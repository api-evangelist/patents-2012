---

title: Systems and methods for fast and precise frequency estimation
abstract: Systems and methods are provided for fast and precise estimation of frequency with relatively minimal sampling and relatively high tolerance to noise.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09166857&OS=09166857&RS=09166857
owner: The Aerospace Corporation
number: 09166857
owner_city: El Segundo
owner_country: US
publication_date: 20120601
---
Frequency estimation systems are an important subsystem of communication navigation radar and various other engineering systems. In some cases the ability to perform relatively efficient and precise estimation of frequency may be a critical component in system design. Indeed an inability to perform relatively efficient and precise estimation may significantly limit the performance of these systems as measured by various metrics of performance. For example in high dynamic global positioning satellite GPS receiver applications effectively acquiring and tracking the GPS carrier signal under dynamic conditions may limit the performance and applicability of these receivers to various applications. For this reason various architectures suited to such applications have been previously proposed that acquire and track the GPS carrier under dynamic conditions with the various different methods having a variety of limitations in terms of signal to noise ratio initial frequency uncertainty and other metrics of performance.

In terms of communication systems precise frequency and phase may be important in communication systems involving coherent modulation techniques such as multiple quadrature amplitude modulation MQAM and multiple phase shift keying MPSK . In certain communication applications techniques such as square law loop or Costas type loop are used to derive the carrier frequency and phase from modulated signals or a pilot signal is used which is tracked. The use of square law loop or Costas type loop result in significant loss in terms of phase noise of the reference carrier and phase ambiguity problems associated with phase ambiguity in the carrier phase equal to integer multiple of 2 M for the MPSK signal. The use of pilot carrier results in a loss of signal power because a significant part of available power is used up in the pilot. The ability to provide fast and accurate frequency and phase estimates at very low signal to noise ratios SNRs may reduce the loss due to pilot carrier to an insignificant value.

More recently precise and fast frequency acquisition and tracking have become increasingly important with the evolution of the Orthogonal Frequency Division Multiplexing OFDM in mobile communication systems. The OFDM modulation scheme may reduce problems of inter symbol interference ISI caused by multipath propagation. It may also exhibit relatively high performance in selective fading environments. Due to these and other features OFDM has become part of various standards such as Worldwide Interoperability for Microwave Access WiMax . Because OFDM is based on the orthogonality among various subcarrier signals it is very important that this orthogonality be maintained when these subcarriers are received at the receiver. However the mobile wireless channels introduce frequency offsets which cause disruption of the orthogonality among the subcarriers resulting in mutual interference among the various subcarriers. Therefore it is desirable to precisely estimate such frequency offsets and correct them to avoid problems associated with intercarrier interference. The offsets may be functions of time and may vary with different subcarriers. Therefore it is further desirable that precise estimation of the frequency offset be made with a minimum requirement on the estimation time and SNR which is also limited in systems involving error correction coding techniques.

Some of the previous techniques for frequency estimation are based on the extended Kalman filter EKF . In these techniques the state of the Kalman filter is comprised of the signal phase frequency and possibly one or more derivatives of the frequency and the measurement is a nonlinear function of the state vector. In this approach the measurement function is linearized about the current estimate of the state. Thus the technique based on EKF is more appropriate in the tracking mode when the initial estimate of the state is close to the true state and under a relatively high signal to noise ratio condition. However when fast acquisition is required starting with a relatively high frequency uncertainty and or in low signal to noise ratio conditions the EKF based methods may not meet the required performance as they have relatively high thresholds for required signal power to noise density ratio P N . Therefore if the P Nratio is below the threshold the EKF may fail to converge and instead it may diverge. In other words when the EKF diverges the state estimation error instead of converging to relatively small value as more and more measurement samples are processed increases with the number of samples processed and approaches a large estimation error. The EKF estimator also results in a phase locked loop PLL configuration with time varying loop filter coefficients and is thus also an optimum PLL. Thus the PLLs have similar limitations as the EKFs.

In fast Fourier transform FFT methods for frequency estimation the N point Fourier transform of a signal is evaluated and the peak of the absolute values of the FFT is searched. The FFT frequency corresponding to the peak is taken as the estimate of the unknown frequency associated with the signal. The FFT method has two limitations. First the estimation error is of the order of the FFT resolution frequency that is equal to 2 B N where 2 B is the interval of frequency uncertainty. Second in a relatively low SNR condition selection of the peak among N noisy outputs of the transform involves detection errors corresponding to a large estimation error in the range of B to B Hz. Increasing the sampling N reduces the resolution frequency however concurrently it also increases the probability of detecting the incorrect peak thus exhibiting threshold effects with respect to the SNR level.

The techniques that have been used in the estimation of the frequency offset in OFDM systems based on the assumption that the offset is same for all the sub carriers involve correlating the received signal with a reference signal and thereby determining the relative phase between the two signals. By estimating the relative phase at two different time instances and dividing the difference between the two relative phase differences by the time difference provides the frequency estimate. The correlation operation requires that the integration interval Tfor the correlation operation may be much smaller than the inverse of the offset frequency felse the signal amplitude at the correlator output will be small and close to zero if T 1 f. On the other hand selection of a small Tleads to relatively large noise at the integrator output which may result in a noisy phase estimate. Differencing the noisy phase estimates may further accentuate the estimation error. Thus the correlation based approach has limitations in terms of the magnitude of the frequency offset and the SNR condition under which it will provide a satisfactory result.

Embodiments of the disclosure are described more fully hereinafter with reference to the accompanying drawings in which embodiments of the disclosure are shown. This disclosure may however be embodied in many different forms and should not be construed as limited to the embodiments set forth herein rather these embodiments are provided so that this disclosure will be thorough and complete and will fully convey the scope of the disclosure to those skilled in the art. Like numbers refer to like elements throughout.

Embodiments of the disclosure are directed to among other things estimation of parameters associated with a signal. The disclosure provides a variety of architectures based on Adaptive Kalman filter AKF and Fast Fourier Transform FFT methods. These various architectures provide relatively fast and precise frequency estimates along with estimates of amplitudes and phase for the case of single and multiple carriers present in the received signal. The various architectures operate on a vast range of signal to noise ratios wherein those operating in low signal to noise ratio conditions involve relatively higher computational effort such that over a relatively large range of SNRs a high precision of estimation is achieved. The various architectures presented also provide precise estimates for the case involving significant frequency derivatives wherein the frequency derivatives may also be estimated from the received signal and accurate tracking of time varying frequency is achieved.

The various architectures presented in this disclosure may further be used for single or multiple sinusoidal signals present in the sampled received signal. These architectures include one or more adaptive Kalman filters AKF . The adaptive Kalman filter is comprised of two coupled Kalman filters. The first Kalman filter KF is the state update Kalman filter SUKF that may estimate a state vector x k that may include in phase and quadrature components of a sinusoidal signal received in the presence of noise. The SUKF may provide the filtered estimates of the in phase and quadrature components of the sinusoidal signal thus filtering out the additive noise from the measurements. The SUKF is based on a state model where the elements of a state transition matrix associated with the state model are the cos and sin functions of the normalized frequency 2 f Fwhere fis the frequency of the received signal and Fis the sampling frequency. Based on the information provided by the SUKF the second Kalman filter termed the parameter update Kalman filter PUKF provides the estimates of a parameter vector whose elements are cos and sin . Based on a delayed filtered parameter vector estimate circumflex over k 1 k 1 the state transition matrix for the SUKF is generated. The two Kalman filters operate in a back to back manner providing the state and the parameter vector estimates circumflex over x k k and circumflex over k k for k 1 2 . . . . From the state and the parameter vector estimates the estimates for the frequency phase and amplitude are obtained in terms of simple functions of the state and parameter vesctor estimates. Unlike the EKF the AKF does not involve any linearization therefore it provides fast frequency estimates when the initial frequency offset is relatively large and under medium SNR conditions. Simulations show that for an SNR of 7 dB an RMS frequency estimation error of about 3 Hz is obtained in about 10 samples when the initial frequency is selected randomly from the range of 50 to 50 Hz and the sampling frequency is 400 Hz. With an increasing number of samples the RMS error tends to be zero.

In the case of signals with randomly time varying frequency with independent incremental change at each sample the AKF may closely track the frequency with the estimation error close to the random independent change in frequency at each time instance. However in the case of significant frequency derivatives that may themselves be slowly varying functions of time the disclosure presents another embodiment wherein the frequency derivatives are explicitly estimated thereby achieving a rapid acquisition followed by close tracking of frequency with relatively small error. Another embodiment of the disclosure presents acquisition and tracking of multiple N sinusoidal signals present in the received signal wherein the various frequencies may also have significant frequency derivatives. In this embodiment the estimator referred to as the adaptive Kalman filter multiple frequency AKF MF the state update Kalman filter SUKF may have dimension 2N and the PUKF may have N KFs with each estimating a parameter vector of dimension 2. In yet another embodiment the input signal is first filtered by a bank of M polyphase filters or the M FFT filters followed by the AKF MFs thus resulting in the reduction of the dimension of the SUKF. The estimates from the M AKF MFs are appropriately combined to provide the final estimates of the frequencies frequency derivatives amplitudes and phase of the N sinusoidal signals present in the received signal.

As the SNR is reduced below some value there is a nonzero probability that the estimates do not converge to small values that are of the order of that predicted from the theoretical Cramer Rao C R bound. To avoid this possibility in another embodiment of the disclosure the input signal or a segment thereof is correlated with the complex exponential function of frequencies equal to the estimate provided by the AKF MF. If the correlation values are not above a certain bound in magnitude the AKF MF is rerun with different initial frequency estimates. The process is repeated until a threshold condition is satisfied or the number of trials exceeds a specified number. At the end of the first estimation step the input signal is reprocessed with N individual single frequency KFs referred to herein as AKF SFs with their initial frequencies provided by the first stage estimation. The second stage may also involve processing of the input signal in segments and the operation of frequency shift at the end of processing each segment and reprocessing each segment multiple times such that the frequency to be estimated by the AKF SF approaches zero at the end of each segment processing and the estimates from adaptive Kalman filter sub systems AKF SSs are accumulated to provide final frequency estimates for the N input frequencies along with other parameters of interest. Simulation examples show that the use of this embodiment results in a root mean squared RMS frequency estimation error obtained with 50 random frequency selections in the range of 100 to 100 Hz and with 100 simulation runs for each such frequency selection of about 3 Hz for an SNR of 7 dB and in 10 input signal samples with no outliers. This compares to about a 2 Hz RMS theoretical C R lower bound on the RMS error.

Another embodiment of the disclosure for the case of very low SNRs 10 dB involves three stages of estimation. In the first stage the input signal may be provided at the input to an M point FFT with M N where N is the number of frequencies in the input signal. The FFT may provide at its output an estimate of average power present at the M FFT frequencies. A frequency selector block may select N M frequencies from the M FFT frequencies corresponding to the highest average power levels. The selected Nfrequencies may be inputted to a bank of NAKF SS that processes the input signal to arrive at the final frequency estimates f m 0 1 . . . N 1. The average power present at the Nfrequencies may be evaluated by correlation. For the case of N equal to 1 two frequencies out of the Nfrequencies fwith the highest power levels may be selected and their corresponding respective values may be compared to threshold values. If the threshold condition is satisfied the final estimate ffrom the stage of estimation is determined from the two selected frequencies. If the threshold condition is not satisfied the first and second processes of the estimation are repeated with a frequency offset introduced in the input signal. In the third process of the estimation the input signal may be shifted in frequency by a complex exponential function at frequency f. The resulting frequency shifted signal may be averaged over an appropriate interval and the signal thus obtained may be reprocessed by the AKF to achieve the final estimate of the frequency f. For the case of N 1 instead of selecting two frequencies in the second stage N frequencies with the highest power may be selected. The N estimates from the third stage may be provided to the third stage that is comprised of N AKFs one for each of the N frequencies. Simulations show that this architecture provides very small frequency estimation error even at very low SNRs. For example at an SNR of 10 dB an RMS error equal to a fraction of 1 Hz is achieved in about 200 samples with the frequency selected randomly from the range of 200 to 200 Hz. While the disclosure presents various comprehensive architectures for the estimation of frequency and other parameters of multiple sinusoidal signals present in the input signal these architectures can be adapted to a variety of applications that involve frequency estimation in one or more forms.

Various embodiments of the disclosure describe the adaptive Kalman filter AKF estimator and the FFT and correlation based estimators for fast and precise estimation of the frequencies amplitudes and phases of multiple sinusoidal signals received in the presence of noise when the interval of observation is relatively limited. The first embodiment of the disclosure describes the adaptive Kalman filter AKF estimator for the case of a single sinusoidal signal present in the presence of noise. The frequency of the signal may remain constant over the interval of observation or may have some random time varying component associated with it. In alternative embodiments of the AKF estimator both the frequency and the frequency derivative may be estimated when there is a significant non zero frequency derivative present during the observation interval and the derivative itself may be a constant or varying slowly during the interval of observation. Various embodiments of different computational complexity are presented for signal to noise ratios ranging over medium to relatively very low values.

The embodiment of the disclosure for the AKF estimator for estimating the frequency amplitude and phase of a signal including a single sinusoidal signal is disclosed first. In this case the intermediate frequency signal of some unknown but constant frequency received in the presence of band pass white Gaussian noise over an interval of time of length Tis given by cos 2 0 1 

In 1 fis known IF frequency and the unknown frequency fhas a value in the range of B to B Hz. The parameters A and are the amplitude and phase respectively both of which are also unknown. The band pass white noise n t may have a one side noise power spectral density of NW Hz. Thus the input signal to noise power ratio is A 4NB and the signal power to noise power spectral density ratio is equal to A 2N with the signal power A 2. The corresponding base band model obtained by the down conversion of the IF signal to complex baseband is given by cos 2a sin 2b 

In 2a 2b z t and z t are the in phase and quadrature baseband signals and 2 f. The baseband noise processes n t and n t are independent white noise processes with the two sided power spectral density N. This embodiment discloses an adaptive Kalman filter AKF estimator to estimate the unknown parameters A and with minimum possible errors such that the performance is close to theoretical bounds on such errors. Each of the baseband signals has power A 2 with the total baseband signal power equal to A. In the embodiment the signal power refers to the total baseband power.

The signals z t and z t are sampled at a sampling rate Fthat is at least two times the maximum possible value of the unknown frequency f 2 . The corresponding discrete time version of the measurements is given by cos 3 sin 0 1 4 

In equations 3 and 4 k denotes the discrete time index and Tis the digital frequency in radians rad with T 1 F denoting the sampling period. The sampled noise sequences n k and n k are independent random sequences with zero mean and variance N T. For the purpose of estimation of the unknown parameters A and by the AKF the state variables x k and x k are defined as cos 5 sin 6 

The measurement equations 3 and 4 for the AKF estimator may also be written in the matrix vector form

The two Kalman filters therefore operate in a back to back manner providing the state and the parameter vector estimates circumflex over x k k and circumflex over k k for k 1 2 . . . . From the state and the parameter vector estimates the estimates for the frequency phase and amplitude may be obtained in terms of simple functions of these estimates by an estimator of signal parameter . Unlike an EKF the AKF does not involve any linearization. Therefore it may provide fast frequency estimates when the initial frequency offset is relatively large and under medium SNR conditions.

It will be appreciated that one or more of the constituent SUKF PUKF and other elements and of the AKF may be implemented in a variety of mechanisms including for example on a processor running instructions to implement the AKF . In one aspect the elements of the AKF may be implemented as modules of a software application stored on one or more memories and accessible by one or more processors configured to execute constituent instructions of the modules and or software application. Alternatively each of the elements of the AKF may be implemented with discrete electrical elements communicatively coupled therebetween. These elements may be digital elements incorporating hardware software or both hardware and software.

The state update Kalman filter equations for the estimation of the state vector x k for the case of known matrix F are given by 1 1 15a 1 1 15b 1 1 11 15c 1 15d 1 15e 1 1 1 15f 1 15g 

In equations 15a 15g circumflex over x k k denotes the filtered estimate of the state x k circumflex over x k k 1 denotes the predicted estimate of x k based on measurements up to time k 1 i.e. z 0 z 1 . . . z k 1 tilde over z k k 1 is the prediction error and K k is the Kalman filter gain. The matrices P k k and P k k 1 are the error covariance matrices for the filtered and predicted estimates respectively of x k . In general the matrices F k and H k may be time varying however in application to equations 12 14 these are independent of k and the matrix G k in 15g is equal to the identity matrix. The process covariance matrix Q is zero for the equation 12 . However to increase the robustness of the algorithm Q may be set to some small non singular matrix. In an exponentially data weighted version of the Kalman filter which has a robustness against certain model inaccuracies the equation 15f is replaced by 1 15h 

where tandenotes the 4 quadrant inverse tangent function Similarly the phase estimate is given in terms of the filtered estimate of the state x k by circumflex over tan 17 

The filtered estimate of the amplitude A is also obtained from the filtered estimate of the state x k as 19 

where Nis the total number of samples and Nis the number of samples that are discarded in the computation of the smoothed estimate of A.

The matrix F in the Kalman filter update equations 15 requires knowledge of the parameters and which are unknown and need to be estimated. In the adaptive Kalman filter AKF of the embodiment of this disclosure these parameters are estimated from circumflex over x k k .

Replacing the state x k by its filtered estimate circumflex over x k k the equations 21 and 22 may be expressed in the following matrix vector form

In equations 23 and 24 the suffix on the variables z H n etc. signifies that these variables relate to the estimation of the parameter . The noise vector naccounts for the error in the estimate of the state x k and has its covariance matrix equal to R k that is determined from the Kalman filter update equations 15 . In case of fixed frequency the parameter vector is not a function of k. However to include a more general case it may be assumed to vary according to the following dynamics equation 1 25 

where Fand Gare some appropriate matrices and k denotes the process noise which may be zero mean and white or otherwise spread across a relatively wide spectrum with covariance matrix Q. The Kalman filter update equations for the estimation of the parameter k at the parameter update Kalman filter from equations 23 and 25 is given by circumflex over circumflex over 1 1 26a 1 circumflex over 1 26b circumflex over 1 1 circumflex over 1 1 26c 1 26d 1 26e 1 1 1 26f 1 26g 

In an exponentially data weighted version of the parameter update Kalman filter the equation 26g is replaced by 1 26h 

In the Kalman filter equation 15 the matrix F k 1 is replaced by its estimate circumflex over F k 1 k 1 given by

The two sets of equations 15 and 26 are updated in an interlaced manner thus the sequence of estimates are circumflex over k 1 k 1 circumflex over F k 1 k 1 circumflex over x k k circumflex over k k for k 1 2 . . . with some initial estimate for circumflex over 0 0 based on some possibly zero initial estimate for the digital frequency .

From the definitions of the matrices H k and H k the equation 28 may be written in the following alternative form

As tilde over x k k 1 and n k are uncorrelated due to the independence of noise sequence n k the covariance of the prediction error tilde over z k k 1 is given by 1 1 1 35 

For the case of F I corresponding to the case of time invariant parameter and G 0 the Kalman filter equations 26 can be simplified to arrive at the weighted least squares algorithm. With the substitution of F I and G 0 and replacing k by k 1 in 26h yields 1 1 1 37 

where in equation 39 Pp k is a more compact notation for P k k . The Kalman gain Kfor the case of constant may be expressed as 1 1 40 

The weighted least squares algorithm is thus given by 1 1 1 1 44a 45b circumflex over circumflex over 1 circumflex over 1 45c 

In 44 circumflex over k is the compact notation for circumflex over k k in the case of constant . From the definition of the parameters and in 9 the estimate of the digital frequency is given by circumflex over tan circumflex over circumflex over 46 

with the estimation error in the estimate of the digital frequency given by tilde over circumflex over 47 

The set of equations 5 6 12 15 17 19 20 23 26 33 46 and 48 constitute the AKF algorithm for the estimation of the frequency amplitude and phase of a single sinusoidal signal received in the presence of noise and is referred to as AKFS.

Referring now to a relatively more detailed block diagram representation of the example AKF is shown. In this representation the sampled signal z k defined in 14 is input to the state vector update Kalman filter that provides the filtered state estimate circumflex over x k 1 k 1 at its output computed according to equations 15 . The filtered state estimate circumflex over x k 1 k 1 is pre multiplied by the 2 2 matrix circumflex over F k 1 k 1 to provide the predicted state estimate circumflex over x k k 1 according to 15c wherein F k 1 is replaced by its estimate circumflex over F k 1 k 1 . The prediction error tilde over z k k 1 is evaluated according to 15b by subtracting circumflex over x k k 1 from the measurement z k where H k in 15b is substituted by the 2 2 identity matrix I. Multiplication of tilde over z k k 1 by the Kalman gain K k and adding the product to the predicted state estimate circumflex over x k k 1 results in the filtered state estimate circumflex over x k k at time k which when delayed by one sample is equal to circumflex over x k 1 k 1 thus completing the recursive loop for the update of the filtered state estimate. The initial filter state circumflex over x 0 0 may be selected equal to 0 0 .

Referring still to the filter error covariance matrix P k 1 k 1 is pre multiplied by circumflex over F k 1 k 1 and post multiplied by the transpose of circumflex over F k 1 k 1 and the resulting product is multiplied by 1 where is the exponential data weighting coefficient. The resultant product circumflex over F k 1 k 1 P k 1 k 1 circumflex over F k 1 k 1 is added to the matrix Q k 1 according to 15h where G k Iand Q k 1 is selected to be a constant diagonal matrix Ifor some small positive scalar . The innovation covariance matrix S k is obtained by adding the result to the matrix R k that is equal to Iwhere is the variance of the sampled noise sequences n k and n k in 14 and H k I. Inverting the matrix S k and pre and post multiplying the matrix S k by P k k 1 and subtracting the result from P k k 1 results in P k k according to 15f . The covariance matrix P 0 0 is selected equal to Ifor some small positive scalar . Pre multiplying S k by P k k 1 yields the Kalman gain K k according to 15e .

The innovation covariance matrix S k is pre and post multiplied by K k and K k respectively providing the measurement covariance matrix R k for the parameter vector update Kalman filter according to 36 . The elements of the vector circumflex over x k 1 k 1 provide the measurement matrix H k given in 28 29 . The matrix H k is input to the parameter vector update Kalman filter for which the filtered state estimate circumflex over x k k is the measurement vector z k .

The parameter vector update Kalman filter is similar to the state vector update Kalman filter with the filtered state estimate circumflex over x k k replaced by the filtered parameter vector estimate circumflex over k k . For the case of constant parameter vector the matrix F k 1 is equal to I. The elements of the filtered parameter vector estimate circumflex over k 1 k 1 provide the matrix circumflex over F k 1 k 1 according to 26i which is input to the state vector update Kalman filter. The two Kalman filters in operate in a recursive and interlaced manner providing the estimates circumflex over k 1 k 1 and circumflex over x k k for k 1 2 . . . wherein the initial estimate circumflex over 0 0 is set equal to cos sin with denoting an a priori estimate for the normalized frequency which may be equal to 0.

From the filtered parameter vector estimate circumflex over k k the estimate for the normalized frequency is obtained by the tan block that provides the four quadrant inverse tangent of the input according to 46 . The estimate for the analog frequency fmay be obtained by multiplying circumflex over by F 2 where Fis the sampling frequency. The filtered state estimate circumflex over x k k is input to a second tan block that yields the estimate for the instantaneous phase k according to 17 . The filtered state estimate circumflex over x k k is input to the norm block that evaluates the Euclidean norm of the input providing the estimate k for the amplitude according to 19 . From k the smoothed estimate is obtained by the averaging block that obtains according to 20 .

As a non limiting simulation example consider the bandwidth B 200 Hz with a sampling rate Fselected equal to 400 Hz. The amplitude A 1 volt with the bandpass noise one sided noise spectral density Nis equal to 2.5 10W Hz with the signal power to noise spectral density ratio equal to 33 dB Hz. This corresponds to the variance of the bandpass noise 2NB 0.1 W with the signal to noise ratio equal to 5 or 7 dB. The one sided noise spectral density of both the baseband processes n t and n t is equal to 2N 5 10W Hz with the baseband SNR for both the in phase and quadrature components equal to 5 7 dB . The initial values for the matrices P Q and Pare selected as

The exponential data weighting coefficients are selected as 0.999. illustrate example results obtained over the interval of 25 samples. For the smoothed estimate of A the number of samples Nis selected equal to 50.

The performance of the adaptive Kalman filter AKF may be compared to the theoretical bound on the frequency estimation error variance which is also known as Cramer Rao C R bound. The Cramer Rao bound on the variance of frequency estimation error tilde over f defined in 48 is given by

The simulation examples compare the performance of the AKF algorithm with the C R bound. For the comparison the AKF algorithm as executed by the AKF is simulated with the frequency fselected randomly from the range B B Hz based on a uniform distribution and with the initial frequency estimate equal to 0. For each such selection the AKF algorithm is simulated with n 100 independent noise sequences. The procedure is repeated with ndifferent values of the frequency fselected on a random basis. For each selection of f the RMS frequency estimation error tilde over f as a function of the number of samples processed is computed by the mean squared average over the nsimulation runs given by

All the other parameters are selected as in the non limiting example to compare with the C R bound in 49a and the RMS estimation error evaluated in 49b is averaged over all the n 100 frequency selections as

In another non limiting example the frequency fis a randomly varying function of k according to the following equation 1 50 

The perturbation k is modeled as an independent zero mean Gaussian sequence with variance . From the definition of the parameters and in 9 the time varying versions of these parameters are approximated by 1 2 1 2 51 As 0.5 52 

In the simulation example 2 and Q is modified to 0.01 Ito account for added uncertainty in the estimate for F k 1 required in the Kalman filter equation 15 . show the results for this example wherein all of the parameters are the same as for the case of . As may be observed from the estimated frequency remains close to the true frequency after an initial 10 samples. plot the frequency estimation error and the two components of the state estimation error tilde over x k k defined in 29 respectively. plots the phase estimation error tilde over k defined in 18 as a function of k. After about 100 samples the peak to peak phase estimation error is about 0.4 rad corresponding to the RMS phase estimation error of about 0.07 rad. The RMS value of the random change in frequency at any time k is equal to square root over 2 Hz and this component is independent of the measurements up to time k and therefore cannot be estimated at time k. Thus the ideal estimation algorithm is expected to result in the RMS frequency estimation error of square root over 2 Hz. From the peak frequency estimation error after the initial 10 samples is about 6 Hz corresponding to an RMS error of about 2 Hz that is close to the ideal case of square root over 2 Hz with the difference of about 0.6 Hz attributed to the estimation algorithm.

In another embodiment of the AKF estimator both the frequency and the frequency derivative may be estimated when there is a significant non zero frequency derivative present during the observation interval and the derivative itself may be a constant or a slowly varying function of time during the interval of observation.

In the case when the frequency is time varying with its derivative the in phase and quadrature baseband signals z t and z t are given by

From 59 and 62 the instantaneous frequency t at t kTis related to the normalized frequency k by 2 63 

where Fis the sampling frequency. In 61 may also be a slowly time varying function of k. The parameters and in 9 are time varying for this case and are given by cos sin 1 2 64 

In 67 H is equal to the 2 2 identity matrix. The state vector x k is estimated by the Kalman filter equations 15 with F k 1 replaced by its estimate circumflex over F k 1 k 1 obtained by replacing k 1 and k 1 in 66b by their estimates circumflex over k 1 k 1 and circumflex over k 1 k 1 respectively. The parameter vector estimate circumflex over k k 1 circumflex over k k 1 circumflex over k k 1 is obtained from the parameter update equations 26 with z k H k and R k defined by equations 23 24 and 36 respectively and with the matrix Qset equal to the 0 matrix Gequal to the 2 2 identity matrix and the matrix F k 1 replaced by

In 68 circumflex over k 1 denotes the estimate of based on the measurement z i with i 1 2 . . . k 2. In order to obtain the estimate of circumflex over k for any k the normalized frequency k at time k is estimated by circumflex over tan circumflex over circumflex over 1 2 69 

In 69 tan denotes the four quadrant inverse tangent functions and circumflex over 0 0 may be set equal to an intial estimate of 0 which may be equal to 0. In the parameter vector update equation 26 circumflex over 0 0 is correspondingly set equal to cos sin . From 69 the first order differences are obtained as circumflex over circumflex over circumflex over 1 1 2 70 

The estimates circumflex over k in 70 constitute the noisy estimate of the parameter wherein may also be a slowly varying function of k. The smoothed estimate of k is obtained by filtering the estimates circumflex over k by an appropriate filter. For example use of a first order filter yields the following smoothed estimate of k . 1 1 circumflex over 1 2 71 

In 71 circumflex over 0 may be set equal to an initial estimate of or may be set equal to 0. In 71 is a positive constant with 0

Referring now to an example architecture in accordance with embodiments of the disclosure for the case of a relatively significant non zero frequency derivative estimation along with the time varying frequency estimation is illustrated. The signal z k may be provided to a frequency estimator block that may be similar to the AKF of . The frequency estimator block may include a state update Kalman filter and a parameter update Kalman filter . The frequency estimator block may provide at its outputs a filtered state estimate circumflex over x k k and a filtered parameter vector estimate circumflex over k k from which a frequency estimate circumflex over f k may be obtained as in the AKF of . Instead of being equal to the identity matrix as may be the case for AKF of may be time varying and may be generated by a frequency derivative estimator .

The normalized frequency estimate circumflex over k may be provided to a first order differencing block which may generate a difference frequency circumflex over k according to 70 . The difference frequency circumflex over k may be provided to a first order filter that generates at its output an estimate of the frequency derivative circumflex over k according to 71 . The delayed version of circumflex over k may be input to the cascade of the cos and sin blocks and the scalar to vector converter followed by a matrix constructor block that generates circumflex over F k 1 from the vector cos circumflex over k 1 sin circumflex over k 1 according to 68 . The 2 2 matrix circumflex over F k 1 may be input to the parameter update Kalman filter for the generation of parameter vector estimate circumflex over k k .

A non limiting simulation example is shown for the estimation of the time varying frequency with the frequency at time k 0 equal to 25 Hz and the parameter equal to 0.007 corresponding to the parameter equal to 0.007 400 1120 rad sec. This corresponds to a rate of change in frequency of about 178 Hz sec. The initial estimates of the frequency and the parameter at time k 0 are equal to 25 Hz and 0 respectively. The SNR for this example is 5 7 dB with the initial values for various matrices in the AKF same as in 49 . shows a plot of the frequency as a function of time along with its estimate obtained from the AKF. After about 100 samples the frequency is tracked very closely by its estimate. plots the convergence of the parameter showing a rapid initial convergence of the estimate to the true parameter value. In 71 the filter parameter is initially selected equal to 0.995 and may be reduced to 0.99 after 150 samples.

In some embodiments of the disclosure the first and higher order derivatives may be obtained by a Kalman filter that may replace the frequency estimator block of . For example for the case of first and second derivative estimation the state vector x k for the Kalman filter may be given by 71a wherein 71a k and k are the normalized frequency and the normalized first derivative of frequency respectively and Twith denotes the second derivative of the frequency t . The time variation of may be given by 1 71b 

In 71b n k is a zero mean independent sequence with variance . The state transition equation for x k is given by 1 71c where in 71c Gis the identity matrix and the covariance matrix Qof the noise vector is given by

The measurement equation for the Kalman filter is given by 1 0 0 71f with z k in 71f made equal to the normalized frequency estimate obtained from the Kalman filter state estimate circumflex over k k as in . Thus n k tilde over k and the covariance of n k may be estimated from 51 53 and is given by Trace 71g 

On the basis of the state space model described by 71a 71g the Kalman filter may provide the estimate circumflex over x k k the second component of which is the estimate of k that may be inputted to the block of instead of that from block of . Derivatives of frequency of order higher than 2 can similarly be obtained by appropriate extension of the dimension of the state vector x k .

In further embodiments of the disclosure parameter estimation on multiple sinusoidal signals received in the presence of noise may be performed. In this case the received intermediate frequency bandpass signal z t is given by

In 72 fis the known intermediate frequency and the unknown frequencies fhave their values in the range of B to B Hz for some B. The amplitudes Aand phase associated with frequencies fare also unknown. The bandpass white noise n t has a one sided noise power spectral density of NW Hz. The corresponding baseband model is given by

In 73a 73b z t and z t are the in phase and quadrature signals and 2 ffor m 1 2 . . . N. The baseband processes n t and n t are independent white noise processes with the two sided power spectral density NW Hz. It is required to estimate the parameters A and for m 1 2 . . . N. The signals z t and z t are sampled at a rate Fthat is at least two times the maximum possible frequency B. The corresponding discrete time version of the measurements is given by

In equation 74 k denotes the discrete time index and T m 1 2 . . . N are the digital frequencies in rad with T 1 F. The sampled noise sequences n k and n k are independent random sequences with zero mean and variance N T. In the case of multiple frequencies the state vector x k is a 2N dimensional vector . . . 75 

In the more general case where the msignal has a frequency derivative a the state components in 76 are replaced by cos 77a sin 77b 

where Iis the 2 2 identity matrix. The filtered and predicted state estimates circumflex over x k k and circumflex over x k k 1 are obtained from the Kalman filter equation 15 wherein the corresponding covariance matrices P k k and P k k 1 are square matrices of dimension 2N. The process covariance matrix Q may be set to zero as for the case of single frequency estimation. The matrix F k 1 in 15 is replaced by the estimate circumflex over F k 1 k 1 obtained by the parameter vector update equations similar to 26 . The matrix circumflex over F k 1 k 1 is a 2N 2N matrix given in the following partitioned form

circumflex over k 1 k 1 circumflex over k 1 k 1 circumflex over k 1 k 1 is obtained recursively from the parameter update equation 26 with circumflex over k k circumflex over k k 1 z k H k and R k in 26 replaced by circumflex over k k circumflex over k k 1 z k H k and R k respectively where

The matrix Qis set equal to the zero matrix with Gequal to the 2 2 identity matrix. The matrix R k in 33 is a 2N 2N matrix for this case of multiple signals with Rgiven by the following 2 2 submatrix of R k .

In 87 circumflex over k 1 denotes the estimate of based on the measurements z i for i 1 2 . . . k 2 and is estimated as for the case of the single frequency estimation. Thus the normalized frequency k at time k is estimated by circumflex over tan circumflex over circumflex over 1 2 88 

The normalized frequency estimate circumflex over 0 0 at time 0 may be set to an initial estimate of 0 which may be equal to 0 and circumflex over 0 0 in the parameter vector update equation set equal to cos sin . From 88 the first order differences are obtained as circumflex over circumflex over circumflex over 1 1 2 89 

The estimate circumflex over k in 89 constitutes the noisy estimate of the parameter which may also be a slowly varying function of k. The smoothed estimate of may be obtained by filtering the estimate circumflex over k by an appropriate filter. For example use of a first order filter yields circumflex over circumflex over 1 1 circumflex over 1 2 90 

In 90 circumflex over 0 may be set equal to an initial estimate of or may be set equal to 0. In 90 is a positive constant with 0

From the definition of the components of the state vector in 77 the phase estimate at time k is obtained as circumflex over tan 1 2 . . . 91 

In 93 Nis the total number of samples and Nis the number of samples that are discarded in the computation of the smoothed estimate of A.

A Kalman gain matrix K k of dimension 2N 2 may be input to the matrix splitter to partition K k into N submatrices K k K k . . . K k each of dimension 2 2 with

In 93b the argument k in the elements of the matrix has been dropped for the notational simplification. The innovation covariance matrix S k may be pre and post multiplied by K k and its transpose K k and the resulting product may be added to a constant matrix I for some small positive scalar providing a measurement covariance matrix Rfor an mPUS parameter update subsystem block A N collectively referred to herein as for m 1 2 . . . N. The component state vector circumflex over x k k may be provided to the mPUS block to generate the estimates for the frequency circumflex over f k frequency derivative circumflex over k phase circumflex over k and amplitude k and the smoothed amplitude estimate for m 1 2 . . . N. The operation of the PUS block has been explained with reference to block of and in the interest of brevity will not be repeated here.

When the number of frequencies N in 72 is relatively large the dimension of the covariance matrices P k k and P k k 1 in the Kalman filter equation 15 equal to 2N 2N is also correspondingly large. In this case the matrix dimension can be reduced by filtering the complex valued signal z k z k j z k j square root over 1 by a set of M complex bandpass filters with their bandwidths equal to 2 B M and their center frequencies selected so that the M filters have mutually disjoint pass bands. For example with M 4 each of the 4 filters has a bandwidth equal to B 2 with their respective center frequencies equal to 3B 4 B 4 B 4 and 3B 4 respectively. In alternative embodiments there may be some non zero overlap among the adjacent frequency bands of the M complex filters output signals to avoid attenuating any frequency that may fall in a transition band of the filter.

The outputs of the M filters may be down converted to complex baseband so that each of the M down converted signals has its center frequency equal to 0 and has frequencies in the range of B 4 to B 4. The sampling rates of the down converted signals are decimated by a factor M to the rate F M. All of the operations of bandpass filtering down conversion to complex baseband and decimation can be performed by a bank of polyphase filters.

The individual outputs of the polyphase filters are then processed by the adaptive Kalman filters to acquire and track the frequencies present in the respective outputs of the polyphase filters. The frequency estimates thus obtained are adjusted by the center frequencies of the corresponding bandpass filters to arrive at the frequency frequency derivative and the amplitude estimates of the N signals present in the signal z k .

In an alternative embodiment instead of using a polyphase filter the filtering of the signal z i may be performed by the FFT operation as follows. Let

The operation in 94 constitutes frequency shifting of the signal z i by frequency ffollowed by a decimation by the factor M assumed to be even. The signal z k can also be obtained in terms of the discrete Fourier transform or the Fast Fourier transform FFT of the ksegment of z i of length M given by z k 1 M z k 1 M 1 . . . z kM 1 after being modified by multiplication of the ielement of by 1 i.e. with

For a component z k at frequency f f f contained in the signal z k for some m 0 m M 1 with f f f the ksegment of that component complex valued signal is given by exp 2 0 1 . . . 1 97 

where i denotes the ielement of the segment and denotes the phase at the start of the ksegment. From 94 the corresponding output for the signal given by

As the adjacent frequencies fare spaced by f for any frequency in the interval fand f 1 with f f f 0 f one obtains

The adaptive Kalman filter for multiple frequencies AKF MF may be applied to signals z k m 0 1 . . . M 1. For any frequency fwith f f f 0 f f the AKF MF applied to both z k and z k result in frequency estimates fand fclose to f and f f respectively with the estimate of f given by f f f f 2. From fand f the estimate of fis given by f f f f 2. The frequency estimates from any two AKF MFs are combined in this manner if the estimates differ by less than the resolution frequency fwhich may be selected to be a fraction of f. The corresponding estimates of the amplitudes and provided by the two AKFM are expected to be close to the magnitudes of Aand Arespectively given by 101 .

Thus with the estimate of f known the coefficients aand aand the phase and may be evaluated from 101a 101b after replacing f by its estimate f and the estimate of the amplitude A may be obtained by the maximal ratio combining of and as 102a 

For the case of a2 0 the equation 102a normalizes the amplitude Aby aproviding the correct estimate for the amplitude A. When the estimate f has significant error an incoherent combining of the amplitudes and may be used to yield the following amplitude estimate. 102b 

The two dimensional vector z k is input to the AKF MF block that is also inputted with the matrices H k Q k 1 and R k . The matrix H k is given by 81 and is of dimension 2 2N Q k 1 Ifor some small positive scalar and R k Iwith M and with Ndenoting the number of frequencies in the signal z k and may be replaced by some appropriate upper bound. Partitioning the input signal z i in this manner reduces both the dimension of the state vector and various other matrices and at the same time reduces the noise variance by the factor M.

Referring still to the AKF MF block A N collectively referred to herein as may provide as its output the frequency estimates circumflex over f k frequency derivative circumflex over k not shown phase circumflex over k and the amplitude k for i 1 2 . . . Nfor m 0 1 . . . M 1. The operation of the AKF MF block has been explained with reference to and in the interest of brevity will not be repeated here. The estimates of frequencies after being modified by the frequencies B m f frequency derivatives amplitudes and phase may be input to a collator combiner block . In the collator combiner block any two frequency estimates in any two adjacent AKF MF blocks that are within the resolution frequency of each other are combined into one estimate obtained by either a simple arithmetic average of the two frequencies or by a weighted average with the weights determined by the corresponding amplitudes with similar averaging of the frequency derivatives. The corresponding amplitudes and phase may be combined according to 102 103 . For the case of constant frequencies the proximity may be determined on the basis of only the final estimates at time Nwhere as for the time varying frequencies the two frequency estimates should be close to each other over an interval of time to be combined into one. The collator combiner block after possibly combining frequency estimates may provide the N frequencies frequency derivatives amplitudes and phase as the output. In an alternative embodiment the operation of splitting the input complex signal z k into M parallel streams denoted by k k . . . k with approximately mutually disjointed spectra may be performed by a bank of polyphase filters instead of the bank of FFT filters as shown in .

When the signal to noise ratio is relatively small and the initial frequency uncertainty is relatively large there may be some small probability that the AKF estimation algorithm may not converge to the true frequency with relatively small estimation error. To avoid such a possibility a correlation detector is used to validate the frequency estimates provided by the AKF.

In the AKF CD architecture the estimation interval of Nsamples is segmented into msegments of nsamples each wherein in the special case nmay be equal to N. In this architecture the AKF algorithm with various matrices described in equations 74 to 103 may be run for nsamples to estimate circumflex over k and circumflex over k for k 1 2 . . . n m 1 2 . . . N where N is the number of frequencies. From 79 the phase estimate circumflex over k is obtained as circumflex over circumflex over 1 circumflex over 1 2 . . . 104 

In 104 circumflex over 0 may be set to 0. The complex valued signal z k z k jz k j square root over 1 is correlated with the signal s k in a semi coherent manner where exp 2 circumflex over 1 2 . . . 105 

For the semi coherent correlation the interval nis divided into msegments of length n and the coherent correlation is computed for each of the mintervals as

In 106 the interval nis determined such that some bound on the expected frequency estimation error in Hz obtained after processing the nsamples is much smaller than the F nHz wherein the bound on the expected frequency estimation error in Hz for example may be some multiple of the C R bound. From 106 the correlation over the interval of nsamples is obtained as

In 107 Ithat may be 0 denotes the number of initial nlength segments that are discarded in the computation of the incoherent correlation r. The number of samples 1naccounts for the initial transient period where the estimation error is relatively high. For the case of 0 where the frequency w k is constant the coherent correlation in 106 reduces to

In 108 circumflex over denotes the estimate of the normalized frequency in radians based on the processing of nsamples. In this case 1in 107 may be set to 0. In the ideal case of small frequency error and relatively small noise variance the correlation in 107 is nearly equal to rgiven by 2 109 

In the correlation detector rcomputed from 107 is compared to a correlation threshold which may be equal to some fraction of an estimate of A. If ris greater than or equal to the threshold the estimate is deemed to converge to some small error. If all the N frequency estimates do not satisfy the threshold conditions the AKF algorithm described in equations 74 to 103 is repeated for the same initial nsamples but with different random frequency initializations wherein the initializations for those frequencies which satisfy the threshold conditions are set equal to their estimates obtained in the first run. The frequencies for which the threshold condition is not satisfied are initialized randomly over some appropriate interval for example over the interval B 4 B 4 . In the absence of estimates of the individual A the threshold may be applied to the total power estimated as

The power estimated in 110 is compared with some fraction of its prior estimate Pwhich may for example be obtained as

Once the threshold condition is satisfied each of the N frequencies is tracked by further processing of the measurements. In this phase of the algorithm the second set of ncomplex measurements is shifted in frequency by the estimate circumflex over n for the mnormalized frequency n obtained at the end of the first phase according to equation 112 . exp 1 . . . 2 112 

The AKF algorithm processes the nsamples of the measurements z k to obtain the estimates of the frequency k circumflex over n k n 1 . . . 2n. In processing the second set of nmeasurements the parameter error covariance matrix P k k 1 may be increased by an appropriate value so as to increase the convergence rate. The estimates of the frequencies k circumflex over n thus obtained are adjusted by circumflex over m n to account for the frequency shift providing the estimates for the frequency k k n 1 . . . 2n. This procedure of shifting the frequency of the complex signal by the frequency estimate obtained at the end of the previous segment and applying the AKF to process the current segment and modifying the resulting estimates by the amount of frequency shift is repeated for the remaining m 2 segments. A further improvement in the estimates may be obtained by reprocessing all of the msegments N 1 times in a manner similar to the processing of the m 1 segments in the first run where Ndenotes the total number of runs with N 1. For the case of time varying frequency the amount of frequency shift at the start of the second and consecutive runs needs to be appropriately adjusted.

In case of multiple frequencies the signal z k may be segmented after the initial phase into M signals by the use of a polyphase filter or using FFT as in 94 96 such that the number of frequencies in any one segment is small and the dimension of the state vector x k in the AKF MF is relatively small for processing any one segment.

The architecture may further include an algorithm control block that may be configured to generate various control signals including the R W read write command to the memory and an MA memory address when needed. The number of available input signal samples Nmay be divided into msegment each of length n. During the first interval of nTseconds the complex input z k is connected to the complex to real converter that outputs a dimension 2 vector z k with its elements equal to the real and imaginary parts respectively of the signal z k . The signal z k is input to the first stage AKF MF that processes the n samples of the signal z k to provide the estimates of various frequencies circumflex over k and frequency derivatives circumflex over k for m 1 2 . . . N. The operation of the AKF MF block has been previously described with reference to .

Still referring to the estimate of the mfrequency circumflex over k and its derivative circumflex over k may be provided to the correlation threshold detector CTDm block for m 1 2 . . . N. The CTDm block may compute the correlation rbetween the input signal and the complex exponential signal at frequency circumflex over k according to 104 108 and may compare the correlation with a predetermined threshold and further generate a signal tthat is indicative of the comparison at the output. The signal tmay be equal to 1 if the threshold condition is satisfied otherwise it may be equal to 0. The signals t t . . . tmay therefore be provided to the algorithm control block . If any of the tvalues are equal to 0 the procedure is repeated with the stored nsamples read from the memory and with the initial frequency estimates provided to the first stage AKF MF selected in a random and independent manner from a selected distribution. For example the initial frequency estimates may be selected from B 2 B 2 with a uniform distribution. For the frequencies for which the threshold condition is satisfied the initial frequency estimates may be made equal to the corresponding estimates obtained from the preceding run. This process of reading the nsamples from the memory processing them by the first stage AKF MF evaluating correlations and comparing the correlation values with the thresholds in blocks CTD . . . CTDN may be repeated until all tvalues are equal to 1 or the number of such trials exceeds some specified value Nwhich may for example be equal to 4. In an alternative embodiment instead of applying thresholds to individual correlation values the threshold may be applied to the sum of the squares of the individual correlation values evaluated in 110 and the threshold may be some fraction of the total power Pwhich may be either known or estimated from the measurements as in 111 . At the completion of the first process of the algorithm as described herein the measurements may be processed by second stage AKFs .

The samples of the input complex signal z k are inputted to a bank of stage AKF to AKFN through the activation of switches S S and Sstarting with the second segment of nsamples in the first run of the second stage. Referring now to a block diagram of an example AKFm is illustrated and discussed. They AKFm may be used as the second stage AKFs of . The input complex signal z k may be multiplied by the output exp j k of an oscillator with frequency . The product of the complex input and the oscillator output z k may be connected to a complex to real converter that may output a dimension 2 vector z k with its elements equal to the real and imaginary parts respectively of the signal z k . The signal z k is input to an AKF that processes the nsamples of the signal z k to provide estimates of various frequencies circumflex over k and frequency derivatives circumflex over k for m 1 2 . . . N where circumflex over k is the estimate of the difference between the frequency k and the oscillator frequency that may be adjusted at the end of nTsecond intervals. During the first run i 1 of the second stage the oscillator frequency may be set equal to the estimate of the frequency k for k n 2n . . . m 1 nwhere mis the number of segments. In the second and subsequent runs of step i 1 and for the case when k is constant over the period of Nsamples the oscillator frequency at the beginning of the first segment is set equal to the estimate of obtained at the end of the previous run. The signals Ito I starting with initial values of zero may change at the end of nTs second intervals by the clock signal CK not shown that may be incorporated in the algorithm control block of . In one non limiting example I 1 if k nand i 1 and is set equal to the estimate of frequency circumflex over k obtained from the stage AKF MF at the end of processing by the stage AKF MF as the output of the offset due to nonzero is zero. As a result the outputs of the delay blocks in accumulators and of are equal to 0 and thus circumflex over . The signal Iis equal to 1 if either k in i 1 or i 1 otherwise I 0.

When I 1 the frequency estimate circumflex over k may be added on to the previous value of providing an updated value for . Thus may be set to circumflex over k in the first run at k nand from there on it may be modified by circumflex over k at intervals of nTseconds. The sum of circumflex over k and at the end of a previous nlength segment provides the frequency estimates during any run and any segment. These estimates are time multiplexed with the estimates circumflex over k from stage in MUX controlled by the algorithm control block details which are not shown. Thus if n 1 then the first segment final estimates are obtained from circumflex over k with the final estimates for the subsequent segments provided by the second stage. On the other hand if n 1 then all of the final estimates come from stage .

Imay be equal to 1 if k nand i 1. Thus the signal may be equal to circumflex over k if k nand i 1 equal to circumflex over k if k nand i 1 and equal to 0 otherwise. An accumulator output may be set equal to at k nfor any value of i. The signal Iis equal to 1 if k in i 1. If I 1 the value circumflex over k is added to the accumulated output. The signal Iis equal to 1 if k Nand is 0 otherwise. At the end of Nsamples an accumulator output is the sum of the derivatives during the msegments wherein it is assumed that during each segment the derivative is nearly constant. The accumulator output times nis subtracted from to provide the oscillator frequency such that the oscillator frequency is nearly equal to the input signal frequency at the beginning of nsample segments. The initial frequency estimate for the AKF is reset to 0 at the end of each nsample segment in each run and the covariance matrix P 0 0 is reset to some specified value at the start of each run.

The amplitude A is equal to 1 volt. The correlation threshold in the first phase of the algorithm is 0.5. In the first trial of the first phase of the algorithm the initial frequency estimate is selected to be 0 Hz in the subsequent trials the initial estimate is made randomly with a uniform pdf in the range 40 40 Hz . The initial covariance matrices are selected as P 0 0 2 Iand P 0 0 2 Iwith Iequal to the 2 2 identity matrix. At the end of the first phase of the algorithm the P 0 0 is reset to P 0 0 0.05 Ito speed up the convergence rate of the AKF. After that it is updated according to AKF update equation 26 .

The simulations were performed with 50 random frequency selections from the range of 200 200 Hz according to the uniform probability density function pdf . For each such frequency selection the algorithm was simulated with 100 independent noise sequences. shows the RMS frequency error in Hz obtained during the last trial of the first phase of the algorithm for each of the 50 frequency selections. plots the result when the AKF algorithm is repeated a second time after frequency shift according to 112 . As may be inferred from these figures for each frequency selection the AKF CD algorithm converges to a relatively small frequency estimation error. plot the RMS error obtained by averaging the errors obtained in the 50 frequency selections. The results are also compared with the C R bound given by 49a for the same signal to noise ratio and the maximum frequency B 200 Hz. As may be seen from the difference between the AKF CD algorithm and the C R bound is small. It may be emphasized that the initial frequency estimates in are based on the complete data of 10 samples and thus it is the final error at the end of 10 samples that is more meaningful in terms of the comparison with the C R bound. shows the 50 frequencies that were selected in the simulations. shows the number of maximum trials in the first phase of the algorithm for each of the 50 selected frequencies showing that only 6 out of the 50 frequency selections required retrials for some noise sequences.

For relatively very low signal to noise ratio conditions the Kalman filter based frequency estimation algorithm may not converge to the correct frequency. Instead it may converge to a frequency with an estimation error in the range of F 2 to F 2 with some non zero probability i.e. the algorithm may diverge. Thus the algorithm converges to the correct frequency for some noise sequence and the initial estimate while for some other noise sequence and or initial frequency estimates it may converge to an estimate with a relatively large error with some non zero probability. Moreover the smaller the signal to noise ratio the relatively higher is the probability of divergence. For this case another embodiment of the disclosure is presented that provides good convergence even under very low signal to noise ratio conditions.

In this embodiment of the disclosure the range of frequency uncertainty F 2 B is divided into M intervals of length f F M. The integer M is selected such that the ratio M MA 2 with A 2 denoting the SNR is higher than some specified threshold value and N M is an integer. For example with 0.25 and 5 M 20 let z k denote the complex valued signal as square root over 1 113 

The signal z k is correlated with complex exponential functions of frequency f B m f m 0 1 . . . M 1 over an interval of M F f samples providing the correlation values

The expression in 114 can also be evaluated in terms of the discrete Fourier transform DFT or the fast Fourier transform FFT by substituting the expression for fin the expression for r 0 . Thus

In 117 the sequence z i is obtained by multiplying the alternative elements of the sequence z i by 1. The DFT of z i in 117 can also be evaluated by the M point fast Fourier transform of z i .

With N N M the correlation values are evaluated over the subsequent N 1 intervals by replacing the subsequence z 1 z 2 . . . z M by the subsequence of z k for the respective interval. The estimate of the average power present during the interval of N samples of z k is obtained by averaging the absolute value squared r over the Nintervals for m 0 1 . . . M 1 i.e. 

In 126 Re denotes the operation of taking the real part of the argument. As the sequence n i is zero mean and independent it follows from 126 that

wherein equation 127 E denotes the expected value operator. From 125 it follows that n 0 and n 0 are uncorrelated and thus due to their Gaussian distribution are independent random variables as

In 132 0 for m 0 1 . . . M 1 are zero mean independent random variables and s 0 is given by 122 . The average power at frequency fis estimated by

In 133 for m 0 1 . . . M 1 are zero mean independent random variables with their variance decreasing inversely with increasing N. The unknown frequency fmay be estimated by maximization of Pover m. However for the case of low SNR and limited number of samples N and thus small N has significant variance resulting in a significant probability of selecting an incorrect value of m and thus causing a relatively large frequency estimation error f f. Moreover even when the value of m is correctly selected there is an estimation error in the range of f 2 and f 2. From 133 the value of s 0 may be only Asin c 0.5 0.4 Awhen fis in the middle of any two of the frequencies fresulting in about a 4 dB loss in signal power compared to the case when the frequency fis equal to one of the frequencies fwhere fis given by 114 . Therefore the probability of selecting an incorrect frequency fis much higher in the case when the unknown frequency falls in between the two frequencies fcompared to the latter case.

In order to minimize the probability of selecting an incorrect frequency f a number Nof frequencies f f . . . f are selected from the set of frequencies f f . . . f defined in 114 with the highest average power Pdefined in equation 133 . The adaptive Kalman filter algorithm described in equations 12 36 is repeated Ntimes with the stored in phase and quadrature observations z k and z k defined in equations 3 and 4 with the initial frequency estimates equal to the f m 0 1 . . . N 1 and with reduced initial prediction error covariance matrix P 0 0 reduced by a factor of the order M. The initial covariance matrix is selected equal to Iwith Idenoting the 2 2 identity matrix. Thus is the variance of the error in the estimates cos 2 f0 f Ts and sin 2 f0 f Ts for the parameters and respectively where fdenotes the true frequency and f denotes the error in the frequency estimate with its variance equal to . With the approximation cos 2 cos 2 2 sin 2 134 

The second equality in 76 follows from the fact that the frequency fitself may have any value in the interval F 2 F 2 and thus the argument of the sin function may lie in the interval resulting in the average for sin equal to 0.5. If the frequency error f can have any value in the interval f 2 f 2 then may be approximated by

In the absence of any initial estimate of the received signal power level A the frequency fcorresponding to the highest value of Pis selected for further processing. However with some estimate of the signal power level A detection is performed on the highest value of Pto eliminate the possibility that none of the frequencies fare close to the true frequency f. The probability of this is a function of M N Nf and the SNR and may be indicated as the highest power out of the M values Pbeing relatively very small.

For the frequency fclose to f the expected value of the corresponding power Pobtained from 136 or from the equations 121 and 133 with fin 121 equal to 0 will be close to P A 2 M. The actual power level may have mean Pwith an error with a variance that is a function of Nand . The actual power will exceed the value Pwith a probability of 0.5. Thus a threshold value Pon the power level Pcan determine whether or not the corresponding frequency fis close to f. However if Pis too high one may miss detecting the correct frequency fwhereas lowering the threshold to a relatively small value may result in a false detection. As an example with A 1 2.5 corresponding to the SNR 0.2 and with M 20 one obtains P 1.25 and a threshold value of P 0.8 may be selected. If the highest value of P m 0 1 . . . M 1 does not exceed P then the sum of the two highest powers Pis compared with the threshold P. If the sum does exceed the threshold Pand the corresponding two frequencies are within f 2 of each other then the frequency with the highest power Pamong the two frequencies is accepted as the correct intermediate estimate of the frequency f. Alternatively the average value of the two frequencies may be taken as the correct intermediate estimate of the frequency f. For the example with P 1.25 a value for Pequal to 1 is selected. However if none of the two threshold conditions are satisfied then the received sequence z k is further processed as follows.

For a specified number of trials N 2 for some integer 0 the steps of correlating the received sampled signal z k with the complex exponential signals with M frequencies f B m f m 0 1 . . . M 1 selecting Nof these frequencies with the highest correlation values running the AKF with each of these Nfrequencies as the initial frequency estimates correlating z k with the Nfinal frequency estimates provided by the AKF and comparing the correlation values with the two thresholds are repeated until the threshold on the correlation value is satisfied or the number of such runs exceeds N. In each such run the M frequencies fdefined in 114 are offset by a different value of f. The offset values of f in different runs are selected from the set of values i f N i 1 2 . . . N 1. However the sequence in which these offset values may be taken may not be in an increasing order. For example with N 2 for an integer the values may be taken in the order 2 2 1 3 . . . 1 3 . . . N 1 f N. For example with N 8 the order is 4 2 6 1 3 5 7 f 8 or

The correlation Pbetween z k and the complex exponential signals with M frequencies f B m f f m 0 1 . . . M 1 can be obtained in terms of generalized FFT as for the case of f 0.

In equation 139 z m m 0 1 . . . M 1 is the DFT of the isegment of length M of the modified signal z k obtained from z k as shown in equation 139 and thus can be evaluated by an FFT algorithm.

Denoting by fthe estimate obtained by the combined FFT and EKF algorithms a further refinement in the estimate is achieved by demodulating the signal z k by the complex exponential signal at frequency fwhich is equivalent to changing the frequency of the signal to f f f averaging the resulting signal over segments of length M and processing the averaged signal by the AKF. Thus

In 141 the signal z k is averaged over M consecutive samples thus reducing the sampling rate to F F M. This is in view of the fact that in the absence of a detection error the frequency estimation error in fis limited in magnitude to f 2 instead of F 2. Thus the sampling rate is reduced by a factor of F f M. The averaging process reduces the noise variance also by the factor M. However the normalized frequency uncertainty f f F lies in the range of and therefore the initial covariance matrix P 0 0 may be set equal to Iwith 3 1 assuming a Gaussian distribution for the initial frequency estimation error with 3 value equal to . In the AKF the sampling time Tis replaced by T MT. The final estimate of the unknown frequency fis given by 142 

where circumflex over f denotes the estimate of the frequency f f f by the AKF. Finally accurate estimates of the amplitude A and phase are obtained by correlating z k with the complex exponential function of frequency circumflex over f . Thus the estimates of the amplitude A denoted by and that of denoted by circumflex over respectively are given by

When the correlation values are input to a cascade of mod square and averaging blocks . . . M 1 to providing the estimated average power P P . . . Ppresent during the Nsamples corresponding to Nblocks of M samples each in the respective passbands of the M FFT filters the FFT transform may be treated as a bank of M FFT filters. Referring to 114 117 the moutput of the FFT block corresponds to shifting the input signal frequency by f B m f and averaging the frequency shifted signal over an interval of M samples. The two operations of frequency shifting and averaging are equivalent to bandpass filtering the signal with a complex bandpass filter of center frequency fand zero crossing bandwidth equal to 2 f and down converting the filtered signal to baseband. The power levels P P . . . Pat the output of M averaging blocks are input to the frequency selector block that selects Nfrequencies from the set of frequencies f m 0 1 . . . M 1 with the highest power levels. The selected frequencies f f . . . f are input to the respective AKF subsystems AKFSS . . . AKFSS N 1 of the stage estimator as the initial frequency estimates for the respective AKFSS . . . N 1.

The block diagram of the adaptive Kalman filter subsystem AKFSS as discussed in reference to may include the matrices given by Q k 1 Iand R k I M Q k 1 Iwith possibly equal to 0 and F k 1 I. With continuing reference to the input signal z k may be read from the memory and provided to a complex to real converter to generate signal z k at the output. The signal z k may be input to the AKF subsystems AKFSS . . . N 1 that also receive the frequencies f f . . . f as the initial frequency estimates with the initial parameter error covariance matrix to all the AKFSSs given by P 0 0 1 M I. The input signal z k k 1 2 . . . Nis processed by the N 1 AKFSSs and may generate the final estimates of frequencies f f . . . f respectively. The reset input Ifrom the algorithm control block may provide the initialization for the AKFSS. At the end of processing by the AKFSSs the frequency estimates f f . . . fmay be provided to correlator blocks corr 0 . . . corr N 1 blocks which are selected via the switch Sfrom the memory . The correlator blocks corr 0 . . . corr N 1 may estimate the average power present in the input signal at the frequencies f f . . . f respectively.

The frequencies f f . . . f along with the estimates of the average power levels P P . . . Ppresent at these frequencies are provided to the frequency selector . The frequency selector selects and outputs the two frequencies fand f with highest average power levels Pand P respectively from the Ninput frequencies. The highest power level Pmay be input to the threshold detector with associated threshold level P. The output of the threshold detector tmay be equal to 1 if P Pand may be 0 otherwise. The sum of Pand Pmay be input to the threshold detector with associated threshold level P. The absolute value of the difference between fand fmay be input to the threshold detector where it may be compared to the resolution frequency fand the output of the threshold detector may be 1 if f f fand 0 otherwise. The outputs of threshold detectors and may be input to an AND gate that has output tequal to 1 if both the inputs are 1 and 0 otherwise. Both the signals tand tmay be provided to the algorithm control block . The frequency fand the average frequency 0.5 f f may be input to a frequency selector . On the command Ifrom the algorithm control block the frequency selector may output one of the two frequencies at the output denoted by f.

Based on the values of tand tthe algorithm control block may generate the signal Iwhich has 3 possible values of 0 1 and 2. Based on I the frequency selector selects frequency fif t 1 selects frequency 0.5 f f if t 0 and t 1 and selects none if both tand tare equal to 0.

If either t 1 or t 1 the first and second steps of the estimator are complete. However if both tand tare equal to 0 the algorithm control block may select a different value of 1 or f 1 f Nand the estimation procedure is repeated until either the threshold condition is satisfied or all of Nvalues of f have been processed. The frequency estimate fat the completion of step and may be taken as the final estimate of the unknown frequency f. However a further refinement in the frequency estimate may be made by the stage of the estimator block .

circumflex over f may control the frequency of a second oscillator that generates the complex exponential signal at frequency circumflex over f which may be input to the second frequency shifter . The other input of the second frequency shifter may be with the complex signal z k . The output of the second frequency shifter may be inputted to an averaging circuit that may average out the Nsamples as the output of the second frequency shifter and generate the output r according to 145 . The output of the averaging circuit may be inputted to the absolute value and the arg blocks respectively to provide the estimate of the amplitude and phase circumflex over respectively of the input signal. When the expected RMS frequency estimation error is not insignificant as may be assessed from the C R bound instead of using the coherent averaging in the estimation of a quasi coherent correlation may be used in the estimation of the amplitude A. A switch not shown at the input of stage estimator may route the input z k to either the first or second frequency shifter as needed by the algorithm control block of .

Referring now to a block diagram of an example correlation block according to embodiments of the disclosure is discussed. The corr m blocks of may be implemented as correlation block of . The complex signal z k may be inputted to a frequency shifter . The other input of the frequency shifter may be connected to the output of an oscillator . The oscillator frequency may be set equal to fas provided by the AKSSS m of . The output of the frequency shifter may be input to a first averaging circuit which may be configured to average the input over an interval of M samples generating rat its output. The output signal rmay be inputted to a block that provides the absolute value squared of the input. The block output r may be inputted to a second averaging circuit that averages out its input over the Nsamples providing the output Paccording to 137a . The reset input Ifrom the algorithm control block of may provide the initialization for the averaging circuits .

The AKF EFT CD algorithm can be applied to the case of the input signal that includes N signals of different frequencies as in 74 . shows the block diagram of the FFT AKF CD estimator for the estimation of multiple frequencies. In a first stage of the estimator the interval f in 114 may be selected so that the minimum spacing among the input frequencies present in the input signal is higher than 2 f and thus M F f is higher than 2N. As for the case of single frequency the average power Pmay be estimated from 114 to 118 for m 0 1 . . . M 1. The number of frequencies Nwith the highest power Pmay be selected for the AKF estimation with N N M wherein a relatively higher value of Nmay result in a relatively small probability of missing any of the input frequencies in the set of Nselected frequencies. The set of frequencies thus selected are denoted by f m 0 1 . . . N 1.

In a second stage of the estimator the AKF algorithm is applied to the signal model described in 74 to 87 with N replaced by Ntherein. In the signal model the N N of the amplitudes Aare zero as the number of frequencies Nselected is higher than N. With f m 0 1 . . . N 1 denoting the final frequency estimates obtained by the AKF corresponding to the Ninitial frequencies f the average power Pat these frequencies is evaluated by equation 136 . The N frequencies with the highest power estimates Pare selected as the frequency estimates are obtained. However if any two frequency estimates are within the resolution frequency fof each other with fequal to a predetermined fraction of f then these two estimates are considered to be the estimates of a single frequency out of the N frequencies. The two such frequency estimates are averaged to provide the overall estimate of the frequency with the corresponding power estimates added to obtain the overall estimate of the power at that frequency. After such a combining of the powers the N frequencies with the highest power estimates are selected as the N frequency estimates form the step of the algorithm.

As an option a threshold on the estimates of the power levels of the individual frequencies or a threshold on the total power in all of the N frequencies may be performed as for the case of single frequency estimation. If the threshold condition is not satisfied then the procedure may be repeated with the M frequencies f B m f m 0 1 . . . M 1 offset by 1 f 2 for a selected integer . with the offset integer taking possible values 1 2 . . . 2 1 as for the case of the single frequency estimation to obtain a new set of initial frequencies f m 0 1 . . . N 1 running the AKF algorithm with these new estimates and obtaining the frequency estimates f m 0 1 . . . N 1 and selecting N frequencies out of the Nestimates based on their power estimates. The procedure may be repeated with different values of the offset integer i until the threshold condition is satisfied or all the 2 1 values of 1 are exhausted.

In the third stage N estimator the estimates fof each of the N frequencies obtained from the second stage are further individually refined. In this step the signal z k may be multiplied by complex exponential function of frequency fand the product averaged over an interval of M F f samples as in 140 141 to obtain the averaged signal z k that is applied to the AKF algorithm with the dimension of the state vector equal to 2 to obtain the estimate circumflex over f of the residual frequency fthat is equal to the error in the frequency estimate. The final frequency estimate is given by 145 similar to the estimate in 142 for the single frequency case. 1 2 . . . 145 

In the estimation of multiple frequencies the signal z k may be segmented into multiple signals by a polyphase filter or the bank of FFT filters as in 94 96 and the AKF FFT CD algorithm is applied to each of these segments to reduce the dimension of the state vector in the AKF algorithm and thus the computational requirements.

Simulation results are presented first for the case when the refinement step of frequency translation and decimation in equations 140 and 141 followed by the application of the AKF to the resulting signal is not performed. Instead the estimate based on selecting one of the Nestimates obtained by the AKF on the basis of the correlation detection performed on these estimates is used as the final estimate. shows an example in phase component of the received complex signal z k with amplitude 1 volt and frequency of 121.2 Hz with an SNR of 5 dB that appears like noise because the noise power is 3 times higher than the signal power. The AKF FFT CD algorithm is applied for the estimation of the frequency and amplitude with the number of simulation runs equal to 100 with the initial covariance matrix equal to 4 Ias in the previous examples corresponding to the frequency range of 200 200 Hz. The value of M is selected equal to 20. shows a plot of the frequency estimation error at the end of 80 samples for the 100 simulation runs corresponding to a cumulative SNR defined as 10 log N of 14 dB. The RMS frequency error from the 100 simulation runs is equal to 1.23 Hz compared to 0.4 Hz from the C R bound. plots the amplitude estimates obtained from equation 143 for the 100 simulation runs.

The estimation error can be further reduced by including the frequency translation and decimation step in 140 and 141 followed by the application of the AKF on the resulting signal. plots the magnitude of the frequency estimation error for the case of SNR 10 dB after processing 280 samples corresponding to equal to 14.5 dB. The signal frequency selected randomly was 42.6 Hz for this case. There is no outlier in this case. The RMS frequency estimation error for this case is equal to 0.74 Hz. Examination of shows that unlike the case of Gaussian distribution some of the errors are much higher than 3 0.74 2.2 Hz. For a Gaussian distribution with RMS value of 0.74 Hz the probability of having a value with its magnitude higher than 2.2 Hz is 0.0026 and thus among 100 simulation runs the expected number of runs with the magnitude of the estimation error exceeding 2.2 Hz is 0.26. If the simulation runs with the magnitude of the estimation error exceeding 7 times the C R bound of 0.11 Hz is excluded from the statistics then the resulting RMS error is only 0.12 Hz for the 93 runs. shows the magnitude of the estimation error for those simulation runs for which the estimation error is less than 7 times the C R bound of f 0.11. Thus except for a few simulation runs the RMS estimation error is very close to the C R bound. With the increase in the number of samples Nthe number of simulation runs for which the error exceeds 7fis expected to reduce.

A frequency estimation system is one of the most important subsystems of communication navigation radar and various other engineering systems. In some cases the efficient and precise estimation may be the critical component in the system design and may significantly limit the performance of these systems with respect to various metrics of performance. For example in application to high dynamic GPS receivers the ability to acquire and track the GPS carrier signal under dynamic conditions limits the performance and applicability of these receivers to various important applications. The present disclosure can drastically increase the performance capability of such systems over the existing ones.

In terms of communication systems precise frequency and phase of the carrier are important in communication systems involving coherent modulation techniques such as MQAM and MPSK. In traditional communication applications either the techniques that use square law loops or Costas type loops are used to derive the carrier frequency and phase from the modulated signal or a pilot signal is used which is tracked. The use of square law loops or Costas type loops results in significant loss in terms of phase noise of the reference carrier and phase ambiguity problems wherein there is phase ambiguity in the carrier phase equal to integer multiple of 2 M for an MPSK signal. The use of pilot carrier results in a loss of signal power because a significant part of available power is used up in the pilot. The ability to provide fast and accurate frequency and phase estimates at very low SNRs can reduce the loss due to pilot carrier to an insignificant value. For example with the pilot signal 10 dB below the modulated signal power the loss is only 0.45 dB operation at 14 dB below results in only 0.17 dB loss compared to a loss of 1 3 dB in a traditional system. These numbers are based on the assumption that the carrier frequency uncertainty is nearly equal to the modulation signal bandwidth.

More recently precise and fast frequency acquisition and tracking have become very important with the evolution of the OFDM Orthogonal Frequency Division Multiplexing in mobile communication systems. The OFDM modulation scheme offers several advantages. For example it has reduced problems of inter symbol interference ISI caused by multipath propagation. It has superior performance in selective fading environments. Due to these advantages OFDM has become part of various important standards such as WiMax. However because the OFDM is based on the orthogonality among various subcarrier signals it is very important that this orthogonality be maintained when these subcarriers are received at the receiver. However the mobile wireless channels introduce frequency offsets which cause the disruption of the orthogonality among the subcarriers resulting in mutual interference among the various subcarriers. Therefore it is very important to precisely estimate such frequency offsets and correct them to avoid the problem of intercarrier interference. The offsets may be functions of time and may be different for different subcarriers. Thus it is necessary that precise estimation of the frequency offset be made with minimum requirements on the estimation time and SNR which is also limited in systems involving error correction coding techniques. The disclosure can virtually eliminate the need for pilot carriers that are provided for the purpose of estimating the carrier offsets resulting in increased efficiency and yet are capable of providing precise estimates for these offsets.

In various radar systems for example in Doppler and FM chirp radars the ability to provide accurate acquisition and tracking in very low SNR conditions can result in a drastic reduction in transmit power resulting in quiet radar. In certain embodiments the systems and methods disclosed herein may be applied to various multi tracking applications including but not limited to RADAR multi target tracking SONAR multi target tracking LIDAR multi target tracking or combinations thereof. The above only provides a few examples where the disclosure can be exploited. The disclosure can be exploited in diverse applications including satellite communication terrestrial wireless communication digital TV radars broadcasting radio astronomy aeronautical and space systems structural vibrations seismology general instrumentation etc.

In general it will be apparent that the embodiments described herein may be implemented in many different embodiments of software firmware and or hardware for example based on Field Programmable Gate Array FPGA chips or implemented in Application Specific Integrated Circuits ASICS . The software and firmware code may be executed by a computer or computing device comprising a processor e.g. a DSP or any other similar processing circuit including for example the computing device described below. The processor may be in communication with memory or another computer readable medium comprising the software code. The software code or specialized control hardware that may be used to implement embodiments is not limiting. For example embodiments described herein may be implemented in computer software using any suitable computer software language type using for example conventional or object oriented techniques. Such software may be stored on any type of suitable computer readable medium or media such as for example a magnetic or optical storage medium. According to various embodiments the software may be firmware stored at an EEPROM and or other non volatile memory associated with a DSP or other similar processing circuit. The operation and behavior of the embodiments may be described without specific reference to specific software code or specialized hardware components. The absence of such specific references is feasible because it is clearly understood that artisans of ordinary skill would be able to design software and control hardware to implement the embodiments based on the present description with no more than reasonable effort and without undue experimentation.

In the example of the computing device comprises one or more processor circuits or processing units one or more memory and or storage circuit component s and one or more input output I O devices . Additionally the computing device comprises a bus that allows the various circuit components and devices to communicate with one another. The bus represents one or more of any of several types of bus structures including a memory bus or memory controller a peripheral bus an accelerated graphics port and a processor or local bus using any of a variety of bus architectures. The bus may comprise wired and or wireless buses.

The processing unit may be responsible for executing various software programs such as system programs application programs and or program modules blocks to provide computing and processing operations for the computing device . The processing unit may be responsible for performing various voice and data communications operations for the computing device such as transmitting and receiving voice and data information over one or more wired or wireless communications channels. Although the processing unit of the computing device is shown in the context of a single processor architecture it may be appreciated that the computing device may use any suitable processor architecture and or any suitable number of processors in accordance with the described embodiments. In one embodiment the processing unit may be implemented using a single integrated processor. The processing unit may be implemented as a host central processing unit CPU using any suitable processor circuit or logic device circuit such as a general purpose processor. The processing unit also may be implemented as a chip multiprocessor CMP dedicated processor embedded processor media processor input output I O processor co processor microprocessor controller microcontroller application specific integrated circuit ASIC field programmable gate array FPGA programmable logic device PLD or other processing device in accordance with the described embodiments.

As shown the processing unit may be coupled to the memory and or storage component s through the bus . The bus may comprise any suitable interface and or bus architecture for allowing the processing unit to access the memory and or storage component s . Although the memory and or storage component s may be shown as being separate from the processing unit for purposes of illustration it is worthy to note that in various embodiments some portion or the entire memory and or storage component s may be included on the same integrated circuit as the processing unit . Alternatively some portion or the entire memory and or storage component s may be disposed on an integrated circuit or other medium e.g. hard disk drive external to the integrated circuit of the processing unit . In various embodiments the computing device may comprise an expansion slot to support a multimedia and or memory card for example.

The memory and or storage component s represent one or more computer readable media. The memory and or storage component s may be implemented using any computer readable media capable of storing data such as volatile or non volatile memory removable or non removable memory erasable or non erasable memory writeable or re writeable memory and so forth. The memory and or storage component s may comprise volatile media e.g. random access memory RAM and or non volatile media e.g. read only memory ROM Flash memory optical disks magnetic disks and the like . The memory and or storage component s may comprise fixed media e.g. RAM ROM a fixed hard drive etc. as well as removable media e.g. a Flash memory drive a removable hard drive an optical disk . Examples of computer readable storage media may include without limitation RAM dynamic RAM DRAM Double Data Rate DRAM DDRAM synchronous DRAM SDRAM static RAM SRAM read only memory ROM programmable ROM PROM erasable programmable ROM EPROM electrically erasable programmable ROM EEPROM flash memory e.g. NOR or NAND flash memory content addressable memory CAM polymer memory e.g. ferroelectric polymer memory phase change memory ovonic memory ferroelectric memory silicon oxide nitride oxide silicon SONOS memory magnetic or optical cards or any other type of media suitable for storing information.

The one or more I O devices allow a user to enter commands and information to the computing device and also allow information to be presented to the user and or other components or devices. Examples of input devices include data ports analog to digital converters ADCs digital to analog converters DACs a keyboard a cursor control device e.g. a mouse a microphone a scanner and the like. Examples of output devices include data ports ADCs DACs a display device e.g. a monitor or projector speakers a printer a network card . The computing device may comprise an alphanumeric keypad coupled to the processing unit . The keypad may comprise for example a QWERTY key layout and an integrated number dial pad. The computing device may comprise a display coupled to the processing unit . The display may comprise any suitable visual interface for displaying content to a user of the computing device . In one embodiment for example the display may be implemented by a liquid crystal display LCD such as a touch sensitive color e.g. 76 bit color thin film transistor TFT LCD screen. The touch sensitive LCD may be used with a stylus and or a handwriting recognizer program.

The processing unit may be arranged to provide processing or computing resources to the computing device . For example the processing unit may be responsible for executing various software programs including system programs such as operating system OS and application programs. System programs generally may assist in the running of the computing device and may be directly responsible for controlling integrating and managing the individual hardware components of the computer system. The OS may be implemented for example as a Microsoft Windows OS Symbian OS Embedix OS Linux OS Binary Run time Environment for Wireless BREW OS JavaOS or other suitable OS in accordance with the described embodiments. The computing device may comprise other system programs such as device drivers programming tools utility programs software libraries application programming interfaces APIs and so forth.

In various embodiments disclosed herein a single component may be replaced by multiple components and multiple components may be replaced by a single component to perform a given function or functions. Except where such substitution would not be operative such substitution is within the intended scope of the embodiments.

While various embodiments have been described herein it should be apparent that various modifications alterations and adaptations to those embodiments may occur to persons skilled in the art with attainment of at least some of the advantages. The disclosed embodiments are therefore intended to include all such modifications alterations and adaptations without departing from the scope of the embodiments as set forth herein.

Embodiments may be provided as a computer program product including a non transitory machine readable storage medium having stored thereon instructions in compressed or uncompressed form that may be used to program a computer or other electronic device to perform processes or methods described herein. The machine readable storage medium may include but is not limited to hard drives floppy diskettes optical disks CD ROMs DVDs read only memories ROMs random access memories RAMs EPROMs EEPROMs flash memory magnetic or optical cards solid state memory devices or other types of media machine readable medium suitable for storing electronic instructions. Further embodiments may also be provided as a computer program product including a transitory machine readable signal in compressed or uncompressed form . Examples of machine readable signals whether modulated using a carrier or not include but are not limited to signals that a computer system or machine hosting or running a computer program can be configured to access including signals downloaded through the Internet or other networks. For example the distribution of software may be an Internet download.

Although embodiments have been described in language specific to structural features and or methodological acts it is to be understood that the disclosure is not necessarily limited to the specific features or acts described. Rather the specific features and acts are disclosed as illustrative forms of implementing the embodiments. Conditional language such as among others can could might or may unless specifically stated otherwise or otherwise understood within the context as used is generally intended to convey that certain embodiments could include while other embodiments do not include certain features elements and or steps. Thus such conditional language is not generally intended to imply that features elements and or steps are in any way required for one or more embodiments or that one or more embodiments necessarily include logic for deciding with or without user input or prompting whether these features elements and or steps are included or are to be performed in any particular embodiment.

