---

title: Biometric authentication of mobile financial transactions by trusted service managers
abstract: A method for authenticating a financial transaction at a point of sale (POS) includes storing an application program in a first secure element of a mobile phone. The application is configured to generate instruction codes to effect the financial transaction upon verification of a user's identity. The user's credentials are stored in a second SE of the phone, which is operable to verify the user's identity from a biometric trait of the user input to the phone and to generate data authenticating the financial transaction in response to the verification of the user's identity. At the POS, the user invokes the application and then inputs a biometric trait to the phone. The second SE verifies the user's identity, and upon verification, generates data authenticating the transaction. The financial transaction data, including the instruction codes and the authenticating data, are then transmitted from the phone to the POS.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08554689&OS=08554689&RS=08554689
owner: eBay Inc.
number: 08554689
owner_city: San Jose
owner_country: US
publication_date: 20120312
---
This application is a continuation of U.S. application Ser. No. 12 414 323 filed Mar. 30 2009 now U.S. Pat. No. 8 150 772 Apr. 3 2012 and claims the benefit of U.S. Provisional Application Nos. 61 059 395 and 61 059 907 filed Jun. 6 2008 and Jun. 9 2008 respectively the respective disclosures of which are incorporated herein by reference.

This disclosure relates to electronic financial transactions in general and more particularly to methods and systems for biometric authentication of financial transactions by a trusted service manager TSM .

 Contactless technology refers to short distance communications between two devices that are not physically connected. A wide variety of contactless technology exists today. Near Field Communication NFC is a specific type of contactless technology that is of high importance to Mobile Network Operators MNOs and to Service Providers SPs such as banks credit card issuers and other payment service providers. NFC is a short range high frequency wireless RF communication technology that enables the exchange of data between devices typically over about a 10 centimeter or about 4 inches distance thus providing a fast simple and secure way for a user to effect a wide range of contactless services with a mobile device such as a mobile telephone or personal digital assistant PDA .

One example of an NFC technology application is financial transactions. NFC mobile devices and other types of contactless devices such as radio frequency enabled credit debit cards key fobs and the like are experiencing rapid growth worldwide in various industries including transportation retail parking and other industries that will now accept NFC mobile payments and other types of contactless payments.

As an example wireless mobile devices that include an NFC device and a smart card which can use radio frequency identification RFID technology for identification purposes can enable a person to effect a simple financial transaction such as the purchase of a retail item in a convenient secure manner. Typically a consumer waves the wireless mobile NFC device near a reader to effect a monetary transfer and the purchase price of the item is deducted from a total amount that is available and stored on a smart card of the wireless mobile device. Optionally the amount of the item can be forwarded to a server that can identify the purchaser through a unique identification code of the purchaser and then subsequently debit a credit or deposit account of the purchaser appropriately for the purchase of the retail item. Such NFC based point of sale POS transactions provide several advantages such as eliminating the need to carry cash and enabling faster more convenient and secure financial transactions.

Because customers are interested in being able to use their mobile devices for contactless services a new mobile NFC ecosystem illustrated in has been defined by the Global System for Mobile communication Association GSMA which is a global trade association representing over 700 GSM mobile phone operators throughout the world. See e.g. Mobile NFC Services GSMA Version 1.0 February 2007 . As illustrated in such ecosystems involve a variety of different players or entities and new roles for such players including 

As will be appreciated successful implementation of NFC technologies requires cooperation between the many disparate players of the GSMA ecosystem. Each player can have its own expectations for example the Customer expects convenient friendly and secure services within a trusted environment the SPs want their applications to be housed and used in as many mobile devices as possible and the MNOs want to provide new mobile contactless services that are secure of high quality and consistent with the existing services experienced by the Customer. But although each player can have its own culture and expectations they all have the same basic requirement viz. the need for security and confidentiality.

The Trusted Service Manager TSM in particular brings trust and convenience to the complex multi player NFC ecosystem. The TSM role includes providing a single point of contact for the SPs e.g. banks to access their respective customer bases through the MNOs and to secure download and lifecycle management for mobile NFC applications on behalf of the SPs. It should be understood that the TSM does not disrupt the SP s business model as the TSM does not participate directly in the transaction stage of the service but rather only indirectly.

In addition to NFC based POS payments there are a number of other payment models currently prevalent in the mobile industry including 

 i Short Message Service SMS SMS is a communications protocol that allows the interchange of short text messages between mobile devices and 

 ii Mobile Internet based payments Customers routinely search for and purchase products and services through electronic communications with online merchants over electronic networks such as the Internet.

Regarding the latter individual customers may frequently engage in transactions with a variety of merchants through for example various merchant websites. Although a credit card can be used for making payments over the Internet a disadvantage of online credit card usage is that online merchants can be exposed to high fraud costs and chargeback fees because there is no credit card authentication signature with an online sale.

In the case of in person POS payments made with payment cards such as with Master Cards or Visa cards in the U.S. or a Chip and PIN card in the U.K. current authentication is by means of the purchaser s provision of a signature or a personal identification number PIN .

Accordingly systems and methods are needed for authenticating NFC based POS transactions securely and reliably without the need for signatures or PINs and more particularly for authentication of POS transactions using a biometric trait such as a fingerprint that can be input via a data communication device of the user e.g. the user s mobile phone.

In accordance with the present disclosure methods and apparatus are provided that enable the authentication of financial transactions to be indirectly effected as a value added service by a service provider acting as a TSM for credit payment provider companies in which biometric authentication data of the transactions is provided directly at the POS via an NFC enabled mobile telephone without the need for the credit payment providers having to provide it.

In one embodiment a method for authenticating a financial transaction at a point of sale POS includes storing an application program in a first secure element SE of a mobile phone equipped with a user biometric trait input device. The application program is configured to generate instruction codes to effect the financial transaction upon verification of a user s identity. The credentials of the user are stored in a second SE of the phone which is operable to verify the user s identity from a biometric trait of the user input to the phone and to generate data authenticating the financial transaction in response to the verification of the user s identity.

At the POS the user activates the phone invokes the application program thereon and inputs a biometric trait to the phone e.g. swipes a thumb on a fingerprint reader of the phone. The second SE verifies the user s identity from the biometric trait input to the phone and upon such verification generates data authenticating the transaction. The data of the financial transaction including the instruction codes therefor and the data authenticating the financial transaction are then transmitted from the phone to a data communication device at the POS which in one embodiment can be effected via a NFC link between the phone and the POS device.

One or more of the storing of the application program in the first SE the storing of the user s credentials in the second SE and the generating of the data authenticating the transaction in response to the verification of the user s identity can comprise a value added service performed by a trusted service manager TSM on behalf of a third party credit or a payment service provider.

A better understanding of the above and many other features and advantages of the novel TSM transaction authentication systems and methods of the present disclosure can be obtained from a consideration of the detailed description of some example embodiments thereof below particularly if such consideration is made in conjunction with the several views of the appended drawings wherein like elements are referred to by like reference numerals throughout.

In accordance with the embodiments described herein methods and systems are provided that enable financial service providers such as PayPal acting in the role of a Trusted Service Manager TSM to authenticate NFC based POS transactions using biometric identifier traits such as a fingerprint that can be input via a data communication device of the user.

The client device can be implemented using any appropriate combination of hardware and or software configured for wired and or wireless communication over a network. For example in one embodiment the client device can be implemented as a personal computer of a user also referred to herein as a customer or consumer in communication with the Internet or another network such as a public switched telephone network PSTN and or a private data network. In other embodiments the client device can be implemented as a wireless telephone personal digital assistant PDA key fob smart card notebook computer or other type of data communication device. Furthermore the client device can be enabled for NFC Bluetooth online infrared communications and or other types of wireless data communication channels.

The client device can include various applications as might be desired in particular embodiments to provide desired features to the client device . Such applications could include for example security applications for implementing client side security features programmatic client applications for interfacing with appropriate application programming interfaces APIs over a network or other types of applications.

The client device can further include one or more user identifiers that could be implemented for example as operating system registry entries cookies associated with a browser application identifiers associated with hardware of client device or other appropriate identifiers. In one embodiment a user identifier can be used by a payment service provider to associate the client device or the user with a particular account maintained by a payment service provider such as PayPal as described in more detail below.

Of importance the client device can further include a device useful for biometric authentication such as a integral fingerprint scanner. Increasingly today mobile phones are being equipped with such devices. When the phone is flipped or activated the biometric trait reader reads the fingerprint of the user confirms the identity of the user from the biometric trait and upon confirmation of the user s identity unlocks a credential payment instrument located in one or more Secure Element s incorporated in the phone. As discussed in more detail below when the phone is then tapped on an NFC enabled POS an authenticated payment is effected via the user s biometric data input to the phone.

The merchant server could be maintained for example by a retailer or by an online merchant offering various products and or services in exchange for payment to be received over a network such as the Internet. The merchant server can be configured to accept payment information from the user via for example the client device and or from a payment service provider over a network. It should be appreciated that although a user merchant transaction is illustrated in this particular embodiment the system can also be applicable to user user merchant merchant and or merchant user transactions.

The merchant server can use a secure gateway to connect to an acquirer . Alternatively the merchant server can connect directly with the acquirer or a processor . Once verified the acquirer which can also have a relation or subscription with the payment service provider processes the transaction through the processor or the payment service provider . Brands for example bank payment card issuers which also have a relation or subscription with the payment service provider are then also involved in the payment transaction so as to enable the user to complete the purchase.

The payment service provider can have data connections and with a subscriber client device a subscriber acquirer a subscriber processor and or a subscriber brand respectively to communicate and exchange data. Such data connections and can take place for example via the Short Message Service SMS or a Wireless Application Protocol WAP over a network. In addition according to one or more embodiments the payment service provider can have a data connection with subscriber Internet companies Internet mortgage companies Internet brokers or other Internet companies .

The payment service provider which can be an online payment provider can provide payment on behalf of the user to the operator of the merchant server via the network . In this regard the payment service provider includes one or more payment applications that can be configured to interact with the client device and or the merchant server over the network to facilitate the purchase of items by the user from the merchant server . In one embodiment the payment service provider can be provided by PayPal.

Each of the client data communication device the merchant server and the payment service provider can include one or more processors memories and other appropriate components for executing instructions such as program code and or data stored on one or more computer readable mediums to implement the various applications data and methods described herein. For example such instructions can be stored in one or more computer readable media such as memories or data storage devices internal and or external to various components of the system and or accessible over a network which can be implemented as a single network or a combination of multiple networks for example the Internet or one or more intranets landline networks wireless networks and or other appropriate types of networks.

As discussed above the payment service provider can also serve in the role of a Trusted Service Manager TSM . In one example embodiment of this the payment service provider acting in the role TSM can work cooperatively with a Mobile Network Operator MNO to incorporate an authentication certificate issued by the payment service provider acting as a Certificate Authority CA in a Secure Element SE or Subscriber Identity Module SIM card of a client device . This SE or SIM card can follow security guidelines such as The Federal Information Processing Standard FIPS Publication 140 2 FIPS 140 2 Level 2 3 a U.S. government computer security standard issued by the National Institute of Standards and Technology NIST and used to accredit cryptographic modules. The client device can already have payment service provider issued certificates and user biometric trait information such as the user s digitized fingerprint stored within it for personalization purposes. When customers or users activate their payment service provider application such as a PayPal payment application which can also be incorporated in the client device in an application SE the users or customers are asked to select a PIN which can be optional or mandatory. The PIN protects the private key of the authenticating certificate.

When a transaction for example a financial transaction using NFC service application of an NFC enabled client device is made via a payment service provider such as PayPal the service provider receives signature information in the form of for example a X.509 certificate. X.509 is an ITU T standard for a public key infrastructure PKI for single sign on and Privilege Management Infrastructure PMI . This X.509 signature information is typically maintained for each registered user of the service provider . The signature information can be a digital signature and can include a time stamp dollar amount transaction type item and even location which can be determined from a GPS enabled client device . Signature information can also be preloaded in client device in for example other applications such as EMV Europay MasterCard Visa a standard for interoperation of IC cards Chip cards and IC capable POS terminals and ATM s for authenticating credit and debit card payments or Elliptic Curve Cryptography ECC another form of public key cryptography in addition to X.509. In addition to NFC the client device can also be enabled for e.g. Bluetooth infrared or other types of communications and or transactions.

The initial set up or programming of the Payment Wallet SE needs to be done only once and can be performed at the premises of the TSM or alternatively over the air OTA . Likewise new or updated applications can be uploaded to the Applications SE of the phone either locally or OTA.

In one advantageous embodiment the Payment Wallet SE can also be configured to store a list of transactions or account or receipt management information that can be viewed by the user at will on the phone and or downloaded to a PC for integration with the user s money management tools such as Quicken Microsoft Money dedicated toolbars or other PC software such as expense management and expense submission tools and flexible spending account submissions.

As discussed above current authentication of transactions via payment cards is typically by way of a user s signature or PIN. In Europe authentication can also be via Chip and PIN . However as illustrated in in accordance with the present disclosure the authentication of financial transactions such as at a POS can be indirectly effected as a value added service by a service provider acting as a TSM for credit payment provider companies such as MasterCard and Visa in which POS biometric authentication occurs directly via the mobile phone . This biometric authentication can serve as signature PIN Chip and PIN ARQC ARPC authentication for all transactions. The authenticated transaction is then submitted to the POS device via the NFC link between the NFC communication module of the phone and the POS device . The POS device receives the transaction as a pre verified or pre authenticated request and in turn transmits it to the host processor for further processing in the form of an ISO 8583 message containing a Card Verification Value CVV code or a Contactless Card and Chip Verification iCVV code field and other information such as a Stored Value Card SVC code and or a bank identification number BIN code. Thus a user s initial input of a biometric trait via the input device can be used both to unlock the phone and to authorize financial transactions without the need for the credit payment providers having to do so.

After the initial registration of the user with the TSM is complete during which step S the Payment Wallet SE of the phone is programmed with the user s credentials and the Application SE of the phone is programmed with one or more suitable financial transaction application programs the phone is then ready for use in making authenticated financial transactions. In an example purchase transaction at a POS such as illustrated in the user in the role of a purchaser can at S first activate the phone e.g. by opening it. At S the user can then select a Make Payment button on the phone . Selecting the Make Payment button invokes a suitable payment application program in the Application SE of the phone that is adapted to among other things read a biometric trait of the user e.g. the user s thumb print and request verification of it by the Payment Wallet SE .

At S the user purchaser then swipes his or her thumb on the biometric trait input device of the phone and at S this biometric trait input is fed directly to the Payment Wallet SE of the phone via a tunnel circuitry . Optionally the thumb swipe can also be operable to unlock the phone for use. Preferably a tunnel circuit is used for security purposes because the architecture of the user s fingerprint is such that it can otherwise be captured by an application on a mobile phone. To prevent this a tunnel encryption circuitry that is FIPS 140 2 level 3 compliant is incorporated in the phone so that the fingerprint data goes directly to the Payment Wallet SE of the phone for authentication and unlocking.

At S the payment application that was invoked by pressing the Make Payment button sends a message to the Payment Wallet SE requesting user verification and payment authentication. At S when the Payment Wallet SE verifies the user s thumbprint and based thereon authenticates the payment the Payment Wallet SE sends the authenticated payment or other instructions back to the payment application which then sends it to the NFC communication module of the phone .

At S when the user then taps the phone on the merchant s POS device the pre authenticated payment instructions are transmitted via an NFC link to the POS device and thence to the merchant s processor device . As above the payment instructions include not only all of the payment information needed to effect the transaction such as the user s account information or credit balance but also all of the information necessary to authenticate the transaction including CVV iCVV SVC and or BIN codes without the need for the credit payment service providers having to provide it.

As those of skill in this art will appreciate although the foregoing method is described in the context of a transaction involving a purchase of goods or services at a POS it is evident that it can be made applicable to other types of financial transactions such as the deposit or withdrawal of cash at an automated teller machine ATM .

Although various components and steps have been described herein as being associated with the client device merchant server and payment service provider of it is contemplated that the various aspects of such servers illustrated in can be distributed among a plurality of servers devices and or other entities. For example in one embodiment transaction record processing application and transaction records can be implemented by an entity separate from payment service provider . Accordingly in such an embodiment communications described herein performed in relation to transaction record processing application and transaction records can be provided to a separate entity and need not be routed through payment service provider in all instances.

Where applicable various embodiments provided by the present disclosure can be implemented using hardware software or combinations of hardware and software. Also where applicable the various hardware components and or software components set forth herein can be combined into composite components comprising software hardware and or both without departing from the spirit of the present disclosure. Where applicable the various hardware components and or software components set forth herein can be separated into sub components comprising software hardware or both without departing from the spirit of the present disclosure. In addition where applicable it is contemplated that software components can be implemented as hardware components and vice versa.

Software in accordance with the present disclosure such as program code and or data can be stored on one or more computer readable media. It is also contemplated that software identified herein can be implemented using one or more general purpose or specific purpose computers and or computer systems networked and or otherwise. Where applicable the ordering of various steps described herein can be changed combined into composite steps and or separated into sub steps to provide the features described herein.

The foregoing disclosure is not intended to limit the present disclosure to the precise forms or particular fields of use disclosed. It is contemplated that various alternate embodiments and or modifications to the present disclosure whether explicitly described or implied herein are possible in light of the disclosure.

Although the apparatus and methods of the present invention have been described and illustrated herein with reference to certain specific example embodiments thereof it should be understood that a wide variety of modifications and variations can be made to these without departing from the spirit and scope of the invention as defined by the claims appended hereafter and their functional equivalents.

