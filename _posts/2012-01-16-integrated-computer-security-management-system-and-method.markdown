---

title: Integrated computer security management system and method
abstract: The present disclosure is generally directed to a computer security management system that integrates a firewall with an intrusion detection system (IDS). In other words, the firewall and IDS of the present disclosure can be designed to communicate process or status information and packets with one another. The present disclosure can facilitate centralized control of the firewall and the IDS and can increase the speed at which packets are passed between a secured computer network and an external network. Increased packet processing speed can be achieved in several ways. For example, the firewall and IDS can process packets in series, in parallel, and sometimes singularly when one of the components is not permitted to process a packet. Alternatively, singular processing can also be performed when one component is permitted to pass a packet to the secured computer network without checking with the other component.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08701176&OS=08701176&RS=08701176
owner: Dell Products, LP
number: 08701176
owner_city: Round Rock
owner_country: US
publication_date: 20120116
---
This application is a continuation of U.S. patent application Ser. No. 12 001 465 entitled Integrated Computer Security Management System and Method filed on Dec. 11 2007 which is a continuation of U.S. patent application Ser. No. 09 949 095 filed on Sep. 7 2001 now U.S. Pat. No. 7 331 061 issued on Feb. 12 2008 the disclosures of which are hereby expressly incorporated by reference in their entirety.

The present disclosure generally relates to a computer security management system that can comprise a firewall integrated with an intrusion detection system IDS or an AVS or a combination thereof.

Electronic commerce eCommerce in today s global economy demands greater access to information and avenues of communication among customers business partners suppliers employees and friends. Any person or business that uses the Internet to achieve global communication must implement significant safeguards to protect digital information assets available in a secured computer network or else risk leaving private stores of digital information in the secured computer network vulnerable to intrusion.

Currently conventional safeguards for secured computer networks typically include stand alone firewalls manufactured by a first party that can route information to one or more stand alone intrusion detection systems IDSs and one or more anti virus systems AVSs . The stand alone IDSs and AVSs are usually designed by second parties that are not affiliated with the firewall manufacturer. Such a conventional safeguard utilizing a combination of firewalls IDSs and AVSs for a secured computer network typically processes packets of information in either a parallel manner or a serial manner. That is for serial processing a packet of information sent to or originating from a secured network can be first processed by a firewall then processed by an IDS and or an AVS before the packet is allowed to enter or leave the secured computer network.

Opposite to the serial configuration another conventional safeguard can be set up such that the stand alone firewall the stand alone IDS and the stand alone AVS each process the packet at the same time or in a parallel manner. However regardless of whether a packet is processed in a parallel manner or in a serial manner by a firewall an IDS and an AVS the conventional art typically requires an independent decision from the firewall the IDS and the AVS before the packet is allowed to pass into or out of a secured computer network. Such a design that waits for separate processing to be completed by a stand alone firewall a stand alone IDS and a stand alone AVS consumes invaluable time that is critical to any type of distributed computer network where speed is both a priority and a necessity.

The processing speed of the conventional safeguards can be hampered by the interfaces needed to link stand alone firewalls and stand alone IDSs. Since conventional safeguards comprise stand alone firewalls and stand alone IDSs are manufactured by different vendors rather complex interfaces are needed to pass packets entering a firewall destined for an IDS. Further in such an environment each stand alone system whether it be a firewall or an IDS will typically have its own packet acquisition engine. Communication between the stand alone firewalls and the stand alone IDSs can be achieved through a combination of published application programming interfaces APIs industry standard protocols and high level scripting languages.

Beneath the APIs needed to connect the firewalls to IDSs are often intricate protocols and networking made by the stand alone application developers. In addition to requiring rather complex interfaces and communications to be established between stand alone firewalls stand alone IDSs and stand alone AVSs conventional systems do not permit simple or rapid upgrades for simultaneous harmonious configuration of both a stand alone firewall a stand alone IDS and a stand alone AVS. In other words the conventional art does not promote simple and efficient upgrade configurations to optimize an interfaced security solution that can comprise a stand alone firewall a stand alone IDS and a stand alone AVS. Often separate configurations will be required for each stand alone system because stand alone systems will typically have different protocols command languages and hardware components.

Related to the problems of the rather complex communication interfaces needed between a stand alone firewall IDS and AVS is that each stand alone system is typically unaware of the calculations or decisions made by the opposing stand alone system. In other words a stand alone IDS or AVS are typically not aware of the calculations or decisions made by its complimentary stand alone firewall. Frequently a stand alone IDS or AVS will not receive any information such as packets from a stand alone firewall if the stand alone firewall determines that the packet violates one or more of its rules. When packets are not evaluated by each stand alone system potential important information about a particular packet may not be discovered by the security manager of a secured computer network because one stand along system may prevent information from reaching another respective stand alone system.

Stated differently when a stand alone firewall drops a packet this packet is typically dropped completely and not forwarded to the stand alone IDS or AVS. Because the packet is not processed by the stand alone IDS or AVS a security manager of a secured computer network may never know or learn that the dropped packet may have also matched an intrusion detection signature or virus. Such a potential match that could be discovered by an IDS or AVS could be an important element in the evaluation of packets for security threats. For example it could be determined that a particular packet may be part of a larger security incident such as an integrity attack a confidentiality attack a denial of service attack a multi stage attack or another similar attack on the secured computer network from users outside or inside of the secured computer network.

Accordingly there is a need in the art for a method and system for managing security information for an entire secured computer network. That is there is a need in the art for a computer security management system that can integrate a firewall with an IDS or AVS or combination thereof. There is also a need in the art for a firewall an IDS and an AVS that can communicate with each other regarding the process or status information of packets. There is a further need in the art for a firewall an IDS and an AVS that can be centrally controlled and that can increase the speed at which packets are passed between a secured computer network and one or more external networks.

An additional need exists in the art for a method and system for managing security information with parallel processing serial processing or singular processing by a firewall an IDS and an AVS that can be selected by a user. A further need exists in the art for a method and system for managing security information where the firewall IDS and AVS can be configured and optimized efficiently with centralized control.

Similarly another need exists in the art for a method and system for managing security information that enables a firewall to communicate firewall status information to an IDS and an AVS. A further need exists in the art for a method and system for managing security information such that the firewall can be configurable for situations when the IDS or AVS are unavailable. A further need exists in the art for a method and system for managing security information where the IDS can be configured to perform only passive intrusion detection. An additional need exists in the art for a method and system for managing security information such that the IDS in some instances is not permitted to block packets being communicated through a firewall. And lastly a further need exists in the art for a method and system for managing security information that comprises a virus scanning device that can function similarly to an IDS and which can be managed centrally along with an IDS and a firewall.

The firewall IDS and AVS of the present disclosure can be designed to communicate process or status information and packets with one another. The present disclosure can facilitate centralized control of the firewall the IDS and the AVS which can increase the speed at which packets are passed between a secured computer network and an external network. Increased packet processing speed can be achieved in several ways. One way can be to eliminate processing of a packet by the IDS before the packet is sent if a monitor mode configuration is selected for the IDS. With such a configuration the IDS can still process a copy of the packet and can generate an alert if a signature match exists.

Another way to increase speed at which a packet is processed can be to let the firewall interact with the IDS and based on that communication and availability of the IDS make a decision whether to send a packet to the IDS or the secured network . Alternatively if an ignore verdict is reached by the firewall for a given packet being evaluated then the IDS can be completely ignored. That is processing by the IDS can be skipped entirely by the firewall and a packet can be sent if it does not violate any firewall rules.

The computer security management system can respond to and track computer security incidents that can be targeted at or that can occur in a networked computer system. Computer security incidents can include but are not limited to integrity attacks confidentiality attacks denial of service attacks multi stage attacks or other similar attacks on computers or computer networks from users outside or inside of a secured computer network.

The invention can comprise a computer security management system. More specifically a computer security management system can comprise a packet acquisition engine a firewall an intrusion detection system IDS or an AVS or a combination thereof that receives packets from the firewall in addition to firewall communication s . A packet can comprise a transmission unit of a fixed maximum size that can comprise binary digits representing both data and a header containing one of an identification number source and destination addresses and error control data.

The packet acquisition engine can be configured to handle multiple sources of information packets. According to one exemplary aspect of the present disclosure the packet acquisition engine can comprise a bridge that couples the firewall to an information stream such as a connection to a distributed computer network like the Internet. The bridge can comprise a device or hardware such as an Ethernet interface that operates at the International Organization for Standardization Open Systems Interconnection ISO OSI data link layer which is the second of seven layers in the ISO OSI reference model for standardizing computer to computer communications.

According to another exemplary aspect of the present disclosure the packet acquisition engine can comprise the Internet Protocol IP layer that is part of the firewall in order to support Network Address Translation NAT . The IP layer can run at the internetwork layer in the Transfer Connection Protocol over Internet Protocol TCP IP model or the network layer in the ISO OSI reference model. According to this exemplary aspect the IDS can perform the network address translation function.

According to various aspects of the present disclosure the firewall can comprise software or hardware or a combination thereof that is designed to protect a secured computer network from external threats originating from another computer network such as the Internet. The firewall can employ one or more user defined rules to determine whether a data packet can pass through the firewall. The firewall can prevent unauthorized access to or from a secured computer network.

All messages entering or leaving the secured computer network can pass through the firewall which examines each message and blocks those that do not meet the specified security criteria contained within the user defined rules. The firewall of the present disclosure can examine each packet entering or leaving the network and can accept reject or deny it based on the user defined rules.

Similar to the firewall the intrusion detection system IDS and the anti virus system AVS of the present disclosure can comprise software or hardware or a combination thereof that is designed to protect a secured computer network from external threats coming from another computer network such as the Internet. However the IDS can employ one or more signatures to determine whether a data packet can pass through the intrusion detection system. The IDS can also reject accept or deny a packet based upon the comparison with the one or more signatures. A signature can comprise all aspects of a packet including header and data such as an electronic mail message or news posting.

The IDS can differ from a firewall in that the IDS can deploy a more sophisticated rule set to evaluate a potential intrusion. The firewall can limit access between computer networks based on address and some protocol information of a given packet. On the other hand the IDS can evaluate the entire packet to determine if it contains malicious traffic and generate an alert if necessary. The IDS can watch for attacks that originate from within or outside or both of a secured computer network. An integrated firewall and IDS can enhance network security by extending the detection functionality of the IDS to the firewall and extending the blocking function of the firewall to the IDS.

According to the present disclosure the firewall can transmit packets and communication comprising firewall status information to the IDS. The firewall status information can comprise decisions made by the firewall with respect to packets based upon a comparison between one or more packets with one or more firewall rules. The firewall can pass packets to the secured computer network immediately irrespective of any analysis performed by the IDS.

In other words the firewall can let packets pass into the secured network without waiting for a decision from the IDS. According to this exemplary scenario packets can be identified as trusted based on the header information of that packet. If the firewall detects a trusted packet the packet can be passed immediately through the firewall without waiting for the IDS to process the packet. If a host is not identified as trusted the packets can be forwarded to the IDS for processing.

The firewall can also send the packet to the IDS where the IDS can let the packet pass to the secured computer network if certain conditions are met. If the IDS detects a problem with a packet it can drop that packet and any future versions of the detected problem packet.

According to another exemplary aspect of the present disclosure the firewall can be configurable for situations when the IDS is unavailable. For example if the IDS is unavailable the firewall can be configured to pass a packet if no match occurs when the firewall rule s and packet are compared. Alternatively in a more conservative configuration the firewall can drop a packet when the IDS is unavailable even if the packet does not violate any firewall rule s .

According to a further aspect of the present disclosure the IDS can operate in a monitor mode where the IDS can be configured to perform only passive intrusion detection. When the IDS is in monitor mode it can be designed to only generate alerts instead of generating alerts and dropping packets. In monitor mode packets can be passed to a secured computer network only if permitted by the firewall.

For example while an IDS may detect a signature match with a copy of a packet in monitor mode the firewall can immediately pass a packet to the secured computer network if the packet does not violate a firewall rule. With monitor mode the type of information and the amount of information that can potentially be blocked by an IDS can be observed without interrupting a data stream. In this way context information can be gathered so that adjustments can be made to firewall rules or IDS signatures or both in order to optimize performance of the IDS and firewall.

According to a further exemplary aspect of the present disclosure the firewall can determine if certain packets should be ignored by the IDS. In other words the IDS is not permitted to monitor or block packets being communicated to the firewall. If a packet does not violate a firewall rule the firewall can pass the packet immediately to the secured computer network.

According to another exemplary aspect of the present disclosure the system can further comprise a virus scanning device that functions similarly to the IDS. The virus scanning device can check a packet against known profiles of existing viruses worms trojan horses and other programs that may cause harm to a computer or that may interrupt computer services. If a packet matches a virus profile the virus scanning device can recommend the IDS or another appropriate part of the system to drop the packet. The virus scanning device can also operate similarly to the IDS in a monitor mode or an ignore mode as discussed above with respect to the IDS.

The following description in combination with the Figures is provided to assist in understanding the teachings disclosed herein. The description is focused on specific implementations and embodiments of the teachings and is provided to assist in describing the teachings. This focus should not be interpreted as a limitation on the scope or applicability of the teachings.

The present disclosure may be embodied in one or more program modules or hardware or a combination thereof that run in a distributed computing environment. The present disclosure may comprise an integrated firewall and intrusion detection system IDS that communicate process or status information and packets with one another. The present disclosure can facilitate centralized control of the firewall and the IDS and can increase the speed at which packets are passed between a secured computer network and an external network. Increased packet processing speed can be achieved in several ways. For example the firewall and IDS can process packets in series in parallel and sometimes singularly when one of the components is not permitted to process a packet. Alternatively singular processing can also be performed when one component is permitted to pass a packet to the secured computer network without checking with the other component.

Although the illustrative embodiment will be generally described in the context of program modules running on a personal computer and a server those skilled in the art will recognize that the present disclosure may be implemented in conjunction with operating system programs or with other types of program modules for other types of computers. Furthermore those skilled in the art will recognize that the present disclosure may be implemented in either a stand alone or in a distributed computing environment or both. In a distributed computing environment program modules relating to alerting may be physically located in different local and remote memory storage devices. Execution of the program modules may occur locally in a stand alone manner or remotely in a client server manner. Examples of such distributed computing environments include local area networks and the Internet.

The detailed description that follows is represented largely in terms of processes and symbolic representations of operations by conventional computer components including a processing unit a processor memory storage devices connected display devices and input devices. Furthermore these processes and operations may utilize conventional computer components in a heterogeneous distributed computing environment including remote file servers computer servers and memory storage devices. Each of these conventional distributed computing components is accessible by the processor via a communication network.

The processes and operations performed by the computer include the manipulation of signals by a processor and the maintenance of these signals within data structures resident in one or more memory storage devices. For the purposes of this discussion a process is generally conceived to be a sequence of computer executed steps leading to a desired result. These steps usually require physical manipulations of physical quantities. Usually though not necessarily these quantities take the form of electrical magnetic or optical signals capable of being stored transferred combined compared or otherwise manipulated. It is convention for those skilled in the art to refer to representations of these signals as bits bytes words information elements symbols characters numbers data entries objects images files or the like. It should be kept in mind however that these and similar terms are associated with appropriate physical quantities for computer operations and that these terms are merely conventional labels applied to physical quantities that exist within and during operation of the computer.

It should also be understood that manipulations within the computer are often referred to in terms such as creating adding calculating comparing moving receiving determining identifying populating loading executing etc. that are often associated with manual operations performed by a human operator. The operations described herein can be machine operations performed in conjunction with various input provided by a human operator or user that interacts with the computer.

In addition it should be understood that the programs processes methods etc. described herein are not related or limited to any particular computer or apparatus. Rather various types of general purpose machines may be used with the program modules constructed in accordance with the teachings described herein. Similarly it may prove advantageous to construct a specialized apparatus to perform the method steps described herein by way of dedicated computer systems in a specific network architecture with hard wired logic or programs stored in nonvolatile memory such as read only memory.

Referring now to the drawings in which like numerals represent like elements throughout the several Figures aspects of the present disclosure and the illustrative operating environment will be described.

A number of program modules may be stored in the drives and RAM including an operating system and one or more application programs such as a program for browsing the World Wide Web such as WWW browser . Such program modules may be stored on hard disk drive and loaded into RAM either partially or fully for execution.

A user may enter commands and information into the personal computer through a keyboard and pointing device such as a mouse . Other control input devices not shown may include a microphone joystick game pad satellite dish scanner or the like. These and other input devices are often connected to the processing unit through an input output interface that is coupled to the system bus but may be connected by other interfaces such as a game port universal serial bus or firewire port. A display monitor or other type of display device is also connected to the system bus via an interface such as a video display adapter . In addition to the monitor personal computers typically include other peripheral output devices not shown such as speakers or printers. The personal computer may be capable of displaying a graphical user interface on monitor .

The personal computer may operate in a networked environment using logical connections to one or more remote computers such as a host computer . The host computer may be a server a router a peer device or other common network node and typically includes many or all of the elements described relative to the personal computer . The LAN may be further connected to an internet service provider ISP for access to the Internet . In this manner WWW browser may connect to host computer through LAN ISP and the Internet . Such networking environments are commonplace in offices enterprise wide computer networks intranets and the Internet.

When used in a LAN networking environment the personal computer is connected to the LAN through a network interface unit . When used in a WAN networking environment the personal computer typically includes a modem or other means for establishing communications through the Internet service provider to the Internet. The modem which may be internal or external is connected to the system bus via the input output interface . It will be appreciated that the network connections shown are illustrative and other means of establishing a communications link between the computers may be used.

The operating system generally controls the operation of the previously discussed personal computer including input output operations. In the illustrative operating environment the invention is used in conjunction with Microsoft Corporation s Windows NT operating system and a WWW browser . However it should be understood that the invention can be implemented for use in other operating systems such as Microsoft Corporation s WINDOWS 3.1 WINDOWS 95 WINDOWS 98 and WINDOWS 2000 operating systems IBM Corporation s OS 2 and AIX operating system SunSoft s SOLARIS operating system used in workstations manufactured by Sun Microsystems and the operating systems used in MACINTOSH computers manufactured by Apple Computer Inc. Likewise the invention may be implemented for use with other WWW browsers known to those skilled in the art.

Host computer is also connected to the Internet and may contain components similar to those contained in personal computer described above. Additionally host computer may execute an application program for receiving requests for WWW pages and for serving such pages to the requester such as WWW server . WWW server may receive requests for WWW pages or other documents from WWW browser . In response to these requests WWW server may transmit WWW pages comprising hyper text markup language HTML or other markup language files such as eXetnsible Markup Language XML to WWW browser . Likewise WWW server may also transmit requested data files such as graphical images or text information to WWW browser . WWW server may also execute scripts such as CGI PERL ASP or JSP Java Server Pages scripts to dynamically produce WWW pages for transmission to WWW browser . WWW server may also transmit scripts such as a script written in JavaScript to WWW browser for execution.

Similarly WWW server may transmit programs written in the Java programming language developed by Sun Microsystems Inc. to WWW browser for execution. The WWW server could comprise a UNIX platform running Apache or Netscape webserver. Alternatively the WWW server could comprise an Internet Information Server IIS . The present disclosure is not limited to these enumerated examples. Other web server environments are not beyond the scope of the present disclosure.

As will be described in more detail below aspects of the present disclosure may be embodied in application programs executed by host computer such as scripts or may be embodied in application programs executed by computer such as Java applications . Those skilled in the art will also appreciate that aspects of the invention may also be embodied in a stand alone application program.

Referring now to the computer architecture for one exemplary embodiment of the present disclosure will be described. The computer architecture can comprise various software modules or hardware or a combination thereof residing in a kernel space or layer and a user space of an integrated firewall and IDS System . Within the kernel space there can reside a bridge that couples a firewall to an information stream that can comprise a data link layer . Those skilled in the art will appreciate that the data link layer can comprise the second lowest layer in the open systems interconnection seven layer model.

The bridge may comprise a hardware device such as an ethernet interface that operates at the data link layer. The bridge may operate as the packet acquisition engine for this exemplary embodiment. The bridge can pass packets of information from the data link layer to the firewall . A packet can comprise a transmission unit of a fixed maximum size that can comprise binary digits representing both data and a header containing one of an identification number source and destination addresses and error control data. The firewall can prevent unauthorized access to or from a secured computer network if a data packet violates one or more of the user defined rules. The present disclosure is not limited to the packet acquisition engine comprising a bridge . Other types of packet acquisition engines are not beyond the scope of the present disclosure. As will be discussed below with respect to the bridge can be removed such that other components of the inventive system perform the acquisition of data packets.

The firewall can comprise software or hardware or a combination thereof that is designed to protect a secured computer network from external threats coming from another computer network such as the Internet. The firewall can employ one or more user defined rules to determine whether a data packet can pass through the firewall. The firewall can process information by employing different protocols such as transmission control protocol TCP user datagram protocol UDP and internet protocol IP . However the present disclosure is not limited to those protocols illustrated. The present disclosure can further include other protocols that support the internet protocol IP as well as protocols that support asynchronous transfer mode ATM . Those skilled in the art will appreciate that various protocols can be substituted without departing from the scope and spirit of the present disclosure.

The firewall may comprise a dedicated gateway machine with security precautions programmed therein that are used to service an outside network such as the Internet dial in lines and other connections to a secured network . The firewall can run proxy gateways that are located outside of a secured network . The proxy gateways or proxy servers can decide whether it is safe to let a particular message or file in the form of a packet to pass into or out of a secured network .

The firewall of the present disclosure usually makes one of five determinations about the packets being processed for a secured computer network. The five determinations that can be made with the firewall include the following whether to trust a packet whether to reject a packet whether to ignore a packet whether to accept a packet and whether to deny a packet.

The trusted determination made by the firewall of the present disclosure relates to one of the important and unique aspects of the present disclosure. The firewall of the present disclosure allows appropriate administrators of a secured network to select sources outside of the secured network that may be considered as trusted . In other words according to one exemplary embodiment of the present disclosure a user of the present disclosure may select certain providers of data that are not considered to be threats to the secured network . The firewall or controller may maintain a list of data providers that are considered trusted relative to the secured network . Therefore if a packet of information has an identifier indicating that the packet has originated from a trusted source then the firewall can pass this packet immediately to the secured network without waiting for a decision from the intrusion detection system IDS . In this way packet processing speed can be significantly increased.

Another unique and inventive aspect of the present disclosure is that the firewall can further be configured to send a copy of the trusted packet to the intrusion detection system IDS so that the IDS can determine whether or not the trusted packet violates any of the signatures maintained within the IDS . In this way any attacks from a trusted data provider can be reported to an appropriate official of the secured computer network.

If the firewall determines that a packet should be rejected the firewall can transmit a reset packet to the source of the packet indicating that the packet has been rejected by the firewall . Similar to the reject determination the firewall can deny a packet by dropping the packet immediately without forwarding the packet to the secured network . However unlike the reject determination made by the firewall the firewall in the denial determination does not transmit any information back to the source of the packet. In this way the source of the packet does not know whether the firewall has passed or rejected the packet. Such a feature of not transmitting any information back to the source is desirable because the source of a computer security incident will not know whether the computer security incident intentional damage was successful.

Another distinctive and inventive aspect of the present disclosure includes the firewall s ability to determine whether the IDS is available for packet processing. The firewall can be configured such that if the IDS is unavailable for processing a packet the firewall can then pass the packet to the secured computer network in order to increase the reliability of packet processing. However the firewall can also be configured such that if the IDS is unavailable the firewall can then drop the packet in order to prevent any packet matching an intrusion signature from entering the secured network without being checked by the IDS . Further details of the IDS availability determination by the firewall will be discussed in further detail below with respect to .

The firewall can also be configured according to another inventive and distinguishing feature of the present disclosure. The firewall can determine whether the IDS is in a monitor mode. If the firewall determines that the IDS has been placed in a monitor mode then the firewall and the IDS can process the packet in parallel but without waiting for the final determination made by the IDS . In other words in the monitor mode the IDS only performs a passive intrusion detection. That is the IDS cannot reject or deny a packet if a violation of one or more of its signatures are detected.

In the monitor mode the firewall simply operates as if the firewall was a stand alone application relative to the IDS . Further details of the monitor mode will be discussed below with respect to . The firewall of the present disclosure can also be configured according to yet another unique and inventive aspect of the present disclosure. The firewall can be configured to determine whether the IDS has been placed in an ignore mode. As the name of the modes adjust if the IDS is placed in ignore mode the firewall simply ignores the existence of IDS .

That is if a packet does not violate any of the rules within the firewall the firewall simply passes the packet to the secured network without any evaluation being made by the IDS . In this way the firewall can operate as a stand alone firewall so that packet processing time can be significantly reduced. However as apparent to one of ordinary skill in the art such a feature of the firewall can make a secured network extremely vulnerable to attacks by computers outside of the secured computer network. Accordingly this feature should be used with extreme caution.

The firewall can pass packets of information and any of the determinations made by the firewall . That is the firewall can communicate to IDS whether a particular packet should be trusted should be rejected should be denied or accepted by a secured computer network.

The IDS can comprise software or hardware or a combination thereof that is designed to protect a secured computer network from external threats coming from other computer networks such as the Internet. The IDS can employ one or more signatures to determine whether a data packet is malicious or contains an attack. Based on the determination of the IDS and verdict of the firewall the IDS can decide whether to reject or deny a packet A signature can comprise a few lines of information about the sender of an electronic mail message or a news posting. For example a signature typically comprises a sequence of data used for identification such as text appended to an e mail message or a fax.

The IDS can differ from the firewall in that the IDS is designed to look for intrusions in order to stop them from happening. The firewall can limit access between an external or unsecured network and a secured network in order to prevent intrusion. On the other hand the IDS can evaluate a network traffic using a more sophisticated set of rules and it can generate a signal or an alarm when suspect traffic is identified. The IDS can watch for attacks that originate from within or outside or both of a secured computer network. As discussed above the IDS can be placed in various modes. In the monitor mode the IDS can generate alerts if one or more violations of its rules are detected. However in monitor mode the IDS will typically not deny or reject a packet.

Also the firewall can assign a verdict of ignore to a packet and processing of that packet by the IDS can be avoided completely. In other words a packet with an ignore verdict assigned to it by the firewall completely bypasses the IDS . In other modes the IDS can evaluate the verdict assigned by the firewall and the packet contents.

For example the IDS can determine whether the firewall has deemed a particular packet to be trusted or whether a particular packet should be denied or rejected. If the IDS detects any one of these firewall verdicts then processing by the IDS stops as will be discussed in further detail below with respect to . If the firewall accepts a packet the IDS can determine whether or not the packet should be reset or denied based upon a comparison of the packet with the signatures of the IDS . The IDS can reject deny or transmit the packet along the data link layer . For a reset determination the IDS can transmit the reset packet as will be discussed below with respect to .

Prior to packet processing by the IDS the firewall can also send packets to a virus scanner . Virus scanner can comprise software or hardware or a combination thereof that is designed to detect and remove computer viruses. The virus scanner is illustrated with dashed lines to indicate that this feature of the present disclosure can be optional. The virus scanner can be configured similar to the IDS in that the virus scanner can be configured to operate in an ignore mode or a monitor mode. In the ignore mode processing by the virus scanner can be skipped entirely while in the monitor mode the virus scanner can only generate alerts instead of generating alerts and dropping rejecting or denying packets.

The integrated firewall and IDS system can be connected to a monitoring device and controller . The monitoring device and controller can configure either the IDS the virus scanner or the firewall or any combination thereof. The monitoring device and controller can be designed to receive any alert messages generated by the IDS . The monitoring device and controller may comprise one or more software and hardware components. The monitoring device and controller facilitates centralized control of the firewall and the IDS so that updates or configuration changes for either the IDS or firewall or both can be easily implemented without the need for complex application programming interfaces APIs .

Typical processing of a packet can include the following exchanges of information between components of the integrated firewall and IDS system a packet can be transmitted along the data link layer where it is acquired by bridge . The bridge passes the actual packet to the firewall which evaluates the packet. The packet or a copy of the packet can then be transmitted by the firewall to an optional virus scanner . The virus scanner can then pass the packet to the IDS which also makes its own evaluation of the packet. The packet then can be sent by the IDS back to the data link layer to be sent to the secured computer network. In some instances depending upon the determination made by the firewall the firewall can immediately forward the packet to the data link layer instead of sending the packet immediately to the IDS .

Referring now to this figure illustrates another exemplary computer architecture according to the present disclosure. Only the differences between will be discussed with respect to . Accordingly in the kernel space has been modified where bridge has been removed. In this exemplary embodiment the packet acquisition engine can comprise the intranet protocol IP layer that is part of the firewall in order to support network address translation NAT . Network address translation refers to the process of converting between IP addresses used within an intranet or other private network called a stub domain and Internet IP addresses. This approach makes it possible to use a large number of addresses within the stub domain without depleting the limited number of available numeric Internet IP addresses. In this exemplary embodiment the IDS can perform the network address translation function. Further packet acquisition can come from multiple layers and sources.

Referring now to this Figure illustrates an exemplary logic flow diagram of a computer implemented process for managing computer security information. More specifically the logic flow diagram illustrated in illustrates a computer implemented process for managing computer security information with an integrated firewall and intrusion detection system IDS . The logic flow described in can be the core logic or top level processing and can be executed repeatedly as long as the firewall and IDS are operating. The logic flow diagram illustrated in illustrates a process that can occur after initialization of the software components illustrated in .

For example in an exemplary object oriented programming environment several of the software components or software objects that are required to perform the steps illustrated in can be initialized or created prior to the process described in . Therefore one of ordinary skill in the art recognizes that several steps pertaining to initialization of the software objects illustrated in may not be illustrated.

The present disclosure includes a computer program which embodies the functions described herein and illustrated in the appended flow charts. However it should be apparent that there could be many different ways of implementing the invention in computer programming and the invention should not be construed as limited to any one set of computer program instructions. Further a skilled programmer would be able to write such a computer program to implement the disclosed invention without difficulty based on the flow charts and associated description in the application text for example. Therefore disclosure of a particular set of program code instructions is not considered necessary for an adequate understanding of how to make and use the invention. The inventive functionality of the claimed computer program will be explained in more detail in the following description in conjunction with the remaining Figures illustrating the program flow.

Certain steps in the processes described below must naturally precede others for the present disclosure to function as described. However the present disclosure is not limited to the order of the steps described if such order or sequence does not alter the functionality of the present disclosure. That is it is recognized that some steps may be performed before or after other steps without departing from the scope and spirit of the present disclosure.

Referring back to this figure provides an overview of the core logic or the top level processing loop of the integrated computer security management system of the present disclosure where step is the first step of process of an integrated assessment of packet information. In step packet information can be acquired from an information stream. For example as illustrated in the packet acquisition engine can comprise a bridge for collecting packets from a data link layer . Alternatively as illustrated in the packet acquisition engine can comprise the IP protocol .

In step it is determined whether the packet is destined for the secured network . If the packet is destined for the secured network then it is passed to the firewall . But if the packet is not destined for the secured network then the packet could still be passed to the IDS for evaluation. In this way the IDS could monitor packets that may be destined for other secured networks and the IDS could inform these other secured networks of possible computer threats. Further details of step will be described below with respect to and the discussion of an All Packets monitoring mode.

In step the packet of information is evaluated with the firewall . Step can comprise several sub steps taken by the firewall to determine whether a packet should be trusted denied rejected or accepted. Further details of step will become apparent from the detailed description of discussed below.

In step it is determined whether a packet should be sent to the secured network based on the firewall assessment alone. In this step the firewall may pass one or more packets immediately to the secured network without waiting for the IDS to process the one or more packets if the one or more packets are believe to be trusted. Also this step can describe a configuration referred to as Pass Thru Enabled. With such a configuration if the IDS is unavailable and the firewall deems a particular packet to be acceptable then the firewall can pass the packet directly to the secured network even though the IDS was deemed unavailable. Step could also describe the configuration referred to as Pass Thru Disabled. With such a configuration if the IDS is unavailable then the firewall will drop the packet if the firewall deems a packet as acceptable but not trusted.

In step the packet that was processed by the firewall or a packet copied by the firewall and the firewall status information of the packet are forwarded to the IDS . The status information of the packet can comprise decisions made by the firewall with respect to a packet based upon a comparison between the packet and one or more firewall rules. A copy of a packet will typically be made by the firewall if the IDS has been configured for a monitor mode. In the monitor mode configuration the IDS can assess packets that have been directly sent by the firewall to the secured network .

In step it is determined whether a packet should be sent to a secured computer network based upon a combined firewall and IDS assessment. In this step it is determined whether a packet has been accepted by the firewall and if the packet has also been accepted by the IDS . In this step the IDS can evaluate the firewall assessment of the packet. If the firewall had considered a packet to be acceptable but not trusted the IDS can further evaluate its own assessment of the packet. If a packet is acceptable by the IDS it can be sent by the IDS to the secured network . Further details of step will become apparent from the detailed discussion of the IDS steps discussed with respect to .

In step a packet is sent rejected or denied by either the firewall or IDS . This step could describe the scenario when the firewall sends a packet directly without processing of the packet performed by the IDS . Alternatively the step could also describe the situation after a packet has been processed by both the firewall and the IDS . Further details of step will become apparent from the detailed description of the method steps relating to the firewall and the IDS as discussed below with respect to .

Referring now to this figure illustrates a computer implemented method for managing computer security information with an integrated firewall and IDS . The exemplary computer implemented method begins with step in which a packet arrives on an interface such as the data link layer .

In step it is determined whether the packet is destined for the secured computer network . If the inquiry to decision step is positive then the Yes branch is followed to step . If the inquiry to decision step is negative then the No branch is followed to decision step .

In decision step it is determined whether the IDS is set to an All Packet mode in which all packets irrespective of their destination are evaluated by the IDS . If the inquiry to decision step is negative then the No branch is followed to step in which the packet is dropped. If the inquiry to decision step is positive then the Yes branch is followed to step . In this way the IDS can monitor traffic that may be destined for other networks not connected to IDS . The IDS can advise these other networks of possible computer threats if a packet matches one or more signatures of the IDS .

Such an All Packet mode feature is desirable when a large computer network has multiple sub networks. For example in a cable modem environment the IDS may be able to monitor packet traffic that is destined further down the line for other secured computer networks relative to the modem in which the IDS is currently connected to. That is the IDS may be able to monitor packet traffic that are destined for other cable modems that form the links to other secured computer networks not shown in the figures. 

In decision step it is determined whether the IDS is in a monitor mode. The IDS can operate in this monitor mode where the IDS can be configured to perform only passive intrusion detection. When the IDS is in monitor mode it can be designed to only generate alerts instead of generating both alerts and blocking or dropping packets of information.

In monitor mode packets can be passed to a secured computer network only if permitted by the firewall . For example while the IDS may detect a signature match with a copy of the packet while in monitor mode the firewall can immediately pass a packet to the secured computer network if the packet does not violate a firewall rule. Monitor mode can provide many advantages.

For example the type of information and the amount of information that can be potentially blocked by the IDS can be observed without interrupting a data stream. In this way context information can be gathered so that modifications or adjustments can be made to firewall rules or IDS signatures or both in order to optimize performance of both the IDS and firewall . Monitor mode is but one unique and distinguishing feature of the present disclosure where the firewall and IDS are optimized.

If the inquiry to decision step is positive then the yes branch is followed to step in which the packet is copied and sent to the IDS . In step parallel processing occurs where the IDS processes the copied packet while the actual packet is processed by the firewall as indicated by the two branches flowing out of this step.

If the inquiry to decision step is negative then the no branch is followed to step in which the packet is passed to either the bridge of one exemplary embodiment or the internet protocol layer of another exemplary embodiment. Step describes the functionality of the packet acquisition engine which can be designed to take packets from the data link layer as described in .

Next in step the packet is compared to the firewall rules. Some of the firewall rules may also include characteristics of packet headers for those packets that may be considered trusted by the firewall . These lists of trusted packets typically correspond to one or more hosts that are considered to pose little or no threat to the secured computer network. The trusted packets can be permitted to pass immediately through the firewall to the secured computer network. Such a trusted packet feature of the firewall can significantly increase processing speed of packets.

In decision step it is determined whether a packet is trusted . If the inquiry decision to decision step is positive then the yes branch is followed to step in which a packet is copied for use with the IDS . In step the firewall transmits the packet to the secured computer network.

If the inquiry to decision step is negative then the no branch is followed to decision step in which it is determined whether the packet should be rejected. If a packet is determined to be rejected by the firewall then such a decision usually means that the packet does violate a firewall rule. However a rejection decision usually means that the packet has originated from a friendly source. Accordingly if the inquiry to decision step is positive then the yes branch is followed to step in which a reset packet is transmitted to the source of the packet. In this way the source receiving the reset packet will be provided information that the original packet was not passed by the firewall into the secured network .

Next in decision step is determined whether a packet should be denied. In other words the firewall can determine whether a packet should be denied where information concerning this denial is not sent back to the source of the packet. In this way the source of the packet does not know if the packet has been passed by the firewall to the secured network or if the packet has been dropped by the firewall . If the inquiry to decision step is positive the yes branch is followed to step in which a packet is copied for the IDS . In step the packet is dropped by the firewall . If the inquiry to decision step is negative where the firewall deems a packet to be acceptable then the process continues to decision step in which it is determined whether the IDS is available for processing the current packet.

It is noted that steps and exemplify some key optimization features of the present disclosure. These steps enable the integrated firewall and IDS system to process packets very quickly while also permitting all of the components of the system to gather as much information that can be obtained regarding a particular packet. If the inquiry to decision step is positive then the yes branch is followed to decision step in which it is determined whether the IDS has been placed in a ignore mode in which the firewall does not transmit any packets to the IDS .

If the inquiry to decision step is negative then the no branch is followed to decision step in which it is determined whether a packet has been denied or rejected by the firewall . If the inquiry to step is positive then the yes branch is followed where the process can end. If the inquiry to decision step is negative then the no branch is followed to decision step . In decision step it is determined whether the IDS has been placed in a pass thru enabled mode. In such a mode the firewall will transmit a packet if the IDS is unavailable. In other words if the inquiry to decision step is positive then the yes branch is followed to step in which the packet is transmitted to the secured network . If the inquiry to decision step is negative then the no branch is followed to step in which the packet is dropped by the firewall .

Referring back to decision step in which it is determined whether or not the IDS should be ignored by the firewall if the inquiry to this decision step is positive then the yes branch is followed to step in which the packet is transmitted by the firewall. As noted above when the firewall reaches an ignore verdict packets are not sent to the IDS . In other words the IDS is not permitted to monitor or even block packets being communicated to the firewall. If a packet does not violate a firewall rule the firewall can pass the packet immediately to the secured computer network.

Decision step and its surrounding steps that relate to the availability of the IDS decision step and its surrounding steps that relate to the Pass Thru configuration and decision step and its surrounding steps that relate to the Ignore verdict also exemplify other key and unique optimizations that distinguish the present disclosure from the conventional art. All of these steps provide optimizations that either cannot be achieved with conventional stand alone firewalls and IDSs or they are too difficult to implement.

If the inquiry to the decision step is negative then the no branch is followed to decision step in which it is determined whether or not the IDS has been placed in a monitor mode . As noted above when the IDS is operating in the monitor mode the IDS can be configured to perform only passive intrusion detection. The IDS in this mode only generates alerts instead of generating both alerts and blocking or dropping packets. In this way valuable information can be collected on packets without slowing the processing of the packets by the firewall .

In monitor mode packets can be passed to a secured computer network only if permitted by the firewall. In this mode the firewall does not wait for any decisions made by the IDS with respect to packets. Such a monitor mode feature is yet another unique and inventive aspect that permits context information to be collected about packets. This context information can later be analyzed as part of a forensic analysis or the information can provide insight in how to optimize IDS signatures and firewall rules for certain types of network traffic. If the inquiry to decision step is positive then the yes branch is followed to step in which the packet is transmitted to the secured network . If the inquiry to decision step is negative then the no branch is followed to step in which either the actual packet or a copy of the packet is compared to IDS signatures on file.

Instead of proceeding directly from decision step to step the process could first proceed to step in which the packet or copy of the packet is compared to a virus profile in step . In decision step it can be determined whether a packet or a copy of a packet matches the profile of a virus. If the inquiry to decision step is positive then the yes branch can be followed to step in which an alert is generated with the virus scanner .

If the inquiry to decision step is negative then the no branch is followed back to step . Steps are illustrated with dashed lines to indicate that the virus scanner is but one optional component of the present disclosure.

In decision step it is determined whether a packet matches a signature on an intrusion detection list. Basically in decision step it is determined whether or not a packet matches one or more signatures stored in or that are accessible by IDS . If the inquiry to decision step is positive then the yes branch is followed to step in which the IDS generates an alert.

If the inquiry to decision step is negative then the no branch is followed to decision step in which it is determined whether or not the IDS is in a monitor mode. If the inquiry to decision step is positive then the yes branch is followed to step in which the copy of the packet is dropped by the IDS . The process then returns to step in which the packet is passed to either the bridge or the IP layer functioning as the packet acquisition engine.

If the inquiry to decision step is negative then the no branch is followed to step in which the IDS evaluates the firewall assessment of a particular packet. In decision step the IDS determines whether the firewall considered the packet as being trusted. If the inquiry to decision step is positive then the yes branch is followed. If the inquiry to decision step is negative then the no branch is followed to decision step determines whether the packet has been denied or rejected by the firewall . If the inquiry to decision step is positive then the yes branch is followed.

It is noted that decision steps and are further additional aspects which define the present disclosure over the conventional art since it is in these steps that the IDS evaluates the firewall communication that was forwarded to the IDS . As noted above many conventional IDS systems do not receive information regarding processing such as decisions made by the firewall . Decision steps and take in account for the immediate processing of the firewall in steps and . In other words decision steps and enable more rapid processing by the IDS since it is at this stage of processing in which the IDS determines that the current packet has been completely processed by the firewall in that further processing by the IDS is unnecessary. With such a process that considers work already performed by one system component unnecessary or redundant processing is eliminated which in turn increases the processing speed for individual system components such as the IDS as well as the system as a whole.

If the inquiry to decision step is negative then the no branch is followed to step in which the IDS evaluates its own assessment of the current packet. It is noted that in the optional embodiment which comprises a virus scanner instead of proceeding directly to step from decision step the process could proceed to routine in which the virus assessment is evaluated by the IDS . Routine would comprise steps similar to steps and as will be discussed in further detail below.

In step the IDS evaluates its own assessment of the current packet. If the current packet has a signature match and is from a signature that is recognized to be a friendly source then the yes branch is followed to step in which a recent packet is transmitted by the IDS back to the source of the packet. Also in step the IDS can generate and write a rule to the firewall relating to the current packet being evaluated. If the inquiry to decision step is negative then the no branch is followed to decision step in which it is determined whether the current packet should be denied. If the inquiry to decision step is positive then the yes branch is followed to step in which the packet is dropped by the IDS. Also in step the IDS can generate and write a rule to the firewall relating to the current packet being evaluated. If the inquiry to decision step is negative then the no branch is followed to step in which the packet is transmitted by the IDS to the secure network.

In a main dashed line separates the process into three sections. The first section denotes the steps that can be performed by the firewall in one exemplary embodiment. The second section denotes the steps of the process that can be performed by the IDS . The third section completely enclosed by dashed lines denotes the steps of the process that can be performed by the virus scanner .

As will become apparent from the process described in above the present disclosure permits very unique and inventive configurations for increasing packet processing speeds for the firewall or the IDS or both. The process described in yields significant optimizations that are also illustrated in .

Referring now to this figure illustrates very exemplary states of the integrated computer security management system according to one exemplary embodiment of the present disclosure. comprises a decision matrix that reflects how packets are processed when the firewall and the IDS are placed in various configurations. The first column describes various decisions that can be rendered by the firewall while the first row illustrates decisions that can be rendered by the IDS as well as various configuration states for the IDS and the virus scanner .

The first section of the decision matrix describes the configuration where the IDS is available for processing a packet that is also being processed by the firewall . Section of the decision matrix describes the configuration in which the IDS is not available for processing a packet that is also processed by the firewall . Section of the decision matrix describes the configuration in which the IDS is placed in a monitor mode. Section of decision matrix further describes the states of the virus scanner based upon a comparison of a packet to one or more virus profiles.

Each section of the decision matrix demonstrates the various optimizations that can be achieved for the present disclosure. For example in the first decision block of the decision matrix the top half or left side section indicates the combined decision of the firewall and the IDS while the lower half or right side section of the block indicates which device will be handling the current packet. Therefore decision block indicates that the firewall and the IDS have accepted the packet such that it will be sent by the IDS as indicated by the lower half of the block . In the second block the overall decision for the current packet is to drop and the IDS will drop the current packet. In the third block the firewall has accepted the current packet while the IDS has rejected the packet. But since the packet is from a friendly or known source the IDS transmits the reset packet back to the source of the packet.

The decision matrix demonstrates the efficiency achieved with the integrated firewall and IDS system of the present disclosure. The majority of the blocks indicate that the firewall manages many of the packets in most of the configurations. That is if the firewall denies rejects or trusts a packet then the firewall typically can process a particular packet immediately without waiting for the IDS to process the packet. In this way packet processing is significantly improved with the present disclosure since the packet processing speed can be substantially increased.

It should be understood that the foregoing relates only to illustrative embodiments of the present disclosure and that numerous changes may be made therein without departing from the spirit and scope of the invention as defined by the following claims.

Although only a few exemplary embodiments have been described in detail herein those skilled in the art will readily appreciate that many modifications are possible in the exemplary embodiments without materially departing from the novel teachings and advantages of the embodiments of the present disclosure. Accordingly all such modifications are intended to be included within the scope of the embodiments of the present disclosure as defined in the following claims. In the claims means plus function clauses are intended to cover the structures described herein as performing the recited function and not only structural equivalents but also equivalent structures.

