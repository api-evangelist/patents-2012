---

title: User authentication system and method for encryption and decryption
abstract: A system configured to authenticate a user for encryption or decryption includes a user authentication apparatus, a computer-readable medium operable to communicate with the user authentication apparatus, and an encryption and decryption computer communicating with the user authentication apparatus. The computer-readable medium may store user identifying information and encryption and decryption data. The encryption and decryption computer may be configured to receive an application programming interface (API) for interfacing with the user authentication apparatus and receive the user identifying information from the computer-readable medium via the API. A user may be authenticated based on the user identifying information and, once the user is authenticated, the encryption and decryption data may be read.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08762713&OS=08762713&RS=08762713
owner: MAZ Encryption Technologies LLC
number: 08762713
owner_city: Wilmington
owner_country: US
publication_date: 20121217
---
This application is a continuation of U.S. patent application Ser. No. 12 957 479 filed Dec. 1 2010 which a continuation of U.S. patent application Ser. No. 12 128 501 filed May 28 2008 now U.S. Pat. No. 7 865 728 which is a continuation of U.S. patent application Ser. No. 11 382 691 filed on May 10 2006 now abandoned which is a continuation of U.S. patent application Ser. No. 10 658 246 filed Sep. 8 2003 now U.S. Pat. No. 7 096 358 which is a continuation in part of U.S. patent application Ser. No. 09 259 991 filed Mar. 1 1999 now U.S. Pat. No. 6 981 141 which is a continuation in part of U.S. patent application Ser. No. 09 074 191 filed May 7 1998 now U.S. Pat. No. 6 185 681 the disclosures of which are incorporated herein by reference.

Other related applications application Ser. No. 11 627 856 filed Jan. 26 2007 now abandoned which is a continuation of application Ser. No. 11 382 691.

A portion of the disclosure of this patent document contains material which is subject to copyright protection. This patent document may show and or describe matter which is or may become trade dress of the owner. The copyright and trade dress owner has no objection to the facsimile reproduction by anyone of the patent disclosure as it appears in the Patent and Trademark Office patent files or records but otherwise reserves all copyright and trade dress rights whatsoever.

Global access of electronic information can be critical for even the smallest of businesses today. Very few companies operate solely within the boundaries of a single location or their employee list. Over the last 25 years technology has rapidly advanced and expanded these boundaries. The advent of such technologies as the Internet intranets extranets and e mail have made the electronic transfer of information common place in businesses today. Management of business information is critical to the success of modern businesses. A technology known as Electronic Document Management EDM aims to provide organizations with the ability to find any document created in any application by anyone at any time dealing with any subject at any place in the world. EDM includes managing multiple versions of a document. PC DOCS Inc. Burlington Mass. is one of the world s leading providers of EDM solutions. With the advanced technology of EDM comes a wide variety of information that has varying economic values and privacy aspects. Users may not know what information is monitored or intercepted or who is using their computer.

An electronic document management system EDMS is a combination of databases indexes and search engines utilized to store and retrieve electronic documents distributed across an organization. An EDMS is designed to provide the structure required for an organization to properly manage and share its electronic document resources.

As companies increase the efficiency of accessing more information their security risks also increase. According to a recent survey by Ernst Young LLP 

more than a quarter said that their security risks have increase at a faster rate than the growth of their computing 

55 of the respondents lacked confidence that their computer systems could withstand an internal attack 

71 of security professionals are not confident that their organizations are protected from external attack and

two thirds of the respondents reported losses resulting from a security breach over the prior two years.

It has been said that There is no need to break the window of a house if the front door is unlocked. This saying certainly applies to computer security. The unlocked doors in electronic information security include 

One of the fastest growing means of communication today is e mail. It is estimated that over one million e mail messages pass through the Internet every hour. E mail provides a quick economical easy to use method of sharing both thoughts and electronic information. Unfortunately e mail is like an electronic postcard for the world to see. It is transmitted across the Internet using the Simple mail Transfer Protocol SMTP . This protocol has virtually no security features. Messages and files can be read by anyone who comes into contact with them.

Knowledge is becoming the most important product for companies today. As EDM enhances a company s productivity and efficiency to manage that knowledge it also exposes that company to unauthorized access to that knowledge. The typical EDMS solely relies on password protection for security.

The value of the approximately 265 000 portable computers laptops notebooks palmtops reported stolen in 1996 was 805 million a 27 increase from 1995. However the data on these portable computers is worth much more than the hardware itself. It is critical that the data stored on any type of hardware whether it is a desktop computer portable computer or server must be properly secured from any unauthorized access.

Passwords are often used to prevent unauthorized individuals from accessing electronic data. Passwords may also be used to link activities that have occurred to a particular individual. The problem with passwords is that if any unauthorized party steals or guesses a password the security of the computer system may be severely compromised. Passwords are wholly inadequate for file archiving.

Systems using firewalls prevent intruders from accessing the firm s internal systems. Password based firewall systems do not provide positive user identification nor do they protect electronic data that is stored on a server has left the firm on a portable computer is sent via e mail over the Internet or is stored on a floppy disk.

The typical smart card is a self contained tamper resistant credit card size device that selves as a storage device and is equipped with an integrated microprocessor chip and non volatile electronic memory. The smart card processes information on the integrated microprocessor chip. Security is enhanced because the user must have the smart card along with the user s confidential information e.g. a password to gain access to their computer files. Passwords are kept off computer hosts and on the smart card to enhance security. Smart cards typically can only be accessed with a user defined password. Many smart cards include a lock out feature so that failed attempts at the smart card password will lock the card out to prevent any unauthorized or fraudulent use of the smart card. ISO 7816 compliant smart cards and smart card readers follow industry standards.

Increasingly information technology professionals are turning to encryption technologies to ensure the privacy of business information. Encryption can provide confidentiality source authentication and data integrity. Unfortunately encryption generally is cumbersome and difficult to use. A major obstacle for the implementation of encryption technologies has been their disruption to the users workflow.

Encryption is a process of scrambling data utilizing a mathematical function called an encryption algorithm and a key that affects the results of this mathematical function. Data before becoming encrypted is said to be clear text. Encrypted data is said to be cipher text. With most encryption algorithms it is nearly impossible to convert cipher text back to clear text without knowledge of the encryption key used. The strength of the encrypted data is generally dependent upon the encryption algorithm and the size of the encryption key.

Private key encryption uses a common secret key for both encryption and decryption. Private key encryption is best suited to be used in trusted work groups. It is fast and efficient and properly secures large files. The leading private key encryption is DES Data Encryption Standard . DES was adopted as a federal standard in 1977. It has been extensively used and is considered to be strong encryption. Other types of private key encryption include Triple DES IDEA RC4 MD5 Blowfish and Triple Blowfish.

Public key encryption uses a pair of keys one public and one private. Each user has a personal key pair and the user s public or decryption key is used by others to send encrypted messages to the user while the private or decryption key is employed by the user to decrypt messages received. Public key encryption and key generation algorithms include the public domain Diffie Hellman algorithm the RSA algorithm invented by Riversi Shamir and Adleman at the Massachusetts Institute of Technology MIT and the Pretty Good Privacy algorithm PGP developed by Phil Zimmermann. Because of their mathematical structure public key encryption is slower than most private key systems thus making them less efficient for use in a trusted network or for encrypting large files.

Although these private key and public key encryption algorithms do a good job at maintaining the confidentiality of the encrypted matter they have numerous problems. The biggest obstacle to adoption of any type of encryption system has been ease of use. Typical encryption systems are very cumbersome. They require a user to interrupt their normal work flow save the clear text document activate the separate encryption software and save the cipher text document under a different name. Where the subject document is ordinary e mail contents the process is especially cumbersome because the clear text must first be created in a separate application then encrypted then attached to the e mail message.

A major concern in computing today is total cost of ownership or TCO. TCO recognizes that while a program might be inexpensive or even free in the case of PGP for non commercial use there are significant costs in using the software. This includes the cost of installation training lost productivity during use and from bugs and maintenance.

Even where one of the typical encryption systems might satisfy a user s TCO needs they may not even be an available option. For example typical EDMSes are self contained and are not compatible with typical encryption systems.

It is therefore the object of the invention to provide a document encryption and decryption system which solves these problems. It is a further object to provide a document encryption and decryption system which works with minimal disruption of a user s normal workflow. It is a further object to provide a document encryption and decryption system which is compatible with EDMSes. It is a further object to provide a document encryption and decryption system which minimizes TCO. It is a further object to provide a document encryption and decryption system which takes advantage of the features of smart cards which are not available from pure on line security systems.

Throughout this description elements appearing in figures are assigned three digit reference designators where the most significant digit is the figure number and the two least significant digits are specific to the element. An element that is not described in conjunction with a figure may be presumed to have the same characteristics and function as a previously described element having a reference designator with the same least significant digits.

The smart card reader preferably complies with ISO 7816 a standard available from the American National Standards Institute ANSI . To interface the smart card reader to the computer s Windows operating system and other software the computer preferably includes an API provided by the smart card reader manufacturer. Alternatively the computer may include Microsoft s smart card API SCard COM available at www.microsoft.com smartcard.

A user s smart card preferably stores a unique user ID and password and a definable hierarchy of encryption keys. The hierarchy preferably forms a table wherein a key name is associated with each key value in the table and the table may store both encryption keys and decryption keys as necessary for the selected cryptographic algorithms. It should be appreciated that in private key cryptography the same key value is used for both encryption and decryption.

Although something as simple as a user ID password scheme could be used with the keys stored in the disk or memorized by the user a data reader device and portable data storage device such as the smart card reader and smart card are preferred. Instead of the smart card reader and smart card there could be provided for example a biometric recognition system wireless identification devices hand held tokens etc. Preferably the portable data storage device can securely store one or more encryption and decryption keys. However a biometric recognition system may provide key selection based on inherent biometric features eliminating the need to actually store keys in a component external to the computer . Where the portable data storage device is used solely as a source of positive identification i.e. authentication the keys may be stored on the file server for example and accessed through a certificate mechanism.

Before proceeding a few terms are defined. By file server it is meant a computer which controls access to file and disk resources on a network and provides security and synchronization on the network through a network operating system. By server it is meant hardware or software which provides network services. By workstation it is meant a client computer which routes commands either to its local operating system or to a network interface adapter for processing and transmission on the network. By client it is meant software which is serviced by a server. A workstation may function as a server by including appropriate software and may be for example a print server archive server or communication server. By software it is meant one or more computer interpretable programs and or modules related and preferably integrated for performing a desired function. By document it is meant a named structural unit of text graphics and or other data that can be stored retrieved and exchanged among systems and users as a separate unit.

Referring now to there is shown a conceptual block diagram of several functional units relevant to the invention which operate within the file server and workstation . The workstation includes at least one application . The application is a collection of software components used to perform specific types of user oriented work and may be for example a graphic editor a word processor or a spreadsheet.

As is typical in the art the workstation obtains access to the file server through a user ID and password system which extends to the file system on the file server . The file server has an access server for handling the filer server s user authentication and access control duties and the workstation include an access client through which a user signs on to the file server . In the preferred embodiment the access server is a part of Windows NT Server and the access client is a part of Windows 95 and Windows NT Workstation. Other operating systems such as Unix and Novell Netware also include access servers and access clients for providing user authentication and file level security.

Within the file server there is preferably an EDM server . To interface with the EDM server the workstation includes an EDM client sometimes referred to as an EDM plug in. The EDM server controls an EDM database and EDM indexes not shown and preferably provides EDM search engines. The EDM database itself may be distributed for example across file systems and file servers and may be entirely or partially in the workstation . The EDM server may include a database server such as a SQL server for interfacing to the EDM database . The EDM client provides the workstation with an interface to the EDM server and therefore allows access by a user at the workstation to the EDM database indexing and search services provided by the EDM server .

The EDMS of the preferred embodiment is SQL based. Thus the EDM database comprises a SQL database the EDM server comprises a SQL server and the EDM client comprises a SQL plug in. The SQL database stores file and file location information. A repository which could be considered part of the EDM database stores the files and is managed and distributed using techniques known in the art. In older EDM systems the SQL plug in comprises special software which adapted particular popular applications for use with the EDMS. However with the promulgation of the Open Document Management Architecture ODMA specification applications are available which operate seamlessly with many contemporary EDM systems. Under ODMA the EDM plug in registers itself so that it handles file I O.

The EDM server EDM database and EDM client are described herein as wholly separate from the respective operating systems of the file server and workstation . However much if not all of the EDM server EDM database and EDM client could be fully integrated into and even become a part of the respective operating systems. In such an embodiment the EDMS is just another part of an operating system s general file and data management features.

As can be seen the access server and the access client functionally reside between the EDM server and the EDM client thereby separating the EDM server and EDM client with a measure of security. This aspect of is the typical prior art configuration and it provides file level security for documents in the EDM database controlled by the EDM server .

Positioned functionally between the application and the EDM client is a crypto server . In typical prior art systems the application would communicate directly with the EDM client . However in accordance with the invention the crypto server is functionally disposed between the application and the EDM client and intercepts or traps I O requests by the application which otherwise would be intercepted or trapped by the EDM client .

The crypto server of the invention is a software module which transparently handles the encryption of documents and the decryption of encrypted documents making encryption and decryption simple and easy to use. The crypto server handles encryption and decryption without requiring user input and without normally displaying status information during normal encryption and decryption operations. Preferably the user or a system administrator may establish a system level configuration determinative of when error messages should be displayed. Preferably also the system administrator may create and maintain a file administration table in the EDM database which defines criteria for which files are to be encrypted and which key to use. The crypto server utilizes the file administration table for example to determine if a new file should be encrypted and which encryption key to use to encrypt the new file. The crypto server preferably utilizes and updates an encrypted files table in the EDM database which lists each encrypted file.

The crypto server may itself comprise a number of functional units. For example the crypto server preferably includes interfaces to one or more cryptographic systems such as those described in the Description of the Related Art section above. The crypto server preferably also includes an interface to the smart card reader for reading the smart card . The smart card preferably is used to keep the encryption and decryption keys separate from the workstation and provide positive user identification. The crypto server also works with the access client in performing user authentication and access. In particular the typical prior art user access process is enhanced by requiring that the user enter a user ID and password which are stored on the user s smart card .

Turning now to there is shown a flowchart of the encryption process in accordance with the invention. After the process begins step it is preferred that the user submit to authentication by the access client and access server step . The authentication step is preferably performed when the user signs onto the workstation . Preferably the user must insert his smart card into the smart card reader and enter the user ID and password stored on the smart card . Once authenticated the smart card then makes available as needed the encryption and decryption key information stored therein.

At some point after the user has been authenticated the user will be working on a document in the application and at some point issue a close save or save as command as known in the art step . The command is then translated into an event step and the crypto server traps this event step . Techniques for translating commands into events and trapping events are well known in the art and are typically different for each operating system. In Windows the event translation step comprises generating an event message.

The trapped event has the effect of alerting the crypto server that it may be necessary to encrypt the document. However preferably before encrypting the document the crypto server tests whether the document should be encrypted step . Preferably at least three different tests are performed.

In the first test the crypto server tests whether the user has been authenticated. The first test is relatively simple. Where the smart card or similar means is used for storing keys this test is necessary because the keys will not even be available unless the user was authenticated.

In the second test the crypto server tests whether the document was already encrypted when it was opened by the application . By default a document which was already encrypted when opened should be encrypted when closed or saved.

In the third test the crypto server tests whether the EDM database has an indicator that the document should be encrypted. As described above the EDM database includes a list of encrypted documents in an encrypted files table. The EDM database preferably also includes criteria for new documents which indicate whether new documents when the criteria are met should be encrypted. The criteria are preferably stored in the file administration table described above. To perform the third test the crypto server passes a database query to the EDM client to have the EDM server query the EDM database . For existing files the query is directed to the encrypted files table. For new files the query is directed to the file administration table. The EDM server then passes the results of the test back to the EDM client which provides the test results to the crypto server .

If for any reason the document is not to be encrypted then the crypto server passes control to the EDM client which performs the close save or save as command on the unencrypted document. Alternatively the decision not to encrypt for one or more reasons may result in an error message being displayed to the user and may result in the document not being closed or saved. At this point for documents which are not to be encrypted the method is complete step .

If in step the document is to be encrypted then the crypto server preferably obtains an encryption key name which is associated with the document step .

The crypto server then uses the encryption key name to retrieve an encryption key value which is associated with the encryption key name step . For most encryption algorithms the encryption key is a multi digit number which is difficult to remember and even difficult to transcribe. The encryption key name is preferably an alphanumeric descriptor which may be used by the user and or system administrator for administering the encryption key value. Preferably the encryption key value is also related to the identity of the user and this is accomplished by retrieving the encryption key value from the key table stored in the smart card which is associated with the relevant encryption key name.

Once the crypto server has the encryption key value the crypto server then encrypts the document with the encryption key value step and passes control to the EDM client step so that the document may be saved step . At this point for documents which are to be encrypted the method is complete step .

Turning now to there is shown a flowchart of the decryption process in accordance with the invention. After the process begins step it is preferred that the user submit to authentication step . Authentication step preferably is the same for encryption and decryption.

At some point after the user has been authenticated the user will wish to open a document into the application step . The file open command may be issued from within the application or may be issued by a second application with the nature of the document such that the application will actually open the document and provide access to the document s contents. In any case once the user selects a document to be opened an open command is issued step . The open command is then translated into an event step and the crypto server traps this event step .

The trapped event has the effect of alerting the crypto server that it may be necessary to decrypt the document. However preferably before decrypting the document the crypto server tests whether the document should be decrypted step . Preferably these tests are complimentary to those described above with respect to the encryption process.

If for any reason the document is not to be decrypted then the crypto server passes control to the EDM client which performs the open command. Alternatively the decision not to decrypt for one or more reasons may result in an error message being displayed to the user and may result in the document not being opened. At this point for documents which are not to be decrypted the method is complete step .

If in step the document is to be decrypted then the crypto server preferably obtains a decryption key name which is associated with the document step . The decryption key name is preferably obtained from the file s header or from the encrypted files table.

The crypto server then uses the decryption key name to retrieve a decryption key value which is associated with the decryption key name step . Preferably the decryption key value like the encryption key value is also related to the identity of the user and this is accomplished by retrieving the decryption key value from the key table stored in the smart card and associated with the decryption key name.

Once the crypto server has the decryption key value the crypto server then decrypts the document with the decryption key value step and passes control to the EDM client step so that the decrypted copy of the document may be opened into the application step . At this point for documents which are to be decrypted the method is complete step .

Throughout this description the embodiments and examples shown should be considered as exemplars rather than limitations on the apparatus and procedures disclosed or claimed. Although many of the examples presented herein involve specific combinations of method acts or system elements it should be understood that those acts and those elements may be combined in other ways to accomplish the same objectives. With regard to flowcharts additional and fewer steps may be taken and the steps as shown may be combined or further refined to achieve the methods described herein. Acts elements and features discussed only in connection with one embodiment are not intended to be excluded from a similar role in other embodiments.

For means plus function limitations recited in the claims the means are not intended to be limited to the means disclosed herein for performing the recited function but are intended to cover in scope any means known now or later developed for performing the recited function.

As used herein whether in the written description or the claims the terms comprising including carrying having containing involving and the like are to be understood to be open ended i.e. to mean including but not limited to. Only the transitional phrases consisting of and consisting essentially of respectively are closed or semi closed transitional phrases with respect to claims.

Use of ordinal terms such as first second third etc. in the claims to modify a claim element does not by itself connote any priority precedence or order of one claim element over another or the temporal order in which acts of a method are performed but are used merely as labels to distinguish one claim element having a certain name from another element having a same name but for use of the ordinal term to distinguish the claim elements.

As used herein and or means that the listed items are alternatives but the alternatives also include any combination of the listed items.

