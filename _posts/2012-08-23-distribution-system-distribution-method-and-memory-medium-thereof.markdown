---

title: Distribution system, distribution method, and memory medium thereof
abstract: The control node, on the basis of the connection information between the distribution nodes and the load information of the distribution nodes, determines a distribution node of the distribution destination to which one of a plurality of distribution nodes subsequently distributes the data, and the data type which is distributed to the distribution node of the distribution destination. The control node distributes node information which specifies the distribution node of the determined distribution destination and type information which specifies the determined data type. The distribution node receives the node information and the type information distributed from the control node. The distribution node, when it receives the data distributed from the other distribution nodes, selects the data of the type specified by the type information from the received data. The distribution node transmits the data of the selected type to the distribution node specified by the node information.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08948050&OS=08948050&RS=08948050
owner: Fujitsu Limited
number: 08948050
owner_city: Kawasaki
owner_country: JP
publication_date: 20120823
---
This application is based upon and claims the benefit of priority of the prior Japanese Patent Application No. 2011 195616 filed on Sep. 8 2011 the entire contents of which are incorporated herein by reference.

The embodiments explained hereinafter relate to a distribution system which distributes information using a distribution node.

A distribution system exists which collects and distributes real time field information such as for example sensor information earthquakes rain etc. from around the location of a user. In such a distribution system in many cases an information provider does not know beforehand who will use the information. Therefore it is necessary for the user to be able to join the distribution system any time when he wants to refer to data and to be able to change the type of sensor information to be distributed at will.

As a system for referring to such sensor information a Publication Subscription communication model is utilized. The Publication Subscription communication model is a system by which a message is distributed at a timing at which an event occurs in a corresponding topic for example when a window of the home opens etc when a subscription is registered beforehand with respect to the topic for example home etc . With this a transmitter and a receiver do not need to be conscious of who and where the other party is and the receiver can receive only the messages that he wants. With this Publication Subscription system the subscription to a distribution process is available not only for a single user but also for a plurality of users simultaneously.

In addition in order to inhibit increases in loads and power consumption of communication processing the information provider is required to integrally deliver to a certain degree regularly obtained data.

Thus when the Publication Subscription system is used an intermediary is required between a transmitter sensor wishing to transmit a plurality of data simultaneously and a receiver user wishing to receive only the necessary data. Therefore the following technique can be considered.

As a first technique such a method of integrating all the data in a server of a data center and then individually distributing only the data required for each user can be considered.

Further as a second technique multicast distribution by an IP Router as a distribution technique to a plurality of users can also be considered. The multicast distribution is a process of relaying in units of packets. When the multicast distribution is used by distributing the data output from the sensor to all users as they are the data can be collected and distributed by being dispersedly processed at plural nodes thereby shortening a delay. In addition a technique related to the above mentioned multicast distribution includes for example a technique related to MPLS Multi Protocol Label Switching .

Further as a third technique the following can be considered. A terminal receives streaming data from a stream server and requests to view the program to be viewed related to the streaming data. The stream server before transmitting the streaming data to the terminal which requested viewing caches common information of said program to be viewed to the common information data base and receives the viewing request for the same program to be viewed from other terminals. Then the stream server after transmitting the common information of the common information data base to said other terminals also transmits the streaming data actually distributed from the stream server to the other terminals as well in addition to the terminal under transmission.

Further as a fourth technique the following can be considered. A management server generates instructing information for preparing complex content on the basis of the content of the complex content to be prepared. A piece of intermediary equipment instructs a content server to eject a content part required for preparing the complex content in accordance with the instructing information. Each content server by corresponding to the content part instructed to be ejected acquires the complex contents elements whose encoding format is converted for a mobile terminal and responds to the intermediary equipment. The intermediary equipment combines in chronologic order the complex contents elements that the contents server responded with on the basis of the instructing information from the management server and prepares them as complex contents for a mobile terminal. The management server distributes the prepared complex contents to the mobile terminal.

According to one aspect of the present embodiment in a distribution system a plurality of distribution nodes and control nodes are connected via a network. The control node includes a memory and a processor. The processor of the control node on the basis of connection information indicating a connection state between distribution nodes and load information in a distribution node determines the distribution node of a distribution destination to which one of a plurality of distribution nodes distribute data subsequently and a data type distributed to the distribution node of the distribution destination. The processor of the control node distributes node information which specifies the determined distribution node of the distribution destination and the type information which specifies the determined data type to the distribution node.

The distribution node includes a memory and a processor. The processor of the distribution node receives the node information and the type information distributed from the control node. The processor of the distribution node when it receives data distributed from other distribution nodes selects the data of the type specified by the type information from the received data and transmits the selected type of data to the distribution node specified by the node information.

The object and the advantages of the invention will be realized and attained by means of the elements and combinations particularly pointed out in the claims.

It is to be understood that both the foregoing general description and the following detailed description are exemplary and explanatory and are not restrictive of the invention as claimed.

With the above mentioned first technique when all the data are integrated in a data center load is concentrated at one spot which may cause a bottleneck in a network band frequency and problems in server performance.

Further with the above mentioned second technique when multicast distribution is performed the data acquired at the sensor are delivered to the user as they are unprocessed and therefore each user is required to extract process the necessary data. Regarding networks since data including unnecessary data are distributed to the destination there is a concern that the band frequency of the network may be wasted in an undesirable manner.

Further with the above mentioned third technique with the presence of viewers of a streaming broadcast who joined in the middle of the broadcast a relaying device does not request common information from the stream server but distributes the common information already cached to the viewers who joined in the middle of the broadcast. However even with said third technique since the data including unnecessary data are distributed to the destination there is a concern that the band frequency of the network may be wasted in an undesirable manner.

Moreover with the above mentioned fourth technique regarding the load on a conversion device which used to perform a conversion process of segments by the above mentioned process being performed on the contents server side transmission quantity is reduced the concentration of the processed load on the conversion device is prevented and therefore the processed load is dispersed. However even with the above mentioned fourth technique the load is concentrated on the contents server side and therefore there may be a bottleneck in the band frequency of the network and problems with server performance.

As mentioned above since the data distributed between distribution nodes are distributed as they are unprocessed from the viewpoint of the users receiving said data at the end unnecessary data are distributed to them as well which as a result increases the network load.

Therefore the embodiments provide a distribution technique capable of reducing the data amount transmitted between distribution nodes.

The determining unit determines the distribution node of a distribution destination to which one distribution node of a plurality of distribution nodes distributes data subsequently and the data type distributed to the distribution node at the distribution destination for each distribution node on the basis of connection information and load information. The connection information is the information indicating the connection state between a plurality of distribution nodes . The load information is the information indicating the load state in each of the plurality of distribution nodes . An example of the determining unit is a process determining unit .

The distribution unit distributes node information which specifies the distribution node of the determined distribution destination and type information which specifies the type of the determined distribution data to a distribution node. An example of the distribution unit is a definition distribution unit .

The distribution node includes a receiving unit and a transmitting unit . The receiving unit receives the node information and the type information distributed from the control node . The transmitting unit selects the data of the type specified by the received type information from the received data when the data were received from other distribution nodes . The transmitting unit transmits the data of a selected type to the distribution node specified by the received node information. An example of a receiving unit is a definition setting unit . An example of the transmitting unit is a transmission processing unit .

By being so configured the distribution node can reduce the data amount forwarded between distribution nodes by forwarding of the data received from other distribution nodes only the data requested by the user to the distribution node of the distribution destination. In addition since only the data type requested by the user are distributed to the user the user can save the trouble of extracting necessary data from the distributed data.

In addition the control node further includes a request receiving unit . The request receiving unit receives the distribution request requesting the data distribution of any type from an information processing terminal . An example of the request receiving unit is a subscription controlling unit . The determining unit when it receives the distribution request determines a terminal distribution node distribution node which distributes data to information processing terminal of the distribution nodes distributable to the information processing terminal in accordance with the load information.

By being so configured the distribution node which actually distributes data to the information processing terminal can be determined in accordance with the load information from among the distribution nodes distributable to the information processing terminal .

In addition when the distributing node is classified to a group the determining unit extracts from node group information associating the distribution node and the group the distribution node which belongs to the group to which said distribution nodes belong the distribution nodes having been set beforehand as distribution nodes distributing to the information processing terminal. The determining unit determines which terminal distribution node is the distribution node distributing data to the information processing terminal in accordance with the load information of the extracted distribution nodes.

By being so configured the terminal distribution node can be determined from the distribution nodes which distribute data to the distribution node and which were set beforehand from among the plurality of distribution nodes as distribution nodes distributing data to said information processing terminal.

In addition the determining unit selects the distribution node which transmits or receives data of types which are targets of distribution requests of the distribution nodes extracted from the group as a terminal distribution node.

By being so configured the distribution node which transmits or receives the data of types which are targets of distribution requests of the distribution nodes which belong to a certain group can be preferentially selected as a terminal distribution node and therefore unnecessary filtering processes can be saved.

Further the determining unit measures the copy counts of data received by the distribution node as the load information. The determining unit in accordance with the copy counts determines the terminal distribution node from among the distribution nodes distributable to the information processing terminal .

By being so configured the distribution node can be determined to be a terminal distribution node in accordance with copy counts of the distribution nodes distributable to the information processing terminal .

The distribution node further includes a load information reporting unit . The load information reporting unit detects a utilization rate of a piece of operational equipment provided in the distribution node and transmits the detected utilization rate of the operational equipment to the control node . An example of the load information reporting unit is a load state collecting unit . At this time the control node further includes a load information updating unit . The load information updating unit uses the utilization rate of the operational equipment received from the distribution node and updates the load information. An example of the load information updating unit is a load information updating unit .

By being so configured the distribution node can be determined to be a terminal distribution node using the utilization rate of the operational equipment of the distribution nodes distributable to the information processing terminal .

The determining unit acquires the distribution node of the distribution destination determined by the distribution request after distribution of the node information of the distribution destination and the type information specifying the data type and the data type distributed to the distribution node of the distribution destination. At this time the distribution unit distributes the node information specifying the acquired distribution node of the distribution destination and the type information specifying the type of acquired data to the distribution node.

By being so configured just the node information specifying the distribution node of the distribution destination updated on or after the time of distributing node information and type information and the type information distribution definition specifying the acquired type of data can be delivered.

The determining unit determines the terminal distribution node as an uppermost distribution node in the distribution tree which is a distribution route for transmitting data and is represented by a tree structure said terminal distribution node being for an information processing terminal which transmitted the distribution request and having many data types included in the received distribution requests.

By being so configured the uppermost distribution node in the distribution tree can be determined to be a terminal distribution node without changing the distribution tree. In this way the data amount flowing on the network can be further reduced.

The determining unit measures the number of distribution requests including the which of the data types of the received distribution requests for each terminal distribution node is in the greatest number. The determining unit determines which terminal distribution node has the highest number of distribution requests that are measured as a root of a distribution tree which is a distribution route for distributing data and is represented by a tree structure .

By being so configured since the logic topology between distribution nodes is reviewed and the distribution node distributing many data types for distribution requests can be made into a route of a distribution tree for many users traffic flowing on the network can be reduced.

The control node further includes a communicating unit . The communicating unit communicates between the control nodes when there are a plurality of control nodes having a plurality of distribution nodes under management of the control nodes respectively. When any of the control nodes receives a distribution request the determining unit of the control node which received the distribution request performs the following process the determining unit selects the distribution node of the distribution destination to which one of a plurality of distribution nodes subsequently performs distribution on the basis of the connection information between a plurality of distribution nodes and the load information in each of the plurality of distribution nodes . At this time the determining unit determines on the basis of the information specifying the distribution node under management of each control node whether the selected distribution node is the distribution node under management of any of the control nodes. When it is determined that the selected distribution node is not the distribution node under management of any of the control nodes the communicating unit performs the following process the communicating unit reports to other control nodes that the communicating unit is sending data of the type which is the target of the distribution request from one or more of the distribution nodes under management of the other control nodes to the terminal distribution node for the information processing device which made a distribution request. An example of the communicating unit is a control node linking unit .

By being so configured the control nodes can be made operable in parallel which enables data distribution even with the increased system scale.

In the present embodiment in order to realize a reduction in the processing treatment for extracting the necessary data for each user as well as realize a reduction in unnecessary information forwarding the following process is performed using the distribution node and the control node. Hereinafter explanation is given treating the distribution node and the control node as separate instruments. However these instruments may be physically integrated into the same instrument node .

In the present embodiment the distribution node sends only the data types having a distribution request from the user of the messages sent from the sensor to the user terminal. Messages include for example layer 3 L3 header layer 4 L4 header layer 7 L7 protocol header and message content.

An example of the layer 3 header is an IP Internet Protocol header. An example of the layer 4 header is a TCP Transmission Control Protocol header. An example of the layer 7 protocol header is an HTTP HyperText Transfer Protocol header.

For example in the case of the messages constituted of XML Extensible Markup Language the distribution node causes only the tag that specifies the content corresponding to each data type having a distribution request from the user to be the distribution target.

Further in the present embodiment the distribution route from the distribution node to the user is changed on the basis of the state of the distribution system. With this instead of concentrating the sensor information on one distribution node and distributing the sensor information from the concentrated distribution node the sensor information can be distributed in a dispersed manner. The control node sets the distribution definition to each distribution node upon receiving the subscription request from the user. Here on the basis of topology information content of the subscription request and a load state of each distribution node the control node generates a distribution definition that would allow the user to copy data from the distribution node with a light load so that the load might not be concentrated at one point. The topology information means the information related to the positional relationship of the sensor the distribution node and the user. The control node performs the setting of the generated distribution definition for each distribution node.

Many variations can be considered regarding how to prepare this distribution definition. For example a method is considered by which the connection between distribution nodes a distribution tree is set to be fixed and only the distribution node which sends the data to the user via copying is switched. In this case in the control node the determination is made on the content of the copying process of distribution nodes and on the distribution node which becomes the connection destination of the user.

The control node here is not limited to a client terminal such as a personal computer PC but any embodiment is applicable so long as the control node is an application software which requires sensor information. For example the control node may be application software in a data center.

According to the present embodiment the data amount forwarded between the distribution nodes can be reduced. By applying the present embodiment in a distribution system with many clients and users which collects and distributes real time information it becomes possible to provide each user with only the necessary information preventing a concentration of load in the system. As a result enhancement of response performance from a user s point of view and the reduction in the traffic amount flowing on the network can be realized at the same time.

In the present embodiment the sensor collects four types of data temperature D moisture D rainfall D and wind velocity D and transmits the data regularly to the neighboring distribution node in node as an XML message. An example of the XML message transmitted by the sensor is illustrated in . It is determined beforehand that the user needs a portion of the information of the information transmitted by the sensor .

The present embodiment is based on the premise that the user U requires that the data of data types D and D be included in the topic and the user U requires only the data of the data type D and that the server requires all the data D to D . In the present embodiment the terminal of the user U the terminal of the user U and the server are all treated as distribution destinations.

Hereinafter in the explanation identifiers of distribution nodes to are represented as Node to Node .

The XML message includes the XML version information the topic the date and hour and the data type related information to . The data type related information is information related to the data type D and as an example includes the data type D and the value 25.5. The data type related information is information related to the data type D and as an example includes the data type D and the value 49. The data type related information is information related to the data type D and as an example includes the data type D and the value 0. The data type related information is information related to the data type D and as an example includes the data type D and the value 5.

Examples of message content also include SOAP Simple Object Access Protocol REST Representational State Transfer command HTML HyperText Markup Language text and the like.

In the distribution tree constructing phase S the distribution tree constructing information related to the association between distribution nodes is defined beforehand. The method of defining distribution tree constructing information is not particularly limited and for example an administrator may set the distribution tree constructing information manually or construct a distribution tree using multicast routing protocols or the like.

In the subscription request receiving phase S the control node receives the data type required by the user of the data included in the topic designated by the user from the user terminal . In addition the control node changes the distribution node which becomes the connection destination of the user terminal in accordance with the load of each of the current distribution nodes so that a specific distribution node will not be a bottleneck.

In the setting phase S the control node performs setting of a distribution definition to each distribution node so that the data from the sensor are distributed to the distribution destination with the determined distribution route.

In the data distributing phase S on the basis of the distribution definition set in S by using the information related to the association between distribution nodes link information each of the distribution nodes distributes only the data of the data type required by the user to the distribution destination set in the link information.

The subscription controlling unit receives the subscription request from the user terminal and writes the content of the subscription request in the user information table . The process determining unit generates the content of a relay definition table and the process definition table using the information registered in a user information table an inter node connection table a sensor information table and a node state table .

The definition distribution unit converts the content of a storage management table and a link management table into a format of a relay definition table and a process definition table of a distribution node and distributes them to the distribution node at the distribution destination.

The user information table is a table which manages the subscription request information of the user and the neighboring distribution node of the user. As to which distribution node the neighboring distribution node of the user is it is defined to be set beforehand using the declaration from the user the time taken from the transmission by the distribution node to the receipt by the user terminal delay time physical network information etc. The neighboring distribution node of the user neighboring node does not define the node which distributes the data to the user but defines the distribution node which is located in the vicinity of the user geographically. The data distribution to the user terminal is actually distributed from the distribution node a distribution node described in the storage node column of the storage management table determined by the process determining unit . The purpose of setting the neighboring node is as mentioned later to set the starting point of the search when searching for the distribution node with the lightest load from among the neighboring nodes which were set and the distribution nodes adjacent to said neighboring nodes.

The inter node connection table is a table which manages the connection relation between the distribution nodes. The manner of connecting between the distribution nodes and the manner of constructing the distribution route is defined to be determined by such techniques as manual settings by the administrator constructing multicast trees or the like.

The sensor information table is a table which manages the neighboring distribution node of a sensor . Which distribution node is selected from among the neighboring distribution nodes of the sensor is defined to be set beforehand using the declaration from the owner of the sensor the time taken from the transmission by the sensor to the receipt by the distribution node delay time information of the physical network etc.

The node state table is a table which manages the load for the relaying process of each distribution node. The control node manages the load of each distribution node by managing the maximum throughput and the current process state by using the node state table . The node state table may collect the CPU utilization rate or the like of each distribution node regularly or for example when the distribution data are generated constantly the node state table may manage the load by defining the number of processes in the distribution node as the load. In the present embodiment as an example of the latter the node state table manages the copy counts for messages per distribution node as a load.

The storage management table is a table which manages the distribution node storing the user terminal that is the distribution node actually distributing data to the user terminal . Even when the neighboring distribution node can be specified by the user information table in some cases the distribution node that actually and directly delivers data to the user terminal and the neighboring distribution node may be different. Thus the control node prepares a table which is different from the user information table as a storage management table and manages the distribution node which actually distributes the data to the user terminal . In addition the control node manages the distribution of data to users by using the storage management table as well.

The link management table is a table which grasps the relaying route connecting between distribution nodes as a link and manages the data type distributed by each link.

The distribution node is a relaying process device on a network. The distribution node includes a reception processing unit a topic identifying unit an destination determining unit a copy processing unit a filter processing unit a transmission processing unit a definition setting unit a relay definition table and a process definition table .

The reception processing unit receives a packet from a sensor or a neighboring distribution node and constitutes a message by assembling the received packet. The topic identifying unit identifies a topic included in the constituted message.

The destination determining unit following the relay definition table determines one or more of the relay destinations of the distribution data as a destination. The copy processing unit copies messages to be distributed to the relay destination in accordance with the number of destinations determined by the destination determining unit .

The filter processing unit following the content of the determined destination and the content of the process definition table deletes the XML tag on the unnecessary data type from the distributed message for each destination filtering process . The transmission processing unit decomposes a filter processed message into a packet and transmits the decomposed packet to the designated destination for example another distribution node user terminal server etc. .

The definition setting unit on the basis of the distribution definition distributed from the control node sets the relay definition table and the process definition table . The relay definition table is a table which manages the relay destination node and or a user group to be distributed for each topic. The process definition table is a table which manages the data type to be delivered for each topic and or destination.

The user U reports a subscription request to the control node using the user terminal . At this time from the user terminal together with the subscription request the user ID of the user U User the data type to which the user U makes a subscription request D and information of the neighboring node of the user terminal distribution node Node are transmitted to the control node as user subscription information. The control node may also manage the information of the neighboring node and obtain information of the neighboring node on the basis of the user ID User reported from the user terminal .

The subscription controlling unit when it receives subscription controlling information a subscription request from the user terminal Yes in S and S adds the user subscription information received from the user terminal to the user information table S . The subscription controlling unit reports to the process determining unit that the number of the user has increased.

Next the process determining unit performs a process of determining distribution nodes S . In the process of determining distribution nodes S the distribution node which actually distributes the distribution data to the user terminal is determined. The process of S is explained using .

The process determining unit performs a process of adding data types S . In the process of adding data types S the data type is added to the link management table so that the data type D required by the user U is distributed to the distribution node determined in S. Subsequently the process determining unit requests that the definition distribution unit distribute the distribution definition information on the data types.

The definition distribution unit upon receiving the distribution request from the process determining unit distributes the distribution definition information to each distribution node S .

Next explanation is given for cancelling a subscription. The topic whose subscription is to be cancelled is reported to the control node from the user terminal and from the user information table the user subscription information which is the target of a subscription cancellation is deleted. The process hereinafter is the same as that of the subscription request. Hereinafter a detailed explanation is given for the subscription cancellation.

The user U reports a subscription cancelling request to the control node using the user terminal . At this time the user terminal with the subscription cancelling request transmits the user ID of the user U User the data type whose subscription is cancelled D and information of the neighboring node of the user terminal distribution node Node to the control node as user subscription cancelling information.

The subscription controlling unit when it receives the subscription controlling information subscription cancelling request from the user terminal No in S and S deletes the entry which corresponds to the subscription cancelling information from the user information table S . The subscription controlling unit reports to the process determining unit that the number of the user has decreased.

The process determining unit using the subscription cancelling information from the subscription controlling unit acquires the identification information of the distribution node distributing the distribution data to the user terminal which reported the subscription cancelling request from the storage node of the storage management table S .

In the node state table the process determining unit decreases the load amount of the distribution node acquired in S by the predetermined value S . The value to be decreased differs in accordance with the types of loads to be monitored e.g whether the load amount to be used is any of a CPU utilization rate memory utilization rate etc.

The process determining unit performs the process of deleting data types S . In the process of deleting data types S the data types are deleted from the link management table so that the data types whose subscription is cancelled by the user U are not unnecessarily distributed to the distribution node which distributes the distribution data to the user terminal with the subscription cancelled.

The definition distribution unit distributes the distribution definition information to each distribution node upon receiving a distribution request from the process determining unit S .

Next the process determining unit refers to the node state table and determines whether or not the load amount for example the number of copies of the node Node included in the user subscription information exceeds the predetermined threshold value S . Here the predetermined threshold value is a value set to the allowable processing amount of the node state table .

In S when the load amount of the node Node included in the user subscription information does not exceed the threshold value No in S the node Node is selected.

On the other hand when the load of the node Node included in the user subscription information exceeds the threshold value Yes in S the process determining unit performs the following process. That is the process determining unit using the inter node connection table sequentially searches for the node whose load does not exceed the threshold value of the nodes adjacent to the neighboring node Node included in the user subscription information and selects the node S .

The process determining unit adds the Node Number Node of the Node selected in S or S the user ID User and the data type D to the storage management table S .

The process determining unit in the node state table increases the load amount of the entry which corresponds to the Node number Node selected in S or S by the predetermined amount S . When the load amount is the copy count 1 is added to the load amount of the entry which corresponds to the Node number Node .

To be specific the process determining unit in the inter node connection table searches for the entry in which the node set in the To column is the node determined in S Node . The process determining unit acquires the identification information of the link L stored in the data item link of the searched for entry and the identification information of the node Node stored in the From . The process determining unit acquires the entry including the identification information L of the acquired link from the link management table . The process determining unit confirms whether or not the data type D included in the user subscription information is stored in the data type of the acquired entry S . When the data type D included in the user subscription information is stored in the data type of the acquired entry that is when the data type is not insufficient No in S the flow is completed since D is delivered to Node .

When the data type D included in the user subscription information is not stored in the data type of the entry acquired from the link management table that is when the data type is insufficient Yes in S since D is not delivered to the storage node Node the process determining unit performs the following process. That is the process determining unit stores the data type D included in the user subscription information in the data item data type of the acquired entry S . Subsequently the process determining unit searches for the upper node the connection source of the link of the storage node Node in the inter node connection table so that D can be distributed sequentially from the node which is closer to the sensor S and repeats S and S . In the present embodiment since the data of the data type D have been delivered to Node D is set in the data item data type of the entry illustrating the link from Node to Node in the link management table .

The process determining unit requests that the definition distribution unit distribute the distribution definition to the distribution node at the time at which the updating of the link management table has been completed.

The above mentioned method is the method to distribute data of the data type required by the user to the user terminal of the user with the increase in the number of users with subscription requests. However for the purposes of optimizing the total distribution system the total storage management and link management may be reviewed regularly. A detailed explanation of this is given in the fifth and sixth embodiments.

The process determining unit searches for the upper node connection source of the link S and deletes the data type D from the entry of the link management table of the upper node. The process determining unit requests that the definition distribution unit distribute the distribution definition to the distribution node at the time at which the updating of the link management table has been completed.

That is in S the definition setting unit analyzes the distribution definition distributed from the control node and registers the storage node and the user ID of the storage management table as a destination of relay definition table . For example in the case of distribution node Node and Server are registered in a relay definition table as the destination. The address information of Node and Server are defined to be set in the control node or distribution node and in a state in which the address can be solved.

In addition in S the definition setting unit registers the data type defined for each User ID of the storage management table and for each To of the link management table in the process defining table . The entry is registered in the process definition table in such a way as to forward D D D and D to Server and to forward D and D to Node for example in the distribution node .

The reception processing unit receives the message S . The topic identifying unit analyzes the received message and acquires the identification information of the topic S . In the case of the distribution node the topic identifying unit identifies that it is a message on topic .

The destination determining unit searches the relay definition table with a topic identified in S as a key reads the destination information of the entry which includes the key and determines the destination S . In the case of the distribution node the destination determining unit reads that the destination is Server and Node with topic identified in S as a key. The destination determining unit reports the read destination to a copy processing unit .

The copy processing unit in accordance with the number of reported destinations copies the received message S . In the case of the distribution node the copy processing unit copies the received message to prepare a message for the attention of Server and Node since there are two destinations reported from the destination determining unit .

The filter processing unit on the basis of the process definition table deletes unnecessary XML tags from the received message filtering process S S .

In the case of the distribution node a filter processing unit refers to the content of the process definition table and forwards the message whose destination is Server as it is. On the other hand the filter processing unit regarding the message whose destination is Node deletes the XML tags of the data types D and D and prepares the message with only XML tags concerning the data types D and D.

The transmission processing unit forwards the message processed by the filter processing unit to each destination S .

Hereinafter a similar process is repeated in each distribution node and necessary data are delivered to a server a user terminal and a user terminal respectively.

For information there is no dependency with respect to the order of the copying process and the filtering process and when it is already known that the same filtering process has been repeatedly performed for enhancing the process efficiency the filtering process may be performed first followed by the copying process.

Thus of one or more distribution nodes adjacent to the user terminal a distribution node having some room for a load can be determined to be the distribution node which actually distributes data to the user terminal . From the determined distribution node on the basis of the existing link relation tracing is available up to the upper distribution node to which the data of the data type required by the user terminal are received. And from the upper distribution node the data of the data type can be pulled into the determined distribution node.

According to the present embodiment the control node generates the distribution definition of the relaying process on the basis of the topology information positional relationship of a sensor a distribution node and a user the content of a subscription request and the load state of each distribution node upon receipt of the user subscription request. And the control node instructs each distribution node to set the distribution definition. The distribution node following the instruction from the control node performs copying filtering and relaying processes. In this way just the necessary data can be distributed dispersedly to a plurality of users.

In the present embodiment explanation is given for the processing content when only the distribution definition updated on and after the previous distribution time is distributed to the distribution node. In the second embodiment the same reference numerals are allotted to a similar configuration to that of the first embodiment and the explanation thereof is abbreviated.

The distribution time management table maintains the date and hour at which the previous distribution was made.

In addition to the function of the first embodiment the process determining unit confirms the entry of the current storage management table and the link management table the content to be updated added or deleted and changes the updated time of storage management table and the link management table . When the content is to be deleted the process determining unit performs the process of deletion not by deleting the entry of the link management table but by leaving the data type column of the link management table blank.

In addition to the function of the first embodiment the definition distribution unit reads the previous distribution time from the distribution time management table and distributes only the entries distribution definition of storage management table and the link management table updated on and after the previous distribution time to the distribution node . In addition the definition distribution unit updates the distribution time of the distribution time management table by the date and hour at which the distribution definition is distributed to the distribution node .

Next an explanation is given for the process flow of the control node in the second embodiment. The process flow of the control node in the second embodiment has the processes of partially changed compared with the process in the first embodiment . For this explanation is given using .

According to the present embodiment the process determining unit makes the updated time writable in the storage management table and the link management table . The definition distribution unit in cooperating with the process determining unit which manages the updated time and the distributing time of the entry makes the distribution definition of the difference between the current distribution and the previous distribution distributable.

In the third embodiment explanation is given for selecting a distribution node from among a plurality of distribution nodes which actually performs distribution to the information processing device from a distribution node which belongs to one distribution node adjacent to the information processing device which made a distribution request. In the third embodiment the same reference numerals are allotted to a similar configuration to that of the first or second embodiment and the explanation thereof is abbreviated.

For users in the vicinity of area A as long as such an area is in area A there is not much difference as to which distribution nodes data are distributed from. In addition a situation might occur such that the user in the vicinity of area A wants to avoid the distribution from the node in the vicinity of area B as much as possible.

Therefore in the present embodiment of a plurality of distribution nodes the distribution node is selected which actually distributes data from the distribution nodes belonging to the group of a distribution node which is in the vicinity of the information processing device which made a distribution request to the information processing device. Here the group is set in accordance with the distribution route communication environment etc. For example in the present embodiment the band frequency between the groups is defined to be narrower than the predetermined threshold value. In addition any group may be set.

The process determining unit selects one distribution node of the group of the distribution nodes using the inter node connection table . At this time the process determining unit preferentially selects the distribution node from the nodes having a user terminal which requests the data type of the same copy target using the inter node connection table so that unnecessary filtering processes can be avoided.

For example after the process of the first embodiment has been completed the user U is defined as having newly made a subscription request of the data types D and D. And at this time for example the distribution node adjacent to the user terminal of the user U is Node . In addition as illustrated in the node group table of Node Node and Node are defined as being in the same group. In this case the process determining unit refers to the node group table and determines the distribution node from among the Node Node and Node .

The process determining unit when it determines the distribution node of the user terminal of the user U which newly becomes the distribution destination refers to the link management table and preferentially selects the node in which the data type received by the distribution node and the data type distributed to the user terminal are the same.

When there is no such node in which the data type received by the distribution node and the data type distributed to the user terminal are the same in the link management table the process determining unit performs the following process. That is the process determining unit refers to the storage management table and preferentially selects the distribution node to be transmitted which stores the user distributing the same data type.

Next explanation is given for the process flow of the control node in the third embodiment. The process flow of the control node in the third embodiment has the process of changed in the process of the first embodiment .

The process determining unit reads the distribution node which belongs to the group of the distribution node selected in S from the node group table S .

The process determining unit searches for whether or not the data type received by the distribution node and the data type performing distribution to the user terminal of the user which made a subscription request are the same by using the link management table S .

As a result of the search in S when there is a node in which the data type received by the distribution node and the data type performing distribution to the user terminal of the user which made the subscription request are the same Yes in S the process determining unit performs the following process. That is the process determining unit selects the searched for distribution node S .

When there is no node in which the data received by the distribution node and the data performing distribution to the user terminal of the user which made a subscription request in the link management table are the same No in S the process determining unit performs the following process. That is the process determining unit searches for whether or not there is anode in which the data type transmitted by the distribution node and the data type performing distribution to the user terminal of the user which made subscription request are the same by using the storage management table S .

As a result of the search in S when there is a node in which the data type transmitted by the distribution node and the data type performing distribution to the user terminal of the user which made a subscription request in the storage management table are the same the process determining unit performs the following process. That is the process determining unit selects the searched distribution node S .

As a result of the search in S when there are no nodes in which the data type transmitted by the distribution node and the data type performing distribution to the user terminal of the user which made a subscription request in the storage management table are the same the process determining unit performs the following process. That is the process determining unit randomly selects one of the distribution nodes read in S .

The process determining unit refers to the node state table and determines whether the load amount for example copy counts of the distribution node selected in S S or S exceeds the predetermined threshold value S . Here predetermined threshold value means the value which is set to be the allowable processing amount of the node state table .

In S when it is determined that the load amount of the distribution node exceeds the threshold value Yes in S the process determining unit performs the following process. That is the process determining unit determines whether or not the load amount of all the distribution nodes which belong to the distribution node group selected in S S or S exceeds the threshold value S . When it is determined that the load amount of the distribution node exceeds the threshold value Yes in S in all of the groups to which the selected distribution belongs the process determining unit performs the following process. That is the process determining unit refers to the node group table selects the other group adjacent to said group S and goes back to the process of S .

When it is determined that the load amount of the distribution node does not exceed the threshold value No in S in all the groups to which the selected distribution node belongs the process determining unit goes back to the process of S .

In S when it is determined that the load amount of the distribution node does not exceed the threshold value No in S the process determining unit adds the selected Node No. Node user ID User and data type D to the storage management table S .

In the node state table the process determining unit increases the load amount of the entry which corresponds to the Node No. Node selected in S S or S by the predetermined value S . When the load amount is the copy counts the entry which corresponds to the Node No. Node is increased by 1 .

According to the present embodiment the control node selects from among a plurality of distribution nodes to the information processing device the distribution node which actually performs distribution from the distribution node belonging to the group of one distribution node adjacent to the information processing device which made a subscription request to the information processing device. In addition since the control node can preferentially select from the distribution nodes which transmit to the information processing device requesting the same data type it can save unnecessary filtering process.

In the first embodiment the load judgment was made on the basis of information such as copy count and the like which can be grasped at the control node side. On the other hand in the present embodiment explanation is given for collecting the load information from each distribution node and reflecting the information as a node state. In this way such a process becomes available based on more precise load information. In the fourth embodiment the same reference numerals are allotted to a similar configuration to that of the first to third embodiments and the explanation thereof is abbreviated.

The load state collecting unit monitors the resources at the distribution node side and regularly reports the monitoring result to the control node side.

The load state updating unit receives the monitoring result reported from the distribution node and updates the node state table . For example when the CPU load of the distribution node is monitored by the distribution node the entry content of the node state table may be made to be the utilization rate of the CPU.

In the process determining unit refers to the node state table and determines whether or not the load amount current CPU utilization rate of the node Node included in the user subscription information exceeds the predetermined threshold value S . Here the predetermined threshold value means the value set to the allowable CPU utilization rate of the node state table . Hereinafter the explanation is abbreviated since it is similar to .

According to the present embodiment the control node can employ the CPU load state of the distribution node in the process of determining the load amount of the distribution node.

In addition although in the fourth embodiment the monitor target was the CPU load of the distribution node it is not limited to this and numerical data such as utilization amount of memory and the like which can be grasped as a resource may also be employed.

In the fifth embodiment explanation is given for the process of reviewing the distribution node which actually performs distribution to the user terminal. In the fifth embodiment the same reference numerals are allotted to the configuration similar to the first to fourth embodiments and the explanation thereof is abbreviated.

When such a situation comes to pass the control node executes the process of reviewing the distribution form of the distribution node so as to perform redistribution from the optimal distribution node. For example it is considered that when 20 subscription requests are received from the user the process reviews the distribution form of the distribution node once. Also in accordance with the passage of time the distribution form of the distribution node may be regularly reviewed for example at each hour.

Therefore in the fifth embodiment as illustrated in an algorithm is used that would allot more data types sequentially from a node located further upstream in the same group in the third embodiment to a user who wishes to have them.

The system configuration of the fifth embodiment is similar to that of the third embodiment . Of the flow charts of the distribution node the process added to the third embodiment is illustrated in .

The process determining unit selects a user whose distribution node is undecided since the reviewing process has not been made by the process of the present flow and a user with many types of subscription request information from the user information table S .

Of the distribution tree the process determining unit selects the uppermost node as a distribution source with room for a load as a distribution source S . Here the process determining unit acquires the storage node which corresponds to the user from the storage management table setting the user selected in S as a key. The process determining unit refers to the inter node connection table and searches for the uppermost node of the acquired storage node. The process determining unit refers to the node state table and determines whether or not the load amount of the uppermost node exceeds the predetermined threshold value. Here predetermined threshold value means the value which is set to be the allowable processing amount of the node state table . When it is determined that the load amount of the uppermost node does not exceed the predetermined threshold value the process determining unit selects the uppermost node as the distribution node which actually performs distribution to the user selected in S.

Next the process determining unit performs the process of adding data types S . The process of adding data types in S is similar to the process of S explained in .

The process determining unit determines whether or not the distribution source is decided for all the users belonging to the group selected in S of the users registered in the user information table S . Of the users registered in the user information table when the distribution source is not decided for all the users belonging to the group selected in S No in S the process determining unit goes back to the process of S. When the distribution source is decided for all the users belonging to the group selected in S Yes in S the process determining unit performs the processes of S to S to all of the groups.

According to the fifth embodiment the control node can review the storage state of the user in the total distribution system by controlling which node the data type is to be distributed from and to which user terminal without changing the topology between the distribution nodes. Thus by resetting the distribution form of the distribution node the data amount flowing on the network can be further reduced.

Although the distribution node which actually distributes to the user terminal may be reviewed in the fifth embodiment the distribution tree itself is not reviewed. However when considering the configuration of the physical network the traffic flowing on the network is considered to be reduced when the distribution node is made into a root of a distribution tree when the users with many data types in their subscription are gathering on the terminal of the distribution tree.

Therefore in the sixth embodiment explanation is given for reviewing the logic topology between the distribution nodes. The system configuration of the sixth embodiment is similar to that of the fifth embodiment. In the sixth embodiment the same reference numerals are allotted to the configurations similar to the first to fifth embodiments and the explanation thereof is abbreviated.

Next the process determining unit selects the node stored in the storage node with the highest count in the result of the above mentioned count as a root of a distribution tree S .

The process determining unit prepares the distribution tree making the selected node a root S . When the distribution tree is prepared making the selected node a root the process determining unit may adopt a constructing method of a distribution tree using for example a multicast routing protocol or the like. As an example the process determining unit may prepare a distribution tree making the selected node a rendezvous point. Rendezvous point means a relaying device which becomes the center for sharing a tree when sharing one distribution tree to perform routing of multicast data even when there are a plurality of multicast groups.

According to the present embodiment since the distribution node which distributes to a user with many data types in their subscription requests can be made into a root of the distribution tree by reviewing the logic topology between the distribution nodes the traffic flowing on the network can be reduced.

In the seventh embodiment explanation is given for how to cope with the enlarged distribution system. In the seventh embodiment the same reference numerals are allotted to configurations similar to the first to sixth embodiments and the explanation thereof is abbreviated.

When the number of distribution nodes greatly increases and when it becomes unable to be controlled with just the single control node a plurality of the control nodes are set and these control nodes perform control in parallel. In this case each control node has the control node distribution node management table which has stored the distribution node managed by each of the control nodes. In this way each control node on the basis of the control node distribution node management table treats a plurality of distribution nodes managed by each of the control nodes as one domain distribution node group under management of the same control nodes and performs distribution control by the domain unit.

The user issues a subscription request to the control node which manages the network to which the user terminal itself belongs using the user terminal . The control node determines a distribution node for the user terminal among distribution nodes under the control node.

When the distribution route covers distribution nodes under control of a plurality of control nodes it is necessary to adjust the data type to be distributed between the control nodes. Therefore the control node linking unit adjusts the data type to be distributed between the control nodes when the distribution route covers distribution nodes under control of the plurality of control nodes.

In the process of adding and deleting data types said control node linking unit when it becomes necessary to change the distribution data of a node which is further upward than the node under its own control requests that the other control node add and delete the distribution data type.

The control node which receives the adding and deleting request of the distribution data type on the basis of the requested content performs the process of adding and deleting the data type and sets the changed content in the distribution node under management.

In the control node the identification information which identifies the control node is stored. In the node the identification information which identifies the node managed by the control node stored in the control node is stored.

Next explanation is given for the process flow of the control node in the seventh embodiment. The process flow of the control node in the seventh embodiment has the processes of changed from the process of the first embodiment . For this explanation is given using . are the processes when said control node linking unit requests that the other control node add or delete the distribution data type.

The process determining unit reads the inter node connection table and specifies the link between a node storage node selected in S or S Node and a distribution node whose storage node is a connection destination Node . Then the process determining unit confirms whether or not the data type D included in the user subscription information is configured to reach the link using the link management table .

To be specific the process determining unit in the inter node connection table searches for the entry of the node determined at To S Node . The process determining unit acquires the identification information of the link stored in the link of the searched for entry L and identification information of the node stored in From Node . The process determining unit acquires an entry which includes the identification information of the acquired link L from the link management table . The process determining unit confirms as to whether or not the data type D included in the user subscription information is stored in the data type of the acquired entry S . When the data type D included in the user subscription information is stored in the data type of the acquired entry No in S since this means that D reaches the Node the flow is completed.

When the data type D included in the user subscription information is not stored in the data type of the entry acquired from the link management table Yes in S since D does not reach the storage node Node the process determining unit performs the following process. That is the process determining unit stores the data type D included in the user subscription information in the data type of the entry acquired from the link management table S . Then the process determining unit searches for an upper node connection source of the link of the storage node Node from the inter node connection table S so that D is delivered from nodes close to the sensor in turn.

The process determining unit refers to the control node distributing node management table and determines whether the node searched for in S is a distribution node which is under management of said control node S .

When the node searched for in S is a distribution node which is under management of said control node No in S the process determining unit goes back to the process of S .

When the node searched for in S is not a distribution node which is under management of said control node Yes in S the process determining unit performs the following process. That is the process determining unit refers to the control node distribution node management table and specifies the control node which manages the searched for node. The process determining unit requests that the control node linking unit add the data types to the link management table for the specified control node request to add data type S .

The process determining unit searches for from a storage management table the entry with a user ID which conforms to the user ID included in the subscription cancelling information and acquires the identification information of the node stored in the data item storage node of the entry. The process determining unit in the inter node connection table searches for the entry To the acquired node Node . The process determining unit acquires the identification information of the link stored in the link of the searched for entry L and the identification information of the node stored in From Node . The process determining unit deletes D from the link management table when the D is included in the data type of the entry which includes the identification information of the acquired link L Yes in S S .

The process determining unit refers to the inter node connection table and searches for the upper node connection source of the link of the Node a node included in the subscription cancelling information S .

The process determining unit refers to the control node distributing node management table and determines whether the node searched for in S is a distribution node under management of said control node.

When the node searched for in S is a distribution node under management of said control node No in S the process determining unit goes back to the process of S S .

When the node searched for in S is not a distribution node under management of said control node Yes in S the process determining unit performs the following process. That is the process determining unit refers to the control node distribution node management table and specifies the control node which manages the searched for node. The control node linking unit requests that the specified control node delete the data types from a link management table for the specified control node request to delete data type S .

Next explanation is given for the process performed at the side of the control node which received the request for adding and deleting the data types transmitted from the control node linking unit .

The process determining unit of the control node performs the process of adding data types S . The process of adding data types S is similar to the process of S in . In the process of adding data types S data types are added to the link management table so that the data type required by the user may be distributed to the distribution node selected in S . Subsequently the process determining unit of the control node requests that the definition distribution unit of the control node distribute the distribution definition information of the data types.

The definition distribution unit of the control node upon receiving the distribution request from the process determining unit refers to the control node distribution node management table and distributes the distribution definition information to each of the self managing distribution nodes S . The distribution definition distribution process S is similar to the process of S in .

The process determining unit of the control node performs the process of deleting data types S . The process of deleting data types S is similar to the process of S in . In the process of deleting data types S the data types are deleted from the link management table so that the data types whose subscription is cancelled may not be unnecessarily distributed to the distribution node. Subsequently the process determining unit requests that the definition distribution unit distribute the distribution definition information of the data types.

The definition distribution unit upon receiving the distribution request from a process determining unit distributes distribution definition information to each distribution node S . The process of a distribution definition distribution process S is similar to the process of S in .

According to the present embodiment between the control nodes when the node which can distribute the data type with the subscription request from the user or the node which can stop distributing the data type with the subscription cancelling request from the user is not under the management of the control node each control node can deliver the changed content to the other control node. Therefore by separating the distribution node to a domain and by making the control node operable in parallel data can be distributed even when the scale of the system is enlarged.

According to the first to seventh embodiments the data types required at the distribution destination are set in each node beforehand and when each node receives data on the basis of the set information only the data types required at the distribution destination are forwarded and thereby the data amount forwarded between distribution nodes can be reduced.

Here the CPU represents a central processing unit and is one example of a processor. The ROM represents a read only memory. The RAM represents random access memory. The I F represents an interface. The CPU the ROM the RAM the communication I F the memory device the output I F the input I F and the readable device are connected with the bus . The readable device is a device which reads a portable memory medium. The output equipment is connected with the output I F . The input equipment is connected with the input I F .

As the memory device a memory device with a various kinds of formats can be used including a hard disc device a flash memory device a magnetic disc device etc. When the computer is a control node a program which controls the operation of the entire control node and the program related to the present embodiment are stored in the memory device or the ROM . The CPU by reading the program related to the present embodiment from the memory device or the ROM functions as a subscription controlling unit a process determining unit a definition distribution unit a load state updating unit and a control node linking unit .

When the computer is a control node the memory or the ROM includes a user information table an inter node connection table a sensor information table a node state table a storage management table and a link management table . In addition the memory device or the ROM includes a distribution time management table a node group table and a control node distribution node management table .

When the computer is a distribution node a program which controls the operation of the entire distribution node and a program related to the present embodiment are stored in the memory device or the ROM . The CPU by reading the program related to the present embodiment from the memory device or the ROM functions as a reception processing unit a topic identifying unit an destination determining unit a copy processing unit a filter processing unit a transmission processing unit and a definition setting unit . The CPU by reading the program related to the present embodiment from the memory device or the ROM further functions as a load state collecting unit .

Further when the computer is a distribution node the memory device or the ROM includes a relay definition table and a process definition table .

The program which realizes the process explained in the above mentioned embodiments may be stored for example in the memory device from the program provider side via a communication network and a communication I F . In addition the program which realizes the process explained in the above mentioned embodiments may be stored in a commercially available and distributable portable memory medium. In this case this portable memory medium may be set in the readable device the program being read by the CPU and executed. As the portable memory medium a memory medium with various formats may be used including a CD ROM a flexible disc an optical disc a magnetic optical disc an IC card a USB memory device etc. Programs stored in such a medium are read by the readable device .

In addition a keyboard a mouse an electronic camera a web camera a microphone a scanner a sensor a tablet etc. can be used for the input equipment . Further a display device a printer a speaker etc can be used for the output equipment . Moreover the network may be a communication network including the Internet LAN Local Area Network WAN Wide Area Network an exclusive line a wired line a wireless line etc.

In addition the present invention is not limited to the embodiments stated so far above and can take the form of various configurations and embodiments within a range not departing from the gist of the present invention.

All examples and conditional language recited herein are intended for pedagogical purposes to aid the reader in understanding the invention and the concepts contributed by the inventor to furthering the art and are to be construed as being without limitation to such specifically recited examples and conditions nor does the organization of such examples in the specification relate to a depicting of the superiority and inferiority of the invention. Although the embodiments of the present invention have been described in detail it should be understood that the various changes substitutions and alterations could be made hereto without departing from the spirit and scope of the invention.

