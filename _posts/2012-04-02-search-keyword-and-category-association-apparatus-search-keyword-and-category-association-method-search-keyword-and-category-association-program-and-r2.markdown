---

title: Search keyword and category association apparatus, search keyword and category association method, search keyword and category association program and recording medium
abstract: To associate a keyword with a category having a high degree of relevance with the keyword. An association apparatus comprises an acquisition means that acquires the number of times when each of a plurality of categories of a search target is designated as a search condition together with a keyword, and a registration means that registers category information indicating the category for which the number of times acquired by the acquisition means is a threshold or more, and the keyword in an associated manner.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09600560&OS=09600560&RS=09600560
owner: Rakuten, Inc.
number: 09600560
owner_city: Tokyo
owner_country: JP
publication_date: 20120402
---
This application is a National Stage of International Application No. PCT JP2012 058892 filed Apr. 2 2012 claiming priority based on Japanese Patent Application No. 2011 189428 filed Aug. 31 2011 the contents of all of which are incorporated herein by reference in their entirety.

The present invention relates to a technical field of a system for acquiring a keyword or a category of a search target as a search condition and for making a search based on the search condition.

There is conventionally known a search system for receiving a search condition designated by a user from a terminal apparatus via a network and making a search based on the designated search condition. Information designatable as the search condition is a keyword a category of a search target or the like. The category of a search target indicates a range containing similar objects when objects to be searched are classified according to a preset reference for example. The category is genre category price range region or the like for example according to each search system.

For example Non Patent Document 1 discloses a technique for searching a restaurant therein. The technique employs categories of restaurants such as region where a restaurant is present business form of a restaurant price range for eating and the like. When the user designates a keyword as a search condition restaurants whose names or explanations contain the keyword are searched for example. Then a list of searched restaurants is displayed on the screen. A list of categories to which the searched restaurants belong is displayed on the screen. When the user selects any category among the categories displayed in the list search refinement is made on the restaurants by the selected category. When the list of categories is displayed the categories are preferentially displayed in descending order of the number of restaurants searched by the designated keyword. That is as a category has more restaurants the category is displayed to be more easily searched by the user.

However a category to which many objects searched by a keyword belong is not necessarily a category having a high degree of relevance with the keyword. This will be described assuming a product as a search target. It is assumed that product genres are beverage and perfume for example. It is assumed herein that a keyword designated as a search condition is water . Beverage is to be drunk for hydration. The genres of beverage includes mineral water or water itself as a product. On the other hand perfume is more focused on its application for perfuming than on being liquid. If a product of perfume is to be searched not water but perfume may be designated as a keyword. Thus it is reasonable that beverage has a higher degree of relevance with water than perfume. The characters of perfume are contained in the product name or explanation of perfume in many cases. Thus more products of perfume may be searched by the keyword water than the products of beverage.

When water is designated as a search condition as in the technique described in Non Patent Document 1 a list of genres of products is assumed to be displayed. At this time if water is not associated with beverage as a keyword and a genre having a high degree of relevance therebetween the genres of perfume may be preferentially displayed to the genres of beverage. The genres of perfume are preferentially displayed and thus the user may not easily search a genre of beverage regarded as having a high degree of relevance with the keyword water from the list.

As described above if a relevance between a keyword and a category is not considered user s convenience may be lowered. However it is complicated to manually extract and associate a pair of keyword and category having a high degree of relevance therebetween. With the manual operation a determination as to whether the relevance is high depends on an individual subjective view and thus a pair of keyword and category having a high degree of relevance therebetween is not necessarily extracted appropriately.

The present invention has been made in terms of the above problems and it is an object thereof to provide an association apparatus capable of associating a keyword and a category having a high degree of relevance with the keyword an association method an association program and a recording medium.

In order to achieve the above described problems an invention described in claim is characterized in that an association apparatus comprising an acquisition means that acquires the number of times when each of a plurality of categories of a search target is designated as a search condition together with a certain keyword and a registration means that registers category information indicating the category for which the number of times acquired by the acquisition means is a threshold or more and the certain keyword in an associated manner.

According to the invention a category which is designated as a search condition together with a keyword many times may be regarded as having a high degree of relevance with the keyword and thus the keyword can be associated with the category having a high degree of relevance with the keyword.

An invention described in claim is characterized in that the association apparatus according to claim wherein when a degree of variation of the number of times acquired by the acquisition means in the plurality of categories exceeds a variably set degree the registration means makes the registration.

According to the invention since when the number of times when a category is designated as a search condition together with a keyword varies in a plurality of categories the keyword can be associated with the category a category designated more times than other categories in the categories can be associated with the keyword.

An invention described in claim is characterized in that the association apparatus according to claim or claim wherein when a plurality of sub categories are set as the categories belonging to the category indicated by the category information registered by the registration means in association with the certain keyword the acquisition means acquires the number of times when each of the plurality of sub categories is designated as a search condition together with the certain keyword and the registration means registers category information indicating the sub category for which the acquired number of times is a threshold or more and the certain keyword in an associated manner.

According to the invention when the categories are hierarchically defined a category having a high degree of relevance with a keyword can be hierarchically associated.

An invention described in claim is characterized in that the association apparatus according to any one of claims to wherein the registration means registers the category information of the category for which the number of times acquired by the acquisition means is a threshold determined depending on the number of categories or more and the certain keyword in an associated manner.

According to the invention a category having a high degree of relevance with a keyword can be appropriately extracted depending on the number of categories.

An invention described in claim is characterized in that the association apparatus according to any one of claims to wherein the search target is a transaction target to be dealt in a commercial transaction and the acquisition means acquires the number of times when a deal of the transaction target is done based on the transaction target searched under the search condition for the number of times when the certain keyword is designated as a search condition together with the category.

According to the invention a keyword and a category which have a higher degree of relevance therebetween can be associated with each other in case that the search target is a transaction target than in case that the keyword is only designated as search conditions.

An invention described in claim is characterized in that the association apparatus according to any one of claims to wherein the acquisition means acquires the number of times when each of the plurality of categories is designated together with the certain keyword per attribute information of a user who designates and the registration means registers the category information indicating the category for which the number of times acquired by the acquisition means is a threshold or more and the attribute information as well as the certain keyword in an associated manner.

According to the invention association suitable for an attribute of the user designating a search condition can be performed.

An invention described in claim is characterized in that the association apparatus according to any one of claims to further comprising a keyword acquisition means that acquires a keyword designated as a search condition and a display order determination means that determines based on the number of times acquired by the acquisition means a display order of the category by a category display means that displays the category registering the category information therein by the registration means in association with a keyword acquired by the keyword acquisition means from among the plurality of categories in a designatable manner.

According to the invention a category designatable for refinement from among the search targets searched by a user designated keyword which has a high degree of relevance with the designated keyword can be preferentially displayed. Thus the user can easily search a category to be designated as a search condition.

An invention described in claim is characterized in that the association apparatus according to any one of claims to further comprising a character string acquisition means that acquires a character string input in a keyword input column as a search condition together with the category information of the category designated as a search condition and a keyword determination means that determines a keyword displayed by a keyword display means that displays a keyword containing a character string acquired by the character string acquisition means as a search condition in a designatable manner and makes a determination such that a keyword registered by the registration means in association with the category information acquired by the character string acquisition means is preferentially displayed.

According to the invention when a keyword containing a user input character string is displayed as a candidate of the keyword to be designated as a search condition a keyword having a high degree of relevance with a designated category can be preferentially displayed. Thus the user can easily designate a keyword.

An invention described in claim is characterized in that the association apparatus according to any one of claims to further comprising a keyword acquisition means that acquires a keyword designated as a search condition an evaluation value acquisition means that acquires an evaluation value for determining a display order as a search result the evaluation value being of a search target searched based on a keyword acquired by the keyword acquisition means and an evaluation value change means that increases the evaluation value of a search target belonging to the category indicated by the category information registered by the registration means in association with a keyword acquired by the keyword acquisition means among the searched search targets relative to the evaluation value of other search target.

According to the invention a display order as a search result of a search target belonging to a category having a high degree of relevance with a designated keyword can be increased. Thus the user can easily search a search target having a high degree of relevance with the keyword from the search results.

An invention described in claim is characterized in that an association method performed by a computer comprising an acquisition step of acquiring the number of times when each of a plurality of categories of a search target is designated as a search condition together with a certain keyword and a registration step of registering category information indicating the category for which the number of times acquired by the acquisition means is a threshold or more and the keyword in an associated manner.

An invention described in claim is characterized in that an association program for causing a computer to function as an acquisition means that acquires the number of times when each of a plurality of categories of a search target is designated as a search condition together with a certain keyword and a registration means that registers category information indicating the category for which the number of times acquired by the acquisition means is a threshold or more and the certain keyword in an associated manner.

An invention described in claim is characterized in that a recording medium computer readably recording an association program therein the program causing a computer to function as an acquisition means that acquires the number of times when each of a plurality of categories of a search target is designated as a search condition together with a keyword and a registration means that registers category information indicating the category for which the number of times acquired by the acquisition means is a threshold or more and the certain keyword in an associated manner.

According to the present invention a category which is designated as a search condition together with a keyword many times may be considered as a category having a high degree of relevance with the keyword and thus the keyword can be associated with the category having a high degree of relevance with the keyword.

An embodiment according to the present invention will be describe below in detail with reference to the drawings. The embodiment described below is where the present invention is applied to a shopping system.

A structure of a shopping system S according to the present embodiment will be first described with reference to . is a figure illustrating an exemplary outline structure of the shopping system S according to the present embodiment.

As illustrated in the shopping system S includes an electronic mall server and a plurality of user terminals . The electronic mall server and each user terminal can mutually exchange data via a network NW or by use of a communication protocol such as TCP IP. The network NW is constructed of Internet a dedicated communication line such as CATV Community Antenna Television line a mobile communication network including a base station or the like a gateway or the like for example.

The electronic mall server exemplary association apparatus according to the present invention is a server apparatus that performs various processings for the electronic mall from which products can be purchased. A user can purchase a desired product from a desired shop by use of the electronic mall. The electronic mall server transmits a Web page of the electronic mall or performs a processing of searching or purchasing a product for example in response to a request from the user terminal .

The user terminal is a terminal apparatus of a user utilizing the electronic mall. The user terminal accesses the electronic mall server in response to a user operation thereby receiving and displaying a Web page from the electronic mall server . The user terminal comprises a CPU a memory an operation unit for receiving a user operation a display for displaying information on a display screen and the like. The user terminal incorporates software such as browser and e mail client therein. The user terminal employs a portable information terminal such as personal computer PDA Personal Digital Assistance or Smartphone a cell phone or the like for example.

A search condition used for searching a product in the electronic mall and a Web page for designating a search condition will be described below with reference to .

When a product is searched in the electronic mall a keyword a product genre or the like can be designated as a search condition. A keyword designated as a search condition is called search keyword. The user may designate both a search keyword and a genre at the same time as search conditions or may designate either of them.

A product genre exemplary category according to the present invention is a range to which products having similar type property or use application or the like belong when products are classified by type property use application or the like for example. The product genres are hierarchically defined in a tree structure. Specifically each node in the tree structure corresponds to a genre. A depth of a node corresponds to a level hierarchy of the genre corresponding to the node. The depth of a node is a distance from the node positioned at the root which will be called root node below . In the tree structure the root node defines a genre called genre top for convenience. As a value of the level is larger a depth of the level is larger and as a value of the level is smaller a depth of the level is smaller. The genre top indicates that the user designate no genre. The genre top is a genre at level 0. A genre corresponding to a child node is a genre at level 1 with respect to the genre top. The genre at level 1 is substantially the highest ordered genre as a user designatable genre. The genres at level 1 include water soft drink beauty cosmetics perfume pet pet goods ladies fashion men s fashion and the like for example. A genre corresponding to a child node is defined as a genre at level 2 with respect to each genre at level 1. Herein a genre c2 corresponding to a child node of a certain genre c1 is called child genre of the genre c1. The child genre is also called sub genre. The genre c1 at this time is called parent genre of the genre c2. The child genre is a range to which similar products belong when the parent genre is further classified. Thus the child genre belongs to the parent genre. A genre corresponding to a descendent node is called descendent genre with respect to a certain genre. For example a genre c3 is assumed as a child genre of the genre c2. In this case the genres c2 and c3 are the descendent genres of the genre c1. When a certain genre has a child genre a plurality of child genres are usually defined. For example the child genres of water mineral water define water mineral water soft drink coffee cocoa and the like for example. The genres belonging to the same parent genre are called brother genre. For example water mineral water soft drink and coffee cocoa are mutually the brother genres. For the genres at and subsequent to level 2 a child genre is defined as needed.

The Web pages for designating a search condition include the top page and a search result page for example. The top page is a Web page positioned at the highest order in the electronic mall. The search result page is a Web page indicating a product search result. The search result page is a Web page for designating a search condition for refining and searching products from the searched products which will be called refinement condition below or re designating a search condition. When the user designates a search condition in the top page a products is searched under the designated search condition by the electronic mall server and a search result page indicating the search result is displayed by the user terminal . Further when the user designates a search condition in the search result page a product is searched again under the designated search condition by the electronic mall server and a new search result page displaying the search result is displayed by the user terminal .

When the user designates a search condition in the search result page the search condition designated in the top page or search result page displayed immediately before the search result page which will be called previous page below may be taken over. For example it is assumed that a search keyword k1 is designated as a search condition in the top page or search result page. Then a search result page indicating a search result by the search keyword k1 is displayed. Herein when the user designates the genre c1 as a search condition the search keyword k1 and the genre c1 are considered as being designated as search conditions. Then a new search result page indicating a search result by the search keyword k1 and the genre c1 is displayed. That is the user designated the genre c1 as a refinement condition. It is assumed that the genre c2 is designated as a search condition in the top page or search result page. A search result page indicating a search result by the genre c2 is displayed. Herein when the user designates a search keyword k2 as a search condition the genre c2 and the sear keyword k2 are considered as being designated as search conditions. Then a new search result page indicating a search result by the genre c2 and the search keyword k2 is displayed. That is the user designated the search keyword k2 as a refinement condition. In the following description the designation of a search keyword or a genre as a search condition in a previous page includes when the user inputs a search keyword or selects a genre in a previous page for explicit designation and when a search condition is taken over thereby to be regarded as being designated.

The search condition setting region includes a keyword input column a genre selection menu a search button and the like. The keyword input column is an input region for inputting a search keyword therein. The genre selection menu is a pull down menu for selecting a genre to be designated as a search condition from among the genres at level 1. The search button is a button for designating a search keyword input in the keyword input column and a genre selected in the genre selection menu as search conditions. When the search button is selected while a search keyword is input the search keyword is designated as a search condition and a search is made under the search condition. Then when the search button is selected while a genre is selected the genre is designated as a search condition and a search is made under the search condition. The user operates the search condition setting region thereby designating both or either of a search keyword and a genre as a search condition.

The genre list display region displays a list of genres therein. Each genre displayed in the genre list display region is integrated genres at level 1. When the user selects any genre from among the genres displayed in the genre list display region a list of genres at level 1 belonging to the selected genre is displayed. Then when the user selects any genre from among the displayed genres at level 1 the selected genre is designated as a search condition and a search is made under the search condition.

The search condition setting region includes a keyword input column a search button and the like. The keyword input column is an input region for inputting a search keyword therein. Further the keyword input column corresponds to a keyword suggest function like the keyword input column on the top page. When a search keyword is designated as a search condition in a previous page the search keyword is previously input in the keyword input column . When the search button is selected while the search keyword is input in the keyword input column the search keyword is designated as a search condition and a search is made under the search condition. Herein if a genre is designated as a search condition in a previous page the genre is also regarded as being designated as a search condition together with the search keyword.

The genre designation region includes one more genre links . The genre link is directed for designating a genre as a refinement condition and indicates the name of a genre to be designated. When the user selects any genre link from the genre designation region a genre corresponding to the selected genre link is designated as a search condition and a search is made under the search condition. If a search keyword is designated as a search condition in a previous page the search keyword is also regarded as being designated as a search condition together with the genre. When a genre is designated as a search condition in a previous page the genre designation region displays a genre link corresponding to a child genre of the designated genre. On the other hand when a search result page is displayed with only the search keyword designated as a search condition in the top page a genre link corresponding to a genre at level 1 is displayed in the genre designation region in the search result page.

The associated keyword display region is displayed when a search keyword is designated as a search condition in a previous page. The associated keyword display region includes an associated keyword link . The associated keyword link is directed for re designating a keyword associated with a search keyword designated in a previous page which will be called associated keyword below as a search condition and searching a product and indicates an associated keyword to be designated. Associated keywords of a search keyword include a word similar to the search keyword a word meaning objects associated with the object indicated by the search keyword a word containing the search keyword and the like. An upper limit of the number of associated keywords displayable in the search keyword candidate display region is previously set. When the user selects any associated keyword link from the associated keyword display region an associated keyword corresponding to the selected associated keyword link is designated as a search keyword and a search is made under the search condition. Herein when a genre is designated as a search condition in a previous page the genre is also regarded as being designated as a search condition together with the search keyword.

The search result display region displays a list of information on searched products therein. Specifically the search result display region displays relevant product information containing searched product image product name price shop name and the like per product. The relevant product information is displayed in a display order of the searched products. Specifically the relevant product information is displayed in an upper part in the search result display region in a higher display order. Further an upper limit of the number of items of the relevant product information displayable in the search result display region is previously determined. For example when the upper limit is 30 the search result display region displays the relevant product information on the top 30 products. Herein when the user selects a link displaying next 30 a new search result page is displayed on the screen of the user terminal and the search result display region in the search result page displays the relevant product information on the 31 to 60 ordered products. A display order of the relevant product information is determined based on listing scores. The listing score is a value indicating an evaluation determined for a product or a product page of the product. A higher listing score indicates a higher evaluation. Then as a product has a higher listing score a display order of the relevant product information on the product is higher. For example a listing score may be higher as a product page is more accessed more viewed or a listing score may be higher as a product is purchased more times. When the user selects any relevant product information from among the relevant product information displayed in the search result display region a product page is displayed on the screen. The product page is a Web page displaying therein detailed information on a product corresponding to the selected relevant product information . The user can purchase a product whose information is displayed in the product page by performing a purchase operation in the product page.

The electronic mall server extracts a search keyword and a genre having a high degree of relevance with the search keyword and registers them in an associated manner in a database in order to enhance user s convenience in a search result page.

A genre having a high degree of relevance with a search keyword is a genre which is designated as a search condition together with the search keyword many times. The number of times is called number of designations. When the user designates a search condition a search query is transmitted from the user terminal to the electronic mall server . The search query is a message indicating a request for a product. When a search keyword is designated as a search condition the designated search keyword is set in the search query. When a genre is designated as a search condition the genre ID is set in the search query. The genre ID is genre identification information. When receiving the search query from the user terminal the electronic mall server records a query log. The query log is a history of the received search query. The electronic mall server calculates the number of designations of each pair of search keyword and genre designated as search conditions based on the query logs.

The number of designations includes the number of times when the user explicitly designates both a search keyword and a genre at the same time and the number of times when the user designates either one of a search keyword and a genre in a previous page and designates the other as a refinement condition in a search result page displayed thereby so that both the search keyword and the genre are considered as being designated. When the user designates a search keyword and a genre for example the user may think that a product which he she wants to search by the designated search keyword is in the products in the designated genre. That is the user thinks that the designated search keyword is associated with the genre. This is because a product he she wants to search meets the search conditions indicated by the designated search keyword and genre. Thus a pair of search keyword and genre is designated more times and thus the search keyword and the genre may have a higher degree of relevance therebetween. Then if a search keyword is associated with a genre having a high degree of relevance with the search keyword user s convenience may be enhanced on search.

A determination is made as to whether a pair of search keyword k and genre c is designated many times based on the number of designations of a pair of search keyword k and brother genre of the genre c. As the number of designations of the genre c is relatively larger the genre c may have a higher degree of relevance with the search keyword k than other genres.

A relevance score is determined for a pair of search keyword and genre extracted as having a high degree of relevance. The relevance score indicates a degree of relevance between a search keyword and a genre. A higher relevance score indicates a higher degree of relevance.

A method for extracting a pair of search keyword and genre having a high degree of relevance therebetween will be described below in detail. Applications of an extraction result of the pair will be described below.

The first application is to control display of genre links in the genre designation region in a search result page. Specifically when a search keyword is designated as a search condition in a previous page the genre designation region preferentially displays therein a genre link having a high degree of relevance with the designated search keyword. A genre link in the genre designation region is displayed in a higher order as the relevance score between a designated search keyword and a genre is higher. When the genre links as a series of genres are displayed the user may select a genre link of a genre regarded as being associated with the previously designated search keyword. Thus a genre having a higher degree of relevance with the designated search keyword is more likely to be designated as a refinement condition by the user. Therefore the user can easily search a genre to be designated as a refinement condition from the genre designation region .

Herein when the user selects WATER SOFT DRINK as the genre link a new search result page is displayed. As illustrated in WATER MINERAL WATER as the genre link among the child genres of WATER SOFT DRINK is displayed in the genre designation region in the search result page. Herein when the user selects the all genres display button the genre inks of all the child genres of WATER SOFT DRINK are displayed in the genre designation region .

For example it is assumed that a search keyword nurse has a high degree of relevance with LADIES FASHION and SHOES respectively. In this case when the user designates a search keyword nurse in the top page LADIES FASHION and SHOES as the genre links among the genres at level 1 are displayed in the genre designation region in the search result page as illustrated in . In this way a genre for which the genre links are displayed in the genre designation region changes depending on a search keyword designated in a previous page.

The second application is to control display of a search keyword candidate in the keyword suggest function in the keyword input column in a search result page. This is performed when a genre is designated as a search condition in a previous page. Specifically a keyword having a high degree of relevance with the genre designated in the previous page among the keywords matching in the left hand part with the character string input by the user in the keyword input column is preferentially displayed as a search keyword candidate. The keyword is displayed in a higher order at this time as the relevance score between the designated genre and the keyword is higher. A search keyword having a higher degree of relevance with the designated genre is more likely to be designated as a refinement condition by the user. Therefore the user can easily designate a search keyword as a refinement condition.

Then a keyword containing an input character string such as a keyword whose kana indicating the pronunciation contains the input character string may be displayed in the keyword input column . Thus for example a keyword matching in the right hand part with the input character string may be displayed.

A genre may be designated in a search result page. For example a check box or the like for selecting a genre is displayed in a search result page. Then when the user selects a check box corresponding to a genre and inputs a character string in the keyword input column a keyword having a high degree of relevance with the selected genre among the keywords containing the input character string may be displayed in the search keyword candidate display region . Further when the user selects a genre from the genre selection menu and inputs a character string in the keyword input column in the top page a keyword having a high degree of relevance with the selected genre among the keywords containing the input character string may be displayed in the search keyword candidate display region .

The third application is to control display of associated keyword links in the associated keyword display region . This is performed when a search keyword and a genre are designated as search conditions in a previous page. Specifically an associated keyword link of an associated keyword having a high degree of relevance with the genre designated in a previous page among the associated keywords of the search keyword designated in the previous page is preferentially displayed in the associated keyword display region . A display order of the associated keyword link in the associated keyword display region is higher as the relevance score between the designated genre and the associated keyword is higher. As the associated keyword has a higher degree of relevance with the designated genre the user is more likely to designate the associated keyword as a refinement condition. Thus the user can easily designate the associated keyword as a search keyword.

The fourth application is to adjust a listing score for determining a display order of relevant product information on each product in the search result display region . This is performed when a search keyword is designated in a previous page. Specifically among the products searched by a search keyword designated in a previous page a listing score of a product having a high degree of relevance with the search keyword is increased. When a genre is designated as a search condition in the previous page only the listing scores of products belonging to descendent genres of the designated genre are increased. Thereby a display order of a product in a genre having a high degree of relevance with the search keyword may be increased. Therefore the user can easily search a product having a high degree of relevance with the search keyword from the search result display region . Further a listing score of a product other than the products in the genres having a high degree of relevance with the search keyword may be lowered.

For example when the user designates a search keyword water in the top page a list of information on products searched by water is displayed in the search result display region in a search result page. At this time the listing scores of the products for WATER SOFT DRINK and the products for PET PET GOODS having a high degree of relevance with water are increased.

The communication unit is connected to the network NW to control a communication state with the user terminal or the like.

The storage unit is configured of a hard disk drive or the like for example. The storage unit constructs therein databases such as a member information DB a product information DB a genre information DB a keyword DB an associated keyword DB a query log DB a designation frequency information DB and a keyword associated genre information DB

Other information stored in the storage unit will be described below. The storage unit stores therein various items of data such as HTML HyperText Markup Language document for displaying Web pages XML Extensible Markup Language documents image data text data and electronic documents. The storage unit stores therein various setting values set by the manager and the like.

The storage unit stores therein various programs such as operating system WWW World Wide Web server program DBMS Database Management System electronic commerce management program and product evaluation program. The electronic commerce management program is directed for performing the processings for the electronic mall such as extracting a pair of search keyword and genre having a high degree of relevance therebetween generating a search result page searching a product and ordering a product. The product evaluation program is directed for determining a listing score of each product. The listing score of each product is updated as needed by the product evaluation program and the listing score is stored in the storage unit in association with the product ID for example. The system control unit can acquire the listing score from the product evaluation program via a dedicated API Application Programming Interface for example. Various programs may be acquired from other server apparatuses and the like via the network NW or may be recorded in a recording medium such as DVD Digital Versatile Disc and read via a drive device.

The I O interface performs an interface processing between the communication unit as well as storage unit and the system control unit .

The system control unit is configured of a CPU a ROM Read Only Memory a RAM Random Access Memory and the like. The CPU reads and executes various programs so that the system control unit functions as an acquisition means a registration means a keyword acquisition means a display order determination means a character string acquisition means a keyword determination means an evaluation value acquisition means and an evaluation value change means according to the present invention.

The electronic mall server may be configured of a plurality of server apparatuses. For example a server apparatus for extracting a pair of search keyword and genre having a high degree of relevance therebetween a server apparatus for performing the processings of searching and ordering a product a server apparatus for transmitting a Web page in response to a request from the user terminal a server apparatus for managing a database and the like may be connected to each other via LAN or the like.

 3. Method for Extracting Pair of Search Keyword and Genre having High Degree of Relevance Therebetween 

A method for extracting a pair of search keyword and genre having a high degree of relevance therebetween will be described below in detail with reference to and .

Herein a search keyword to be extractable is assumed as k. A genre having a high degree of relevance with the keyword k is assumed to be extracted from the genres at level 1 for convenient description. A set of genres at level 1 is assumed as G. At first the system control unit determines whether a genre having a high degree of relevance with the keyword k may be present in the genres at level 1. Specifically each genre is determined as to a degree of variation offset of the number of designations when it is designated as a search condition together with the keyword k. As each genre is less varied in the number of designations or is higher in uniformity there is no difference between each genre and the keyword k in their relevance. Then no difference in their relevance indicates that a genre having a particularly high degree of relevance with the keyword k is not present in the genres at level 1. When a degree of variations of the number of designations exceeds a variably set certain degree the system control unit determines that a genre having a high degree of relevance with the keyword k is present in the genres at level 1. The determination employs entropy for example. Assuming the entropy as E E is calculated in the following Equation 1.

In Equation 1 p c is a probability at which the genre c is designated which will be called designation probability below when the keyword k is designated as a search condition together with a genre at level 1. p c is calculated in the following Equation 2.

In Equation 2 sc k c is the number of times when the genre c is designated as a search condition together with the keyword k. p c is calculated based on the number of times when the genre c was designated together with the keyword k in the past and thus p c is also a rate at which the genre c is designated for all the genres at level 1.

The system control unit calculates the entropy E and then compares the entropy E with a threshold. Assuming the threshold as when E is met it is determined that a genre having a high degree of relevance with the keyword k is present. The entropy E tends to be higher as the number of genres at level 1 is larger. This is because the maximum value of the entropy E is higher as the number of genres is larger. Thus the threshold needs to be variably set depending on the number of genres. Assuming the number of genres at level 1 as n the maximum value of the entropy E is log n . The system control unit calculates the threshold in the following Equation 3 for example. Mathematical Formula 3 1 log Equation 3

When determining that a genre having a high degree of relevance with the keyword k may be present in the genres at level 1 the system control unit determines which genre has a high degree of relevance with the keyword k from among the genres at level 1. Specifically the system control unit compares the designation probability with a threshold. Assuming the threshold as when p c is met it is determined that the genre c has a high degree of relevance with the keyword k. The threshold is the minimum value of the designation probability at which the genre c is determined to have a high degree of relevance with the keyword k. The designation probability tends to be higher as the number of genres at level 1 is smaller. Thus the threshold needs to be variably set depending on the number of genres. Thus the system control unit calculates the threshold in the following Equation 4 for example.

In Equation 4 K2 is a constant meeting K2 2. K3 is an integer constant of 3 or more. K2 and K3 are set by the manager for example. When K2 is set at 1 or more the threshold can be set at 1 n or more as an average value of the designation probability. The threshold is set depending on the number of genres when the number of genres is less than K3 because 1 n largely changes relative to a change in the number of genres when the number of genres is small. On the other hand the threshold is set to be constant when the number of genres is K3 or more because a genre which does not actually have a high degree of relevance with the keyword k is more likely to be determined to have a high degree of relevance therebetween when the threshold is too small. A method for determining the threshold is not limited to the method described herein. The threshold may be determined to be higher as the number of genres is smaller.

Herein the designation probability p c is the relative number of designations of the genre c for the total numbers of designations of all the genres at level 1. Thus a determination as to whether the designation probability is the threshold or more is a determination as to whether the number of designations sc k c of the genre c is equal to or more than a threshold 2 of the number of times calculated in the following Equation 5.

The threshold 2 is the minimum value of the number of designations when the genre c is determined to have a high degree of relevance with the keyword k. The system control unit may determine whether the genre c has a high degree of relevance with the keyword k by comparing the number of designations with the threshold 2 instead of comparing the designation probability with the threshold .

When it is determined that the genre c has a high degree of relevance with the keyword k the system control unit determines a relevance score for the pair of genre c and keyword k. For example the relevance score may be higher as the number of designations is larger. For example the number of designations itself may be employed as a relevance score. The relevance score may be determined such that the relevance score is higher as the number of designations is larger and the relevance score is higher as the designation probability is larger. For example a calculation equation using the number of designations and the designation probability as variables may be used to calculate a relevance score. When determining a relevance score the system control unit registers the keyword k the genre ID of the genre c and the relevance score in the keyword associated genre information DB in an associated manner.

Exemplary extraction results of pairs of keyword and genre having a high degree of relevance therebetween will be described herein. and are graphs indicating a designation probability per genre at level 1. and indicate the graphs only for some genres among all the genres at level 1.

The genres at and subsequent to level 2 will be described below. is a figure illustrating how a genre associated with the keyword k is extracted at each level. When extracting a genre having a high degree of relevance with the keyword k from among the genres at level 1 the system control unit tries to extract a genre having a high degree of relevance with the keyword k from among the child genres of the extracted genre. For example as illustrated in it is assumed that the genre g1 is extracted as a genre having a high degree of relevance with the keyword k from among the genres g1 g2 g3 and the like at level 1. In this case a genre having a high degree of relevance with the keyword k is extracted from among the child genres g11 g12 g13 and the like of the genre g1. This is because when a genre has a high degree of relevance with the search keyword a genre having a high degree of relevance with the search keyword may be present also among the child genres of the genre. On the other hand a genre is not extracted from the child genres of the genre g2 and the child genres of the genre g3.

The method for extracting a genre having a high degree of relevance with the keyword k at and subsequent to level 2 is basically the same as for level 1. In Equation 1 and Equation 2 for calculating the entropy E a set of child genres of a genre which is determined to have a high degree of relevance with the keyword k may be assumed as G. In Equation 3 and Equation 4 for calculating a threshold the number of child genres of a genre which is determined to have a high degree of relevance with the keyword k may be set at n.

In the entropy E is a threshold 1 or less for the child genres of the genre g1 and thus a genre having a high degree of relevance with the keyword k is extracted from among the child genres of the genre g1. For example the designation probability of the genre g11 and the designation probability of the genre g13 are a threshold 1 or more respectively and thus the genre g11 and the genre g13 are registered in association with the keyword k respectively. A determination is made for the child genres of the genre g11 as to whether the entropy E is the threshold or less. Herein a genre is not extracted from among the child genres of the genre g11 since the entropy E is not a threshold 11 or less. On the other hand a genre having a high degree of relevance with the keyword k is extracted from among the child genres g131 g132 g132 and the like of the genre g13 since the entropy E is a threshold 13 or less. Herein the designation probability of the genre g132 is a threshold 13 or more and thus the genre is registered in association with the keyword k for example. Further a determination is made for the child genres of the genre g132 as to whether the entropy E is a threshold 132 or less. In this way the system control unit hierarchically extracts a genre having a high degree of relevance with the keyword k by depth first searching for example.

By the way when calculating the number of designations when each genre is designated together with the keyword k the system control unit adds the number of designation of a child genre to the number of actual designations of the parent genre thereof. For example it is assumed in that the numbers of designations of the genres gill g112 and g113 at level 3 are 5 7 and 3 respectively. Herein it is assumed that the number of designations of the genre g11 which is the parent genre of the genre gill and the like is 10. In this case a total value of the numbers of designations of the genres g111 g112 and g113 is added to the number of designations of the genre g11. Therefore the number of designations of the genre g11 reaches 25. Further 25 which is the number of designations of the genre g11 is added to the genre g1 which is the parent genre of the genre g11. In this way the number of designations of a genre is reflected on each genre from the parent genre of the genre to the genres at level 1. A certain genre designated together with the keyword k indicates that part of the total parent genre of the genre is designated together with the keyword k. Thus in this case this is because the parent genre is also designated together with the keyword k. Further the number of designations of a child genre may not be added to the number of designations of the parent genre.

At first the system control unit initializes the designation frequency DB and the keyword associated genre information DB step S . Specifically the system control unit deletes all of the information registered in the databases. Then the system control unit initializes a keyword genre list step S . The keyword genre list is a list in which pairs of search keyword genre ID and number of designations are registered.

Then the system control unit acquires a pair of search keyword and genre ID from the query logs registered in the query log DB step S . Specifically the system control unit acquires pairs of search keyword and genre ID from the query logs in a period of time when reception time date is previously set such as in a period of time from the present time up until 30 days ago . At this time the system control unit acquires the pairs from the query logs in which both a search keyword and a genre ID are set.

Next the system control unit as an acquisition means acquires the number of times when each genre is designated as a search condition together with a search keyword step S . Specifically the system control unit selects one pair from among the pairs of search keyword and genre ID acquired from the query logs. Then the system control unit counts as the number of designations the number of pairs having the same search keyword and genre ID as the selected pairs from among the pairs acquired from the query longs. At this time the system control unit contains the selected pair itself in the number of designations. Then the system control unit selects one pair from the pairs acquired from the query logs except the same pairs as the previously selected pairs. Then the system control unit counts the selected pair in the number of designations similarly in the above method. Subsequently the system control unit performs the same processing until a selectable pair is not present.

When terminating the processing in step S the system control unit registers the search keyword the genre ID and the number of designations in an associated manner in the keyword genre list for each pair of search keyword and genre ID for which the number of designations is calculated step S .

Then the system control unit selects one of the search keywords registered in the keyword genre list step S . The selected search keyword is called selected keyword herein. Then the system control unit searches a pair containing the same search keyword as the selected keyword from the keyword genre list. The system control unit generates a search list made of searched pairs step S . Then the system control unit selects one pair in which the level of the genre corresponding to the genre ID is the deepest from among the pairs registered in the search list step S . The level of the genre is contained in the genre information corresponding to the genre ID among the genre information registered in the genre information DB . Herein the genre corresponding to the genre ID contained in the selected pair is called selected genre. 

Then the system control unit determines whether the level of the selected genre is level 1 step S . At this time when determining that the level of the selected genre is not level 1 step S NO the system control unit determines whether a pair containing the genre ID of the parent genre of the selected genre is present among the pairs registered in the search list step S . The genre ID of the parent genre of the selected genre is contained in the genre information corresponding to the genre ID of the selected genre. When determining that a pair containing the genre ID of the parent genre of the selected genre is present step S YES the system control unit adds the number of designations contained in the selected pair to the number of designations contained in the pair containing the genre ID of the parent genre step S . On the other hand when determining that a pair containing the genre ID of the parent genre of the selected genre is not present step S NO the system control unit newly adds the pair of selected keyword genre ID of the parent genre and number of designations to the search list step S . The system control unit assumes the number of designations at this time to be the same as the number of designations contained in the selected pair.

When determining that the level of the selected genre is level 1 in step S step S YES when the processing in step S is terminated or when the processing in step S is terminated the system control unit determines whether an unselected pair is present among the pairs registered in the search list step S . At this time when determining that an unselected pair is present step S YES the system control unit selects one pair in which the level of the genre corresponding to the genre ID is the deepest from among the unselected pairs step S . Then the system control unit proceeds to step S. The system control unit repeats the processings in steps S to S thereby adding the number of designations of each genre to each genre from the parent genre of the genre to the genres at level 1.

On the other hand when determining that all the pairs are selected step S NO the system control unit registers the designation frequency information in the designation frequency information DB step S . Specifically the system control unit registers the selected keyword in the designation frequency information DB and registers the genre ID and the number of designations contained in each pair registered in the search list in association with the selected keyword. Then the system control unit sets the genre ID of the genre top as an argument of an associated genre extraction processing to be performed next step S . Then the system control unit performs the associated genre extraction processing step S . In the associated genre extraction processing a selected keyword and a genre having a high degree of relevance with the selected keyword are registered in an associated manner. The associated genre extraction processing can make a recursive call. The associated genre extraction processing will be described below in detail.

Then the system control unit determines whether an unselected search keyword is present in the search keywords registered in the keyword genre list except the same keywords as the previously selected search keywords step S . At this time when determining that an unselected search keyword is present step S YES the system control unit selects one of the unselected search keywords step S . Then the system control unit proceeds to step S. The system control unit repeats the processings in steps S to S thereby extracting all the pairs of search keyword and genre having a high degree of relevance therebetween. When determining that all the search keywords are selected step S NO the system control unit terminates the keyword genre association processing.

When the selected keyword is designated as a search condition less times the system control unit may not perform the associated genre extraction processing on the selected keyword. In this case each genre is designated as a search condition together with the selected keyword less times and thus it does not necessarily have a high degree of relevance with the selected keyword. For example the system control unit calculates a total value of the numbers of designations contained in the respective pairs registered in the search list when generating the search list in step S. When the total value is smaller than a previously set value the system control unit does not perform the steps S to S and proceeds to step S.

At first the system control unit calculates the number of child genres of the genre corresponding to the argument genre ID step S . Specifically the system control unit counts the number of genre IDs registered in the child genre ID list contained in the genre information corresponding to the argument genre ID. Then the system control unit calculates the threshold of the entropy based on the calculated number of child genres step S . For example the system control unit calculates the threshold by use of Equation 3 described above.

Then the system control unit calculates a designation probability corresponding to the selected keyword for each child genre of the genre corresponding to the argument genre ID step S . That is the system control unit performs a processing corresponding to the calculation in Equation 2 described above. Specifically the system control unit acquires the genre ID from the child genre ID list contained in the genre information corresponding to the argument genre ID. Then the system control unit searches the number of designations corresponding to the acquired genre ID from the designation frequency information corresponding to the selected keyword. At this time when the number of designations corresponding to the acquired genre ID is not registered in the designation frequency information the number of designations of the genre with the genre ID is assumed at 0. The system control unit makes as many searches as the genre IDs registered in the child genre ID list. Then the system control unit calculates a total value of the numbers of designations searched. The system control unit divides the number of designations searched by the total value thereby calculating a designation probability.

Then the system control unit calculates the entropy E based on the calculated number of designations step S . That is the system control unit calculates Equation 1 described above. The system control unit determines whether the entropy E is the threshold or less step S . At this time when determining that the entropy E is not the threshold or less step S NO the system control unit terminates the associated genre extraction processing. On the other hand when determining that the entropy E is the threshold or less step S YES the system control unit calculates the threshold of the designation probability based on the number child genres step S . For example the system control unit calculates the threshold by use of Equation 4 described above.

Then the system control unit selects one of the child genres of the genre corresponding to the argument genre ID step S . Herein the selected child genre is called selected child genre. Then the system control unit determines whether the designation probability of the selected child genre is the threshold or more step S . At this time when determining that the designation probability is the threshold or more step S YES the system control unit determines the relevance score of the selected child genre depending on the number of designations of the selected child genre step S . Then the system control unit as a registration means associates the selected keyword the genre ID of the selected child genre and the determined relevance score and registers them as one record in the keyword associated genre DB step S . Then the system control unit determines whether a child genre of the selected child genre is set step S . Specifically when a child genre list is set in the genre information corresponding to the genre ID of the selected child genre the system control unit determines that a child genre is set and when a child genre list is not set determines that a child genre is not set. At this time when determining that a child genre is set step S YES the system control unit sets the genre ID of the selected child genre as an argument of the associated genre extraction processing step S . Then the system control unit performs the associated genre extraction processing step S .

When determining that the designation probability of the selected child genre is not the threshold or more in step S step S NO when determining that a child genre is not set in step S step S NO or when the processing in step S is terminated the system control unit determines whether an unselected child genre is present in the child genres of the genre corresponding to the argument genre ID step S . At this time when determining that an unselected child genre is present step S YES the system control unit selects one of the unselected child genres step S . Then the system control unit proceeds to step S. On the other hand when determining that all the child genres are selected step S NO the system control unit terminates the associated genre extraction processing.

At first the system control unit searches a product meeting a search condition designated by the user step S . Specifically when a search keyword is set in the search query the system control unit searches product information containing the search keyword in at least one of the product name and the product explanation from the product information DB . When a genre ID is set in the search query the system control unit searches the product information of the product belonging to the genre corresponding to the genre ID from the product information DB based on the genre ID contained in the product information. When the search keyword and the genre ID are set in the search query the system control unit searches the product information which contains the search keyword in at least one of the product name and the product explanation and belongs to the genre corresponding to the genre ID.

Then the system control unit records a query log step S . Specifically the system control unit acquires present time date as reception time date. Then the system control unit generates a query log containing the reception time date the search keyword and genre ID set in the search query. At this time when the user requesting to search is logging in the system control unit contains sex age and prefecture in the query log. For example the system control unit receives the user ID from the user terminal and stores the received user ID as a cookie in the user terminal when the user logs in the electronic mall. Thus when the user is logging in the search query is added with the cookie containing the user ID. Therefore the system control unit acquires the user ID from the cookie added to the search query. The system control unit acquires member information corresponding to the user ID from the member information DB . Then the system control unit specifies sex age and prefecture based on the member information. The system control unit registers the generated query log in the query log DB

Then the system control unit acquires a template of HTML document of a search result page from the storage unit step S . Then the system control unit performs a search condition setting region setting processing step S . Specifically the system control unit sets the genre ID in the acquired template such that when the genre ID is set in the search query the genre ID is transmitted together with the search keyword input in the keyword input column when the search button in the search result page is selected.

Then the system control unit performs a genre designation region setting processing step S . In the genre designation region setting processing data for displaying a genre link in the genre designation region in the search result page is set in the acquired template. Then the system control unit performs an associated keyword display region setting processing step S . In the associated keyword display region setting processing data for displaying an associated keyword link in the associated keyword display region in the search result page is set in the acquired template. Then the system control unit performs a search result display region setting processing step S . In the search result display region setting processing data for displaying relevant product information in the search result display region in the search result page is set in the acquired template. Further the genre designation region setting processing the associated keyword display region setting processing and the search result display region setting processing will be described below in detail.

Then the system control unit transmits the HTML document of the search result page completed by setting each item of information to the user terminal which is the transmission source of the search query step S . When terminating this processing the system control unit terminates the search query reception processing.

At first the system control unit determines whether a search keyword is designated as a search condition step S . That is the system control unit determines whether a search keyword is set in the search query. At this time when determining that a search keyword is not designated step S NO the system control unit performs a normal processing of displaying a genre link step S . Specifically when a genre ID is not set in the search query the system control unit generates data for a genre link for each genre at level 1. On the other hand when the genre ID is set in the search query the system control unit generates data for a genre link for each child genre of the genre corresponding to the genre ID. When generating the data for a genre link the system control unit sets URL for product search in the href attribute of tag. Herein the system control unit adds the genre ID of the corresponding genre to URL indicating the transmission destination of the search query and generates URL for product search. The system control unit sets the genre name of the corresponding genre between the start tag and the end tag of the tag. The system control unit additionally sets the generated data for a genre link in a region corresponding to the genre designation region in the acquired template. When terminating this processing the system control unit terminates the genre designation region setting processing.

On the other hand when determining that a search keyword is designated step S YES the system control unit determines whether a genre is designated as a search condition step S . That is the system control unit determines whether the genre ID is set in the search query. Herein the genre corresponding to the genre ID set in the search query is called designated genre. At this time when determining that a genre is designated step S YES the system control unit acquires a child genre ID list from the genre information corresponding to the genre ID of the designated genre among the genre information registered in the genre information DB step S . On the other hand when determining that a genre is not designated step S NO the system control unit acquires a child genre ID list from the genre information of the genre top step S . That is the system control unit acquires a list of genre IDs of the genres at level 1.

When terminating the processing in step S or S the system control unit searches a record containing the genre ID registered in the acquired child genre ID list among the records containing the search keyword from the keyword associated genre DB step S . Specifically the system control unit acquires one genre ID from the child genre ID list. Then the system control unit searches a record containing the acquired genre ID and the search keyword. The system control unit performs the processing on all the genre IDs registered in the child genre ID list.

Then the system control unit determines whether a relevant record is present as a result of the searching in step S step S . At this time when determining that a relevant record is not present step S NO the system control unit proceeds to step S. This is a case that a genre having a high degree of relevance with the search keyword designated by the user is not present.

On the other hand when determining that a relevant record is present step S YES the system control unit selects a record having the highest relevance score from among the searched records step S . Then the system control unit generates data for a genre link of the genre corresponding to the genre ID contained in the selected record step S . The generation method is the same as the method described in step S. However when generating URL for product search the system control unit generates URL indicating the transmission destination of the search query added with the genre ID of the corresponding genre and the search keyword. Then the system control unit additionally sets the generated data for a genre link of the genre in a region corresponding to the genre designation region in the acquired template step S .

Then the system control unit determines whether an unselected record is present in the searched records step S . At this time when determining that an unselected record is present step S YES the system control unit selects one record having the highest relevance score from among the unselected records step S . Then the system control unit proceeds to step S. The system control unit repeats the processings in steps S to S and as a display order determination means determines a display order of the genre links of the genre having a high degree of relevance with the search keyword based on the relevance scores. That is the system control unit preferentially displays a genre link whose genre has a higher relevance score. Then when determining that all the records are selected step S NO the system control unit terminates the genre designation region setting processing.

At first the system control unit determines whether a search keyword is set as a search condition step S . At this time when determining that a search keyword is not designated step S NO the system control unit terminates the associated keyword display region setting processing. On the other hand when determining that a search keyword is designated step S YES the system control unit determines whether a genre is set as a search condition step S .

At this time when determining that a genre is not designated step S NO the system control unit performs a normal processing of displaying an associated keyword link step S . Specifically the system control unit searches an associated keyword corresponding to the search keyword from the associated keyword DB . Then the system control unit generates data for an associated keyword link of the searched associated keyword. At this time the system control unit sets URL for product search in the href attribute of tag. Herein the system control unit adds an associated keyword to URL indicating the transmission destination of the search query and generates URL for product search. Further the system control unit sets the associated keyword between the start tag and the end tag of the tag. The system control unit additionally sets the generated data for an associated keyword link in a region corresponding to the associated keyword display region in the acquired template. When terminating the processing the system control unit terminates the associated keyword display region setting processing.

When determining that a genre is designated step S YES the system control unit searches an associated keyword corresponding to the search keyword from the associated keyword DB step S . Then the system control unit searches a record containing the same search keyword as the associated keyword and the genre ID of the designated genre from the keyword associated genre DB per searched associated keyword step S .

Then the system control unit selects a record having the highest relevance score from among the searched records step S . Then the system control unit generates data for an associated keyword link of the associated keyword contained as the search keyword in the selected record step S . The generation method is the same as the method described in step S. However when generating URL for product search the system control unit generates URL indicating the transmission destination of the search query added with the associated keyword and the genre ID of the designated genre. Then the system control unit additionally sets the generated data for an associated keyword link in a region corresponding to the associated keyword display region in the acquired template step S .

Then the system control unit determines whether the data for an associated keyword link is added up to the upper limit number of displayable associated keyword links step S . At this time when determining that the data is added up to the upper limit step S YES the system control unit terminates the associated keyword display region setting processing. On the other hand when determining that the data is not added up to the upper limit step S NO the system control unit determines whether an unselected record is present in the searched records step S . At this time when determining that an unselected record is present step S YES the system control unit selects one record having the highest relevance score from among the unselected records step S . Then the system control unit proceeds to step S. The system control unit repeats the processings in step S to S thereby determining a display order of the associated keyword links of the associated keyword of the search keyword the associated keyword having a high degree of relevance with the designated genre based on the relevance scores. That is the system control unit preferentially displays an associated keyword link of an associated keyword having a higher relevance score. Then when determining that all the records are selected step S NO the system control unit terminates the associated keyword display region setting processing.

At first the system control unit as an evaluation value acquisition means acquires a listing score of each product searched in step S in the search query reception processing via API of the product evaluation program for example step S . Then the system control unit determines whether a search keyword is designated as a search condition step S . At this time when determining that a search keyword is designated step S YES the system control unit selects one of the searched products step S . Herein the selected product is called selected product. 

Then the system control unit acquires the genre ID of a child genre to which the selected product belongs from among the child genres of the designated genre. The genre to which the selected product belongs is the same genre as the genre corresponding to the genre ID contained in the product information of the selected product or a genre corresponding to the genre ID contained in the product information of the selected product in descendent genres. Then the system control unit searches a record containing the search keyword and the acquired genre ID from the keyword associated genre DB step S . Then the system control unit determines whether a relevant record is present as a result of the searching step S . At this time when determining that a relevant record is present step S YES the system control unit as an evaluation value change means increases the listing score of the selected product step S . For example the system control unit may add a previously set value to the listing score or may multiply the listing score by a previously set coefficient. The system control unit may further increase the listing score as the relevance score contained in the searched record is higher.

When determining that a relevant record is not present in step S step S NO or when the processing in step S is terminated the system control unit determines whether an unselected product is present among the searched products step S . At this time when determining that an unselected product is present step S YES the system control unit selects one of the unselected products step S . Then the system control unit proceeds to step S. The system control unit repeats the processings in step S to S thereby increasing the listing score of a product having a high degree of relevance with the search keyword among the searched products.

When determining that a search keyword is not designated in step S step S NO or when determining that all the products are selected step S NO the system control unit selects a product having the highest listing score from among the searched products step S . Then the system control unit generates data for relevant product information based on the product information on the selected product. Then the system control unit additionally sets the generated data in a region corresponding to the search result display region in the acquired template step S .

Then the system control unit determines whether the data for relevant product information is added up to the upper limit of displayable relevant product information step S . At this time when determining that the data is added up to the upper limit step S YES the system control unit terminates the search result display region setting processing. On the other hand when determining that the data is not added up to the upper limit step S NO the system control unit determines whether an unselected product is present in the searched products step S . At this time when determining that an unselected product is present step S YES the system control unit selects one product having the highest listing score from among the unselected products step S . Then the system control unit proceeds to step S. The system control unit repeats the processings in steps S to S thereby preferentially displaying the relevant product information of a product having a higher listing score. Then when determining that all the products are selected step S NO the system control unit terminates the search result display region setting processing.

The user terminal receiving the HTML document of the search result page from the electronic mall server displays the search result page on the screen based on the HTML document. At this time the CPU of the user terminal as a genre display means displays the genre links in the genre designation region in the data setting order based on the data for the genre links . Then the CPU of the user terminal displays the associated keyword links in the associated keyword display region in the data setting order based on the data for the associated keyword links . Then the CPU of the user terminal displays the relevant product information in the search result display region in the data setting order based on the data for the relevant product information .

At first the system control unit determines whether the genre ID is set in the search keyword candidate request step S . At this time when determining that the genre ID is not set step S NO the system control unit searches a keyword matching in the left hand part with the character string set in the search keyword candidate request from the keyword DB . Then the system control unit transmits a list of searched keywords as search keyword candidates to the user terminal step S . When terminating the processing the system control unit terminates the search keyword candidate request reception processing.

On the other hand when determining that the genre ID is set step S YES the system control unit searches a record containing a search keyword matching in the left hand part with the character string set in the search keyword candidate request from the keyword associated genre DB step S . Then the system control unit extracts a record containing the genre ID set in the search keyword candidate request from the searched records step S . The system control unit rearranges the extracted records in descending order of the relevance scores contained in the records. Then the system control unit acquires the search keywords from the extracted records in descending order of the relevance scores. At this time the system control unit acquires the upper limit number of keywords displayable in the search keyword candidate display region . Further the system control unit generates a list of search keywords acquired from the records in descending order of the relevance scores. In this way the system control unit as a keyword determination means determines a keyword to be displayed in the search keyword candidate display region such that a search keyword having a high degree of relevance with the genre corresponding to the genre ID set in the search keyword candidate request is preferentially displayed among the search keywords matching in the left hand part with the character string set in the search keyword candidate request. Then the system control unit transmits the generated list of keywords to the user terminal step S . When terminating the processing the system control unit terminates the search keyword candidate request reception processing.

When receiving the list of keywords from the electronic mall server the user terminal displays the search keyword candidate display region in the search result page. The CPU of the user terminal as a keyword display means displays the keywords registered in the received list in the search keyword candidate display region in a registration order and displays them as designatable search keywords.

As described above according to the present embodiment the system control unit in the electronic mall server acquires the number of times when each of a plurality of genres of the products is designated as a search condition together with a search keyword and registers the genre ID indicating the genre for which the acquired number of times is a threshold or more and the search keyword in an associated manner in the keyword associated genre DB . Thus a keyword and a genre having a high degree of relevance with the keyword can be associated.

Further the system control unit registers when the entropy indicating a small degree of variation of the acquired number of times in the genres is a threshold or less. Thus a genre which is designated more times than other genres can be associated with the keyword.

Further when a plurality of child genres belonging to a genre are set for the genre indicated by the genre ID registered in association with a search keyword the system control unit as an acquisition means acquires the number of times when each of the child genres is designated as a search condition together with the search keyword and registers the genre ID indicating the child genre for which the acquired number of times is a threshold or more and the search keyword in an associated manner. Thus the genres having a high degree of relevance with the keyword can be hierarchically associated.

Further the system control unit registers the genre ID of the genre for which the acquired number of times is equal to or more than a threshold determined depending on the number of genres and the search keyword in an associated manner. Thus a genre having a high degree of relevance with the keyword can be appropriately extracted depending on the number of genres.

Further the system control unit receives a search query from the user terminal and determines based on the relevance score depending on the acquired number of times a genre display order by the user terminal for displaying in the genre designation region a genre link of a genre the genre ID of which is registered in the keyword associated genre DB in association with the search keyword contained in the search query among a plurality of genres. Thus the user can easily search a genre to be designated as a search condition from the genre designation region .

Further when receiving a character string input in the keyword input column from the user terminal together with the genre ID of a genre designated as a search condition and determining a keyword to be displayed by the user terminal for displaying a keyword containing the received character string in the search keyword candidate display region the system control unit determines to preferentially display a keyword registered in the keyword associated genre DB in association with the received genre ID. Thus the user can easily designate a search keyword from the search keyword candidate display region .

Further the system control unit receives a search query from the user terminal acquires a listing score of a product searched based on a search keyword contained in the search query and increases the listing score of the product belonging to the genre indicated by the genre ID registered in the keyword associated genre DB in association with the search keyword among the searched products relative to the listing scores of other products. Thus the user can easily search information on a product having a high degree of relevance with the keyword from the search result display region .

Then the electronic mall server may extract a pair of search keyword and genre having a high degree of relevance therebetween per attribute of the user designating the search conditions. This is because a trend to designate a pair of search keyword and genre as search conditions may be different depending on an attribute of the user. The user attributes are registered in the query log DB and thus the number of designations of the pair of search keyword and genre can be calculated per attribute of the user designating the search conditions. A pair is extracted per attribute since the display contents in the search result page need to be personalized.

Specifically the system control unit extracts a pair of search keyword genre ID sex age and prefecture from the query logs in step S in the keyword genre association processing illustrated in for example. At this time the system control unit extracts only the search keyword and genre ID from the query logs in which sex age and prefecture are not registered. Then the system control unit performs the processings in steps S to S as described above. That is the system control unit first extracts a pair of search keyword and genre having a high degree of relevance therebetween not in consideration of user attributes.

Then the system control unit performs basically the same processings as steps S to S per user attribute. By way of example a case in which the processings are performed based on sex will be described. In step S the system control unit extracts a pair with male from among the pairs acquired from the query log DB . Then the system control unit calculates the number of times when each genre is designated as a search condition together with a search keyword based on the extracted pair among the pairs acquired from the query log DB step S . Then the number of times is registered in the keyword genre list step S . Thereafter the system control unit performs steps S to S. In step S in the associated genre extraction processing illustrated in the system control unit associates the selected keyword the genre ID of the selected child genre the relevance score and the attribute information indicating male and registers them as one record in the keyword associated genre DB . When terminating the processings for male the system control unit similarly performs the processings for female. This is applicable to a case in which a pair of search keyword and genre having a high degree of relevance therebetween is extracted per age or prefecture. A pair may be extracted not based on age but based on year for example. For example a pair of search keyword and genre having a high degree of relevance therebetween may be extracted per combination of attributes such as sex age and prefecture. The user attributes are not limited to sex age and prefecture.

When receiving a search query from the user terminal the system control unit determines whether the user requesting to search is logging in. This can be determined by confirming whether a cookie containing the user ID is added to the search query. When determining that the user is not logging in the system control unit performs the genre designation region setting processing the associated keyword display region setting processing and the search result display region setting processing as described above. Herein when searching a record from the keyword associated genre DB the system control unit searches a record containing no attribute information. This is because when the user requesting to search is not logging in a user attribute cannot be specified. Thus the system control unit performs the processings not in consideration of the user attributes.

On the other hand when determining that the user is logging in the system control unit specifies user attributes. Then when searching a record from the keyword associated genre DB in the genre designation region setting processing the associated keyword display region setting processing and the search result display region setting processing the system control unit searches a record containing attribute information indicating the specified user attributes. Thereby the display contents in the search result page can be adapted to the contents suitable for the attributes of the viewing user.

This is applicable to the search keyword candidate request reception processing. When the user is not logging in the system control unit searches a record containing no attribute information from the keyword associated genre DB and when the user is logging in searches a record containing attribute information indicating user attributes from the keyword associated genre DB

Further according to the present embodiment the electronic mall server extracts a pair of search keyword and genre having a high degree of relevance therebetween based on the number of times when the search keyword and the genre are designated as search conditions. However the electronic mall server may extract a pair of search keyword and genre having a high degree of relevance therebetween based on the number of times when a searched product is purchased the number of times when order is established based on the searching of the product under the search conditions for the number of times when the search keyword and the genre are designated as search conditions. The number of times is called number of designations with purchase condition. This is because a search keyword and a genre designated as search conditions have a higher degree of relevance therebetween when a product is purchased as a result of the searching under the search conditions than when the user only designates the search conditions.

Then the storage unit constructs a purchase history DB therein. is a figure illustrating exemplary contents registered in the purchase history DB . The purchase history DB registers product purchase history by the user therein. Specifically the purchase history DB registers therein order code purchase time date user ID product ID shop ID product code sex age prefecture search keyword search genre ID and the like in an associated manner per product purchase. The order code is order identification information given every product order. The user ID indicates a user who purchases. The product ID and the product code indicate a purchased product. The shop ID indicates a shop where the product is purchased. Sex age and prefecture are attributes of the user who purchases. The search keyword and the search genre ID are a search keyword and a genre ID designated as search conditions.

For example when transmitting the HTML document of the search result page to the user terminal in response to the search query received from the user terminal the system control unit transmits a cookie containing the search keyword and genre ID contained in the search query to the user terminal . Thereby the system control unit can receive a search keyword and a genre ID last designated as search conditions as a cookie from the user terminal . The user selects any relevant product information from the search result display region in the search result page and thus the product page is displayed on the screen of the user terminal . The user performs a purchase operation in the product page so that the user terminal transmits a purchase request to the electronic mall server . When receiving the purchase request the system control unit registers a purchase history. At this time the system control unit acquires present time date as purchase time date. Further the system control unit acquires sex age and prefecture of the user. Further the system control unit acquires the search keyword and the genre ID from the cookie added to the purchase request. Then the system control unit registers the purchase history containing the acquired information in the purchase history DB

The system control unit acquires a pair of search keyword and search genre ID from the purchase history registered in the purchase history DB in step S of the keyword genre association processing illustrated in for example. Thereafter the system control unit performs steps S to S and the associated genre extraction processing as described above. At this time the system control unit may perform the processings based on the number of designations with purchase condition instead of the number of designations.

Further the above embodiment is such that when a genre link of a genre having a high degree of relevance with a search keyword is displayed in the genre designation region only a genre link of a genre at one level is displayed. However genre links of genres at several levels may be displayed.

When searching a record of a genre having a high degree of relevance with the search keyword from a keyword associated genre DB in steps S to S in the genre designation region setting processing illustrated in the system control unit searches a record of a genre having a high degree of relevance based on depth first searching from the child genres of the designated genre or the genres at level 1. That is when a record containing the search keyword and the certain genre ID contained in the acquired child genre ID list is registered in the keyword associated genre DB the system control unit next acquires a child genre ID list contained in the genre information corresponding to the genre ID. Then the system control unit searches a record containing the genre ID registered in the acquired child genre ID list from among the records containing the search keyword. The system control unit adds data for a genre link to each searched record.

Further whenever the user performs an input operation in the keyword input column in the search result page the display of the genre links in the genre designation region may dynamically change depending on a character string input in the keyword input column . Specifically a genre link of a genre associated with a search keyword containing the input character string may be displayed. For example when receiving a search keyword candidate request from the user terminal the system control unit searches a record containing a search keyword matching in the left hand part with the character string set in the search keyword candidate request from the keyword associated genre DB . At this time when a genre ID is set in the search keyword candidate request the system control unit searches a record containing the genre ID. On the other hand when a genre ID is not set in the search keyword candidate request the system control unit searches a record containing the genre ID at level 1. The system control unit adds data for a genre link to each searched record.

Further in the above embodiment the electronic mall server records query logs and calculates the number of designations based on the query logs. However the electronic mall server may calculate the number of designations in another way without recording a query log. For example when receiving a search query containing a search keyword and a genre ID from the user terminal the system control unit determines whether the search keyword and the genre ID are registered in the designation frequency information DB . At this time when determining that they are not registered the system control unit registers a pair of search keyword genre ID which are contained in the search query and number of designations in the designation frequency information DB . At this time the system control unit assumes the number of designations at 1. On the other hand when determining that they are registered the system control unit adds 1 to the number of designations corresponding to the search keyword and the genre ID contained in the search query in the designation frequency information DB

Further the genres are hierarchically defined in the above embodiment but may not be hierarchically defined. Only one hierarchy of genres may be possible.

Further the categories of the present invention are applied to the genres in the above embodiment. However the categories of the present invention may be applied to category price range region and the like.

Further in the above embodiment the present invention is applied to searching a product. However the present invention may be applied to searching service Web page image movie voice map news blogs and the like for example.

