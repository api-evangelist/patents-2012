---

title: Print relay device, print system, print relay device control method, and storage medium
abstract: A print relay device acquires printer information which is registered in a print service server and is linked to a user. In order to cause an image forming device to receive a print job from the print service device via the print relay device, the print relay device specifies printer information that is not registered in the print relay device from among the acquired printer information, and additionally registers the specified printer information in the printer information which is registered in the print service server and is linked to the user.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08743405&OS=08743405&RS=08743405
owner: Canon Kabushiki Kaisha
number: 08743405
owner_city: Tokyo
owner_country: JP
publication_date: 20121108
---
The present invention relates to a print relay device a print system a print relay device control method and a storage medium.

A content print system in which a print instruction is transmitted from a client to a server and the server that has received the print instruction converts the content to be printed into print data has been proposed. The cloud computing that has been attracting attention is also one of system architectures for providing a service from a server to a client.

As described above there has conventionally been known the presence of a form in which a Web server provides a service to a client. A cloud computing that has recently been attracting attention is also a form in which a Web server provides a service to a client. A main feature of the cloud computing is that data conversion and data processing are executed in a distributed manner using many computing resources so as to process requests from many clients in a simultaneous manner. At present too many vendors provide various types of services by implementing Web services on a cloud computing environment for realizing the cloud computing in a disorderly way.

Among vendors who provide services on a cloud computing environment Google registered trademark is a notable vendor. Google registered trademark not only establishes many large scale data centers but also develops a data communication structure between devices and services so as to provide services in cooperation with devices. For example Google registered trademark has developed a data communication structure for providing services in cooperation with image forming devices and has disclosed an interface for providing data communication between the cloud computing environment prepared by Google registered trademark and image forming devices. In this system the image forming device receives a print request from a service and executes printing.

Japanese Patent Laid Open No. 2003 196054 discloses a system in which a client that has received a print request transmits client information and a print data generation request to a server and the server acquires print control information corresponding to client information to thereby generate print data.

There might be a case where a print relay device is provided that provides a print relay service between an image print device such as a printer and a print service device that provides a print service on a cloud computing environment. By providing a print relay device serving as a relay server a vendor device that provides a print service can readily register manage a printer and provide value added services such as aggregation.

However in the Google s registered trademark cloud environment conventional printers printers having a dedicated interface implemented and printers connected to a proxy PC having a dedicated interface implemented need to be managed in a different way. The printers having a dedicated interface implemented and the printers connected to a proxy PC having a dedicated interface implemented can be connected to a print service device without passing through a print relay device. Hence the print relay device has no means for knowing printer information about the printers having a dedicated interface implemented and the printers connected to a proxy PC having a dedicated interface implemented . When a different print procedure is employed the print relay device may not be able to gather printer information the print relay device cannot integrally manage printers based on experience values such as information collection print suppression or the like. In other words all the printers cannot be managed or services cannot be provided to all the printers by simply providing a relay server.

The present invention provides a print relay device that acquires printer information from a print service device and integrally manages printers not managed by the print relay device for providing a print relay service.

According to an aspect of the present invention a print relay device is provided that communicates with a print service device which registers printer information including printer capabilities upon registration of an image forming device receives print settings set by a user via a print setting screen displayed on a user device and transmits a print job corresponding to the print settings to the image forming device via a network. The print relay device includes an acquisition unit configured to acquire printer information which is registered in the print service server and is linked to the user a specification unit configured to specify printer information that is not registered in the print relay device among the acquired printer information and a registration unit configured to additionally register printer information in which information relating to the transmission destination in the printer information specified by the specification unit has been replaced with information indicating the transmission destination is the print relay device in the print service server in order to receive the print job from the print service server to the image forming device via the print relay device.

Further features of the present invention will become apparent from the following description of exemplary embodiments with reference to the attached drawings.

Also the print system includes a Web application server group and a print server group . Both server groups may also be server groups provided by the same vendor. In this case both server groups may also be connected to each other via the network . The print system also includes a print relay server . The print relay server is connected to the network and the network is connected to the Internet . In the present embodiment devices and server groups constituting the print system are connectable to each other via the Internet and can perform data communication with each other. The number of devices is only one shown in but may be in plural. The number of server groups is in plural but may be one.

Also the Input Output interface is an interface unit that receives data from a pointing device not shown . An NIC Network Interface Card is a unit that connects the devices and server groups constituting the print system to the network . The aforementioned units can perform reception transmission of data via a bus . Also the image forming device includes a print unit not shown . The print unit can receive transmit data from to the units via the bus . The print unit is a unit that can print a raster image on a recording medium.

A description of functions will be generally given by separating in a first half and a second half. A description of basic function consisting of two groups will be given in the first half. Next in the second half a description will be given of the development function by developing the basic function consisting of two groups described in the first half to thereby integrally manage a conventional printer a printer having a dedicated interface implemented or a printer connected to a proxy PC having a dedicated interface implemented .

Here the conventional printer is a native printer not implemented an interface for performing data communication with the cloud computing environment prepared by Google registered trademark in a case of Google registered trademark . The printer having a dedicated interface implemented is a native printer implemented an interface for performing data communication with the cloud computing environment prepared by Google registered trademark in a case of Google registered trademark . The printer connected to a proxy PC having a dedicated interface implemented is a conventional printer installed in a proxy PC having a dedicated interface implemented that is PC in which GoogleChrome runs .

A feature of the basic function described in the first half is that a print job in the following three print function is distributed to the printer via the service printer and the relay virtual printer. A feature of the development function described in the second half is that the printer having a dedicated interface implemented and the printer connected to a proxy PC having a dedicated interface implemented that has been already registered in the print system is re registered in the relay virtual printer.

Hereinafter a description will be given of basic functions of two groups as first half. The function classified as a first group is a function classified as a registration that registers the image forming device in the print relay server and realizes a relay virtual printer within the print relay server to thereby register the relay virtual printer in a print service .

The function classified as a second group is a function classified as a print that firstly transmits the content data generated by the Web application server group to the print server group and then causes an image forming device to print out print data based on a print notification transmitted from the print server group . When the print system causes the image forming device to print out print data based on the print notification information transmitted from the print server group the print server group transmits a print notification to the image forming device via the print relay server serving as an intermediary and causes the image forming device to print out print data.

Firstly a description will be given of the function classified as the registration that is the first group. A description will be given of the function classified as the registration provided in the image forming device . The image forming device has print control unit . The print control unit realizes the functions shown in . More specifically the print control unit includes a display unit a print service information holding unit and a registration unit . The display unit displays various screens. The print service information holding unit has information about the print service . shows information about a print service. Although information about a plurality of print services is shown in the print service according to the first embodiment corresponds to a Print Service A. When the processing for registering the image forming device in the print service is instructed from a user the display unit generates and displays the UI for registration in a print service as shown in based on information shown in . On the screen shown in a user selects a print service in which the image forming device is desired to be registered from a button .

In the case of the first embodiment there is only one print service i.e. the print service a user has no choice but to select the Print Service A. The user inputs a user ID and a password to the selected print service .

Next the user pushes a registration button . The registration unit issues registration information in response to the pressing of the registration button by the user. In the first embodiment there is only one print service i.e. the print service . When a plurality of print services is selectable a user ID and a password can be separately set to each print service. Also the registration unit transmits the issued registration information to a request reception unit provided in a relay virtual printer management service to be described below. The other functions which have not previously been described will be described below.

Here a description will be given of registration information. Registration information includes a print service name. The print service name is information for specifying a print service selected by a user. In other words the print service name is information for specifying the print service provided in the print server group . Also registration information includes a user ID and a password. The user ID and the password are information required for utilizing the print service and the Web application server group . The user ID and the password are referred to as user information . In the present embodiment it is assumed that the Web application server group and the print server group are provided by the same vendor. Thus when a user uses services provided by both server groups the user can use both services using the same user information. In the first embodiment it is assumed that a user has already registered user information in the Web application server group in advance.

Also registration information includes an RPID Real Printer ID that is unique identification information assigned to the image forming device . Unique identification information is assigned to each image forming device not shown including the image forming device and thus each image forming device is specified by unique identification information. A MAC address that is a unique number of the communication device is applied as the RPID. In the first embodiment the location for placement of each image forming device can be specified by specifying the RPID. Also registration information includes Printer Kind that is device model information about the image forming device . The identical device model information is assigned to the devices of the same kind. When two image forming devices are the devices of the same kind it refers to the fact that two image forming devices incorporate the same the communication module B . A detailed separate description will be given below of the communication module B a communication module A a communication module A and a communication module B.

Also registration information includes the printer name of the image forming device . The printer name is a name that is assigned to the image forming device and is used for designating the image forming device . Unlike identification information the image forming devices may have the same printer name.

Also registration information includes capabilities. Capabilities are information indicating the capability of the image forming device . Capabilities include for example information indicating whether or not the image forming device can perform duplex printing information indicating whether or not the image forming device can perform color printing and information about the size of a paper sheet which can be output. Capabilities are the print function of the image forming device . Also capabilities are transmitted to the request reception unit in XML format as shown in . Each parenthesis shown in indicates the print capability of the image forming device . In this example it is indicated that the image forming device can perform imposition printing color printing and can output sheets of paper with the size of B5 A4 and A3.

Next a description will be given of the function classified as the registration provided by the print relay server . The print relay server has the relay virtual printer management service . is a functional block diagram illustrating the relay virtual printer management service . The relay virtual printer management service includes a request reception unit a control unit a virtual printer generation unit a print service printer generation unit a print service information management unit and an interface information management unit . The request reception unit receives registration information. The control unit can acquire registration information received by the request reception unit and interpret the registration information. Then the control unit provides instructions to the virtual printer generation unit and the print service printer generation unit to perform the following two processes. The first process is a process for realizing the function of the relay virtual printer by the virtual printer generation unit . The second process is a process for registering information about the relay virtual printer in the print service by the print service printer generation unit . Note that a solid arrow means execution writing processing and a dashed arrow means reading processing throughout the drawings.

A description will be given of the first process that is the process for realizing the function of the relay virtual printer by the virtual printer generation unit . The relay virtual printer realizes the functions shown in and the details of which will be described below. The virtual printer generation unit specifies and acquires a communication module B stored in the interface information management unit based on Printer Kind transmitted from the control unit . Also the virtual printer generation unit specifies and acquires a communication module A stored in the interface information management unit based on the print service name. The communication module B is a module that performs communication with the image forming device . Since the devices of the same model have the same communication module B as described above the devices of the same model can specify the communication module B from Printer Kind. The communication module B communicates with a communication module B provided in the print control unit . The communication module A is a module that performs communication with the print server group and is a module that can communicate with a communication module A provided in the print service . The virtual printer generation unit that has acquired two or more communication modules realizes a process thread into which two or more communication modules have been loaded. The process corresponds to the relay virtual printer .

The virtual printer generation unit realizes the relay virtual printer and then issues a VPID Virtual Printer ID that is identification information for identifying the realized relay virtual printer . The RPID described above may be employed as the VPID or the virtual printer generation unit may uniquely generate VPID. Alternatively the MAC address of the print relay server may be employed as the VPID. The virtual printer generation unit transmits the issued VPID to the control unit . The relay virtual printer is realized each time the registration information is transmitted from the image forming device . The VPID i.e. a unique identifier is assigned to each of the realized relay virtual printers . In the first embodiment the location for placement of the relay virtual printer can be specified by specifying VPID.

Next a description will be given of the second process that is the process for registering information about the relay virtual printer in the print service by the print service printer generation unit . The control unit transmits user information to the print service printer generation unit . The print service printer generation unit authenticates the print server group based on the received user information. When the authentication is successful the print service printer generation unit transmits a printer name capabilities and a VPID to the print service .

The print service printer generation unit receives a SPID Service Printer ID as a response from the print service . The SPID is identification information issued for the purpose of identifying the print of which the print service has received the print registration request. The control unit acquires VPIDs and SPIDs from the virtual printer generation unit and the print service printer generation unit respectively. The control unit that has acquired the VPIDs and SPIDs instructs the print service information management unit to store the information. The print service information management unit stores VPIDs SPIDs and registration information by associating them with each other as shown in . Reference numerals and correspond to VPID print service name RPID and Printer Kind respectively. Also reference numerals and correspond to SPID printer name and capabilities respectively.

Next a description will be given of the function classified as the registration provided by the print server group . The print server group has the print service . The print server group virtualizes a plurality of servers as a single server and realizes the function of the print service by means of the single server. The print server group activates a plurality of virtual machines in the single server and causes each virtual machine to realize the function of the print service . The print service shown in is just one of them.

Also the printer information registration unit issues an SPID corresponding to the VPID and transmits the issued SPID to the printer information storage unit and the print service printer generation unit . The printer information storage unit stores the printer name the capabilities the VPID the SPID the user ID and the password and that are brought into association with each other. is a diagram illustrating information stored in the printer information storage unit where reference numerals and correspond to SPID printer name capabilities VPID user ID and password respectively. The other functions which have not previously been described will be described below. As described above a description has been given of the function classified as the registration that registers the image forming device in the print relay server and realizes the relay virtual printer within the print relay server to thereby register the relay virtual printer in the print service .

Next a description will be given of the function classified as the print. Firstly a description will be given of the function provided by the client . The client has the Web browser . The Web browser transmits a print instruction for the content stored in the Web application server group to the Web application server group . Also the Web browser receives a command i.e. redirect instruction for accessing the print server group from the Web application server group and accesses the print server group in accordance with the received redirect instruction. Also the Web browser acquires a view list of image forming devices that are printable by a user who is using the Web browser from the accessed print server group and displays the list.

Next a description will be given of the function provided by the Web application server group . The Web application server group has the Web application . The Web application server group virtualizes a plurality of servers as a single server and realizes the function of the Web application by means of the single server. The Web application server group activates a plurality of virtual machines in the single server and causes each virtual machine to realize the function of the Web application .

The Web application provides a document creation service. When a user wishes to distribute a material at the company s meeting the user uses a document creation service for creating the material. When the client uses the Web application there is no need to install the Web application on the client but the client may only have the Web browser . The Web application transmits screen information required for creating the material to the Web browser . The Web application performs authentication based on user information including the user ID and the password both input by a user via the Web browser and sends screen information required for creating a material in response to the success of authentication. The Web browser that has received the screen information displays a creation screen for creating a document based on the screen information and a user creates a material to be distributed at the meeting using the creation screen.

The Web application receives information about the material created by a user using the creation screen creates a content based on the received information and causes the storage device for the Web application server group to store the created content. Also the created content is stored in various formats. Examples of such format include a typical word processor document spreadsheet document and presentation document PDF Portable Document Format format and HTML Hyper Text Markup Language format. Note that the Web application provides not only a document creation service but also a mail service and a schedule service.

A user who wishes to print content created by using a document creation service presses down a print button displayed on the creation screen. shows the fact that a print button has been pressed down. Note reference numeral denotes the content created by a user. The Web application receives information indicating that the print button has been pressed down and transmits a command for accessing the print server group i.e. a redirect instruction to the Web browser . Note that a redirect instruction includes a request for acquiring the view list corresponding to a user who is using the Web browser described above content identification information for identifying a content to which a print instruction has been given by a user and user information. Also when a print data acquisition request is made from the print server group the Web application transmits print data identification information for identifying print data to the print server group . In the present embodiment print data is a content in PDF format. Thus print data identification information is identification information relating to a content in PDF format.

As described above the Web application provides not only a document creation service but also a mail service and a schedule service. The content created by these services provided by the Web application is available from a program or a service provided by a third party via the interface of the Web application . Since the Web application holds content in various formats a content can be acquired in various formats through the interface. The above description has been given of the Web application provided in the Web application server group .

Next a description will be given of the function classified as the print provided by the print server group . As shown in the print service provided in the print server group includes the printer information presentation unit . The printer information presentation unit transmits the view list to the Web browser in response to the view list acquiring request from the Web browser . The printer information presentation unit specifies SPIDs and printer names stored in the printer information storage unit based on user information. Then the printer information provision unit generates a view list of image forming devices available for use by a user based on the SPIDs and the printer names.

Also the printer information presentation unit receives the SPID of an image forming device selected from the view list by the user. The printer information presentation unit specifies capabilities stored in the printer information storage unit based on the received SPID generates a print setting screen and transmits the generated print setting screen to the Web browser . The printer information storage unit generates the print setting screen shown in based on information about capabilities shown in . As shown in the printer information storage unit generates a print setting screen in which only the print settings described in capabilities are selectable.

The print instruction reception unit receives the print settings set by the user via the print setting screen and the SPID from the Web browser . Also when an access is made from the Web browser based on the redirect instruction the print instruction reception unit receives print data identification information for identifying print data to which a print instruction has been given by a user.

The print data information acquisition unit receives print data identification information from the print instruction reception unit . Also the print data information acquisition unit receives the print settings input by a user and the SPID corresponding to the image forming device selected by the user from the print instruction reception unit . The control unit acquires the print data identification information the print settings and the SPID from the print data information acquisition unit . The print settings are described in XML format as shown in . Referring to it can be seen that the double sided setting the monochrome setting and the paper size A4 are set by a user. The communication module A can communicate with a device having the communication module A and is an interface for data communication between two devices. The communication module other than the communication module A cannot communicate with the communication module A . The reason for this will be described after the description of the function provided by the communication module A .

The communication module A of the print service includes a print data identification information storage unit a print setting information storage unit and a print job notification unit . The print data identification information storage unit receives print data identification information from the control unit and stores the received print data identification information. The print setting information storage unit receives print settings from the control unit and stores the received print settings. The print data identification information storage unit and the print setting information storage unit receive a storage instruction from the control unit to thereby perform storage processing. The control unit instructs the print job notification unit to send notification information in response to the reception of an indication of the end of storage from the print data identification information storage unit and the print setting information storage unit . The print job notification unit acquires an SPID from the control unit in response to the notification information transmission instruction from the control unit and specifies a VPID based on information stored in the printer information storage unit . Information about the transmission destination corresponding to the SPID i.e. the VPID of the transmission destination is referred to as target . In other words a user specifies the VPID by selecting the SPID. Also the print job notification unit acquires the storage location of print data and the storage location of print settings from the control unit generates notification information A and transmits the notification information A to the registered image forming device.

The print job notification unit corresponds to a first transmission unit and information to be transmitted by the print job notification unit corresponds to information relating to data. In the first embodiment the information relating to data is the notification information A. However the information relating to data may also include other information other data or the like depending on the communication specification. The same applies to notification information B to be described below. Also in the first embodiment the registered image forming device refers to the relay virtual printer corresponding to the VPID. The notification information A is described in XML format as shown in . Reference numeral indicates the description of the storage location of print data and reference numeral indicates the description of the storage location of print settings.

Here a description will be given of the reason why the communication modules other than the communication module A cannot communicate with the communication module A. This is because the communication modules other than the communication module A cannot interpret the notification information A which is transmitted by the print job notification unit and is described in XML format. Another reason why communication modules other than the communication module A cannot communicate with the communication module A is given in the following example. For example when the communication module A does not have the print job notification unit and causes the communication module A to acquire print data and print settings in another way the communication module A which acquires the notification information A cannot acquire print data and print settings. This is because since the communication module A which acquires the notification information A is in a state of waiting for the notification information A from the communication module A the communication module A cannot acquire print data and print settings unless the communication module A is notified of the notification information A.

The communication module A capable of communicating with the communication module A needs to have a query function for querying the communication module A to inquire whether or not data to be acquired is present. In this manner there may also be a case where communication cannot be established between the communication module A and the communication module A due to the fact that the communication module A does not correspond to the data communication standard of the communication module A. A structure for enabling communication between the communication module A and the communication module A is referred to as the specification of a vendor who provides the print server group . Then the specification strongly depends on the vendor managing the print server group .

The vendor managing the print server group discloses the communication module A that communicates with the communication module A by implementing the communication module A in the print server group . In fact such a system is being established in recent years and the vendor managing the print server group discloses a proprietary specification for performing data communication between the print server group and the device. In order to establish communication between the image forming device and the print server group the device vendor of the image forming device must install the communication module A on the image forming device . Assume that the vendor managing the print server group changes the configuration of the communication module A. In other words assuming that the vendor managing the print server group changes the specification the device vendor must change the communication module A of the image forming device in accordance with the changes in the specification. However such an operation burden is very high. The reason for this is that image forming devices are arranged in various customer environments and thus service persons must visit various customer environments so as to change the communication module A in order to establish communication between the print server group and the image forming devices again.

Although another solution that distributes the communication module A without using a service person may also be considered such solution places a load on a communication band because the communication module A must be distributed to a plurality of image forming devices. However above possibility is solved by using the function classified as the print provided by the print relay server to be described below. The specification for data communication disclosed by the vendor managing the print server group corresponds to a first specification. The interface of the communication module A and the communication module A is an interface that is generated in accordance with the first specification.

Next a description will be given of the function classified as the print provided by the print relay server . As shown in the relay virtual printer has the communication module A and the communication module B . The communication module A includes a print notification reception unit a print setting acquisition unit and a print data acquisition unit . The communication module B includes a print job notification unit a print setting storage unit and a print data storage unit . The print notification reception unit of the communication module A receives the notification information A transmitted from the print job notification unit . Since the relay virtual printer is registered instead of the RPID of the image forming device in the print service the notification information A is transmitted to the print notification reception unit . Since the communication module A is a module that is a one to one correspondence with the communication module A the print notification reception unit is capable of interpreting the notification information A. The print notification reception unit corresponds to a first acquisition unit.

The print notification reception unit confirms the storage location of print data and the storage location of print settings both described in the notification information A and notifies the print setting acquisition unit and the print data acquisition unit of the information. The print setting acquisition unit acquires print settings from the print setting information storage unit based on the notified storage location of print settings. The print data acquisition unit acquires print data from the print data identification information storage unit based on the notified storage location of print data.

The print data acquisition unit instructs the print data storage unit to store print data acquired by the print data acquisition unit . The print setting acquisition unit instructs the print setting storage unit to store the print settings acquired by the print setting acquisition unit . The print data storage unit that has stored print data notifies the print job notification unit of the storage location of print data. The print setting storage unit that has stored the print settings notifies the print job notification unit of the storage location of the print settings. The print job notification unit generates the notification information B in response to the reception of the notification of the storage locations from the print data storage unit and the print setting storage unit . The notification information B is described in XML format as shown in . Reference numeral indicates the description of the storage location of print data and reference numeral indicates the description of the storage location of print settings. The print job notification unit transmits the notification information B to the print control unit . The print job notification unit corresponds to a second transmission unit. As described above the communication module A serving as the former communication module passes print data and print settings to the communication module B serving as the latter communication module to thereby realize communication between modules.

The image forming device implements the communication module B corresponding to the communication module B. As described above the image forming device acquires print data from the print service . With this arrangement even if the communication module A changes in accordance with the change in the communication module A notification information can be transmitted to the image forming device by changing the communication module A of the print relay server . In other words even if the vendor managing the print server group changes a proprietary specification for performing data communication between the print server and the image forming device there is no need for the device vendor to change the communication module of the image forming device . The device vendor can establish communication between the image forming device and the print server group which are arranged in various user environments by changing the relay virtual printer of the print relay system. As a method for changing the relay virtual printer not only a method for changing the communication module A of the relay virtual printer but also a method for newly generating the relay virtual printer by discarding the existing relay virtual printer may be considered.

Next a description will be given of the function classified as the print provided by the image forming device . As shown in the print control unit has the communication module B . The communication module B includes a print notification reception unit a print setting acquisition unit and a print data acquisition unit . The print notification reception unit receives the notification information B transmitted from the print job notification unit . The print notification reception unit corresponds to a second acquisition unit. Since the communication module B is a module that is a one to one correspondence with the communication module B the print notification reception unit is capable of interpreting the notification information B. The specification defined by a device vendor in order to perform data communication between the relay virtual printer and the image forming device corresponds to a second specification that can be handled by the device vendor. The interface of the communication module B and the communication module B is an interface that is generated in accordance with the second specification.

The print notification reception unit confirms the storage location of print data and the storage location of print settings both described in the notification information B and notifies the print setting acquisition unit and the print data acquisition unit of the information respectively. The print setting acquisition unit acquires print settings from the print setting storage unit based on the notified storage location of print settings. The print data acquisition unit acquires print data from the print data storage unit based on the notified storage location of print data. The acquired print settings and print data are transmitted to a job management unit via the print notification reception unit . The job management unit acquires print data and print setting information and instructs a print execution unit to execute printout. The instructed print execution unit generates a raster image based on print settings and print data and instructs a print unit to print the generated raster image. The above description has been given of the function classified as the print in which a print instruction of the content generated by the Web application server group is transmitted to the print server group and print data transmitted from the print relay server is printed by the image forming device .

Next a description will be given of processing for registering the image forming device in the print relay server and realizing the relay virtual printer within the print relay server to thereby register the relay virtual printer in the print service .

Firstly in step S a user selects a print service desired to be registered from the UI of the image forming device and inputs a user ID and a password. In step S the registration unit of the print control unit requests the request reception unit of the relay virtual printer management service to register a printer. At this time the registration unit of the print control unit transmits the registration information to the relay virtual printer management service .

In step S the control unit of the relay virtual printer management service receives the registration information from the request reception unit . The control unit instructs the virtual printer generation unit to realize the relay virtual printer based on the received registration information. In step S the relay virtual printer transmits a response indicating a successful creation to the virtual printer generation unit . The virtual printer generation unit that has received a response indicating a successful creation creates a VPID. In step S the print service printer generation unit of the relay virtual printer management service transmits the user ID and the password to the printer information registration unit of the print service to thereby receive authentication. When the authentication performed by the printer information registration unit was successful the printer information registration unit transmits the fact that authentication was successful to the print service printer generation unit in step S.

In step S the print service printer generation unit requests the print service to register the VPID as a printer service printer to be provided to the user. In step S the printer information registration unit of the print service issues an SPID in response to the registration of the VPID as a service printer and transmits the SPID to the print service printer generation unit .

In step S the control unit of the relay virtual printer management service receives the VPID and the SPID from the virtual printer generation unit and the print service printer generation unit respectively. Then the control unit instructs the print service information management unit to store update the received VPID and SPID. In step S the print service information update unit that has received the instruction from the control unit instructs the printer information registration unit to store the updated SPID and transmits the fact that the settings have been completed to the relay virtual printer . In step S the relay virtual printer is connected to the communication module A of the print service based on the SPID and waits for the notification information A to be transmitted.

In step S the request reception unit of the relay virtual printer management service notifies the registration unit of the print control unit of the fact that the printer registration has been completed. In step S the display unit of the print control unit instructs the UI of the image forming device to display the fact that the image forming device registration has been completed. In step S the print control unit is connected to the communication module B based on the VPID and waits for the notification information B to be transmitted. The above description has been given of registration processing.

Next a description will be given of processing for transmitting a print instruction for the content generated by the Web application server group to the print server group to thereby cause the image forming device to print out print data transmitted from the print server group with reference to . Firstly in step S the Web browser requests the Web application to display the content which a user wishes to edit. In step S the Web application transmits the screen for the content corresponding to the requested content to the Web browser . In step S the Web browser requests a list screen of image forming devices service printers registered in the print service in response to the print instruction given by a user via the screen for the content.

In step S the printer information presentation unit of the print service transmits a list screen of service printers corresponding to a user who is using the Web browser to the Web browser . In step S the Web browser requests a print setting screen corresponding to the selected image forming device in response to the selection of an image forming device from the list screen by a user. In step S the printer information presentation unit transmits the print setting screen to the Web browser . In step S the Web browser transmits the print settings input by a user via the print setting screen to the print instruction reception unit of the print service .

In step S the print data information acquisition unit acquires identification information about print data to which a print instruction has been given by a user from the Web application . Also the control unit generates a job by combining identification information about print data and print settings. In step S the print job notification unit notifies the print notification reception unit of the relay virtual printer of the fact that the job has been generated.

In step S the print data acquisition unit and the print setting acquisition unit of the relay virtual printer request the print data identification information storage unit and the print setting information storage unit of the print service to acquire a job. In step S the print data acquisition unit and the print setting acquisition unit acquire a job i.e. print data and print settings from the print data identification information storage unit and the print setting information storage unit of the print service . In step S the print job notification unit of the relay virtual printer notifies the print notification reception unit of the print control unit of the fact that the job has been generated.

In step S the print data acquisition unit of the print control unit requests the print data storage unit of the relay virtual printer to acquire print data. In step S the print data acquisition unit acquires print data from the print data storage unit . In step S the print setting acquisition unit requests the print setting storage unit to acquire print settings. In step S the print setting acquisition unit acquires the print settings from the print setting storage unit . In step S the print control unit renders a raster image based on the acquired print settings and print data and causes the image forming device to print the raster image.

The description has been given with respect to the first half of the first embodiment. In the following second half a description will be given of the development function by developing the basic function consisting of two groups described in the first half. The basic function described in the first half consists of two groups 1. registration function and 2. print function and is premised on the assumption that a user newly utilizes the system. However there is often a case that such premise may not be satisfied. One example of such cases is the case where there is a printer that has already been connected to a print service.

Examples of a printer that has already been connected to a print service include a printer having a dedicated interface implemented or a printer connected to a proxy PC having a dedicated interface implemented . When a new printer is registered in the print service the new printer can be registered via a print relay server as described in the first half whereas a printer that has already been connected to the print service is registered without a detour through a print relay server. For this reason the print relay server cannot integrally manage the usage state of printers that have already been connected to the print service so that information collection or management based on an experience value such as print suppression cannot be made. An example of such management based on an experience value such as print suppression includes the settings of an upper limit value for the number of copies for each user. By taking all the printers a detour through the print relay server an experience value for a print status for each user can be acquired so that a print restriction can be imposed on all the printers based on the values.

Accordingly a printer having a dedicated interface implemented or a printer connected to a proxy PC having a dedicated interface implemented is re registered via a print relay server with the aid of the development function to be described below. In this manner the relay virtual printer service can integrally manage the usage states of printers.

Firstly the summary of the development function will be clarified. With the aid of the development function disclosed by the present invention a printer having a dedicated interface implemented or a printer connected to a proxy PC having a dedicated interface implemented can be registered in a print relay server to execute printing. By taking a detour through a print relay server use information can be integrally managed so that information collection and management based on an experience value such as print suppression can be made. The aforementioned description has been given with respect to the summary of the development function.

Here a description will be given of the print system employing the development function. GCP Google Cloud Print registered trademark which is one of print services discloses the API Application Programming Interface shown in . There are two types of APIs the application API for Submitting Print Jobs and the printer API for Receiving Print Jobs . The development function will be described by taking an example of GCP. The relay virtual printer management service re registers a printer having a dedicated interface implemented or a printer connected to a proxy PC having a dedicated interface implemented via the print relay server using the API for GCP. The flow is shown in .

Firstly in step S the control unit of the print relay server requests searches the SPID List of printers registered in the print service via the print service information update unit . In step S the control unit requests the List of registered printers SPIDs to the printer information registration unit of the print service . The printer information registration unit that has received the request acquires the List of registered printers from the printer information storage unit and passes the List to the print service information update unit . In other words the print service information update unit and the control unit collectively function as an acquisition unit that acquires printer information linked to a user registered in a print service. In step S the control unit extracts printers not managed by the print service information management unit from among the List of registered printers acquired by the print service information update unit in step S. In other words the control unit functions as a specification unit that specifies unregistered printer information. How the extraction process is performed will be described below. The control unit repeats the following processing for the number of extracted printers.

In step S the control unit requests the VPID printer SPID to the printer information registration unit using the SPID via the print service information update unit . In the case of a printer having a dedicated interface implemented the MAC address of the printer itself is typically used as the VPID. This is because the VPID is information for identifying a printer and the MAC address which is a value specific to each printer is suitable for the VPID. In the case of a printer connected to a proxy PC having a dedicated interface implemented the MAC address of the proxy PC is used as the VPID. In this case when a plurality of printers is connected to a proxy PC the VPID common to the plurality of printers is set. In step S the control unit acquires the VPID from the printer information storage unit . The aforementioned processing is performed using the application API for Submitting Print Jobs .

In the subsequent processing the relay virtual printer management service uses the printer API for Receiving Print Jobs . In step S the control unit of the print relay server requests printer information list VPID to the printer information registration unit of the print service using the VPID acquired in step S. In step S the control unit acquires printer information from the printer information registration unit .

Here printer information is the printer name and the capabilities which are managed by the table shown in . In step S the control unit updates the table using the printer information acquired in step S. At this time the VPID created by the relay virtual printer management service is used. In the present embodiment the MAC address of the relay virtual printer management service itself is intended to be used.

In step S a printer is registered using the VPID register VPID capabilities . In step S the control unit receives an SPID as a response of registration. In step S registration in the proxy that has been previously used in the registered printer is deleted delete SPID . In step S the table is updated so as to reflect the deleted printer.

The aforementioned description has been given of the summary of the flow in which a printer having a dedicated interface implemented or a printer connected to a proxy PC having a dedicated interface implemented is re registered via a print relay server using the API for GCP.

Next a detailed description will be given of the content of the development function with reference to and . When the development function is applied information stored in the printer information storage unit of the print service is as shown in the table in FIG. C. The table shown in FIG. C corresponds to the table shown in in the basic function. The Printer C and the Printer D are registered in the print service without a detour through the print relay server . More specifically the Printer C is a printer having a dedicated interface implemented and the Printer D is a printer connected to a proxy PC having a dedicated interface implemented .

Printer registration update processing in the development function is shown in and . Firstly in steps S and S a user requests the request reception unit of the relay virtual printer management service to update printer registration via the Web browser of the client computer . In step S the print service information update unit of the relay virtual printer management service requests authentication to the print service . In step S the print service information update unit acquires an authentication token as an authentication success response.

In step S the control unit requests searches the printer information registration unit of the print service to obtain the List of registered printers linked to a user using the authentication token via the print service information update unit . In step S the printer information registration unit of the print service transmits the List of registered printers to the printer information storage unit . The printer List to be transmitted is the SPIDs managed by the table shown in FIG. C. All the SPIDs linked to a user managed by the table are returned. In the case of the table shown in FIG. C the number of SPIDs is seven. More specifically examples of SPIDs include SP 3KM15KEG 892E SP II3KI93KEE 343D SP 5D15DEAF BE3C SP 2336ACD3 4D27 SP 1AE5A901 3D8C SP F5C17CC0 1877 and SP 4120C0A0 99A3 .

In step S the control unit of the relay virtual printer management service extracts printers not included in the table shown in stored in the print service information management unit from among the acquired List of registered printers. The printers to be extracted in the present embodiment are the Printer C which is a printer having a dedicated interface implemented and the Printer D which is a printer connected to a proxy PC having a dedicated interface implemented .

In step S the control unit requests the VPID printer SPID to the printer information registration unit of the print service using the SPID acquired in step S via the print service information update unit . In step S the printer information registration unit returns a VPID corresponding to the SPID. In step S the control unit requests printer information using the acquired VPID list VPID . In step S the printer information registration unit returns printer information such as capabilities print setting specified values and the like which are linked to the VPID using information shown in FIG. C via the printer information storage unit . Here the printer information registration unit returns printer information relating to the Printer C and the Printer D. In step S the virtual printer generation unit of the relay virtual printer management service requests the relay virtual printer to create a relay virtual printer based on information about the Printer C and the Printer D acquired in step S. In other words the virtual printer generation unit requests the relay virtual printer to create a virtual printer corresponding to each printer which is not managed by the print relay server from among the acquired printer list. For example in the present embodiment the acquired VPID shown in FIG. C by the Printer C is a Printer C s MAC Address and thus the control unit specifies that the Printer C is a printer that has not yet been managed. Then the virtual printer generation unit transmits information about the Printer C to the relay virtual printer and requests the relay virtual printer to create a virtual printer having a VPID which can be managed by the relay virtual printer management service . Consequently a virtual printer having the value of VPBCH 2531CB19 5D9E is generated with respect to the Printer C as shown in FIG. B. The relay virtual printer management service performs the same processing for the Printer D.

In step S the relay virtual printer returns a response indicating a successful creation to the virtual printer generation unit . Upon receiving the response the virtual printer generation unit creates a VPID. The VPID corresponds to a printer identification name for a print relay device. In step S the control unit of the relay virtual printer management service updates information managed by the print service information management unit . The updated table is shown in FIG. B. Information relating to printer name i.e. the Printer C and the Printer D is added. To be noted here is that the VPID is updated to the value created by the relay virtual printer . As shown in reference numerals and in FIG. C the MAC address of a printer or a PC is used for the VPIDs of the Printer C and the Printer D that are registered in the print service without a detour through the print relay server .

Information e.g. MAC address which is information about an output destination relating to a printer registered without a detour through the print relay server which has been acquired based on the printer ID issued by the print server group upon registration of printer information is used. In this manner registration information is managed by changing the output destination as viewed from the print server group to the print relay server and by making print data transmitted from the print server group reach the image forming device serving as the final output destination. Consequently the image forming device can benefit from a service provided by the print server group to the same extent as prior to change. Furthermore data from the print server group is exchanged via the print relay server resulting in a drastic improvement in ease of management of a printer having a dedicated interface implemented as compared to prior to change.

In addition since printer information other than the output destination remains the same as those prior to change the relay virtual printer management service can set print setting values which can be set on the print setting screen displayed on the user device as in a conventional way. However the form is not necessarily limited to this. For example the relay virtual printer management service may replace printer information other than the output destination with other values. For example When a print restriction is applied to a user registered in a print relay server the settings in which both 1 side printing and 2 side printing can be performed can be replaced with the settings in which only 2 side printing can be performed. Also the settings can be made such that the relay virtual printer management service manages the frequency of usage of printers and the printers are displayed on the print setting screen in the ascending or descending order depending on the frequency of usage.

In step S the control unit requests service printer registration to register the relay virtual printers of the Printer C and Printer D created in steps S to S in the print service via the print relay server . In step S the printer information registration unit returns the SPID as a response indicating successful creation to the print service information update unit . In step S the print service updates the printer information table managed by the printer information storage unit . The updated table is shown in FIG. C. Information about the Printer C and Printer D is newly added. The newly added rows have the same VPIDs as those shown in FIG. B i.e. the VPIDs created in step S . At this point the rows of the Printer C and the Printer D registered without a detour through the print relay server still remains.

In step S the control unit requests the printer information registration unit to delete the service printers of the Printer C and the Printer D which have been registered without a detour through the print relay server via the print service information update unit . In step S the printer information registration unit returns a response indicating successful creation. In other words the control unit functions as a registration unit that additionally register printer information in which information relating to the transmission destination in printer information has been replaced by information to be transmitted to the relay virtual printer management service in the print service .

By executing the processing the printers that has not been managed by the print service information management unit prior to execution of the processing are placed under control of the print service information management unit . In other words information about the non managed printers that have already been registered prior to the processing is no longer necessary. Hence the SPIDs corresponding to the non managed printers that have already been registered prior to the processing are deleted.

The reason for this is to prevent the non managed printers that have already been registered prior to the processing and the old non managed printers that have been placed under control of the relay virtual printer management service by executing the processing from being simultaneously displayed on the printer selection screen provided to a user. Another reason for this is to reduce the resource amount of the print service . Note that the non managed printers that have already been registered prior to the processing are printers that are found not to be managed by the relay virtual printer management service based on the acquired printer list and the printers that have been placed under control of the relay virtual printer management service are printers that have already been registered in the print service and were not managed by the relay virtual printer management service . More specifically a printer that has been placed under control of the relay virtual printer management service is a printer that has newly re registered in the print service by changing information about an output destination to information about an output destination to the relay virtual printer management service .

In step S the printer information storage unit of the print service updates the printer information table for management. The updated table is shown in FIG. C. The rows of the Printer C and the Printer D registered without a detour through the print relay server are deleted.

In step S the control unit of the relay virtual printer management service instructs the printer information registration unit to store the SPID and transmits the fact that the settings have been completed to the relay virtual printer . In step S the relay virtual printer is connected to the communication module A of the print service based on the SPID and waits for the notification information A to be transmitted. In step S the request reception unit of the relay virtual printer management service notifies the registration unit of the print control unit of the fact that the printer registration has been completed. In step S the Web browser displays a screen indicating to the user that registration of the image forming device has been completed.

The aforementioned description has been given of the flow in which a printer having a dedicated interface implemented or a printer connected to a proxy PC having a dedicated interface implemented is re registered via the relay virtual printer management service . In this way a conventional printer a printer having a dedicated interface implemented and a printer connected to a proxy PC having a dedicated interface implemented are registered in the relay virtual printer management service via the print relay server . All the printing passes through a print relay server so that information can be collected. Consequently management for print restriction based on experience values default printer settings or the like can be made by collecting information. In other words according to the print relay device of the present invention the print relay device acquires printer information from a print service device and integrally manages printers not managed by the print relay device. Thus management for print restriction default printer settings or the like can be made based on the collected information and thus all the printers can be managed or services can be provided to all the printers.

Although the registration processing is triggered by printer registration update operation by a user via the Web browser the registration processing may be performed by polling by the relay virtual printer management service . By repeating steps S to S by the relay virtual printer management service for each predetermined period an unregistered printer can be surely registered in the print service via the relay virtual printer management service for each predetermined period. The registration processing may also be performed each time the relay virtual printer management service is in operation for registration processing or print processing. By repeating the processes in steps S to S each time an inquiry is made from the print service or the print control unit or each time the relay virtual printer management service operates in response to the relay virtual printer the burden of operation processing may occur. However the period during which a printer having a dedicated interface implemented or a printer connected to a proxy PC having a dedicated interface implemented is not registered in the print relay server can be shortened. Alternatively the registration processing may also be triggered by an event output by the print service each time the registration is changed. In order to do this the function for outputting an event each time the registration is changed to GCP is required. However if the function is prepared printers not managed by the relay virtual printer service can be registered immediately in the relay virtual printer management service without exception at the timing of the event reception by the relay virtual printer management service . The processes in steps S to S are performed at the timing of the event reception.

In the relay virtual printer management service the MAC address of the relay virtual printer management service itself can also be commonly used as the VPID. However the print service has the case in that registering a plurality of printers with a single VPID is undesirable in terms of performance . In this case the control unit of the relay virtual printer management service may manage a plurality of printers by grouping using a plurality of VPIDs. For example a plurality of VPIDs is provided to a single user for management instead of providing a single VPID to a single user. It should be noted that the VPID is not the MAC address of a conventional printer or a server PC but is uniquely created by the relay virtual printer in lexical order such that the created VPIDs can be controlled by the print relay server . The unit of grouping can be contemplated according to function color duplexing use location Office Home frequency of usage frequent use recently used original VPID VPID is re assigned by a print relay server or the like as printer attributes. Then the control unit transmits the grouped printer information to the print service .

As described above the print service can provide a print setting screen on which a printer name linked to each printer attribute is displayed to a Web browser. In other words the control unit manages a plurality of VPIDs by dividing printers into groups so that the case for the print service in which registering a plurality of printers with a single VPID is undesirable in terms of performance can be solved. Also since the control unit performs grouping using VPIDs the Web browser can display an UI that is readily usable by a user.

Among the printers connected to a proxy PC having a dedicated interface implemented there is also a printer that cannot be connected to a network and can only be connected to a local network via a USB or the like. In the first embodiment a description has been given by taking an example in which all of the printers having a dedicated interface implemented or the printers connected to a proxy PC having a dedicated interface implemented are re registered via a print relay server. In the third embodiment a description will be given by taking an example in which a part of printers connected to a proxy PC having a dedicated interface implemented remains to be registered via a proxy PC having a dedicated interface implemented instead of taking a detour through a print relay server.

Upon receiving printer information from the print service the control unit of the relay virtual printer management service determines whether or not a printer connected to a proxy PC having a dedicated interface implemented is provided with the network function . If the printer connected to a proxy PC having a dedicated interface implemented is provided with the network function the control unit may prompt the printer connected to the PC to perform resettings. If the control unit determines that the printer connected to a proxy PC having a dedicated interface implemented is not provided with the network function but is a printer that only support a local connection such as a USB connection the control unit leaves the original registration via the proxy PC having a dedicated interface implemented . In other words if a printer cannot be connected to a network the control unit does not make additional settings for unregistered printer information to the print service . It should be note that the VPIDs set by the control unit are changed in accordance with the VPID MAC address of the proxy PC having a dedicated interface implemented so as to be controlled by the relay virtual printer management service . More specifically the VPIDs are adjusted to be sorted in lexical order. As described above not only printers provided with the network function but also printers that only support a local connection such as a USB connection can be used and the order of UI display can be controlled by adjusting the VPIDs.

In the first embodiment a description has been given by taking an example in which all of the printers having a dedicated interface implemented or the printers connected to a proxy PC having a dedicated interface implemented are re registered via a print relay server. However a part of printers having a dedicated interface implemented may also remain directly registered instead of taking a detour through a print relay server. For example the session configuration between servers or printers may change due to collection or division of proxy resulting in changes in locations on which a communication load is placed. Also if all the printers are in connection the load on the print relay server may also increase.

For example a printer having a dedicated interface implemented which is often used for consumer application as a unit of distributing a communication load or as a unit of reducing a load on a print relay server is connected to a conventional individual proxy. Also printers other than a printer having a dedicated interface implemented which is often used for enterprise application may also be in connection via a print relay server. Upon printer registration a step of determining the system architecture by the control unit of the relay virtual printer management service may be provided. Alternatively a user may select the configuration using a UI display. More specifically a user may select from the printer list upon printer registration that which printer is to be registered in the print relay server so as to be able to execute the processing.

Aspects of the present invention can also be realized by a computer of a system or apparatus or devices such as a CPU or MPU that reads out and executes a program recorded on a memory device to perform the functions of the above described embodiments and by a method the steps of which are performed by a computer of a system or apparatus by for example reading out and executing a program recorded on a memory device to perform the functions of the above described embodiments. For this purpose the program is provided to the computer for example via a network or from a recording medium of various types serving as the memory device e.g. computer readable medium .

While the present invention has been described with reference to exemplary embodiments it is to be understood that the invention is not limited to the disclosed exemplary embodiments. The scope of the following claims is to be accorded the broadest interpretation so as to encompass all such modifications and equivalent structures and functions.

This application claims the benefit of Japanese Patent Application No. 2011 279541 filed Dec. 21 2011 which is hereby incorporated by reference herein in its entirety.

