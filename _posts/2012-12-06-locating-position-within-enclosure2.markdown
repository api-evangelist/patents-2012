---

title: Locating position within enclosure
abstract: Among other things, one or more techniques and/or systems are provided for locating a position within an enclosure. In one example, known global coordinates (e.g., GPS coordinates of latitude/longitude) associated with the position within the enclosure may be transformed into local coordinates (e.g., x/y coordinates) for the position. The local coordinates may be used for tracking a location of the position within the enclosure. In another example, known local coordinates of the position within the enclosure may be transformed into global coordinates for the position, which may be used for tracking a location of the position within the enclosure. In another example, a blueprint image of the enclosure may be used to track a location of the position within the enclosure. In this way, location tracking may be provided for objects within indoor spaces (e.g., a mapping application may track a current position of a mobile device within a building).
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09612121&OS=09612121&RS=09612121
owner: Microsoft Technology Licensing, LLC
number: 09612121
owner_city: Redmond
owner_country: US
publication_date: 20121206
---
Many devices provide location based services that utilize position tracking. In one example a mapping service on a mobile phone may utilize global coordinates e.g. positional information such as longitude and latitude from a global positioning system GPS to identify a current location of the mobile phone. In this way the user may plan a travel route from the current location to a particular destination of interest to the user. In another example a restaurant application on a tablet device may utilize positional information such as global coordinates to suggest local restaurants to a user. Current position tracking techniques utilize global coordinates associated with GPS because GPS may provide relatively accurate longitude and latitude information for outdoor spaces. However GPS may not accurately represent indoor locations because GPS may not be able to identify locations within enclosures such as buildings. In this way location based services may be limited to tracking outdoor positions.

This summary is provided to introduce a selection of concepts in a simplified form that are further described below in the detailed description. This Summary is not intended to identify key factors or essential features of the claimed subject matter nor is it intended to be used to limit the scope of the claimed subject matter.

Among other things one or more systems and or techniques for locating a position within an enclosure are provided herein. That is a position e.g. a location of an object such as a mobile device a person an entity a portion of a building etc. may be located within an enclosure e.g. an underground structure a subway a floor of a building etc. such that the position may be tracked within indoor spaces without losing location based functionality. In this way a user of a mobile device may seamlessly transition between indoor and outdoor spaces for example. It may be appreciated that an example of various angles lines points and or other features described in the summary are illustrated in for illustrative purposes.

In one example of locating a position within an enclosure local coordinates associated with the enclosure may be used to determine global coordinates of a given point as the position within the enclosure. That is an origin point for a local coordinate system e.g. a first position within a building such as a corner of the building may represent an origin of a Cartesian coordinate system associated with the building may be established based upon origin point global coordinates of a global coordinate system for the origin point. For example a GPS device associated with the corner of a building may provide the origin global coordinates of the origin point. A reference point in the local coordinate system e.g. a second position within the building such as a second corner of the building may correspond to a location of the reference point within the building may be established based upon reference point global coordinates of the global coordinate system for the reference point. For example a GPS device associated with the second corner of the building may provide the reference point global coordinates of the reference point.

A directional reference line e.g. true north may be established for the enclosure based upon the global coordinate system. A first axis e.g. a y axis for the local coordinate system may be established based upon the origin point. In this way an azimuth gamma e.g. an angle from the directional reference line to the first axis of the local coordinate system may be determined based upon the origin point and or the reference point. For example an azimuth beta e.g. an angle from the directional reference line to a reference point line that connects the origin point to the reference point and an angle delta e.g. an angle from the first axis to the reference point line may be used to determine the azimuth gamma. In this way the azimuth gamma may be determined. An azimuth alpha e.g. an angle from the directional reference line to a given point line that connects the origin point to the given point within the enclosure may be determined. For example an angle theta e.g. an angle from the first axis to the given point line and the azimuth gamma may be used to determine the azimuth alpha. Accordingly given point global coordinates of the global coordinate system may be determined for the given point as the position within the enclosure. The given point global coordinates may be determined based upon the azimuth alpha the origin point global coordinates and or a given point line length of the given point line for example. In this way local coordinates associated with the enclosure may be used to determine global coordinates of the position of the given point within the enclosure.

In another example of locating a position within an enclosure global coordinates associated with the enclosure may be used to determine local coordinates of a given point as the position within the enclosure. That is origin point global coordinates of a global coordinate system e.g. coordinates obtained from GPS and or origin point local coordinates of a local coordinate system may be obtained for an origin point associated with the enclosure e.g. an origin corresponding to a first position within a building for the local coordinate system associated with the building . Reference point global coordinates of the global coordinate system e.g. coordinates obtained from GPS and or reference point local coordinates of the local coordinate system may be obtained for a reference point associated with the enclosure e.g. a point at a second position within the building .

A directional reference line e.g. true north may be established for the enclosure based upon the global coordinate system. A first axis e.g. a y axis for the local coordinate system may be established based upon the origin point. In this way an azimuth gamma e.g. an angle from the directional reference line to the first axis of the local coordinate system may be determined based upon the origin point and or the reference point. An azimuth alpha e.g. an angle from the directional reference line to a given point line that connects the origin point to the given point within the enclosure may be determined. A given point line length of the given point line that connects the origin point to the given point may be determined. An angle theta e.g. an angle from the first axis to the given point line may be determined based upon the azimuth gamma and or the azimuth alpha. Accordingly given point local coordinates of the local coordinate system may be determined for the given point as the position within the enclosure. The given point local coordinates may be determined based upon the angle theta and or the given point line length. In this way global coordinates associated with the enclosure may be used to determine local coordinates of the position of the given point within the enclosure.

In another example of locating a position within an enclosure a blueprint image of an enclosure may be used to determine coordinate points of a position e.g. a position corresponding to a mobile device within the enclosure. That is the blueprint image of a level of the enclosure may be obtained e.g. a blueprint image comprising pixels that represent a floor of a building . Because the blueprint image may represent the level using pixels a set of scale parameters for the blueprint image may be used to convert between pixel values and physical coordinates. The set of scale parameters may map pixels of the blueprint image to physical coordinate measurements of the enclosure. A first perpendicular distance from the position within the enclosure to a first structure may be determined e.g. a first distance from the mobile device to a first wall of the building . A second perpendicular distance from the position to a second structure may be determined e.g. a second distance from the mobile device to a second wall of the building . In this way a first circle may be generated based upon the first perpendicular distance using the set of scale parameters e.g. the first circle may be generated using the first perpendicular distance as a radius and a second circle may be generated based upon the second perpendicular distance using the set of scale parameters e.g. the second circle may be generated using the second perpendicular distance as a radius .

The position of the first circle and or the second circle may be translated within the blueprint image such that the first circle and the second circle are tangential to the first structure and the second structure. For example a first location for the first circle may be defined such that the first circle is tangential to the first structure e.g. the first circle may be moved to the first location within the blueprint image such that the first circle is tangential to the first wall of the building . A second location for the second circle may be defined such that the second circle is tangential to the second structure e.g. the second circle may be moved to the second location within the blueprint image such that the second circle is tangential to the second wall of the building . In this way coordinate points of the position within the enclosure may be determined based upon coordinates of the first circle and or coordinates of the second circle e.g. based upon center values of the first circle and or second circle .

To the accomplishment of the foregoing and related ends the following description and annexed drawings set forth certain illustrative aspects and implementations. These are indicative of but a few of the various ways in which one or more aspects may be employed. Other aspects advantages and novel features of the disclosure will become apparent from the following detailed description when considered in conjunction with the annexed drawings.

The claimed subject matter is now described with reference to the drawings wherein like reference numerals are generally used to refer to like elements throughout. In the following description for purposes of explanation numerous specific details are set forth in order to provide an understanding of the claimed subject matter. It may be evident however that the claimed subject matter may be practiced without these specific details. In other instances structures and devices are illustrated in block diagram form in order to facilitate describing the claimed subject matter.

Many devices provide location based services that utilize position tracking functionality such as GPS that do not provide relatively accurate tracking of positions within enclosures e.g. building a multi level building a shopping mall a tunnel a subway etc. e.g. where a GPS signal may be unavailable blocked etc. . Accordingly as provided herein a position e.g. a position of an object such as a mobile device may be located within an enclosure such that a location of the position may be track within an indoor space. For example a global spatial model may be used to represent locations e.g. three dimensional locations of objects utilizing known global coordinates e.g. GPS receivers mounted on a corner of a building and or local coordinates of a local coordinate system associated with the enclosure e.g. a Cartesian coordinate system . The global spatial model may transform between global coordinates and local coordinates in order to identify the position within the enclosure. In one example the global spatial model may utilize a blueprint image of the enclosure in order to determine the position within the enclosure. In this way location tracking may be provided within indoor spaces and location tracking may be seamlessly transitioned between indoor and outdoor spaces.

One embodiment of locating a position within an enclosure is illustrated by exemplary method in . It may be appreciated that method may be described in conjunction with example of for illustrative purposes e.g. example comprises a representation of an enclosure such as a floor of a building comprising a first GPS device located at an origin point and or a second GPS device located at a reference point within the enclosure . The position within the enclosure may correspond to a position of a given point within the enclosure .

At the method starts. At the origin point for a local coordinate system e.g. a Cartesian coordinate system comprising a first axis and a second axis associated with the enclosure may be established based upon origin point global coordinates of a global coordinate system for the origin point e.g. the first GPS device located at the origin point may provide the origin point global coordinates . At the reference point may be established in the local coordinate system based upon reference point global coordinates of the global coordinate system for the reference point e.g. the second GPS device located at the reference point may provide the reference point global coordinates .

A directional reference line may be identified within the enclosure e.g. the first GPS device may provide a true north measurement that may be used to construct the directional reference line . At an azimuth gamma e.g. an angle between the directional reference line and the first axis may be determined based upon the origin and or the reference point . In one example of determining the azimuth gamma an azimuth beta e.g. an angle from the directional reference line to a reference point line that connects the origin point to the reference point may be determined based upon the origin point the reference point and or a reference point line length of the reference point line . For example an inverse geodetic problem solution e.g. an inverse chord equation may be used to determine the azimuth beta . An angle delta from the first axis to the reference point line may be determined. In this way the azimuth gamma may be determined based upon the azimuth beta and or the angle delta e.g. azimuth gamma equals azimuth beta minus angle delta .

At an azimuth alpha e.g. an angle from the directional reference line to a given point line that connects the origin point to the given point may be determined. In one example of determining the azimuth alpha an angle theta e.g. an angle between the first axis and the given point line may be determined based upon given point local coordinates of the local coordinate system for the given point . In this way the azimuth alpha may be determined based upon the angle theta and or the azimuth gamma .

At given point global coordinates e.g. GPS coordinates of the given point such as latitude and longitude values of the global coordinate system may be determined for the given point as the position within the enclosure. The given point global coordinates may be determined based upon the azimuth alpha and or a given point line length of the given point line e.g. a distance from the origin to the given point . For example a direct geodetic problem solution may be used to determine the given point global coordinates. In this way global coordinates such as GPS coordinates may be determined for the given point based upon local coordinates of the given point e.g. the given point local coordinates used to determine the azimuth alpha . In one example the given point may correspond to an object such as a mobile device. The position of the object may be displayed within a digital representation of the enclosure through a user interface e.g. a mapping application on the mobile device and or on another device etc. for example. In this way the mobile device may be tracked inside the enclosure e.g. by translating local coordinates to global coordinates such as GPS coordinates . It may be appreciated that the given point may correspond to any object such as a wireless access point a person a location tracking enabled device etc. . At the method ends.

One embodiment of locating a position within an enclosure is illustrated by exemplary method in . It may be appreciated that method may be described in conjunction with example of for illustrative purposes e.g. example comprises a representation of an enclosure such as a floor of a building comprising a first GPS device located at an origin point and or a second GPS device located at a reference point within the enclosure . The position within the enclosure may correspond to a position of a given point within the enclosure .

At the method starts. At origin point global coordinates of a global coordinate system e.g. the first GPS device located at the origin point may provide the origin point global coordinates and origin point local coordinates of a local coordinate system e.g. a Cartesian coordinate system comprising a first axis and a second axis may be obtained for the origin point . At reference point global coordinates of the global coordinate system e.g. the second GPS device located at the reference point may provide the reference point global coordinates and reference point local coordinates of the local coordinate system may be obtained for the reference point .

A directional reference line may be identified within the enclosure e.g. the first GPS device may provide a true north measurement that may be used to construct the directional reference line . At an azimuth gamma e.g. an angle from the directional reference line to the first axis of the local coordinate system may be determined based upon the origin point and or the reference point . In one example given point global coordinates of the global coordinate system may be obtained which may be used to determine one or more angles such as an azimuth alpha e.g. the given point global coordinates may be used to identify a given point line length of the given point line which may be used to determine the azimuth alpha . Accordingly at the azimuth alpha e.g. an angle from the directional reference line to the given point line connecting the origin point and the given point and the length of given point line may be determined. For example an inverse geodetic problem solution e.g. an inverse chord equation may be used to determine the azimuth alpha and length of given point line .

At an angle theta from the first axis to the given point line may be determined based upon the azimuth gamma and or the azimuth alpha e.g. angle theta equals azimuth alpha minus azimuth gamma .

At given point local coordinates of the local coordinate system e.g. x y coordinates may be determined for the given point as the position within the enclosure . The given point local coordinates may be determined based upon the angle theta and or the given point line length of the given point line . In this way local coordinates such as x y coordinates may be determined for the given point based upon global coordinates associated with the enclosure for example. At the method ends.

The coordinate transfer component may be configured to determine a set of scale parameters for the blueprint image . Because the blueprint image represents the enclosure as pixels the set of scale parameters may comprise mappings of pixels to physical coordinate measurements of the enclosure. In this way the set of scale parameters may be used by the coordinate transfer component to switch between pixel values and physical coordinates of the enclosure.

The coordinate transfer component may be configured to determine a first perpendicular distance from a position within the enclosure to a first structure e.g. the first wall and a second perpendicular distance from the position to a second structure e.g. the second wall . In this way the coordinate transfer component may create perpendicular distances . In one example the first perpendicular distance and or the second perpendicular distance may be received through a mapping user interface e.g. a user of a mobile device corresponding to position may utilize the mobile device to detect and or input the perpendicular distances .

The coordinate transfer component may be configured to generate a first circle based upon the first perpendicular distance using the set of scale parameters . For example a first radius may be defined for the first circle based upon the first perpendicular distance . The set of scale parameters may be used to transform pixel values to physical coordinates when generating the first circle . The coordinate transfer component may be configured to generate a second circle based upon the second perpendicular distance using the set of scale parameters . For example a second radius may be defined for the second circle based upon the second perpendicular distance . The set of scale parameters may be used to transform pixel values to physical coordinates when generating the second circle . In this way the coordinate transfer component may be configured to generate the first circle and or the second circle which may be used to locate a position e.g. local coordinates of a local coordinate system for the position within the enclosure represented by the blueprint image e.g. as illustrated in .

The coordinate transfer component may be configured to position the first circle and or the second circle within the blueprint image . For example the coordinate transfer component may define a first location for the first circle such that the first circle is tangential to a first structure e.g. a first wall . The coordinate transfer component may define a second location for the second circle such that the second circle is tangential to a second structure e.g. the second wall . In this way the coordinate transfer component may determine coordinates points of a position e.g. local coordinates of a local coordinate system for position of within the enclosure based upon coordinates of the first circle and or coordinates of the second circle e.g. pixel coordinates or local coordinates of a local coordinate system for the position . For example the coordinate points may be based upon center values of the first circle and or the second circle . In one example the coordinate transfer component may display the coordinate points through a mapping user interface. It may be appreciated that the position may correspond to a floor of a building such that the coordinate points may correspond to three dimensional coordinates. In this way the position may be tracked between floors of the building and or between an outdoor space and the building for example.

Still another embodiment involves a computer readable medium comprising processor executable instructions configured to implement one or more of the techniques presented herein. An exemplary computer readable medium that may be devised in these ways is illustrated in wherein the implementation comprises a computer readable medium e.g. a CD R DVD R or a platter of a hard disk drive on which is encoded computer readable data . This computer readable data in turn comprises a set of computer instructions configured to operate according to one or more of the principles set forth herein. In one such embodiment the processor executable computer instructions may be configured to perform a method such as at least some of the exemplary method of and or at least some of exemplary method of for example. In another such embodiment the processor executable instructions may be configured to implement a system such as at least some of the exemplary system of and or at least some of the exemplary system of for example. Many such computer readable media may be devised by those of ordinary skill in the art that are configured to operate in accordance with the techniques presented herein.

Although the subject matter has been described in language specific to structural features and or methodological acts it is to be understood that the subject matter defined in the appended claims is not necessarily limited to the specific features or acts described above. Rather the specific features and acts described above are disclosed as example forms of implementing the claims.

As used in this application the terms component module system interface and the like are generally intended to refer to a computer related entity either hardware a combination of hardware and software software or software in execution. For example a component may be but is not limited to being a process running on a processor a processor an object an executable a thread of execution a program and or a computer. By way of illustration both an application running on a controller and the controller can be a component. One or more components may reside within a process and or thread of execution and a component may be localized on one computer and or distributed between two or more computers.

Furthermore the claimed subject matter may be implemented as a method apparatus or article of manufacture using standard programming and or engineering techniques to produce software firmware hardware or any combination thereof to control a computer to implement the disclosed subject matter. The term article of manufacture as used herein is intended to encompass a computer program accessible from any computer readable device carrier or media. Of course those skilled in the art will recognize many modifications may be made to this configuration without departing from the scope or spirit of the claimed subject matter.

Although not required embodiments are described in the general context of computer readable instructions being executed by one or more computing devices. Computer readable instructions may be distributed via computer readable media discussed below . Computer readable instructions may be implemented as program modules such as functions objects Application Programming Interfaces APIs data structures and the like that perform particular tasks or implement particular abstract data types. Typically the functionality of the computer readable instructions may be combined or distributed as desired in various environments.

In other embodiments device may include additional features and or functionality. For example device may also include additional storage e.g. removable and or non removable including but not limited to magnetic storage optical storage and the like. Such additional storage is illustrated in by storage . In one embodiment computer readable instructions to implement one or more embodiments provided herein may be in storage . Storage may also store other computer readable instructions to implement an operating system an application program and the like. Computer readable instructions may be loaded in memory for execution by processing unit for example.

The term computer readable media as used herein includes computer storage media. Computer storage media includes volatile and nonvolatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions or other data. Memory and storage are examples of computer storage media. Computer storage media includes but is not limited to RAM ROM EEPROM flash memory or other memory technology CD ROM Digital Versatile Disks DVDs or other optical storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can be accessed by device . Any such computer storage media may be part of device .

Device may also include communication connection s that allows device to communicate with other devices. Communication connection s may include but is not limited to a modem a Network Interface Card NIC an integrated network interface a radio frequency transmitter receiver an infrared port a USB connection or other interfaces for connecting computing device to other computing devices. Communication connection s may include a wired connection or a wireless connection. Communication connection s may transmit and or receive communication media.

The term computer readable media may include communication media. Communication media typically embodies computer readable instructions or other data in a modulated data signal such as a carrier wave or other transport mechanism and includes any information delivery media. The term modulated data signal may include a signal that has one or more of its characteristics set or changed in such a manner as to encode information in the signal.

Device may include input device s such as keyboard mouse pen voice input device touch input device infrared cameras video input devices and or any other input device. Output device s such as one or more displays speakers printers and or any other output device may also be included in device . Input device s and output device s may be connected to device via a wired connection wireless connection or any combination thereof. In one embodiment an input device or an output device from another computing device may be used as input device s or output device s for computing device .

Components of computing device may be connected by various interconnects such as a bus. Such interconnects may include a Peripheral Component Interconnect PCI such as PCI Express a Universal Serial Bus USB firewire IEEE 1394 an optical bus structure and the like. In another embodiment components of computing device may be interconnected by a network. For example memory may be comprised of multiple physical memory units located in different physical locations interconnected by a network.

Those skilled in the art will realize that storage devices utilized to store computer readable instructions may be distributed across a network. For example a computing device accessible via a network may store computer readable instructions to implement one or more embodiments provided herein. Computing device may access computing device and download a part or all of the computer readable instructions for execution. Alternatively computing device may download pieces of the computer readable instructions as needed or some instructions may be executed at computing device and some at computing device .

Various operations of embodiments are provided herein. In one embodiment one or more of the operations described may constitute computer readable instructions stored on one or more computer readable media which if executed by a computing device will cause the computing device to perform the operations described. The order in which some or all of the operations are described should not be construed as to imply that these operations are necessarily order dependent. Alternative ordering will be appreciated by one skilled in the art having the benefit of this description. Further it will be understood that not all operations are necessarily present in each embodiment provided herein.

Moreover the word exemplary is used herein to mean serving as an example instance or illustration. Any aspect or design described herein as exemplary is not necessarily to be construed as advantageous over other aspects or designs. Rather use of the word exemplary is intended to present concepts in a concrete fashion. As used in this application the term or is intended to mean an inclusive or rather than an exclusive or . That is unless specified otherwise or clear from context X employs A or B is intended to mean any of the natural inclusive permutations. That is if X employs A X employs B or X employs both A and B then X employs A or B is satisfied under any of the foregoing instances. In addition the articles a and an as used in this application and the appended claims may generally be construed to mean one or more unless specified otherwise or clear from context to be directed to a singular form. Also at least one of A and B and or the like generally means A or B or both A and B.

Also although the disclosure has been shown and described with respect to one or more implementations equivalent alterations and modifications will occur to others skilled in the art based upon a reading and understanding of this specification and the annexed drawings. The disclosure includes all such modifications and alterations and is limited only by the scope of the following claims. In particular regard to the various functions performed by the above described components e.g. elements resources etc. the terms used to describe such components are intended to correspond unless otherwise indicated to any component which performs the specified function of the described component e.g. that is functionally equivalent even though not structurally equivalent to the disclosed structure which performs the function in the herein illustrated exemplary implementations of the disclosure. In addition while a particular feature of the disclosure may have been disclosed with respect to only one of several implementations such feature may be combined with one or more other features of the other implementations as may be desired and advantageous for any given or particular application. Furthermore to the extent that the terms includes having has with or variants thereof are used in either the detailed description or the claims such terms are intended to be inclusive in a manner similar to the term comprising. 

