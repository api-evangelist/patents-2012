---

title: System and method for initial ranging in wireless communication systems
abstract: A system and method for initial ranging in wireless communication systems is provided. A plurality of orthogonal frequency division multiplexing (OFDM) blocks are received by an OFDMA base station transceiver from a plurality of remote user devices in wireless communication with the base station. A ranging subchannel is extracted from the OFDM blocks. The number of active codes in the ranging subchannel is determined, active codes are identified, and carrier frequency offsets (CFOs) are estimated for each active code. Timing delays and power levels for each active code are then estimated. The estimated CFOs, timing delays, and power levels are broadcasted by the base station to the remote user devices, so that the user devices can utilize same to adjust transmission parameters to optimize power levels and synchronize communication with the base station.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09166856&OS=09166856&RS=09166856
owner: The Trustees of Princeton University
number: 09166856
owner_city: Princeton
owner_country: US
publication_date: 20120828
---
This application is a continuation of U.S. patent application Ser. No. 12 114 220 filed on May 2 2008 now U.S. Pat. No. 8 254 242 the entire disclosure of which is expressly incorporated herein by reference.

The present invention was made with government support under National Science Foundation Grant Nos. ANI 03 38807 and CNS 06 25637. Accordingly the Government has certain rights to the present invention.

The present invention relates to wireless communication systems and more particularly to a system and method for initial ranging in wireless communication systems.

In the field of wireless communication technology recent demands for high data rates have stimulated intense research activity in multicarrier modulation techniques. Particular interest has been directed to orthogonal frequency division multiple access OFDMA wireless communication systems which have become part of the Institute of Electrical and Electronics IEEE 802.16 family of standards for wireless metropolitan area networks WMANs . OFDMA systems allow for the transmission of digital information between a base station BS and a plurality of remote user devices such as cellular telephones wireless handheld computers etc. OFDMA systems split the available bandwidth into smaller subchannels composed by a set of orthogonal subcarriers which are assigned to different users to simultaneously communicate with the BS. The user signals are received at the BS as a series of orthogonal frequency division multiplexing OFDM blocks from which information data are extracted by the BS. Unfortunately OFDMA systems are extremely sensitive to timing errors and carrier frequency offsets CFOs that may occur between uplink signals and the local references at the BS. Timing errors give rise to interblock interference IBI while inaccurate compensation of the CFOs destroys orthogonality among subcarriers and produces interchannel interference ICI as well as multiple access interference MAI .

In an attempt to alleviate these drawbacks of OFDMA systems the IEEE 802.16 standards specify a synchronization procedure called Initial Ranging IR wherein users that intend to establish a link with the BS adjust their transmission parameters so that uplink signals arrive at the BS synchronously and with approximately the same power level. In its basic form the IR process develops through the following steps. First a remote user computes frequency and timing estimates on the basis of a downlink control channel. The estimated parameters are then used in the uplink phase during which each remote user transmits a randomly chosen code over a ranging time slot that comprises a specified number of adjacent OFDM blocks. However as a consequence of the different users positions within the cell uplink signals arrive at the BS at different time instants. Furthermore since the ranging time slot is randomly selected several users may collide over a same ranging subchannel. After separating colliding codes and extracting timing and power information the BS broadcasts a response message indicating the detected codes and giving the necessary instructions for timing and power adjustment.

The main functions of the BS during the ranging process may be classified as multi user code detection and multi user timing and power estimation. In existing IR techniques a long pseudo noise PN code is transmitted by each RSS over all available ranging subcarriers. Code detection and timing recovery is then accomplished on the basis of suitable correlations computed in either the frequency or time domains. These approaches require huge computational complexity since each correlation must be evaluated for each possible ranging code and hypothesized timing offset. Moreover separation of users is achieved by exploiting only the correlation properties of the employed code set. In the presence of multipath distortions however ranging subcarriers are subject to different attenuations and phase shifts thereby leading to a loss of the code orthogonality. This gives rise to MAI which severely degrades the system performance.

Alternative solutions involve replacing the PN ranging codes with a set of modified generalized chirp like GCL sequences and mitigating the effects of channel distortion through differential detection of the ranging signals. Unfortunately this approach is still plagued by significant MAI and furthermore it cannot be applied to interleaved OFDMA systems since ranging subcarriers must be assigned adjacently. Some attempts at reducing the system complexity rely on the decomposition of the multi parameter estimation problem into a number of successive steps. However they are only suitable for flat channels and fail in the presence of multipath distortions. Still another approach involves a reduction of the computational burden but this is achieved at the price of an increased overhead using a dedicated common ranging code.

A common drawback among others of existing IR methods is their poor performance in the presence of frequency selective channels. For example in one existing method a signal design is proposed which is robust to multipath distortions wherein ranging signals are divided into several groups and each group is transmitted over an exclusive set of subcarriers with a specific timing delay. This approach leads to a significant reduction of MAI as signals of different groups are perfectly separable in either the frequency or time domain. Additionally in existing approaches phase rotations induced by residual CFOs between the uplink signals and the BS frequency scale are ignored even though such rotations may become significant over ranging periods spanning several adjacent blocks. In such cases the received ranging signals are no longer orthogonal and CFO compensation is necessary to avoid a serious degradation of the system performance. Unfortunately frequency recovery schemes for OFDMA systems are normally derived under the assumption that uplink signals are transmitted over disjoint subcarriers and as a result cannot be applied to a scenario where multiple codes share the same subchannel.

Accordingly what would be desirable but has not yet been provided is a system and method for initial ranging in wireless communication systems which addresses the foregoing shortcomings of existing initial ranging approaches.

The present invention relates to a system and method for initial ranging in wireless communication systems. OFDM blocks are received by an OFDMA base station transceiver from a plurality of remote user devices. After passing the received signal into a discrete Fourier transform DFT unit ranging subchannels are extracted from the received blocks and a ranging subchannel is selected for processing. The number of active codes that are present in the selected subchannel is then determined. Once this information is obtained CFOs are subsequently estimated together with the active codes using a multiple signal classification MUSIC algorithm. Timing delays and power levels are then estimated for each active code using maximum likelihood ML and least squares LS estimation algorithms. The BS then broadcasts a response message indicating the detected codes and their corresponding instructions for adjusting synchronization parameters and power levels. A reduced complexity algorithm is also provided by the present invention for estimating timing delays and power levels with reduced computational complexity. In another embodiment of the present invention CFOs timing errors and power levels are estimated using an Estimation of Signal Parameters via Rotational Invariance Techniques EPSRIT algorithm.

The present invention relates to a system and method for initial ranging in wireless communication systems wherein a specified number of OFDM blocks are received by the BS from a plurality of remote user devices. The received signal is passed to a DFT unit which extracts ranging subchannels from the received blocks and a ranging subchannel is selected for processing. After determining the number of active codes in the considered subchannel CFOs are estimated for each active code using a MUSIC algorithm. Timing delays and power levels are then estimated for each active code using ML and LS estimation algorithms. The estimated CFOs timing delays and power levels are broadcast by the base station to the remote user devices which can optimize their power levels and synchronize with the BS reference scales. In another embodiment of the present invention CFOs timing errors and power levels are estimated using an ESPRIT algorithm.

As used herein matrices and vectors are denoted by boldface letters with Ibeing the identity matrix of order N. The expression A diaga n n 1 2 . . . N denotes an N N diagonal matrix with entries a n along its main diagonal while Bis the inverse of a square matrix B. The expressions E and are used for expectation complex conjugation transposition and Hermitian transposition respectively. The notation represents the Euclidean norm of the enclosed vector while represents the modulus. The expression c indicates the largest integer smaller than or equal to c and denotes the k l th entry of the enclosed matrix.

The present invention is operable with OFDMA wireless communication systems in which remote wireless communication devices referred to herein as ranging subscriber stations RSSs engage in an IR procedure with an OFDMA BS transceiver e.g. a transceiver at a cellular tower location a building etc. . The equations algorithms according to the present invention can be utilized in OFDMA systems where M denotes the number of OFDM blocks in a ranging time slot and each ranging subchannel can be accessed by no more than M 1 RSSs. The latter are separated by means of orthogonal codes which are randomly selected from a set c c . . . c with c c c . . . c M 1 and c m 1 for 0 m M 1. Each OFDM block employs N subcarriers with frequency spacing f and indices in the set 0 1 . . . N 1. R denotes the number of ranging subchannels each of which is divided into Q subbands uniformly spaced over the signal bandwidth at a distance N Q f from each other. A given subband is called a tile and is composed by a set of V adjacent subcarriers. The subcarrier indices in the qth tile q 0 1 . . . Q 1 of the rth subchannel r 0 1 . . . R 1 are collected into a set J iwith entries

Beginning in step an OFDMA base station transceiver receives M OFDM blocks from a plurality of RSSs that intend to establish a link with the BS. In step each OFDM block is processed by a discrete Fourier transform DFT unit to extract the QV subcarriers corresponding to the R ranging subchannels. As a general rule different RSSs in a given subchannel employ different codes. In step a ranging subchannel is selected and modeled in accordance with the present invention as follows.

For the purposes of this description we concentrate on the rth subchannel where K M 1 denotes the number of simultaneously active RSSs. To simplify the notation the subchannel index is not referred to herein. The waveform transmitted by the kth RSS propagates through a multipath channel of order L with impulse response h h h . . . h L 1 . At the BS the received samples are not synchronized with the local references. denotes the timing error of the signal received from the kth RSS expressed in sampling intervals while denotes the corresponding frequency offset normalized to the subcarrier spacing.

We denote by Ya QV dimensional vector which stores the DFT outputs of the considered subchannel during the mth OFDM block. Since DSSs are perfectly aligned to the BS references their signals do not contribute to Y. In contrast the presence of uncompensated CFOs destroys orthogonality among ranging signals and gives rise to ICI. Recalling that the ranging subchannels are interleaved in the frequency domain at a distance of N f QR from each other interference on Yarising from subchannels other than the considered one can be neglected. Under the above assumptions it is possible to write 

In step the number of currently active codes in the selected subchannel is calculated as discussed below in greater detail in connection with . Then in step CFOs are estimated for each active code as discussed below in greater detail in connection with . In step after CFOs have been estimated timing delays errors for each active code are estimated. This process is discussed below in greater detail in connection with . In step power levels for each active code are estimated as discussed in connection with .

In step a determination is made as to whether all subchannels have been processed. If a negative determination is made control returns to step so that an additional subchannel can be processed as described above to provide estimates of CFOs timing delays and power levels for the corresponding RSSs. If a positive determination is made step occurs.

After CFOs timing delays and power levels have been estimated for each RSS this information is broadcast in step to the remote users i.e. the RSSs so that each user device can adjust its transmission parameters and align its own uplink signal to the BS reference scales. Specifically users that intend to access the network for the first time compute initial frequency and timing estimates on the basis of a downlink control signal broadcast by the BS. The estimated parameters are then employed by each RSS as synchronization references for the uplink ranging transmission. This means that during the IR process the CFOs are induced only by Doppler shifts and or estimation errors and as a consequence they will be quite small. For example consider the IEEE 802.16 standard for WMANs with subcarrier spacing f 11.16 kHz and carrier frequency f 5 GHz. In the case of perfect downlink synchronization the maximum CFO in the uplink is 2fv c where vdenotes the terminal speed while c 3 10m s is the speed of light. Letting v 120 km h yields 0.10 which means that the normalized CFO lies within 10 of the subcarrier spacing. Timing errors depend on the distances of the RSSs from the BS and their maximum value corresponds to the round trip propagation delay for a user located at the cell boundary. This parameter is known and is given by 2R cT where R is the cell radius and T 1 N f is the sampling period. A simple way to counteract the effects of timing errors relies on the use of sufficiently long CPs comprising N L sampling intervals. This leads to a quasi synchronous network in which timing errors do not produce any IBI and result only in phase shifts at the output of the receive DFT unit. The CP of data blocks should be made just greater than the channel length to minimize unnecessary overhead. It follows that accurate timing estimation must be accomplished during the ranging period in order to align all active users with the BS time slot and to avoid IBI over the data section of the frame.

In step the number of received codes in the considered subchannel is determined by evaluating the correlation matrix and applying an eigendecomposition EVD procedure. It is assumed that the CFOs are confined within a small fraction of the subcarrier spacing. In such a case the demodulated signals incur negligible phase rotations over one OFDM block and W in Equation 4 above can be approximated by I. Substituting Equation 3 into Equation 2 and observing that FF I yields 

From Equation 11 it is seen that Y i is a superposition of frequency rotated codes cembedded in white Gaussian noise and with random amplitudes S i . This model has the same structure as measurements of multiple uncorrelated sources from an array of sensors. EVD can then be performed on the correlation matrix of Y i whereupon the active codes and their corresponding CFOs can subsequently be determined.

Estimation of the number of active codes over the ranging subchannel can be accomplished in step through the EVD of the correlation matrix R EY i Y i . Let . . . be the eigenvalues of Rarranged in non increasing order. Then from Equation 11 it follows that the M K smallest eigenvalues are equal to the noise power while the largest K eigenvalues are related to and also to the average signal power. Mathematically the following Equation applies 

In step after performing EVD on circumflex over R and arranging the eigenvalues circumflex over circumflex over . . . circumflex over in non increasing order an estimate circumflex over K of the number of active codes is found through information theoretic criteria. Two examples of such criteria are represented by the Akaike and Minimum Description Length MDL criteria. The MDL approach looks for the minimum of the following objective function 2 ln ln tilde over 15 where tilde over K is the ratio between the geometric and arithmetic mean of circumflex over circumflex over . . . circumflex over i.e. 

In step once circumflex over K has been computed from Equation 12 an estimate of the noise power can be computed as 

In step CFOs are estimated using a MUSIC approach. The MUSIC algorithm relies on the fact that the eigenvectors . . . associated with the M K smallest eigenvalues of circumflex over R form an estimated basis of the noise subspace Sand accordingly they are approximately orthogonal to all vectors in the signal space S. An estimate of is thus obtained by minimizing the projection of tilde over conto the subspace spanned by the columns of . . . . This leads to the following estimation algorithm 

In principle CFO recovery must only be accomplished for the active codes. However since at this stage the BS has no knowledge of which codes have been transmitted over the considered subchannel frequency estimates circumflex over circumflex over . . . circumflex over must be evaluated for the complete set c c . . . c.

In step active codes are identified. The present invention searches for the K largest values in the set circumflex over say circumflex over and declares as active the corresponding codes c. The CFO estimates are eventually found as circumflex over circumflex over circumflex over . . . circumflex over . The CFO estimation based on the MUSIC algorithm is referred to herein as the MUSIC based frequency estimator MFE while the active code identification algorithm is referred to herein as the MUSIC based code detector MCD .

A key issue is the maximum CFO value that can be handled by MFE. To simplify the analysis it is assumed that the ranging codes belong to the Fourier basis of order M and are given by 01 20 for k 1 2 . . . M 1. Then identifiability of the rotated codes cis guaranteed as long as the CFOs are smaller than N 2MN in magnitude. Let N 2MN and N 2MN . In such a case the received codes cand care identical and there is no way to distinguish among them. This fact limits the acquisition range of MFE to the interval 

The computational load complexity of MFE can be assessed as follows. Assume that the number of active codes has already been found and is available at the BS. Then computing circumflex over R in Equation 14 requires approximately O MQV operations while the complexity for evaluating the metric tilde over in Equation 19 is O M M K for each tilde over . Denoting by N the number of candidate values tilde over and observing that the maximization in Equation 18 must be performed over the entire code set c c . . . c it follows that a total of O NM M K operations are required to find circumflex over . The overall complexity of MFE is thus on the order of O MQV NM M K . This figure does not consider the EVD on tilde over R since this operation is comparatively easier than the maximization step in Equation 18.

First Equation 2 is reformulated in a more compact form. For this purpose matrices D c m eA are defined and collect the CFOs and timing errors in two K dimensional vectors . . . and . . . . Then Yis rewritten as 21 with S S S . . . S and D D D . . . D . Timing recovery is then accomplished by means of a two step procedure in which an estimate of S is computed first and then is exploited to obtain the timing errors.

In step it is assumed that the accuracy of the CFO estimates obtained in the first stage of the ranging process is such that tilde over . Then from Equation 21 the ML estimate of S based on the observed vectors Yis found to be 

To assess the computational load complexity of LS TE it is useful to distinguish between a first stage leading to the sequences v l in Equation 33 for 0 v V 1 and a second stage where these sequences are used to compute the timing metrics of the detected codes. First it is observed that a complexity of order O KN log N is required to determine the matrices D circumflex over for k 1 2 . . . K while computing the matrix T circumflex over and vector D circumflex over Yrequires O MKQV and O MKQV operations respectively. Evaluation of through Equation 22 is equivalent to solving a linear system of order KQV and needs O KQV operations. Finally the complexity of the IDFT in Equation 33 is O Q log Q for each value of v. Since most of the processing is devoted to the computation of T circumflex over the overall complexity in the first stage can reasonably be approximated as O MKQV . In the second stage of the estimation process the timing metric of Equation 32 is computed for all candidate values tilde over and all detected codes. Observing that O VL operations are required for each quantity tilde over the computational burden of the second stage is O KVL . The overall complexity of LS TE is summarized in the first row of Table 1 below. Reduced complexity timing delay estimates RC TE are provided for comparison purposes. RC TE is described below in connection with .

To quantify the computational saving of the simplified ML estimation algorithm of Equation 38 utilized in step with respect to Equation 22 it is observed that O MK and O MK operations are needed to obtain C circumflex over C circumflex over and C circumflex over Y i respectively while O K operations are further required for evaluating the right hand side of Equation 38. Since C circumflex over C circumflex over is independent of q and v the overall complexity involved in the computation of i for 0 q Q 1 and 0 v V 1 is approximately O KQV M K . Additional O QV logQ operations are eventually needed by the IDFTs in Equation 33. Compared to the first stage of LS TE it follows that the computational burden is reduced by a factor MKQV M K which may be significant even for small values of the product QV.

Evaluating tilde over for each value tilde over 0 1 . . . may still be computationally demanding especially when is large. A viable method to further reduce the system complexity is to decompose the timing error into a fractional part less than Q plus an integer part which is multiple of Q. This amounts to setting 41 where 0 1 . . . Q 1 while pis an integer parameter taking values in the set 0 1 . . . P 1 with P Q . In such a case the timing metric of Equation 32 can be manipulated into the equivalent form 

Inspection of Equations 45 and 46 indicates that the simplified estimator maximizes tilde over in a decoupled fashion where an estimate of is obtained first and is then exploited to get circumflex over p . In assessing the computational load of this scheme it is assumed that the quantities v l have already been computed for 0 v V 1. Then evaluating circumflex over through Equation 45 requires O QVL operations while O QVL operations are needed to get circumflex over p from Equation 46. Since estimates circumflex over and circumflex over p must be obtained for each detected code the overall complexity in the second stage of the estimation process is approximately O KVL Q PV . Compared to LS TE the computational requirement is thus reduced by a factor Q PV . This advantage is achieved at the price of some performance degradation since the described search procedure is not guaranteed to locate the global maximum of tilde over .

A further simplification is possible by setting V 2. In this case it is found from Equation 44 that maximizing circumflex over tilde over p with respect to tilde over p is equivalent to maximizing cos 2 tilde over p Q N with 

The modules are programmed in accordance with the processing steps discussed above and include an active code identification module a CFO estimation module a timing delay estimation module and a power level estimation module . The active code identification module processes the ranging OFDM blocks received by the transceiver from RSSs in communication with the transceiver to identify active codes. The active codes are then processed by the modules to provide estimates of the corresponding CFOs timing delays and power levels. These estimates are then broadcast by the transceiver to the RSSs so that each one can adjust its transmission parameters to the BS reference scales .

Software simulation testing was conducted to ascertain the performance characteristics of the present invention. Simulations of an IEEE 802.16 wireless MAN programmed in accordance with the present invention was conducted which had a total of N 1024 subcarriers over an uplink bandwidth of 11.4 MHz. The sampling period is T 87.5 ns corresponding to a subcarrier distance of 1 NT 11.16 kHz. It was assumed that R 8 subchannels were available for initial ranging. Each subchannel was divided into Q 16 tiles uniformly spaced over the signal spectrum at a distance of N Q 64 subcarriers. To reduce the system complexity the number of subcarriers in any tile was set to V 2. Each ranging time slot included M 4 OFDM blocks. The ranging codes were taken from a Fourier set of length and are randomly selected by the RSSs at each simulation run expect for the sequence 1 1 1 1 . The discrete time CIRs had order L 12. Their entries were modeled as independent and circularly symmetric Gaussian random variables with zero means and an exponential power delay profile i.e. exp 12 0 1 . . . 11 49 where is related to the average transmission power of the kth RSS. In all subsequent simulations was chosen such that E h 1 for 1 k K. In this way the powers Pof the ranging signals are random variables with unit means. Channels of different users were assumed to be statistically independent of each other. They were generated at each new simulation run and kept fixed over an entire time slot. A cell radius of 10 km was considered corresponding to a maximum propagation delay of 204 sampling periods. Ranging blocks were preceded by a CP of length N 256 in order to avoid IBI. The normalized CFOs were uniformly distributed over the interval and varied at each run. Recalling that the estimation range of MFE is 

Simulations began by investigating the performance of MCD in terms of probability of making an incorrect detection say P. The latter is defined as the probability that the set of detected codes does not coincide with the set of codes participating in the ranging process. illustrates Pas a function of the signal to noise ratio SNR defined as SNR 1 . The number of active RSSs is either 2 or 3 while the maximum CFO is 0.05. Comparisons were made with the ranging scheme proposed by Fu Li and Minn FLM where the kth ranging code is declared active provided that the quantity 

The impact of the CFOs on the performance of MFE was assessed in where the RMSE is shown as a function of . The SNR was fixed to 10 dB while K was still 2 or 3. As expected the accuracy of the frequency estimates degrades with due to increased amount of inter channel interference ICI that affects the received signal. However the loss is quite small over the full range 0.1.

The performance of the timing estimators was measured in terms of probability of making a timing error say P . An error event was declared to occur whenever the estimate circumflex over gave rise to IBI during the data section of the frame. In such a case the quantity circumflex over L N 2 is larger than zero or smaller than L N 1 where Nis the CP length during the data transmission period. In our simulations we set N 64. illustrates P vs. SNR as obtained with RC TE LS TE and FLM. The number of active codes was K 2 or 3 while 0.05. It can be seen that for SNR larger than 6 dB RC TE and LS TE provided much better results than FLM. Also the loss of RC TE with respect to LS TE is negligible in all considered situations.

The impact of residual CFOs on the RMSE of the power estimates was assessed as shown in where the RMSE is shown as a function of . Again the SNR was fixed to 10 dB and K was either 2 or 3. As can be seen LS PE performed slightly better than RC PE. Both schemes were extremely robust to CFOs when K is either 2 or 3.

The embodiment shown in can be employed in an OFDMA system employing N subcarriers with index set 0 1 . . . N 1. It is assumed that a ranging time slot is composed by M consecutive OFDMA blocks while the N available subcarriers are grouped into ranging subchannels and data subchannels. The former are used by the active RSSs to initiate their ranging processes while the latter are assigned to DSSs for data transmission. R denotes the number of ranging subchannels and it is assumed that each of them is divided into Q subbands. A given subband is composed of a set of V adjacent subcarriers which is called a tile. The subcarrier indices of the qth tile q 0 1 . . . Q 1 in the rth subchannel r 0 1 . . . R 1 are collected into a set J i v where the tile index ican be chosen adaptively according to the actual channel conditions. The only constraint in the selection of iis that different tiles must be disjoint i.e. J J for q qor r r. The rth ranging subchannel is thus composed of QV subcarriers with indices in the set J J while a total of N QVR ranging subcarriers is available in each OFDMA block.

It is assumed that each subchannel can be accessed by a maximum number of K minV M 1 RSSs which are separated by means of orthogonal codes in both the time and frequency domains. The codes are selected in a pseudo random fashion from a predefined set C C . . . C with

The signal transmitted by the kth RSS propagates through a multipath channel characterized by a channel impulse response CIR h h 0 h 1 . . . h L 1 of length L in sampling periods . We denote by the timing error of the kth RSS expressed in sampling intervals T while is the frequency offset normalized to the subcarrier spacing. During IR the CFOs are only due to Doppler shifts and or to estimation errors and in consequence they are assumed to lie within a small fraction of the subcarrier spacing. Timing offsets depend on the distance of the RSSs from the BS and their maximum value is thus limited to the round trip delay from the cell boundary. In order to eliminate IBI it is assumed that during the ranging process the CP length comprises N L sampling periods where is the maximum expected timing error. This assumption is not restrictive as initialization blocks are usually preceded by long CPs in many standardized OFDM systems.

In step a ranging subchannel is extracted from the DFT outputs corresponding to the received OFDM blocks. We denote by X q X i X i 1 . . . X i V 1 the DFT outputs corresponding to the qth tile in the mth OFDMA block. Since DSSs have successfully completed their IR processes they are perfectly aligned to the BS references and their signals do not contribute to X q . In contrast the presence of uncompensated CFOs destroys orthogonality among ranging signals and gives rise to ICI. The latter results in a disturbance term plus an attenuation of the useful signal component. To simplify the analysis in the ensuing discussion the disturbance term is treated as a zero mean Gaussian random variable while the signal attenuation is considered as part of the channel impulse response. Under the above assumptions we may write

To proceed further it is assumed that the tile width is much smaller than the channel coherence bandwidth. In this case the channel response is nearly flat over each tile and we may reasonably replace the quantities H i v with an average frequency response

As discussed below the DFT outputs X i v can be exploited to identify the active codes and to estimate the corresponding timing errors and CFOs.

In step the number K of active codes over the considered ranging subchannel is determined. For this purpose we collect the i v th DFT outputs across all ranging blocks into an M dimensional vector Y i X i v X i v . . . X i v given by

From Equation 59 above it can be observed that Y i has the same structure as measurements of multiple uncorrelated sources from an array of sensors. Hence an estimate of K can be obtained by performing an EVD of the correlation matrix R EY i Y i . In practice however Ris not available at the receiver and must be replaced by some suitable estimate. One popular strategy to get an estimate of Ris based on the FB principle. Following this approach Ris replaced by 60 where tilde over R is the sample correlation matrix

In step CFOs are estimated using the ESPRIT algorithm. For simplicity it is assumed that the number of active codes has been perfectly estimated. Then an estimate of . . . can be found by applying the ESPRIT algorithm to the model set forth in Equation 59. The eigenvectors of circumflex over R associated to the K largest eigenvalues circumflex over circumflex over . . . circumflex over are arranged into an M K matrix Z zz. . . z . Next we consider the matrices Zand Zthat are obtained by collecting the first M 1 rows and the last M 1 rows of Z respectively. The entries of are finally estimated in a decoupled fashion as

After computing estimates of the effective CFOs through Equation 63 the problem arises of matching each circumflex over to the corresponding code C. This amounts to finding an estimate of lstarting from circumflex over . For this purpose we denote by the magnitude of the maximum expected CFO and observe from Equation 57 that M 1 belongs to the interval J 1 1 with N M 1 N. It follows that the effective CFOs can be univocally mapped to their corresponding codes as long as 

In step timing errors are estimated next. We call X q X i X i 1 . . . X i V 1 the V dimensional vector of the DFT outputs corresponding to the qth tile in the mth OFDM block. Then from Equation 56 we have

The quantities circumflex over are eventually used to find estimates circumflex over l circumflex over of the associated ranging code and timing error. To accomplish this task we let V 1 2N . Then recalling that 0 from Equation 58 it can be seen that V 1 falls into the range I l l . If 

In step code detection is performed. From Equations 67 and 74 it can be seen that two distinct estimates circumflex over l and circumflex over l are available at the receiver for each code index l. These estimates are now used to decide which codes are actually active in the considered ranging subchannel. For this purpose we define two sets I circumflex over l and I circumflex over l and observe that in the absence of any detection error it should be I I l. Hence for any code matrix C C the following detection strategy is utilized 

In step power levels are eventually estimated. Assume that the accuracy of the frequency and timing estimates provided by EFE and ETE is such that circumflex over and circumflex over . Then the ML estimate of q S q S q . . . S q for q 0 1 . . . Q 1 based on the observation vectors X q is found to be

In step a determination is made as to whether additional ranging subchannels exist. If a positive determination is made step occurs again and the processing steps shown in are repeated so that the additional ranging subchannels can be processed. Otherwise step occurs wherein the estimated CFOs timing errors and power levels are broadcast to remote users. In the downlink response message the BS will indicate only the detected codes while undetected RSSs must restart their ranging process.

Performance testing began by investigating the performance of ECD in terms of probability of making an incorrect detection. illustrates P as a function of SNR 1 . The number of active RSSs was 2 and 3 while the maximum CFO was either 0.05 or 0.1. Comparisons were made with the ranging scheme proposed by Fu Li and Minn FLM . The results of indicate that ECD performs remarkably better than FLM.

The performance of the timing estimators is measured in terms of probability of making a timing error say P . An error event is declared to occur whenever the estimate circumflex over gives rise to IBI during the data section of the frame. This is tantamount to saying that the timing error circumflex over L N 2 is larger than zero or smaller than L N 1 where Nis the CP length during the data transmission phase. For testing purposes we set N 32. illustrates P vs. SNR as obtained with ETE and FLM. The number of active codes is K 2 or 3 while 0.05 or 0.1. It can be seen that ETE provides much better results than FLM.

Having thus described the invention in detail it is to be understood that the foregoing description is not intended to limit the spirit or scope thereof. What is desired to be protected is set forth in the following claims.

