---

title: Large interconnect fabrics
abstract: In one embodiment, a network switch includes multiple chips communicably coupled together and a buffered crossbar. Each chip is coupled to every other chip with two bi-directional serial channels and includes a slice of the buffered crossbar. One or more input ports, one or more output ports, and an input logic module are coupled to the plurality of chips, and the input logic module is configured to receive a packet of data, allocate the packet of data into one or more data fragments, and distribute the packet of data to the buffered crossbar. An output logic module is coupled to the chips and configured to retrieve the packet of data from the buffered crossbar, reconstruct the packet of data from the data fragments according to a gather scheme, and transmit the packet of data.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09160685&OS=09160685&RS=09160685
owner: Cisco Technology, Inc.
number: 09160685
owner_city: San Jose
owner_country: US
publication_date: 20120309
---
This application claims the benefit under 35 U.S.C. 119 e of U.S. Provisional Patent Application No. 61 451 301 filed 10 Mar. 2011 which is incorporated herein by reference.

This disclosure generally relates to network switches and more specifically relates to interconnect switch fabrics.

A network switch is a data switching device that forwards a data packet from a source network component to a destination network component. Typically a network switch receives a packet from the source network component via an input port and sends a packet to the destination network component via an output port.

A crossbar switch is a switching device that forwards packets directly from input ports to output ports without buffering. In a buffered crossbar inputs are connected to the memories directly and data may be written without delay. That is the memory is written to output after arbitration for a single bus per output. When memory is full there is a choice of storing in external memory or back pressuring which is specific to output port. Since each input and output has dedicated bus to all of its memories there is no resource conflict. A buffered crossbar may be non blocking.

In particular embodiments scatter gather I O is a method of input and output by which a single procedure call sequentially writes data from multiple buffers to a single data stream or reads from data stream to multiple buffers. Scatter gather refers to the process of gathering data from or scattering data into the given set of buffers. Scatter gather may operate synchronously or asynchronously. Interconnect fabrics are fundamental to all switches. As the number of nodes being connected goes up the complexity of the fabric also goes up.

Particular embodiments include large scale interconnects that maintain or improve key metrics such as of power cost and latency. In particular embodiments a switch includes N N bi directional serial ports dividing the ports among N chips each with N ports. Particular embodiments connect the chips with two bi directional serial channels so that each chip has two bi directional channels going to each of the other chips. In particular embodiments the serial channels are time sliced at least N ways one for each port. In particular embodiments inside each chip is a crossbar with N N horizontal and N N vertical lines. Particular embodiments include a memory at each intersection of the horizontal and vertical lines.

Particular embodiments use a buffered crossbar and a scatter gather scheme for sending data from an input to an output. Particular embodiments utilize large buffered crossbars using a scheme of scattering the input data and gathering the output data via serial channels that are time sliced. Particular embodiments eliminate the need for cross fabric traffic request grant or arbitration. Thus in particular embodiments both flow control decisions and arbitration decisions can be made without additional fabric traffic.

In particular embodiments when any input port receives a packet of data the packet is split into pieces and spread across the N chips of the system using the time slot assigned to that input port. In particular embodiments within the chips each fragment is stored in the memory at the intersection of the input and the intended output. In particular embodiments the memory location is the same in every chip for this packet but each holds different parts of the packet. Particular embodiments of the chip with the output port considers all the packets that lines up for it in its own memory chooses one for example at location L. In particular embodiments the rest of the chosen packet is read at location L in the other memories using the serial channel and the specific time slot for the particular output. In particular embodiments the resulting reconstructed packet is sent out through the output port.

Particular embodiments result in very low latency. Still packets are carried across the fabric in order which may eliminate the need for complex out of order schemes. In particular embodiments the cost and power of the implementation is low. In particular embodiments a switch may be built using only one kind of chip.

Particular embodiments comprise internal components of a switch or router system in addition to the crossbar fabric. illustrates an example switch or router system. In the example of switch comprises front panel ports MAC PCS input logic external memory controller external memory scatter gather ports cross point output logic priority resolution and stats . In particular embodiments one or more systems perform one or more steps of one or more methods described or illustrated herein. Particular embodiments include one or more portions of one or more systems .

In particular embodiments data packets are received through a physical connection at front panel ports . MAC PCS comprise input ports that are 10 G 40 G and 100 G compatible. The input ports may be configured to couple to a variety of hardware and network protocols. The input ports may comprise one or more physical interfaces to a network. The input port may be configured to both receive and transmit data packets or fragments of the data packets. The method may start at step of where data packets are received at an input logic module. The data packets may be received at input logic . Input logic may comprise logic that receives incoming data packets.

At step the packet of data may be allocated into data fragments. In particular embodiments the data fragments may each be about the same size. In particular embodiments the total number of data fragments may be dependant on the number of chips in the plurality of chips. That is one data fragment may be allocated per chip. In particular embodiments if the data packet is not large enough to be split into equally sized packets one for each chip the data fragments may still be of equal size for as many chips as possible. Input logic comprises logic that may allocate the packets of data into data fragments that is input logic may split data packets into cells and sub cells. In particular embodiments input logic may comprise a cellulizer that splits the data packets in to cells and sub cells. Input logic may attempt to detect errors in each data packet by checking the header bit parity or using address failure detection AFD logic. In particular embodiments input logic determines the chip and chip address to which each of the data fragments will be sent by performing a fabric port of exit FPOE lookup. Input logic may act as a switched port analyzer SPAN to select network traffic for analysis by a network analyzer. In particular embodiments SPAN mirrors traffic from one or more source ports to a destination port for analysis.

External memory controller manages the flow of data and supports transfers between the input logic of switch system illustrated in and external memory . External memory may have separate base addresses and address range than cross point .

At step the packet of data may be distributed to the buffered crossbar utilizing a scatter scheme. In particular embodiments data fragments may be distributed for storage to a particular address on each chip across the plurality of chips of a single buffered crossbar and utilizing a scatter scheme. Packets may be distributed without reference to the final network port destination of the packets. In particular embodiments sub cells are scattered to a particular chip and chip address one sub cell to each chip in the plurality of chips. In particular embodiments a single buffered crossbar handles all types of incoming and outgoing traffic such as unicast multicast and multiple priorities of each with respect to quality of service QoS . In particular embodiments a single buffered crossbar may handle incoming and outgoing traffic according to QoS. In particular embodiments some locations on each chip may be reserved for different types of incoming and outgoing traffic such as unicast multicast and based on QoS. In particular embodiments there may be two buffered crossbars one buffered crossbar for low quality traffic and one buffered crossbar for high quality traffic.

Scatter gather ports may comprise one or more physical interfaces between input logic and cross point . Scatter gather ports may be configured to couple to a variety of hardware and network protocols. The scatter gather ports may be configured to both receive and transmit data packets or fragments of the data packets. The scatter gather ports may be 10 G or for higher speeds such as 40 G and 100 G. The scatter gather ports may be utilized to distribute the data fragments for storage to a particular address space on each chip across the plurality of chips utilizing a scatter scheme.

Cross point comprises a plurality of chips communicably coupled together and comprising a buffered crossbar. Each of the chips in crosspoint may be coupled to each other chip and comprise a slice of the buffered crossbar fabric. In particular embodiments each chip is mutually exclusive. In particular embodiments inside each chip is a crossbar with N N horizontal and N N vertical lines where N is an integer greater than 1. Although a simplified buffered crossbar is shown for illustration purposes in practice a buffered crossbar may have more than 1000 inputs and 1000 outputs such as 3000 4000 8000 or 10000 inputs outputs. In particular embodiments for example a 4000 port switch may have 64 chips with 64 front panel ports.

The example fabric of has four nodes B B B B that are each coupled to each other with two bi directional serial channels . In particular embodiments with M nodes or chips with N inputs outputs each there may be a total of N M 1 bi directional channels. In particular embodiments with N chips with N inputs outputs each there may be N N 1 wires coupling the chips. In particular embodiments bi directional serial channels may comprise 10 G copper standard connectors or optical connectors such as a Fiber Distributed Data Interface FDDI connector or other types of optical connectors. Switch fabrics may have other N M densities where N and M are both integers greater than 1. In particular embodiments for example switch fabrics may be 2 4 switch fabrics.

In particular embodiments any of the four nodes B B B B may act as an input node or an output node. When a data packet is received at an input node for example at node B the data packet may be fragmented into four equal parts. A first data fragment may remain at node B while the three other data fragments are sent to node B B and B respectively. Similarly a data packet may be received at nodes B B or B and then get fragmented into four equal parts and distributed to the other remaining nodes.

With respect to when the data packet is ready to be sent out an output node for example B which already has a quarter of the packet of data collects each of the other three data fragments from nodes B B and B reconstructs the packet of data from the four fragments and transmits the packet of data. Collecting the data fragments reconstructing the packets of data and transmitting the packets of data may also occur at any of the three other nodes that were not the initial input node.

At step the packets of data is retrieved from the buffered crossbar by retrieving the one or more data fragments from the plurality of chips. Output logic module is coupled to the plurality of chips. The output logic module is configured to retrieve and reassemble the packet of data from the plurality of chips. At step the packets of data are reconstructed from the data fragments at an output port according to a gather scheme. In particular embodiments sub cells are combined to form a cell and cells are combined to recreate the packet of data. The packet of data is reassembled from a plurality of different flows such as unicast multicast and multiple priorities of each. In particular embodiments there is one output port for every input port. In particular embodiments there may be greater than one output port for each input port.

Output logic module may reassemble the packet of data from cells and sub cells. Data packets may be reassembled based on type of data flow or QoS. Priority resolution module may determine which data packets are going to be reassembled based on type of data flow or QoS. Stats module may monitor all traffic routed through switch and collect statistics on the data flow relating to hardware and software information. Hardware information may include information such as packet and byte counts start and end timestamps source and destination IP addresses IP protocol and source and destination port numbers. Software information may include information such as input identifier output identifier routing information including next hop address origin and peer egress traffic and source and destination prefix mask.

At step the packet of data is transmitted to other nodes in the network at which point the method may end. Data packets may be sent out through MAC PCS and the physical connections on front panel ports to destination endpoints. Particular embodiments may repeat the steps of the method of where appropriate. Moreover although this disclosure describes and illustrates particular steps of the method of as occurring in a particular order this disclosure contemplates any suitable steps of the method of occurring in any suitable order. Furthermore although this disclosure describes and illustrates particular components devices or systems carrying out particular steps of the method of this disclosure contemplates any suitable combination of any suitable components devices or systems carrying out any suitable steps of the method of .

Particular embodiments may be implemented on one or more network devices. illustrates an example network device . In particular embodiments one or more devices perform one or more steps of one or more methods described or illustrated herein. In particular embodiments one or more devices provide functionality described or illustrated herein. In particular embodiments software running on one or more devices performs one or more steps of one or more methods described or illustrated herein or provides functionality described or illustrated herein. Particular embodiments include one or more portions of one or more devices .

This disclosure contemplates any suitable number of devices . This disclosure contemplates device taking any suitable physical form. As example and not by way of limitation device may be an embedded device a system on chip SOC a single board computer system SBC such as for example a computer on module COM or system on module SOM a desktop computer system a laptop or notebook computer system an interactive kiosk a mainframe a mesh of computer systems a mobile telephone a personal digital assistant PDA a server or a combination of two or more of these. Where appropriate device may include one or more devices be unitary or distributed span multiple locations span multiple machines or reside in a cloud which may include one or more cloud components in one or more networks. Where appropriate one or more devices may perform without substantial spatial or temporal limitation one or more steps of one or more methods described or illustrated herein. As an example and not by way of limitation one or more devices may perform in real time or in batch mode one or more steps of one or more methods described or illustrated herein. One or more devices may perform at different times or at different locations one or more steps of one or more methods described or illustrated herein where appropriate.

In particular embodiments network device includes a processor memory storage an input output I O interface a communication interface and a bus . Although this disclosure describes and illustrates a particular device having a particular number of particular components in a particular arrangement this disclosure contemplates any suitable device having any suitable number of any suitable components in any suitable arrangement.

In particular embodiments processor includes hardware for executing instructions such as those making up a computer program. As an example and not by way of limitation to execute instructions processor may retrieve or fetch the instructions from an internal register an internal cache memory or storage decode and execute them and then write one or more results to an internal register an internal cache memory or storage . In particular embodiments processor may include one or more internal caches for data instructions or addresses. This disclosure contemplates processor including any suitable number of any suitable internal caches where appropriate. As an example and not by way of limitation processor may include one or more instruction caches one or more data caches and one or more translation lookaside buffers TLBs . Instructions in the instruction caches may be copies of instructions in memory or storage and the instruction caches may speed up retrieval of those instructions by processor . Data in the data caches may be copies of data in memory or storage for instructions executing at processor to operate on the results of previous instructions executed at processor for access by subsequent instructions executing at processor or for writing to memory or storage or other suitable data. The data caches may speed up read or write operations by processor . The TLBs may speed up virtual address translation for processor . In particular embodiments processor may include one or more internal registers for data instructions or addresses. This disclosure contemplates processor including any suitable number of any suitable internal registers where appropriate. Where appropriate processor may include one or more arithmetic logic units ALUs be a multi core processor or include one or more processors . Although this disclosure describes and illustrates a particular processor this disclosure contemplates any suitable processor.

In particular embodiments memory includes main memory for storing instructions for processor to execute or data for processor to operate on. As an example and not by way of limitation device may load instructions from storage or another source such as for example another device to memory . Processor may then load the instructions from memory to an internal register or internal cache. To execute the instructions processor may retrieve the instructions from the internal register or internal cache and decode them. During or after execution of the instructions processor may write one or more results which may be intermediate or final results to the internal register or internal cache. Processor may then write one or more of those results to memory . In particular embodiments processor executes only instructions in one or more internal registers or internal caches or in memory as opposed to storage or elsewhere and operates only on data in one or more internal registers or internal caches or in memory as opposed to storage or elsewhere . One or more memory buses which may each include an address bus and a data bus may couple processor to memory . Bus may include one or more memory buses as described below. In particular embodiments one or more memory management units MMUs reside between processor and memory and facilitate accesses to memory requested by processor . In particular embodiments memory includes random access memory RAM . This RAM may be volatile memory where appropriate. Where appropriate this RAM may be dynamic RAM DRAM or static RAM SRAM . Moreover where appropriate this RAM may be single ported or multi ported RAM. This disclosure contemplates any suitable RAM. Memory may include one or more memories where appropriate. Although this disclosure describes and illustrates particular memory this disclosure contemplates any suitable memory.

In particular embodiments storage includes mass storage for data or instructions. As an example and not by way of limitation storage may include an HDD a floppy disk drive flash memory an optical disc a magneto optical disc magnetic tape or a Universal Serial Bus USB drive or a combination of two or more of these. Storage may include removable or non removable or fixed media where appropriate. Storage may be internal or external to device where appropriate. In particular embodiments storage is non volatile solid state memory. In particular embodiments storage includes read only memory ROM . Where appropriate this ROM may be mask programmed ROM programmable ROM PROM erasable PROM EPROM electrically erasable PROM EEPROM electrically alterable ROM EAROM or flash memory or a combination of two or more of these. This disclosure contemplates mass storage taking any suitable physical form. Storage may include one or more storage control units facilitating communication between processor and storage where appropriate. Where appropriate storage may include one or more storages . Although this disclosure describes and illustrates particular storage this disclosure contemplates any suitable storage.

In particular embodiments I O interface includes hardware software or both providing one or more interfaces for communication between device and one or more I O devices. Device may include one or more of these I O devices where appropriate. One or more of these I O devices may enable communication between a person and device . As an example and not by way of limitation an I O device may include a keyboard keypad microphone monitor mouse printer scanner speaker still camera stylus tablet touch screen trackball video camera another suitable I O device or a combination of two or more of these. An I O device may include one or more sensors. This disclosure contemplates any suitable I O devices and any suitable I O interfaces for them. Where appropriate I O interface may include one or more device or software drivers enabling processor to drive one or more of these I O devices. I O interface may include one or more I O interfaces where appropriate. Although this disclosure describes and illustrates a particular I O interface this disclosure contemplates any suitable I O interface.

In particular embodiments communication interface includes hardware software or both providing one or more interfaces for communication such as for example packet based communication between device and one or more other devices or one or more networks. As an example and not by way of limitation communication interface may include a network interface controller NIC or network adapter for communicating with an Ethernet or other wire based network or a wireless NIC WNIC or wireless adapter for communicating with a wireless network such as a WI FI network. This disclosure contemplates any suitable network and any suitable communication interface for it. As an example and not by way of limitation device may communicate with an ad hoc network a personal area network PAN a local area network LAN a wide area network WAN a metropolitan area network MAN or one or more portions of the Internet or a combination of two or more of these. One or more portions of one or more of these networks may be wired or wireless. As an example device may communicate with a wireless PAN WPAN such as for example a BLUETOOTH WPAN a WI FI network a WI MAX network a cellular telephone network such as for example a Global System for Mobile Communications GSM network or other suitable wireless network or a combination of two or more of these. Device may include any suitable communication interface for any of these networks where appropriate. Communication interface may include one or more communication interfaces where appropriate. Although this disclosure describes and illustrates a particular communication interface this disclosure contemplates any suitable communication interface.

In particular embodiments bus includes hardware software or both coupling components of device to each other. As an example and not by way of limitation bus may include an Accelerated Graphics Port AGP or other graphics bus an Enhanced Industry Standard Architecture EISA bus a front side bus FSB a HYPERTRANSPORT HT interconnect an Industry Standard Architecture ISA bus an INFINIBAND interconnect a low pin count LPC bus a memory bus a Micro Channel Architecture MCA bus a Peripheral Component Interconnect PCI bus a PCI Express PCI X bus a serial advanced technology attachment SATA bus a Video Electronics Standards Association local VLB bus or another suitable bus or a combination of two or more of these. Bus may include one or more buses where appropriate. Although this disclosure describes and illustrates a particular bus this disclosure contemplates any suitable bus or interconnect.

This disclosure contemplates one or more computer readable storage media implementing any suitable storage. In particular embodiments a computer readable storage medium implements one or more portions of processor such as for example one or more internal registers or caches one or more portions of memory one or more portions of storage or a combination of these where appropriate. In particular embodiments a computer readable storage medium implements RAM or ROM. In particular embodiments a computer readable storage medium implements volatile or persistent memory. In particular embodiments one or more computer readable storage media embody software. Herein reference to software may encompass one or more applications bytecode one or more computer programs one or more executables one or more instructions logic machine code one or more scripts or source code and vice versa where appropriate. In particular embodiments software includes one or more application programming interfaces APIs . This disclosure contemplates any suitable software written or otherwise expressed in any suitable programming language or combination of programming languages. In particular embodiments software is expressed as source code or object code. In particular embodiments software is expressed in a higher level programming language such as for example C Perl or a suitable extension thereof. In particular embodiments software is expressed in a lower level programming language such as assembly language or machine code . In particular embodiments software is expressed in JAVA C or C . In particular embodiments software is expressed in Hyper Text Markup Language HTML Extensible Markup Language XML or other suitable markup language.

Herein a computer readable non transitory storage medium or media may include one or more semiconductor based or other integrated circuits ICs such as for example field programmable gate arrays FPGAs or application specific ICs ASICs hard disk drives HDDs hybrid hard drives HHDs optical discs optical disc drives ODDs magneto optical discs magneto optical drives floppy diskettes floppy disk drives FDDs magnetic tapes solid state drives SSDs RAM drives SECURE DIGITAL cards or drives any other suitable computer readable non transitory storage medium or media or any suitable combination of two or more of these where appropriate. A computer readable non transitory storage medium or media may be volatile non volatile or a combination of volatile and non volatile where appropriate.

Herein or is inclusive and not exclusive unless expressly indicated otherwise or indicated otherwise by context. Therefore herein A or B means A B or both unless expressly indicated otherwise or indicated otherwise by context. Moreover and is both joint and several unless expressly indicated otherwise or indicated otherwise by context. Therefore herein A and B means A and B jointly or severally unless expressly indicated otherwise or indicated otherwise by context.

This disclosure encompasses all changes substitutions variations alterations and modifications to the example embodiments herein that a person having ordinary skill in the art would comprehend. Moreover although this disclosure describes and illustrates respective embodiments herein as including particular components elements functions operations or steps any of these embodiments may include any combination or permutation of any of the components elements functions operations or steps described or illustrated anywhere herein that a person having ordinary skill in the art would comprehend. Furthermore reference in the appended claims to an apparatus or system or a component of an apparatus or system being adapted to arranged to capable of configured to enabled to operable to or operative to perform a particular function encompasses that apparatus system component whether or not it or that particular function is activated turned on or unlocked as long as that apparatus system or component is so adapted arranged capable configured enabled operable or operative.

