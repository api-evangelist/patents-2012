---

title: Method and system for user authentication for computing devices utilizing PKI and other user credentials
abstract: A system and method for user authentication utilizing PKI credentials and user credentials on an electronic device comprising a mobile communication device, smart phone, a computer or other computing device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09166777&OS=09166777&RS=09166777
owner: Echoworx Corporation
number: 09166777
owner_city: Toronto
owner_country: CA
publication_date: 20120305
---
This invention relates to electronic devices and more particularly to a method and system for user authentication using PKI credentials and other user credentials for an electronic mobile communication device or a computing device configured with an operating system.

The Lion operating system is the operating system typically installed on Apple computers such as the Mac and the Macbook devices. iOS known as the iPhone Operating System is a mobile operating system from Apple Inc. The iOS operating system was originally developed for the iPhone device. It has since been extended to other Apple devices such as the iPod touch device and the iPad tablet.

Windows is the operating system from Microsoft Corporation typically installed on the vast majority of personal computers.

Microsoft Corporation also has its Windows Phone operating system for mobile communication device platforms. Other operating systems for mobile device platforms include BlackBerry OS from Research In Motion and Android from Google.

Under the typical operating system a device can be configured with user credentials such as a user identifier i.e. user id and or a password. In known manner the user credentials provide an authentication mechanism for allowing a user to gain access to the device.

Similarly the operating systems for other mobile devices or computing devices include a mechanism for configuring user credentials.

It will be appreciated that while such an authentication mechanism provides a layer of security once the user credentials are compromised the device is exposed to a potentially malicious user or system.

The present invention is directed to a method and system for user authentication using PKI Public Key Infrastructure credentials and other user credentials for an electronic communication device a computer and other types of computing devices or smart phones or mobile devices configured for an iOS based operating system Windows based operating system or other types of operating systems or platforms.

According to one aspect the present invention comprises a device configured for generating authentication credentials for a user associated with the device.

According to another aspect the present invention comprises a computer implemented method for generating authentication credentials for a user associated with a device.

According to another aspect the present invention comprises a device configured for providing access to a user associated with the device based on an authentication of a plurality of credentials configured for the user.

According to another aspect the present invention comprises a computer program product for setting up authentication credentials for a user associated with a device.

According to another aspect the present invention comprises a computer program product for providing access to a user associated with a device based on authentication of a plurality of credentials configured for the user.

According to one embodiment the present invention comprises a computing device configured for communication over a network said computing device comprising an application component configured for receiving a plurality of credentials for a user associated with the computing device and said plurality of credentials including a passcode and a registration code from a credential management system a component configured to generate one or more key pairs comprising public keys and private keys and including a digital signature public private key pair and an encryption public private key pair a component configured to submit a certificate signing request to said credential management system and said certificate signing request including said plurality of credentials said registration code and said one or more public keys a component configured to receive a certificate from said credential management system said certificate being generated based on authentication of said credentials and on the registration code included in said certificate signing request and a component configured for encrypting said one or more private keys with said passcode and storing said encrypted private keys locally.

According to another embodiment the present invention comprises a computer implemented method for configuring credentials associated with a user said method comprising the steps of inputting a passcode associated with the user receiving a registration code from a credential management system generating one or more key pairs comprising public keys and private keys and including a digital signature public private key pair and an encryption public private key pair transmitting a certificate signing request to said credential management system and said certificate signing request including said plurality of credentials said registration code and said one or more public keys receiving a certificate from said credential management system said certificate being generated based on authentication of said credentials and on the registration code included in said certificate signing request and encrypting said one or more private keys with said passcode and storing said encrypted private keys locally.

According to another embodiment the present invention comprises computer implemented method for authenticating a user for accessing an online application running on an application server from a computing device associated with the user said method comprising the steps of submitting a login request to the application server transmitting a random session identifier from the application server to the computing device prompting the user to enter one or more credentials including a passcode retrieving an encrypted private digital signature key stored at the computing device and decrypting said encrypted private digital signature key with said passcode signing said random session identifier with said decrypted private digital signature key transmitting said signed random session identifier and said one or more credentials to the application server verifying said signed random session identifier and said one or more credentials and authorizing the login request based on the verification of said signed random session identifier and said one or more credentials associated with the user.

According to another embodiment the present invention comprises a system for authenticating a user for accessing from a computing device an application running on an application server operatively coupled said system comprising a component configured to transmit a login request to the application server and receive a random session identifier from the application server an interface component configured to receive one or more credentials including a passcode entered by the user a component configured to retrieve an encrypted private signature key stored locally and to decrypt said encrypted private signature key utilizing said passcode entered by the user a component configured to sign said random session identifier with said decrypted private signature key a component configured to transmit said signed random session identifier and said one or more user credentials to the application server a component running on the application server configured to verify said signed random session identifier and said one or more user credentials and a component running on the application server configured to authorize the login request based on the verification of said signed random session identifier and said one or more credentials associated with the user.

According to another embodiment the present invention comprises a computer program product for configuring credentials associated with a user said computer program product comprising a storage medium configured to store computer readable instructions said computer readable instructions including instructions for inputting a passcode associated with the user receiving a registration code from a credential management system generating one or more key pairs comprising public keys and private keys and including a digital signature public private key pair and an encryption public private key pair transmitting a certificate signing request to said credential management system and said certificate signing request including said plurality of credentials said registration code and said one or more public keys receiving a certificate from said credential management system said certificate being generated based on authentication of said credentials and on the registration code included in said certificate signing request and encrypting said one or more private keys with said passcode and storing said encrypted private keys locally.

According to another embodiment the present invention comprises a computer program product for authenticating a user for accessing an online application running on an application server from a computing device associated with the user said computer program product comprising a storage medium configured to store computer readable instructions said computer readable instructions including instructions for submitting a login request to the application server transmitting a random session identifier from the application server to the computing device prompting the user to enter one or more credentials including a passcode retrieving an encrypted private digital signature key stored at the computing device and decrypting said encrypted private digital signature key with said passcode signing said random session identifier with said decrypted private digital signature key transmitting said signed random session identifier and said one or more credentials to the application server verifying said signed random session identifier and said one or more credentials and authorizing the login request based on the verification of said signed random session identifier and said one or more credentials associated with the user.

Other aspects and features of the present invention will become apparent to those ordinarily skilled in the art upon review of the following exemplary embodiments of the invention in conjunction with the accompanying figures.

Reference is made to which shows in diagrammatic form an exemplary system incorporating a mechanism and process for setting up or configuring authentication credentials for a native application e.g. computer program or software application running or installed on a computer or other type of computing device according to an embodiment of the invention and indicated generally by reference .

The system comprises an electronic device and a credential management system . The electronic device and the credential management system are operatively coupled for communication through a communication network indicated generally by reference . The electronic device may comprise a desktop computer a notebook computer or other type of computer. According to another aspect the electronic device may comprises a smart phone such as the iPhone handheld device from Apple Inc. a BlackBerry device from Research In Motion or other mobile communication device or another type of computing device or tablet such as an iPAD device also from Apple Inc.

Referring to the computer is operatively coupled to a communication network and configured to transmit and receive email messages and other types of data and or voice communications. According to an embodiment the communication network comprises a wide area wireless network for example a cellular network. According to an embodiment the communication network provides Internet access. One or more email servers e.g. remote servers not shown are operatively to the communication network either through the Internet or directly through a transceiver not shown . According to another exemplary implementation the device is operatively coupled to a local area network or LAN for example a wireless LAN WLAN WI Fi or Bluetooth based connection. One or more email servers not shown are operatively coupled to the wireless WLAN. In known manner the communication networks provide the capability for the computer or device to transmit and receive email messages and other types of messages or data communications from the remote or local remote servers for example configured as email servers.

The computer is configured with an operating system for example Microsoft Windows Apple iOS etc. and runs one or more computer programs or applications indicated generally by reference . The computer is configured with a communication module or interface. The communication module is implemented and configured in known manner and provides the capability for the device to interface with the communication network for example as described above. The computer programs running on the computer comprise an email module or client or application indicated generally by reference . The email module is configured in known manner to provide the capability or facility to compose transmit receive and otherwise manage email communications and other types of communications or data messages. The computer according to an embodiment of the present invention is configured with a credential setup application program i.e. a native application comprising a computer program or software and indicated generally by reference . As shown the computer is also configured with a key storage facility indicated generally by reference .

The key storage facility comprises a secure facility configured locally e.g. on the computer for storing credentials for example digital signature and encryption keys associated with a user. According to an embodiment the key storage facility comprises a local file system for example a key file .pfx which is encrypted and protected using one or more passcodes and or file access permissions. The key s are accessed through an input output I O application program interface API for the file system. According to another embodiment the key storage facility is configured for an iOS implementation where the device comprises an iPhone mobile communication device or for a Lion operating system on an Apple computer. The iOS operating system includes a sandbox. The sandbox comprises a secure data repository for example configured in local device memory and can be associated with one of the applications i.e. Apps installed on the computer or mobile device . According to an embodiment a sandbox is configured and utilized for the credential setup application . The key s comprise a keychain database which is stored in the sandbox and further encrypted and protected by passcode s . According to an exemplary implementation the device is configured with a keychain API for accessing the key s . According to another embodiment the key storage facility is configured under the operating system for example in a Windows based implementation utilizing the Microsoft Cryptographic Application Programming interface MSCAPI for the keystore facility. According to an exemplary implementation the computer is configured with a crypto API for accessing the key s in the keystore facility.

According to an exemplary embodiment the computer or device and the credential setup application are configured to function with a SasS based credential management system such as the ESS system available from Echoworx Corporation in Toronto Ontario CANADA and indicated generally by reference in . According to an exemplary embodiment the credential management system is configured to operate as a Web based service. The credential setup application is configured to provide user credential and authentication functions as will be described in more detail below.

As shown in the system is configured with a process to set up or configure credentials for a user according to an embodiment of the present invention. The first step in the process comprises receiving a registration email from the credential management system as indicated by reference . According to an embodiment the registration email is configured or includes a registration code RegCode . In response the credential setup i.e. the native application is launched and according to an embodiment the user is prompted to enter 1 email address 2 the registration code RegCode and 3 a passcode as indicated by reference . The passcode is used to encrypt the keys as described in more detail below. The credential setup application is configured to generate public private key pairs of signing and encryption keys as indicated generally by reference for example utilizing a Public Key Infrastructure or PKI. The credential setup application is configured to execute or implement various known encryption decryption mechanisms techniques or algorithms and can be updated according to current security best practices and developments. Next as indicated by reference the credential setup application is configured to submit or transmit a request in the form a Certificate Signing Request to the credential management system . According to an embodiment the Certificate Signing Request comprises the email address the Registration Code and the public keys. The credential management system includes a computer program or software configured to authorize the request received from the native application and publish a new certificate as indicated generally by reference . If the registration code RegCode received from the native application is invalid or incorrect the credential management system is configured to reject the Certificate Signing Request. According to an exemplary implementation the certificate is published to a Trusted Lookup Service. The credential management system transmits or returns the certificate to the credential setup application as indicated by reference in . The credential setup application receives the certificate and is configured to encrypt the keys i.e. the private keys with the passcode. The encrypted keys are securely stored or saved in memory comprising the key storage facility as indicated generally by reference .

Reference is next made to which illustrates by way of example an authentication and authorization operation for providing access for a user to an online application through a native application client according to an embodiment of the present invention and indicated generally by reference . In this example the user of the device wishes to log on or gain access to an online application running on an application server .

As indicated by reference the native application or client is installed on the computer and is configured e.g. through executable code or software to submit a login request to the application server for example on startup or in response to a user request. The application server is configured e.g. through executable code or software to generate or respond with a random session ID as indicated by reference . The native application is configured to prompt the user to enter a passcode a user identifier i.e. user ID and a password as indicated in step . The native application loads the private key s associated with the user from the local key storage as also shown in and is configured to utilize the passcode to decrypt the private keys as indicated by reference . The native application then uses the decrypted private signature key to sign the random session ID received from the application server as indicated by step . The native application is configured to submit or transmit the signed random session ID and the user ID and password to the application server as indicated by reference . If the application server is inaccessible e.g. is offline or doesn t respond then an exception condition occurs and the login procedure is terminated. The application server is configured for example through executable code or software to authenticate the identity of the user for example by verifying the signature i.e. the signed random session ID as indicated in step . This ensures the random session ID issued by the application server is associated with the correct or valid user ID. If the signature is invalid has expired or is not correctly associated with the user ID then the authentication operation is a fail and exception condition arises. Similarly if the passcode or password provided by the native application is incorrect invalid or expired or the private keys are missing e.g. the random session ID is not signed by the private signature key then an exception condition occurs and the authentication procedure fails and is terminated or suspended. Once the user is authenticated the application server is configured to authorize system access for the user by validating the user ID and the password in step . The application server then returns a successful login e.g. a landing page to the native application as indicated by reference in .

Reference is next made to which shows in diagrammatic form an exemplary system incorporating a mechanism and process for setting up or configuring authentication credentials for a user through a web based application e.g. an application accessed using a Web browser such as Internet Explorer from Microsoft Corporation according to an embodiment of the invention and indicated generally by reference .

The system includes a computing device e.g. a computer and a credential management system . The computer and the credential management system are operatively coupled for communication through a communication network for example the Internet or World Wide Web www indicated generally by reference . The electronic device may comprise any web enabled device such as a desktop computer a notebook computer or according to another aspect a smart phone such as the iPhone handheld device from Apple Inc. the BlackBerry handheld device from Research In Motion or other mobile communication device or another type of computing device or a tablet such as an iPAD device also from Apple Inc.

Referring still to the computer is operatively coupled to a communication network and configured to transmit and receive email messages and other types of data and or voice communications. According to an embodiment the communication network comprises a wide area wireless network or the Internet. One or more email servers and or other remote servers not shown are operatively to the communication network. In known manner the communication networks provide the capability for the computer to transmit and receive email messages and other types of messages or data communications from the remote or local remote servers for example configured as email servers and or application servers.

The computer is configured with an operating system for example Microsoft Windows Apple Lion Apple iOS BlackBerry OS etc. and runs one or more computer programs or applications indicated generally by reference . The computer is configured with a communication module or interface to provide connectivity to the network e.g. the Internet or World Wide Web . The computer programs running on the computer comprise an email module or client or application indicated generally by reference and a web browser application indicated generally by reference . The email module is configured in known manner to provide the capability or facility to compose transmit receive and otherwise manage email communications and other types of communications or data messages. According to an embodiment the computer is configured with a web browser for example Internet Explorer from Microsoft Corporation to execute or run a web page based credential management application as described in more detail below. As shown the computer is also configured with a key storage facility indicated generally by reference . The key storage facility can be implemented in a manner similar to that described above with reference to .

As shown in the credential management system according to this embodiment is configured with a credential management web portal indicated generally by reference . The credential management web portal comprises a web based interface configured with one or more web pages e.g. a landing paging accessed by the web browser e.g. Internet Explorer from Microsoft Corporation or a web enabled mobile communication device or smart phone .

As shown in the web based application is configured with a process for setting up or configuring credentials for a user utilizing the web portal . The process according to an exemplary implementation comprises executable code or computer software embodied or executed by the web browser the credential management web portal and or the credential management system and indicated by reference . The first step in the process comprises receiving a registration email from the credential management system and the registration email includes a registration code i.e. RegCode as indicated generally by reference in . The user then proceeds to launch the web browser running on the computer for example the Internet Explorer browser as indicated by reference . According to an embodiment the registration email can include embedded code or a link e.g. HTML link to launch the web browser and a landing page i.e. a setup page in the credential management web portal . According to an embodiment the credential web portal page is configured as indicated by reference to prompt the user to provide the following information or data 1 email address 2 registration code i.e. RegCode and 3 a passcode which is used to encrypt the keys as described in more detail below . Next as indicated by reference the credential management web portal is configured e.g. through executable code or software to generate public private key pairs for signing and encryption. The credential management web portal is configured to then submit a Certificate Signing Request to the credential management system as indicated by reference . According to an embodiment the Certificate Signing Request includes the email address for the user the registration code RegCode and the public key s . The credential management system is configured to authorize the request from the user s computer i.e. as indicated in step and publishes a new public certificate e.g. a PKI based certificate which is accessible through a trust lookup service e.g. a trusted authority or intermediary as indicated by reference . The credential management system also provides or returns a copy of the certificate to the credential management web portal as indicated by reference . The credential management web portal is configured to encrypt the keys i.e. the private signature and encryption keys utilizing the passcode. The encrypted keys can then be downloaded from the web browser i.e. the credential management web portal to the key storage facility and securely stored local to the computer as indicated generally by reference . According to an exemplary web based implementation the web browser is configured with a HTML5 FileReader API Application Programming Interface to provide a file system I O API capability for locally storing the encrypted keys.

Reference is next made to which illustrates by way of example an authentication and authorization operation for a user utilizing a web browser according to an embodiment of the present invention and indicated generally by reference . In this example the user of the computer or mobile device wishes to use the web browser to log on or access a web based application running on a web application server .

The user utilizes the web browser for example an installed version of the Internet Explorer browser to navigate to a login or landing page for the web application for example through a HTTPS request as indicated generally by reference . The web application server is configured e.g. through executable code or software to download the login page to the web browser as indicated by reference . According to an embodiment the login page includes a random session ID which is received from or generated by software or executable code on the web application server . The user is prompted on the login page to enter the passcode the UserID and a password as indicated by reference . The web browser is configured to load or retrieve the user s private keys from the key storage facility and decrypt the private keys i.e. signature and encryption keys using the passcode provided by the user as indicated by reference . If the passcode entered by the user is incorrect or the private key s are missing then an exception condition exists and the authentication procedure is terminated. The web browser uses the decrypted private signature key to sign the random session ID issued by the web application as indicated by reference and the web browser submits the signed random session ID to the web application server together with the user ID and the user password as indicated in step . If the web application server is not accessible e.g. off line then the login procedure is terminated. The web application is configured to verify or authenticate the identity of the user for example by verifying the signature i.e. the signed random session ID as indicated in step . This ensures the random session ID issued by the web application server is associated with the correct or valid user ID. If the signature is invalid has expired or is not correctly associated with the user ID then the authentication operation is a fail and exception condition arises. Once the user has been authenticated the web application server is configured to authorize system access i.e. log in for the user by validating the user ID and the password provided by the user through the web browser . If the user ID and or password is invalid or expired then the web application server terminates the log in for the user.

The credential setup application the credential management web portal the application components or modules for the web browser and other functional components or modules of the system can be implemented in known manner and comprise one or more computer programs software computer readable and executable code components modules or objects to provide the functions features and functionality as described herein and stored or embedded on computer readable media storage media or other digital storage media or devices. The particular implementation details will be readily within the understanding of one skilled in the art.

The present invention may be embodied in other specific forms without departing from its spirit or essential characteristics. The embodiments described and disclosed are to be considered in all aspects only as illustrative and not restrictive. The scope of the invention is therefore indicated by the appended claims rather than by the foregoing description. All changes which come within the meaning and range of equivalency of the claims are to be embraced within their scope.

