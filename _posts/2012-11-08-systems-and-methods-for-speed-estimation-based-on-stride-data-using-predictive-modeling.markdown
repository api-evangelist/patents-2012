---

title: Systems and methods for speed estimation based on stride data using predictive modeling
abstract: Systems and methods for speed estimation based on stride data using predictive modeling relate to portable wireless devices () that contain GPS or other location resources to generate position and speed data. The device () also incorporates an accelerometer () or other motion sensor. When GPS signals are interrupted, an estimation module () and associated logic generates a speed estimate based solely on stride frequency data from the accelerometer (). Unlike conventional estimators, the estimation module () operates on a non-deterministic basis, generating an estimated speed using a joint probability distribution derived from previous speed and stride data captured while positioning signals are available. The estimation module () can continue to operate when GPS signals are available, and either filter the GPS speed measures for spurious signals, or further train the estimation module () with new position data. The estimation module () can also incorporate altitude measurements when estimating speed.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09158740&OS=09158740&RS=09158740
owner: GOOGLE TECHNOLOGY HOLDINGS LLC
number: 09158740
owner_city: Mountain View
owner_country: US
publication_date: 20121108
---
The present teachings relate to systems and methods for speed estimation based on stride data using predictive modeling and more particularly to platforms and techniques for estimating a speed value for a user of a device in motion using nondeterministic speed modeling based on detected stride frequency.

In competitive running and other personal recreational applications portable electronic devices may track the location and speed of a user wearing or carrying the device. In conventional devices of this type the user s speed while running or performing other activities can often be tracked using positioning platforms including global positioning satellite GPS tracking systems by dividing elapsed distance by elapsed time. Sometimes however signals from GPS satellites can be obscured by trees buildings weather and other obstructions. When GPS signals are corrupted or unavailable the user will often find it convenient to continue to receive an indication of speed using alternative techniques.

An alternative technique that provides a speed value for a runner or other user detects the stride frequency of that user s walking or running pace. It has been known to use an accelerometer built into a portable electronic device to detect the comparatively sharp acceleration at the start of the user s forward stride. By tracking successive strides the user s stride frequency can be determined.

In known platforms the stride frequency can be used as an input to a linear polynomial or other deterministic model to generate an estimated current speed of the user s walking or running activity. In known estimators of this kind the device assumes that the user s speed is related to the frequency of their detected strides in a deterministic or closed form fashion. Sometimes there are different deterministic models for a walking user and a running user. The deterministic models can be based on human biomechanical models or other calculations which assume a direct correspondence between the stride frequency observed for the user and the user s immediate speed at that stride frequency.

However empirical use of known speed estimator devices has shown that the estimated speed output obtained from these types of deterministic algorithms does not always match up well with actual speed. A user s estimated speed using deterministic models can differ by forty percent or more when compared to the speed as measured by accurate GPS reception.

There is an opportunity to develop methods and systems for speed estimation in which an estimation of a user s speed while running or performing other activities can be generated with comparatively high accuracy even when GPS or other location services are not available.

Implementations of the present teachings relate to systems and methods for speed estimation based on stride data using predictive modeling. More particularly implementations relate to platforms and techniques for estimating the speed of a device worn or carried by a user. The device can be equipped with sensing devices including a location module such as a GPS receiver chip for receiving position data from GPS satellites as well as an accelerometer module to detect motion data in the device locally. When the GPS signals are obscured and or at other times the device can be configured to receive a set of stride data from the accelerometer and use that data to derive an estimate of the user s speed based on a user record which associates previously captured stride data and previously captured speed data e.g. calculated by dividing elapsed distance by elapsed time .

Logic within the device can then produce an estimate of the user s current speed based on a non deterministic engine or model which predicts speed based on the current stride measurement including stride frequency and the set of previously captured speed data. In implementations the predictive model or engine can be or include a Bayesian model or engine although it will be appreciated that other types of models or engines can be used. The predictive model or engine can be based on a joint probability distribution between previously detected speed data and previously detected stride data rather than a closed form calculation.

The accuracy of the estimated speed can be enhanced by the fact that the predictive model is based on the record for that user individually so that the model captures over time the characteristics of that user s speed behavior as it relates to stride data of that user. The user can thus receive a set of calculated and or estimated speed data on the device which remains accurate under different operating conditions including those when regular GPS or other positioning services are not available.

Reference will now be made in detail to exemplary implementations of the present teachings which are illustrated in the accompanying drawings. Where possible the same reference numbers will be used throughout the drawings to refer to the same or like parts.

The device can include a network enabled communication component such as for example a cellular 3GPP 3GPP2 LTE transceiver a WiFi IEEE 802.11 transceiver a WiMAX IEEE 802.16 transceiver a Bluetooth IEEE 802.15 transceiver an infrared transceiver and or other standardized or proprietary communication transceivers and communication buses such as Ethernet and USB . With such a transceiver the electronic device can support voice and or data communications and thus may include a dialing e.g. telephony application a messaging e.g. email text messaging instant messaging application a digital media e.g. MP3 MP4 player application and or a data synchronization application.

The device can have a small form factor such as a watch style device an arm band device a belt style device or a head set device. As shown the electronic device can host or incorporate a number of hardware software and or other resources including a display and an operating system .

The display can be or include a light emitting diode LED display liquid crystal display LCD and or displays having other types of panels or illumination elements. In some implementations the display can incorporate hardware based input components such as for example a capacitive or resistive touch sensitive panel allowing the user to enter data based on touch points or other actions on the screen. As noted the device can be configured in a comparatively small form factor but the touch screen or display screen may be larger for low vision applications or other use cases. It may be noted that the device can incorporate other input and output components such as for example audio output via a speaker audio input via a microphone and or user input via mechanical buttons or switches.

As shown the electronic device can host or incorporate further hardware software and or other services or resources to provide an overall framework for operating the device and conducting input communications and or other activity. The resources of the electronic device can include for example an operating system installed on the electronic device and controlling the data storage processing communications and or other resources of the electronic device and or accessed via the electronic device . The device can incorporate radio frequency RF circuitry along with one or more antennas to conduct wireless signaling with local area networks wide area networks positioning systems and or other networks nodes or stations.

The device can also incorporate resources related to the capture and tracking of speed related data including as illustrated a position module an accelerometer module and an estimation module . In implementations the position module can be or include a GPS receiver chip platform service and or module capable of receiving signals from four or more GPS satellites and translating those signals into comparatively accurate position e.g. latitude longitude and optionally altitude location Doppler speed elevation time and or other data. From the GPS location and time information the position module can calculate speed by dividing change in location by change in time.

Alternately in implementations the speed of the device can be calculated or derived using Doppler speed data determined from a set of GPS carrier signals rather than from position data. In implementations the position module can be or include other types or classes of location hardware software and or services such as location modules based on the known geographic location of cellular towers or their cells location modules which operate based on radio triangulation techniques or others. In implementations for example the position module can also or instead be based on the Galileo satellite tracking system and or others.

The accelerometer module can be or include a hardware software and or other device built into or associated with the device and configured to detect forces acting on the device particularly changes in acceleration of the device and or other motion phenomena associated with the device . The accelerometer module can be based on piezo electric capacitive strain gauge and or other detection or sensor technology. The device can optionally in implementations incorporate an altimeter module such as a barometric altimeter to sense current altitude values of the device .

In addition the device can be configured with an estimation module to estimate a speed of the device in the absence of current location information. Data from the position module the accelerometer module and the optional altimeter module when present can as shown be used as input to the estimation module for operations described herein.

The display may show the estimated speed value as determined from the estimation module the calculated speed value as determined from the position module or a blend of the two speed values. In implementations the speed value calculated or estimated can be displayed in miles per hour as shown but can also be configured to be displayed in feet per second kilometers per hour and or other units or measures. Pace values namely minutes per mile or other time over distance values can also be displayed. In implementations the display can show a speed value calculated or estimated continuously at regular intervals upon receiving an input or selection from the user and or at other times or under other conditions.

The estimation module and or other hardware module application and or service can incorporate processor memory logic software and or other resources to estimate speed values and conduct other operations as described herein.

In one illustrative operating mode and as for example illustrated in the device can be worn attached to and or carried by a user located in a relatively clear or unobstructed environment such as an outdoor trail track and or other set of surroundings that permit the receipt of signals from at least four position satellites such as a set of GPS satellites or others. The user can use or operate the device in connection with a variety of activities including for example long distance running events hiking on public trails and other athletic personal recreation and or other activities. During those or other activities the device can generate and capture various data to calculate or estimate a current speed of the user and or device. That data can include as shown a set of current stride measurements which can be captured using the accelerometer module . The current stride measurements can include a set of stride frequency data indicating how many strides per second the user of the device is taking. In implementations the current stride measurements can also or instead include information such as a total number of strides date and or time of stride events and or other data.

In conditions or environments as shown in the device can also capture generate and or receive a set of position data . The set of position data can be received or derived from GPS or other signals received or processed by the position module . The position module can use the set of position data to calculate the current speed value of the device by comparing the date and or time stamp values for successive positions x x x . . . of the device to the distance between those positions and generate a speed value. In implementations the current speed value as measured by the position module can also or instead be averaged over a predetermined number of position measurements and or can be computed using other techniques using the set of position data . It may be noted that the calculated current speed data derived from the data produced by position module can be sent to the estimation module to be stored alongside with corresponding current stride data from the accelerometer module for the same time intervals.

According to implementations it may be noted that while in an unobstructed environment such as illustrated in the device can be configured to display the calculated speed as generated by the position module . Speed values that are derived from the set of position data and or the set of position satellites by position module and or other modules logic and or software may be referred to at times herein as calculated speed values or outputs.

In other surroundings and as for example shown in the device can be located in a blocked environment such as the interior of a building inside a gym under extensive foliage in densely constructed areas of a city e.g. urban canyons and or other locations. In those types of blocked environment or others the device may be unable to receive or unable to receive with adequate or consistent signal strength signals transmitted by the set of position satellites . In those types of operating conditions the position module may not be able to derive the set of position data and associated information such as the current calculated speed of the device . In those kinds of situations or others the device can be configured to switch the way in which the device determines current speed to rely upon current stride measurements rather than an unavailable set of position data . Speed values that are derived from current stride measurements may be referred to at times herein as estimated or predicted speed values or outputs.

In those blocked environment operating conditions or others and as shown for example in the device can operate on current stride measurements and other information to generate an estimated current speed. In those cases and others the estimation module and or other hardware module application and or service can access an individual s user record . In implementations the user record can store a set of previously captured or stored data related to the user s personal activity history and movement. In implementations the user record can include a set of stored or previous stride frequency data from the accelerometer module and a related set of previously calculated speed data captured at the same time or time interval from the position module for the user of the device. The prediction engine uses probabilistic approaches and this individual s stochastically related speed and stride history to generate an estimated or predicted current speed based on current stride information .

In implementations as shown the estimation module and or other hardware module application and or service can incorporate a prediction engine to access the user record and or other data and perform speed estimation and other operations. In implementations the prediction engine can be or include a Bayesian engine or model in which the set of previous stride frequency data and the set of previously calculated speed data can be used to construct a joint probability distribution of those quantities. The joint probability distribution can relate the stride frequency data recorded during previous activities by the user to calculated speed data with which the user was traveling at those stride frequencies. As the accelerometer module and or other sensor detector application and or logic detects new or current stride measurements the stride measurements can be provided as input to the prediction engine of the estimation module .

Using Bayesian or other prediction models or techniques the prediction engine and or other model engine logic application and or service can then use the current stride measurements to generate an estimate of the user s current speed based on or derived from the previously calculated speeds which were recorded when prior stride frequency data was equivalent to the current stride frequency measurement. According to implementations the use of a Bayesian model or engine in the prediction engine will provide a minimum mean squared error estimate of the current speed for a given stride frequency measurement. It will however be appreciated that other modeling techniques engines algorithms and or calculations can be used.

According to aspects of the present teachings the use of a prediction engine rather than a strictly deterministic model or relationship between stride frequency and speed allows flexibility to account for the non linear non polynomial or otherwise less than totally predictable correspondence between those variables. Those non deterministic results can arise for example due to the fact that a user may at times reduce his stride frequency yet increase his speed by taking longer strides. The same user may increase both stride frequency and stride length during periods of peak exertion leading to a greater than expected increase in speed. It will be further appreciated that systems and methods according to the present teachings likewise enjoy an advantage in terms of building a model based on the user record that is uniquely tailored to the user s overall activity patterns. This avoids employing deterministic models or relations which assume that a certain walking stride frequency results in a particular speed or that a particular running stride frequency results in a certain speed. This approach is useful because among other things experimental data such as that shown in demonstrates that such assumptions are not always valid even for the same user.

By applying a prediction engine that is stochastic or non deterministic in nature but trained to an individual user the accuracy of the estimated speeds for that user over a variety of conditions can be increased. Moreover the prediction engine can evolve or refine the learned model of the user s speed and stride behavior over time changing as the user s speed patterns change due to age physical condition types of activities and or other factors.

Thus and merely for example consider a scenario in which the accelerometer module and or other sensor detector application and or logic detects a current stride frequency of 1.50 Hz strides per second given the user record in . In practice user record may have thousands of measurements or more with a plurality of calculated speed measurements for each stride frequency value. In this example however user record only contains four calculated speed measurements recorded at a stride frequency of 1.50 Hz. Three of these speeds are different highlighting the nondeterministic nature of this problem. Possible reasons different calculated speeds may be recorded for a particular stride frequency include error in the accelerometer module error in the position module or error in both. Another possible reason for different calculated speeds is that the user may have changed stride length while maintaining a constant stride frequency. For these reasons and possibly others the stride frequency and calculated speed can be treated as random variables F and V respectively.

The prediction engine can ameliorate the inaccuracies in the measurements of F and V through a probabilistic approach by generating an estimated speed equal to the expected value of speed for the measured stride frequency of 1.50 Hz i.e. E V F 1.501 given a joint probability distribution generated by the data in user record . Computing the expected value of speed for a given stride frequency narrows the range of possible values from the entire joint probability distribution to a smaller range of values given by the conditional probability distribution of speed for the current stride frequency measurement. Mathematically the estimated speed circumflex over v is given by

In implementations if the user continues to be located in the blocked environment the current stride measurements can continue to be used to update the estimated current speed value. The display can show the estimated speed determined using the current stride measurements and the probabilistic output generated by the prediction engine .

In implementations the device can continue to operate in an estimation mode based on current stride measurements until the device clears the blocked environment and resumes the reception of location signals from the set of position satellites . Upon receiving those location signals the device can in implementations revert to receiving and processing GPS and or other location signals from the set of position satellites and switch to displaying those currently measured speed values as determined by the position module instead of estimated speed values based on the output of the prediction engine . In further implementations the device can continue to display calculated speed values while simultaneously training the prediction engine by continuing to record current stride frequency and current calculated speed data in the user record for use in speed estimation at a future time.

In further implementations the device can be configured to remain in an estimation mode and continue to generate an estimated current speed based on the current stride measurements even when the device emerges from a blocked environment and begins receiving signals from the set of position satellites again. In operating modes of these types the device can receive the set of position data at the position module generate a current calculated speed based on that position data and use that data and calculated speed to continue to train the prediction engine at the same time that the prediction engine is operating to generate an estimated speed. In operating modes of these types the prediction engine and device can continue to learn and refine the Bayesian and or other prediction model taking advantage of the availability of the set of position data when the device can receive signals from the set of position satellites .

In still further implementations if a sufficiently large user record has been generated based on memory usage number of samples or some other measure additional training of the prediction engine may not be necessary and thus the user record may no longer need to be updated. In operating modes of this type speed estimation can continue to be performed using the current user record without continuing to update user record with the latest stride frequency and calculated speed measurements.

In still further implementations the device can be configured to operate in a measurement mode using the set of position data when that data is available and to present the current calculated speed on the display using speed values determined from the set of position satellites when those signals are being received. In such implementations the device can be configured to perform certain further processing related to speed calculations and in particular to filter or condition the position data produced by using the set of position satellites . In such modes or configurations the estimation module can receive the set of position data and calculate a current speed value using that data. In aspects it may be noted the set of position data received and or developed from the set of position satellites can be received and processed in real time or near real time resulting in a current calculated speed value that can be displayed to the user on an immediate or near immediate basis.

In modes as noted before presenting a current calculated speed value to the user the estimation module and or other hardware module application and or service can be configured to perform a data consistency check or operation on the current calculated speed value generated by the set of position data . The speed estimator module and or other hardware module application and or service can perform that check by continuing to generate an estimated speed value using the prediction engine using the current stride measurements and at the same time in parallel or conjunction with the calculated speed value derived from the measured set of position data generated by the set of position satellites .

In operation signals received from the set of position satellites can for example be corrupted due to radio frequency interference of various kinds leading to a brief set of spurious or anomalous values in the set of position data . The estimation module and or other hardware module application and or service in these filtering modes can be configured to perform a comparison of the latest or current calculated speed value derived from the set of position data to the latest or current estimated speed value and determine whether the current calculated speed value calculated from the set of position data deviates by more than a predetermined threshold from the estimated value.

If that calculated speed value exceeds the predetermined threshold the current value displayed to the user can be temporarily switched to the speed value estimated from the current stride measurements . Temporary outliers and or false readings in the calculated speed data can thereby be filtered out and or avoided. In implementations where the device is also simultaneously training the prediction engine using the current set of position data the position speed and or other values which deviate by more than the predetermined threshold can likewise be deleted from the data stream used as training sets for the Bayesian and or other engine.

In certain implementations the device can also be configured to track and take into account an additional dimension of data when generating the estimated speed of the device . In particular and as shown in the device can be configured to track the change in altitude i.e. slope of the device when performing speed determinations in addition to capturing or processing location stride frequency and other variables described previously. As shown in the device in such implementations can be configured to capture store and track a set of altitude data indicating the altitude of the device above a reference point such as sea level. In these implementations the set of altitude data can also be contained in and or derived from signals received from the set of position satellites although it will be appreciated that in other implementations other sources of altitude or elevation data can be used such as the use of a separate altimeter module in the device itself. When incorporated in the device the altimeter module can be or include a barometric type altimeter device. In implementations slope values can be calculated from GPS data directly and the estimation module can use non GPS altitude data from the altimeter module and non GPS stride frequency data from the accelerometer module along with prior distribution data stride frequency calculated slope calculated speed stored in the user record for the current user to estimate speed when GPS signals are not available.

In scenarios as shown the device can also capture a set of current stride measurements including stride information described above. In aspects a runner or other user traveling up or down the incline of a mountain hill and or other irregular terrain may alter or adjust their speed and or stride based on the severity of the incline the altitude of the terrain and or other factors.

In those kinds of environments or others a stride frequency model that has been built up for that user in flat terrain may not lead to speed estimation values that remain accurate or fully accurate due to expected compensations in the user s stride patterns or other physical behavior. As a result in implementations that are configured to track elevation data and as shown in the estimation module and or other hardware module application and or service can be configured to track not just historical stride frequency data and historical speed data but also historical slope data where slope data is calculated by dividing change in vertical distance altitude by change in horizontal distance. In implementations as noted the historical slope data along with any currently received set of altitude data can be received or generated by the position module operating on signals received from the set of position satellites . In implementations as shown the user record can record that additional dimension of slope data. Thus a predictive model may use the prior distribution data for stride frequency calculated slope and calculated speed.

When positioning information is not available the current stride frequency measurement e.g. as determined using accelerometer module and the current altitude measurements e.g. as determined using altimeter module may be used in conjunction with the predictive model to estimate speed. Initially the current stride frequency can be used by the prediction engine as previously described with reference to to obtain a preliminary estimated speed. This preliminary estimated speed can be converted to an estimated elapsed distance based on the time stamps of the current altitude measurements . Given a change in altitude from the current altitude measurements and the estimated elapsed distance the prediction engine can calculate a current estimated slope value. With the current stride measurements and the current slope value the prediction engine can use the augmented user record to generate an estimated speed based on both the current stride measurements and the current altitude measurements as follows circumflex over v E V F f where circumflex over v is the estimated speed F and V are the random variables of stride frequency slope and speed respectively and f and are the measured stride frequency and the current estimated slope value respectively.

In implementations the slope value can also or instead be estimated from the current altitude measurements in a recursive fashion using the last slope and speed estimates produced by the prediction engine . In that case the prediction engine can estimate a horizontal displacement in the current sampling period by multiplying the horizontal speed by the duration of the current sampling period. The prediction engine can then combine the estimated horizontal distance with the change in altitude during the current sampling period to produce an estimate of the current slope. In recursive implementations of this type during initial conditions when no previous speed or slope values have been stored the current stride frequency and an estimated slope of zero can be passed to the prediction engine to begin computation. As noted implementations incorporating slope values can be advantageous in hilly or mountainous terrain and in other environments.

In step a determination can be made whether the device is receiving a position signal from the set of position satellites via the position module . If the determination of is yes processing can proceed to step otherwise processing can proceed to step . In step the current calculated speed for the device can be measured from the position module . In step a determination may be made whether to train the speed prediction engine . If the determination in step is yes processing can proceed to step otherwise processing can proceed to step . In step the current stride measurements and the calculated speed are added to the user record . In optional step in implementations in which current altitude measurements are used the calculated slope can likewise be stored in the user record .

In step a determination can be made whether to estimate the current speed or to use the currently calculated speed. If the determination in step is yes processing can proceed to step otherwise processing can proceed to step . In step a speed estimate is generated in the estimation module using the current stride measurements which can be or include currently measured stride frequency values as detected by the accelerometer module . In optional step in implementations using slope data and or altitude data as described above in connection with the estimation module can generate or adjust a speed estimate using the current altitude measurements related slope values or associated information. In step the calculated speed can be filtered using the estimated speed as an optional step. In step the speed either the calculated speed or the estimated speed is displayed on display of device . The speed estimation process ends in step . It may be noted that in implementations the process illustrated in can be executed for more than one user and or at more than one time for example at different times while the device is being operated by different users and results can be stored to one or more user record .

It will be appreciated that while various processing activity logical decisions and or other operations illustrated in have been described as taking place in steps that two or more of various of those operations or activities can be combined into one operation or activity and that any one or more of those operations or activities can be divided into two or more operations or activities. Moreover while those various operations or activities have been illustrated and described as occurring in a certain order it will be appreciated that in implementations those same and or other operations or activities can take place in a different order or orders. Further while various operations or activities have been described as being carried out by certain hardware software service and or other resources it will be appreciated that in implementations the same activities and or operations can be carried out by other hardware software service and or other resources.

In implementations it may be noted that the device can comprise a number of hardware software firmware communications and or other resources including a processor communicating with memory such as electronic random access memory operating under control of or in conjunction with an operating system such as a mobile device operating system which can host an application programming interface API and or other components or resources. The processor can be incorporated in one or more microprocessors microcontrollers chips servers clusters and or other computers or hardware resources and or can be implemented using cloud based resources. The RF circuitry contained in the device can be or include a transceiver a modulator demodulator and other circuits. The device can host further software including one or more applications such as communications messaging texting telephony browser and or other applications or services. The device can further host a data store such as a database stored on a local solid state or other memory to access or store position data speed data altitude data Doppler data stride data and or subsets of selections thereof along with other content media or other data. Other configurations of the device associated radio frequency hardware or software network connections and other hardware software and service resources are possible.

As used herein each of a model a module and an engine can be or include hardware software firmware logic a self learning network and or service resources in any combination. Each of those entities can operate under software or other programmed control.

The foregoing description is illustrative and variations in configuration and implementation may occur to persons skilled in the art. For example while implementations have been described in which the device employs a single estimation module and single prediction engine in implementations more than one module can perform the same operations of those engines models and or modules. Similarly while implementations have been described in which the estimation module and or other hardware module application and or service accesses the user record of one user in implementations the device can host the user records of multiple users. Other resources described as singular or integrated can in implementations be plural or distributed and resources described as multiple or distributed can in implementations be combined. The scope of the present teachings is accordingly intended to be limited only by the following claims.

