---

title: Methods for identifying bacteria
abstract: The present invention provides methods for identifying bacteria by analysis of lipid A and/or lipoteichoic acid structure and/or mass spectrometry ionization patterns.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09273339&OS=09273339&RS=09273339
owner: UNIVERSITY OF WASHINGTON
number: 09273339
owner_city: Seattle
owner_country: US
publication_date: 20120103
---
This application claims priority to U.S. Provisional Patent Application Ser. Nos. 61 429 396 filed Jan. 3 2011 and 61 530 483 filed Sep. 2 2011 which are incorporated by reference herein in their entirety.

This invention was made with government support under 5 U54 AI057141 03 awarded by National Institutes of Health NIH Federal Reporting. The government has certain rights in the invention.

Rapid and accurate pathogen identification is needed to allow physicians to react and respond appropriately to infections including those that are potentially life threatening. Currently pathogen identification requires culture on solid medium agar based plate followed by diagnostic analysis that normally requires additional rounds of replication in culture or purification of a specific bacterial product. At best microbe identification requires multiple days during which additional levels of biosafety containment may be required depending on the overall classification of the pathogen. Thus improved methods for bacterial identification are needed.

 a obtaining precursor ion mass spectrometry PIMS spectra on precursor ions for lipid A LA or precursors molecules thereof and or lipoteichoic acid LTA or precursor molecules thereof from a sample containing bacteria of interest 

 b comparing the PIMS spectra to a database of bacterial LA and or LTA precursor ion mass spectrometry spectra 

As disclosed herein the inventors have surprisingly discovered that the methods of the invention can be used for example to distinguish bacteria and to distinguish antibiotic vs. non antibiotic resistant bacteria and to identify bacterial environmental variants. As such the present invention will find wide use in a variety of diagnostic and research applications.

In one embodiment the methods comprise comparing precursor ion m z values and relative abundance of the precursor ions to the database of bacterial LA and or LTA precursor ion mass spectrometry spectra data. In another embodiment the methods further comprise fragmenting all or a subset of the precursor ions to produce an MSset of ions and obtaining MS spectra on all or a subset of the MSset of ions MSMS spectra and wherein the comparing further comprises comparing the MSMS spectra to bacterial LA and LTA MSspectra in the database to assist in identifying bacteria in the sample. In a further embodiment the methods further comprise fragmenting all or a subset of the precursor ions to produce a set of derived fragment ions and obtaining MS spectra on all or a subset of the derived fragment ions MS spectra and wherein the comparing further comprises sequentially comparing the MSspectra to bacterial LA and LTA MSspectra in the database to assist in identifying bacteria in the sample. In another embodiment the methods further comprise searching the precursor ion and or MSspectra against a database of bacterial LA and LTA signature ions to identify signature ions in the precursor ion and or MSspectra. The methods may further comprise

 i searching neutral losses of signature ions in the MSspectra against a theoretical neutral loss database to identify dissociation formulae 

 ii proposing LA and or LTA candidate structures from bacteria in the sample based on the dissociation formulae and the signature ions in the MSspectra 

 iii assigning a score to each LA and or LTA candidate structure based on correlation between theoretical and acquired MSspectra wherein candidate structures that meet or exceed a user defined threshold are considered as accurate assignments.

 A determining a neutral loss of every MSspectrum s precursor ion in the corresponding MSspectrum and searching against the theoretical neutral loss database and

wherein step ii comprises proposing the LA and or the LTA structures from the bacteria in the sample based on the integrating data from each MSlevel.

 A fragmenting the LA and or the LTA candidate structures by direct bond cleavage to produce fragmentations 

 B combining the fragmentations into a reconstructed mass spectra representing the theoretical dissociation of the LA and or the LTA candidate structures and

 C assigning the score to each of the LA and or the LTA candidate structure based on correlation between theoretical MSspectra and the reconstructed mass spectra.

In a second aspect the present invention provides methods for identifying antibiotic resistant Gram negative bacteria comprising obtaining lipid A from a Gram negative bacterial sample and determining whether the lipid A comprises a phosphoethanolamine PEtN modification wherein presence of PEtN modified lipid A indicates that the Gram negative bacteria is antibiotic resistant. In one embodiment the antibiotic resistance comprises resistance to colistin. In a further embodiment the Gram negative bacterial sample is selected from the group consisting of an sample and a sample. In a further embodiment the Gram negative bacterial sample comprises an sample. In a still further embodiment the Gram negative bacterial sample comprises a sample.

In a third aspect the present invention provides methods for constructing libraries of LA and or LTA precursor ion and MSand or MSdata comprising

 a obtaining PIMS spectra on precursor ions for lipid A LA or precursors molecules thereof and or lipoteichoic acid LTA or precursor molecules thereof obtained from a plurality of different bacteria 

 b determining precursor ion m z values and relative ratios of precursor ion signals relative to each other 

 c determining consensus values for the precursor ion m z values and the relative ratios of the precursor ion signals relative to each other for a given bacteria and

All references cited are herein incorporated by reference in their entirety. As used herein the singular forms a an and the include plural referents unless the context clearly dictates otherwise. And as used herein is interchangeably used with or unless expressly stated otherwise. All embodiments of any aspect of the invention can be used in combination unless the context clearly dictates otherwise.

 a obtaining precursor ion mass spectrometry PIMS spectra on precursor ions for lipid A LA or precursors molecules thereof and or lipoteichoic acid LTA or precursor molecules thereof from a sample containing bacteria of interest 

 b comparing the PIMS spectra to a database of bacterial LA and LTA precursor ion mass spectrometry spectra wherein the comparing is used to identify bacteria in the sample.

As disclosed herein the inventors have surprisingly discovered that the methods of the invention can be used for example to distinguish bacteria and to distinguish antibiotic vs. non antibiotic resistant bacteria and to identify bacterial environmental variants. As such the present invention will find wide use in a variety of diagnostic and research applications.

Lipid A the endotoxic portion of lipopolysaccharide LPS is embedded in the outer leaflet of the Gram negative bacterial outer membrane. As an essential component of Gram negative bacterial membranes lipid A exhibits species specific structural diversity. The general structure consists of a backbone of two glucosamine residues present as a 1 6 linked dimer. This backbone can be diversified in response to specific environmental signals or between bacterial species. Specifically changes in the fatty acid content varying both in the length and number of fatty acid side chains e.g. tetra to hepta acylated and phosphorylation patterns can differ as well. Additional modifications of the phosphate residues by monosaccharides such as aminoarabinose or galactosamine and phosphoethanolamine can occur. The diversity of such species and environmentally driven structural modifications are an adaptive mechanism that increases bacterial survival often through increasing resistance to host antimicrobial peptides or in the avoidance of the host innate immune system. Precursor molecules ie molecules from which LA is cleaved during isolation to LA include but are not limited to LPS.

Lipoteichoic acid LTA is a major cell wall component of Gram positive bacteria. The Gram positive cell wall is composed of cross linked peptidoglycan PG variably decorated with teichoic acid polymers. Teichoic acid polymers are also linked to plasma membrane phospholipids. The general structure of LTA varies between species consisting of 2 or 4 acyl groups of variable chain length. LTA from low G C subdivisions of Gram positive bacteria contains two fatty acid tails while those from high G C bacteria contain 4 fatty acid tails. Additionally LTA can be variably modified with alanine in response to low pH or glycosyl linkages depending on bacterial background. Glycosyl linkages can include glycerolphosphate galactose or N acetyl glycerol.

The sample may be any suitable sample of interest that is believed to contain bacteria to be identified. The bacteria may be dead or alive as LA and LTA are quite stable. Non limiting examples of test samples include but are not limited to water samples including but not limited to water samples from ponds streams lakes oceans seas wastewater reservoirs drinking water water distribution pipeline etc. body fluid samples including but not limited to wound secretions scrapings blood urine sweat saliva vaginal secretions sputum beverage samples liquid medicine samples food samples environmental samples for example from medical centers such as linens medical devices etc. pharmaceutical facilities for example from manufacturing or processing lines food production facilities livestock facilities solid waste samples diagnostic samples air air filters air duct and breath samples.

The sample can be used as obtained or can be processed in any way suitable for use with the methods of the invention. In one embodiment the methods comprise identifying bacteria directly from a complex sample ie no requirement for amplifying bacteria present in the sample . In another embodiment bacteria are isolated from the sample such as by streaking onto solid bacterial culture medium followed by growth for an appropriate period of time and use of individual colonies for isolation of LA or LTA or for initiating a larger scale culture for example an overnight liquid culture which is then subjected to LA or LTA isolation. It is within the level of skill in the art based on the teachings herein to determine an appropriate strategy for processing the sample for a specific use.

In one embodiment bacterial cells are placed in the mass spectrometer for analysis with no purification of LA or LTA. In a preferred embodiment the LA and or LTA and precursors thereof can be isolated from bacteria in the sample using any suitable method that serves to maintain LA and or LTA structure. As used herein isolation means that LA and or LTA are separated from their normal cellular environment. The methods do not require the use of purified LA or LTA. In preferred embodiments the LA and or LTA for use in the methods of the invention makes up at least 10 of the sample subjected to MS analysis preferably at least 20 30 40 50 60 70 80 90 95 98 99 or 100 of the sample subjected to MS analysis. Such isolation techniques are known to those of skill in the art including but not limited to the use of various organic solvents ex phenol chloroform methanol ethanol etc. ammonium hydroxide isobutyric acid based protocols and microwave assisted enzymatic digestion and detergent free mild hydrolysis as described below. For example after extraction LTA lipid A can be isolated from the phenol based preparations using gentle hydrolysis which preserves structural elements e.g. phosphate groups and attached carbohydrate moieties that are sensitive to harsh acid treatment or directly for the ammonium hydroxide isobutyric acid based as it cleaves the glycosidic linkage between LTA lipid A and the rest of the glycolipid molecule.

In a further example a sample preparation method based on microwave assisted enzymatic digestion and detergent free mild hydrolysis to isolate LA and or LTA and precursors thereof is applicable to profiling the lipid A structures from as little as 1 g of dried bacterial cells approximately the amount in a small bacterial colony obtained from solid growth medium . This technique has been successfully used with a variety of Gram positive and Gram negative bacterial species as shown below.

It will be understood by those of skill in the art that methods for isolating LA LTA and precursors thereof may differ for bacteria in different samples some bacteria may require additional growth time for the growth of colonies and the membrane characteristics of a given bacteria will affect extraction. Based on the teachings herein it is within the level of skill in the art to determine the appropriate use of solvents detergents buffers microwave power settings time under irradiation etc. to carry out the various types of LA LTA or precursor extraction.

The methods of the invention comprise obtaining precursor ion mass spectrometry PIMS spectra. As is known in the art mass spectrometry MS is an analytical technique that measures the mass to charge ratio of charged particles and can be used for determining the elemental composition of a sample or molecule and elucidating the chemical structures of molecules. MS comprises ionizing chemical compounds to generate charged molecules or molecule fragments and measuring their mass to charge ratios. In a typical MS procedure a a sample is loaded onto the MS instrument and undergoes vaporization b the components of the sample are ionized by one of a variety of methods resulting in the formation of ions c the ions are separated according to their mass to charge ratio in an analyzer by electrical and magnetic fields d the ions are detected often by a quantitative method and e the ion signal is processed into mass spectra. Suitable instruments for carrying out MS thus typically comprise a an ion source which can convert gas phase sample molecules into ions or in the case of electrospray ionization move ions that exist in solution into the gas phase a mass analyzer which sorts the ions by their masses by applying electromagnetic fields and c a detector which measures the value of an indicator quantity and thus provides data for calculating the abundances of each ion present.

Any suitable MS instrument can be used in the methods of the invention. Selecting an appropriate MS instrument and protocol can be accomplished by one of skill in the art based on the teachings herein. Non limiting MS techniques that can be used to carry out the methods of any embodiment or combination of embodiments of the present invention include but are not limited to matrix assisted laser desorption ionization time of flight MS MALDI TOF MS platforms tandem MS MALDI TOF TOF MS infusion based electrospray ionization ESI coupled to ion trap tandem mass spectrometry ITMS and any of the many so called ambient ionization methods such as surface acoustic wave nebulization SAWN technology including SAWN on any mass analyzer e.g. quadrupole TOF MS QTOF or SAWN ion trap IT MS . Other examples of ambient ionization methods include DESI and DART but there are numerous such methods available as will be understood by those of skill in the art.

Surface acoustic waves SAWs are Rayleigh waves and are generated by the application of a voltage across a piezoelectric material causing a mechanical displacement of the uppermost layer of the chip which propagates as a ripple across the surface of the wafer. At the appropriate frequency surface acoustic waves can be used to atomize droplets pipetted onto the surface of a lithium niobate wafer. We have previously shown that the SAW nebulized SAWN aerosol contains charged molecules that could be sampled by MS to record usable MSand MSspectra WO2011 060369 . In fact SAWN generates multiply charged ions similar to those of ESI that can be easily subjected to MS. The advantage of glycolipid analysis by SAWN over MALDI and ESI are three fold 1 ionization occurs from a planar device like MALDI that circumvents clogging of capillaries and thus facilitating higher throughput and ease of use by non experts 2 it is less energetic than ESI and MALDI making it more likely that the native chemical signature we seek to measure will be intact on transfer to the MS and 3 no chemical matrix is required as is the case with MALDI such that mass spectra free of matrix based chemical noise are produced down to the low m z region where glycolipids of interest to this proposal are detected. A planar SAWN device provides the ease of use of MALDI i.e. a planar surface where samples are simply pipetted but without need for a matrix that can obscure ions of interest and combines this with the performance of ESI i.e. multiply charged precursor ions that can be used in for example hierarchical tandem mass spectrometry MS as described below.

As used herein Precursor ions are ions of a starting molecule LA LTA and or precursors thereof generated during MS. Such precursor ions may also be referred to as MSions. As will be understood by those of skill in the art MS may result in a large number of precursor ions from a given starting molecule. Obtaining the PIMS spectra does not require obtaining PIMS spectra of all MSions. Thus in various embodiments obtaining the PIMS spectra comprises obtaining PIMS spectra on 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 or more MSions. In one non limiting example the method comprises obtaining the PIMS spectra for the 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 or more MSions such as the most predominant ions. In another embodiment the method comprises obtaining the PIMS spectra on all MSions.

The PIMS spectra provides information on a the m z values of the precursor ions generated which represents or reads a barcode for the LA and or LTA of bacteria in the sample and b the relative abundance of the precursor ions generated. The method further comprises comparing the PIMS spectra to a database of bacterial LA and LTA precursor ion mass spectrometry spectra to permit identification of bacteria present in the sample based on the comparison. For example bacterial identifications may occur by reading out simple phenotypes of two measured components for each sample 1 precursor ion m z values mass to charge ratio which can be used for determining the elemental composition of a sample or molecule and elucidating the chemical structures of molecules 2 the normalized relative abundance of these precursor ions which may represent more subtle differences in the bacterial signature such as environmental factors and 3 by conducting hierarchical tandem mass spectra on all or a select set of PIMS ions to reveal differences and complexity under MSions composed of multiple entities all with different chemical configurations but the same MSvalue commonly referred to as isobars.

In one embodiment using purified LA and or LTA obtaining PIMS spectra on precursor ions comprises selecting peaks between about 1000 m z and about 2200 m z in other embodiments between about 1100 m z and about 2100 m z or between about 1200 m z and about 2000 m z. These embodiments focus the analysis on ions with a mass to charge ratio likely to be of most relevance for the analysis. As will be understood by those of skill in the art the m z ranges can vary above or below these values depending on all relevant factors in a given MS assay such as degree of purification instrument etc. . In embodiments where unpurified LA and or LTA samples are used the m z ranges may be approximately 10 fold higher than those discussed above ie between about 10 000 m z and about 22 000 m z .

The methods may further comprise various techniques for data processing as are within the level of skill in the art based on the teachings herein. For example the methods may comprise weighting and scaling of spectral peaks using any suitable technique. In another non limiting embodiment spectral peaks may be binned as a means to reduce costs and computational requirements.

The methods of the invention further comprise comparing the PIMS spectra to a database of bacterial LA and or LTA precursor ion mass spectrometry spectra wherein the comparing is used to identify bacteria in the sample. The database may be of any suitable type for a given application. In one embodiment the database may comprise or consist of LA or LTA precursor ion MS data previously obtained from a single bacterial species and may include precursor ion MS data a variety of sub species this embodiment can be used for example in methods designed to determine if a specific bacteria of interest is present in the sample. In another embodiment the database may comprise or consist of LA and or PTA precursor ion MS data previously obtained from a plurality of bacteria of interest. In one such embodiment the database contains LA and or LTA precursor ion MS data previously obtained from a plurality of Gram positive bacteria a plurality of Gram negative bacteria or a plurality of Gram positive and Gram negative bacteria. In another such embodiment the database may comprise or consist of precursor ion LA and or LTA MS data previously obtained from a one or more bacteria known to develop antibiotic resistance wherein the previously obtain MS data includes data from antibiotic resistant strains and non antibiotic resistant strains of the bacteria. As will be understood by those of skill in the art there are many such variations of databases that can be used in the methods of the invention. A suitable database for use will depend on the specifics of the methods to be carried out and can be determined by one of skill in the art based on the teachings herein. In another embodiment the database may comprise or consist of any of the database libraries disclosed herein. In another embodiment the database may comprise or consist of LA or LTA precursor ion MS data previously obtained from one or more or all of the following groups of bacteria that cannot be distinguished using current ribosomal profiling techniques 

The methods of the invention may be used to detect single bacterial cells present in a sample. In various embodiments at least 10 10 10 10 or 10 bacterial cells are present in the sample.

The data included in the databases includes at least precursor ion m z values for LA or LTA molecules in the bacteria represented in the database. The data may also include the normalized relative abundance of these precursor ions as well as data regarding the MS technique used to generate the data. In a preferred embodiment the MS technique used to generate the PIMS spectra from the sample is the same as the MS technique used to generate the data in the database. The data may include limited or exhaustive hierarchical tandem mass spectrometry data used to define structures or define subtle differences between species on all or a select set of PIMS ions. The data may further comprise structural information for the LA and or LTA present in bacteria or sub species thereof represented in the database.

The database may comprise a single database or one or more databases that can be separately accessed and may be integrated as discussed in more detail below.

In another embodiment the comparison comprises a classification system to provide a score for identification. For example each database entry can include a probability based score. This score perhaps along with other information can be used to identify an ion spectrum LA or LTA. Any such suitable classification system can be used to provide a score such as a probability based score and it is well within the level of those of skill in the art to determine an appropriate system based on the teachings herein.

Any type of comparison of the PIMS spectra to the database MS data can be used to identify bacteria in the sample. For example any means of comparing the LA and or precursor ion m z values in the sample to the m z values in the database can be used similarly any means of comparing the relative abundance of such precursor ions generated from LA and or LTA in the sample to the data in the database can be used. In one non limiting embodiment the comparison may comprise a dot product comparison of spectra incorporating m z values and optionally their relative intensities. In another embodiment a heat map comparison of spectra incorporating m z values and optionally their relative intensities can be used. An example heat map is depicted in . It is well within the level of those of skill in the art to determine an appropriate comparison technique based on the teachings herein.

The methods of the invention can be used to identify any bacterial species or sub species in a sample. Further the methods can be used to identify multiple bacterial species and or sub species from a given sample. In one embodiment the methods are used to identify Gram positive bacteria i.e. to determine the identity of Gram positive bacteria in the sample or to assess the presence of a specific Gram positive bacteria in the sample . In this embodiment the method comprises obtaining PIMS spectra on precursor ions for LA. In another embodiment the methods are used to identify Gram negative bacteria ie to determine the identity of Gram negative bacteria in the sample or to assess the presence of a specific Gram negative bacteria in the sample . In this embodiment the method comprises obtaining PIMS spectra on precursor ions for LTA. In another embodiment the methods are to identify unknown bacteria i.e. regardless of whether Gram negative or Gram positive in a sample. In this embodiment the method comprises obtaining PIMS spectra on precursor ions for LA and LTA. It will be recognized by those of skill in the art that methods comprising PIMS spectra on precursor ions for LTA may further comprise obtaining PIMS spectra on precursor ions for LA while methods comprising PIMS spectra on precursor ions for LA may further comprise obtaining PIMS spectra on precursor ions for LTA.

In various non limiting embodiments the methods can be used to identify one or more bacteria or sub species thereof including but not limited to subspecies including and extended spectrum lactamase organisms as well as bacterium in the genus and

As shown in the examples that follow see for example analysis of MSspectra was used to demonstrate the ability of LA and LTA MSdata to distinguish not only bacteria but also antibiotic resistance MRSA distinguishable from non MRSA and environmental variants grown high and low Mg distinguishable at high sensitivity accuracy and specificity. The data see for example further show that MS1 data can be used to directly identify bacteria in complex samples.

In another embodiment the method further comprises fragmenting all or a subset of the precursor ions to produce an MSset of ions and obtaining MS spectra on all or a subset of the MSset of ions MSMS spectra and wherein the comparing further comprises comparing the MSMS spectra to bacterial LA and LTA MSspectra in the database to assist in identifying bacteria in the sample. Those of skill in the art will understand the types of mass spectrometry devices that are most suitably used with this embodiment of the invention. Any MS device that can fragment ions can produce MSspectra. For example the simplest form of an MS is an ionization device and a mass analyzer and detector. One can modify the way ions are made going from soft where mostly MS1 ions are recorded to hard where mostly all of the MS1 are fragmented to produce an MSE spectrum. In another embodiment an ESI TOF MS device can be used See Proteomics 3 847 850 2003 .

As used herein MS refers to fragmentation of all MSions or a subset of ions. See for example Nature Methods 2004 Oct. 1 1 39 45. This embodiment can be used for example if the MSdata is inconclusive in identifying bacteria present in the sample and provides a multiplex approach that reveals additional information of bacterial LA LTA structure.

In various embodiments obtaining the MSMS spectra comprises obtaining MSMS spectra on 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 or more MSions. In one non limiting example the method comprises obtaining the MSMS spectra for the 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 or more of the most abundant MSions. In another embodiment the method comprises obtaining the MSMS spectra on all MSions.

The MSMS spectra provides similar information on the MSions as did the PMIS on the precursor ions including but not limited to information on a the m z values of the MSions assessed and b the relative abundance of the MSions generated. Similarly the database s to be used in this embodiment would further comprise previously obtained MSMS spectra data similar to that present in the database for the PIMS spectra including but not limited to MSion m z values for LA or LTA molecules in the bacteria represented in the database. The data may also include the normalized relative abundance of these MSions scoring information as available for the MSions as well as data regarding the MS technique used to generate the data.

In one embodiment obtaining MSMS spectra on MSions comprises selecting peaks between about 1000 m z and about 2200 m z in other embodiments between about 1100 m z and about 2100 m z or between about 1200 m z and about 2000 m z. These embodiments focus the analysis on MSions with a mass to charge ratio likely to be of most relevance for the analysis.

In another embodiment the methods further comprise fragmenting all or a subset of the precursor ions to produce a set of derived fragment ions and obtaining MS spectra on all or a subset of the derived fragment ions MS spectra and wherein the comparing further comprises sequentially comparing the MSspectra to bacterial LA and LTA MSspectra in the database to assist in identifying bacteria in the sample. This embodiment can be used for example where PMIS and or MSE data is inconclusive or where more detailed structural information on the relevant LA and or LTA species is desirable. For example this embodiment can be used to determine new LA and or LTA structures. Thus this embodiment can be used for example to identify new biomarkers of specific bacteria as well as biomarkers of antibiotic resistant bacterial strains. Those of skill in the art will understand the types of mass spectrometry devices that are most suitably used with this embodiment of the invention. For example an ion trap can be used to obtain full MSspectra while other tandem mass spectrometers ie those with more than one mass analyzer including but not limited to triple quad MS QTOF MS and Qtrap MS can typically obtain MSspectra.

As used herein derived fragment ions are ions fragmented from the precursor ions the first generation of such ions MS are fragmented from the MSions the second generation of such derived fragment ions MS are fragmented from the MSions etc. The process is iterative with MSrepresenting the number of generations. Thus in one embodiment the MSspectra data is obtained for at least two generations MSand MS of derived fragment ions and compared to bacterial LA and LTA MSand MSspectra in the database. In another embodiment the MSspectra data is obtained for at least generations MS MS and MS of derived fragment ions and compared to bacterial LA and LTA MS MS and MSspectra in the database. The methods can be repeated to any desired n value of derived fragment ions 2 3 4 5 6 etc. This embodiment is sequential in that each successive generation of derived fragment ion derived from a single precursor ion can be compared against the database in contrast to the MSE embodiment where all subsequent generations of fragmented ions or subsets thereof are compared against the database simultaneously. For example in one embodiment MSspectra are compared to the database and if needed ie no difference seen or not enough difference etc. MSspectra are compared to the database. Similarly MSand further spectra can be obtained and compared to the database until a desired end point is obtained such as a difference seen either in chemical structure or relative abundance from ion intensity values present in all spectra of things all with the same structure . Each level of MSdata reveals new structural details of LA and or LTA that allows more refined structures to be defined.

In various embodiments obtaining the MSMS spectra comprises obtaining MSMS spectra on 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 or more MSions the number can differ from one generation of derived fragment ions to another as deemed suitable for a given purpose. In one non limiting example the method comprises obtaining the MSMS spectra for the 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 or more most abundant MSions. In another embodiment the method comprises obtaining the MSMS spectra on all MSions.

The MSMS spectra provides similar information on the MSions as did the PMIS on the precursor ions including but not limited to information on a the m z values of the MSions assessed and b the relative abundance of the MSions generated. Similarly the database to be used in this embodiment would further comprise previously obtained MSMS spectra data similar to that present in the database for the PIMS spectra including but not limited to MSion m z values for LA or LTA molecules in the bacteria represented in the database. The data may also include the normalized relative abundance of these MSions as well as data regarding the MS technique used to generate the data.

In a further embodiment that can be combined with any embodiment or combination of embodiments herein the method further comprises searching the precursor ion and or MSspectra against a database of bacterial LA and LTA signature ions to identify signature ions in the precursor ion and or MSspectra. As used herein signature ions are unique ions that help hypothesize the molecule s structure. In this embodiment the database may comprise one database of previously identified signature ions for bacteria represented in the database and a second database comprising the precursor ion and or MSion MS spectra data. An exemplary embodiment is shown in . In this non limiting example bacterial LA is subjected to a hierarchical tandem mass spectrometry MS strategy that generates MSand higher tandem mass spectra for each significant precursor ion detected in an MSscan. Structures are assigned by the method which first searches a theoretical signature ion TSI database to detect signature ions and then confirms these by comparison to a database of expected theoretical neutral losses TNL from which a chemical formula and structure is derived.

Tandem mass spectrometry involves multiple steps of mass spectrometry selection with some form of fragmentation occurring in between the stages. Exemplary tandem MS techniques suitable for use with the present claims include but are not limited to those disclosed in Shaffer et al. in the Journal of the American Society for Mass Spectrometry JASMS June 2007 Vol. 18 No. 6 pp. 1080 1092.

 i searching neutral losses of signature ions in the MSspectra against a theoretical neutral loss database to identify dissociation formulae 

 ii proposing LA and or LTA candidate structures from bacteria in the sample based on the dissociation formulae and the signature ions in the MSspectra 

 iii assigning a score to each LA and or LTA candidate structure based on correlation between theoretical and acquired MSspectra wherein candidate structures that meet or exceed a user defined threshold are considered as accurate assignments.

In this embodiment the database comprise for example a database based on the interpretation of LA and or LTA fragmentation rules in tandem mass spectra which includes phosphate patterns as well as fatty acid and monosaccharide substituents. Direct bond cleavages of LA and or LTA structures can be considered as the general template for fragmentation and structural inference. In a further embodiment each database may comprise two sub databases or may comprise two separate but connected databases for 1 theoretical signature ions TSI and 2 theoretical neutral losses TNL . For example the observed LA signature ions can be determined from the conserved characteristic of LA diglucosamine and named according to nomenclature known in the art. Based on the observed fragmentation templates of LA signature ions can be calculated and compared to the theoretical signature ion TSI database. In a further embodiment any MS spectra without any identifiable signature ions are discarded prior to comparing to the database.

To increase the structural diversity of LA and or LTA represented in the TSI database a user defined carbon range of fatty acids can be applied for example 12 0 to 20 0 fatty acids . By systematically altering the fatty acid side chain lengths and positions all possible signature ions can be computed if desired and incorporated into the TSI database. To facilitate structure assignment neutral losses of signature ions can be calculated and put in the theoretical neutral loss TNL database. Additionally common observed neutral losses that come from direct bond cleavages of LA other than cleavages of signature ions can also be included in the TNL database. Similarly to increase the structural diversity covered by TNL databases fatty acid compositions of TNL can be systematically altered within the user defined carbon range.

In this embodiment acquired MSspectra can be searched against the TSI database to find possible signature ions and spectra without any identifiable signature ions can be discarded . Any identified signature ions suggest formulae corresponding to the reducing and or non reducing portions of LA. By subtracting the mass of signature ions from their precursors the neutral losses of signature ions can be subsequently calculated and searched against the TNL database. The combination of signature ions and matched neutral losses may be used to provide a preliminary candidate structure .

In a further embodiment searching neutral losses of signature ions in the MSspectra against a theoretical neutral loss database to identify dissociation formulae comprises

 A determining a neutral loss of every MSspectrum s precursor ion in the corresponding MSspectrum and searching against the theoretical neutral loss database and

wherein step ii comprises proposing the LA and or the LTA structures from the bacteria in the sample based on the integrating data from each MSlevel.

In this embodiment the calculated neutral losses of all the ions in each spectrum can also searched against the TNL database to provide desired information for spectrum annotation ie a lipid spectrum match LSM . After preliminary structures are assigned neutral loss of one or more or every MSspectrum s precursor ion can be calculated in the corresponding MSspectrum and searched against the TNL database again to for example identify the possible dissociation patterns. The method may proceed iteratively until the MSlevel is reached. The final structures can be deduced for example by integrating the information gained from the different levels of MSdata.

In another embodiment assigning a score to each LA and or LTA candidate structure based on correlation between theoretical and acquired MSspectra comprises

 A fragmenting the LA and or the LTA candidate structures by direct bond cleavage to produce fragmentations 

 B combining the fragmentations into a reconstructed mass spectra representing the theoretical dissociation of the LA and or the LTA candidate structures and

 C assigning the score to each of the LA and or the LTA candidate structure based on correlation between theoretical MSspectra and the reconstructed mass spectra.

In this embodiment for every LSM a hypothetical LA structure can be fragmented in silico based primarily on direct bond cleavages including glycosidic bond cleavages i.e. A X B Y C Z type ions losses of O and N linked acyl chains losses of phosphate losses of monosaccharide and perturbations representing combined losses. Fragmentations can for example then be combined into a reconstructed mass spectrum representing the theoretical dissociation of the candidate structure.

In another embodiment an X score may be applied to a lipid spectrum match LSM to evaluate the closeness of fit between one or more acquired MSspectrum and a theoretical tandem mass spectrum. The peak intensity of each reconstructed mass spectrum can for example be assigned a Boolean value where 1 represents for example the existence of a fragmentation of such m z value. The X score between the acquired mass spectrum and the reconstructed mass spectrum of hypothetical structure can be measured using any suitable scoring scheme including but not limited to those disclosed in the examples below.

In one embodiment each X score calculation is a scalar dot product between reconstructed mass spectrum x and the preprocessed acquired mass spectrum y with is the correction factor.

In a further embodiment the methods may comprise use of a target decoy strategy for example generating decoys by shuffling the candidate LA and or LTA structures on the fly while analyzing each MSspectrum. In one embodiment such shuffling only occurs on the position and length of LA and or LTA fatty acid side chains. This approach ensures that every decoy LA and or LTA exhibits precisely the same molecular composition and mass as the target i.e. candidate LA and or LTA structures. X score of both candidate and decoy LSM can then be calculated to help evaluate the significance.

The methods of any embodiment or combination of embodiments of the invention can be used alone or in combination with other bacterial identification methods such as those based on protein MS patterns. Thus in another embodiment the methods comprise obtaining mass spectrometry MS spectra on precursor ions for bacterial proteins in the sample comparing the protein MS spectra to a database of bacterial protein precursor ion mass spectrometry spectra wherein the comparing is used to help identify bacteria in the sample. In a further embodiment the sample is processed to obtain LA and or LTA together with protein using a standard protocol that maintains the pH of the sample between about 4 to 5 such as a pH of about 4.5 for the portion of the sample processing for LA and or LTA isolation. In one exemplary embodiment such a technique would comprise contacting a bacterial pellet with sodium acetate such as 5 20 ml or any other suitable treatment resulting in a sample pH of about 4.5 with or without heating and mixing to resuspend the bacteria. Next acetonitrole is added such as about 5 20 ml and the sample mixed followed by centrifugation such as at about 25 000 g for about 2 minutes to obtain the supernatant for MS analysis. In another embodiment the bacterial sample is split into two samples with a first sample pelleted and treated as above and a second sample treated similarly except that the sodium acetate is replaced with formic acid. In this embodiment the first sample can be used for LA and or LTA analysis and the second sample can be used for protein analysis. In a further embodiment the sample is treated via the sodium acetate procedure and a portion of the sample is used for LA and or LTA analysis and the rest of the sample is treated with formic acid for protein analysis.

In this embodiment the methods of the present invention can be used in combination with protein MS analysis to for example improve the efficiency of the protein MS analysis. One embodiment of such protein MS analysis is the Bruker MALDI Biotyper mass spectrometer platform Bruker Daltonics See for example Sauer et al. PLoS ONE 3 7 e2843. doi 10.1371 journal.pone.0002843. The methods of the present invention provide improved accuracy in bacterial identification compared to protein based MS techniques or in combination with protein based MS techniques as indicated by the following examples See for example for results using current methods 

 a is considered as a part of the species phylogenetically and gives no different pattern in protein based MS while it can be distinguished from using the methods of the present invention.

 b identification requires a second protein MS based test for confirmation gold standard MLST . As is very closely related to the S. mitis group there might occur misidentifications mostly with low ID scores. 16S rDNA sequencing also is not sufficient for differentiation of and while the methods of the present invention can distinguish and

 c Three species are very closely related to and accordingly may appear as mis identification results using protein based MS analysis and . Furthermore the former subspecies now is not securely distinguishable by the MALDI Biotyper 

 d complex 313 Species differentiation can be difficult using protein based MS techniques. While and can be differentiated well there are several members of the Genospecies 3 clustering with or which can lead to 3 ID result where biochemistry will identify or . The methods of the present invention may be used for accurate species distinction within the complex.

 e complex is a group of six very closely related species with a similar resistance pattern and Distinguishing between species within the complex is not possible using protein based MS techniques.

 f The group is very diverse and differentiation within the group is limited using protein based MS techniques while the methods of the present invention can be used to distinguish between members of the group.

 g and are closely related and show very similar protein MS patterns the methods of the present invention can be used to help distinguish and

 h and protein based MS patterns are very similar the methods of the present invention can be used to help distinguish and

 i is a member of a very diverse group that that cannot be distinguished using protein based MS methods any hits in this group are considered as group . The methods of the present invention can be used to help distinguish between different members of the group.

 j complex can be separated well from other species but sub species resolution within complex is currently limited using protein based MS techniques. The methods of the present invention can be used to help distinguish between different members of the complex.

 k and are very closely related and are not reliably distinguished using the MALDI Biotyper . The methods of the present invention can be used to help distinguish between and

 l species are very closely related and only can be differentiated reliably from the other species using protein based MS techniques. The methods of the present invention can be used to help distinguish between different species.

 m is a subspecies of and the two cannot be distinguished using protein based MS analysis. The methods of the present invention can be used to help distinguish between and

 n Some species within the genus are very closely related leading to a very similar pattern using protein based MS analysis. The methods of the present invention can be used to help distinguish between species within the genus

 O and are very similar in protein based MS patterns while the methods of the present invention can be used to help distinguish between and

Results of a comparison between one or more input spectra generated by a mass spectrometer or similar device e.g. PIMS MS MSspectra and one or more stored spectra e.g. spectra stored as in a database can be carried out in an automated fashion using a computing device acting as a spectra identifier. 

Upon completion content related the results of the comparison can be generated by the spectra identifier. For example the content can include graphs images alphanumeric and or video content preferably displayed to a user via a graphical user interface on either the spectra identifier or a client device.

For example shows spectra identifier configured to communicate via network with mass spectrometer and client devices . Network may correspond to a LAN a wide area network WAN a corporate intranet the public Internet or any other type of network configured to provide a communications path between networked computing devices. The network may also correspond to a combination of one or more LANs WANs corporate intranets and or the public Internet.

Although only shows two client devices distributed application architectures may serve tens hundreds or thousands of client devices. Moreover client devices and or any additional client devices may be any sort of computing device such as an ordinary laptop computer desktop computer network terminal wireless communication device e.g. a cell phone or smart phone and so on. In some embodiments client devices and can be dedicated to MS and or bacteriological research. In other embodiments client devices and can be used as general purpose computers that are configured to perform a number of tasks and need not be dedicated to MS or bacteriological research. In still other embodiments the functionality of spectra identifier and or spectra database can be incorporated in a client device such as client devices and or . In even other embodiments the functionality of spectra identifier and or spectra database can be incorporated into mass spectrometer .

Mass spectrometer can be configured to receive an input material e.g. LA and or LTA and generate one or more spectra as output. For example mass spectrometer can be an electrospray ionization ESI tandem mass spectrometer or a SAWN based mass spectrometer. In some embodiments the output spectra can be provided to another device e.g. spectra identifier and or spectra database perhaps to be used as an input to the device. In other embodiments the output spectra can be displayed on mass spectrometer client devices and or and or spectra identifier .

Spectra identifier can be configured to receive as an input one or more spectra from mass spectrometer and or client device s and or via network . In some embodiments spectra identifier can be configured to directly receive input spectra via keystroke touchpad or similar data input to spectra identifier hard wired connection s to mass spectrometer and or client device s and or accessing storage media configured to store input spectra e.g. spectra database flash media compact disc floppy disk magnetic tape and or any other technique to directly provide input spectra to spectra identifier .

The one or more input spectra can include for example a MSsequence of n related spectra from a given input material. Each of the n related spectra can relate to one or more different ions and or neutral fragments of the input material.

Spectra identifier can be configured to generate results of spectra identification by comparing one or more input spectra to stored spectra . For example stored spectra can be known precursor ion mass spectrometry spectra MSion mass spectrometry spectra or MS. As shown in stored spectra can reside in spectra database . When performing spectra identification spectra identifier can access and or query spectra database to retrieve part or all of stored spectra . In some embodiments spectra identifier can perform the comparison task directly while in other embodiments part or all of the spectra identification task can be performed by spectra database perhaps by executing one or more query language commands upon stored spectra .

While shows spectra identifier and spectra database directly connected in other embodiments spectra identifier can include the functionality of spectra database including storing stored spectra . In still other embodiments spectra identifier and spectra database can be connected via network .

Upon identifying the input spectra spectra identifier can be configured to provide content at least related to results of spectra identification as requested by client devices and or . The content related to results of spectra identification can include but is not limited to web pages hypertext scripts binary data such as compiled software images audio and or video. The content can include compressed and or uncompressed content. The content can be encrypted and or unencrypted. Other types of content are possible as well.

User interface module can be operable to send data to and or receive data from external user input output devices. For example user interface module can be configured to send and or receive data to and or from user input devices such as a keyboard a keypad a touch screen a computer mouse a track ball a joystick a camera a voice recognition module and or other similar devices. User interface module can also be configured to provide output to user display devices such as one or more cathode ray tubes CRT liquid crystal displays LCD light emitting diodes LEDs displays using digital light processing DLP technology printers light bulbs and or other similar devices either now known or later developed. User interface module can also be configured to generate audible output s such as a speaker speaker jack audio output port audio output device earphones and or other similar devices.

Network communications interface module can include one or more wireless interfaces and or one or more wireline interfaces that are configurable to communicate via a network such as network shown in . Wireless interfaces can include one or more wireless transmitters receivers and or transceivers such as a Bluetooth transceiver a Zigbee transceiver a Wi Fi transceiver a WiMAX transceiver and or other similar type of wireless transceiver configurable to communicate via a wireless network. Wireline interfaces can include one or more wireline transmitters receivers and or transceivers such as an Ethernet transceiver a Universal Serial Bus USB transceiver or similar transceiver configurable to communicate via a twisted pair one or more wires a coaxial cable a fiber optic link or a similar physical connection to a wireline network.

In some embodiments network communications interface module can be configured to provide reliable secured and or authenticated communications. For each communication described herein information for ensuring reliable communications i.e. guaranteed message delivery can be provided perhaps as part of a message header and or footer e.g. packet message sequencing information encapsulation header s and or footer s size time information and transmission verification information such as CRC and or parity check values . Communications can be made secure e.g. be encoded or encrypted and or decrypted decoded using one or more cryptographic protocols and or algorithms such as but not limited to DES AES RSA Diffie Hellman and or DSA. Other cryptographic protocols and or algorithms can be used as well or in addition to those listed herein to secure and then decrypt decode communications.

Processors can include one or more general purpose processors and or one or more special purpose processors e.g. digital signal processors application specific integrated circuits etc. . Processors can be configured to execute computer readable program instructions contained in storage and or other instructions as described herein.

Data storage can include one or more computer readable storage media that can be read and or accessed by at least one of processors . The one or more computer readable storage media can include volatile and or non volatile storage components such as optical magnetic organic or other memory or disc storage which can be integrated in whole or in part with at least one of processors . In some embodiments data storage can be implemented using a single physical device e.g. one optical magnetic organic or other memory or disc storage unit while in other embodiments data storage can be implemented using two or more physical devices.

Data storage can include computer readable program instructions and perhaps additional data. For example in some embodiments data storage can store part or all of a spectra database and or stored spectra such as spectra database and or stored spectra respectively. In some embodiments data storage can additionally include storage required to perform at least part of the herein described methods and techniques and or at least part of the functionality of the herein described devices and networks.

In some embodiments data and services at spectra identifier and spectra database can be encoded as computer readable information stored in tangible computer readable media or computer readable storage media and accessible by client devices and and or other computing devices. In some embodiments data at spectra identifier and or spectra database can be stored on a single disk drive or other tangible storage media or can be implemented on multiple disk drives or other tangible storage media located at one or more diverse geographic locations.

In some embodiments each of the computing clusters and can have an equal number of computing devices an equal number of cluster storage arrays and an equal number of cluster routers. In other embodiments however each computing cluster can have different numbers of computing devices different numbers of cluster storage arrays and different numbers of cluster routers. The number of computing devices cluster storage arrays and cluster routers in each computing cluster can depend on the computing task or tasks assigned to each computing cluster.

In computing cluster for example computing devices can be configured to perform various computing tasks of spectra identifier . In one embodiment the various functionalities of spectra identifier can be distributed among one or more of computing devices and . Computing devices and in computing clusters and can be configured similarly to computing devices in computing cluster . On the other hand in some embodiments computing devices and can be configured to perform different functions.

In some embodiments computing tasks and stored data associated with server devices and or can be distributed across computing devices and based at least in part on the processing requirements of spectra identifier and or spectra database the processing capabilities of computing devices and the latency of the network links between the computing devices in each computing cluster and between the computing clusters themselves and or other factors that can contribute to the cost speed fault tolerance resiliency efficiency and or other design goals of the overall system architecture.

The cluster storage arrays and of the computing clusters and can be data storage arrays that include disk array controllers configured to manage read and write access to groups of hard disk drives. The disk array controllers alone or in conjunction with their respective computing devices can also be configured to manage backup or redundant copies of the data stored in the cluster storage arrays to protect against disk drive or other cluster storage array failures and or network failures that prevent one or more computing devices from accessing one or more cluster storage arrays.

Similar to the manner in which the functions of spectra identifier and or spectra database can be distributed across computing devices and of computing clusters and various active portions and or backup portions of these components can be distributed across cluster storage arrays and . For example some cluster storage arrays can be configured to store the data of spectra identifier while other cluster storage arrays can store data of spectra database . Additionally some cluster storage arrays can be configured to store backup versions of data stored in other cluster storage arrays.

The cluster routers and in computing clusters and can include networking equipment configured to provide internal and external communications for the computing clusters. For example the cluster routers in computing cluster can include one or more internet switching and routing devices configured to provide i local area network communications between the computing devices and the cluster storage arrays via the local cluster network and ii wide area network communications between the computing cluster and the computing clusters and via the wide area network connection to network . Cluster routers and can include network equipment similar to the cluster routers and cluster routers and can perform similar networking functions for computing clusters and that cluster routers perform for computing cluster

In some embodiments the configuration of the cluster routers and can be based at least in part on the data communication requirements of the computing devices and cluster storage arrays the data communications capabilities of the network equipment in the cluster routers and the latency and throughput of local networks the latency throughput and cost of wide area network links and and or other factors that can contribute to the cost speed fault tolerance resiliency efficiency and or other design goals of the moderation system architecture.

At block one or more peaks in the input spectrum are identified. The peaks can be determined using the MassSpecWavelet techniques discussed above or via other techniques such sorting the input spectrum by relative intensity or abundance and taking the top T T 0 points in the sorted input spectrum. Other techniques can be used as well.

Returning to at block a comparison between peaks of the input spectra and peaks in one or more stored spectra is performed. The stored spectra can be stored in any format for a spectrum such as but not limited to storage in a raw data format JCAMP DX ANDI MS mzXML mzData and or mzML. In some embodiments the input spectrum and or some or all of the stored spectra can be converted between formats before or during the comparison. The stored spectra can also include additional information such as a name of a compound molecule structure substance ion fragment or other identifier that can be used to identify the spectrum. For example if a stored spectrum is a spectrum for pure water then the stored spectrum can have additional information such as water or HO to help identify the stored spectrum.

If the peaks of the input spectra match peaks in one or more stored spectra method proceeds to block . Otherwise method proceeds to block where a no match display is generated and displayed. After completing the procedures of block method can proceed to block .

At block the input spectrum is compared to each of the one or more matching and stored spectra identified at block . For example consider spectra provided with relative intensity and mass charge ratio values. For each of the input spectrum and the matching spectra a dot product of the relative abundance and mass charge value can be taken to determine a weighted average mass charge value. Then the weighted average mass charge value for the input spectrum A IS can be compared to each of the weighted average mass charge values for the matching spectra A MS where i 1 to the number of matching spectra. The matching spectra j with the closest weighted average mass charge value A MS to A IS can be considered to be a best matching spectrum. In some embodiments a difference between A MS and A IS can be determined and if the absolute value of this difference is greater than a threshold then the best matching spectrum can be considered not to match the input spectrum. If the two spectra are not considered to match method can proceed to block transfer of control not shown in .

At block when a match is found an output based on the best matching spectrum can be generated. For example if identifying information for the stored spectrum is maintained the output can indicate an identity of the matching spectrum. Also or instead the input spectrum and or the matching spectrum can be shown as part of the display. Further the A MS and A IS can be part of the display as well. Other information can be part of the display as well.

The output can be provided using some or all components of a user interface module such as user interface module and or a network communications interface module such as network communication interface module . For example the output can be displayed on a display printed emitted as sound using one or more speakers and or transmitted to another device using network communications interface module. Other examples are possible as well.

At block a determination is made as to whether there are additional input spectra to be processed. If there are additional spectra to be processed method can proceed to block otherwise method can proceed to block where method exits.

At block of method a material structure is initialized. For example the material structure can be initialized to no structure or if a material in a known class of materials e.g. lipids are to be analyzed the material structure can be initialized to a generic member of the known class of materials.

At block an input spectrum is received. The input spectrum can be expressed in any format for a spectrum such as but not limited to raw data format JCAMP DX ANDI MS mzXML mzData or mzML. Other formats can be used as well or instead.

At block one or more peaks in the input spectrum are identified. The peaks can be determined using the MassSpecWavelet techniques discussed above or via other techniques such sorting the input spectrum by relative intensity or abundance and taking the top T T 0 points in the sorted input spectrum. Other techniques can be used as well.

At block a determination is made as to whether there are any theoretical signature ions TSIs associated with the input spectrum. The determination can be made via a database query or other comparison between stored data for theoretical signature ions and the identified peaks of the input spectrum. In some embodiments data about one or more precursor ions can be stored and associated with a theoretical signature ion. In other embodiments probability information such as a classification score for identification can be generated passed in to the database as part of the database query and used to aid identification of a theoretical signature ion.

If one or more theoretical signature ions are found to be associated with the input spectrum then method can proceed to block .

However if no theoretical signature ions are found to be associated with the input spectrum then method can proceed to block and exit.

At block neutral losses for the input spectrum can be determined. For example a mass of a signature ion can be calculated and used as the value of the neutral loss of the input spectrum. If multiple signature ions are determined to be associated with the input spectrum the mass of each signature ion can be used as a neutral loss value. As another example the stored data for the signature ion can include one or more neutral loss values which can be used as the neutral loss value s for the input spectrum.

At block candidate structures s can be found whose neutral loss matches a neutral loss for the input spectrum. For example one or more theoretical neutral loss TNL values can be stored in a theoretical neutral loss database. In some embodiments the theoretical neutral loss database can one or more records each with a neutral loss value as a key and one or more candidate structures as attributes associated with the key neutral loss value. In these embodiments the theoretical neutral loss database can be queried with each neutral loss value and any structure s retrieved by these queries can be treated as candidate structures.

At block an X score for each candidate structure can be determined. The X score can be determined between a given candidate structure and the input spectrum using any suitable scoring scheme including but not limited to those disclosed in the examples below. For example an X score calculation can be a scalar dot product between the material structure with the given candidate structure added and part or all of the input spectrum perhaps as adjusted with a correction factor.

At block a determination is made as to whether there are additional input spectra to be processed. If there are additional spectra to be processed method can proceed to block otherwise method can proceed to block .

At block an output based on the material structure can be generated. The output can include the material structure the input spectra some or all of the candidate structures identifying information and or other information.

The output can be provided using some or all components of a user interface module such as user interface module and or a network communications interface module such as network communication interface module . For example the output can be displayed on a display printed emitted as sound using one or more speakers and or transmitted to another device using network communications interface module. Other examples are possible as well.

In a second aspect the present invention provides methods for identification of antibiotic resistant bacteria comprising obtaining lipid A from a bacterial sample and determining whether the lipid A comprises a phosphoethanolamine PEtN modification and or a hexosamine modification at the 1 position wherein presence of PEtN modified lipid A and or the hexosamine modification indicates that the bacteria is antibiotic resistant.

As used herein a PEtN modification comprises the addition of ethanolamine to a lipid A phosphate. In one embodiment the PEtN modification comprises a modification at the 4 position for . In another embodiment the PEtN modification comprises a modification at the 1 and 4 position for

In one embodiment the antibiotic resistance comprises resistance to colistin also known as polymyxin E . In another embodiment the bacterial sample comprises an sample such as an sample. In another embodiment the bacterial sample comprises a sample such as a sample.

As shown in the examples that follow phosphoethanolamine and or hexosamine modification at the 1 position of lipid A are shown as novel biomarkers for colistin resistance in and . These subtle structural changes shown for these bacterial species commonly occur as a result of environmental perturbations to which the bacteria adapt to avoid host killing mechanisms.

Isolation and analysis of lipid A from the bacteria in this second aspect of the invention can be carried out by any suitable methods including but not limited to any embodiment or combination of embodiments of the methods described herein.

The sample may be any suitable sample including but not limited to clinical samples such as those described above. Also as described above the lipid A can be obtained directly from the sample or bacteria in the sample may first be amplified to obtain more cells in order to increase the amount of lipid A obtained.

In a third aspect the present invention provides methods for constructing libraries of LA and or LTA precursor ion and MSand or MSdata comprising

 a obtaining PIMS spectra on precursor ions for lipid A LA or precursors molecules thereof and or lipoteichoic acid LTA or precursor molecules thereof obtained from a plurality of different bacteria 

 b determining precursor ion m z values and relative ratios of precursor ion signals relative to each other 

 c determining consensus values for the precursor ion m z values and the relative ratios of the precursor ion signals relative to each other for a given bacteria and

As disclosed above the libraries of the invention can be used for example for the automatic identification of bacterial species. Accessible information from the library can include i bacterial species bacterial MSphenotypes ii glycolipid hierarchical tandem mass spectra MSto MS iii annotated glycolipid structures and iv theoretical and observed isotopic distributions for the primary precursor ion species in each MSdata set.

All embodiments and combinations of embodiments of the first and second aspect of the invention can be used in this third aspect unless the context dictates otherwise. Thus the methods for extracting isolating LA or LTA samples from bacteria include but are not limited to any of the methods disclosed herein. Similarly all embodiments of MS devices techniques that can be used are equally applicable in this aspect as are the various embodiments for obtaining PIMS spectra and determining precursor ion m z values and relative ratios of precursor ion signals relative to each other. In one embodiment MALDI TOF MS and or SAWN ITMSdata in both positive and negative ion modes are used. In one non limiting example MALDI TOF MSdata is used together with data from other MS instrument types to populate the database with precursor ion i.e. MS data in positive and negative ion modes. These MSdata consist of two columns of numbers m z values and relative intensity for each. Acquiring MSdata on different platforms provide technical replicates of each extract and an understanding of how instrumental differences and operators affect bacterial identification. Additionally it permits determination of which glycolipid extracts only produce good data in positive ion mode.

For example suppose two mass spectrometers MS1 and MS2 are used to generate spectra and or other information to be stored in a database. In this example suppose MS1 generates spectra using the JCAMP DX format while MS2 generates spectra using the mzXML format. Further suppose that the database uses a third format to store spectra. The database and or auxiliary software can convert JCAMP DX and mzXML formatted spectra into the third format for database storage. Then upon retrieval the database and or auxiliary software can reconvert the stored third format spectra into another format such as but not limited to JCAMP DX or mzXML for output.

The methods of this aspect of the invention comprise LA or LTA samples from a plurality 2 or more of different bacteria. The number of different bacteria from which samples are obtained is determined based on user needs. In various embodiments PIMS data may be obtained from resulting data stored for two or more different bacteria. As used herein different bacteria are different bacterial species different sub species and or the same species sub species but where some portion have undergone an environmental modification for example development of antibiotic resistance .

In one embodiment PIMS spectra may be obtained from one or more or all of the following groups of bacteria that cannot be distinguished using current ribosomal profiling techniques 

In another embodiment PIMS spectra may be obtained from two more or all of subspecies including and extended spectrum lactamase organisms as well as bacterium in the genus and

In another embodiment the methods further comprise fragmenting all or a subset of the precursor ions to produce a set of derived fragment ions and obtaining MS spectra on all or a subset of the derived fragment ions MSor MS spectra determining consensus values for the derived fragment ion m z values and the relative ratios of the derived fragment ion signals relative to each other for a given bacteria and storing the consensus values as a feature of the bacterial type in a database. Derived fragment ions are described above all embodiments for obtaining and analyzing MSand or MSspectra herein are applicable to this third aspect of the invention. In one embodiment the MSspectra data is obtained for at least two generations MSand MS of precursor ions MS and derived fragment ions MS in another embodiment at least three generations MS MS and MS of precursor ions MS and derived fragment ions MSand MS etc.

In one non limiting example SAWN ITMSdata is obtained. Subtle details of strain variation resulting from environmental pressure may be hidden under MSisobaric signals. Use of the MSapproach helps to tease apart all glycolipid structures above a threshold including those highly similar isobars obscured in MSdata as a single m z species. In one embodiment the threshold is preset threshold. Any suitable threshold can be used and it is within the level of those of skill in the art to establish a suitable threshold based on the teachings herein. In one non limiting embodiment the threshold would require a minimum signal noise ratio of 2 1. See for example Anal. Chem. 2009 81 6481 8. For glycolipid structure definition the SAWN ITMSplatform can be used to acquire positive and negative ion MSand MSdata. The MSdata can be generated for the most abundant ion species approximately 5 7 species in each MSspectrum and their structures determined using the MSmethods described in detail above. Structures and all SAWN ITMS1 and SAWN ITMSdata can be recorded in the MSGS library to identify bacteria alone or in combination with MALDI TOF MSdata.

In another embodiment the methods further comprise storing in the database as a feature of the bacterial type one or more of signature ions and LA or LTA structure s . Signature ions can be determined via standard MS techniques based on the teachings herein signature ions for some bacterial LA or LTA that are known may be input into the database for example manually or through automated access to other databases. Similarly LA and LTA structures can be determined using the methods of the present invention previously identified LA or LTA structures may also be input into the database for example manually or through automated access to other databases.

In another embodiment the method comprises storing consensus values for the precursor ion and derived fragment ion m z values and the relative ratios of the precursor ion derived fragment ion signals relative to each other for a given bacteria in a theoretical neutral loss database wherein the consensus values are used to assign a dissociation formula for LA or LTA for the different bacterial types. As used herein dissociation formulae are the pathway s of dissociation of a precursor ion. In this embodiment the method results in a database comprising for example a database based on the interpretation of LA and or LTA fragmentation rules in tandem mass spectra which includes phosphate patterns as well as fatty acid and monosaccharide substituents. Direct bond cleavages of LA and or LTA structures can be considered as the general template for fragmentation and structural inference. In a further embodiment each database may comprise two sub databases or may comprise two separate but connected databases for 1 theoretical signature ions TSI and 2 theoretical neutral losses TNL . For example the observed LA signature ions can be determined from the conserved characteristic of LA diglucosamine and named according to nomenclature known in the art. Based on the observed fragmentation templates of LA signature ions can be calculated and compared to the theoretical signature ion TSI database. In a further embodiment any MS spectra without any identifiable signature ions are discarded prior to comparing to the database.

To increase the structural diversity of LA and or LTA represented in the TSI database a user defined carbon range of fatty acids can be applied for example 12 0 to 20 0 fatty acids . By systematically altering the fatty acid side chain lengths and positions all possible signature ions can be computed if desired and incorporated into the TSI database. To facilitate structure assignment neutral losses of signature ions can be calculated and put in the theoretical neutral loss TNL database. Additionally common observed neutral losses that come from direct bond cleavages of LA other than cleavages of signature ions can also be included in the TNL database. Similarly to increase the structural diversity covered by TNL databases fatty acid compositions of TNL can be systematically altered within the user defined carbon range.

In this embodiment acquired MSspectra for an unknown bacteria can be searched against the TSI database to find possible signature ions . Any identified signature ions suggest formulae corresponding to the reducing and or non reducing portions of LA. By subtracting the mass of signature ions from their precursors the neutral losses of signature ions can be subsequently calculated and searched against the TNL database. The combination of signature ions and matched neutral losses may be used to provide a preliminary candidate structure .

The library structure and reading software can be of any suitable type. In one non limiting embodiment the library structure software may be based for example on a relational database system MySQL and the reading software can be a graphical user interface such as a web based user interface. The library can be stored in a MySQL database hosted on a desired secure server. The library structure software is geared toward extracting information from the library for bacterial identification by processing queries for comparison of observed data to previously recorded data. In other embodiments the library structure software can provide some or all data stored in the theoretical signature ion TSI and or theoretical neutral loss TNL database to an application program for processing without use of database queries. For information on the open source software MySQL concept see the articles describing it at web site dev.mysql.com tech resources articles .

Lipid A and LTA were prepared using a published isolation method 46 1773 1778 2005 . Briefly approximately 0.1 10 mg of lyophilized material of an overnight culture of each strain was resuspended in 400 l of isobutyric acid and 1 M ammonium hydroxide 5 3 v v and incubated at 100 C. for 30 minutes to 1 h vortex frequently in a 1.5 ml screw cap test tube. Individual samples were cooled in ice water and centrifuged for 15 min at 2000 g supernatants were collected and diluted 1 1 v v with endotoxin free water. The samples were subsequently frozen and lyophilized overnight. The resultant powered material was washed twice with 1 ml of methanol and the insoluble lipid A was extracted in 100 200 l of a mixture of chloroform methanol and water 3 1 0.25 v v v depending on starting amount.

Negative ion matrix assisted laser ionization desorption time of flight tandem mass spectrometry MALDI TOF TOF MS experiments was performed. Briefly lipids were solubilized in 200 l of a mixture of chloroform methanol and water 3 1 0.25 v v v and spotted 1 L directly onto the MALDI sample plate followed by 1 L of 100 mg mL norharmane MALDI matrix dissolved in chloroform methanol water 3 1.5 0.25 v v v . All experiments were performed using a Bruker Autoflex Speed MALDI TOF TOF mass spectrometer Bruker Daltonics Inc. Billerica Mass. USA . Each spectrum was an average of 300 500 shots and 50 75 laser power. For MS MS analysis precursor ions were chosen and submitted for LIFT TOF TOF acquisition in the negative ion mode as per Bruker standard MALDI TOF protocols. ES Tuning Mix Agilent Palo Alto Calif. USA was used as a calibration standard.

 a Lipid a Isolation from Cells Using Microwave Assisted Enzymatic Digestion and Sodium Acetate Hydrolysis Liquid Cultures

200 l 50 mM of sodium acetate buffer pH 4.5 containing proteinase K 60 g ml was added to lyophilized cells and microwaved at 50 W for 5 min at 58 C. The samples were incubated for 1 hour at 100 C. followed by centrifugation at 10000 g for 5 min and supernatant discard. The pellet was washed twice with 400 l methanol centrifuged at 10000 g for 5 min dissolved and extracted once with 200 l chloroform methanol 1 1 v v followed by centrifugation at 8000 g for 5 min and drying of supernatant under a nitrogen stream.

Bacterial colony was placed in a 1.5 ml Eppendorf tube containing 1 phenol in PBS washed twice using 400 l diHO and centrifuged at 10000 g for 5 min. Following this step the sample was treated as described above for liquid cultures

Using a common extraction method isobutyric acid ammonium hydroxide for both Gram negative and positive bacterial backgrounds lipid A and LTA were extracted respectively and analyzed using a MALDI TOF MS in the negative ion mode 29 36 . Bacteria lipid A LA or lipoteichoic acid LTA was extracted and isolated from cell membranes and analyzed by MALDI TOF spectrometer. MS1 spectra were collected and preprocessed as follows. Raw data files were converted to mzXML data format. The peak list information were detected using MassSpecWavelet a wavelet based mass spectrum processing software provided by the Bioconductor Bioinformatics 2006. 22 17 p. 2059 2065. The similarity of pairs of the spectra was determined by calculating their dot product.

Spectra shown in are representative examples for two Gram negative and positive bacterial backgrounds. Using these methods of glycolipid extraction and MS analysis results from approximately 25 additional species and subspecies used to generate the heat map demonstration of glycolipid phenotyping .

This preliminary data clearly demonstrates the ability of LA and LTA MS1 data to distinguish not only bacteria but also antibiotic resistance MRSA is distinguishable from non MRSA and environmental variants grown high and low Mg growth conditions known to alter LA composition is distinguishable . As indicated by the diagonal black set of squares all data sets most closely match themselves and not other data. A black square represents a normalized score of 1.0 or a perfect match while the darkest gray squares represent a score of 0 at the opposite end of the normalized scoring scheme or where there is no match. The intermediate gray color indicates that there is high similarity but that there are MS features remaining that distinguish these data as unique one from the other. The same is true for the white scores where one can see that a single molecular change can be detected between without modifications from with ColR modifications i.e. additional of PEtN versus hex and and O157 can be distinguished. These cases demonstrate that the present methods will succeed where the protein phenotype of Biotyper fails.

This data set demonstrates that bacteria may be identified by MS1 profiles of their glycolipid extracts. To provide more objective evidence of the value of this approach sensitivity 100 accuracy 96 and specificity 96 were calculated using a standard receiver operating characteristic ROC curve and a 6 point result rating data not shown . All 128 true positives in a total of 3 894 cases from the test data were correctly identified with only 145 false positives. Most false positives can be explained by dot product scores greater than 0.5 but less than 0.8 of either sub species or modified growth conditions. This confirms the MS1 methods of the invention provide a very sensitive and accurate method for bacterial identification.

Using similar methods to those discussed above and lipid A extracts were mixed 10 10 1 and a mass spectrum recorded in negative ion mode on a MALD TOF MS Bruker Autoflex Speed . The diversity of various bacterial glycolipid structures form the foundation of LA and LTA chemical barcodes to identify bacteria. Importantly these glycolipids can constitute up to 90 of the total bacterial membranes and are stable making them easily and rapidly extractable. Similar unique structures exist for LTA from Gram positive bacteria. Using the same methods as disclosed above it was shown that mixture analysis is feasible from ordinary MALDI TOF MS instrumentation providing an advantage over current protein based methods that require pure cultures.

To determine if lipid A from could be extracted directly from bacteria present in zero passage samples e.g. human wound effluent and serum ATCC strain 19606 was added or spiked to either wound effluent or serum C at approximately 1 10colony forming units CFU ml. The samples were processed using a small scale lipid A extraction method isobutyric acid ammonium hydroxide described above. The results show that similar lipid A profiles could be generated using MALDI TOF MS from bacteria present in wound effluent or serum as compared to bacteria alone demonstrating the feasibility of the methods of the invention to identify wound and or bloodstream infection without further growth or amplification in the clinical laboratory.

Using the microwave glycolipid extraction process described above lipid A has been extracted in approximately 3.5 hours from single colonies of and . The results data not shown clearly show the value of this extraction and MS analysis technique in the rapid and sensitive analysis of the glycolipid molecules in these bacterial species.

Colistin resistance is rare in however wound infections in injured soldiers are becoming a matter of great concern for the US military hospital system. However due to the prevalence of multidrug antibiotic resistance in a majority of clinical isolates there has been a dramatic increase in the primary use of the negatively charged antimicrobial peptide colistin polymyxin E . Even though colistin has been in limited use over the past 30 years due to concerns regarding toxicity specifically nephrotoxicity damage to the kidneys and neurotoxicity damage to the nerves little is known about the molecular mechanism of colistin resistance in . Though recently alterations in the lipid A content through the addition of the positively charged moiety phosphoethanolamine PEtN at the 4 position have been reported that alters the electrostatic charge on the bacterial membrane 37 . We have also identified a second positively charged moiety a hexosamine at the 1 position of lipid A .

To test the hypothesis that either or both of these lipid A modifications are important in altering the resistance profile of to colistin lipid A was extracted from a variety of clinical isolates from three geographically distinct patient populations clinical trial patients at the National Institutes of Health in Bethesda Md. Wounded Warfighters at Walter Reed Medical Center in Washington D.C. and in patients at the Siriraj Hospital Mahidol University Bangkok Thailand. Lipid A extraction MS and MSanalysis were performed as described above. Results for an exemplary number of bacterial isolates are shown in and indicate that the presence of phosphoethanolamine is a novel biomarker for colistin resistance in . These subtle structural changes shown for commonly occur as a result of environmental perturbations to which the bacteria adapt to avoid host killing mechanisms.

In addition we have recently obtained five colistin resistant isolates from wounded soldiers at Walter Reed Army Institute of Research WRAIR that show a 100 correlation of phosphoethanolamine addition to lipid A in these isolates. These results were reported within 4 hours of the isolates arrival as agar plate cultures in the laboratory. These results clearly demonstrate the feasibility of this type of analysis as a diagnostic test for colistin resistance in a clinical setting and potentially keep a wounded soldier from receiving a treatment that may have detrimental toxic effect with no positive bacterial eradication outcome.

Using identical procedures it was determined that colistin resistant possess lipid A modified by PEtN at the 1 and 4 position data not shown .

Infusion based electrospray ionization ESI coupled to multiple stage tandem mass spectrometry MS is a standard methodology for investigating lipid A structural diversity Shaffer et al. 2007 . Annotation of these MSspectra however has remained a manual expert driven process. In order to keep up with the data acquisition rates of modern instruments we devised a computational method to annotate lipid A MSspectra rapidly and automatically which we refer to as Hierarchical Tandem Mass Spectrometry HiTMS algorithm. As a first pass tool HiTMS aids expert interpretation of lipid A MSdata by providing the analyst with a set of candidate structures that may then be confirmed or rejected. HiTMS deciphers the signature ions e.g. A Y and Z type ions and neutral losses of MSspectra using a species specific library based on general prior structural knowledge of the given lipid A species under investigation. Candidates are selected by calculating the correlation between theoretical and acquired MSspectra. At a false discovery rate of less than 0.01 HiTMS correctly assigned 85 of the structures in a library of 133 manually annotated subspecies lipid A structures. Additionally HiTMS correctly assigned 85 of the structures in a smaller library of lipid A species from demonstrating that it may be used across species.

Preparation of Bacterial Lipid A. tularensis subspecies Fn strain U112 was grown with aeration in tryptic soy broth Gibco BRL Grand Island N.Y. supplemented with 0.1 cysteine at 25 C. and harvested in the stationary phase. Yp strain KIM6 was grown in Luria broth pH 7.4 at 37 C. with aeration and harvested in the late exponential phase referred to as Yp wild type Yp WT 24 . Lipid A C 1 and C 4 phosphatase LpxE and LpxF respectively have been expression cloned in Fn 25 . The individual plasmids with the structural genes of LpxE or LpxF and an ampicillin resistance gene were incorporated into KIM6 cell via electroporation 11 . The phosphatase expressing strains were then grown in Luria broth containing 100 g ml ampicillin pH 7.4 at 37 C. with aeration and harvested in the late exponential phase and designated as Yp LpxE and Yp LpxF. Fn and Yp LPS were extracted using the hot phenol water extraction method as previously described 26 . Lipid A was isolated after LPS was treated with RNase A DNase I and proteinase K by the method of Caroff 27 .

Mass Spectrometric Analysis. The isolated Fn lipid A was analyzed by electrospray ionization ESI in the negative ion mode on a hybrid linear ion trap Fourier transform ion cyclotron resonance FTICR mass spectrometer LTQ FT Thermo Scientific San Jose Calif. . Lipid A was prepared at 0.5 mg ml in methanol chloroform 2 1 and infused at 1.0 l min into a heated capillary inlet maintained at 400 450 C. MSspectra were acquired according to a target MS scheme predetermined from previous studies 7 . Briefly in this scheme fifteen deprotonated molecular ions were selected individually for MSfor the initial loss of 12 0 number of carbons number of double bonds 14 0 16 0 18 0 and 20 0 fatty acids each of which were determined previously to be esterified through the 2 position fatty acid at the 3 hydroxy position of the lipid A deprotonated anions. Each of the subsequent ions was selected for MSfor the combined loss of galactosamine and the 3 position 3 hydroxy fatty acid 12 0 14 0 16 0 18 0 and 20 0 . Ions representing these combined losses were in turn selected for MSand monitored for the observation of Y Zion pairs using 1 minute scan averaging. Each MSand MS channel was selected regardless of product ion spectra observed 28 and only the MSwere used for the determination of the individual lipid A structures. Ion population in the LTQ was set at 10 000 and collision energies employed for MSranged from 25 35 . For Yp Lipid A data were acquired on an LTQ FT Ultra Thermo Scientific as described elsewhere 10 11 .

Theoretical Databases Construction. Theoretical database constructor program was written with Perl v5.8.8 see web site perl.org built for x8664 Linux platform. A species specific theoretical database was constructed based on the manual interpretation of lipid A fragmentation rules in tandem mass spectra which included phosphate patterns as well as fatty acid and monosaccharide substituents. Direct bond cleavages of lipid A structures were considered as the general template for fragmentation and structural inference.

Each species specific theoretical database contains two sub databases for 1 theoretical signature ions TSI and 2 theoretical neutral losses TNL . Observed signature ions are unique ions that help hypothesize the molecule s structure. The observed lipid A signature ions were usually determined from the conserved characteristic of lipid A diglucosamine and named according to the nomenclature described by Domon and Costello 29 . Based on the observed fragmentation templates of lipid A signature ions were calculated and put into the theoretical signature ion TSI database. To increase the structural diversity of lipid A represented in the TSI database a user defined carbon range of fatty acids was applied i.e. 12 0 to 20 0 fatty acids . By systematically altering the fatty acid side chain lengths and positions all possible signature ions were computed and incorporated into the TSI database. To facilitate the structure assignment neutral losses of signature ions were also calculated and put in the theoretical neutral loss TNL database. Additionally common observed neutral losses that come from direct bond cleavages of lipid A other than cleavages of signature ions were also included in the TNL database. Similarly to increase the structural diversity covered by TNL databases fatty acid compositions of TNL were systematically altered within the user defined carbon range.

DeltaMass is a user assigned HiTMS parameter that defines the mass tolerance used to represent the acceptable mass difference between theoretical and observed ions. DeltaMass was applied in all searches against the TSI and TNL databases using the values consistent with the mass accuracy of the acquired data.

Data Preprocessing. Raw data files were converted into mzXML data format by ReAdW available in Xcalibur software Thermo Scientific . The peak information from either individual or averaged mass spectra were then extracted using MassSpecWavelet a wavelet transform based peak detection software provided by the Bioconductor project see web site bioconductor.org 30 . Resulting peak information of each MStandem mass spectrum was recorded in a peak list file referred as MSspectra hereafter .

Hierarchical Tandem Mass Spectrometry HiTMS Algorithm. HiTMS was implemented in Perl v5.8.8 see web site perl.org and run on a 64 bit GNU Linux platform. Acquired MSspectra were searched against TSI database to find possible signature ions and spectra without any identifiable signature ions were discarded . Any identified signature ions suggest formulae corresponding to the reducing and or non reducing portions of lipid A. By subtracting the mass of signature ions from their precursors the neutral losses of signature ions are subsequently calculated and searched against the TNL database. The combination of signature ions and matched neutral losses provides a preliminary candidate structure . The calculated neutral losses of all the ions in each spectrum were also searched against the TNL database to provide needed information for spectrum annotation. To each lipid spectrum match LSM an X score is applied to evaluate the closeness of fit between every MSspectrum and its preliminary candidate structures see Cross Correlation . After preliminary structures were assigned neutral loss of every MSspectrum s precursor ion was calculated in the corresponding MSspectrum and searched against TNL database again to identify the possible dissociation patterns. HiTMS continues the above procedures in an iterative manner until the MSlevel is reached. The final structures are deduced by integrating the information gained from the different levels of MSdata.

Cross Correlation X score . The X score uses a closeness of fit measurements between an acquired and theoretical tandem mass spectrum similar to SEQUEST xcorr 31 32 . For every LSM hypothetical lipid A structure is fragmented in silico based primarily on aforementioned direct bond cleavages including glycosidic bond cleavages i.e. A X B Y C Z type ions losses of O and N linked acyl chains losses of phosphate losses of monosaccharide and perturbations representing combined losses. Fragmentations are later combined into a reconstructed mass spectrum representing the theoretical dissociation of the candidate structure. The peak intensity of each reconstructed mass spectrum is assigned a Boolean value where 1 represents the existence of a fragmentation of such m z value. The X score between the acquired mass spectrum and the reconstructed mass spectrum of hypothetical structure is measured as follows 

Each X score calculation is a scalar dot product between reconstructed mass spectrum x and the preprocessed acquired mass spectrum y where is the correction factor as described in previous publications 31 32 . DeltaMass is used as the bin size to convert mass spectra into vectors. X score is used by HiTMS to measure the closeness of fit of every LSM.

On the fly Decoy Generation. In the world of proteomics a decoy database is often employed to help evaluate the significance of peptide spectra matches. A decoy database comprises protein sequences that have been shuffled or reversed generated from the given target database beforehand or on the fly 33 35 . HiTMS uses this target decoy strategy generating decoys by shuffling the candidate lipid A structure on the fly while analyzing each MSspectrum. To avoid destroying the lipid A biochemistry shuffling only occurs on the position and length of fatty acid side chains. This approach ensures that every decoy lipid A exhibits precisely the same molecular composition and mass as the target i.e. candidate lipid A structures. X score of both candidate and decoy LSM are then calculated to help evaluate the significance.

Manual Structural Analysis of Fn Lipid A. In prior work we demonstrated the power of an infusion based high throughput HTP hierarchical ESI MSstrategy to generate lipid A tandem mass spectra 7 . In this strategy each precursor ion and all subsequent fragment ions for each generation up to the 4level were fragmented in an hierarchical MSfashion. For example a precursor ion might generate a set of fragment ions A. . . A where n is the number of fragments produced by precursor ion A. Next each of these 1generation fragment ions was fragmented to produce a series of 2generation fragment ions A. . . Awhere m is the number of 2generation fragment ions produced by fragment ion Asuch that the process of continued up to the level of the 4generation where ion intensity generally dropped below the detectable threshold. Thereby each precursor ion had an hierarchical set of tandem mass spectra similar to a surname genealogical tree that branches out from the progenitor parental line associated with it that could be used to aid structure assignment. While lipid A structures were assigned manually in our prior efforts 7 10 11 the objective of the current work was to develop HiTMS an automated structure assignment algorithm and demonstrate its effectiveness on two structural different types of lipid A. To this end we first tested HiTMS s accuracy for high throughput structure assignments on a library of 133 unique Fn lipid A structures involving 58 variations of fatty acid combinations. This library consisted of a set of 30 previously published structures 7 and an additional set of 103 unpublished structures all of which were manually assigned see Supplemental Table S.1 for new structures. The 133 unique lipid A structures in the library were derived from 49 943 tandem mass spectra i.e. MSup to MS . While HiTMS is capable of analyzing individually all 49 943 tandem mass spectra our manually derived library of 133 structures came from 284 unique mass spectra produced by averaging 1 min intervals of infusion data. Here we focused HiTMS analysis on only these 284 averaged spectra for which structures had been manually confirmed. In order to determine the accuracy of structure assignments by HiTMS the 284 averaged mass spectra including 7 MS 16 MS 55 MSand 206 MSspectra were analyzed by HiTMS in an automated manner.

Species specific Construction of TSI and TNL Databases. Analogous to the use of species specific genomic databases in proteomics HiTMS uses species specific theoretical databases to identify the origin of fragment ions. These species specific theoretical databases require some basic knowledge of the lipid A structural configuration under investigation which may be inferred initially from the precursor ion spectrum. For example in the case of lipid A isolated from Fn the theoretical signature ions were derived primarily from Y and Z type ions as per Domon and Costello 29 . These theoretical signature ions were deposited in a species specific Fn TSI database including the combination of Y Zions with a C 1 phosphate one of 12 0 to 20 0 fatty acids where chain length range is user defined on 2 position and a potential galactosamine GalN substitution on C 1 phosphate. Additionally the fact that Fn lipid A only has a C 1 phosphate which gives characteristic Y Zions was included as signature ions while cross ring cleavages were not included. Finally all theoretical neutral losses that could be generated from direct bond cleavage of Fn lipid A were deposited in Fn TNL databases including n 0 3 OH ketene n 1 ketene n 0 acid GalN glucosamine GlcN and a phosphate group n is the range of carbon atoms in the fatty acids from 12 to 20. In addition the neutral losses resulting from glycosidic cleavages were also included in Fn TNL.

In the case of lipid A isolated from Yp theoretical signature ions were derived primarily from A type ions. Unlike Fn Yp lipid A is diphosphorylated and required unique TSI and TNL databases. The phosphorylation patterns of lipid A in Yp are C 1 and C 4 bisphosphate C 1 pyrophosphate and C 4 pyrophosphate 11 . Yp lipid A has also been observed to be heavily modified with up to two aminoarabinose Ara4N moieties 10 . At the mammalian host temperature of 37 C. the major Yp lipid A structures consists of a 1 6 linked diglucosamine backbone with two phosphate groups and four primary 14 0 fatty acids 36 38 . Such tetra acylated lipid A with four identical fatty acids distributed evenly on the reducing and non reducing end is likely to result in symmetric lipid A structures. The symmetric pattern of bisphosphorylated lipid A produces B Y and C Z type ions that fail to distinguish reducing end from non reducing end. Thus A type ions are crucial in Yp structure assignment because they fragment across the reducing glycan and result in distinguishable reducing and non reducing fragments providing unique signature ions 10 11 .

We also examined two Yp phosphatase mutant strains LpxE and LpxF which over express phosphatases resulting in the dephosphorlation of the 1 and 4 positions respectively yielding asymmetric lipid A. To account for this asymmetry both A type ions as well as Y and Z type ions were also included in Yp TSI database to detect a C 1 phosphate modification. In total the Yp TSI database consisted of A A Y and Zions with combinations of 0 1 or 2 phosphates 0 1 2 or 3 primary acyl chains and 0 or 1 secondary acyl chains while the range of fatty acid carbons was from 12 to 16. All theoretical neutral losses that can be generated from direct bond cleavage of Yp lipid A were deposited in Yp TNL databases including n 0 3 OH ketene n 1 ketene n 0 acid Ara4N and up to two phosphate groups where n is the fatty acid chain length. Possible neutral losses from any signature ions were also calculated and included in Yp TNL databases. Yp TSI and Yp TNL databases were used in structural analysis of Yp WT Yp LpxE and Yp LpxF datasets.

HiTMS Analysis of Fn Lipid A Mass Spectra. HiTMS analysis begins with the examination of a set of tandem mass spectra from the highest order of MSmass spectra available which by default is the least complex and works backward toward the precursor ion scan. In the case of the Fn dataset HiTMS began with MStandem mass spectra which were examined for the presence of species specific theoretical signature ions deposited in the Fn TSI database. In our dataset of 284 averaged tandem mass spectra HiTMS found that 147 71 of the 206 MStandem mass spectra contained signature ions present in the Fn TSI database. This meant that these 147 MStandem mass spectra came from lipid A species that were assignable based on the known Fn lipid A biochemistry from which the Fn TSI database was defined. As confirmation the assigned tandem mass spectra from the signature ion matches were further evaluated for the presence of expected neutral losses present in the Fn TNL database. This secondary Fn TNL database search provided preliminary structural hypotheses for each of the 147 mass spectra that were subsequently evaluated by a cross correlation X score analysis.

In order to evaluate the significance of a match HiTMS employed a target decoy strategy similar to that frequently used in proteomics to evaluate the false discovery rate of peptide tandem mass spectral matches. For each of the 147 assigned MStandem mass spectra HiTMS generated six on the fly decoys by shuffling the positions and lengths of the fatty acid side chains based on the species specific candidate structure. Decoys had the exact same chemical composition as the candidate structure and maintained lipid A like fragmentation rules. An X score which is a correlation score used to evaluate the closeness of fit between an acquired and a theoretical MSspectrum was then calculated for every LSM as defined in materials and methods including candidates and decoys.

The X score analysis calculated the similarity between tandem mass spectra generated from the derived hypothetical structures used to create the TSI and TNL databases and those from the observed data. To generate the X scores peak lists of spectra were converted into vectors binned by DeltaMass mass tolerance default 0.8 Da . This X score process produced a set of values similar to those generated by SEUQEST a popular tool for matching peptide tandem mass spectra to the amino acid sequences of proteins in a database 32 . As shown in the X score distribution from candidate matches was much higher than X score from decoy matches. Thus an X score value of 3.0 at which the two distributions intersected was selected as the default X score cutoff that successfully rejected more than 99 of decoys and resulting an FDR

HiTMS analysis of the 284 averaged mass spectra matched 120 lipid A structures data not shown . Comparison to our database of 133 manually assigned lipid A structures revealed that 109 unique lipid A structures were correctly retrieved by HiTMS and 11 putative new structures were hypothesized. Only 24 of the original structures were undetected which could be due to a number of reasons e.g. some of the manually assigned structures may be incorrect or the automated threshold used by HiTMS may have missed some ions selected during the manual analysis. The performance of HiTMS was assessed using F measure which is a tool for calculating precision and recall 39 . For the Fn dataset a balanced F measure of 0.86 with a precision of 0.91 and a recall of 0.82 was observed which suggests that HiTMS was able to assign lipid A structures with both a high precision and high recall. Interestingly out of the 206 MStotal tandem mass spectra were uniquely assignable and 57 annotated with more than one lipid A structure. The latter results suggest the existence of isomers even after the sample was examined down to the MSlevel. The isomeric structures detected in these 57 MSspectra are most likely due to various combinations of the fatty acid side chains 7 .

HiTMS Versus Manual Annotations. Of the 133 manually assigned lipid A tandem mass spectra 24 18 were not annotated by HiTMS data not shown . However while HiTMS produced structural hypotheses for 11 of these 24 their X scores were below the acceptable cutoff value of 3.0. These low X score structure predictions could be due to the lack of detectable signature ions or other supporting ions such as evidence of direct bond cleavage of fatty acids in these 11 tandem mass spectra. It should be noted that as the hierarchical MSstrategy approaches an MSacquisition that data quality naturally declines along with declining ion signal strength. This lower data quality is one likely reason for failing to detect informative signature ions. Thus as spectral quality decreases lower X score values are expected. In addition reconstruction of theoretical spectra is based on the most ideal fragmentations that include every possible direct bond cleavage and their combinations not the most likely to cleave chemical bonds. While lipid A structures in Fn are very complex it may be possible that in some cases the initial spectra might have been misinterpreted manually. For the moment though this manually curated library of structures is the standard from which we judge success for HiTMS. Finally while we have not done so here it should be noted that HiTMS is capable of examining individually each of the 49 943 acquired mass spectra that were averaged to produce 248 spectra for manual interpretation. This strategy will likely reveal even more complexity but given the difficulties in confirming accuracy of so many putative structures we have limited our analysis here to the manually curated data set.

HiTMS Spectral Annotation. As an example of how HiTMS annotates mass spectra in general and the ability of HiTMS to aid manual structure assignment shows an annotated tandem mass spectrum and the subsequent lipid A structural hypothesis that in this case was not detected by manual interrogation but can be easily confirmed with the annotated spectrum. Note that one reason this structure may have been missed is due to the low intensity signature ions that HiTMS detected which could be easily neglected during manual assignment due to the fact that there were many more dominant ions to account for during interpretation. Further as mentioned above distinguishing isomers is a difficult task that HiTMS analysis of MSdata was designed to handle. To do so HiTMS uses a sophisticated peak detection algorithm MassSpecWavelet 30 to improve the detection of low intensity peaks while allowing the analyst to adjust the threshold accordingly. In these cases HiTMS not only identified many potential new structures but also annotated them facilitating manual review of the structure assignments.

Yp Lipid A Structural Analysis. Lipid A structural diversity is reflected in part in the various combinations of fatty acids numbers and types as well as in the phosphorylation patterns which appear to be species specific. Like fatty acid composition phosphorylation pattern has been shown to have strong influence on bacterial pathogenicity 40 . Thus to insure that HiTMS could make accurate structure assignments where such modifications were common we also analyzed a previously published Yp lipid A data sets 10 11 . This data was generated for lipid A isolated from Yp after growth in rich media at 37 C. as part of a study to determine the phosphorylation pattern in Yp. Specifically Yp lipid A is structurally unique from Fn and has been shown to have diverse phosphorylation patterns including bisphosphorylation and pyrophosphorylation. Unlike Fn Yp lipid A contains two phosphates and is usually detected in bisphosphorylated forms 10 . In addition there are additional Ara4N modifications and differences in fatty acid side chains compared to Fn. Thus this data set on a symmetrical form of lipid A provided a number of unique opportunities to test HiTMS.

These Yp datasets contained MSto MStandem mass spectra but no MStandem mass spectra. Regardless of this difference and the fact that Yp datasets were much smaller than the Fn data set HiTMS was able to correctly assign two diphosphorylated lipid A structures from Yp WT dataset i.e. the major structures as well as five lipid A structures from genetically modified Yp which resulted from in vivo removal of C 1 phosphate Yp LpxE dataset and C 4 phosphate Yp LpxF dataset 10 11 .

Specifically the Yp data set included spectra from MSto MSconsisting of 31 521 tandem mass spectra in Yp WT 2 807 in Yp LpxE and 3 187 in Yp LpxF that were averaged as per Fn for HiTMS analysis. Analysis of 148 averaged MSspectra from Yp WT 35 from Yp LpxE and 40 from Yp LpxF respectively showed that HiTMS correctly assigned these lipid A structures as well as the structures known to be made by genetically modified LpxE and LpxF phosphatase mutants. As with the Fn data an X score cutoff of 3.0 was applied to filter the search results. An example of HiTMS annotation of Yp LpxE data is depicted in . The detected Aion suggests the fatty acid on the 2 position is 14 0 3 OH but the fragmentation of unsaturated 14 1 fatty acid could be on 2 or position. This process produced two candidate structures which are presented for expert review to confirm refute the proposed structures. Based on the X score and the number of matched ions the 14 1 acyl chain structure is more likely to be on the 2 position however the possibility of it being on the 3 position could not be ruled out. In addition the mass difference from MSto MSwas annotated with a fatty acid composition of a 12 0 plus a 14 0 3 OH ketene or a 14 0 fatty acid plus a 12 0 3 OH ketene. In this case a simple mass difference alone is not enough to determine which composition is more likely correct but we have shown that HiTMS can annotate correctly even the correlated MSspectra provided by A ions.

The HTP hierarchical MSdata acquisition strategy we developed previously 7 produced thousands of tandem mass spectra in a few days time that were reduced to one minute averages for manual interpretation. Even then Fn lipid A interpretation required several months of expert analysis time to produce 133 unique lipid A structures. Thirty of these 133 were previously reported and here we reported 103 additional structures data not shown derived from manual interpretation of the same original dataset. In order to automate lipid A structure assignment so that annotation rates would be more in line with the data acquisition rates we developed HiTMS. This automated algorithm relies on species specific theoretical libraries of signature ions and neutral losses to produce structure assignments. HiTMS correctly identified 85 of the 133 structures in our Fn lipid A library at 

