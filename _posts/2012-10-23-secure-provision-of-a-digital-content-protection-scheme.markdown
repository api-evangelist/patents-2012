---

title: Secure provision of a digital content protection scheme
abstract: Methods, apparatuses and storage medium associated with securely provisioning a digital content protection scheme are disclosed. In various embodiments, a method may include forming a trust relationship between a media application within an application execution environment of a device and a security controller of the device. The application execution environment may include an operating system, and the operating system may control resources within the application execution environment. Additionally, the security controller may be outside the application execution environment, enabling components of the security controller to be secured from components of the operating system. Further, the method may include the security controller in enabling a digital content protection scheme for the media application to provide digital content to a digital content protection enabled transmitter within the application execution environment for provision to a digital content protection enabled receiver. Other embodiments may be disclosed or claimed.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08726346&OS=08726346&RS=08726346
owner: Intel Corporation
number: 08726346
owner_city: Santa Clara
owner_country: US
publication_date: 20121023
---
The present application claims priority under 35 U.S.C. 365 a to International Application No. PCT US2011 062938 filed Dec. 1 2011 entitled SECURE PROVISION OF A DIGITAL CONTENT PROTECTION SCHEME which designates the United States of America. The entire contents and disclosure is hereby incorporated by reference in its entirety.

This application relates to the technical field of data processing more specifically to methods and apparatuses associated with secure provision of a digital content protection scheme.

The background description provided herein is for the purpose of generally presenting the context of the disclosure Unless otherwise indicated herein the materials described in this section are not prior art to the claims in this application and are not admitted to be prior art by inclusion in this section.

Secure playing of digital content often requires protection of the digital content when transmitted from a graphics unit to a display unit. Various schemes have been developed to protect the digital content from unauthorized copying during transmission e.g. high bandwidth digital content protection HDCP available from Digital Content Protection LLC of Beaverton Oreg. See HDCP Specification v1.4 published Jul. 8 2009 for further information. Protection schemes such as HDCP may be vulnerable when the operating system is vulnerable to compromise such as open source operating systems. The exposure may be increasing as more and more computing devices such as mobile computing devices hereinafter simply mobile devices like personal digital assistants smart phones tablet computers and so forth employ open source operating systems.

Methods apparatuses and storage medium associated with securely provisioning a digital content protection scheme are disclosed. In various embodiments a method may include forming a trust relationship between a media application within an application execution environment of a device and a security controller of the device. The application execution environment may include an operating system and the operating system may control resources within the application execution environment. Additionally the security controller may be outside the application execution environment enabling components of the security controller to be secured from components of the operating system. Further the method may include the security controller provisioning e.g. enabling and or configuring a digital content protection scheme for the media application to provide digital content to a digital content protection enabled transmitter within the application execution environment for provision to a digital content protection enabled receiver directly or via one or more intermediate digital content protection enabled repeater .

Various aspects of the illustrative embodiments will be described using terms commonly employed by those skilled in the art to convey the substance of their work to others skilled in the art. However it will be apparent to those skilled in the art that alternate embodiments may be practiced with only some of the described aspects. For purposes of explanation specific numbers materials and configurations are set forth in order to provide a thorough understanding of the illustrative embodiments. However it will be apparent to one skilled in the art that alternate embodiments may be practiced without the specific details. In other instances well known features are omitted or simplified in order not to obscure the illustrative embodiments.

Various operations will be described as multiple discrete operations in turn in a manner that is most helpful in understanding the illustrative embodiments however the order of description should not he construed as to imply that these operations are necessarily order dependent. In particular these operations need not be performed in the order of presentation. Further descriptions of operations as separate operations should not be construed as requiring that the operations be necessarily performed independently and or by separate entities. Descriptions of entities and or modules as separate modules should likewise not be construed as requiring that the modules be separate and or perform separate operations. In various embodiments illustrated and or described operations entities data and or modules may be merged broken into further sub parts and or omitted.

The phrase in one embodiment or in an embodiment is used repeatedly. The phrase generally does not refer to the same embodiment however it may. The terms comprising having and including are synonymous unless the context dictates otherwise. The phrase A B means A or B . The phrase A and or B means A B or A and B . The phase at least one of A B and C means A B C A and B A and C B and C or A B and C .

In various embodiments as described earlier processor and memory arrangement may be configured to enable OS and one or more media applications to be operated therein while processor and memory arrangement may be configured to enable authentication service and HDCP driver to be operated therein. Processor and memory arrangement is intended to represent a broad range of processor and memory arrangement including but are not limited to arrangements with single or multi core processors of various execution speeds and power consumptions and memory of various architectures with one or more levels of caches and of various types dynamic random access FLASH and so forth. Similarly media applications may be any application where parts of its operations involve playing digital media content on display unit .

In various embodiments graphics unit may be configured to provide graphics functions to media applications and OS while display unit may be configured to display outputs of media applications and OS . Further as described earlier graphics unit may include HDCP register and HDCP transmitter whereas display unit may include HDCP receiver configured to provide HDCP to digital content being played by media applications on display unit through graphics unit .

In various embodiments OS may include various conventional components including user mode graphics driver and kernel mode graphics driver configured to facilitate media applications and OS in using graphics functions provided by graphics unit . Further to better address the potential security vulnerability of graphics drivers and OS may further include user mode HDCP module and kernel mode HDCP module configured to facilitate media applications in playing digital content on display unit through security controller thereby providing better protection for the digital content when transmitted from graphics unit to display unit in particular from HDCP transmitter of graphics unit to HDCP receiver of display unit . To facilitate the use of user mode HDCP module and kernel mode HDCP module user mode graphics driver may be modified to route all HDCP related operations to user mode HDCP module instead. various embodiments security controller may provide a secured operating environment for authentication service and HDCP driver sequestering or sheltering authentication service and HDCP driver from components of OS . In other words OS including its components does not have access to the execution resources of security controller and therefore does not have access to authentication service and HDCP driver . In various embodiments authentication service may be configured to form a trust relationship with media application enabling security controller to route digital content of media application for media application to HDCP transmitter and ultimately to HDCP receiver . HDCP driver may be configured to drive HDCP transmitter and control its interactions with HDCP receiver including controlling HDCP transmitter in performing the various authentications under the HDCP scheme. In various embodiments user mode HDCP module and kernel mode HDCP module may be configured to provide pass through access to HDCP driver . Accordingly by virtue of the secured operating environment security controller provides for authentication service and HDCP driver in various embodiments OS may be an open source operating system.

In various embodiments user mode HDCP module may be configured to support a number of application programming interface API calls for user mode graphics driver to route HDCP related operations to user mode HDCP module . In various embodiments the API calls may include a call to enable HDCP call to disable HDCP a call to request HDCP status and a call to obtain the report back HDCP status. In various embodiments these API calls may be implemented in any high level languages such as C or assembly language supported by the processors of processor and memory arrangement .

In various embodiments user mode HDCP module and kernel mode HDCP module employ a number of buffers to pass data between the modules. In various embodiments kernel mode HDCP module includes a Read File function and a Write file function to retrieve data from and write data into security controller .

From block method may proceed to block where HDCP driver may detect whether display unit is attached. If present of display unit is not detected method may proceed from block to block then to block where authentication service may de establish the secure channel and end method . On the other hand if presence of display unit is detected method may proceed from block to block where HDCP driver may detect if a HDCP key has been loaded. On detection of the HDCP key having been loaded method may proceed to block . However if no HDCP key was detected method may proceed to block where HDCP driver may load a HDCP key before proceeding to block . At block HDCP driver may parse system renewability message SRM data from the HDCP enable request or other communications from media application for HDCP operation.

From block method may proceed to block where HDCP driver may determine whether the credential of HDCP receiver has been revoked or not. If the credential of HDCP receiver has been revoked by the credential authority of HDCP method may proceed from block to blocks and and terminate as described earlier. On the other hand if credential of HDCP receiver has not been revoked method may proceed to block where HDCP driver may drive HDCP transmitter to perform HDCP authentication part 1 with HDCP receiver .

From block on failure to authenticate HDCP receiver method may proceed to blocks and and terminate as earlier described. However on successful authentication of HDCP receiver method may proceed to block where HDCP driver may determine whether the HDCP receiver is a repeater. On determining that a HDCP receiver is a repeater method may proceed to block where HDCP driver may drive HDCP transmitter to perform HDCP authentication part 2 for repeaters.

On determining that a HDCP receiver is not a repeater or on successful authentication of a HDCP repeater method may proceed to block where HDCP driver may determine whether there are additional display units present. On determining that at least another additional display unit is present method may proceed to block to authenticate the HDCP receiver of the additional display unit or an intermediate repeater to the HDCP receiver of the additional display as described earlier.

On determining that all HDCP receivers of display units including any intermediate repeaters have been authenticated method may proceed to block where media application may route digital content to the authenticated HDCP receivers of the detected display units through the authenticated HDCP transmitter and or repeater . Routing of the digital content from the HDCP transmitter to the HDCP receiver may be encrypted. At block for video digital content HDCP driver may also drive HDCP transmitter and HDCP receiver to perform HDCP authentication part 3 for encryption and decryption of video digital content during vertical blanking intervals of the video digital content.

From block method may proceed to block where HDCP driver may detect for any HDCP part 3 authentication failure or end of play of the digital content by media application . If neither conditions are detected method may return to block and continue operations as earlier described. On the other hand if either a HDCP part 3 authentication failure or end of play is detected method may proceed to block where authentication service may de establish the secure channel between security controller and media application . Thereafter method may proceed to block where method may terminate.

Referring back to for one embodiment at least one of the processor s of processor and memory arrangement may be packaged together with computational logic configured to practice the method of . For one embodiment at least one of the processor s of processor and memory arrangement may be packaged together with computational logic configured to practice the method of to form a System in Package SiP . For one embodiment at least one of the processor s of processor and memory arrangement may be integrated on the same die with computational logic configured to practice the method of . For one embodiment at least one of the processor s of processor and memory arrangement may be integrated on the same die with computational logic configured to practice the method of to form a System on Chip SoC . For at least one embodiment the SoC may be utilized in a smart phone cell phone tablet or other mobile device.

Although specific embodiments have been illustrated and described herein it will be appreciated by those of ordinary skill in the art that a wide variety of alternate and or equivalent implementations may be substituted for the specific embodiments shown and described without departing from the scope of the embodiments of the present disclosure. This application is intended to cover any adaptations or variations of the embodiments discussed herein. Therefore it is manifestly intended that the embodiments of the present disclosure be limited only by the claims and the equivalents thereof.

