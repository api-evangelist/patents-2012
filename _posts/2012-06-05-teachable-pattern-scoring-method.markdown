---

title: Teachable pattern scoring method
abstract: A computerized teachable pattern scoring method receives a teaching image and region pattern labels. A region segmentation is performed using the teaching image to generate regions of interest output. A feature measurement is performed using the teaching image and the regions of interest to generate region features output. A pattern score learning is performed using the region features and the region pattern labels to generate pattern score recipe output. A computerized region classification method using the region features and the pattern score recipe to generate pattern scores output. A region classification is performed using the pattern scores and region features to generate region class output.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09152884&OS=09152884&RS=09152884
owner: DRVision Technologies LLC
number: 09152884
owner_city: Bellevue
owner_country: US
publication_date: 20120605
---
This work was supported by U.S. Government grant numbers 1R44HL106863 01 awarded by the National Heart Lung and Blood Institutes. The U.S. Government may have certain rights in the invention.

This invention relates to the biology image recognition and the pattern guided feature extraction step.

Computerized biology image recognition the computer characterization of regions containing biological objects such as colonies in cell cultures of induced pluripotent stem cells or embryonic stem cells individual cells and cellular and subcellular components bacteria viruses of interest etc. in microscopy digital images is a fundamental step in quantitative microscopy.

A typical computerized biology image recognition process consists of three major steps 1 a region segmentation step detects the regions of interest from an image 2 a feature measurement step extracts measures features measurements from the regions of interest and 3 a classification step uses features to classify the regions of interest into different types. The computerized biology image recognition allows automated or semi automated biological object recognition and typing. This enables studies of population statistics and image cytometry. It has broad applications in basic research cancer research toxicology and drug discoveries.

Currently most users perform computerized biology image recognition using standard image processing software such as Zeiss AxioVision Nikon s NIS Elements Olympus cellSens ImageJ Metamorph ImagePro Slidebook Imaris Volocity etc. custom scripts programming or by hand. However it is difficult to apply standard image processing software functions to perform biology image recognition. As a result the majority of biology recognition is performed either manually or using a simple intensity threshold followed by simple measurements and gating that has very limited applications. Some software supports plug ins. Yet plug ins developed in one lab for image recognition rarely work for the application of a second lab. The users have to modify the algorithm parameters or even the code itself. Computerized biology image recognition products have been developed for high content screening applications. However they are coupled to specific instrument platforms cell types and reagents. They are not flexible for broad applications.

The current immature microscopy biology recognition tools impose cost barriers on scientists and the image based scientific discovery process. The cost in skilled labor for manual recognition and custom script development is high. A greater cost is that of experiments foregone or data uncollected due to problems related to image recognition.

There are a large set of features such as size shape intensity and texture measurements that can be extracted from each segmented object for pattern classification. However many of them are raw measurements. For example the Fourier Descriptors FD provide a set of raw coefficients features that represent different curvature components of a shape. However complicated shapes cannot be discriminated by a few dominating features. They are best characterized by certain combinations of multiple features. It is difficult for human to determine the appropriate feature combinations for best characterization. A pattern recognition tool could automatically generate feature combinations by discriminate analysis. However it is difficult for human to understand or control adjust the automatically generated feature combinations.

The current invention allows users to teach different types of patterns for feature combination using teach by example approach. User can flexibly define basic pattern types that are meaningful and or they could identify visually. The teachable pattern scoring method of the current invention will automatically generate pattern scores from the teaching examples using a combination of raw features. The pattern scores for an object represent the similarity of the object pattern to taught patterns. Therefore user can easily evaluate pattern scores by their similarity judgment when viewing images. In this way user could identify scoring errors and could improve the pattern scoring by error correction teaching.

Many raw features can be selected for use with the teachable feature combination. The pattern scores can be used along with other features size shape intensity texture etc. for pattern classification.

The primary objective of the invention is to provide teachable pattern scoring method that combines features into scores of user taught patterns. The second objective of this invention is to provide meaningful feature combinations that users can evaluate and update. The third objective of the invention is to allow the flexible specification of user desired patterns. The fourth objective of the invention is to support the creation of pattern classifiers with understandable classification rules based on pattern scores.

A computerized teachable pattern scoring method receives a teaching image and region pattern labels. A region segmentation is performed using the teaching image to generate regions of interest output. A feature measurement is performed using the teaching image and the regions of interest to generate region features output. A pattern score learning is performed using the region features and the region pattern labels to generate pattern score recipe output. A computerized region classification method based on teachable pattern scoring receives at least one application image and pattern score recipe. A region segmentation is performed using the application image to generate regions of interest output. A feature measurement is performed using the application image and the regions of interest to generate region features output. A pattern scoring is performed using the region features and the pattern score recipe to generate pattern scores output. A region classification is performed using the pattern scores and region features to generate region class output.

The application scenario of the teachable pattern scoring method is shown in . It consists of a teaching phase and an application phase . As shown in the teaching phase inputs at least one teaching image . It performs a region segmentation step to detect at least one regions of interest from the teaching image . A feature measurement step measures features from regions of interest to generate at least one region features . A pattern score learning step inputs region features and region pattern labels that are entered from teaching and creates pattern score recipe . The pattern score recipe contains the instructions for a computer to perform pattern scoring method on region features to generate pattern scores during the application phase. The pattern scores for an object region represent the similarity of the object pattern to taught patterns.

As shown in the application phase inputs at least one application image . It performs a region segmentation step to detect at least one regions of interest from the application image . A feature measurement step measures features from regions of interest to generate at least one region features . A pattern scoring step inputs region features and pattern score recipe to generate pattern scores . The pattern scores along with the region features are processed by a region classification step to output region classes for the regions of interest .

An alternative embodiment of the teaching phase of the teachable pattern scoring method including update teaching is shown in . Under this embodiment at least one validation image is processed to assess the resulting pattern scores after applying the current pattern score recipe . The validation image should be different from the initial teaching image or contain new teaching regions of the same image. This creates at least one new regions of interest and at least one region features from the validation image . The region features are processed by the pattern scoring step using the current pattern score recipe to generate pattern scores for the regions of interest . The pattern scores for the validation image regions of interest may contain erroneous pattern scores that do not reflect the taught region patterns. This is corrected by an additional pattern labeling step to generate additional region pattern labels that may include representative regions with erroneous pattern scores. The additional region pattern labels their region features and the original current pattern score recipe are used by an pattern score update learning step to generate an updated pattern score recipe . The update teaching process could be applied multiple times on the same or a different validation image in an iterative fashion to update previous version of the pattern score recipe yielding the updated pattern score recipe in the current iteration.

Note that the teaching phase only needs to be performed once and the taught recipe can be applied multiple times for new images during the application phase. In a preferred embodiment of the invention the above application scenarios are implemented by a computer and the data are stored in computer memory or disks.

The region segmentation and feature measurement are the pre processing steps for both teaching and application phases of the teachable pattern scoring method.

Region segmentation step inputs at least one images and outputs regions of interest . It processes images containing objects and determines the regions of interest in the images corresponding to those objects. Region segmentation is the key to follow on processing in any imaging applications. If segmented object regions are incorrect the measurements performed on the segmented objects will certainly be incorrect and therefore any analysis and conclusion drawn based on the incorrect measurements will be erroneous and compromised.

For simple applications image thresholding is the standard method for region segmentation. This works on images containing bright objects against dark background or dark objects against bright background. This region segmentation method amounts to determining a suitable threshold value to separate objects from background. For images with multiple object types with high object boundary contrast edge detection methods are often used for object segmentation. In a preferred embodiment of the invention a versatile region segmentation method that can be trained to automatically perform region segmentation for almost all image processing applications is used See Lee JSJ et. al. Learnable object segmentation U.S. Pat. No. 7 203 360 Apr. 10 2007 .

The feature measurement step processes the at least one input image and the segmented regions of interest to generate a set of features for each region of interest. There are many feature measurements available from prior art including morphological features intensity features texture and contextual features etc.

Morphological features characterize region position size shape etc. Typical position features include centroid and bounding boxes. Typical size features include area perimeter major and minor axis lengths of fitting ellipse etc. There are many region shape features include compactness perimeters 2 area aspect ratio major axis minor axis roundness 4 area major axis 2 solidity area convex area and region boundary Fourier descriptors coefficients representing different curvature components of a shape etc.

Those ordinary skilled in the art should recognize that other morphological features could be used and they are all within the scope of this invention.

The features are derived from the grayscale intensity of an image. In addition to the original grayscale intensity a pixel neighborhood such as 3 3 5 5 7 7 etc. can be defined. The grayscale intensity statistics such as mean standard deviation skewness kurtosis and other statistics can be derived from the neighborhood. Moreover pre processing of the grayscale intensity can be performed before gathering the statistics. The pre processing includes point operations such as logarithm conversion for optical density measurement or filtering such as edge enhancement by linear or morphological gradient operator that includes dark edge bright edge and general edge enhancement etc.

When the input image is a color image color transformation may be applied to convert the color image into multi bands of grayscale images. In one embodiment of the invention the multiple bands includes the following images R Red channel G Green channel B Blue channel R G R G R R G B G R G B B R G B R G R B G B G R B G B R or hue saturation intensity HSI etc.

The intensity space features with and without pre processing can be generated for each band of the image. Those ordinary skilled in the art should recognize that other feature spaces such as temporal space or different focal planes could be used and they are all within the scope of this invention.

Those ordinary skilled in the art should also recognize that other intensity features could be used and they are all within the scope of this invention.

Texture features characterize the spatial dependency of the grayscale intensities in neighbors around each pixel. Typical texture features include co occurrence matrices based features such as moment contrast correlation entropy energy inertia etc. run length based features Laws texture energy measures and autocorrelation and power spectrum based features etc.

Contextual features characterize the spatial dependency of the grayscale intensities around a region and its surrounding neighbors. Typical contextual features include the contrast of region of inside and outside edges of the region. The contrast can be measured with all different intensity or texture features. The contrast can be measured using ratio or difference measurements.

Those ordinary skilled in the art should recognize that other texture and contextual features such as Gabor filtering or wavelet based features could be used and they are all within the scope of this invention.

The pattern score learning step is the essential process during the teaching phase. It consists of an optional feature selection step a pattern scoring model learning step and a pattern scoring model storage step as shown in .

In one embodiment of the invention the region pattern labels input is created by entering pattern types and label selected regions with the types. This could be performed by user when viewing the teaching image from a computer display. shows the processing flow for creating region pattern labels . A pattern type specification step allows the flexibly specification of pattern types by a user . For example in a stem cell application the region types could be normal shape colony irregular shape colony artifact etc. In one embodiment of the invention the pattern types are specified by a user from a computer GUI Graphical User Interface display. Some of the regions of interest can then be associated with pattern types by a region labeling step . In this way typical regions for each of the pattern types can be labeled. In one embodiment of the invention the region labeling step is conducted using a computer GUI display where regions of interest are displayed and a user can perform labeling by a simple clicking at the object to be labeled. The output of the region labeling step is the region pattern labels to be used for pattern score learning .

If region features include a large number of features the pattern scoring performance could degrade in the presence of irrelevant or redundant features. In one embodiment of the invention a feature selection step is applied before the pattern scoring model learning step .

Feature selection method selects a subset of features that could discriminate between regions of different pattern types . Feature selection reduces the dimensionality of the data to be processed by the scoring method that could reduce execution time and improve predictive accuracy.

In one embodiment of the invention the CFS Correlation based Feature Selection can be used for feature selection. The CFS algorithm is based on the following hypothesis a good feature subset is one that contains features highly correlated with predictive of the class yet uncorrelated with not predictive of each other. Other feature selection method such as Branch and bound method sequential forward selection method sequential backward selection method could also be used. In a hierarchical scoring method the feature selection can be performed by Lee JSJ et. al. Feature regulation for hierarchical decision learning U.S. Pat. No. 7 233 931 Jun. 19 2007.

Those ordinary skilled in the art should recognize that other feature selection methods could be used and they are all within the scope of this invention.

Given a set of labeled by pattern types region features selected or un selected for learning the pattern scoring method generates pattern scores using a combination of features through a pattern scoring model . The pattern scores for an object represent the similarity of the object pattern to taught pattern types .

To perform pattern scoring a pattern scoring model is first defined. The learning process will then determine parameters of the model based on the learning data.

In one embodiment of the invention a distance to center model is used for pattern scoring . illustrates the distance to center model in two dimensional space where the distributions of three pattern types and and their cluster centers and are shown. The samples from different pattern types are illustrated by different shapes diamonds vs. circles vs. triangles . The cluster centers and are illustrated by solid dark point of their corresponding shapes. This method can be directly generalized into N dimensional space where N is the number of region features used for learning. The pattern scoring model learning process determines the cluster centers of each pattern type from the N dimensional feature space. To determine cluster center for scoring determination a distance metric is needed. In one embodiment of the invention an Euclidean distance is used. In another embodiment of the invention the Mahalanobis distance is used. The Mahalanobis distance differs from Euclidean distance in that it takes into account the correlations of the data set and is scale invariant.

In one embodiment of the invention the pattern score for a given sample F can be calculated by the following rule 

Where Pattern Score F is the pattern score for pattern type i and Dist F is the distance metric value of the sample F to pattern type i. In the distance to center model the Dist F can be calculated as the distance between sample F and the cluster center of the pattern type i.

An alternative embodiment of the pattern scoring model includes multiple cluster centers for each pattern type multiple cluster centers model . The multiple cluster centers can be determined by first dividing each pattern type into multiple clusters. This can be done by clustering methods such as hierarchical clustering k means clustering fuzzy clustering etc. Each of the multiple cluster centers can be determined as the center of each of the multiple clusters. In the multiple cluster center model the distance Dist F is determined as

Where p is the number of clusters for pattern type i and Dist F is the distance between sample F and the cluster center k of the pattern type i.

A kernel based model could be used as the pattern scoring model in another embodiment of the invention where a pattern type is represented by multiple kernels and the score of a sample is the summation of all kernel values through a base distribution such as Gaussian . Parzen windows method is a typical kernel based model.

Those ordinary skilled in the art should recognize that other pattern scoring model such as nearest neighbor or decision tree models could be used and they are all within the scope of this invention.

To create pattern score recipe the parameters learned for pattern scoring model have to be stored into a computer file that can be loaded and applied during the application phase. This is accomplished by the pattern scoring model storage step . The parameters to be stored include the cluster centers covariance matrix values or normalization factors for the Mahalanobis distance metric. In addition to support the pattern score update learning either all training samples or some intermediate results will be stored. For example in the distance to center model the feature sum and feature sum of square can be stored for each pattern type to facilitate incremental model parameter update. The storage of the additional data for recipe update can be made as an optional step and the additional data only need to be retrieved during the update teaching process.

During the update teaching the additional pattern labeling can be performed using a computer GUI where regions of interest are displayed and user can perform labeling by simple clicking at the regions where pattern scores are incorrect. The additional teaching samples and additional region pattern labels are used to update the original current pattern score recipe . The pattern score update learning includes a pattern scoring model update learning step using region features additional region pattern labels and the pattern score recipe to generate updated pattern scoring model output. This is followed by a pattern scoring model update storage step using the updated pattern scoring model to generate updated pattern score recipe output .

In one embodiment of the invention the original teaching data is stored in the pattern score recipe . In this case the pattern scoring model update learning could be done with the same procedure as the pattern scoring model learning with the original and the additional data. In case that only intermediate results are stored the incremental update rules could be applied. For example the feature sum and feature sum of square can be incrementally updated without the original teaching data. The updated cluster centers and distance normalization factors can then be derived from the updated feature sum and feature sum of square.

The pattern scoring model update storage step can be performed with the same procedure as the pattern scoring model storage method .

During the application phase the pattern score recipe can be used on new sample derived from the at least one application image to calculate the pattern scores . The pattern scores along with the region features are processed by a region classification step to output region classes for the detected regions of interest . In one embodiment of the invention the decision tree classifier can be used for region classification see Lee JSJ et. al. Regulation of hierarchic decisions in intelligent systems U.S. Pat. No. 7 031 948 Apr. 18 2006. 

Those ordinary skilled in the art should recognize that other pattern classification methods such as artificial neural networks support vector machines nearest neighbor classifier Bayes linear Bayes quadratic Fishers linear classifiers etc. can also be used for region classification. They are all within the scope of this invention.

The invention has been described herein in considerable detail in order to comply with the Patent Statutes and to provide those skilled in the art with the information needed to apply the novel principles and to construct and use such specialized components as are required. However it is to be understood that the inventions can be carried out by specifically different equipment and devices and that various modifications both as to the equipment details and operating procedures can be accomplished without departing from the scope of the invention itself.

