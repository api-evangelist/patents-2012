---

title: Automated pre-processing of body-mounted magnetometer data from constellations of low earth orbit satellites for derivation of birkeland current signatures
abstract: A system, method and computer-readable medium for mapping magnetic activity for a current linking a planet's space environment to an ionosphere of the planet are disclosed. Magnetic field measurements of the current are obtained from a plurality of satellites orbiting the planet. A residual magnetic field is determined from the obtained magnetic field measurements. The determined residual magnetic field is arranged to create a time series for a selected location of a planet-centered coordinate system. The magnetic activity is mapped using the created time series for the selected location.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08686721&OS=08686721&RS=08686721
owner: The Johns Hopkins University
number: 08686721
owner_city: Baltimore
owner_country: US
publication_date: 20120419
---
This invention was made with U.S. Government support under the National Science Foundation under contract number 0739864. The U.S. Government has certain rights in the invention.

This application is related to prior filed U.S. provisional application No. 61 603 423 filed on Feb. 27 2012 which is incorporated herein by reference in its entirety.

The present disclosure relates to methods of detecting magnetic signals produced by electrical currents flowing between Earth s atmosphere ionosphere and space for the purpose of determining a distribution and intensity of the electrical currents. The present disclosure specifically relates to a system for obtaining time series of residual magnetic field measurements distributed globally over the Earth from a plurality of Earth orbiting satellites.

Geomagnetic storms generally related to solar activity generate currents electric and magnetic fields in the upper atmosphere of the Earth and can have effects on various operations on Earth and its space environment. Exemplary disruptions include disruptions to high frequency communications global positioning systems pagers and electrical power grids. The electric current systems associated with these atmospheric effects generate magnetic fields which can be detected from a low Earth orbit. Global maps of these upper atmospheric magnetic signals recorded continuously over an extended period of time may allow for the derivation and monitoring of these currents and their dynamics in order to prepare for and respond to such disruptive activity. Therefore the present disclosure provides a method and system for providing a global map of residual magnetic field signals above the ionosphere to provide global monitoring capabilities.

In one aspect the present disclosure provides a method of mapping magnetic activity for a current linking a planet s space environment to an ionosphere of the planet the method including obtaining magnetic field measurements of the current from a plurality of satellites orbiting the planet determining a residual magnetic field from the obtained magnetic field measurements and arranging the determined residual magnetic field to create a time series for a selected location of a planet centered coordinate system that maps the magnetic activity.

In another aspect the present disclosure provides a system for mapping magnetic activity in an upper atmosphere of a planetary object the system including a plurality of magnetometers configured to orbit the planetary object wherein at least one of the plurality of magnetometers is configured to measure a magnetic field of the planetary object along an orbital path of the at least one magnetometer and a processor configured to receive the magnetic field measurement from the at least one magnetometer determine a residual magnetic field over a plurality of time segments for the magnetometer from the magnetic field measurement and arrange the plurality of residual magnetic fields to obtain a time series of residual magnetic field data for a selected location of the planetary object to map the magnetic activity.

In yet another aspect the present disclosure provides a computer readable medium having instructions stored therein which when accessed by a processor enable the processor to perform a method the method including receiving magnetic field measurements obtained from a plurality of satellites orbiting the Earth in at least one orbital plane determining a residual magnetic field from the obtained magnetic field measurements arranging the determined residual magnetic field to create a record of residual magnetic fields over the at least one orbital plane and determining at least one map of magnetic activity in an atmosphere of the Earth using the record of residual magnetic fields over the at least one orbital plane.

The present disclosure is directed to a system and method for determining a current between the Earth space environment and its ionosphere atmosphere using magnetic field measurements. The method uses measurements of magnetic fields obtained from a plurality of polar orbit satellites orbiting the Earth. In one aspect the magnetic field measurements from the plurality of satellites are collected at a central processing station and merged to form a plurality of raw data time series wherein each first time series includes a time series of magnetic field measurements obtained for a selected satellite. The time series measurements can be compared to a model of an Earth magnetic field which can be a standard model to determine residual magnetic fields B which are departures from a main model field at the satellites. The residual magnetic fields can then be rearranged to obtain a second time series wherein a selected second time series corresponds to a residual magnetic field. The second time series is used to provide a global map over the Earth by collecting data over a given time span over the tracks of the satellites such that the slots in each orbit plane provide a continuous sampling over each orbit plane. The second time series can be stored to a computer readable medium or used to perform an operation in various scientific and industrial applications. In one aspect the second time series can be used to determine the currents between the Earth space environment and the atmosphere e.g. Birkeland currents in a real time basis. Dynamics in the mapped residual magnetic fields reflect corresponding dynamics in the field aligned currents or Birkeland currents flowing in and out of the Earth s ionosphere whose spatial and time development can then be determined.

More particularly the present disclosure includes the methods for deriving magnetic field signatures of said currents from a plurality of low Earth orbiting satellites in near polar orbits. The satellites send the data to a central processing station typically an Earth based location using one or more data packets. The data packets generally provide location and attitude information as well as magnetic measurements obtained via multi component magnetometers associated with the satellites. A processor at the central processing station collects time stamps and arranges the plurality of packets to obtain an array that includes a plurality of first time series related to magnetic field measurements. Each of the plurality of first time series corresponds to a selected satellite. An exemplary first time series can include magnetometer data vehicle position and vehicle attitude data etc.

At least one of the first time series and generally all of the first time series are compared to an Earth magnetic field model and a residual magnetic field data vector is obtained from a difference between the obtained magnetometer data and the Earth magnetic field model. In various embodiments the Earth magnetic field model is a time varying model such as the International Geomagnetic Reference Field IGRF model which is a standard mathematical description of the Earth s magnetic field. Comparing the Earth magnetic field model to the magnetometer data typically includes rotating the Earth magnetic field model from an Earth frame of reference into a coordinate system of the satellite using satellite attitude and position data sent from the satellite to the central processing station.

Determining the residual magnetic field further includes correcting magnetometer data using at least one of a gain orientation and orthogonality corrections which are specific to for each magnetometer and satellite. These corrections are generally derived and applied using magnetometer measurements obtained over a 24 hour period and are made prior to determining the preliminary residual magnetic field for a selected satellite.

The preliminary residual magnetic field provides a basis to evaluate the appropriate frequency band over which attitude data are used. A low pass filter is used to remove spurious high frequency noise from the attitude data. The suitable pass frequency for this filter is selected by performing the filtering operation over a range of pass frequencies and evaluating the stability of the filtered magnetic field residuals with respect to pass frequency. A stable residual magnetic field varies less than 10 per factor of 2 difference in the pass filter frequency. In various embodiments the selected pass frequency is about of an orbit.

The residual attitude data filtered at the selected pass frequency are then used to derive final magnetic residuals which are transformed into geophysically meaningful coordinate system such as an Earth centered inertial ECI coordinates.

Various methods may then be used to determine a quality of the final magnetic residual data. In one embodiment data quality factors DQ are determined for each residual magnetic fields time segments. In general the data quality factor is defined as a standard deviation of magnetic field residuals for a specific satellite and time segment divided by a mean standard deviation in the magnetic field residual for the same time segment from the plurality of satellites. Data having DQ values outside of a selected threshold are discarded. In various embodiments a residual magnetic field segment having a data quality factor DQ 1.3 is discarded. Discarded data segments are replaced with residual magnetic field data derived from neighboring or nearby satellites in the orbit plane of the satellite whose data were discarded.

The time series of final magnetic field residuals from the plurality of satellites are then merged into records for specified time intervals wherein the duration of the specified time intervals corresponds to at least a time between sequential satellites in a given orbit plane. The resulting merged records can represent continuously sampled final magnetic residuals over an entire orbital plane and correspond to a global sample of the magnetic signatures recorded over the time span of the record. The time step between each global magnetic field residual record is generally shorter than the time span represented by each record and is typically one quarter to one tenth of the time span represented by each record. The sequence of global magnetic field residual records represents a time series of magnetic signatures over the Earth. The series of global magnetic residual records may be stored to a computer readable medium and or accessed by various operators for evaluating the residual data to determine the dynamics of Birkeland currents and or remotely sense other currents that may be indicated by the magnetic residuals.

Data is sent from each satellite to a central processing station which in one exemplary embodiment is the Satellite Network Operations Center SNOC facility. The data is sent in packets called Event Response Messages ERMs that typically contain tri axial magnetic field measurement data position data and a plurality of attitude data which can include attitude sample data and interpolated attitude data derived from the attitude sample data as well as other data that may be suitable for derivation of magnetic signals due to natural phenomena. In addition various exemplary engineering flags such as torque rod operation and attitude control mode can be sent within the ERM or in alternate data telemetry streams. The ERM includes data obtained over a selected time segment. In an exemplary embodiment an ERM includes 74 magnetic field values sampled at evenly spaced times. In an exemplary embodiment the time spacing between magnetic field samples is 19.4 seconds or 2.2 seconds corresponding to ERM time spans of 24 minutes or 3 minutes respectively.

The ERM packets and other ancillary data are catalogued at the central processing station and reformatted packaged for electronic transmission to a central processing location according to individual satellite and compiled to form a first time series corresponding to the satellite. In one embodiment of the system the central processing location is the Science Data Center SDC operated by and residing at The Johns Hopkins University Applied Physics Laboratory. The exemplary time series is composed of data from multiple ERM packets into one hour files for each satellite. The central processing station generally performs the methods disclosed herein for determining a time series of final residual magnetic field for each satellite and merges the individual time series of final magnetic field residuals to derive a series of global magnetic residual records. Additionally the central processing station can send the determined time series and global magnetic residual records to a memory device a display and a user having an interest in the data.

Time series for each satellite can also be made for satellite information such as attitude data position data etc. The attitude time series is generally formed using a selected method of interpolation because the number of attitude measurements per packet is generally less than the number of magnetometer measurements per packet. In an exemplary embodiment attitude measurements are obtained about 7 times per ERM while magnetometer measurements are obtained about 74 times per ERM. The interpolation generally provides attitude data to correspond to each magnetometer measurement. In one embodiment the obtained attitude data can be interpolated using a piece wise cubic spline fit.

The raw magnetometer data of the satellite centered time series Sat Sat are corrected for various errors i.e. for calibration gain attitude interpolation errors etc. . An exemplary correction includes calibrating data from each satellite with a physical model of the Earth s magnetic field. The calibration provides consistency in measurements between all satellites. In an exemplary embodiment the magnetometers are calibrated to the IGRF model. In one embodiment the inter satellite calibration is conducted over a 24 hour time span of magnetometer data obtained over the plurality of satellites. The satellite calibration can include deriving a correction matrix C that determines a vector correction and a constant c that determines a scalar correction. The calibration includes performing multiple linear regression fits of 24 hours of magnetometer data obtained from each satellite. The correction matrix and correction constant can be derived by fitting the original residuals to linear functions of the IGRF field. That is C and c are determined by minimizing Eq. 1 where Brefers to a magnetic field measurement vector obtained in the isatellite body frame of reference and Bis the model field as rotated into the spacecraft body frame at the position of the measurement and the sum is over the 24 hour period. Once the correction matrix and scalar correction is derived for the 24 hour period for a selected satellite data the correction i.e. matrix C and scalar correction c is applied to the magnetometer data over the same 24 hour period using Eq. 2 to derive corrected initial magnetic residuals Eq. 2 The resulting corrected magnetometer time series Bis therefore corrected for scalar gain offset and orientation errors and results in data from the plurality of satellites being normalized to the same effective DC level.

Once calibration errors are removed the corrected magnetometer time series measurements are used to determine a selected processing for interpolated attitude data to derive final magnetic residuals. In various embodiments the initial residual magnetic fields are calculated as a difference between the corrected magnetometer measurements and the related model field IGRF rotated into the body frame of the satellite. Since rotating the model field into the body frame of the satellite is affected by errors in attitude data and the values of the residual magnetic fields are sensitive to errors in attitude data. A 1 error in attitude can result in an error in the residual magnetic field of nearly 1000 nT which is larger than typical magnetic signatures from field aligned currents in the upper atmosphere and is nearly as strong as the largest magnetic field perturbations due to magnetic storms flares etc. Thus in various embodiments a low pass filter is applied to the interpolated attitude data to derive of magnetic residuals that has a reduced correlation between the filtered magnetic residuals and the attitude data.

The filtered residual magnetic field data is then checked for quality. In an exemplary embodiment the data quality factor can be determined using Eq. 3 below 

Therefore in one aspect the present disclosure provides a method of mapping magnetic activity for a current linking a planet s space environment to an ionosphere of the planet the method including obtaining magnetic field measurements of the current from a plurality of satellites orbiting the planet determining a residual magnetic field from the obtained magnetic field measurements and arranging the determined residual magnetic field to create a time series for a selected location of a planet centered coordinate system that maps the magnetic activity. In an embodiment in which the planet is Earth the plurality of satellites further includes low Earth orbit satellites having polar orbits. The residual magnetic fields are determined from a difference between the obtained magnetic field measurement and a planetary magnetic field model. A model of the planet s magnetic field is rotated into a reference frame of at least one of the plurality of satellites in order to determine the residual magnetic field. In one embodiment attitude data associated with the residual magnetic field is filtered at a filter frequency that is selected to eliminate attitude noise. The method may further include the steps of i applying orientation gain and offset corrections to obtained magnetic field measurements at at least one satellite ii transforming a planetary magnetic field model into a body frame of reference of the at least one satellite and subtracting the transformed planetary magnetic field model from the obtained magnetic field measurements to obtain a magnetic residual vector in the body frame of reference of the at least one satellite and iii transforming the magnetic residual vector into a frame of reference of the planet. A quality factor may be evaluated for the plurality of residual magnetic fields. When the evaluated quality factor of the residual magnetic field meets a selected quality threshold the residual magnetic field may be removed from a selected slot and replaced with a generated residual magnetic field. The generated residual magnetic field may be generated from at least one of i a residual magnetic field from a satellite in an adjacent slot ahead of the selected slot along the orbital path and ii a residual magnetic field from a satellite in a slot behind the selected slot along the orbital path. An ionospheric disturbance can then be determined from the mapped magnetic activity. Determining the current linking the planet s space environment to the ionosphere of the planet generally uses the created time series of the residual magnetic field for the selected location of the planetary centered coordinate system.

In another aspect the present disclosure provides a system for mapping magnetic activity in an upper atmosphere of a planetary object the system including a plurality of magnetometers configured to orbit the planetary object wherein at least one of the plurality of magnetometers is configured to measure a magnetic field of the planetary object along an orbital path of the at least one magnetometer and a processor configured to receive the magnetic field measurement from the at least one magnetometer determine a residual magnetic field over a plurality of time segments for the magnetometer from the magnetic field measurement and arrange the plurality of residual magnetic fields to obtain a time series of residual magnetic field data for a selected location of the planetary object to map the magnetic activity. In an embodiment in which the planet is Earth the plurality of magnetometers is located on a plurality of low Earth orbit satellites. The processor is may be configured to determine the residual magnetic field from a difference between the obtained magnetic field measurement and a magnetic field model of the planetary object. The processor may be further configured to rotate the magnetic field model of the planetary object into a reference frame of the magnetometer. The processor may be further configured to filter attitude data of at least one of the plurality of magnetometers and select a filter to apply to the attitude data to reduce noise. In one embodiment the processor is configured to i evaluate a quality factor for the plurality of residual magnetic fields ii remove a residual magnetic field for a selected slot when the quality factor for the residual magnetic field meets a selected quality threshold and iii replace the removed residual magnetic field with a generated residual magnetic field. The processor can replace the removed residual magnetic field using at least one of i a residual magnetic field from a satellite in an adjacent slot ahead of the selected slot along the orbital path and ii a residual magnetic field from a satellite in a slot behind the selected slot along the orbital path. In one embodiment the processor is determines an atmospheric event from the determined magnetic activity. The system may further include an interface enabling an operator to determine an action using the mapped magnetic activity. In an embodiment in which the planet is Earth the processor may determine a current linking an Earth space environment to the atmosphere of the Earth using the created time series of the residual magnetic field for a selected location in an Earth centered coordinate system.

In yet another aspect the present disclosure provides a computer readable medium having instructions stored therein which when accessed by a processor enable the processor to perform a method the method including receiving magnetic field measurements obtained from a plurality of satellites orbiting the Earth in at least one orbital plane determining a residual magnetic field from the obtained magnetic field measurements arranging the determined residual magnetic field to create a record of residual magnetic fields over the at least one orbital plane and determining at least one map of magnetic activity in an atmosphere of the Earth using the record of residual magnetic fields over the at least one orbital plane.

While the foregoing disclosure is directed to the exemplary embodiments of the disclosure various modifications will be apparent to those skilled in the art. It is intended that all variations within the scope and spirit of the appended claims be embraced by the foregoing disclosure.

