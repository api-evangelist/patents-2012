---

title: Generating an OD matrix
abstract: Computers, a user equipment, a computer system, computer program products, and a method for a computer system are disclosed. In some embodiments, the method comprises the steps of: receiving user IDs, cell IDs and time stamps associated with the cell IDs and the user IDs; requesting and receiving, from a cell ID database, geographical coordinates corresponding to the cell IDs; finding stations and times for each user ID based on, at least in part, the geographical coordinates and time stamps associated with each user ID; exchanging the stations with a place for each one of the stations; generating at least one OD sub-matrix associated with each user ID based on, at least in part, places and times of arrival and departure associated with these places; and merging the OD matrices into an OD matrix.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08532648&OS=08532648&RS=08532648
owner: Telefonaktiebolaget L M Ericsson (Publ)
number: 08532648
owner_city: Stockholm
owner_country: SE
publication_date: 20120202
---
This application claims the benefit of U.S. Provisional Patent App. No. 61 515 482 filed on Aug. 5 2011 this application is also a continuation of International Application No. PCT EP2011 074312 filed on Dec. 30 2011. The above identified applications are incorporated by reference herein in their entirety.

The invention relates to a method computers a computer system a user equipment and computer program products associated with generation of an OD Origin Destination matrix.

Accurate estimation of origin start and destination hereinafter called OD estimation is of interest in a number of use cases. It is for example of importance as basic data when planning a public transport system and when planning investments in new infrastructure like railways trains roads and buses.

Today OD estimation is generally performed in one of two ways either by surveys among people or by using measurements of e.g. the number of road vehicles that passes a certain place link traffic .

Surveys have some advantages over other techniques. You can for example get information on why a trip has been conducted how many people that traveled in the same car and if they would have used public transportation if it had been available. A downside of surveys is that they are very expensive. Another downside with manually collected surveys is that people tend to forget how they traveled when they left their place of origin starting point when they arrived etc. Sometimes people also lie about their traveling for one or another reason. All in all this might not give a good foundation on which to build accurate estimations.

Link traffic flows can be obtained from measurement devices such as cameras and inductive sensors installed along most major roads and the data from these measurement devices could be used for OD estimation. Even though this is probably cheaper than surveys it still requires installation and maintenance of measurement devices. Also it can only give an OD estimation along roads where there are measurement devices installed and the result will only be a rough estimate.

The estimate is often in the form of a two dimensional OD matrix having for example the destinations on one axis and the origin on the other. The values in the matrix relate to the frequency of each O D pair e.g. how many vehicles that have started from a certain origin and where their trip ended in a certain destination. Typically there is an OD matrix for a certain period of time. Thus in a three dimensional matrix a third axis could represent a certain time period.

The idea of making an OD estimation with the help of a cellular telecommunications network has been disclosed in 1 N. Caceres et al. Deriving origin destination data from a mobile phone network IET Intell. Transp. Syst. Vol. 1 No 1 p 15 26 March 2007 and 2 K. Sohn and D. Kim Dynamic Origin Destination Flow Estimation Using Cellular Communication System IEEE Transactions on vehicular technology Vol. 57 No. 5 September 2008. In the two studies OD matrices are calculated or enhanced in a simulation model by use of cellular network data. An approach taken is to use cellular network data to get link traffic counts and then use the counts in the calculation of an OD matrix. A big advantage of the methods described in 1 and 2 from a privacy perspective is that it is very hard if not impossible to identify a single individual at least as long as the link traffic flows on busy roads is studied. A drawback with e.g. 2 is however that since handover information is used to estimate link traffic volume it can only be applied to mobile phones when in a call or sending receiving data. It can also only give a very approximate solution since the problem of finding OD matrices form traffic link counts is under determined. In their simulation they also assume that a mobile telephone is always connected to the closest base station which is a simplification which is not quite true.

Another approach of tracking people using mobile phones is disclosed in 3 Y. Asakura and E. Hato Tracking survey for individual travel behavior using mobile communication instruments Transportation Research Part C 12 273 291 2004. This article discloses a methodology where applications are installed on mobile communication instruments not mobile phones in order to collect data about which base station the mobile communication instruments are connected to. Using that data and an algorithm it is determined if a person is standing still or moving. A similar algorithm is also known from 4 J. H. Kang et al. Extracting Places from Traces of Locations Mobile Computing and Communications Review Volume 9 No. 3 July 2005. 3 never addresses the problem of having higher degree of sparse data which would be the case with data obtained in a cellular network today. In 3 special devices are used to collect data on the signal strength from nearby base stations at given regular and quite frequent times. The retrieved information is therefore much denser in time than in a network with cellular telephones for consumer use. Furthermore there is no aggregation of data into something that could be utilized for OD estimation especially there is no generation of an OD matrix.

An object of the invention is to solve or at least contribute to a solution of the problem of creating a completely computerized solution for the generation of an OD matrix from data from one or more cellular telecommunications network.

The invention relates to a computer for supporting generation of an OD matrix based on at least in part network data associated with a plurality of user IDs. In one embodiment the computer comprises a receiving unit for receiving a user ID cell IDs and time stamps associated with the cell IDs and the user ID a requesting unit for requesting and receiving from a cell ID database geographical coordinates corresponding to a cell ID a station identification unit for finding stations and times based on at least in part the geographical coordinates and time stamps a mapping unit for exchanging the stations with a place for each one of the stations an OD matrix generating unit for generating at least one OD sub matrix associated with the user ID based on at least in part places and times of arrival and departure associated with the places and a sending unit for sending the OD sub matrix to another computer. Hereby is achieved that an OD sub matrix for one or more user IDs can be generated and sent for merging of a plurality of OD sub matrices into an OD matrix. This can be done irrespective of how and where the network data is created. Since network data from at least one communications network is used a large amount of data can be used thus making the OD matrix useful for a more variety of purposes than they are today.

The invention also relates to another configuration of a computer for supporting generation of an OD matrix based on at least in part network data associated with a plurality of user IDs. In some embodiments this computer comprises a receiving unit for receiving a user ID associated geographical coordinates and time stamps associated with the geographical coordinates and the user ID a station identification unit for finding stations and times based on at least in part the geographical coordinates and time stamps a mapping unit for exchanging the stations with a place for each one of the stations an OD matrix generating unit for generating at least one OD sub matrix associated with the user ID based on at least in part places and times of arrival and departure associated with the places and a sending unit for sending the OD sub matrix to another computer.

The computers mentioned above may comprise a time adjustment unit for adjusting times of arrival and or departure from the stations by a linear extrapolation based on at least in part data time stamped between the stations. Hereby is achieved that more accurate times for arrival and departures from stations are enabled thus improving the accuracy of the OD matrix.

The computers may comprise a clustering unit for clustering the stations into at least two clusters and a calculation unit for calculating for each one of the clusters a position of a new station based on at least in part the stations belonging to the same cluster and wherein the mapping unit instead of exchanging the stations exchanges the new stations with the respective place. Hereby the number of stations can be reduced and the accuracy of the OD matrix can be improved. The OD sub matrices and OD matrices also becomes easier to understand and analyze both by humans and machines.

The station identification unit may be configured to determine a geographical position associated with each time stamp for a user ID as either a first condition indicating that a user equipment associated with the user ID is moving or a second condition indicating that the user equipment is stationary and create a station if the geographical position is determined to be in the second condition with respect to a first time stamp and is determined to be in the first condition with respect to a second time stamp immediately following the first time stamp and the second condition preceding a change to the first condition has been maintained for a longer time than a time threshold. Hereby is achieved that an unnecessary number of station generations can be avoided. This increases the accuracy size and usefulness of the OD matrix.

The station identification unit may also be configured to calculate a mean value for the geographical position of the station based on at least in part consecutive geographical positions related to the second condition. Hereby is achieved that the geographical position of a station can be determined more accurately thus improving the accuracy of the OD matrix. In this case the station identification unit may be configured to calculate the mean value also based on at least in part the time between the time stamps associated with the second condition in such a way that a longer time between two consecutive geographical positions gives a higher influence on the mean value than if the time would have been shorter. Hereby is achieved that account is taken for real life situations where the network data associated with a user ID may be sparse. For example when a user equipment for wireless telecommunication is in active mode either in a call or sending data the base station the user equipment is connected to is typically logged twice a second in network but when the phone is in idle mode the information on which base station the user equipment is connected to is only logged about once an hour this varies between carriers but is usually between 20 minutes and 2 hours .

The invention also relates to a computer system comprising at least one computer according to the two alternative main computer configurations above.

The computer system may utilize Hadoop map reduce for generating the OD matrix. In that case the computer system comprises a master computer connected to the at least one computer which in the computer system then is a slave computer. Hereby an architecture that is scalable is achieved thus enabling the processing of big network data sets which in turn improves the accuracy of the OD matrix.

Furthermore the invention relates to a method performed by a computer system for generating an OD matrix based on at least in part network data associated with a plurality of user IDs. In some embodiments the method comprises the steps of receiving user IDs cell IDs and time stamps associated with the cell IDs and the user IDs requesting and receiving from a cell ID database geographical coordinates corresponding to the cell IDs finding stations and times for each user ID based on at least in part the geographical coordinates and time stamps associated with each user ID exchanging the stations with a place for each one of the stations generating at least one OD sub matrix for each user ID based on at least in part places and times of arrival and departure associated with the places and merging the OD sub matrices into the OD matrix.

The method may comprise the step of adjusting times of arrival and or departure from the stations by a linear extrapolation based on at least in part data time stamped between the stations.

The method may comprise the steps of clustering the stations into at least two clusters and calculating for each one of the clusters a position of a new station based on at least in part the stations belonging to the same cluster and instead of exchanging the stations exchanges the new stations with the respective place.

Moreover the invention relates to a user equipment e.g. a mobile telephone for supporting generation of an OD matrix based on at least in part network data associated with a plurality of user IDs. The user equipment comprises a unit for receiving or retrieving geographical coordinates and associated time stamps a station identification unit for finding stations and times a mapping unit for exchanging the stations with a place for each one of the stations an OD matrix generating unit for generating at least one OD sub matrix based on at least in part places and times of arrival and departure associated with these places and a sending unit for sending the OD sub matrix to a computer system.

The unit for receiving or retrieving geographical coordinates and associated time stamps may also be configured to receive or retrieve a user ID associated with the user equipment or a user of the user equipment. The sending unit may be adapted to send the user ID along with the OD sub matrix.

The user equipment may comprise a time adjustment unit for adjusting times of arrival and or departure from the stations by a linear extrapolation based on at least in part data time stamped between the stations.

The user equipment may comprise a clustering unit for clustering the stations into at least two clusters and a calculation unit for calculating for each one of the clusters a position of a new station based on at least in part the stations belonging to the same cluster and wherein the mapping unit instead of exchanging the stations exchanges the new stations with the respective place.

The invention also relates to a computer program product for generating an OD matrix based on at least in part network data associated with a plurality of user IDs. In some embodiments the computer program product comprises a non transitory computer readable medium storing a computer program for execution by a processor. In some embodiments the computer program includes code units for requesting from a cell ID database geographical coordinates corresponding to the cell IDs code units for determining for each of a plurality of user IDs stations based on at least in part geographical coordinates and time stamps associated with each user ID code units for exchanging the stations with a place for each one of the stations code units for generating at least one OD sub matrix associated with each user ID based on at least in part places and times of arrival and departure associated with the places and code units for merging the OD sub matrices into the OD matrix.

The invention also relates to a computer program product for supporting generation of an OD matrix based on at least in part network data associated with a plurality of user IDs. In some embodiments the computer program product comprises a non transitory computer readable medium storing a computer program for execution by a processor. The computer program may include code units for receiving or retrieving geographical coordinates and associated time stamps code units for finding stations code units for exchanging the stations with a place for each one of the stations code units for generating at least one OD sub matrix based on at least in part places and times of arrival and departure associated with the places and code units for sending the OD sub matrix to a computer system.

The embodiments below cover various modifications and alternative implementations and will hereinafter be described in detail. However it is to be understood that the detailed description and drawings are not intended to limit the general inventive idea to the specific forms disclosed.

Embodiments for generating OD matrices using telecommunications network operator data information in the following called network data will be disclosed in the following. The telecommunications networks could of course be a GSM Global System for Mobile Communications network a UMTS Universal Mobile Telecommunications System network an LTE Long Term Evolution network or any future telecommunications network according to e.g. any 3GPP 3rd Generation Partnership Project telecommunications standard. An important component for building knowledge of human mobility is to discover where and when people or vehicles go from one specific place to another specific place. From the network data knowledge of human mobility can be drawn and the network data could therefore be used for a number of different use cases purposes. A technical problem solved by at least one embodiment described herein is how useful information data about origin and destination of trips as well as their numbers can be extracted from the network. Another technical problem solved by at least one embodiment described herein is to enable ways of making it easier for people to draw conclusions about how people and vehicles travel based on at least in part network data. The raw network data is available but until this invention the methods and means of how to extract this information did not exist.

Throughout this document the word plurality shall be interpreted as at least two . Other terms that are used below include 

A more detailed embodiment of the method is illustrated in . In the illustrated embodiment the method is implemented with the help of a distributed computer system . The network data is here streamed from a first computer server which may be owned by a cellular network operator to a second computer server . The second computer here belongs to the computer system and distributes the network data among a group of third computer servers which also are comprised in the computer system . The distribution is thus scalable and more easily adapted to large amount of data in that the third computers can work in parallel. One way for the distribution is to utilize implement Hadoop map reduce with a master computer as jobtracker. The master computer may belong to the computer system as well and in such an embodiment uses both the second computer and the third computers as slaves tasktrackers. The number of parallel third computers may be every number from two computers to several thousands using Hadoop map reduce. As also indicated in the master computer also communicates with at least one fourth computer for merging aggregating OD matrices for a plurality of user IDs. The fourth computer is in this Hadoop example also a slave and belongs to the computer system . In one embodiment an Hadoop cluster of computers are used where each slave computer process data associated with several user IDs. As also should be clear to the person skilled in the art of Hadoop implementation the second computer and the fourth computer typically are not computers that only distribute tasks and merge OD matrices respectively but they could also perform tasks which in the following are described as being performed by the third computers . In other words one or more of the third computers may also perform the tasks which in the following are described as being performed by the second computer and the fourth computer respectively.

Even if steps B and B are illustrated as being performed by the third computers in these steps may in other embodiments of the computer system be performed by one or more separate computers not shown which send the user IDs the time stamps and the geographical coordinates to associated third computers .

In a step B illustrated both in stations are found among the network data and the associated geographical coordinates received from the cell ID database . In other words the trips are here found without any knowledge of the location of any cities etc. This step B comprises the finding of all stations made by each user of course supposing that each individual carry their mobile UE. Input network data available for the user is evaluated including user ID time stamps and corresponding longitude and latitude. All stations associated with the user UE are then output from this step function. Finding trips might seem like an easy task but the input data may be very sparse and with much fluctuations even if a person is perfectly still. It has for example been noticed that even in a stationary condition the UE may switch base station up to 6 times with only a few seconds connected to each base station.

An embodiment of this step B is illustrated in more detail in . The step B is here an iterative process and defines each point i.e. each geographical position associated with a time stamp for the user ID as either a first condition here referred to as moving or a second condition here referred to as stationary . As indicated in a sub step B if a previous point in time i 1 in is a moving point then the new point i in is defined as stationary if it is geographically close enough to the previous point i.e. a geographical distance D between the points is within a predetermined first distance threshold d. As indicated in a sub step B if the previous point is stationary then the current new point is stationary if it is close to a mean value position A in of all stationary points preceding it and if there is no moving points in between. In other words the current point is stationary if the previous point i 1 is stationary and the distance D between the position of the current point i and the mean value position A of all the other stationary points after the last moving point is within a second distance threshold d.

If the previous point is a stationary point and the new point is defined as moving a station is created if the UE has been stationary longer than a certain time threshold T. In other words the time difference between the current point and the earliest stationary point after the last previous moving point is here compared with the time threshold T and if the time difference is larger than the time threshold T the station is created. This is indicated as sub step B in . In an alternative embodiment of the sub step B the time difference is calculated as being the time between the time of the earliest stationary point after the last previous moving point and the time of the point just before the current moving point. The geographical coordinates of the station is set as the mean value A. This embodiment of step B thus has three variable parameters two distance thresholds d and d and one time threshold T. The skilled person understands that the optimal values for the distance thresholds d and d and the time threshold T can be set according to a specific use case and or geographical area. The skilled person appreciates that there would or at least could be differences between a rural area and a big city area. The distance thresholds d and d may have the same value in one embodiment of step B. In one embodiment the distance thresholds d and d are set to 1000 meters and the time threshold T to 10 minutes. It should also be mentioned that more thresholds may be used in other embodiments of step B for example an additional time threshold which has to be passed for two stations to be counted as two separate stations. Another example is to add a minimum travel time or a minimum travel distance as another or additional way of separating stations in time or distance.

Since A here is a vector the calculation is done over each vector component i.e. with respect to at least longitude and latitude.

All the generated stations together with the associated arrival times and departure times and user ID from each one of the stations are output from step B.

Since there are a lot of fluctuations in a cellular telecommunications network and its generated network data even if a person is standing still the distance thresholds d and d may have to be set quite long in order to not erroneously determine a stationary user UE as moving. Therefore when a user starts moving with his her UE he she might be classified as stationary for a while longer than he is in reality. Hence the actual time of departure and arrival might not accurately correspond to the time between a stationary point and a moving point determined in step B. In an optional tuning step B the departure times and arrival times are re determined fine tuned adjusted. By analyzing the points belonging to a station it is possible to better predict when the user actually left the place. One way of doing this is by utilizing an extrapolation method e.g. a linear extrapolation as illustrated in . In the illustrated example the X axis is time and the Y axis is distance. All the white points are points based on at least in part the received network data and the determination of stations and times of arrival and departure in step B. If a departure time from station A would have been determined based on at least in part the white points it would be about 13 00 and the arrival time at stations B would be about 15 00. However with the illustrated linear extrapolation based on at least in part the white points in between the departure time from station A would be about 13 15 and the arrival time at station B about 14 15. The use of the linear extrapolation could in step B be used for fine tuning the arrival and departure times of all trips but in other embodiments of the optional step B be utilized for trips which fulfills certain criteria such as trips having a length above a certain time threshold and or having a certain number of moving points between the two stationary points. In the number of moving points is six.

Sometimes the points might be very sparsely distributed in time and there might only be a few points defining a station. This may result in a very or relatively poor estimate of where the user has been stationary. Since a user often visit a place more than once all stations belonging to a user may be compared to determine more accurately where the user actually has been. This is done with the help of the optional step of B. As input the function step takes all the stations identified in step B and belonging to a user ID. The stations are then grouped together using a clustering method e.g. any clustering method where the number of clusters does not have to be specified beforehand. A suitable clustering method is a mean shift clustering. The advantage of the mean shift clustering method is that it doesn t require any a priori knowledge of the number of clusters and does not constrain the shape of the clusters. More information about the mean shift clustering could be retrieved e.g. from http homepages.inf.ed.ac.uk rbf CVonline LOCAL COPIES TUZEL1 MeanShift.pdf retrieved on 14 Jul. 2011 and hereby incorporated by reference.

Examples of alternative clustering methods are density clustering methods and hierarchical clustering methods. Step B may in one embodiment be performed before or in parallel with the tuning step of B even though it is illustrated in as being performed after the tuning step B. The clustering step B may be configured in such a way that it rather fails to group two stations that should be grouped together than grouping two stations that should not be grouped together.

In embodiments where step B is performed a seventh step B follow in which each cluster is determined to be a new station which replaces the stations on which it is based i.e. the stations generated in B. The position of the new station cluster may be calculated in this step B to be the mean position of the positions of all stations from step B included in the same cluster. All the new stations as well as their calculated position and time of arrival and departure are forwarded to the next step B.

In order to make an OD matrix which is relatively easy for a human to understand the stations have to be aggregated into something that is easier to overlook and draw conclusions from. This can be done in two different ways either with or without a priori knowledge about what places to look at.

The advantage of having defined what places to look at is that the assigning of a station from either step B B or step B in dependence of embodiment to a place is easy and fast and there is always a name for each place assuming that names are provided. The disadvantage is that stations might be grouped together into a place in a way that doesn t really reflect the way they might be intuitively clustered in the real world by a human or organization company.

What places to look at can either be defined manually or obtained from one or more GIS Geographic Information System for example OpenStreetMap Google earth and Google maps. In the GIS has been illustrated as being hosted by an external server but it might of course be hosted by one or more of the third computers or another computer of the computer system . API messages or HTTP messages may typically be used in the communication with the GIS e.g. one of the APIs for Google map.

In this eighth step B the third computers maps each station i.e. either the new stations from step B or the station from step B or B in dependence of embodiment to one of the provided places. The skilled person understands that there are different ways to do it. For example if the provided places from the GIS are provided with longitude and latitude the places will be associated with stations if the geographical coordinates of the stations are within a certain distance from the position of the place. Another way is to just assign each station to the nearest place. The skilled person appreciate that there are other ways of doing this as well but it should be made clear that not all embodiments of this step requires that all stations should map to a place. Some stations may simply be regarded as not being related to any place and therefore should or could be removed.

In a ninth step B at least one OD sub matrix is created by the third computer . One way of generating an OD sub matrix is to create a square matrix with element at position i j representing the number of trips between the place with index i and the place with index j. To save more information from the previous steps a separate OD sub matrix can be created for each time period of interest. For example one OD sub matrix can be created for all trips starting between 07 00 and 08 00 on a weekday in January and another OD sub matrix for all trips starting between 14 00 and 15 00 on weekends in March etc.

How to aggregate the time intervals could either be manually defined using a configuration file or by monitoring statistics from the data stream node i.e. the first computer . The statistics may make it possible to discover that there are certain patterns in the ability to move in the data sets. Based on this data a certain number of groups may be defined such as night morning morning traffic lunch evening traffic evening etc. This information may help to aggregate the data into more realistic groups rather than by a hardcoded split on hours. It should be recalled from the above discussion about different Hadoop implementations that even if at least one OD sub matrix is generated for a user ID in one of the third computers and that the OD sub matrix then is forwarded to the fourth computer see a tenth step B below there are alternative embodiments where the OD sub matrix is temporarily stored in the third computer in order to await the generation of further OD sub matrices for other user IDs in the same computer and that the computer then merges a plurality of its generated OD sub matrices for the different user IDs into a more aggregated OD sub matrix.

In the tenth step B the third computers send their OD sub matrices to the fourth computer which in an eleventh step B merges OD sub matrices from the third computers into at least one OD matrix . In an Hadoop implementation the merging can be seen as the reduce phase of Hadoop map reduce.

In a twelfth optional step B the merged OD matrices of step B are stored in a non volatile memory in the fourth computer and or a further computer not shown .

In an optional thirteenth step B the OD matrices are used in some ways. One such use could be to make them available for display on a computer screen or be printed on paper. Other types of use could be to retrieve the OD matrices from the non volatile memory and use the OD matrix data as input to an application for further graphical processing in order to for example show the most used origins and destinations on a map or other ways of visually showing the most popular trips made by people at a certain time interval.

Another use case is for the purpose of planning the building of infrastructure such as metros and monorails to support the need of transportation in high density populations and big cities like Chennai India. Right now the knowledge of trips in Chennai is collected by people who manually count cars in cross roads. This is costly and takes a long time compared to the utilization of information according to the general principle outlined in this description where information about how people travel is derivable from information already inside the network data.

Other ways of utilizing the OD matrices is to plan car pooling and so called school pooling where students living in the same area pool their ride in a taxi like way of transportation. Yet other use cases are decisions for building of bridges and crossings identification of unprotected railroad crossings and optimization of time schedules for bus routes. Still other use cases are the planning of tracks and rescue stations in rural and or mountainous areas where the network data can be really sparse and positions be relatively inaccurate due to for example large network cells.

The data required for the general method above is already collected in the cellular network and doesn t require any extra installations on the UE. Infrastructure and information already present is thus used increasing the value of the infrastructure and the information.

The comparison between trips made by a single user results in a more accurate estimation of the location where the user is stationary. The aggregation of the stations and mapping into places make the data more easily accessible and has as a useful side effect in that it makes it much harder to identify a single individual.

The third computers illustrated in comprise units in dependence of the above described embodiments of the method illustrated in . Thus each one of the third computers may comprise the following units as illustrated in A a receiving unit for receiving user ID s cell IDs and time stamps associated with the cell IDs and user IDs i.e. for performing step B B a requesting unit for requesting and receiving from an external or internal cell ID database geographical coordinates corresponding to a cell ID i.e. performing steps B and B C a station identification unit for finding stations and times i.e. performing step B D a mapping unit for exchanging stations from the station identification unit or from step B or new stations form step B with a place i.e. according to step B E an OD sub matrix generating unit for generating at least one OD sub matrix based on at least in part places and times of arrival and departure associated with these places i.e. according to step B and F a sending unit for sending the OD sub matrix to another entity such as the fourth computer i.e. according to step B .

Alternatively or in addition thereto the receiving unit can be adapted to receive geographical coordinates associated with the time stamps and user IDs.

The third computers may also comprise the following units in dependence of embodiment A a time adjustment unit for adjusting times of arrival and or departure from stations i.e. according to step B B a clustering unit for clustering stations i.e. according to step B C a calculation unit for calculating a position of a new station based on at least in part clustered stations i.e. according to step B and D a merging unit for merging one or more OD sub matrices associated with different user IDs.

The merging unit may not only be adapted to merge OD sub matrices created in the third computer but may also be adapted to merge sub matrices originating also from other third computers even in order to create the OD matrix . Thus the third computer as implied above in the description of the Hadoop implementations may act as both a third computer and the fourth computer .

Furthermore the third computer in comprises at least one computer program product in the form of a non volatile memory or volatile memory e.g. an EEPROM Electrically Erasable Programmable Read only Memory a flash memory a disk drive or a RAM Random access memory . The computer program product comprises a computer program which comprises code units or computer instructions which when run on the third computer causes the third computer to perform the steps according an embodiment of the method. In slightly other words the computer program product comprises computer readable code means on which the computer program is stored. Hence the computer program comprises at least six modules corresponding to the units respectively in order to perform the steps B B and B B when run on the processing unit . The computer program may also dependent on embodiment comprise one or more of the four modules corresponding to the four units in order for the third computer to perform also one or more of the steps B B and the step of merging OD sub matrices into a more aggregated OD sub matrix or the OD matrix generated according to step B. In other words when the different modules are run on the processing unit the processing unit together with the modules in this embodiment is the receiving unit requesting unit the station identification unit the time adjustment unit the clustering unit the calculation unit the mapping unit the OD sub matrix generating unit the sending unit and the merging unit respectively. Although the units in the embodiment disclosed above in conjunction with are implemented as computer program modules at least one of the units of may in alternative embodiments be implemented at least partly as hardware circuits.

Another way of describing an embodiment of the third computer is to say that it is a computer comprising the processing unit connected to the input unit and the output unit wherein the processing unit is configured to perform at least the following functions A receive a user IDs cell IDs and time stamps associated with the cell IDs and user IDs i.e. for performing step B B request from an external or internal cell ID database geographical coordinates corresponding to a cell ID C receive the geographical coordinates from the cell ID database D find stations and tags associated with the stations where the tags comprises arrival time and departure time from these stations E replace map the stations with places F generate at least one OD sub matrix based on at least in part places and times of arrival and departure associated with these places G send the OD sub matrix to another computer.

In one embodiment the processing unit would also be configured to perform the functions A adjust the arrival time and or departure time from the stations B cluster the stations into different clusters C calculate a position of new stations the position of each new station being based on at least in part stations in the same cluster to which the new station correspond and D replace map the new stations instead of the original stations with the places.

The third computer may of course also store OD matrices or OD sub matrices in the computer program product or in another memory .

The above described embodiments of a method computers and the computer system may of course be combined with other steps intended to further improve the accuracy relevance of the OD matrix . Such additional steps could be to also take into account information provided by social networks such as so called check in announcements by users UEs via social network applications belonging to e.g. Facebook Foursquare Gowalla and Google .

Having described a method being performed with the help of the computer system comprising e.g. the second computer one or more third computers and the fourth computer and in the case of a Hadoop implementation also the master computer another embodiment of the method shall now be described in conjunction with . In this embodiment a part of a method for generating OD sub matrices is performed in a UE or rather more than one UE in parallel in order to get OD matrices comprising trips made by more than one person.

An advantage of this embodiment in comparison with the processing of stations etc in the third computers is that accurate positions can be more easily utilized by the method with the help of A satellite based positioning systems such as GPS Global Positioning System Galileo Glonass and COMPASS Beidou B local area networks and or C proximity sensor systems such as RFID tags NFC Near Field Communication tags associated with physical objects such as buildings and shops.

Another advantage is that in use cases where the altitude is of interest it can more easily be retrieved from e.g. a GPS signal receiver and or an altitude meter air pressure meter in the telephone. Still another advantage is that it enables the sending of an individual OD matrix instead of raw data which means that bandwidth costs are reduced and that the users can keep more raw data to themselves and hence reduce privacy risks. A drawback is that in practice in so called smartphones today an application has to be installed in the UE which means that the number of people on which OD matrices are based may be smaller than what would typically be possible in the embodiments described in conjunction with .

In an embodiment in which cell IDs are utilized e.g. with the purpose of saving energy in comparison with a utilization of GPS the UE does not have to get the network data from the second computer but it already knows the cell ID of the current cell. In such an embodiment the UE retrieves in a step C the already in the UE stored cell ID of the network cell in which the UE currently is positioned. Then in a step C the cell ID is sent to the cell ID database in a similar way as in step B and receives the corresponding geographical coordinates in step C in a similar way as in B.

In an alternative embodiment where GPS or a similar satellite based system is utilized the geographical coordinates are retrieved from a GPS receiver unit in the UE. This is illustrated as step C in .

A step C corresponds to step B. The positions of the UE can be input to the function of step C at regular intervals and or triggered by predetermined events such as when the UE changes cell or when an accelerometer comprised in the UE indicates a value above a certain acceleration threshold. Another trigger could be the passing of a certain speed threshold by comparing the speed threshold with an instantaneous speed calculated by a speed calculation unit of e.g. a navigation system.

As indicated in the output from the step C may be the user ID origins destinations arrival times and departure times. However since it usually can be assumed at least for a fairly long period such as a couple of months that the user associated with the user ID has not changed the user ID may not have to be involved in any of the following steps except perhaps in a last step C where at least one OD matrix is sent to a computer for merging of OD sub matrices from different UEs. It may of course also be assumed in an embodiment where the IMEI is used as the user ID that the user ID never changes and the user ID does in that case in some embodiments never have to be checked at all by the merging computer since the merging computer does not have to know from which users received OD sub matrices come from.

A step C corresponds to step B. Here the GIS is illustrated as being a system in communication with the UE but the system may in the form of for example a navigation system be stored in the UE itself. C corresponds to step B and C corresponds to step B. As touched upon above the step of sending one or more OD sub matrices from the UE to a merging computer such as the fourth computer may or may not involve the sending of the user ID along with the OD sub matrices.

The UE illustrated in comprises different units in dependence of the above described embodiments of the method illustrated in . The UE therefore comprises the following units A a unit for receiving or retrieving geographical coordinates associated time stamps and optionally an associated user ID B the station identification unit for finding stations and times i.e. performing step C C the mapping unit for exchanging the stations or the new stations with a places respectively i.e. according to step C D the OD matrix generating unit for generating at least one OD sub matrix based on at least in part places and times of arrival and departure associated with these places i.e. according to step C E the sending unit for sending an OD sub matrix from the UE to an external entity for merging with other OD sub matrices from other UEs wherein the sending unit here may or may not be adapted to send an associated user ID along with the OD sub matrix i.e. according to step C. The external entity may be a computer of the computer system adapted to merge OD sub matrices into the OD matrix .

The UE may according to the description above in conjunction with also comprise one or more of the following units sensors and system A a signal receiving unit for a satellite based position system B an accelerometer C an altitude sensor D a navigation system E the time adjustment unit for adjusting times of arrival and or departure from stations i.e. according to step C F the clustering unit for clustering stations i.e. according to step C G the calculation unit for calculating a position of a new station based on at least in part clustered stations i.e. according to step C.

Furthermore the UE comprises at least one second computer program product in the form of a non volatile memory e.g. an EEPROM Electrically Erasable Programmable Read only Memory a flash memory and a disk drive. The second computer program product comprises an optional navigation system computer program and a computer program for generation of an OD sub matrix according to at least one of the embodiments illustrated in conjunction with steps C C. The computer program comprises code units which when run on the UE causes UE to perform the steps according to any of the method embodiments of . Hence the computer program comprises program modules in order for the UE to perform the steps C C when run on the processing unit . In other words when the different modules of the computer program are run on the processing unit the processing unit together with the modules of the computer program in this embodiment are at least the unit for receiving or retrieving the station identification unit the mapping unit the OD matrix generating unit and the sending unit and optionally also the time adjustment unit the clustering unit and the calculation unit . The optional navigation system corresponds to the navigation system computer program when run on the processing unit .

Although the code units in the embodiment disclosed above in conjunction with are implemented as computer program modules which when run on a UE causes the UE to perform steps described above in the conjunction with figures mentioned above at least one of the code units modules may in alternative embodiments be implemented at least partly as hardware circuits.

Another way of describing an embodiment of the UE is to say that it is a UE comprising a processing unit wherein the processing unit is configured to perform at least the following functions A receive the geographical coordinates from a positioning system in the UE and or from the cell ID database B find stations and tags associated with the stations where the tags comprises arrival time and departure time from these stations C replace map the stations or new stations with places D generate at least one OD sub matrix based on at least in part places and times of arrival and departure associated with these places E send the OD sub matrix to another entity.

The processing unit may also be configured to perform at least one of the following functions A receive or retrieve cell IDs and time stamps associated with the cell IDs B request from an external or internal cell ID database geographical coordinates corresponding to a cell ID C adjust the arrival time and or departure time from the stations 

cluster the stations into different clusters D calculate a position of new stations the position of each new station being based on at least in part stations in the same cluster to which the new station belongs.

The UE may of course also store OD sub matrices in the second computer program product or in another memory in order to be able to send or resend the OD sub matrix at a later point in time and or to be able to display the OD sub matrix on the UE itself or use the OD sub matrix in another application stored in the UE . Such an application could be an application for keeping track of times and places where the user has been.

It should be understood that in case of software implementation the methods computer programs etc irrespective of whether it is a UE implementation according to or a more centralized implementation like the one illustrated in may be implemented with any suitable programming language. One such suitable language is Java.

