---

title: Session certificates
abstract: A client device requests permission from a network access device to access a network associated with the network access device. The client device sends credentials of a user associated with the client device for authenticating with the network access device. The client device receives from the network access device permission to access the network along with a session certificate and an associated key. The session certificate and the key are associated with the credentials of the user. The client device establishes a network session using the network based on receiving the permission. During the network session, the client device establishes a secure communications channel with a website. The client device authenticates the user to the website by sending the session certificate to the website over the secure communications channel. The client device then receives permission from the website to access contents of the website.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09166969&OS=09166969&RS=09166969
owner: Cisco Technology, Inc.
number: 09166969
owner_city: San Jose
owner_country: US
publication_date: 20121206
---
The following disclosure relates generally to establishing network sessions using session certificates.

A user visiting websites sometimes has to authenticate him or her to a website before being granted access to the contents of the website. For example a bank website may require the user to enter a pre registered login username and password combination to be granted access. Typically the user authenticates separately to different websites.

In a general aspect a method for establishing network sessions using session certificates is implemented when a client device requests permission from a network access device to access a network associated with the network access device. The client device sends credentials of a user associated with the client device for authenticating with the network access device. The client device receives from the network access device permission to access the network along with a session certificate and an associated key. The session certificate and the key are associated with the credentials of the user. The client device establishes a network session using the network based on receiving the permission. During the network session the client device establishes a secure communications channel with a website. The client device authenticates the user to the website by sending the session certificate to the website over the secure communications channel. The client device then receives permission from the website to access contents of the website.

The details of one or more aspects of the subject matter described in this specification are set forth in the accompanying drawings and the description below. Other potential features and aspects of the subject matter will become apparent from the description the drawings and the claims.

The client device may be a tablet computer a laptop computer a desktop computer a smart phone an e book reader a music player or any other appropriate portable or stationary computing device. The client device may include one or more processors configured to execute instructions stored by a computer readable medium for performing various client operations such as input output communication data processing and the like. The client device includes one or more network interfaces through which it can establish wireless or wired connections to one or more networks such as network . The client device also runs applications e.g. a web browser using which the client device can establish network sessions with various websites over the network .

The network access device may be a router an access point a gateway server a switch or any other appropriate portable or stationary networking device. The network access device may include one or more processors configured to execute instructions stored by a computer readable medium for performing various client operations such as input output communication data processing and the like. The network access device includes one or more network interfaces through which it can communicate with client devices e.g. client device and with the AAA server . The communication by the network access device may be wired or wireless communication. The network access device is configured for administering access to the network by various client devices. The network access device runs applications for verifying connection requests from client devices and monitoring and or managing connections established over the network .

The network may include a packet switched data network a circuit switched data network or any other network able to carry data for example Internet Protocol IP based or asynchronous transfer mode ATM based networks including wired or wireless networks. The network may be configured to handle web traffic such as hypertext transfer protocol HTTP traffic and hypertext markup language HTML traffic. The network also may be configured to support security and control messages such as authentication using Extensible Authentication Protocol EAP methods over IEEE 802.11 Wi Fi Online Certificate Status Protocol OCSP messages and Remote Authentication Dial In User Service RADIUS messages.

The network may include the Internet Wide Area Networks WANs Local Area Networks LANs analog or digital wired and wireless networks e.g. Wi Fi networks wired Ethernet networks Public Switched Telephone Network PSTN Integrated Services Digital Network ISDN and Digital Subscriber Line xDSL Third Generation 3G or Fourth Generation 4G mobile telecommunications networks private networks such as an intranet radio television cable satellite networks and or any other delivery or tunneling mechanism for carrying data or any appropriate combination of such networks.

The AAA server may be implemented on one or more servers that collectively perform authentication authorization and accounting AAA functions for the network . The AAA server includes one or more processors configured to execute instructions stored by a computer readable medium for performing various operations such as storing and managing credentials of registered users and generating and managing session certificates for users. For example the AAA server may be implemented using the RADIUS protocol. In one implementation the AAA server is a Certificate Authority CA for the system and it is recognized as the CA by network devices in the system . In such a case network devices such as the client device the network access device and the web server trust as valid session certificates and public private key pairs that are disseminated by the AAA server .

In this context a session certificate is a digital certificate issued to a user e.g. user of client device based on credentials of the user that have been registered with the AAA server at some prior time. For example the session certificate may be a X.509 certificate.

The session certificate is attached to the identity of the user and is generated by the AAA server based on a request by the network access device as described in the following sections. A public private key pair unique to the user is generated by the AAA server and associated with the session certificate. The key pair and session certificate may be unique to the particular network session during which the key pair and session certificate are generated such that the same user may get different key pairs and session certificates for network connections to the network that are established at different times.

The user may use the session certificate and public private key pair for authenticating himself herself to various network entities e.g. web server when connecting securely to the network entities. Therefore the session certificate may be used as proof of the fact that the user has performed authentication with the AAA server . In some implementations the user also may use the session certificate and public private key pair for encrypting and or authenticating messages that the user securely exchanges with other network entities.

The session certificate is valid i.e. may be used for authentication and or encryption for a pre determined amount of time which is indicated in the session certificate. The pre determined amount of time may be a few hours such that the session certificate is short lived or it may be a few days or months or some other suitable time period. The pre determined amount of time is also known as the certificate expiry time or certificate validity time or simply as validity time.

In some implementations the validity period of the session certificate may be tied to a network session associated with the client device during which the session certificate is generated. When the network session ends the session certificate is marked as not valid. The network access device monitors the network session established by the client device and periodically sends accounting messages to the AAA server to update the server about the status of the network session. The AAA server stores information on session certificates that it has issued. Based on the accounting messages received from the network access device the AAA server updates information on the validity of the session certificates stored in its database. The AAA server marks a session certificate as not valid if the network session is terminated or the validity period expires whichever is earlier or if the session certificate is revoked i.e. rendered not valid by the AAA server based on some other reason.

In other implementations the validity period of a session certificate may not be tied to the network session during which the session certificate is generated. In such cases the session certificate may be valid till the validity period expires or if the session certificate is revoked by the AAA server based on some other reason.

Authentication refers to the process where a user s identity is authenticated typically by providing evidence that it holds a specific digital identity such as an identifier e.g. a login username and the corresponding credentials e.g. a login password one time token and digital certificates.

The authorization function determines whether a user is authorized to perform a given activity e.g. access the resources of network . Authorization is typically based on authentication of the user when logging on to an application or service. Authorization may be determined based on a range of restrictions for example time of day restrictions or physical location restrictions or restrictions against multiple accesses by the same entity or user.

Accounting refers to the tracking of resource consumption by users for the purposes of security capacity and trend analysis cost allocation and billing among others. Accounting may record events such as authentication and authorization failures and include auditing functionality which permits verifying the correctness of procedures carried out based on accounting data. For example as part of accounting procedures the AAA server server may gather information on the identity of the user of client device connection to network by client device when the connection to network was established and or terminated and if there is a status to report.

The web server is a server that is configured to host a website accessible by client devices via the network . Although only one web server is shown in the system may include a plurality of web servers that are accessible by client devices via the network . Client devices such as client device may access the website hosted by web server by establishing a HTTP connection via the network . In some implementations the web server permits only secure connections from client devices for accessing the website hosted by the web server . In such cases a client device accesses the website hosted by web server by establishing a secure HTTP HTTPS connection via the network using for example the Secure Socket Layer SSL protocol or the Transport Layer Security TLS protocol.

In general the network may be configured such that client devices that are granted permission by the network access device may connect to the network . When a user of the client device wants to connect to the network e.g. to surf the Internet the client device sends a connection request to the network access device in order to be allowed to connect to the network . As part of sending the connection request the client device may prompt the user to enter credentials that may be used for verifying the identity of the user e.g. login username and password that have been registered with the AAA server and or the network access device . Alternatively upon receiving the connection request the network access device may ask for credentials from the client device to allow access to the network . For example the network access device may be a Wi Fi access point and may allow connections to the network using IEEE 802.11 protocol and an EAP method that establishes a secure tunnel such as EAP Flexible Authentication via Secure Tunneling EAP FAST Protected EAP PEAP or EAP Tunneled Transport Layer Security EAP TTLS .

Upon being prompted by the client device the user enters his her credentials on the client device . The client device sends the user credentials to the network access device which verifies the user based on the credentials. Upon verifying the credentials of the user as being accurate the network access device forwards the credentials to the AAA server for generating a session certificate for the client device . The AAA server determines that the network access device has already verified the credentials of the user of client device and it generates a session certificate for the user that is tied to the credentials sent by the network access device . As part of generating the session certificate the AAA server generates a public private key pair e.g. using the RSA algorithm and ties the key pair to the session certificate.

In a different implementation the network access device does not verify the credentials of the user that it receives from client device . Instead the network access device sends the credentials to the AAA server which performs the verification based on information that is stored in its database. If the AAA server determines that the credentials are accurate then the AAA server generates the session certificate as described above.

Once the session certificate is generated the AAA server sends the session certificate and the key pair to the network access device . The network access device sends a message to the client device granting permission to access the network along with the session certificate and the key pair. The client device stores the session certificate and key pair in local memory and connects to the network that is the resources in the network allow the client device to establish network sessions using the resources. In addition in one implementation the client device makes the session certificate and key pair available to a web browser running on the client device . The session certificate and key pair is made available to the web browser through a provisioning application programming interface API or file update. In another implementation the client device does not proactively provide the session certificate and key pair to the web browser. The web browser queries the client device for the session certificate and key pair during SSL or TLS negotiation while establishing a HTTPS connection with a website. Upon receiving the web browser query the client device makes the session certificate and key pair available to the web browser through an API.

The provisioning i.e. generation and distribution of the session certificate may take place over a secure EAP tunnel as part of the EAP over local area network LAN authentication. As described above the EAP over LAN authentication is used for verifying that the user of client device is authorized to access the network .

Once a network connection to network is established by the client device the user of client device may visit various websites e.g. using the web browser on client device . For example the user of client device visits the website hosted by web server . The web server requires a secure connection and the web browser on client device establishes a HTTPS connection to the web server . As part of the SSL handshake for establishing the HTTPS connection the client device sends the session certificate to the web server to authenticate the user.

The web server determines from the session certificate that the AAA server is the CA who generated the session certificate. The web server communicates with the AAA server e.g. over the network to verify the session certificate. For example the session certificate may be a X.509 certificate and the web server queries the AAA server using OCSP messages to validate the session certificate.

The AAA server tracks the connection of the client device to the network e.g. using RADIUS accounting messages that are sent by the network access device . Based on the information in the messages from the network access device the AAA server determines whether the connection currently exists. If the connection exists and or the validity period of the session certificate has not expired the AAA server responds to the web server query with information that the session certificate is valid. On the other hand if the connection of the client device to the network is terminated and or the validity period of the session certificate has expired the AAA server updates the information its database marking the session certificate as expired or invalid. The AAA server responds to the web server query with information that the session certificate is not valid.

If the response from the AAA server informs the web server that the session certificate is valid the web server accepts the session certificate as verification of the identity of the user of client device . Consequently the web server allows user of client device to access the website over the HTTPS connection. On the other hand if the response from the AAA server informs the web server that the session certificate is not valid the web server rejects the session certificate from the client device . In one implementation when the web server rejects the session certificate from the client device the web server proceeds to verify the user based on an alternative mechanism e.g. web authentication using a login username password combination. In another implementation upon rejecting the session certificate from the client device the web server refuses the connection from the client device to access the website.

The user may attempt to connect to multiple websites hosted on different web servers via the connection that is established over network by client device as described above. For one or more of the connections to the different web servers the user may be authenticated to the web servers using the session certificate. Therefore the user is not required to authenticate multiple times to multiple web servers. This may improve the ease of access to different websites and thus be convenient to the user.

In addition authenticating the user using the session certificate that is tied to the identity of the user as known to the CA that is the AAA server adds an extra layer of security for establishing secure connections to web servers. For example SSL or TLS handshakes that are used in HTTPS connection establishment typically use server side certificates tied to the web server. By introducing session certificates associated with the user as part of the SSL or TLS handshake this may prevent man in the middle attacks.

The flow of messages is initiated when the client device sends a request to the network access device to access the network . For example the user of the client device may want to visit a website hosted by web server . Along with the request the client device sends the credentials of the user to the network access device . The credentials may be sent in a separate message or as part of the request .

The network access device verifies the credentials of the user received from the client device . Upon verifying the credentials the network access device sends the credentials to the AAA server in a message for generating the session certificate. As discussed previously in an alternative implementation the network access device does not verify the credentials. Instead it sends the credentials to the AAA server in message for both verification and generating the session certificate.

The AAA server generates the public private key pair and the associated session certificate for the user of the client device . The AAA server sends the key pair and the session certificate to the network access device in a message . The network access device forwards the session certificate and the key pair to the client device in message . Upon receiving the message the client device is able to connect to the network .

The exchange of messages and may take place in a secure method e.g. using a secure EAP tunnel as part of an EAP over LAN authentication for the client device . The exchange of messages and also may take place over a secure connection established between the network access device and the AAA server .

The AAA server periodically sends query messages to the network access device . The query messages seek information on the status of the network connection from the client device to the network . The network access device sends response message with information on the status of the network connection. In some implementations the query message is not sent. Instead the network access device periodically sends update messages e.g. RADIUS accounting messages to the AAA server with information on the status of the network connection from the client device to the network . Based on the information provided by the network access device the AAA server maintains updated information in its database on the validity of the session certificate for the user of the client device .

The web browser on client device sends a secure connection request message to the web server when the user attempts to visit the website hosted by web server . As part of the handshake for establishing the secure connection the client device sends the session certificate to the web server .

The web server sends a query message e.g. an OCSP query message to the AAA server to determine the revocation status i.e. the validity of the session certificate. The query message may include the session certificate as part of the message.

The AAA server looks up the validity of the session certificate in its database and sends a reply message to the web server with information on whether the session certificate is valid or whether it is not valid e.g. the session certificate has expired or been revoked.

If the session certificate is valid the web server sends an acceptance message to the client device indicating that it accepts the session certificate as verified proof of the identity of the user of client device . Along with sending the acceptance message the web server allows the web browser on client device to access the contents of the website hosted by the web server . However if the reply message from the AAA server informs that the session certificate is not valid then the web server rejects the session certificate and sends message to the client device informing the web browser accordingly. In addition the message may include a request from the web server to the web browser to provide additional verification information for the user e.g. login username and password for web authentication.

If the secure connection is established between the client device and the web server the user can access the content of the website hosted by the web server . Consequently an exchange of data between the web browser on client device and the web server takes place over the secure connection.

The database may be implemented as a table that includes users registered with the AAA server and session certificates that have been generated for the users. The table may have multiple rows and multiple columns and . Each row of the table has an entry corresponding to the credentials of a user and an associated network session. For example a row entry may correspond to the user of client device and for a network connection established by the client device with the network . Each row entry is associated with a unique session certificate. There may be multiple rows corresponding to multiple entries for the same user with the same credentials but for different network sessions. The different row entries for the same user are associated with different session certificates. For example user A is associated with rows and of the table with row being for session 1 while row is for session 2. Row is associated with session certificate certificate A1 while row is associated with certificate A2 which is different from certificate A1.

For each row of the database there are four columns. The first column stores the user credentials. For a user with multiple rows in the database the first column also stores the corresponding network session. This may be useful to differentiate between the network sessions as each row entry corresponds to a different network session established by the user. However for a user with one entry in the database the column may not include the corresponding network session. For example column stores user credentials and session information for row entry and for row entry as both entries are for the same user. On the other hand for row entry column stores user credentials user B and no session information as user B is associated with a single network session.

In an alternative implementation the first column in every row entry in the database includes both the user credentials and session information. In this case column for row entry stores the session information along with the user credentials user B even if user B is associated with a single network session.

The second column stores the session certificate associated with the particular user credentials and network session. The session certificates are different for each row entry even if the user is the same as described previously.

The third column stores the certificate expiry time or validity period of the session certificate associated with the entry. If the certificate expiry time of the associated session certificate is a time that is in the past compared to the present time then the session certificate has expired.

The fourth column stores information on whether the session certificate associated with the row entry has been revoked. For example if a network session has been terminated the corresponding session certificate may be revoked even if the validity period has not expired. If a session certificate is revoked the corresponding entry in column says Y while if a session certificate is not revoked the corresponding entry in column says N . The AAA server can update the entry in column based on the accounting messages it receives from the network access device . By checking the entries in the columns and the AAA server can determine whether a session certificate is invalid i.e. whether it has expired or been revoked.

The process is executed when the client device establishes communication with the network access device . For example the client device sends a connection request to the network access device when the user of client device wants to connect to network for visiting the website hosted by web server via the network .

The client device sends the user credentials to the network access device . For example the client device may prompt the user to enter credentials that are used for verifying the identity of the user to the network access device . Once the user enters the requested credentials the client device sends the user credentials to the network access device .

Upon receiving the user credentials from the client device the network access device checks whether it has credentials corresponding to the user of client device in its local cache . For example the network access device may have previously received from the AAA server a copy of the credentials of the user of client device as part of a past message exchange with client device .

If the network access device determines that it has the credentials in local cache the network access device checks whether the credentials match . For example the network access device checks whether the credentials sent by the client device matches the cached copy of the credentials received previously from the AAA server . On the other hand if the network access device determines that it does not have the credentials in local cache it sends the credentials to the AAA server . This may be the case for example when the user of client device is requesting access to the network for the first time. In this case the network access device sends the credentials to the AAA server for verification and for generating the session certificate if the credentials are verified as correct.

If the credentials are available in local cache and do not match the credentials sent by the client device the network access device denies permission to the client device to establish a connection to the network. For example if the credentials supplied by client device are different from the credentials of the user cached by network access device then the network access device determines that the user of client device cannot be authenticated and authorized to access the network . Consequently the network access device may send a connection rejection to the client device .

However if the credentials are available in local cache and match the credentials sent by the client device the network access device sends the credentials to the AAA server . In this case the network access device sends the credentials to the AAA server for generating the session certificate. In some implementations the network access device may include a flag with the message to the AAA server to indicate whether it has verified the credentials.

Upon receiving the credentials from the network access device the AAA server determines whether the credentials are authenticated . For example the AAA server may check a flag that is included in the message from the network access device to determine whether the network access device has verified the credentials. A flag with a value 1 may indicate that the network access device has verified the credentials and is requesting a session certificate from the AAA server . A flag with a value 0 may indicate that the network access device has not verified the credentials and is requesting the AAA server to verify the credentials and then generate the session certificate if the credentials are verified as correct.

If the AAA server determines that the credentials have to be authenticated the AAA server may check whether the credentials sent by the network access device matches the credentials corresponding to the user of client device that is stored at the AAA server as part of the registration information for the user. If the credentials do not match then the AAA server sends an error message to the network access device . In addition the AAA server may send a copy of the credentials that is stored in its database to the network access device. This may be the case for example when this is the first time that the user of the client device is being verified and consequently the network access device has not previously received a copy of the credentials for the user from the AAA server. Upon receiving the error message from the AAA server the network access device denies permission to the client device to establish a connection to the network as described previously.

In some implementations the network access device sends the credentials to the AAA server only if it is able verify the user i.e. there is a match between credentials stored in its local cache with the credentials sent by the client device . In such implementations the AAA server does not have to check whether the credentials are authenticated and does not have to send any error message to the network access device .

On the other hand if the credentials are authenticated then the AAA server generates a key pair and associated session certificate for the user and sends to the network access device . For example the AAA server generates a public private key pair and a session certificate for the user of client device that is tied to the key pair. The AAA server sends the session certificate and the key pair to the network access device .

The network access device grants permission to the client device to access the network and sends the key pair and session certificate to the client device . For example the network access device sends a message to the client device granting permission to access the network along with the session certificate and the key pair. In one implementation the message granting permission may be different from the message sending the key pair and session certificate. In other implementations the same message may include information granting permission along with the key pair and session certificate.

The client device establishes connection to the network and stores the key pair and session certificate in local memory . For example upon receiving permission from the network access device the client device connects to the network that is the resources in the network allow the client device to establish connections using the resources. In addition the client device stores the session certificate and key pair in local memory and makes the session certificate and key pair available to applications running on the client device that may require the session certificate key pair e.g. the web browser. The user of client device may then access the contents of the website hosted by the web server .

The process is executed when a web server receives a connection request from a client device and establishes a secure channel with the client device . For example the web server receives a request from the web browser on client device for establishing an HTTPS connection to the web server . The request is made by the web browser when the user of client device attempts to access the secure website hosted by the web server . The web server accepts the connection request and performs a security handshake e.g. an SSL or TLS handshake with the web browser to validate and establish the HTTPS channel.

The web server receives the session certificate from the client device . For example as part of the SSL handshake for establishing the HTTPS connection the client device sends the session certificate associated to the web server to authenticate the user. Upon receiving the session certificate the web server sends a query to an AAA server to validate the session certificate . For example web server determines from the session certificate sent by client device that the AAA server is the CA who generated the session certificate. The web server sends a certificate validity query to the AAA server e.g. using an OCSP message to determine whether the session certificate is valid. The web server sends the query when the pre determined validity period indicated on the session certificate has not expired but the session certificate may have become invalid due to some other reason e.g. the session certificate may have been revoked by the AAA server . On the other hand if the validity period indicated on the session certificate has expired then the web server determines without querying the AAA server that the session certificate is not valid.

The web server checks whether the session certificate is valid . For example the web server receives a response to its query from the AAA server with information whether the session certificate is valid. Alternatively as described in the preceding section the web server may check the validity period indicated on the session certificate to determine whether the certificate has expired i.e. it is not valid.

If the web server determines that the session certificate is valid the web server grants website access to the client device . For example the web server completes the security handshake with the web browser on the client device and authenticates the user based on the session certificate as part of the security handshake. The user is then allowed to access the contents of the website hosted by the web server without having to perform any other authentication for being allowed access.

However if the web server determines that the session certificate is not valid the web server rejects the session certificate . For example if the response from the AAA server informs the web server that the session certificate is not valid the web server rejects the session certificate from the client device and refuses the connection request from the web browser to access the website hosted by the web server .

However in some implementations after rejecting the session certificate as not valid the web server proceeds to perform alternative authentication with the client device . For example the web server may complete the SSL handshake and establish the HTTPS connection without the session certificate. Then the web server may verify the user based on web authentication e.g. using a login username password combination.

The process is executed when the CA receives user credentials from a network access device . For example the AAA server receives from the network access device credentials associated with the user of client device when the client device requests a connection to the network . Upon receiving the credentials the CA determines whether the credentials are valid . For example the message received from the network access device with the credentials of the user of client device might include a request from the network access device to verify the credentials sent with the message. This may be the case for example when the network access device has not verified the credentials. As described previously the network access device may not verify the credentials for various reasons e.g. this is the first request from the client device such that the network access device does not have a locally cached copy of the credentials of the user of client device .

If the CA determines that the credentials are not valid the CA generates an error . For example upon comparing the credentials sent by the network access device with the corresponding user credentials that are stored in its database the AAA server may determine that the credentials do not match and therefore the credentials sent by the network access device are not valid. Consequently the AAA server sends an error message to the network access device indicating the credentials are not valid. In addition the AAA server also may send a copy of the user credentials that are stored in its database. This may allow the network access device to verify the credentials of the user for future connection requests thereby saving on the overhead of sending the credentials to the AAA server for verification.

In some implementations the verification of the credentials are done by the network access device and the AAA server is not involved. In such implementations the CA does not check whether the credentials are valid and consequently does not have to generate error if the credentials are not valid.

On the other hand if the credentials are determined to be valid either by the network access device or the CA then the CA generates a public private key pair and associated session certificate and sends to the network access device . For example the AAA server generates a session certificate for the user of client device that is tied to the credentials sent by the network access device . As part of generating the session certificate the AAA server generates a public private key pair and ties the key pair to the session certificate. The AAA server sends the session certificate and the key pair to the network access device for transmission to the client device .

The CA checks whether a session certificate has expired . For example the AAA server periodically checks the lifetime of all the session certificates in its database to determine whether any session certificate has expired. The certificate expiry time that is indicated on each session certificate is stored in the database corresponding to each issued session certificate as shown in column of database . The AAA server periodically checks which of the certificate expiry times are in the past compared to the time the check is performed. The corresponding session certificates are determined to have expired.

For session certificates that have not expired the CA periodically receives updates from the network access device . For example the AAA server tracks the connections of various client devices to the network using accounting messages that are sent by the network access device .

Based on the update messages received from the network access device the CA determines whether the connections are terminated . For example the accounting messages from the network access device inform the AAA server which of the connections of different client devices to the network have terminated e.g. the user of the corresponding client device may have closed the connection. For session certificates associated with connections that are still active the CA continues checking whether the session certificates have expired or whether the corresponding connections have terminated .

On the other hand if the CA determines that a session certificate has expired or the corresponding connection has been terminated then the CA marks the session certificate as not valid . For example upon checking the certificate expiry time corresponding to row entry in the database the AAA server may determine that the certificate has expired and therefore mark the associated certificate certificate A1 as not valid. Alternatively the AAA server may receive an accounting message from the network access device with the information that the network connection session 1 for user A has been terminated. The AAA server marks the associated certificate certificate A1 as revoked i.e. not valid with the value Y in column for the row entry corresponding to . Consequently when web server sends a query to the AAA server to know the validity of session certificate certificate A1 the AAA server sends a response to the web server indicating that the session certificate certificate A1 is not valid. However if the web server inquires about session certificate certificate B or certificate A2 for which the validity times have not expired and the network connections have not terminated the AAA server responds with the information that the session certificate certificate B or certificate A2 is still valid. Therefore the web server may authenticate the user associated with either session certificate certificate B or certificate A2 based on the session certificate.

The disclosed and other examples can be implemented as one or more computer program products i.e. one or more modules of computer program instructions encoded on a computer readable medium for execution by or to control the operation of data processing apparatus. The implementations can include single or distributed processing of algorithms. The computer readable medium can be a machine readable storage device a machine readable storage substrate a memory device or a combination of one or more them. The term data processing apparatus encompasses all apparatus devices and machines for processing data including by way of example a programmable processor a computer or multiple processors or computers. The apparatus can include in addition to hardware code that creates an execution environment for the computer program in question e.g. code that constitutes processor firmware a protocol stack a database management system an operating system or a combination of one or more of them.

A computer program also known as a program software software application script or code can be written in any form of programming language including compiled or interpreted languages and it can be deployed in any form including as a standalone program or as a module component subroutine or other unit suitable for use in a computing environment. A computer program does not necessarily correspond to a file in a file system. A program can be stored in a portion of a file that holds other programs or data e.g. one or more scripts stored in a markup language document in a single file dedicated to the program in question or in multiple coordinated files e.g. files that store one or more modules sub programs or portions of code . A computer program can be deployed to be executed on one computer or on multiple computers that are located at one site or distributed across multiple sites and interconnected by a communication network.

The processes and logic flows described in this document can be performed by one or more programmable processors executing one or more computer programs to perform functions by operating on input data and generating output. The processes and logic flows can also be performed by and apparatus can also be implemented as special purpose logic circuitry e.g. an FPGA field programmable gate array or an ASIC application specific integrated circuit .

Processors suitable for the execution of a computer program include by way of example both general and special purpose microprocessors and any one or more processors of any kind of digital computer. Generally a processor will receive instructions and data from a read only memory or a random access memory or both. The essential elements of a computer can include a processor for performing instructions and one or more memory devices for storing instructions and data. Generally a computer can also include or be operatively coupled to receive data from or transfer data to or both one or more mass storage devices for storing data e.g. magnetic magneto optical disks or optical disks. However a computer need not have such devices. Computer readable media suitable for storing computer program instructions and data can include all forms of nonvolatile memory media and memory devices including by way of example semiconductor memory devices e.g. EPROM EEPROM and flash memory devices magnetic disks e.g. internal hard disks or removable disks magneto optical disks and CD ROM and DVD ROM disks. The processor and the memory can be supplemented by or incorporated in special purpose logic circuitry.

While this document describe many specifics these should not be construed as limitations on the scope of an invention that is claimed or of what is claimed but rather as descriptions of features specific to particular embodiments. Certain features that are described in this document in the context of separate embodiments can also be implemented in combination in a single embodiment. Conversely various features that are described in the context of a single embodiment can also be implemented in multiple embodiments separately or in any suitable sub combination. Moreover although features is described above as acting in certain combinations and even initially claimed as such one or more features from a claimed combination can in some cases be excised from the combination and the claimed combination is directed to a sub combination or a variation of a sub combination. Similarly while operations are depicted in the drawings in a particular order this should not be understood as requiring that such operations be performed in the particular order shown or in sequential order or that all illustrated operations be performed to achieve desirable results.

Only a few examples and implementations are disclosed. Variations modifications and enhancements to the described examples and implementations and other implementations can be made based on what is disclosed.

