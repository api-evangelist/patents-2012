---

title: Anti-malware protection operation with instruction included in an operand
abstract: Disclosed is a system and method for extending anti-malware protection to systems having multiple storage devices, such as RAID. In embodiments, a trusted connection may be established between a host and a controller of the multiple storage devices. The trusted connection may use various information encryption techniques to undermine attempts by malware to preserve malware-infected locations on the storage devices by redirecting anti-malware protection related operations by the host. Through an encrypted and trusted connection between the host and a controller of the multiple storage devices, anti-virus and/or anti-malware software (hereinafter, AVS) may transmit encrypted anti-malware protection related operations to the controller of the multiple storage devices, overcoming detection and/or diversion by the malware. Other embodiments may be described and claimed.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09027148&OS=09027148&RS=09027148
owner: Intel Corporation
number: 09027148
owner_city: Santa Clara
owner_country: US
publication_date: 20120319
---
The present application is a national phase entry under 35 U.S.C. 371 of International Application No. PCT US2012 029656 filed Mar. 19 2012 entitled ANTI MALWARE PROTECTION OPERATION WITH INSTRUCTION INCLUDED IN AN OPERAND which designated among the various States the United States of America. The Specification of the PCT US2012 029656 Application is hereby incorporated by reference.

The present disclosure relates generally to the technical field of data processing. More specifically the present disclosure relates to extending anti malware protection to systems having multiple storage devices particularly to redundant array independent disk RAID systems.

Malware or malicious code is a catch all term used to refer to various types of software that can cause problems or damage a computer. The term Malware may encompass viruses worms Trojan horses macro viruses rootkit malware and backdoors. Over time malware has evolved to be increasingly more stealthy and targeted.

Malware has become stealthier by in some cases hiding inside the core operating system by infecting kernel modules e.g. rootkits . Rootkits especially the ones executing with supervisor or high level privileges e.g. Ring privilege in the case of Intel Architecture processors are very difficult or nearly impossible to detect by traditional anti virus solutions or anti malware solutions hereinafter AVS . For example rootkits with supervisor privilege and other malware hidden therein may intercept queries from the AVS and feed incorrect information to the AVS to preserve the malware in a storage device.

Embodiments of the present disclosure may relate to extending anti malware protection to systems having multiple storage devices. In embodiments a trusted connection may be established between a host and a controller of the multiple storage devices. The trusted connection may use various information encryption techniques to undermine attempts by malware to preserve malware infected locations on the storage devices by redirecting anti malware protection related operations by the host. Through an encrypted and trusted connection between the host and a controller of the multiple storage devices anti virus and or anti malware software hereinafter AVS may transmit encrypted anti malware protection related operations to the controller of the multiple storage devices overcoming detection and or diversion by the malware.

According to one embodiment the controller may receive from the host device a first instruction having a first address and an operand. The first instruction may be nominally associated with an anti malware protection related operation and the first address may refer to first one or more storage locations of the multiple storage devices. Further the controller may recover from the operand a second instruction that is to be operated on second one or more storage locations of the multiple storage devices. The controller may then execute the second instruction to operate on the second one or more storage locations to effectuate the anti malware protection related operation.

Various aspects of the illustrative embodiments will be described using terms commonly employed by those skilled in the art to convey the substance of their work to others skilled in the art. However it will be apparent to those skilled in the art that some alternate embodiments may be practiced using portions of the described aspects. For purposes of explanation specific numbers materials and configurations are set forth in order to provide a thorough understanding of the illustrative embodiments. However it will be apparent to one skilled in the art that alternate embodiments may be practiced without the specific details. In other instances well known features are omitted or simplified in order not to obscure the illustrative embodiments.

Further various operations will be described as multiple discrete operations in turn in a manner that is most helpful in understanding the illustrative embodiments however the order of description should not be construed as to imply that these operations are necessarily order dependent. In particular these operations need not be performed in the order of presentation.

The phrase in one embodiment is used repeatedly. The phrase generally does not refer to the same embodiment however it may. The terms comprising having and including are synonymous unless the context dictates otherwise. The phrase A B means A or B . The phrase A and or B means A B or A and B . The phrase at least one of A B and C means A B C A and B A and C B and C or A B and C . The phrase A B means B or A B that is A is optional.

The host CPU may be one or more of a variety of single core or multi core microprocessors configured to fetch and execute a plurality of instructions. Host CPU may execute e.g. instructions of an operating system configured to facilitate the operation and interconnectivity of the various components of computing device . Host CPU may also execute instructions of applications launched by the operating system. According to one embodiment host CPU is a multi core processor such as the Intel Core i3 Intel Core i5 and Intel Core i7 microprocessors available from Intel Corporation of Santa Clara Calif.

The system memory may be communicatively coupled to host CPU . System memory may be configured to receive and store instructions executed by host CPU and data associated with the instructions being executed. The system memory may include non volatile and or volatile memory. In embodiments system memory may include one or more of dynamic random access memory DRAM synchronous dynamic random access memory SDRAM read only memory ROM flash memory and the like.

The chipset may couple signals between system memory a variety of input output units and host CPU . In embodiments chipset may include a memory controller. In other embodiments chipset may include a complementary interface to a direct media interface DMI integrated with host CPU .

The chipset may transmit signals to and receive signals from multi device controller via communication link . The communication link may be any one of a variety of communication interfaces. For example communication link may be a computer bus interface having a control bus an address bus and a data bus such as but not limited to Serial Advance Technology Attachment SATA Integrated Development Environment IDE peripheral Component Interconnect PCI Small Computer System Interface SCS HyperTransport InfiniBand and the like. Alternatively communication link may be a point to point network connection such as Ethernet or may be a wireless connection such as one conforming with one of the Institute of Electrical Electronic Engineers IEEE 802.11 standards.

Still referring to multi device controller may be configured to communicate with host CPU via communication link to receive and respond to instructions regarding storage devices . In embodiments multi device controller may be a card integrated into computing device through a connector that supports communication link . According to one embodiment multi device controller may be integrated into chipset . According to another embodiment multi device controller may be a stand alone device carried by a modular networking rack or cabinet and communicates with chipset via a network connection.

In embodiments multi device controller is configured to communicate with host CPU via chipset through a trusted connection to perform anti malware related operations. In embodiments multi device controller may include a bus an interface controller a buffer a parity generator random access memory RAM a microcontroller controller firmware and one or more storage device controllers collectively coupled to one another as shown.

The bus may be configured to provide a low resistance connection between several components of multi device controller . The interface controller may be configured to communicatively couple bus to communication link to convert the protocol used on communication link to a protocol that is compatible with the components of multi device controller . The buffer may be coupled to bus and configured to provide temporary storage for microcontroller . The parity generator may be coupled to bus and may be configured to support encrypted communications by microcontroller by generating parity data for data handled by microcontroller . In embodiments the parity data may also be stored on one or more storage devices . In embodiments parity generator may be configured to generate dedicated or distributed parity according to various embodiments of the disclosure. The RAM may be coupled to bus and may be configured to be operable to support microcontroller by storing and providing instructions and their operands to facilitate sending data to and receiving data from host CPU and to facilitate storing data to and retrieving data from one or more storage devices . The RAM may be SRAM DRAM SDRAM or one of any of a variety of types of random access memory according to several embodiments of the disclosure.

The microcontroller may be communicatively coupled to bus to receive instructions and their operands from host CPU and to transmit instructions and their operands to one or more storage device controllers . The microcontroller may be configured to execute instructions and may include one or more of an application specific integrated circuit ASIC field programmable gate array FPGA and so forth. The microcontroller may be configured to transmit instructions and their operands if applicable to one or more storage device controllers in order to write data to or read data from one or more storage devices . The microcontroller may be configured to read from and write data to one or more storage devices in response to instructions received from host CPU .

Malware that infects a computer system may alter commands sent from a host CPU to a storage controller. When malware infects the computer system the malware will often times store malware code and or data to locations of non volatile memory or persistent storage of the computer system so that the malware may reinitiate operation upon power up of the computer system after a reset or a power down of the computer system. As discussed previously some malware may infect the higher privileged portions of an operating system e.g. the kernel. The malware may then leverage the privileged access to the operating system to redirect attempts by an AVS or other program to read from or write over locations in non volatile memory or persistent storage that are storing malware code and or data. For example an AVS being executed by the computer system may attempt to scan the non volatile memory or persistent storage in search for patterns that are indicative of malware by reading each location of the memory or a storage device. Deeply rooted malware may intercept attempts by the AVS to read or write certain memory locations by altering the address of the read or write command that is sent to a controller of the non volatile memory or persistent storage. Thus without a trusted connection to the controller of the non volatile memory or persistent storage eliminating malware with high privileged access may be difficult.

In embodiments microcontroller may be configured to execute instructions of controller firmware to establish and maintain a trusted connection between multi device controller and programs such as an AVS that are executed by host CPU . The controller firmware may be configured to cause microcontroller to perform cryptographic functions. Specifically controller firmware may include instructions which when executed by microcontroller enable multi device controller to establish an out of band connection with an AVS executed by host CPU . For example controller firmware may be configured to cause microcontroller to be responsive to a trusted connection protocol initiated by the AVS. In embodiments controller firmware may be configured to in response to receiving a request by the AVS to establish a trusted connection cause microcontroller to request a signed certificate from the AVS to validate the authorization of the AVS to establish the trusted connection. The controller firmware may include a decryption code such as a public key to the certificate of the AVS for decrypting the message received from the AVS. Additionally controller firmware may include a controller certificate with a private key so the AVS and multi device controller utilize a dual level of encryption. These communications between the AVS and multi device controller may occur concurrently in parallel to read write commands issued to multi device controller by other programs such as the operating system that are executed by the host CPU . Thus a trusted and authenticated connection may be established out of band between multi device controller and programs that are executed by host CPU .

The controller firmware may be configured to support additional cryptographic communications between multi device controller and programs executed by host CPU . According to one embodiment the AVS may issue read write commands to multi device controller using dummy addresses and the AVS may encrypt the actual read write addresses in the payload or operand of the command. According one embodiment the AVS may encrypt the actual read write addresses in the operand by encrypting the operand with a private key of the certificate of the AVS in addition to using the public key of the certificate of multi device controller . Often times malware may attempt to redirect commands that are directed to memory storage locations occupied by the malware. However since the location addresses associated with these commands are dummy addresses the malware will likely ignore these commands since the command do not appear to be directed toward memory locations occupied by the malware. The malware will be unlikely to redirect these commands with addresses that are encrypted in the operand of the command for at least two reasons. First the malware will be unlikely to redirect the commands because the actual addresses to which the commands are directed are carried in the payload or operand of the command. Second the malware will be unlikely to redirect the commands because the decryption codes public keys private keys and or similar technology used to decrypt the encrypted operands in embodiments are stored within controller firmware . Thus redirect attempts by the malware will be detectable and reportable when multi device controller attempts to authenticate commands received from the AVS. While cryptographic techniques associated with public key infrastructure are described herein in alternate embodiments controller firmware may be configured to enable multi device controller to communicate with the programs executed by host CPU by using other cryptographic techniques that are known to those of ordinary skill in the art.

The controller firmware may be configured to perform the above described cryptographic functions by utilizing a firmware support . In embodiments firmware support may include several logical blocks that support cryptographic functions described above. The firmware support may include a command processor a read write address generator a parity generator and encryption and message authentication code MAC support . The firmware support may be stored in updatable non volatile memory such as flash according to one embodiment of the disclosure. The encryption and MAC support may be configured to work with command processor read write address generator and parity generator to cause microcontroller to encrypt and decrypt messages to validate the authorization of programs executed by host CPU such as AVS and maintain one or more trusted connections with the programs.

The one or more storage devices may be communicatively coupled to multi device controller via corresponding communication links collectively . The one or more storage devices may be one or more hard disk drives HDD solid state drives SSD or other non volatile memory. The one or more storage devices may comprise an array of independent disks that are communicatively coupled to be read from or written to by multi device controller . The communication links collectively may form a small computer system interface SCSI an integrated drive electronics IDE interface or other like storage interfaces according to various embodiments of the disclosure.

In embodiments one or more storage devices may be configured to store and retrieve data in a striped manner in response to the operation by multi device controller according to one embodiment. For example data may be stored onto one or more storage devices in a striped manner without parity mirroring or redundancy. As another example data may be stored onto one or more storage devices in a striped manner with byte level striping and dedicated parity. As yet another example data may be stored onto one or more storage devices using one of bit level byte level and block level striping and using one of dedicated parity and distributed parity. Consequently one or more storage devices may be configured to be operated by multi device controller in a redundant array of inexpensive disks RAID configuration in any one or more of standard RAID levels e.g. RAID levels 0 6.

The AVS may rely on the previously described trusted connection between the AVS and multi device controller to detect the presence of malware. For example if the AVS is unable to establish a trusted connection with multi device controller or if read write commands are rejected or results in incorrect data. In embodiments the AVS may provide indication to a display to notify a user that malware may be present on one or more of storage devices . Additionally or alternatively the AVS may transmit an electronic notification to one or more users that malware may be present on one or more storage devices so that correct action may be taken.

Advantageously inclusion of cryptographic functions within multi device controller may enable host CPU to establish and maintain a trusted connection between multi device controller and one or more programs that are executed by host CPU . The trusted connection provides anti malware programs with the ability to scan and correct e.g. by over writing malware that is stored on one or more storage devices . The trusted connection provides anti malware programs with the ability to correct malware even when the malware has attained high privilege access within computing device .

As discussed above in connection with the AVS executed by host CPU may use one or more encryption keys e.g. a private encryption key of the AVS and a public encryption key of multi device controller to encrypt the operand of the first instruction.

In block method may include recovering from an operand by multi device controller a second instruction. The second instruction may be operated on second one or more storage locations of the number of storage devices. The second instruction may be substantively associated with the anti malware protection related operation. In embodiments the first and second one or more storage locations may differ by at least one storage location.

Enabling the controller to recover a second instruction from an operand of the first instruction may prevent malware from detecting the target storage location of the anti malware protection related operation. According to one embodiment the second instruction may be encrypted to further prevent malware from detecting the anti malware protection related operation.

In block method may include executing the second instruction by multi device controller to operate on the second one or more storage locations to effectuate the anti malware protection related operation.

Operating on the second one or more storage locations may include reading the second one or more storage locations in order to search for patterns that are indicative of malware residing at the storage locations. Additionally operating on the second one or more storage locations may include writing new data to the second one or more storage locations in order to remove malware residing at the storage locations.

In block method may include if the second instruction is a read instruction assembling by multi device controller data read from the second one or more storage locations to form assembled data and returning the assembled data by multi deice controller to host CPU as read output data of the first instruction.

The method may be fully or partially practiced with computing device . For example computing device may include a computer readable storage medium embodied with instructions configured to enable multi device controller in response to execution of the instructions to perform any or all of the operations of method . According to one embodiment the computer readable medium may be a non transitory computer readable storage medium. Furthermore one or more of the techniques or components described in connection with may be combined with or used in method .

The host device may include software and hardware to support a trusted connection or out of band secondary channel for performing anti malware related operations. The host device may include an operating system communicatively coupled to a multi device controller through a primary channel . The primary channel may be any one of a number of standard interfaces used between a host CPU as shown in and a storage device controller e.g. ATA PCI Ethernet and the like. The primary channel represents a physical connection between multi device controller and hardware running operating system . The primary channel also represents a logical connection between operating system and a controller firmware .

The operating system may be a Windows product developed by Microsoft Corporation a UNIX based environment or a Macintosh related environment such as OS X according to various embodiments of the disclosure. The operating system may include a file system and a private software development kit SDK . The file system may be a program operable by operating system that enables a user and operating system to organize and efficiently retrieve data stored on one or more storage devices . The private SDK may include a variety of tools that enable the development of software operable by operating system .

The multi device controller may be configured to establish and maintain a secondary and trusted communication channel in addition to maintaining primary communication channel . The multi device controller may include controller firmware memory and a system on a chip . According to one embodiment multi device controller may be multi device controller of .

The controller firmware may include cryptographic functionality to support establishing and maintaining a trusted channel with programs and computer systems that are external to host device . The controller firmware may include a number of instructions configured to enable multi device controller to operate on one or more storage devices in response to instructions received from operating system in accordance with standard operation of a storage controller. Additionally controller firmware may include a number of instructions which when executed by multi device controller enable multi device controller to establish trusted channel .

The controller firmware may include firmware support and trusted application programming interface API and controller firmware may utilize firmware support and a trusted API to establish a trusted channel . Additionally firmware support may include encryption and message authentication code MAC support that may be used by controller firmware to decrypt and authenticate incoming messages. For example in response to an inquiry or attempt to initiate trusted channel by backend server controller firmware may communicate with backend server through trusted API and firmware support to request a digital certificate a digital signature or and an encrypted message from backend server . According to one embodiment controller firmware may include a PKI based certificate with a private key for decrypting messages intended to be decoded by multi device controller . The controller firmware may also be pre loaded with a symmetric or public encryption key that is distributed on a limited basis to enable controller firmware to authenticate backend server . Through a series of handshake signals controller firmware and backend server may establish a trusted channel . According to one embodiment backend server may authenticate and provision or initialize the cryptographic keys and code in controller firmware .

According to one embodiment controller firmware may include instructions which when executed by multi device controller cause multi device controller to execute the operations of method of .

The memory and system on a chip may support multi device controller in receiving and executing instructions related to storing data to one or more storage devices in a striping manner. For example multi device controller may be configured to write data to the one or more storage devices in any one of a bit level byte level and block level striping manner with or without parity.

The host device may include an anti malware and or antivirus software AVS application that may be executed by the host CPU of host device to perform anti malware protection related operations. The AVS application may advantageously communicate with multi device controller through trusted channel . The AVS application may use an AVS kit to conform with a protocol recognizable by trusted API of controller firmware . Similar to backend server the AVS application may initiate and establish a secondary and trusted communication channel with multi device controller by encrypting messages that may be decrypted by multi device controller using cryptographic keys and or code stored within controller firmware .

The AVS application may identify and eliminate malware residing at storage locations of one or more storage devices . The AVS application may identify malware by inserting and encrypting read commands and target storage locations of storage devices into the operand of a read or write instruction transmitted to multi device controller . The AVS application compares data that is read from storage locations and identifies malware residing at storage locations by comparing the read data to predetermined patterns. The AVS application may then use an application to notify a user or electronic system that malware has been identified on the storage device. The application may be configured to grant permission to the AVS application to repair i.e. erase the infected storage locations or may be configured to instruct the AVS application to await further instruction from a user. Accordingly system may be used to execute anti malware protection related operations on a system having one or more storage devices .

At controller firmware may authenticate the request from the AV AM agent with a session key located within controller firmware and controller firmware may process the command.

At controller firmware may issue a read request to plurality of storage devices for operation on the logical block addresses requested by AV AM agent .

At storage devices may return data stored at the requested logical block addresses to controller firmware .

At controller firmware may assemble read data and compute a message authentication code MAC . In embodiments a MAC may be computed by performing a hash function on the read data.

At controller firmware may respond with the trusted read data that has been encrypted with a session key.

At AV AM agent may verify the authenticity of the trusted read data for example by computing a MAC of the decrypted data and comparing the MAC of AV AM agent to the MAC of controller firmware .

At AV AM agent may notify an AV AM backend if message authentication fails. The AV AM backend may then provide notification to one or more users that malware may have prevented a trusted read.

At controller firmware may authenticate the request from AV AM agent with a session key located within controller firmware and controller firmware may process the command.

At controller firmware may issue a write request to plurality of storage devices of the issued data at the logical block addresses requested by AV AM agent .

At controller firmware may issue a read request to storage devices to confirm that the data was successfully written.

At controller firmware may respond to AV AM agent with the written data confirmation that has been encrypted with a session key.

At controller firmware may authenticate the request from AV AM agent and processes the heartbeat message. The controller firmware may authenticate the request by decrypting the message first with the private key of controller firmware and second with the public key of AV AM agent .

At controller firmware may generate a heartbeat response with a MAC. The MAC may be computed on the data that was initially encrypted and transmitted by AV AM agent .

At AV AM agent may verify the authenticity of the heartbeat message. Through actively and periodically maintaining and verifying the trusted connection between AV AM agent and controller firmware the AV AM agent may be notified of a new presence of malware if the heartbeat connection unexplainably interfered with.

In various embodiments at least one computer readable storage medium may have a number of instructions configured to enable a controller of a number of storage devices in response to execution of the instructions by the controller to receive a first instruction from a host computing device coupled with the controller. The first instruction may include a first address and an operand. The first instruction may be nominally associated with an anti malware protection related operation and the first address may refer to first one or more storage locations of the storage devices. The controller may also be enabled to recover from the operand a second instruction that may be operated on second one or more storage locations of the storage devices. The second instruction may be substantively associated with the anti malware protection related operation and the first and second one or more storage locations differ by at least one storage location. The controller may be enabled to execute the second instruction to operate on the second one or more storage locations to effectuate the anti malware protection related operation. The controller may be enabled to receive the first instruction via a trusted connection communicatively coupling the controller and the host computing device. The controller may be enabled to form the trusted connection between the controller and the host computing device over a secondary channel that may couple the controller to the host computing device. The controller and the host computing device may be further coupled to each other via a primary channel.

In other embodiments the anti malware protection operation may be one of a read operation and a write operation to be performed on the second one or more storage locations. For a read operation the controller may be enabled to assemble data read from the second one or more storage locations to form assembled data and return the assembled data to the host computing device as read output data of the first instruction.

In other embodiments the controller to recover the second instruction from the operand may be configured to decode or decrypt the operand based on the instructions.

In other embodiments the controller may be enabled to use a private key to decode or decrypt the second instruction from the operand.

In other embodiments the instructions may include a certificate of the controller. The certificate may include the private key. In other embodiments the controller of the storage devices may be enabled to execute the second instruction to operate on the second one or more storage locations of the storage devices while the storage devices include an array of independent disks.

In various embodiments data may be stored in a striped manner in the array of independent disks using one of bit level byte level and block level striping and using one of dedicated parity and distributed parity. The data may be stored in a striped manner in the array of independent disks with byte level striping and dedicated parity. The second instruction may be encrypted to prevent malware from detecting the anti malware protection related operation.

In various embodiments the controller of the storage devices may be enabled to use a dual layer of encryption.

In embodiments a method may include receiving by a controller of a number of storage devices a first instruction from a host computing device. The host computing device may be coupled to the controller. The first instruction may include a first address and an operand. The first instruction may be nominally associated with an anti malware protection related operation and the first address may refer to first one or more storage locations of the storage devices. The method may include recovering from the operand by the controller a second instruction to be operated on second one or more storage locations of the storage devices. The second instruction may be substantively associated with the anti malware protection related operation and the first and second one or more storage locations may differ by at least one storage location. The method may include executing the second instruction by the controller to operate on the second one or more storage locations to effectuate the anti malware protection related operation.

According to various embodiments receiving may include receiving the first instruction via a trusted connection communicatively coupling the controller and the host computing device. The method may further include forming by the controller the trusted connection between the controller and the host computing device over a secondary channel. The secondary channel may couple the controller to the host computing device. The controller and the host computing device may be further coupled to each other via a primary channel. The operand may be encrypted and recovering the second instruction from the operand may include decrypting the operand by using a private key.

According to various embodiments the first and second instructions may be read or write instructions. For read instructions the method may further include assembling by the controller data read from the second one or more storage locations to form assembled data and returning the assembled data by the controller to the host computing device as read output data of the first instruction. The storage devices may include an array of independent disks. The data may be stored in a striped manner in the array of independent disks without parity mirroring or redundancy. The data may be stored in a striped manner in the array of independent disks with byte level striping and dedicated parity.

In embodiments an apparatus may include a number of data storage devices and at least one controller communicatively coupled to the data storage devices. The at least one controller may be configured to write data to the data storage devices and read data from the data storage devices in response to a first number of instructions. The controller may be configured to receive a first storage instruction that includes a first operand and a first address corresponding to first one or more storage locations. The controller may be configured to recover a second storage instruction based on the first operand. The second storage instruction may include a second address corresponding to second one or more storage locations that differ from the first one or more storage locations by at least one storage location. The controller may be configured to execute the second storage instruction to operate on the second one or more storage locations to effectuate an anti malware protection related operation.

In various embodiments the controller may configured to receive the first storage instruction from a host computing device via a trusted logical connection between the controller and the host computing device over a secondary channel. The secondary channel may communicatively couple the controller and the host computing device. The controller and the host computing device may be further coupled to each other via a primary channel.

In various embodiments the controller may be further configured to be responsive to a first instruction set via the primary channel and a second instruction set via the secondary channel. The second instruction set may include fewer instructions than the first instruction set. The secondary channel may be an out of band channel. The data storage devices may include an array of independent disks. The data may be stored in a striped manner in the array of independent disks using one of bit level byte level and block level striping and using one of dedicated parity and distributed parity storage techniques. The controller may include a parity generator configured to support encrypted communications by the controller.

In various embodiments an apparatus may include a number of data storage devices and at least one controller communicatively coupled to the data storage devices. The at least one controller may be configured to receive read and write commands encoded with dummy addresses. The at least one controller may be configured to decrypt actual read and write addresses that have been encrypted by a malware protection related program into operands of the respective read and write commands.

In various embodiments the actual read and write addresses may be encrypted with a public key and the at least one controller may be configured to decrypt the actual read and write addresses with a private key corresponding to the public key.

In various embodiments the received read and write addresses may have been encrypted with dual levels of encryption and the at least one controller may be configured to decrypt the dual levels of encryption.

Specific features of any of the above described embodiments may be fully or partially combined with one or more other embodiments either wholly or partially to form new embodiments of the disclosure.

