---

title: Virtual machine based content processing
abstract: A set of techniques is described for enabling a virtual machine based transcoding system. The system enables any transcoding provider to make their transcoding service available to other users over a network. The system can automate the deployment, execution and delivery of the transcoding service on behalf of the transcoding provider and enable other users to use the transcoding services to transcode content. The system receives a virtual machine image, transfers the image to a location where the media content is stored and creates a virtual private network of resources that will perform the transcoding of the media content. The virtual private network may be firewalled or otherwise restricted from opening connections with external clients when transcoding the content in order to prevent malicious use of the media content.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09237188&OS=09237188&RS=09237188
owner: Amazon Technologies, Inc.
number: 09237188
owner_city: Reno
owner_country: US
publication_date: 20120521
---
Over the last several decades the cost of computer memory storage and processors has been steadily declining while the power and performance of such devices have been increasing at a relatively rapid pace. As a result a given amount of memory e.g. DRAM today costs substantially less to a consumer than what the same amount would have cost just a few years ago. Many experts expect this trend to continue at least in the near future. Wide Area Network WAN traffic costs however have not shown the same rapid decline in pricing and increase in performance as computer processing and storage. For a variety of reasons communications over WANs such as the Internet have been slower to advance in real terms and thus are often the source of bottlenecks in performance for many systems.

Today an ever increasing number of applications and services are being made available over networks such as the Internet. Many content application and or service providers are turning to technologies such as remote resource sharing and cloud computing. Cloud computing is a general term often used to describe the process of providing access to electronic resources through services such as Web services where the hardware and or software used to support those services is made to be dynamically scalable to meet the needs of the services at any given time. A user or customer typically will rent lease or otherwise pay for access to resources through the cloud and thus does not have to purchase and maintain the hardware and or software to provide access to these resources. A service provider that owns those resources will usually take on the responsibility of maintaining and managing the resources ensuring that they are highly available scalable and otherwise ready to provide the necessary services.

In such cloud environments users frequently want their data transformed in some specified way. In light of the slower advancements of network communications mentioned above moving large amounts of raw data across network connections is not always ideal and may take longer than what can be tolerated by many systems. There is currently no solution for transforming data that takes advantage of cloud computing and virtual machines while at the same time reducing the amount of data that needs to be delivered over a WAN.

In the following description various embodiments will be illustrated by way of example and not by way of limitation in the figures of the accompanying drawings. References to various embodiments in this disclosure are not necessarily to the same embodiment and such references mean at least one. While specific implementations and other details are discussed it is to be understood that this is done for illustrative purposes only. A person skilled in the relevant art will recognize that other components and configurations may be used without departing from the scope and spirit of the claimed subject matter.

Systems and methods in accordance with various embodiments of the present disclosure may overcome one or more of the foregoing or other deficiencies experienced in conventional approaches for transcoding transforming and or otherwise processing content. In particular various embodiments provide approaches for using virtual machines and or virtual networks for transcoding and processing content in a multi tenant networking and computing environment.

In accordance with various embodiments a virtual machine based transcoding system is described that enables any transcoding provider or other user that wishes to offer their content processing algorithms to make their transcoding service available to other users over a network such as the Internet. The system can automate the deployment execution and delivery of the transcoding service on behalf of the transcoding provider and enable other users e.g. content publishers etc. to use the transcoding services to transcode and or otherwise process their content e.g. audio video multimedia and other data . For example the system may allow a content publisher such as a content creator owner or distributor to upload or otherwise provide their media content to a specified location and request that transcoding be performed. In various embodiments the virtual machine based transcoding system can be provided by a service provider e.g. cloud computing provider in a multi tenant computing environment e.g. cloud computing environment .

In accordance with an embodiment the transcoding provider provides a complete virtual machine image to the system. The virtual machine image can include a combination of an operating system and other software resources that will be instantiated by the system to perform the transcoding. In one embodiment the virtual machine image includes all of the necessary resources to perform the transcoding and does not rely on establishing any network connections to any external entities.

Once the virtual machine image is received the service provider may enable content publishers to request to use the transcoding service contained in the machine image on their media that the system might be storing. In accordance with an embodiment once the system receives a request to transcode a set of content such as media content the system can first transfer the virtual machine image to the location where that media content is stored. Because the media content is often substantially larger in size than the virtual machine image it can be advantageous to transmit the code to the data rather than the other way around.

In accordance with an embodiment once the virtual machine image is transferred to the location of the media content the system can create a virtual private network that includes one or more compute instances or other resources for performing the transcoding of media or other content. In one embodiment the virtual private network can be firewalled off from initiating connections with any external clients in order to prevent any potentially malicious users posing as legitimate transcoding providers from compromising the security or digital rights associated with the media content. Because the virtual network is effectively disconnected from external entities the only malicious action that can be possibly taken by the transcoding service is to return corrupted data which can be readily detected by the owner of the media content. In accordance with one embodiment this restriction of access implies that the virtual private network should not rely on any external libraries or other services in order to perform its functions. In addition the firewall can restrict access from external entities to the compute instances inside the virtual private network in order to prevent any theft or other malicious acts on the resources contained inside the virtual private network. In this manner the content publisher is not allowed to steal the transcoding algorithms or code from the virtual private network while still being able to utilize those transcoding algorithms on its content.

In accordance with an embodiment the virtual network is configured to listen on a port using a standard protocol connection e.g. HTTP server listening on port 80 which may have been agreed upon in advance between the service provider and the transcoding provider. This allows the content publisher to provide its media content to the virtual network in order to carry out the transcoding. The virtual network can allow data to be posted in a predetermined location e.g. specific file directory along with appropriate metadata that indicates the source and destination formats. These formats will be used by the virtual network to transcode the media content. In at least one embodiment the media content can be streamed into the virtual network and the virtual network can stream transcoded content in response to another predetermined location.

In accordance with various embodiments the content publisher may simply select which transcoding algorithms makes sense for their business and then invoke an interface e.g. an application programming interface API to specify when a set of content needs to be transcoded. The interface can take into account where the data is located and what kind of transformation or transcoding is being requested.

In accordance with various embodiments the service provider may implement a billing service that computes the charges e.g. price per megabyte for any customer that wishes to utilize the transcoding service. Customers can also be allowed to rate the quality of transcoding performed by the transcoding service. In some embodiments the transcoding provider may also be charged a fee for utilizing the resources of the service provider e.g. cloud computing provider to carry out the transcoding of data.

It should be noted that although the various portions of this disclosure refer to examples of transcoding media content this is not a necessary limitation to all of the embodiments described herein. In various alternative embodiments the principles and embodiments mentioned herein may be applied to any type of transforming and other processing of content including but not limited to data mining or analysis image recognition transmuxing digital watermarking segmenting applying access controls adding meta data inserting advertisements translating into various languages transcribing changing bit rates sequencing changing or adding audio associated with a video or modifying customizing or making compatible various other features of content in any other manner.

In the illustrated embodiment a service provider maintains a number of resource centers which may be geographically distributed. The resource centers may include any data center server farm content delivery network point of presence POP or any other location that hosts the various resources of the service provider. In accordance with various embodiments a resource center may include various computer servers data storage machines network devices and other hardware resources necessary to provide services or resources to the clients of the service provider. For example as shown in the resources provided may include a number of virtual private networks and data stores which may be used to store media content and other data.

In accordance with various embodiments the service provider can make these resources available to various transcoding providers content publishers and viewers over a network . As used throughout this disclosure a network can be any wired or wireless network of devices that are capable of communicating with each other including but not limited to the Internet or other Wide Area Networks WANs cellular networks Local Area Networks LANs Storage Area Networks SANs Intranets Extranets and the like. The resource centers can include any physical or logical grouping of resources such as a data center a server farm and the like.

In accordance with an embodiment a content publisher may provide e.g. upload a set of media content to a store of the service provider and specify that a particular transcoding or other transforming algorithm be applied to the media content. In various embodiments a content publisher may be any content creator content distributor user generated content publisher or any other entity that possesses media content and desires to transcode transform or otherwise process that content. Examples of content creators may be motion picture studios universities producing educational content private organizations producing internal video content and other organizations such as online real estate and auto sales companies producing videos to increase sales. Content distributors may be cable and television service providers music distributors movie purveyors and the like. Examples of user generated content publishers may be social media companies video uploading services and any other entity that stores content on behalf of its viewers. In various embodiments any user or entity that owns a piece of media content may fulfill the role of a content publisher.

In accordance with an embodiment a transcoding provider may provide a virtual machine image to the service provider and this virtual machine image may be used to instantiate one or more virtual private networks of resources that will perform the transcoding of media. A virtual network can be created on any existing resource center of the service provider by transferring the virtual machine image to that resource center and instantiating all of the resources contained in the image.

In accordance with an embodiment a virtual machine image is a virtual appliance which can be used to instantiate or create virtual machines on the resource center of the service provider. These virtual machines may be linked or connected to create a virtual network that can be used to perform the various services described herein. As demand for these services grows or shrinks any number of virtual machines e.g. compute instances server instances etc. can be added to or removed from the virtual network. In various embodiments the virtual private network enables a user e.g. transcoding provider to provision a private isolated section of the service provider s network where resources e.g. virtual machines can be instantiated. In accordance with an embodiment the user may specify any network topology including selection of internet protocol IP address range creation of subnets and configuration of route tables and network gateways.

In the illustrated embodiment the transcoding provider provides a virtual machine image to a resource center of the service provider . The resource center may be located in a particular geographic location such as New York N.Y. USA. The resource center may include its local hardware infrastructure that runs the various virtual resources and other software resources provided by the service provider .

Furthermore a different user e.g. content publisher may provide its media content to the service provider and request to transcode the media content or otherwise transform it in some manner. In various embodiments the media content may be uploaded in a different resource center located in a remote geographic location from where the virtual machine image is stored. For example as shown in the illustration resource center may be located in Singapore or any other remote destination. In various embodiments the resource centers in can be any location having its own local hardware infrastructure such as a data center server farm network point of presence POP and the like. In at least one embodiment the resource center is remote with respect to the resource center in a sense that they must communicate over a wide area network WAN connection rather than a local area network LAN connection. In an alternative embodiment the resource center is remote with respect to the resource center in that communications within each resource center intra center communications are performed over a different protocol or are faster by more than a threshold limit than communications between the resource centers inter center communications .

In accordance with an embodiment rather than transferring the media content which may be considerably large between these remote locations the service provider transfers a copy of the virtual machine image to resource center . In accordance with one embodiment there may be a control service that handles creating the virtual networks and starting up the machine images in the appropriate place.

Once the virtual machine image is received in resource center the service provider may launch the virtual network locally in the same data center as the media content. In accordance with various embodiments a virtual machine image can serve as a unit of deployment for any service that is desired to be delivered using the resources of the service provider . For example the virtual machine image may be a read only file system image which includes an operating system e.g. Linux UNIX or Windows and any additional software used to deliver a service or a portion of a service. In accordance with various embodiments the file system can be compressed encrypted signed and or divided into segments and uploaded into data stores of the service provider for storage. An XML manifest file may be used to store information about the virtual machine image including its name version architecture default kernel id decryption key and digests for all of the segments of the file system.

In accordance with an embodiment the virtual machine image is used to construct a virtual network of resources such as virtual machines server instances compute instances or the like. This virtual network will be designated to perform the transcoding or other processing of content . In an alternative embodiment rather than constructing a new virtual network the system may instead select one of the existing virtual networks that is capable of performing the transcoding. For example the system may select one of the virtual private networks of the transcoding provider that may be running in the resource center . In various embodiments each virtual network on the system may be associated with its owner user e.g. content publisher transcoding provider etc. . In these embodiments other users are restricted or precluded access from the virtual private network.

In one embodiment no other entities reside in the virtual network besides the transcoding service specified in the virtual machine image and the virtual network is restricted from any external network connectivity by using a firewall . For example the resources of the virtual network can be prevented from initiating any network connections with external clients over the Internet. As such no matter how malicious the transcoding virtual machine image is there is nothing it is allowed to do with the media content other than to send back corrupted data but this would be detectable by the content publisher or service provider . By restricting the virtual network in such a manner the transcoding provider is precluded from siphoning off data to a side channel posting the data on the Internet and performing other undesirable actions. In addition external entities are restricted from accessing the resources inside the virtual network . This prevents the content publisher or other malicious users from stealing or corrupting the transcoding algorithm or other information inside the virtual network.

In accordance with an embodiment the secured nature of the virtual network implies that the virtual machine image does not rely on making any network connections to external entities such as libraries web services and the like. Thus in one embodiment the virtual machine image is a stand alone all inclusive software package that can be used to start up any number of resource instances for performing the transcoding or other processing of content.

In accordance with an embodiment the virtual network listens on a specified port in a predetermined protocol that has been agreed upon by the service provider and the transcoding provider . In one embodiment the virtual network may not initiate connections and is only allowed to respond to incoming requests. The media content can be provided to e.g. streamed to the virtual network over the predetermined port. Alternatively the content may be posted to a known resource location directory transform with appropriate meta information indicating the source and destination formats and other information needed to perform the transcoding. Once the virtual network performs the transcoding it can provide the transcoded media content in response to request. In one embodiment the virtual network may stream the transcoded content back to a designated recipient location or the like.

In the illustrated embodiment the virtual private network may be comprised of a plurality of compute instances behind a firewall wherein the compute instances execute a transcoding algorithm provided by the transcoding provider. These compute instances can be managed by the service provider and the number of instances can be automatically scaled up or down according to demand for the transcoding algorithm. In one embodiment each compute instance is a virtual server resource or virtual machine node having a specific processing capacity and memory associated therewith which allows the service provider to meter the usage of the transcoding service by each client e.g. the service provider may charge the transcoding provider per hour of computing resources consumed . In an alternative embodiment the compute instances can be actual server machines in the resource center maintained by the service provider.

In accordance with an embodiment the service provider may provide a set of web services application programming interfaces APIs or management console to allow content publishers and other users to utilize the virtual machine based transcoding system. For example a content publisher may provide content to a store of the service provider and use the console or APIs to select which transcoding algorithms e.g. encoders are appropriate for their business. Alternatively this selection can be made by using a configuration file e.g. XML file user interface service calls or any other methods known in the art. Once an encoder is selected the content publisher may call the API whenever they would like a set of content transcoded. The API may determine where e.g. which resource center the data is located and what kind of transformation is being requested.

In accordance with an embodiment the service provider may provide a rating service that enables the various users who have actually used the transcoding system to issue ratings for the different transcoding providers and their individual algorithms. For example if scaled down images were being overly pixelated users may review the transcoding and complain and give it a low numeric rating which other customers could see. Additionally the service provider may provide a market place e.g. similar to an online application store for mobile phone devices where the various users e.g. media content owners may shop and compare the different transcoding providers and their individual services. For example the market place may display a number of different transcoding algorithms or other content processing services along with their prices and ratings in order to enable a user to review compare and select between the various services. In at least one embodiment the market place can retrieve the various ratings from the rating service and render them on the interface to select the transcoding algorithms.

In addition to or in the alternative to the rating service the service provider may detect which transcoding providers and or algorithms have failed most frequently and keep track of such information. This can allow the service provider to shut down those transcoders that are not performing well. For example if a transcoding algorithm fails to receive the entirety of the input stream the algorithm may be flagged as potentially malfunctioning. The service provider may then shut down the failing transcoders contact the transcoding providers publish the information e.g. lower rating to various users or perform other corrective actions. In some embodiments the service may also implement pirate detection where the activity of the virtual machines or other resources performing the transcoding are monitored to make sure that they are not attempting to copy information or perform other pirating acts. For example if the transcoding instances are detected to be simultaneously spooling the media content or performing other unwarranted actions the transcoding provider may be flagged as being potentially malicious.

In accordance with an embodiment the service provider may also maintain a billing service that meters the content processed by the virtual network and computes a charge for any user associated transcoding the content based at least in part on the metering of the content processed by the virtual network. For example the system that transferred the content into the transcoding machine may keep track of the number of bytes sent in. The service provider may then reconcile those bytes with the price established by the transcoding provider and charge the users using the transcoding service on behalf of the transcoding provider. In addition the service provider may charge the transcoding provider for utilizing the resources e.g. servers hardware etc. of the service provider. A variety of different charging or billing techniques can be utilized in accordance with the embodiments described herein. For example the billing service can receive input or instructions regarding the charging from the owner of the transcoding algorithm and apply the instructions to compute the appropriate charges for the content publishers and other users that utilize those algorithms.

In accordance with an embodiment the service provider may also deploy a prediction service that estimates a prediction of likely future demand for the transcoding service being provided by the virtual network based at least in part on a history of requests and starts up additional compute instances or other resources in the virtual network to match the prediction of likely demand. In various embodiments the process for instantiating a compute instance may take some time in order to configure and test the instance before allowing it to begin processing content. As such it may be desirable to pre instantiate such compute instances and other resources if demand for a particular transcoding algorithm is rapidly increasing. In one embodiment the prediction service may be deployed and running in the resource center and based on past historical requests both in aggregate and on a per customer basis the prediction service can ensure that enough compute instances and virtual networks remain available within resource center so that future likely demand can be satisfied quickly rather than instantiating each compute instance upon request which may otherwise introduce unnecessary latency .

In operation the service provider receives a virtual machine image from a transcoding provider. The virtual machine image may be received in any resource center or location owned by a service provider. In accordance with an embodiment the virtual machine image contains the operating system and other resources that can be instantiated to perform a transcoding or other processing algorithm on content.

In operation the service provider may receive a request to transcode or otherwise process a set of content e.g. media content . The media content may be stored in a different resource center or geographic location than the virtual machine image. For example the transcoding provider may have uploaded the virtual machine image in San Francisco and a content publisher in Hong Kong may wish to employ the transcoding service developed by the transcoding provider on its media stored in Hong Kong.

In operation the service provider transmits the virtual machine image to the location where the media content is stored. Following the example above the service provider would transfer a copy of the virtual machine image from the resource center in San Francisco to the resource center maintained in Hong Kong. The transfer may take place by any WAN based or other electronic communication such as file transfer protocol FTP or the like.

In operation the service provider instantiates a virtual private network based on the virtual machine image in the same location where the content is stored. Following the example above the virtual network would be created in the Hong Kong resource center by instantiating a number of compute instances that will be responsible for performing the transcoding of the media content. Alternatively the system may instead select one of the existing virtual networks that will be used to perform the transcoding. In accordance with some embodiments the system may perform a cost benefit analysis to determine whether to utilize an existing virtual network or to create a new virtual network. For example the system may inspect the availability of existing virtual networks the size of the media content to be transcoded the size of the virtual machine image that would need to be transferred the bandwidth speed of the network connections as well as any other variables related to the transcoding job. Based on these or other factors the system may predict the cost and latency for creating a new virtual network versus using an existing virtual network and determine which option to utilize for transcoding. In one embodiment the virtual private network is firewalled to restrict any external access from within the virtual network. In this embodiment the resources of the virtual network are not allowed to open any connections to entities that reside outside of the virtual network and may only respond to certain requests by performing specific actions.

In operation the service provider enables the resources e.g. compute instances of the virtual private network to access the content stored in the resource center. Following the example above the new virtual network would be allowed to access the media content of the Hong Kong publisher in order to transcode the media content. The content may be streamed into the virtual private network or posted in a designated location for transcoding content.

In operation the resources of the virtual private network transcode or otherwise process the content. For example the media content may be transcoded from H.264 format to MPEG 4 format or the like. Some examples of the various media formats may include but are not limited to H.264 MPEG 4 AVC M JPEG MPEG 4 OGG Theora VP8 WebM VC1 SMPTE as well as any other media formats and encodings that are known in the art. In accordance with an embodiment once the media content has been transcoded it can be returned by the virtual network in response to an appropriate request. In one embodiment the transcoded content may be streamed while it is being transcoded.

Various embodiments discussed or suggested herein can be implemented in a wide variety of operating environments which in some cases can include one or more user computers computing devices or processing devices which can be used to operate any of a number of applications. User or client devices can include any of a number of general purpose personal computers such as desktop or laptop computers running a standard operating system as well as cellular wireless and handheld devices running mobile software and capable of supporting a number of networking and messaging protocols. Such a system also can include a number of workstations running any of a variety of commercially available operating systems and other known applications for purposes such as development and database management. These devices also can include other electronic devices such as dummy terminals thin clients gaming systems and other devices capable of communicating via a network.

Most embodiments utilize at least one network that would be familiar to those skilled in the art for supporting communications using any of a variety of commercially available protocols such as TCP IP OSI FTP UPnP NFS CIFS and AppleTalk. The network can be for example a local area network a wide area network a virtual private network the Internet an intranet an extranet a public switched telephone network an infrared network a wireless network and any combination thereof.

In embodiments utilizing a Web server the Web server can run any of a variety of server or mid tier applications including HTTP servers FTP servers CGI servers data servers Java servers and business application servers. The server s also may be capable of executing programs or scripts in response requests from user devices such as by executing one or more Web applications that may be implemented as one or more scripts or programs written in any programming language such as Java C C or C or any scripting language such as Perl Python or TCL as well as combinations thereof. The server s may also include database servers including without limitation those commercially available from Oracle Microsoft Sybase and IBM .

The environment can include a variety of data stores and other memory and storage media as discussed above. These can reside in a variety of locations such as on a storage medium local to and or resident in one or more of the computers or remote from any or all of the computers across the network. In a particular set of embodiments the information may reside in a storage area network SAN familiar to those skilled in the art. Similarly any necessary files for performing the functions attributed to the computers servers or other network devices may be stored locally and or remotely as appropriate. Where a system includes computerized devices each such device can include hardware elements that may be electrically coupled via a bus the elements including for example at least one central processing unit CPU at least one input device e.g. a mouse keyboard controller touch screen or keypad and at least one output device e.g. a display device printer or speaker . Such a system may also include one or more storage devices such as disk drives optical storage devices and solid state storage devices such as random access memory RAM or read only memory ROM as well as removable media devices memory cards flash cards etc.

Such devices also can include a computer readable storage media reader a communications device e.g. a modem a network card wireless or wired an infrared communication device etc. and working memory as described above. The computer readable storage media reader can be connected with or configured to receive a computer readable storage medium representing remote local fixed and or removable storage devices as well as storage media for temporarily and or more permanently containing storing transmitting and retrieving computer readable information. The system and various devices also typically will include a number of software applications modules services or other elements located within at least one working memory device including an operating system and application programs such as a client application or Web browser. It should be appreciated that alternate embodiments may have numerous variations from that described above. For example customized hardware might also be used and or particular elements might be implemented in hardware software including portable software such as applets or both. Further connection to other computing devices such as network input output devices may be employed.

Storage media and computer readable media for containing code or portions of code can include any appropriate media known or used in the art including storage media and communication media such as but not limited to volatile and non volatile removable and non removable media implemented in any method or technology for storage and or transmission of information such as computer readable instructions data structures program modules or other data including RAM ROM EEPROM flash memory or other memory technology CD ROM digital versatile disk DVD or other optical storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can be accessed by a system device. Based on the disclosure and teachings provided herein a person of ordinary skill in the art will appreciate other ways and or methods to implement the various embodiments.

The specification and drawings are accordingly to be regarded in an illustrative rather than a restrictive sense. It will however be evident that various modifications and changes may be made thereunto without departing from the broader spirit and scope of the invention as set forth in the claims.

