---

title: Convenient provisioning of embedded devices with WiFi capability
abstract: A WiFi-enabled embedded device boots as a first access point. The WiFi-enabled embedded device communicates with a first wireless station to receive configuration parameters while continuing to operate as an access point. The WiFi-enabled embedded device then applies the configuration parameters internally to cause the WiFi-enabled embedded device to operate as a second wireless station. In an embodiment, the first wireless station discovers a configuration service advertized by the WiFi-enabled embedded device using mDN/DNS-SD, and automatically provides the configuration parameters to the WiFi-enabled embedded device. Convenient provisioning of the WiFi-enabled embedded device is thus made possible.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08665744&OS=08665744&RS=08665744
owner: Gainspan Corporation
number: 08665744
owner_city: San Jose
owner_country: US
publication_date: 20120518
---
Embodiments of the present disclosure relate generally to WiFi enabled embedded devices and more specifically to techniques for convenient provisioning of embedded devices with WiFi capability.

Embedded devices refer to devices which operate with minimal processing and or memory capabilities to the point they generally have minimal user interfaces e.g. LEDs and switches but not support for much bigger displays such as monitors or graphical user interfaces as is well known in the relevant arts. Embedded devices find use in a broad range of electronic environments such as consumer electronics refrigerators lighting equipment televisions printers etc. automotives e.g. cars and industrial electronics.

WiFi capability is often provided integral to such embedded devices. Such capability implies that the device is provided with the necessary hardware and software to operate in accordance with IEEE 802.11 standards. Such capability is generally important since the resulting communication can form the basis for various tasks such as data acquisition management applications maintenance scheduling etc.

However embedded devices need to be provisioned before such WiFi capability is usable. Provisioning entails various configurations such that the embedded device can thereafter communicate with other desired devices on the network.

The drawing in which an element first appears is indicated by the leftmost digit s in the corresponding reference number.

An aspect of the present invention enables convenient provisioning of WiFi enabled embedded devices. A WiFi enabled embedded device boots as a first access point. The WiFi enabled embedded device communicates with a first wireless station to receive configuration parameters while continuing to operate as an access point. The WiFi enabled embedded device then applies the configuration parameters internally to thereafter operate as a second wireless station.

According to another aspect the first wireless station discovers a configuration service advertized by the WiFi enabled embedded device using mDN DNS SD and automatically provides the configuration parameters to the WiFi enabled embedded device.

According to yet another aspect the WiFi enabled device provides a service based on HTTP using which the first wireless station communicates with the WiFi enabled embedded device and automates several aspects of the provisioning.

Several aspects of the invention are described below with reference to examples for illustration. It should be understood that numerous specific details relationships and methods are set forth to provide a full understanding of the invention. One skilled in the relevant arts however will readily recognize that the invention can be practiced without one or more of the specific details or with other methods etc. In other instances well known structures or operations are not shown in detail to avoid obscuring the features of the invention.

Wireless station is designed to operate according to the specifications of a wireless station or client in an IEEE 802.11 WLAN standards. Access point operates as a switch providing connectivity between various wireless stations. Access point may be provided with connectivity to external networks not shown also such that the wireless stations are provided connectivity to systems on such networks as well. Access point operates in accordance with IEEE 802.11 WLAN standards.

WiFi enabled embedded device represents an embedded device which has wireless communication capability according to IEEE 802.11 standards and which may have minimal or no user interface. As an example WiFi enabled embedded device may be a pressure sensor that records pressure measurements of a corresponding physical quantity. It may be desired to transmit the pressure measurements to AP which may either process the measurements or forward the measurements to another device either within or external to WLAN that may process the measurements. Other examples include microwave oven smart plug etc.

However the minimal or no user interface e.g. in the form of display keypad buttons etc in WiFi enabled embedded device may pose a problem for its provisioning. Alternatively even if such user interface were present WiFi enabled embedded device may be physically located in a place that may be difficult to access for manual configuration.

Due to the minimal or no user interface provisioning of WiFi enabled embedded device may be difficult or cumbersome. Provisioning or configuration refers to configuration of various parameters such as an identifier of a network i.e. access point WiFi enabled embedded device should associate with any authentication information to be used prior to such association and any other information as deemed convenient necessary for providing Wi Fi connectivity to device .

Several aspects of the present invention enable WiFi enabled embedded device to be provisioned wirelessly through a wireless station wireless station in the example of as described next.

Further the steps in the flowchart are described in a specific sequence merely for illustration. Alternative embodiments using a different sequence of steps can also be implemented without departing from the scope and spirit of several aspects of the present invention as will be apparent to one skilled in the relevant arts by reading the disclosure provided herein. The flowchart starts in step in which control passes immediately to step .

In step WiFi enabled embedded device boots as a first access point. As is well known in the relevant arts booting refers to the operation s of loading and executing a set of modules or routines upon powering on of the device without requiring user intervention etc. Thus to boot as an access point the set of modules that are executed needs to include those instructions that enable device to thereafter operate as an access point AP as defined by the IEEE 802.11 standards. Accordingly after being powered on WiFi enabled embedded device performs operation of an AP such as for example one or more of transmission of beacons responding to probe request messages etc. Booting as an AP enables wireless stations such as wireless station to associate with WiFi enabled embedded device and thereafter configure WiFi enabled embedded device as described below. Control then passes to step .

In step WiFi enabled embedded device communicates with wireless station to receive configuration parameters. Communication entails exchange of data packets. In an embodiment described below such communication occurs on initiation by wireless station . Wireless station associates with WiFi enabled embedded device now operating as an AP according to the specifications of the IEEE 802.11 standards. WiFi enabled embedded device continues to operate as an AP while receiving the configuration parameters from wireless station . The configuration parameters include the SSID of a target AP to which WiFi enabled embedded device is to associate with as well as any authentication information e.g. passwords required prior to such association.

SSID and authentication information is merely representative. However the configuration parameters can also include other parameters related to other layers of the networking stack as t may be required for the device to establish IP connectivity when it changes state to operate as a second wireless station as described in step . The data exchanged between WiFi enabled embedded device and wireless station during the communication of step may be encrypted for example according to secure socket layers SSL technology . The key s required for deciphering the communication may be stored a priori in WiFi enabled embedded device and wireless station . Control then passes to step .

In step WiFi enabled embedded device applies the configuration parameters internally to cause WiFi enabled embedded device to operate as a second wireless station. Application of the configuration parameters refers to storing of the values of the configuration parameters in appropriate locations and performing any other necessary operation to thereafter enable device to associate with another desired target AP while operating as a wireless station second wireless station according to IEEE 802.11 standards.

Thus assuming the configuration information specifies AP as the target AP WiFi enabled embedded device assumes the role of a wireless station according to IEEE 802.11 and may scan the radio channels specified for WLAN operation by IEEE 802.11 for beacons transmitted from AP . Subsequent to receipt of such a beacon WiFi enabled embedded device associates with AP after providing the requisite authentication information. Alternatively WiFi enabled embedded device operating as a wireless station may exchange probe request probe response packets prior to association with the target AP AP in the example . Control then passes to step in which the flowchart ends.

After associating with the target AP WiFi enabled embedded device may exchange information data packets with AP . By specifying appropriate values for configuration parameters device may be forced to operate with desired AP WiFi network. In an embodiment WiFi enabled embedded device is implemented with several capabilities to make the provisioning operations noted above more convenient and requiring minimal or no user intervention as described next.

In an embodiment when WiFi enabled embedded device boots up to operate as an access point AP the device sends beacons according to 802.11 standards. The beacons can be the basis on which wireless station can associate with WiFi enabled embedded device to establish layer 2 connectivity . Alternatively probe requests can also be the basis for such connectivity.

WiFi enabled embedded device may be implemented with DHCP server software thereby providing a layer 3 Internet Protocol address to wireless station if so requested by wireless station . WiFi enabled embedded device may be designed to choose an appropriate IP network address that does not conflict any pre existing network should one be operative at the time of deployment of WiFi enabled embedded device . Once an IP address is allocated to both of WiFi enabled embedded device and wireless station in a same IP network the two devices are ready for communication using IP over wireless connection 802.11 standards . WiFi enabled device may also be implemented with SSL software to allow secure communication at layer 3.

mDNS DNS SD techniques may thereafter be used to enable automatic discovery by wireless station of the provisioning web application provided in WiFi enabled embedded device . DNS SD is specified by IETF draft DNS Based Service Discovery published on Dec. 9 2011 by the Internet Engineering Task Force IETF and mDNS is specified in Multicast DNS draft cheshire dnsext multicastdns 15 published on Dec. 9 2011 by the Internet Engineering Task Force IETF .

For the operation of mDNS DNS SD based techniques it is first assumed that the necessary layer 2 and layer 3 communication is established between device operating as an AP and wireless station . Device then advertises using a multi cast destination IP address a provisioning service that the client devices wireless stations can interact with. Thus multi cast packet is received by all wireless stations though only one shown in that have associated with device as an AP. It is assumed that wireless station is designed to process packets with such a multi cast destination address and station operating as a resolver discovers the provisioning service available on device . Alternatively a broadcast address can be used instead of multicast address to facilitate discovery.

The service may be identified by a service URI at which the service is accessible using HTTP type protocols. Thus as a part of the discovery WiFi enabled embedded device makes available the service URI to wireless station . Wireless station accordingly needs to be implemented with compatible software to make use of the features provided at the service URI in device to at least provide values for various configuration parameters.

In a simple case such compatible software is provided in the form of a web application made available on WiFi enabled embedded device . This web application is downloaded using a URI web application URI that may also be made available automatically during discovery using the techniques described above. Wireless station executes the downloaded web application which facilitates a user to fill the fields corresponding to respective configuration parameters with appropriate values and return the corresponding values to WiFi enabled device . The web application communicates these user input fields to WiFi enabled device using the service URI described above.

In another case mobile applications when wireless station corresponds to a mobile device phone may use the service at the above mentioned service URI to transmit configuration parameters to the device after interacting with the user. In yet another case the configuration parameters may be transmitted to the device without any interaction with the user machine to machine communications . For example a module executing within wireless station may identify the SSID of access point and authentication information required for interfacing with access point and include the identified information as values of configuration parameters sent to device . The values may be sent using the APIs provided on device . Once properly configured with the received values device may operate as a wireless station in conjunction with AP as described above.

Prior to or as a part of step described above WiFi enabled embedded device may scan the 802.11 specified frequency channels to locate active available access points while continuing to operate as an access point. WiFi enabled embedded device may thus compile a list of available APs and communicate the list of APs to wireless station . Wireless station can then specify the specific according to techniques described above one of the APs in the list as the target AP that WiFi enabled embedded device is to associate with. In this embodiment WiFi enabled embedded device operates as an AP to permit wireless station to associate with it and also scans channels for available access points. The scanning duration may be set long enough to find beacons from all available APs in the vicinity.

Thus using the techniques of mDNS DNS SD WiFi enabled embedded device can be provisioned with Wi Fi capability while requiring minimal potentially zero manual effort from a user.

Such minimal manual effort can be beneficial in several environments. For example WiFi enabled embedded device may represent a smart mains plug main extension box . Such a mains plug is an embedded device with WiFi capability and may have a micro controller for selectively switching ON or switching OF one or more mains power outlets provided in the plug. In addition the mains plug may also have power usage monitoring capability to monitor the amount of power consumed by devices e.g. TVs refrigerators connected to the power outlets. The main plug may have minimal or no user interface.

After purchase of such a smart mains plug a user may power the smart plug from a power outlet in his her house. The user may wish the smart plug to communicate with an access point in the house and via the access point to a computer for obtaining power use measurements etc. The smart plug boots as an AP and can communicate with for example the users mobile phone with wireless station functionality . The mobile phone can send configuration parameters to the smart plug now operating as an AP itself as described above. After applying the configuration parameters the smart plug operates as a wireless station to exchange data with the access point already installed in the house and thereby with the user s computer.

The convenient provisioning of above may be complemented with WPS Push Button feature specified by the WiFi protected setup WPS in the IEEE 802.11 specifications. According to this feature the provisioning web application in WiFi enabled embedded device causes a soft button to be displayed on a corresponding configuration web page viewed on wireless station . The user of wireless station is prompted to push the soft WPS button which causes configuration of WiFi enabled embedded device as described above.

In yet another embodiment the convenient provisioning of above is complemented by WPS PIN method as specified by IEEE 802.11 specifications. According to this feature the provisioning web application in WiFi enabled embedded device requests for the entry of a number PIN or Personal Identification Number on the corresponding configuration web page viewed on wireless station . Once the PIN is entered the configuration of WiFi enabled embedded device is performed in a manner similar to that described in detail above.

After completion of initial configuration in accordance with the flowchart of the WiFi enabled device can be put back into the provisioning mode by pressing a button or by sending a command over the network according to a pre specified convention. In case of a button the WPS button could be overloaded for example an extended push to function as a button that also puts the device into provisioning mode.

It is noted that communication between WiFi enabled embedded device and wireless station for example as would be performed in step of the flowchart of can be protected by WPA Wi Fi Protected Access or WPA2 Wi Fi Protected Access II security protocols at layer 2 and SSL security at layer 3.

Also the steps of and of the flowchart of can be re executed even after WiFi enabled embedded device has been provisioned once. For example even after WiFi enabled embedded device has associated with AP based on execution of steps and of the flowchart of a user can cause steps and to be re executed with a different set of configuration parameters. As an example a user can thus cause association of WiFi enabled embedded device with an AP not shown in other than AP . Such re execution can be triggered by the use of an API as well.

The components blocks of WiFi enabled embedded device are shown merely by way of illustration. However device may contain more or fewer components blocks.

Antenna operates to receive from and transmit to a wireless medium corresponding wireless signals containing data. Switch may be controlled by processing block connection not shown to connect antenna either to receive block via path or to transmit block via path depending on whether WiFi enabled embedded device is to receive or transmit. In another embodiment the receive and transmit blocks are each connected to separate antennas to enable simultaneous reception and transmission.

Transmit block receives data to be transmitted via antenna on path from processing block generates a modulated radio frequency RF signal according to IEEE 802.11 standards and transmits the RF signal via switch and antenna . Receive block receives an RF signal according to IEEE 802.11 standards bearing data via switch and antenna demodulates the RF signal and provides the extracted data to processing block on path .

Non volatile memory stores instructions which when executed by processing block enables WiFi enabled embedded device to be provisioned as described in detail above. Accordingly non volatile memory may be viewed as a non transitory machine computer readable medium which provides instructions that cause several features of the present invention to be operative. In the embodiments described above such software instructions may include support for mDNS DNS SD DNS server DHCP server HTTP TCP IP stacks as described above etc. Non volatile memory may in addition store web pages and other configuration data both for the provisioning as well as the values received by communication with wireless station .

Volatile memory RAM may be used to store data and temporary variables to be processed by processing block in providing desired features. In particular instructions and data representing the software modules and variables for enabling WiFi enabled embedded device to be provisioned as described above may be copied by processing block from non volatile memory to RAM for execution.

Volatile memory and non volatile memory constitute computer program products or machine computer readable medium which are means for providing instructions to processing block . Processing block may contain multiple processing units internally with each processing unit potentially being designed for a specific task. Alternatively processing block may contain only a single general purpose processing unit. The instructions executed by processing block enable WiFi enabled embedded device to perform the steps of the flowchart of .

It should be appreciated that WiFi enabled embedded device may have additional mechanisms which prevent the operation of the flowchart of once the provisioning is complete. For example non volatile memory may store configuration flag with a first value indicating that the device needs to be provisioned and being set to another value once the provisioning is successful. Thus the configuration flag is used to indicate whether WiFi enabled embedded device has received configuration parameters or not.

On subsequently powering ON after being powered OFF WiFi enabled embedded device determines the value of the configuration flag to determine if the configuration parameters have already been received. If the configuration flag indicates that the configuration parameters have already been received WiFi enabled embedded device does not perform the steps of the flowchart described above and instead powers ON as a wireless station directly and associates with the target AP for data exchange. Thus the provisioning operations of the flowchart described above need be done potentially only once.

References throughout this specification to one embodiment an embodiment or similar language means that a particular feature structure or characteristic described in connection with the embodiment is included in at least one embodiment of the present invention. Thus appearances of the phrases in one embodiment in an embodiment and similar language throughout this specification may but do not necessarily all refer to the same embodiment.

While various embodiments of the present invention have been described above it should be understood that they have been presented by way of example only and not limitation. Thus the breadth and scope of the present invention should not be limited by any of the above described embodiments but should be defined only in accordance with the following claims and their equivalents.

