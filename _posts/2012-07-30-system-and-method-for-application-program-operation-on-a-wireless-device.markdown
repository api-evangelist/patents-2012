---

title: System and method for application program operation on a wireless device
abstract: Embodiments described herein address mobile devices with non-secure operating systems that do not provide a sufficient security framework. More particularly, the embodiments described herein provide a set of applications to the device for providing security features to the non-secure operating system.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08699999&OS=08699999&RS=08699999
owner: BlackBerry Limited
number: 08699999
owner_city: Waterloo, Ontario
owner_country: CA
publication_date: 20120730
---
This application is a continuation of prior U.S. patent application Ser. No. 13 196 925 filed on Aug. 3 2011 now issued to patent as U.S. Pat. No. 8 254 884 which is a continuation of prior U.S. patent application Ser. No. 11 282 564 filed on Nov. 21 2005 now issued to patent as U.S. Pat. No. 8 045 958. The entire contents of U.S. patent application Ser. No. 13 196 925 and U.S. patent application Ser. No. 11 282 564 are hereby incorporated by reference.

The embodiments described herein relate generally to wireless devices and more particularly to providing a secure environment for applications running on wireless devices with non secure operating systems.

Wireless devices hereafter referred to as mobile devices include mobile phones and mobile e mail devices that typically have applications which allow users of these devices to perform a wide variety of functions including accessing or sending information playing games etc. These applications may be installed during the manufacture of these devices. Alternatively these applications may be made by a third party and installed after the manufacture of these devices.

The operating system of a mobile device provides an application programming interface API that provides access to data which may be sensitive and a task manager for controlling application execution. However typical operating systems lack a robust framework for addressing security and manageability of API access control as well as application control. Accordingly sensitive APIs i.e. APIs that provide access to sensitive information may be accessed by rogue applications without passing through any security framework. For example a sensitive API can be an API that allows access to a database of a corporate e mail application. That being said there are legitimate uses of APIs that must also be taken into consideration. In addition non secure operating systems on a mobile device often have no framework for allowing IT administrators to control which applications can be executed. Both API access control and application control for mobile systems are of particular concern to IT administrators who have a responsibility to protect confidential corporate information that reside on or are accessible by mobile devices.

It will be appreciated that for simplicity and clarity of illustration elements shown in the figures have not necessarily been drawn to scale. Further where considered appropriate reference numerals may be repeated among the figures to indicate corresponding or analogous elements. In addition numerous specific details are set forth in order to provide a thorough understanding of the embodiments described herein. However it will be understood by those of ordinary skill in the art that the embodiments described herein may be practiced without these specific details. In other instances well known methods procedures and components have not been described in detail so as not to obscure the embodiments described herein. Also the description is not to be considered as limiting the scope of the embodiments described herein.

The embodiments described herein generally relate to a mobile wireless communication device hereafter referred to as a mobile device that has a non secure operating system. Examples of applicable communication devices include pagers cellular phones cellular smart phones wireless organizers personal digital assistants computers laptops handheld wireless communication devices wirelessly enabled notebook computers and the like.

The mobile device is a two way communication device with advanced data communication capabilities including the capability to communicate with other mobile devices or computer systems through a network of transceiver stations. The mobile device may also have the capability to allow voice communication. Depending on the functionality provided by the mobile device it may be referred to as a data messaging device a two way pager a cellular telephone with data messaging capabilities a wireless Internet appliance or a data communication device with or without telephony capabilities . To aid the reader in understanding the structure of the mobile device and how it communicates with other devices and host systems reference will now be made to .

Referring first to shown therein is a block diagram of an exemplary embodiment of a mobile device . The mobile device includes a number of components such as a main processor that controls the overall operation of the mobile device . Communication functions including data and voice communications are performed through a communication subsystem . The communication subsystem receives messages from and sends messages to a wireless network . In this exemplary implementation of the mobile device the communication subsystem is configured in accordance with the Global System for Mobile Communication GSM and General Packet Radio Services GPRS standards. The GSM GPRS wireless network is used worldwide and it is expected that these standards will be superseded eventually by Enhanced Data GSM Environment EDGE and Universal Mobile Telecommunications Service UMTS . New standards are still being defined but it is believed that they will have similarities to the network behavior described herein and it will also be understood by persons skilled in the art that the embodiments described herein are intended to use any other suitable standards that are developed in the future. The wireless link connecting the communication subsystem with the wireless network represents one or more different Radio Frequency RF channels operating according to defined protocols specified for GSM GPRS communications. With newer network protocols these channels are capable of supporting both circuit switched voice communications and packet switched data communications.

Although the wireless network associated with mobile device is a GSM GPRS wireless network in one exemplary implementation other wireless networks may also be associated with the mobile device in variant implementations. The different types of wireless networks that may be employed include for example data centric wireless networks voice centric wireless networks and dual mode networks that can support both voice and data communications over the same physical base stations. Combined dual mode networks include but are not limited to Code Division Multiple Access CDMA or CDMA2000 networks GSM GPRS networks as mentioned above and future third generation 3G networks like EDGE and UMTS. Some other examples of data centric networks include WiFi 802.11 Mobitex and DataTAC network communication systems. Examples of other voice centric data networks include Personal Communication Systems PCS networks like GSM and Time Division Multiple Access TDMA systems.

The main processor also interacts with additional subsystems such as a Random Access Memory RAM a flash memory a display an auxiliary input output I O subsystem a data port a keyboard a speaker a microphone short range communications and other device subsystems .

Some of the subsystems of the mobile device perform communication related functions whereas other subsystems may provide resident or on device functions. By way of example the display and the keyboard may be used for both communication related functions such as entering a text message for transmission over the network and device resident functions such as a calculator or task list.

The mobile device may send and receive communication signals over the wireless network after required network registration or activation procedures have been completed. Network access is associated with a subscriber or user of the mobile device . To identify a subscriber the mobile device requires a SIM RUIM card i.e. Subscriber Identity Module or a Removable User Identity Module to be inserted into a SIM RUIM interface in order to communicate with a network. The SIM card or RUIM is one type of a conventional smart card that can be used to identify a subscriber of the mobile device and to personalize the mobile device among other things. Without the SIM card the mobile device is not fully operational for communication with the wireless network . By inserting the SIM card RUIM into the SIM RUIM interface a subscriber can access all subscribed services. Services may include web browsing and messaging such as e mail voice mail Short Message Service SMS and Multimedia Messaging Services MMS . More advanced services may include point of sale field service and sales force automation. The SIM card RUIM includes a processor and memory for storing information. Once the SIM card RUIM is inserted into the SIM RUIM interface it is coupled to the main processor . In order to identify the subscriber the SIM card RUIM can include some user parameters such as an International Mobile Subscriber Identity IMSI . An advantage of using the SIM card RUIM is that a subscriber is not necessarily bound by any single physical mobile device. The SIM card RUIM may store additional subscriber information for a mobile device as well including datebook or calendar information and recent call information. Alternatively user identification information can also be programmed into the flash memory .

The mobile device is a battery powered device and includes a battery interface for receiving one or more rechargeable batteries . In some embodiments the battery can be a smart battery with an embedded microprocessor. The battery interface is coupled to a regulator not shown which assists the battery in providing power V to the mobile device . Although current technology makes use of a battery future technologies such as micro fuel cells may provide the power to the mobile device .

The mobile device also includes an operating system and software components to which are described in more detail below. The operating system and the software components to that are executed by the main processor are typically stored in a persistent store such as the flash memory which may alternatively be a read only memory ROM or similar storage element not shown . Those skilled in the art will appreciate that portions of the operating system and the software components to such as specific device applications or parts thereof may be temporarily loaded into a volatile store such as the RAM .

The operating system in the absence of additional software components or controls is a non secure operating system which lacks a comprehensive security and management framework. This results in a number of shortcomings in areas such as user authentication ensuring that only the intended user can access the device memory security ensuring that an application s data in memory is private to that application only flash security ensuring that an application s data in flash memory is private to that application only and API security ensuring that only authorized applications can access sensitive APIs as well as other security issues.

The subset of software applications that control basic device operations including data and voice communication applications will normally be installed on the mobile device during its manufacture. Other software applications include a message application that can be any suitable software program that allows a user of the mobile device to send and receive electronic messages. Various alternatives exist for the message application as is well known to those skilled in the art. Messages that have been sent or received by the user are typically stored in the flash memory of the mobile device or some other suitable storage element in the mobile device . In some embodiments some of the sent and received messages may be stored remotely from the device such as in a data store of an associated host system that the mobile device communicates with.

The message application can include an address book that provides information for a list of contacts for the user. For a given contact in the address book the information can include the name phone number work address and e mail address of the contact among other information. In some embodiments the address book may be a separate software application.

The software applications can further include a device state module a Personal Information Manager PIM and other suitable modules not shown . The device state module provides persistence i.e. the device state module ensures that important device data is stored in persistent memory such as the flash memory so that the data is not lost when the mobile device is turned off or loses power.

The PIM includes functionality for organizing and managing data items of interest to the user such as but not limited to e mail calendar events voice mails appointments and task items. A PIM application has the ability to send and receive data items via the wireless network . PIM data items may be seamlessly integrated synchronized and updated via the wireless network with the mobile device subscriber s corresponding data items stored and or associated with a host computer system. This functionality creates a mirrored host computer on the mobile device with respect to such items. This can be particularly advantageous when the host computer system is the mobile device subscriber s office computer system.

Other types of software applications can also be installed on the mobile device . These software applications can be third party applications which are added after the manufacture of the mobile device . Examples of third party applications may be games calculators or other utilities. Unfortunately if these applications have a malicious intent the non secure operating system cannot properly limit or prevent the operation of these malicious applications without additional support.

Advantageously the mobile device can operate with a set of applications that provide security features including a connect module an integration module and a security management module . These modules can be installed after the manufacture of the mobile device to provide extra functionality for the mobile device . These modules can also provide security features for the mobile device to mitigate the security and management shortcomings of the non secure operating system .

The connect module implements the communication protocols that are required for the mobile device to communicate with the wireless infrastructure and any host system such as an enterprise system that the mobile device is authorized to interface with. Examples of a wireless infrastructure and an enterprise system are given in which are described in more detail below. The connect module includes a set of APIs that can be integrated with the mobile device to allow the mobile device to use any number of services associated with the enterprise system. The connect module allows the mobile device to establish an end to end secure authenticated communication pipe with the host system. A subset of applications for which access is provided by the connect module can be used to pass IT policy commands from the host system to the mobile device . These instructions can then be passed to the security management module to modify the security and management features of the device . Alternatively in some cases the IT policy update can also be done over a wired connection.

The integration module is an interface between the APIs that can be provided by the connect module and the host environment of the mobile device which includes the operating system any applications network services etc. Accordingly the integration module includes several sub modules not shown that integrate the APIs provided by the connect module with host environment APIs including APIs of the operating system APIs of the applications that are executed by the mobile device i.e. the message application APIs associated with the communication subsystem and the like. When the connect and integration modules and are installed on the mobile device the integration module begins carrying out tasks to provide services to the mobile device via the APIs of the connect module .

The integration module does not make any changes to the device environment per se but augments the behavior of the device environment and the applications by interfacing with the corresponding APIs. In this fashion the integration module in combination with the security management module can affect the security capabilities of the non secure operating system . The security management module can provide several security features including at least one of application execution control API access control user authentication device data removal application feature specific control and the like. The security management module is described in more detail below.

The additional applications can be loaded onto the mobile device through at least one of the wireless network the auxiliary I O subsystem the data port the short range communications subsystem or any other suitable device subsystem . This flexibility in application installation increases the functionality of the mobile device and may provide enhanced on device functions communication related functions or both. For example secure communication applications may enable electronic commerce functions and other such financial transactions to be performed using the mobile device .

The data port enables a subscriber to set preferences through an external device or software application and extends the capabilities of the mobile device by providing for information or software downloads to the mobile device other than through a wireless communication network. The alternate download path may for example be used to load an encryption key onto the mobile device through a direct and thus reliable and trusted connection to provide secure device communication.

The data port can be any suitable port that enables data communication between the mobile device and another computing device. The data port can be a serial or a parallel port. In some instances the data port can be a USB port that includes data lines for data transfer and a supply line that can provide a charging current to charge the battery of the mobile device .

The short range communications subsystem provides for communication between the mobile device and different systems or devices without the use of the wireless network . For example the subsystem may include an infrared device and associated circuits and components for short range communication. Examples of short range communication standards include standards developed by the Infrared Data Association IrDA Bluetooth and the 802.11 family of standards developed by IEEE.

In use a received signal such as a text message an e mail message or web page download will be processed by the communication subsystem and input to the main processor . The main processor will then process the received signal for output to the display or alternatively to the auxiliary I O subsystem . A subscriber may also compose data items such as e mail messages for example using the keyboard in conjunction with the display and possibly the auxiliary I O subsystem . The auxiliary subsystem may include devices such as a touch screen mouse track ball infrared fingerprint detector or a roller wheel with dynamic button pressing capability. The keyboard is preferably an alphanumeric keyboard and or telephone type keypad. However other types of keyboards may also be used. A composed item may be transmitted over the wireless network through the communication subsystem .

For voice communications the overall operation of the mobile device is substantially similar except that the received signals are output to the speaker and signals for transmission are generated by the microphone . Alternative voice or audio I O subsystems such as a voice message recording subsystem can also be implemented on the mobile device . Although voice or audio signal output is accomplished primarily through the speaker the display can also be used to provide additional information such as the identity of a calling party duration of a voice call or other voice call related information.

Referring now to an exemplary block diagram of the communication subsystem component is shown. The communication subsystem includes a receiver a transmitter as well as associated components such as one or more embedded or internal antenna elements and Local Oscillators LOs and a processing module such as a Digital Signal Processor DSP . The particular design of the communication subsystem is dependent upon the communication network with which the mobile device is intended to operate. Thus it should be understood that the design illustrated in serves only as one example.

Signals received by the antenna through the wireless network are input to the receiver which may perform such common receiver functions as signal amplification frequency down conversion filtering channel selection and analog to digital ND conversion. A D conversion of a received signal allows more complex communication functions such as demodulation and decoding to be performed in the DSP . In a similar manner signals to be transmitted are processed including modulation and encoding by the DSP . These DSP processed signals are input to the transmitter for digital to analog D A conversion frequency up conversion filtering amplification and transmission over the wireless network via the antenna . The DSP not only processes communication signals but also provides for receiver and transmitter control. For example the gains applied to communication signals in the receiver and the transmitter may be adaptively controlled through automatic gain control algorithms implemented in the DSP .

The wireless link between the mobile device and the wireless network can contain one or more different channels typically different RF channels and associated protocols used between the mobile device and the wireless network . An RF channel is a limited resource that must be conserved typically due to limits in overall bandwidth and limited battery power of the mobile device .

When the mobile device is fully operational the transmitter is typically keyed or turned on only when it is transmitting to the wireless network and is otherwise turned off to conserve resources. Similarly the receiver is periodically turned off to conserve power until it is needed to receive signals or information if at all during designated time periods.

Referring now to a block diagram of an exemplary implementation of a node of the wireless network is shown. In practice the wireless network comprises one or more nodes . In conjunction with the connect module the mobile device can communicate with the node within the wireless network . In the exemplary implementation of the node is configured in accordance with General Packet Radio Service GPRS and Global Systems for Mobile GSM technologies. The node includes a base station controller BSC with an associated tower station a Packet Control Unit PCU added for GPRS support in GSM a Mobile Switching Center MSC a Home Location Register HLR a Visitor Location Registry VLR a Serving GPRS Support Node SGSN a Gateway GPRS Support Node GGSN and a Dynamic Host Configuration Protocol DHCP . This list of components is not meant to be an exhaustive list of the components of every node within a GSM GPRS network but rather a list of components that are commonly used in communications through the network .

In a GSM network the MSC is coupled to the BSC and to a landline network such as a Public Switched Telephone Network PSTN to satisfy circuit switched requirements. The connection through the PCU the SGSN and the GGSN to a public or private network Internet also referred to herein generally as a shared network infrastructure represents the data path for GPRS capable mobile devices. In a GSM network extended with GPRS capabilities the BSC also contains the Packet Control Unit PCU that connects to the SGSN to control segmentation radio channel allocation and to satisfy packet switched requirements. To track the location of the mobile device and availability for both circuit switched and packet switched management the HLR is shared between the MSC and the SGSN . Access to the VLR is controlled by the MSC .

The station is a fixed transceiver station and together with the BSC form fixed transceiver equipment. The fixed transceiver equipment provides wireless network coverage for a particular coverage area commonly referred to as a cell . The fixed transceiver equipment transmits communication signals to and receives communication signals from mobile devices within its cell via the station . The fixed transceiver equipment normally performs such functions as modulation and possibly encoding and or encryption of signals to be transmitted to the mobile device in accordance with particular usually predetermined communication protocols and parameters under control of its controller. The fixed transceiver equipment similarly demodulates and possibly decodes and decrypts if necessary any communication signals received from the mobile device within its cell. Communication protocols and parameters may vary between different nodes. For example one node may employ a different modulation scheme and operate at different frequencies than other nodes.

For all mobile devices registered with a specific network permanent configuration data such as a user profile is stored in the HLR . The HLR also contains location information for each registered mobile device and can be queried to determine the current location of a mobile device. The MSC is responsible for a group of location areas and stores the data of the mobile devices currently in its area of responsibility in the VLR . Further the VLR also contains information on mobile devices that are visiting other networks. The information in the VLR includes part of the permanent mobile device data transmitted from the HLR to the VLR for faster access. By moving additional information from a remote HLR node to the VLR the amount of traffic between these nodes can be reduced so that voice and data services can be provided with faster response times and at the same time requiring less use of computing resources.

The SGSN and the GGSN are elements added for GPRS support namely packet switched data support within GSM. The SGSN and the MSC have similar responsibilities within the wireless network by keeping track of the location of each mobile device . The SGSN also performs security functions and access control for data traffic on the wireless network . The GGSN provides internetworking connections with external packet switched networks and connects to one or more SGSN s via an Internet Protocol IP backbone network operated within the network . During normal operations a given mobile device must perform a GPRS Attach to acquire an IP address and to access data services. This requirement is not present in circuit switched voice channels as Integrated Services Digital Network ISDN addresses are used for routing incoming and outgoing calls. Currently all GPRS capable networks use private dynamically assigned IP addresses thus requiring the DHCP server connected to the GGSN . There are many mechanisms for dynamic IP assignment including using a combination of a Remote Authentication Dial In User Service RADIUS server and DHCP server. Once the GPRS Attach is complete a logical connection is established from a mobile device through the PCU and the SGSN to an Access Point Node APN within the GGSN . The APN represents a logical end of an IP tunnel that can either access direct Internet compatible services or private network connections. The APN also represents a security mechanism for the network insofar as each mobile device must be assigned to one or more APNs and mobile devices cannot exchange data without first performing a GPRS Attach to an APN that it has been authorized to use. The APN may be considered to be similar to an Internet domain name such as myconnection.wireless.com .

Once the GPRS Attach operation is complete a tunnel is created and all traffic is exchanged within standard IP packets using any protocol that can be supported in IP packets. This includes tunneling methods such as IP over IP as in the case with some IPSecurity IPsec connections used with Virtual Private Networks VPN . These tunnels are also referred to as Packet Data Protocol PDP Contexts and there are a limited number of these available in the network . To maximize use of the PDP Contexts the network will run an idle timer for each PDP Context to determine if there is a lack of activity. When a mobile device is not using its PDP Context the PDP Context can be de allocated and the IP address returned to the IP address pool managed by the DHCP server .

Referring now to shown therein is a block diagram illustrating components of an exemplary configuration of a host system that the mobile device can communicate with in conjunction with the connect module . The host system will typically be a corporate enterprise or other local area network LAN but may also be a home office computer or some other private system for example in variant implementations. In this example shown in the host system is depicted as a LAN of an organization to which a user of the mobile device belongs. Typically a plurality of mobile devices can communicate wirelessly with the host system through one or more nodes of the wireless network .

The host system comprises a number of network components connected to each other by a network . For instance a user s desktop computer with an accompanying cradle for the user s mobile device is situated on a LAN connection. The cradle for the mobile device can be coupled to the computer by a serial or a Universal Serial Bus USB connection for example. Other user computers are also situated on the network and each may or may not be equipped with an accompanying cradle . The cradle facilitates the loading of information e.g. PIM data private symmetric encryption keys to facilitate secure communications between the mobile device and the host system etc from the user computer to the mobile device and may be particularly useful for bulk information updates often performed in initializing the mobile device for use. The information downloaded to the mobile device may include certificates used in the exchange of messages.

It will be understood by persons skilled in the art that the user computers will typically also be connected to other peripheral devices such as printers etc. which are not explicitly shown in . Furthermore only a subset of network components of the host system are shown in for ease of exposition and it will be understood by persons skilled in the art that the host system will comprise additional components that are not explicitly shown in for this exemplary configuration. More generally the host system may represent a smaller part of a larger network not shown of the organization and may comprise different components and or be arranged in different topologies than that shown in the exemplary embodiment of .

To facilitate the wireless communication of messages and message related data between the mobile device and components of the host system a number of wireless communication support components may be provided. In some implementations the wireless communication support components can include a message management server a mobile data server a contact server an IT policy module and the like.

In this exemplary embodiment the mobile device communicates with the host system through node of the wireless network and a shared network infrastructure such as a service provider network or the public Internet. Access to the host system may be provided through one or more routers not shown and computing devices of the host system may operate from behind a firewall or proxy server . The proxy server provides a secure node and a wireless internet gateway for the host system . The proxy server intelligently routes data to the correct destination server within the host system .

In some implementations the host system can include a wireless VPN router not shown to facilitate data exchange between the host system and the mobile device . The wireless VPN router allows a VPN connection to be established directly through a specific wireless network to the mobile device . The wireless VPN router can be used with the Internet Protocol IP Version 6 IPV6 and IP based wireless networks. This protocol can provide enough IP addresses so that each mobile device has a dedicated IP address making it possible to push information to a mobile device at any time. An advantage of using a wireless VPN router is that it can be an off the shelf VPN component and does not require a separate wireless gateway and separate wireless infrastructure. A VPN connection can preferably be a Transmission Control Protocol TCP IP or User Datagram Protocol UDP IP connection for delivering the messages directly to the mobile device in this alternative implementation.

Messages intended for a user of the mobile device are initially received by a message server of the host system . Such messages may originate from any number of sources. For instance a message may have been sent by a sender from the computer within the host system from a different mobile device not shown connected to the wireless network or a different wireless network or from a different computing device or other device capable of sending messages via the shared network infrastructure possibly through an application service provider ASP or Internet service provider ISP for example.

The message server typically acts as the primary interface for the exchange of messages particularly e mail messages within the organization and over the shared network infrastructure . Each user in the organization that has been set up to send and receive messages is typically associated with a user account managed by the message server . Some exemplary implementations of the message server include a Microsoft Exchange server a Lotus Domino server a Novell Groupwise server or another suitable mail server installed in a corporate environment. In some implementations the host system may comprise multiple message servers . The message server may also be adapted to provide additional functions beyond message management including the management of data associated with calendars and task lists for example.

When messages are received by the message server they are typically stored in a data store associated with the message server . In some embodiments the data store may be a separate hardware unit not shown that the message server communicates with. Messages can be subsequently retrieved and delivered to users by accessing the message server . For instance an e mail client application operating on a user s computer may request the e mail messages associated with that user s account stored on the data store associated with the message server . These messages are then retrieved from the data store and stored locally on the computer . The data store associated with the message server can store copies of each message that is locally stored on the mobile device . Alternatively the data store associated with the message server can store all of the messages for the user of the mobile device and only a smaller number of messages can be stored on the mobile device to conserve memory. For instance the most recent messages i.e. those received in the past two to three months for example can be stored on the mobile device .

When operating the mobile device the user may wish to have e mail messages retrieved for delivery to the mobile device . The message application operating on the mobile device may also request messages associated with the user s account from the message server . The message application may be configured either by the user or by an administrator possibly in accordance with an organization s information technology IT policy to make this request at the direction of the user at some pre defined time interval or upon the occurrence of some pre defined event. In some implementations the mobile device is assigned its own e mail address and messages addressed specifically to the mobile device are automatically redirected to the mobile device as they are received by the message server .

The message management server can be used to specifically provide support for the management of messages such as e mail messages that are to be handled by mobile devices. Generally while messages are still stored on the message server the message management server can be used to control when if and how messages are sent to the mobile device . The message management server also facilitates the handling of messages composed on the mobile device which are sent to the message server for subsequent delivery.

For example the message management server may monitor the user s mailbox e.g. the message store associated with the user s account on the message server for new e mail messages and apply user definable filters to new messages to determine if and how the messages are relayed to the user s mobile device . The message management server may also compress and encrypt new messages e.g. using an encryption technique such as Data Encryption Standard DES or Triple DES and push them to the mobile device via the shared network infrastructure and the wireless network . The message management server may also receive messages composed on the mobile device e.g. encrypted using Triple DES decrypt and decompress the composed messages re format the composed messages if desired so that they will appear to have originated from the user s computer and re route the composed messages to the message server for delivery.

Certain properties or restrictions associated with messages that are to be sent from and or received by the mobile device can be defined e.g. by an administrator in accordance with IT policy and enforced by the message management server . These may include whether the mobile device may receive encrypted and or signed messages minimum encryption key sizes whether outgoing messages must be encrypted and or signed and whether copies of all secure messages sent from the mobile device are to be sent to a pre defined copy address for example.

The message management server may also be adapted to provide other control functions such as only pushing certain message information or pre defined portions e.g. blocks of a message stored on the message server to the mobile device . For example in some cases when a message is initially retrieved by the mobile device from the message server the message management server may push only the first part of a message to the mobile device with the part being of a pre defined size e.g. 2 KB . The user can then request that more of the message be delivered in similar sized blocks by the message management server to the mobile device possibly up to a maximum pre defined message size. Accordingly the message management server facilitates better control over the type of data and the amount of data that is communicated to the mobile device and can help to minimize potential waste of bandwidth or other resources.

The mobile data server encompasses any other server that stores information that is relevant to the corporation. The mobile data server may include but is not limited to databases online data document repositories customer relationship management CRM systems or enterprise resource planning ERP applications.

The contact server can provide information for a list of contacts for the user in a similar fashion as the address book on the mobile device . Accordingly for a given contact the contact server can include the name phone number work address and e mail address of the contact among other information. The contact server can also provide a global address list that contains the contact information for all of the contacts associated with the host system .

It will be understood by persons skilled in the art that the message management server the mobile data server the contact server and the IT policy module need not be implemented on separate physical servers within the host system . For example some or all of the functions associated with the message management server may be integrated with the message server or some other server in the host system . Furthermore the host system may comprise multiple message management servers particularly in variant implementations where a large number of mobile devices need to be supported. Furthermore in some embodiments the functionality of the IT policy module can be provided by an IT policy server not shown .

Referring now to shown therein is an exemplary embodiment of a non secure operating system and several applications and that may be executed on the mobile device . The operating system includes a task manager and at least one sensitive API that is exposed. The term exposed means that the API may provide access to sensitive information through corresponding functions and is freely accessible by any application that is executed by the operating system . The API may also invoke sensitive processing or any other functionality that can be considered detrimental to any enterprise system that the device interfaces with the user or the user s data. For instance examples of sensitive APIs include the PIM and the message application . The PIM allows a developer to access a user s PIM data which may be a security risk to the end user. The message application allows a developer to send SMS messages which is a potential risk to the network operator and the end user. The operating system will typically have other APIs and only a few sensitive APIs are shown for simplicity.

The OS Task manager is responsible for the applications that are currently being executed by the operating system and includes information for these applications. The OS Task manager controls and schedules the execution of the applications and and can also be used to terminate the execution of any application currently executing.

The application is an example of an acceptable or normal application that includes a sensitive API that provides functions which can access sensitive data or perform sensitive operations and is freely accessible by any application that is executed by the operating system without the additional control provided by the security management module . The application is also an example of a normal application and the application is an example of a rogue or malicious application. In this example any application regardless of whether or not it contains malicious code is allowed to be executed by the operating system and may freely access the application API or the operation system API without the additional control provided by the security management module . Furthermore any application that is loaded onto the mobile device is permitted to run which may not be acceptable if the application contains malicious code.

In acceptable scenarios the application may call a sensitive function or read data that is exposed by the API of application or by the API of the operating system . In both of these cases the operation of the application is acceptable since the functions accessed or the data read by the application are used for legitimate purposes.

In unacceptable scenarios the application may call a sensitive function or read data that is exposed by the API of application or by the API of the operating system . In both of these cases the operation of the application is unacceptable since the functions accessed or the data read by the application may be used for malicious purposes.

Referring now to shown therein is an exemplary block diagram of the operating system that operates under the security and management policies provided by the security management module .

These policies can be initialized upon the first installation of the security management module and later updated by an IT administrator for example through a wired connection in some embodiments through a wireless connection in some embodiments and by either a wired or wireless connection in some embodiments. The operating system also includes the task manager and the API as well as other typical components that are necessary for operation. These components include compilers utilities for managing computer resources and the like as is commonly known by those skilled in the art these components are not shown to simplify the description .

The security management module includes access information that specifies whether applications can access i.e. make a function call a sensitive function in an API. The security management module via the integration module implements a security access protocol such that when functions are called from a sensitive API either the API or the OS task manager checks with the security management module which in turn checks the access information to determine if the calling application has been granted access to call that particular function. If access has been granted then program execution continues to function as it normally would. If access has not been granted then the security management module will return an error to the calling application. In some embodiments there can be global use of functions in a certain API and in some embodiments use can be permitted depending on the particular calling application. These scenarios are discussed further below.

The access information can be encoded in the security management module and implemented when the module is first installed on the mobile device . Installation on the mobile device may occur when the mobile device is manufactured and the access information may then be regularly updated in the future via the connect module by an IT administrator associated with the device . In some embodiments the access information may be stored in a separate file that can be accessed by the security management module . Further in some embodiments the access information can be encrypted and a private key can be required for example to access the security management module and the access information to prevent a third party from violating and modifying the access information. Depending on the implementation the access information may simply specify a Boolean value for each possible calling application or may list a number of acceptable applications that may access a sensitive or controlled function provided by an API. In some cases the calling application may bare a digital signature that identifies it as being authorized to access a particular API function. In this case the access can be conditional depending on whether the digital signature information matches corresponding information stored in the access information. Accordingly the security management module can gate access to the API based on the identity of the calling application. In some embodiments the access information may specify additional conditions of access such as the identity of the user of the mobile device .

In use for the example shown in the sensitive APIs and will check with the security management module to determine if the calling application is allowed to make a function call. The application will be allowed to make the function call since the access information will indicate that the application can access sensitive APIs. However the malicious application will not be allowed to make functions calls to functions in either the API or the API since the access information will not list the application as an application that is allowed to make such function calls.

In some embodiments the security management module also includes execution information on whether an application is allowed to be executed by the operating system . Applications can be identified by a unique ID in the execution information and if the execution information indicates that an application is allowed to run then the OS task manager will execute the application. Conversely if the execution information does not indicate that an application is allowed to run then the OS task manager will not execute the application since the application may be a rogue application.

The execution information can be encoded in the security management module and applied to the device when the security management module is first installed. The execution information can then be regularly updated in the future by an IT administrator associated with the device in the same fashion as the access information. The execution information may be coded in a separate file that is accessed by the security management module . The execution information may simply contain the ID of each application that is allowed to run or may have a Boolean value associated with a list of applications that indicate which applications are allowed to execute. Alternatively the application may bare a digital signature that matches corresponding information in the execution information that identifies it as being authorized to execute. The execution information is preferably encrypted so that malicious users cannot access and or modify the execution information. In some embodiments the security management module can also remove an application on the device that is not an approved application as indicated by the execution information. In some embodiments the security management module can prevent installation of non approved applications.

In use an application first registers with the OS task manager prior to execution. The OS task manager then checks with the security management module to determine if the application is an allowable application i.e. allowed to execute . In the example shown in the applications and can be executed by the operating system . However the malicious application will not be executed by the operating system since the execution information will not list the application as an application that is allowed to execute.

As another example illustrating the operation of the mobile device prior to use or during a later update an administrator may specify that the application may access one or more functions of the API of the operating system but no functions of API of the application . Accordingly during operation when the application accesses the API the API checks with the security management module to determine if the application has access to the particular function that it is requesting which depends on the settings in the access information. For some functions the application may be granted access while for others the application may not be granted access. In this case when the application accesses the API the API checks with the security management module and determines that the application does not have access to any of the functions of the API . The API then sends an error message to the function .

With regards to the application access to sensitive API functions is not a concern because this application is not given permission to run by the security management module . However in embodiments in which the security management module does not block the execution of applications the application is not listed as having access to any sensitive API functions in the access information associated with the security management module . In this sense the security management module can provide two layers of security to prevent unauthorized access of sensitive or controlled API functions by applications that may contain malicious code. Accordingly some embodiments may have either API access control or application control in absence of the other while other embodiments may have both layers of security.

Referring now to shown therein is a flowchart of an exemplary embodiment of a controlled API access process that may be implemented by the security management module . The process begins at step at which point an API function is called and the process determines whether the called API function is a controlled i.e. sensitive API function. If not then at step the API function call is executed. If access to the called API function is being controlled then the process moves to step in which the application being called checks with the security management module to determine if any application has access to the controlled API function being called i.e. whether general usage is authorized . If not then the called API or the security management module returns an error value to the calling application that indicates failure due to the controlled API function being unauthorized for usage. If the controlled API function is authorized for usage then the process moves to step in which the function call to the controlled API function is executed. This is an example of general security access to the controlled API function since the security management module does not check on the identity of the calling application but rather whether the controlled API function is authorized for general or global usage.

Referring now to shown therein is a flowchart of an another exemplary embodiment of a controlled API access process that may be implemented by the security management module . The process begins at step at which point an API function is called and the process determines whether the called API function is a controlled i.e. sensitive API function. If not the process moves to step in which the API function call is executed. Alternatively if the called API function is controlled the process moves to step in which the function being called checks with the security management module to determine if the particular calling application has access to the controlled API function. If not in step the security management module returns an error value that indicates failure due to the controlled API function being unauthorized for usage by the calling application. Alternatively if the controlled API function is authorized for usage by this particular calling application then the process moves to step in which the function call to the controlled API function is executed. This is an example of per application security access to the controlled API function since the security management module checks the identity of the calling application to determine if it has access to the controlled API function being called.

In some embodiments access to certain API functions may be allowed for only certain users of the device . For instance some users of the device may have privileges over general users and may require access to the sensitive APIs to change certain features or data associated with these devices that are generally used in a given corporate environment.

In this case the security management module can be updated to provide access to these privileged users based on a user ID for instance whereas general users are not given such access.

In some embodiments the security management module can be used to improve the user authentication features provided by the non secure operating system . For instance some devices may have an operating system with a built in user authentication module but the features of this module may not meet the stringent requirements of the security policies of a given corporation. For instance there may not be enough control that is offered for certain authentication requirements such as for example password length password form timeout length for entering a password change time and the like. In these situations the security management module can provide user authentication with adequate security. An IT administrator may then use the security management module to override the built in authentication module of the operating system . A more sophisticated user authentication scheme is then implemented by the security management module . The more sophisticated scheme may add user authentication features that are not supported by the built in authentication scheme. Examples of such features may include additional restrictions on minimum password length inactivity time out before device lock out how often a user password must be changed and composition of the user password. This allows an IT administrator to have much greater control over user authentication for a mobile device having a non secure operating system.

In some embodiments the security management module can implement a Device Wipe function. An important management security feature for IT administrators is to be able to remotely wipe sensitive data from a mobile device should the device be lost. In this case the user of the device notifies the IT administrator who then sends a WIPE command to the security management module which then deletes any user and corporate sensitive information on the device. The security management module can then delete the portions of the RAM and flash memory that contain the sensitive information.

In some embodiments the security management module can also provide application feature specific security. For example the security management module can support an enable disable BCC IT Policy. Basically some financial and government organizations do not allow employees to Blind Carbon Copy recipients when sending e mail messages for various audit and regulatory reasons. With the security management module the IT Administrator can disable the BCC feature for the message application . In this example the security management module receives a Disable BCC command from an IT administrator and interacts with the message application via an appropriate API to remove the BCC field from the e mail user interface.

Many applications expose APIs that can fundamentally affect the behavior and features of an application. As a result of a particular IT policy command from the security management module a particular application s behavior can be manipulated via its APIs to achieve the desired security result. Disabling the BCC field for the message application is one example. Other examples can include preventing users from dialing certain numbers or viewing certain web pages with a web browser on the mobile device etc. Application specific feature control can be defined at the time of the design and build of the security management module i.e. during the design phase one can define which features an IT administrator can be able to control and the code to be used with the appropriate application API to implement the control of those features .

The connect module allows the IT administrator to remotely update the security settings implemented by the security management module. In some embodiments this can be done by the IT administrator via the IT policy module . Prior to installation of the modules the IT administrator can decide which applications are allowed to execute on the mobile device and which applications or even users for that matter are allowed to access certain functions for sensitive APIs. The IT administrator can maintain this security in a central location and can revisit the security issues for a given mobile device at any time in the future. For instance the IT administrator can routinely review applications that are made by a third party and if they are not malicious update the security settings used by the security management module . In some embodiments when an application that is not listed in the control or access information is trying to execute or access a function of a sensitive API respectively the security management module via the connect module can contact the IT administrator to determine if the application such be given such execution or access privileges.

The embodiments described herein address mobile devices with operating systems that do not provide a sufficient security framework to provide security features such as at least one of conditional access to sensitive APIs conditional execution of applications on the mobile device user authentication and the like. In some cases the embodiments described herein can provide an IT administrator or another suitable person with security control in operating system environments for which no such controls exist.

In one aspect at least one embodiment described herein provides a computer program product for providing security features for a mobile device having a non secure operating system the computer program product comprising a computer readable medium embodying program code means executable by a processor of the mobile device for carrying out a method for implementing the security features wherein the program code means comprises 

a a security management module for providing the security features to the non secure operating system of the mobile device 

b a connect module for remotely updating the security features provided by the security management module and 

c an integration module for interfacing the connect module and the security management module with the non secure operating system.

In some cases the method includes providing access information to the security management module and when a given application being executed on the mobile device makes a function call to an application program interface that provides access to a sensitive function the method further includes allowing execution of the function call to the sensitive function when the access information indicates that function calls to the sensitive function are allowed otherwise not allowing execution of the function call to the sensitive function.

In some cases the method further includes checking the access information to determine if the given application calling the sensitive function is allowed to access the sensitive function.

In some cases the method further includes providing execution information to the security management module and prior to execution of a given application by the non secure operating system the method further includes checking the execution information and allowing execution of the given application if the given application is indicated as an allowable application in the execution information otherwise not allowing execution of the given application.

In some cases the method further includes contacting an administrator if security information is not provided for the given application.

In some cases the method further includes overriding user authentication features provided by the non secure operating system with user authentication features provided by the security management module.

In some cases the method further includes using the security management module to provide application feature specific security.

In another aspect at least one embodiment described herein provides a method for providing security features for a mobile device having a non secure operating system wherein the method comprises 

c interfacing the connect module and the security management module with the non secure operating system.

In some cases the method further includes providing access information and when a given application being executed on the mobile device makes a function call to an application program interface that provides access to a sensitive function the method further includes allowing execution of the function call to the sensitive function when the access information indicates that function calls to the sensitive function are allowed otherwise not allowing execution of the function call to the sensitive function.

In some cases the method further includes checking the access information to determine if the given application calling the sensitive function is allowed to access the sensitive function.

In some cases the method further includes providing execution information and prior to execution of a given application by the non secure operating system the method further includes checking the execution information and allowing execution of the given application if the given application is indicated as an allowable application in the execution information otherwise not allowing execution of the given application.

In some cases the method further includes contacting an administrator if security information is not provided for the given application.

In some cases the method further includes overriding user authentication features provided by the non secure operating system with user authentication features provided by the security management module.

In some cases the method further includes using the security management module to provide application feature specific security.

In another aspect at least one embodiment described herein provides a mobile communications device having a non secure operating system. The mobile communications device comprises a main processor that controls the operation of the mobile communications device a communication subsystem connected to the main processor the communication subsystem sends and receives data at least one application for allowing a user to perform a function on the mobile communications device at least one application program interface that provides access to a sensitive function and a set of applications for providing security features for the non secure operating system. The set of applications including a security management module for providing security features to the non secure operating system of the mobile device a connect module for remotely updating the security features provided by the security management module and an integration module for interfacing the connect module and the security management module with the non secure operating system.

In some cases the mobile device further includes access information and when a given application being executed on the mobile device makes a function call to the at least one application program interface that provides access to a sensitive function the security management module allows execution of the function call to the sensitive function when the access information indicates that function calls to the sensitive function are allowed otherwise the security management module does not allow execution of the function call to the sensitive function.

In some cases the security management module checks the access information to determine if the given application calling the sensitive function is allowed to access the sensitive function.

In some cases the mobile communications device further includes execution information and prior to execution of a given application by the non secure operating system the security management module checks the execution information and allows execution of the given application if the given application is indicated as an allowable application in the execution information otherwise the security management module does not allow execution of the given application.

In some cases the security management module is adapted to override user authentication features provided by the non secure operating system with user authentication features provided by the security management module.

It should be understood that various modifications can be made to the embodiments described and illustrated herein without departing from the embodiments described herein the scope of which is defined in the appended claims.

