---

title: Sound to haptic effect conversion system using amplitude value
abstract: A haptic conversion system is provided that intercepts frames of audio data, such as a digital audio signal, converts the frames into a haptic signal, and plays the created haptic signal through an actuator to produce haptic effects. The haptic signal is based on a maximum value of each audio data frame, which defines a magnitude of the haptic signal. The haptic signal is applied to the actuator configured to receive the haptic signal, where the actuator utilizes the haptic signal to generate the one or more haptic effects.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09448626&OS=09448626&RS=09448626
owner: IMMERSION CORPORATION
number: 09448626
owner_city: San Jose
owner_country: US
publication_date: 20120203
---
This application claims priority of U.S. Provisional Patent Application Ser. No. 61 441 792 filed on Feb. 11 2011 the disclosure of which is hereby incorporated by reference.

One embodiment is directed generally to a device and more particularly to a device that produces haptic effects.

Haptics is a tactile and force feedback technology that takes advantage of a user s sense of touch by applying haptic feedback effects i.e. haptic effects such as forces vibrations and motions to the user. Devices such as mobile devices touchscreen devices and personal computers can be configured to generate haptic effects. In general calls to embedded hardware capable of generating haptic effects such as actuators can be programmed within an operating system OS of the device. These calls specify which haptic effect to play. For example when a user interacts with the device using for example a button touchscreen lever joystick wheel or some other control the OS of the device can send a play command through control circuitry to the embedded hardware. The embedded hardware then produces the appropriate haptic effect.

Such devices can also be configured to play audio data such as a digital audio signal. For example such devices can include applications configured to play video data such as a movie or video game that contains an audio portion or audio data such as a song. Similar to haptics calls to additional embedded hardware capable of generating audio effects such as speakers can be programmed within the OS of the device. Thus the OS of the device can send a play command through control circuitry to the additional embedded hardware where the additional embedded hardware then produces the appropriate audio effect.

One embodiment is directed to a system that converts an audio signal into one or more haptic effects. The system receives a data frame of the audio signal. The system further generates a maximum value of the data frame. The system further generates a haptic signal based on the maximum value where the maximum value defines a magnitude of the haptic signal. The system further sends the haptic signal to an actuator to generate the one or more haptic effects.

One embodiment is a haptic conversion system that can intercept one or more frames of audio data such as a digital audio signal convert the one or more frames into a haptic signal and play the created haptic signal through an actuator to produce one or more haptic effects. The haptic signal can include a single control parameter. The haptic signal can be applied to a type of actuator configured to receive a single control parameter where the actuator can utilize the single control parameter to generate the one or more haptic effects.

A computer readable medium may be any available medium that can be accessed by processor and may include both a volatile and nonvolatile medium a removable and non removable medium a communication medium and a storage medium. A communication medium may include computer readable instructions data structures program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and may include any other form of an information delivery medium known in the art. A storage medium may include RAM flash memory ROM erasable programmable read only memory EPROM electrically erasable programmable read only memory EEPROM registers hard disk a removable disk a compact disk read only memory CD ROM or any other form of a storage medium known in the art.

In one embodiment memory stores software modules that provide functionality when executed by processor . The modules include an operating system that provides operating system functionality for system as well as the rest of a mobile device in one embodiment. The modules further include a haptic conversion module that converts an audio signal into a haptic signal that is used to produce one or more haptic effects as disclosed in more detail below. In certain embodiments haptic conversion module can comprise a plurality of modules that each provide specific individual functionality for converting an audio signal into a haptic signal that is used to produce one or more haptic effects. System will typically include one or more additional application modules to include additional functionality such as MOTIV Haptic Development Platform by Immersion Corporation.

System in embodiments that transmit and or receive data from remote sources further includes a communication device such as a network interface card to provide mobile wireless network communication such as infrared radio Wi Fi cellular network or other next generation wireless data network communication. In other embodiments communication device provides a wired network connection such as an Ethernet connection or a modem.

Processor is further coupled via bus to a display such as a Liquid Crystal Display LCD for displaying a graphical representation or user interface to a user. The display may be a touch sensitive input device such as a touch screen configured to send and receive signals from processor and may be a multi touch touch screen.

System further includes one or more actuators . Processor may transmit a haptic signal associated with a haptic effect to actuator which in turn outputs haptic effects. Actuator may be for example an electric motor an electro magnetic actuator a voice coil a shape memory alloy an electro active polymer a solenoid an eccentric rotating mass motor ERM a linear resonant actuator LRA a piezoelectric actuator a high bandwidth actuator an electroactive polymer EAP actuator an electrostatic friction display or an ultrasonic vibration generator.

In some embodiments system further includes one or more speakers . Processor may transmit an audio signal to speaker which in turn outputs audio effects. Speaker may be for example a dynamic loudspeaker an electrodynamic loudspeaker a piezoelectric loudspeaker a magnetostrictive loudspeaker an electrostatic loudspeaker a ribbon and planar magnetic loudspeaker a bending wave loudspeaker a flat panel loudspeaker a heil air motion transducer a plasma arc speaker and a digital loudspeaker.

The haptic conversion system also includes a haptic conversion module according to the embodiment. In certain embodiments haptic conversion module is identical to haptic conversion module of . In the illustrated embodiment haptic conversion module is comprised of two sub modules reverb module and boombox module . However this is merely an example embodiment and in alternate embodiments haptic conversion module can be comprised of any number of sub modules or haptic conversion module can be a single module.

According to the embodiment reverb module is configured to intercept the one or more audio buffers that audio track module streams to speaker . Reverb module is further configured to send each audio data frame of each audio buffer to boombox module . Boombox module is configured to analyze each audio data frame and calculate a maximum value for each audio data frame. The calculating of the maximum value for each audio data frame performed by boombox module is further described in greater detail in relation to . Boombox module is further configured to return the maximum value for each audio data frame to reverb module .

The haptic conversion system also includes a haptic effect player module and an actuator . Haptic effect player module is a module that is embedded within a device such as a mobile device and that is configured to play one or more haptic effects at an actuator by sending one or more haptic signals to the actuator. In one embodiment haptic effect player module is a TouchSense Player module by Immersion Corporation. Actuator is an actuator configured to receive one or more haptic signals and configured to output one or more haptic effects. In certain embodiments actuator is an actuator configured to receive a single control parameter such as a magnitude parameter where the single control parameter is used to control a magnitude of a periodic effect when played through the actuator. Actuator can be for example an electric motor an electro magnetic actuator a voice coil a shape memory alloy an electro active polymer a solenoid an ERM or a LRA.

According to the embodiment reverb module is configured to use the maximum value of the audio data frame returned by boombox module to create a haptic signal where the haptic signal is a periodic effect and where the maximum value defines an amplitude of the haptic signal. In certain embodiments the haptic signal is a periodic effect at a resonant frequency of actuator . Reverb module is further configured to call an application program interface API of haptic effect player module and send haptic effect player module the maximum value of the audio data frame as a parameter of the API. In certain embodiments the API of haptic effect player module is a PlayPeriodicEffect API of a TouchSense Player module by Immersion Corporation. The API of haptic effect player module sends the maximum value of the audio data frame to actuator where the actuator is configured to play an appropriate periodic effect based on the maximum value of the audio data frame. According to the embodiment the maximum value of the audio data frame serves as an amplitude parameter of actuator and the changing of the amplitude parameter of actuator plays an appropriate periodic effect within actuator . By playing a periodic effect actuator produces a haptic effect.

According to the embodiment the haptic conversion system includes an operating system a reverb module and a boombox module . Operating system is an operating system of a device such as a mobile device . In the illustrated embodiment operating system is an Android operating system for a mobile device. Reverb module and boombox module are sub modules of a haptic conversion module such as haptic conversion module of . In certain embodiments reverb module and boombox module are identical to reverb module and boombox module respectively of .

According to the embodiment at an application configured to create an audio signal is created. The application is any application that can be executed within operating system . In the illustrated embodiment the application is an Android application. The flow proceeds to . At a SoundPool object is created by the application where a SoundPool object is an instance of a SoundPool API which is an Android API where a SoundPool object manages and plays audio resources for the application. The SoundPool object can include a collection of audio samples that can be loaded into a memory of a device from a resource stored within the device or from a file stored within a file system of the device. The SoundPool object can decode the collection of audio samples into a raw 16 bit PCM mono or stereo buffer. The flow proceeds to . At other audio objects are created by the application where the other audio objects are instances of other audio APIs. The other audio objects can also decode audio samples into a 16 bit PCM audio buffer. The flow proceeds to . At an AudioTrack object is created by either the SoundPool object or one of the other audio objects. An AudioTrack object is configured to receive one or more PCM audio buffers and stream the one or more PCM audio buffers.

The flow proceeds to . At a reverb object is created. A reverb object is an instance of reverb module where the reverb object is configured to process one or more audio data frames of a PCM audio buffer sent by the AudioTrack object as previously described in relation to . The flow proceeds to . At one or more settings of the reverb object are set. Example of reverb settings include enable disable haptic conversion enable disable haptic conversion for media select a strength of haptic conversion from three selections e.g. light moderate and strong and select one or more applications for example from a list for which haptic conversion is enabled. In certain embodiments the above settings are stored in an extensible markup language XML file. The above settings can be read from the XML file and stored within the reverb object where the reverb object can be enabled for certain applications and disabled for other applications. In certain embodiments three values identified as strength density and sharpness are based on three factors 1 strength setting e.g. light moderate and strong 2 haptic theme that maps user interface events with haptic effects and 3 actuator type. The strength density and sharpness values can be generated and stored within the reverb object. The flow proceeds to . At a boombox object is created by the reverb object. A boombox object is an instance of boombox module where the boombox object is configured to receive an audio data frame from the reverb object generate a maximum value of the audio data frame and send the maximum value of the audio data frame to the reverb object as previously described in relation to . In certain embodiments the strength and density values that are generated and stored within the reverb object can also be stored within the boombox object.

The flow proceeds to . At the reverb object sends an audio data frame of a PCM audio buffer that is received from an AudioTrack object to the boombox object. The flow proceeds to . At the boombox object samples data contained within the audio data frame. Such sampling is further described in greater detail in relation to . The flow proceeds to . At the boombox object translates the data contained within the audio data frame into a single voltage value i.e. a maximum value . Such translation is also further described in greater detail in relation to . The boombox object then returns the single voltage value to the reverb object. The flow proceeds to . At the reverb object performs magnitude filtering on the single voltage value. Such magnitude filtering is also further described in greater detail in relation to . In certain embodiments the sharpness value that is generated and stored within the reverb object is used to perform the magnitude filtering on the single voltage value. The flow proceeds to . At the reverb object plays a periodic effect at an actuator using the single voltage value. By playing the periodic effect at the actuator the reverb object causes the actuator to produce a haptic effect.

As previously described a haptic conversion module such as haptic conversion module of processes an audio signal contained within a PCM audio data buffer. As also previously described the processing of the audio signal includes sampling each audio data frame of a PCM audio data buffer calculating a maximum value for each audio data frame of a PCM audio data buffer and magnitude filtering. Such processing of the audio signal is now described in greater detail.

According to certain embodiments an envelope of the audio signal is first extracted. An envelope can be extracted using all frequencies of an original audio signal or a filtered version of the original audio signal. However the envelope itself does not have the same frequency content as the original audio signal.

In one embodiment an audio data frame is taken from the audio signal. As an example an audio data frame may have a frame length of 1 ms. As another example the audio data frame may have a frame length of 10 ms. A 1 ms audio data frame captures the envelope of frequencies above 500 Hz but lower frequencies are not captured and leak through. A 10 ms frame captures the envelope of frequencies above 50 Hz etc. In one embodiment an absolute value of each sample in the frame is computed. In an alternate embodiment a square of each sample in the frame is computed rather than an absolute value. Such processing constitutes the sampling of an audio data frame performed by a haptic conversion module such as haptic conversion module of .

A maximum value V of the absolute sample values or the square sample values in an alternate embodiment is computed. The maximum value V can then be converted using a linear conversion function as described below in relation to .

Thus according to the embodiment an envelope of an audio signal is mapped to an amplitude of a haptic signal where the amplitude of the haptic signal is filtered. In an alternate embodiment the envelope of the audio signal can first be filtered and then the filtered envelope of the audio signal can be mapped to an amplitude of a haptic signal.

Magnitude filtering performed by a haptic conversion module such as haptic conversion module of is now described in greater detail. A magnitude or strength V of a haptic effect is computed using the previous value V. In certain embodiments V can be mapped to a frequency. In other embodiments V can be mapped to a set of frequency values. If V of iteration i is smaller than V of iteration i 1 then the output V can be set to zero or some other small value or else the output remains unchanged V V . This specific technique can capture the peak values of the signal that represents a haptic event and automatically associate to that haptic event an independent haptic effect. This technique can also be used to let an actuator settle down before the next haptic event is played and thus avoiding saturating a user with too much haptic information. In an alternate embodiment smoother decay can be used rather than a sharp drop to 0 when V of iteration i is smaller than V of iteration i 1 . A sharpness parameter ranging from 0 to 100 can be used to define the amount of decay to be applied to V V V sharpness m where m is an integer divisor starting from 1 and increments as long as V of iteration i is smaller than V of iteration i 1 . According to the embodiment m is reset back to 1 when V of iteration i is greater or equal to V of iteration i 1 or in other words when V V . In certain embodiments a sharpness value that is generated and stored within a reverb object is used as the sharpness parameter.

Each frame of certain ms duration is processed in the frequency domain. Thus in certain embodiments a fast fourier transformation FFT of the frame can be used to extract the frequency content. In other embodiments band pass filters can be used to extract the frequency content.

In one embodiment the frame information can be divided in bass or low frequency for example lower than 200 Hz middle frequency for example between 240 Hz and 4000 Khz and high frequency for example higher than 4400 KHz where the middle frequency content and high frequency content is extracted using the content of the signal.

According to the embodiment when the signal starts to be processed the first frame contains more middle frequency content i.e. graph given the maximum value obtained which is bigger than a frequency value in the low frequency band i.e. graph and high frequency band i.e. graph .

According to the embodiment a haptic effect can be played when the content frequency of the frame is different from the frequency content of the previous frame. As illustrated in the haptic effect will be played at the locations signalized by arrows .

In alternate embodiments variations of this technique can include playing a pulse at every frequency change with magnitude as follows maximum magnitude of the unprocessed frame maximum magnitude corresponding to the frequency band maximum magnitude allowed in TouchSense software only for the first frame.

In certain alternate embodiments if the following frames have the same frequency content then the magnitude of the unprocessed frame can be played or the magnitude of the processed frame can be played or a constant vibration perhaps small can be played as long as the frame has the same frequency content or the magnitude can be varied based on power content in the frequency band.

In certain alternate embodiments a different haptic effect can be played when a frame with a different frequency content is found.

Furthermore human perception of sounds is not linear and depends on frequency of the sound. More particularly humans are more sensitive to low frequencies than to high frequencies. Gender and age also affect the perception. Thus in certain embodiments there could be a compensation factor that boosts certain frequencies. The boosting factor can be based on human perception of sound or even preference of users where some frequency bands are enhanced manually. The software can enhance in general the high frequency content where it is known that users have a lower sensitivity to sound. This will allow the haptic effect for a specific band to be of greater strength and thus enhancing the sound that while perceived and noticed by a user s auditive system might not have enough power.

In certain embodiments a user of the haptic conversion system can customize the sound to haptic effect conversion algorithm. More specifically the user can choose whether a digital audio signal is filtered using a low pass filter a high pass filter or a band pass filter. Alternatively or in addition to customizing a filter type the user can specify filter parameters rather than choosing between pre defined parameters. According to these embodiments a haptic conversion system can display one or more user defined parameters within a graphical user interface. The user can then either choose from one or more user defined parameters or specify one or more user defined parameters using the graphical user interface. For example a user can choose a type of filter utilized in the sound to haptic effect conversion algorithm from among a low pass filter a band pass filter and a high pass filter. As another example the user can specify one or more cut off frequencies where instead of a value between 250 and 500 Hz the user can specify any values. As yet another example the user can specify a gain that is used in the sound to haptic effect conversion algorithm.

In certain embodiments rather than utilizing system defined filter parameters the haptic conversion system can calculate filter parameters at runtime based on user defined parameters. More specifically a user can select a filter type. For example a user can select a Butterworth design a Bessel design or a Chebyshev design where for each design a user can select a low pass filter a high pass filter a band pass filter or a band stop filter. If a user selects a Chebyshev design a user can also specify a ripple. A user can also specify a filter order and a sample rate. A user can also specify one corner frequency if the user selected a low pass filter or a high pass filter and two corner frequencies if the user selected a band pass filter or a band stop filter. A user can also select an optional additional zero value and an optional lower limit of a magnitude scale. Furthermore a user can also select whether the filter is designed by a bilinear transform method or a matched z transform method. The haptic conversion system can then calculate one or more filter parameters at runtime based on the parameters specified by the user.

At a maximum value of the data frame is generated. In certain embodiments the maximum value is generated by sampling the data frame to generate one or more sample values of the data frame wherein the maximum value is a maximum value of the one or more sample values. In one embodiment the one or more samples values are absolute values. In an alternate embodiment the one or more sample values are square values. In certain embodiments the maximum value is converted from an original maximum value using a linear conversion function. The flow proceeds to .

At a haptic signal is generated based on the maximum value. In certain embodiments the maximum value defines a magnitude of the haptic signal. Also in certain embodiments the magnitude of the haptic signal is filtered. Additionally in certain embodiments where the magnitude of the haptic signal is filtered a sharpness parameter is used to define an amount of decay to be applied to the magnitude of the haptic signal. The flow proceeds to .

At the haptic signal is sent through an actuator to generate the one or more haptic effects. In certain embodiments the haptic signal is a periodic effect. Also in certain embodiments the generating and the sending the haptic signal further includes passing the maximum value as a parameter to an application programming interface of a haptic effect player module.

Thus according to an embodiment a haptic conversion system intercepts audio data frames that are part of an audio signal converts the audio data frames into a haptic signal where a maximum value of each audio data frame defines a magnitude of the haptic signal and plays the converted haptic signal through an actuator to generate haptic effects. Based on the maximum value that defines the magnitude of the haptic signal the strength of the haptic signal played through the actuator can be very strong thus creating a richly defined haptic effect.

The features structures or characteristics of the invention described throughout this specification may be combined in any suitable manner in one or more embodiments. For example the usage of one embodiment some embodiments certain embodiment certain embodiments or other similar language throughout this specification refers to the fact that a particular feature structure or characteristic described in connection with the embodiment may be included in at least one embodiment of the present invention. Thus appearances of the phrases one embodiment some embodiments a certain embodiment certain embodiments or other similar language throughout this specification do not necessarily all refer to the same group of embodiments and the described features structures or characteristics may be combined in any suitable manner in one or more embodiments.

One having ordinary skill in the art will readily understand that the invention as discussed above may be practiced with steps in a different order and or with elements in configurations which are different than those which are disclosed. Therefore although the invention has been described based upon these preferred embodiments it would be apparent to those of skill in the art that certain modifications variations and alternative constructions would be apparent while remaining within the spirit and scope of the invention. In order to determine the metes and bounds of the invention therefore reference should be made to the appended claims.

