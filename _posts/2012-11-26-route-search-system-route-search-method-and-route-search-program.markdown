---

title: Route search system, route search method, and route search program
abstract: A route search system according to one embodiment includes a receiving unit, a first search unit, a determination unit, a second search unit, and an output unit. The receiving unit receives search criteria. The first search unit searches for a first route and time required based on the search criteria by referring to a storage unit that stores route information. The determination unit determines whether a difference between user's time and the time required is equal to or more than a specified value. When the difference is the specified value or more, the second search unit searches for a second route that takes a longer time than the first route. The output unit outputs the second route.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09448077&OS=09448077&RS=09448077
owner: Rakuten, Inc.
number: 09448077
owner_city: Tokyo
owner_country: JP
publication_date: 20121126
---
This application is a National Stage of International Application No. PCT JP2012 080467 filed Nov. 26 2012 claiming priority based on Japanese Patent Application No. 2012 123208 filed May 30 2012 the contents of all of which are incorporated herein by reference in their entirety.

One embodiment of the present invention relates to a route search system a route search method and a route search program.

Techniques to present a route from the place of departure to the place of destination and time required for the route to a user have been known. For example a website taught by Non Patent Literature 1 below is to perform route search based on the place of departure the place of destination time criteria specification of any one of the time of departure the time of arrival the first train and the last train and other criteria specification of a via point a means of transportation etc. indicated by a user and present a route that satisfies those criteria to a user.

In the existing frameworks such as the website taught by the above described Non Patent Literature 1 although it is possible to find a route with less travel burden for example a route with the shortest time required a route with the cheapest fare a route with the fewest transfers etc. it is not possible to find a route that allows the best use of a user s time until the time of arrival. There is thus a demand for a framework that allows a user having extra time to make the best use of the time.

A route search system according to one aspect of the present invention includes a receiving unit configured to receive search criteria including a planned departure time a target arrival time a place of departure and a place of destination a first search unit configured to search for a first route from the place of departure to the place of destination and time required for the first route based on the search criteria by referring to a storage unit configured to store route information a determination unit configured to determine whether a difference between time from the planned departure time to the target arrival time and the time required is equal to or more than a specified value a second search unit configured to when the difference is equal to or more than the specified value calculate a difference between a departure time of a candidate route and the planned departure time and calculate a difference between an arrival time of the candidate route and the target arrival time by referring to the storage unit determine whether the candidate route satisfies route requirements that depart from the place of departure within a specified time from the planned departure time and arrive at the place of destination at some time from a specified time before the target arrival time to the target arrival time by taking a longer time than the first route based on the two differences and thereby search for a second route that satisfies the route requirements and an output unit configured to output the second route as a search result for the search criteria.

A route search method according to one aspect of the present invention is a route search method performed by a route search system including a receiving step of receiving search criteria including a planned departure time a target arrival time a place of departure and a place of destination a first search step of searching for a first route from the place of departure to the place of destination and time required for the first route based on the search criteria by referring to a storage unit that stores route information a determination step of determining whether a difference between time from the planned departure time to the target arrival time and the time required is equal to or more than a specified value a second search step of when the difference is equal to or more than the specified value calculating a difference between a departure time of a candidate route and the planned departure time and calculate a difference between an arrival time of the candidate route and the target arrival time by referring to the storage unit determining whether the candidate route satisfies route requirements that depart from the place of departure within a specified time from the planned departure time and arrive at the place of destination at some time from a specified time before the target arrival time to the target arrival time by taking a longer time than the first route based on the two differences and thereby searching for a second route that satisfies the route requirements and an output step of outputting the second route as a search result for the search criteria.

A route search program according to one aspect of the present invention causes a computer to implement a receiving unit configured to receive search criteria including a planned departure time a target arrival time a place of departure and a place of destination a first search unit configured to search for a first route from the place of departure to the place of destination and time required for the first route based on the search criteria by referring to a storage unit configured to store route information a determination unit configured to determine whether a difference between time from the planned departure time to the target arrival time and the time required is equal to or more than a specified value a second search unit configured to when the difference is equal to or more than the specified value calculate a difference between a departure time of a candidate route and the planned departure time and calculate a difference between an arrival time of the candidate route and the target arrival time by referring to the storage unit determine whether the candidate route satisfies route requirements that depart from the place of departure within a specified time from the planned departure time and arrive at the place of destination at some time from a specified time before the target arrival time to the target arrival time by taking a longer time than the first route based on the two differences and thereby search for a second route that satisfies the route requirements and an output unit configured to output the second route as a search result for the search criteria.

According to the above described aspects when a difference between time from the departure time to the arrival time indicated by search criteria and time required for a route obtained by the first route search based on the search criteria is equal to or more than a specified value which is when there is extra time in the user s time a route that fills the time is searched for. To be specific in order to find a route second route that takes a longer time than a first route and that departs at the time that is as close as possible to the planned departure time and arrives at the time that is as close as possible to the target arrival time the second search is performed based on both of the departure time to the arrival time. Then the second route that is found as a result of the search is presented to a user. By such two step search it is possible to present a user having extra time a route to make the best use of the time.

In the route search system according to another aspect the storage unit may further store availability information indicating an available period or an available time zone of a route or a facility and the second search unit may select a candidate route that satisfies the route requirements and goes through the route or the facility during the available period or the available time zone as the second route. It is thereby possible to prevent that a route that is actually not available is presented as the second route to a user and it is thereby expected to enhance the convenience of the route search system.

In the route search system according to another aspect the storage unit may further store evaluation information indicating an evaluation of a route or a facility based on a timing factor and the second search unit may determine an evaluation value of a candidate route based on the evaluation information of a route or a facility included in the candidate route and selects a candidate route that has a higher evaluation value than other candidate routes as the second route. It is thereby possible to present a user the route with a high evaluation value which is a route that is expected to give a user a higher level of satisfaction by using the route as the second route and it is thereby expected to enhance the satisfaction level of the user.

In the route search system according to another aspect the receiving unit may acquire position information of a user after the output unit outputs the second route and specifies new search criteria including the planned departure time and the place of departure obtained from the position information and a new second route may be output by the first search unit the determination unit the second search unit and the output unit based on the new search criteria. Thus even if the second route presented once to a user becomes inappropriate later on it is possible to present the user the second route based on the search criteria specified by the latest information and it is thereby expected to enhance the satisfaction level of the user.

In the route search system according to another aspect the second search unit may select the new second route among routes that go through a different via point from the second route previously output from the output unit. Thus when a user does not travel along the second route presented first it is possible to present the user the route including another via spot as the second route and it is thereby expected to enhance the satisfaction level of the user.

In the route search system according to another aspect the second search unit may select the new second route among routes that travel by a different means of transportation from the second route previously output from the output unit. Thus when a user does not travel along the second route presented first it is possible to present the user the route by another means of transportation as the second route and it is thereby expected to enhance the satisfaction level of the user.

In the route search system according to another aspect the receiving unit may receive the search criteria further including target calorie consumption and the second search unit may acquire expected calorie consumption for a case where the user uses a candidate route and selects the candidate route that satisfies the route requirements and where the expected calorie consumption is equal to or more than the target calorie consumption as the second route. Thus when there is extra time in user s time it is possible to present the user the route that allows consumption of calories during traveling as the second route and it is thereby expected to enhance the satisfaction level of the user who desires to consume calories by using the extra time.

In the route search system according to another aspect when the candidate route where the expected calorie consumption is equal to or more than the target calorie consumption does not exist the second search unit may select the candidate route that satisfies the route requirements and where the expected calorie consumption is highest as the second route. It is thereby possible to present a user the route to consume as many calories as possible though not to consume the target calories as the second route and it is thereby expected to enhance the satisfaction level of the user who desires to consume calories by using the extra time.

In the route search system according to another aspect the second search unit may acquire position information of a user after the output unit outputs the second route estimate a via point and a stay time at the via point of the user based on the position information calculate calorie intake of the user at the via point based on a result of the estimation update the target calorie consumption based on the calorie intake and search for the new second route based on the search criteria including the updated target calorie consumption. It is thereby possible to modify the target calorie consumption in consideration of the amount of calories estimated to be taken by a user during traveling and present the user the route to achieve the modified target calorie consumption as the second route again. This eliminates the need for the user to enter the target calorie consumption again when the user eats some calories during traveling and it is thereby expected to enhance the satisfaction level of the user.

According to one aspect of the present invention it is possible to present a user having extra time a route to make the best use of the time.

Embodiments of the present invention will be described hereinafter in detail with reference to the appended drawings. Note that in the description of the drawings the same or equivalent elements are denoted by the same reference symbols and the redundant explanation thereof is omitted.

First an overall configuration of a route search system according to this embodiment is described with reference to . The route search system includes a route search server databases storage unit and user terminals . Those devices are connected with one another through a communication network N. A user causes the route search server to perform route search processing through the user terminal and thereby acquires information about a route that allows the best use of the user s time.

The route search server is a computer system that performs route search processing in response to a search request from a user.

The databases are a set of several types of databases that are required in the route search system . In this embodiment each of the databases is configured as a separate component from the route search server as shown in and connected to the route search server through a dedicated network such as SAN Storage Area Network . Note that however the configuration of the databases is not limited thereto. For example each of the databases may be NAS Network Attached Storage connected to the communication network N or may be DAS Direct Attached Storage directly connected to the route search server by the SCSI interface. Further each database may be built in the route search server .

The user terminal is a computer that is owned by a user general user . Although the user terminal may be a stationary personal computer a portable terminal which a user can use as moving is mainly assumed in this embodiment. To be specific the user terminal is a portable terminal such as an advanced mobile phone smart phone a mobile phone or a personal digital assistant PDA for example. The type of the user terminal however is not limited thereto. The number of user terminals in the route search system is also not particularly limited.

Based on the above assumption the route search server is described in detail hereinbelow. First the databases which the route search server refers to for route search are described in detail.

A route database is a device that stores route information. The content and format of the route information are determined from the viewpoints of the specific implementation method processing efficiency and the like of route search processing performed by the route search server . In this embodiment the route information includes a route ID that identifies a route a departure point ID an arrival point ID a means of transportation a departure time an arrival time and time required for each route between adjacent points. The departure time and the arrival time are availability information indicating a time period or a time zone where the route is available.

An example of routes that are used in this embodiment is described with reference to . In routes between points and facilities located in each point are schematically shown. N to N indicate points that serve as reference points for route search such as bus stops stations airports ports and intersections. E to E indicate routes between adjacent points such as lines buses trains airplanes ships etc. and roads. F and F indicate facilities located at the point N and the point N respectively.

The facility database is a device that stores facility information. The content and format of the facility information are determined from the viewpoints of the specific implementation method processing efficiency and the like of route search processing performed by the route search server . In this embodiment the facility information includes a facility ID that identifies a facility a facility name a point ID of a point where a facility is located and other facility related information average stay time business hours seasonal factor temporal factor etc. . The business hours are availability information indicating a time period or a time zone where the facility is available and the seasonal factor and the temporal factor are evaluation information indicating evaluations of the facility based on timing factors.

The store database is a device that stores store information. The content and format of the store information are determined from the viewpoints of the specific implementation method processing efficiency and the like of route search processing performed by the route search server . In this embodiment the store information includes a store ID that identifies a store a store genre ID that identifies a store genre a store name and store position information latitude and longitude . shows an example of store information.

The store genre database is a device that stores store genre information. The content and format of the store genre information are determined from the viewpoints of the specific implementation method processing efficiency and the like of route search processing performed by the route search server . In this embodiment the store genre information includes a store genre ID that identifies a store genre a store genre name a stay time and estimated calorie intake. shows an example of store genre information.

Note that the structures of the respective databases are not limited to those shown in and the databases may be normalized or made redundant by an arbitrary policy.

The functions and configuration of the route search server are described hereinafter. shows a hardware configuration of the route search server . As shown therein the route search server includes a CPU that executes an operating system an application program and the like a main storage unit such as ROM and RAM an auxiliary storage unit such as a hard disk a communication control unit such as a network card an input device such as a keyboard and a mouse and an output device such as a display. Note that however it is not necessary to include the input device and the output device when there is no need to directly operate the route search server when setting of a server update of software and the like are performed by remote control and the like.

The functional elements of the route search server which are described later are implemented by loading given software onto the CPU or the main storage unit making the communication control unit the input device the output device and the like operate under control of the CPU and performing reading and writing of data in the main storage unit or the auxiliary storage unit . The data and database required for processing are stored in the main storage unit or the auxiliary storage unit . Note that although the route search server is composed of one computer in the example of the functions of the route search server may be distributed among a plurality of computers.

The user terminal has the same hardware configuration as the route search server and therefore the illustration of the hardware configuration of the user terminal is omitted. Note that however specific parts can be different between the user terminal and the route search server and the input device and the output device are implemented by a touch panel in the user terminal for example. In the user terminal like the route search server the below described functional elements are implemented using hardware.

An overview of route search processing performed by the route search system according to this embodiment is described hereinafter. The route search system performs route search in response to a search request from a user and presents a route that allows the best use of the user s time which is referred to hereinafter as initial search . The route search system may search and present a route again after presenting a route to the user once by initial search by receiving position information and position information acquisition time of the user terminal as appropriate from the user terminal which is referred to hereinafter as automatic re search . The route presented to the user by the initial search can become an unavailable route or an inappropriate route later on when a user does not travel along the presented route or when an unexpected situation such as train delay occurs on the route. With the automatic re search it is possible to present an appropriate route again to the user and enhance the convenience of the user.

The functional elements of the route search system according to this embodiment are described hereinafter with reference to .

First the functional elements of the user terminal are described. The user terminal includes an input operation unit a request unit an assistance information storage unit and a display unit . The input operation unit is a functional element that receives an input operation from a user. The request unit is a functional element that receives input search criteria and transmits them to the route search server . The assistance information storage unit is a functional element that stores information that assists the input of search criteria. The display unit is a functional element that displays a search result screen.

The request unit generates search criteria based on information input by a user through the input operation unit or assistance information stored in the assistance information storage unit . The search criteria at least include the planned departure time the target arrival time the place of departure and the place of destination and may further include target calorie consumption. The request unit transmits the generated search criteria to the route search server . After that the display unit displays the route information presented by the route search server as a search result. The assistance information stored in the assistance information storage unit includes schedule information registered in advance by a user system time information and position information acquired by GPS. The request unit can obtain the target arrival time and the place of destination from the schedule information obtain the current time planned departure time from the system time information and obtain the current place place of departure from the position information.

When the route search server performs the automatic re search the request unit transmits the position information and the position information acquisition time of the user terminal to the route search server at regular intervals or by a user s explicit operation.

Next the functional elements of the route search server are described. The route search server includes a receiving unit a first search unit a determination unit a second search unit and an output unit .

The receiving unit is a functional element that receives search criteria. The receiving unit receives the search criteria from the request unit of the user terminal and temporarily stores the search criteria and passes them to the first search unit . The temporarily stored search criteria are referred to at the time of automatic re search. Specifically at the time of automatic re search the receiving unit specifies new search criteria based on the position information and the position information acquisition time of the user terminal received from the request unit and the temporarily stored search criteria and passes the new search criteria to the first search unit .

Note that although the request unit generates all of the search criteria for the initial search in this embodiment the route search server may complement the input of the search criteria. To be specific the route search server may use the system time that is held by the route search server as the planned departure time current time of the search criteria or may set the target arrival time and the place of destination of the search criteria based on the user s schedule information registered in the route search server or another external server not shown . This reduces the amount of search criteria to be entered by a user and it is thereby possible to save a user the trouble of entering the criteria.

The first search unit is a functional element that searches for a route first route from the place of departure to the place of destination and time required for the route based on the search criteria acquired from the receiving unit . The first search unit acquires the first route and time required for the route that satisfy the search criteria by referring to the route database . After that the first search unit passes the acquired route information to the determination unit . In this embodiment it is assumed that the first route is a route with the shortest time required shortest route . Note that however the first route is not limited thereto and it may be a route with the cheapest fare cheapest route a route with the easiest transfers the easiest route a route with the highest evaluation value of those indexes or the like. Further the first route may be a plurality of routes such as several routes in higher ranks when evaluated by the same index or routes in higher ranks of the respective evaluations. When there are a plurality of candidates for the first route the first search unit passes each of the candidate routes as the first route to the determination unit .

A route search algorithm that is used by the first search unit to search for the first route is not particularly limited. To be specific a route search algorithm which is the improvement of the shortest route algorithm such as the Dijkstra s algorithm is used for example.

The first route is described hereinafter using the examples shown in . When the place of departure and the place of destination of the search criteria are the point N and the point N respectively there are three possible routes route route E and route E route route E and route route E . Assuming that the train wait time is negligible for any of the routes E to E the time required for the route is 10 minutes 7 minutes 3 minutes the time required for the route is 5 minutes and the time required for the route is 20 minutes. Thus in this case the route which is the shortest route is selected as the first route and the first search unit passes the route and the time required for the route 5 minutes to the determination unit .

The determination unit is a functional element that determines whether a difference between the time from the planned departure time to the target arrival time which is referred to hereinafter as user s time and the time required for the first route acquired from the first search unit is equal to or more than a specified value k. The specified value k may be a fixed value such as k 20 or a value calculated by a calculation formula such as k user s time 0.5. The determination unit passes the determination result to the second search unit .

When the time from the planned departure time to the target arrival time is T and the time required for the first route is T the determination unit calculates a difference between those two times t T T. Then the determination unit determines whether the difference t is equal to or more than the specified value k.

An example of the determination method is described with reference to . It is assumed that the planned departure time is 8 00 am and the target arrival time is 8 20 am. As described earlier because the route E which is the shortest route is the first route T 20 and T 5 and t T T 15. In the case where the specified value k is defined as k 20 because t is not equal to or more than the specified value k the determination unit determines that the difference is not equal to or more than the specified value. On the other hand in the case where the specified value k is defined as k T 0.5 k 10 and because t is equal to or more than the specified value k the determination unit determines that the difference is equal to or more than the specified value.

The second search unit is a functional element that searches for a route second route that allows a user to make the best use of the time when a difference between the user s time and the time required for the first route is equal to or more than the specified value which is when there is extra time in the user s time. In the case where the determination result of the determination unit is the difference is equal to or more than the specified value the second search unit searches for a second route that satisfies route requirements that depart from the place of departure within a specified time k from the departure time and arrive at the place of destination at some time from a specified time k before the target arrival time to the target arrival time taking a longer time than the first route. To be specific the second search unit refers to the route database and the facility database and acquires the second route that satisfies the search criteria and the route requirements. On the other hand in the case where the determination result of the determination unit is the difference is not equal to or more than the specified value the second search unit passes the first route as the final search result to the output unit without searching for the second route.

The above described k and k are set to the shorter time than the user s time in order to make the best use of the user s time. For example k and k may be values where the user s travel time from the departure time to the arrival time fills at least 70 of the user s time or fills 80 of the user s time in order to find the route that makes the better use of the user s time. Note that however the values of k and k are not limited thereto.

When the second search unit acquires one or more second routes as a result of search it passes the second routes to the output unit . There may be a plurality of second routes and in this case the second search unit passes the plurality of second routes to the output unit . On the other hand when there is no candidate for the second route including the case where the second search unit does not search for the second route the second search unit may pass the first route to the output unit .

The second search unit determines the route that satisfies the route requirements as the second route among candidate routes such as a circuitous route a route using a slow means of transportation and a route that stops by some facility. The second search unit may determine the second route based on the business hours the temporal factor and the like contained in the facility information. Specifically the search unit may make determination about the appropriateness of use of each of the routes extracted as candidates and exclude an unavailable route and a route that is not appropriate for use dangerous route crowded route etc. .

Further the second search unit may determine the second route based on the evaluation value of each of the candidate routes determined from the evaluation information of the route or the facility. The second search unit compares the user s time with the timing factor seasonal factor or temporal factor of the facility indicated by the facility information and determines the evaluation value of the route that goes through the facility during the time or period indicated by the timing factor. For example the second search unit increases the evaluation value to be more than usual for the candidate route that goes through the park A during the period indicated by the seasonal factor cherry blossoms bloom in spring in . On the other hand the second search unit reduces the evaluation value to be less than usual for the candidate route that goes through the park A during the time indicated by the temporal factor dangerous after 11 pm and the candidate route that goes through the park B during the period indicated by the temporal factor crowded in holidays in .

Then the second search unit preferentially selects the candidate route where the calculated evaluation value is high. To be specific the second search unit selects an arbitrary number of candidate routes in the descending order of the evaluation values as the second routes. Note that the route information may contain evaluation information and in this case the second search unit can determine the second route by taking the evaluation value of the route just like the evaluation value of the facility into consideration.

In the case where target calorie consumption is included in the search criteria the second search unit searches for a route by using not only the route requirements but also the requirements that the target calorie consumption is achieved . When the route that satisfies the requirements about the target calorie consumption is not found the second search unit may determine the route where the expected calorie consumption is as high as possible as the second route. It is thereby possible to present a user the route to consume as many calories as possible though not to consume the target calories and thereby enhance the satisfaction level of the user.

The search by the second search unit and the second route are specifically described hereinafter using the example of routes in . It is assumed that the specified value k is defined as k T 0.5. In this case because the determination unit determines that the difference is equal to or more than the specified value as described above the second search unit search for the second route.

The second route is described with reference to . It is assumed that the specified values k and k are defined as fixed values 5 minutes . Further the expected calorie consumption is 30 kcal by walking for 10 minutes and 3 kcal by train for 10 minutes. Further for convenience of description the time required for the first route and the second route is L and L respectively and a difference between the planned departure time and the departure time of each route is t and a difference between the arrival time of each route and the target arrival time is t. Based on such assumptions the route requirements to be satisfied by the second route are t k and t k and L

The route requirements are described first. The first route is the route that departs from the point N at 8 00 am and arrives at the point N at 8 05 am through the route E. Thus t 0 k 5 t 15 k 5 L 5 L 5 and the first route in this example does not satisfy the route requirements.

The candidates for the second route are the candidate route the route that departs from the point N at 8 00 am and arrives at the point N at 8 07 am through the route E stops by the facility F from 8 07 am to 8 17 am and then departs from the point N at 8 17 am and arrives at the point N at 8 20 am through the route E and the candidate route the route that departs from the point N at 8 00 am and arrives at the point N at 8 20 am through the route E as shown in . Because both of the candidate route and the candidate route satisfy the route requirements when the search criteria do not include the target calorie consumption the second search unit selects both of the candidate route and the candidate route as the second routes.

The processing in the case of taking the calorie consumption requirements into consideration is described hereinafter. It is assumed that the target calorie consumption is included in the search criteria and the target calories to be consumed are 50 kcal. When using the candidate route the user can consume 3 kcal by taking a train for 10 minutes in total through the route E and the route E and consume 30 kcal by stopping by the facility F for 10 minutes and thus can consume 33 kcal in total. On the other hand when using the candidate route the user can consume 60 kcal by walking through the route E for 20 minutes. Accordingly while the candidate route does not satisfy the calorie consumption requirements the candidate route satisfies the calorie consumption requirements. Thus the second search unit selects only the candidate route as the second route.

Note that although calorie consumption per unit workout 10 minute walking is assumed to be 30 kcal in the above example the amount of calories consumed actually varies from individual to individual depending on gender body weight and the like. Thus the route search server may have a database not shown that stores calorie settings such as calorie consumption for each gender body weight or per unit workout of each user and the second search unit may calculate calorie consumption by referring to the database. The second search unit can thereby calculate calorie consumption in accordance with each user. Note that however the way of storing and using calorie settings is not limited thereto. For example the user terminal may store calorie settings and the user terminal may transmit the calorie settings to the route search server at the same time as sending a search request. Further calorie settings may have default settings and a user may customize the settings.

The second search unit may estimate a via point and a stay time of a user estimate the amount of calories taken by the user during stay estimated calorie intake and automatically update the target calorie consumption by a difference between the estimated calorie intake and the amount of calories already consumed by the user in the automatic re search in the case where the search criteria include target calorie consumption.

First the second search unit estimates the via point and the stay time of the user based on the position information and the position information acquisition time acquired from the user terminal by the receiving unit . Specifically the second search unit acquires the position information latitude and longitude of the via point and the stay time based on the history of the position information and the position information acquisition time transmitted from the user terminal at regular intervals or by the user s explicit operation. As the interval of transmission of the position information and the position information acquisition time from the user terminal is shorter the second search unit can estimate the via point and the stay time of the user more accurately. Note that however a means of estimating the via point and the stay time of the user is not limited thereto. For example the second search unit may acquire the position information registered by the user on a service provided by the Internet and estimate the via point and the stay time of the user based on the position information.

Next the second search unit acquires the estimated calorie intake. The second search unit searches the store database based on the position information latitude and longitude of the via point and acquires the store genre ID of the corresponding store information. After that the second search unit searches the store genre database based on the store genre ID and the stay time and acquires the estimated calorie intake of the corresponding store genre information.

Finally the second search unit revises the target calorie consumption upward by the difference between the estimated calorie intake and the amount of calories already consumed by the user and then determines the second route by the above described automatic re search.

An example of the automatic re search is described hereinafter with reference to . For easier description the travel time is not taken into consideration the route requirements are always satisfied in this example. In c to c indicate the amount of calories to be consumed for traveling through each route. When a user is at the point A and performs route search by setting the place of departure to the point A the place of destination to the point C and the target calorie consumption to c the second search unit determines that c c c and selects the route of the point A the point B the point C as the second route. However actually the user travels through the route of the point A the point B the coffee shop A and stays at the coffee shop A for one hour. The processing of the automatic re search after that is described hereinafter.

First the second search unit estimates the via point coffee shop A and the stay time one hour from the position information and the position information acquisition time acquired from the user terminal by the receiving unit .

Next the second search unit searches the store database shown in based on the via point coffee shop A and thereby acquires the store genre ID J of the corresponding store information store information with the store ID S . After that the second search unit searches the store genre database shown in based on the store genre ID J and the stay time one hour and thereby acquires the estimated calorie intake 300 kcal of the corresponding store genre information store genre information with the store genre ID J .

Finally the second search unit revises the target calorie consumption c upward by the difference 300 c between the estimated calorie intake 300 kcal and the amount of calories c already consumed by the user c

The output unit is a functional element that outputs the second route acquired from the second search unit as a search result for the search criteria. To be specific the output unit transmits information of the second route to the user terminal and the user terminal receives the information and displays a search result screen containing the information of the second route on the display unit and thereby the second route is presented to the user. Note that when the second route is not found when the second search unit does not search for the second route or when the second route is not found as a result that the second search unit searches for the second route the output unit outputs the first route.

The operation of the route search system and a route search method according to this embodiment are described hereinafter with reference to .

First the overall flow of the route search process is described with reference to . Steps S to S are the process of initial search and Steps S to S are the process of automatic re search.

A user enters search criteria through the input operation unit Step S . The route search server receives the search criteria by the receiving unit Step S receiving step . After that the first search unit the determination unit the second search unit and the output unit perform route search processing Step S . The display unit displays the search result acquired from the output unit Step S .

The user terminal transmits the position information of the terminal to the route search server still after obtaining the route information once from the route search server at regular intervals or by the user s explicit operation Step S . The route search server acquires the position information by the receiving unit and updates the search criteria Step S . After that the first search unit the determination unit the second search unit and the output unit perform the same route search processing as in Step S Step S and the display unit displays the search result Step S . The automatic re search from Step S to S is performed repeatedly at regular intervals or by the user s explicit operation until the user arrives at the place of destination Step S .

The details of the route search processing in Steps S and S in are described hereinafter with reference to .

In the case where the automatic update of target calorie consumption is not performed the processing of Steps S and S in is both the process shown in . Specifically the first search unit searches for the first route first Step S first search step . Next the determination unit calculates a difference between the user s time and time required for the first route Step S and determines whether the difference is equal to or more than the specified value Step S determination step .

When the difference is equal to or more than the specified value the second search unit searches for the second route Step S second search step . When the search criteria do not include target calorie consumption the second search unit searches for the route that satisfies the route requirements and when the search criteria include target calorie consumption the second search unit searches for the route that satisfies both of the route requirements and the calorie consumption requirements. When the second route is found as a result of the search YES in Step S the output unit outputs the second route as a search result Step S output step . On the other hand when it is determined that the difference is not equal to or more than the specified value NO in Step S or when the second route is not found NO in Step S the output unit outputs the first route Step S output step .

In the case where the automatic update of target calorie consumption is performed the processing of Step S in is the process shown in and the processing of Step S in is the process shown in . Differences Steps S to S second search step of the process shown in from the process shown in are particularly described hereinafter.

The processing of Steps S to S is the same as the processing of Steps S to S described above. When the difference is equal to or more than the specified value YES in Step S the second search unit determines whether the user has stopped by a restaurant or the like based on the position information acquired from the user terminal Step S . When it is determined that the user has stopped by some place YES in Step S the second search unit acquires the estimated calorie intake based on the estimated via point and stay time Step S and revises the target calorie consumption upward based on the estimated calorie intake Step S . After that the second search unit searches for the second route based on the revised target calorie consumption Step S second search step . The processing of Steps S to S is the same as the processing of Steps S to S described above.

A route search program P that causes a computer to function as the route search server is described hereinafter with reference to .

The route search program P includes a main module P a receiving module P a first search module P a determination module P a second search module P and an output module P.

The main module P is a part that exercises control over the route search process. The functions implemented by executing the receiving module P the first search module P the determination module P the second search module P and the output module P are equal to the functions of the receiving unit the first search unit the determination unit the second search unit and the output unit described above respectively.

The route search program P is provided in the form of being recorded in a static manner on a tangible recording medium such as CD ROM or DVD ROM or semiconductor memory for example. Further the route search program P may be provided as a data signal superimposed onto a carrier wave through a communication network.

As described above according to this embodiment it is possible to present a user having extra time a route that makes the best use of that time which is a route that allows the user to make effective use of the time during traveling. Further in the case where the already presented route becomes inappropriate later on it is possible to present the user an appropriate route again by automatic route re search. Furthermore by adding target calorie consumption to search criteria it is possible to present the user a route to achieve consumption of target calories. Further in the case where the user stops by a restaurant or the like it is possible to automatically revise the target calorie consumption upward and present the user a route to achieve consumption of the initially set target calories.

Hereinbefore the present invention has been described in detail with respect to the embodiment thereof. However the present invention is not limited to the above described embodiment. Various changes and modifications may be made therein without departing from the scope of the invention.

All of the functional elements of the route search server in the above described embodiment may be incorporated into the user terminal and the user terminal may directly access the databases and obtain the second route. In this case the route search server is omitted. To be specific as shown in the receiving unit receives input information from the input operation unit and the assistance information storage unit and generates search criteria and outputs the search criteria to the first search unit .

Further the route search system according to the present invention may be implemented as API Application Programming Interface that returns information about a route that makes the best use of user s time in response to a search request from another computer software.

