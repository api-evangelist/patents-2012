---

title: System and method of extending oauth server(s) with third party authentication/authorization
abstract: In accordance with various embodiments, systems and methods that provide for authorization of access to protected resources. Such a system can include a plurality of applications, executing on one or more application servers. The system can also include an authorization server which is operable to interface with one or more remote and/or non-co-located third party authentication servers. Each application can (a) receive a request for authorization to access a controlled resource; (b) redirect the request for authorization to a configurable authentication endpoint identifying a third party authentication server; (c) receive authorization information from the third party authorization server; and (d) issue an authorization code for access to the protected resource.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08782411&OS=08782411&RS=08782411
owner: Oracle International Corporation
number: 08782411
owner_city: Redwood Shores
owner_country: US
publication_date: 20120725
---
A portion of the disclosure of this patent document contains material which is subject to copyright protection. The copyright owner has no objection to the facsimile reproduction by anyone of the patent document or the patent disclosure as it appears in the Patent and Trademark Office patent file or records but otherwise reserves all copyright rights whatsoever.

This application is related to all of the following patent applications all of which are incorporated herein by reference in their entireties including all Appendices filed therewith 

U.S. patent application Ser. No. 13 557 474 filed Jul. 25 2012 entitled SYSTEM AND METHOD OF SECURE SHARING OF RESOURCES WHICH REQUIRE CONSENT OF MULTIPLE RESOURCE OWNERS USING GROUP URI S and

U.S. patent application Ser. No. 13 557 478 filed Jul. 25 2012 entitled SYSTEM AND METHOD OF MAPPING AND PROTECTING COMMUNICATION SERVICES WITH OAUTH .

The current invention relates to an authorization protocol and in particular to a system and method for supporting authorization servers and authentications servers which are not co located.

Open Authorization Protocol OAuth is an open standard for authorization. OAuth allows users to for example share their private resources e.g. photos videos contact lists stored on one site with another site without having to hand out their credentials typically supplying username and password tokens instead. Each token grants access to a specific site e.g. a video editing site for specific resources e.g. just videos from a specific album and for a defined duration e.g. the next 2 hours . This allows a user to grant a third party site access to their information stored with another service provider without sharing their access permissions or the full extent of their data.

The OAuth specification describes the authorization flow on issuing access token based on resource owner user authorization. However the interaction between the authorization authentication server and the resource owner about how to check the resource owner s credentials is not defined. Existing OAuth implementations only support a co located authorization server and authentication server. That is to say the standard OAuth authorization flow and private authentication mechanism are strongly coupled as a whole solution hard to be separated and re used with third party authentication authorization servers.

In accordance with various embodiments systems and methods that provide for authorization of access to protected resources are provided. Such a system can include a plurality of applications executing on one or more application servers. The system can also include an authorization server which is operable to interface with one or more remote and or non co located third party authentication servers. Each application can a receive a request for authorization to access a controlled resource b redirect the request for authorization to a configurable authentication endpoint identifying a third party authentication server c receive authorization authentication information from the third party authentication server and d issue an authorization code for access to the protected resource. The third party authentication server need not be co located may be remote from the system may be outside the direct control of the system operator. A custom mechanism and or code can be implemented for authorization and authentication.

Embodiments of the present invention extend the present standards for authorization by defining a custom authentication authorization flow supporting the separation of authentication and resource owner interaction. Using this feature customers can integrate any authentication authorization mechanism available in the world for e.g. Facebook Google Subscriber or a custom identity management product into a services gatekeeper system. This feature enables operators to use their own custom identity management systems or delegate the authentication authorization service to a third party e.g. Facebook Facebook Google Subscriber or a custom identity management product . When an application requests access to subscriber information the services gatekeeper system of the present invention can communicate with a third party authentication server via a custom protocol to authenticate the subscriber s credentials. Once authorized the authentication server can notify the services gatekeeper system which then grants the application access to the requested subscriber information.

Other objects and advantages of the present invention will become apparent to those skilled in the art from the following detailed description of the various embodiments when read in light of the accompanying drawings.

In the following description the invention will be illustrated by way of example and not by way of limitation in the figures of the accompanying drawings. References to various embodiments in this disclosure are not necessarily to the same embodiment and such references mean at least one. While specific implementations are discussed it is understood that this is provided for illustrative purposes only. A person skilled in the relevant art will recognize that other components and configurations may be used without departing from the scope and spirit of the invention.

Furthermore in certain instances numerous specific details will be set forth to provide a thorough description of the invention. However it will be apparent to those skilled in the art that the invention may be practiced without these specific details. In other instances well known features have not been described in as much detail so as not to obscure the invention.

Common reference numerals are used to indicate like elements throughout the drawings and detailed description therefore reference numerals used in a figure may or may not be referenced in the detailed description specific to such figure if the element is described elsewhere. The first digit in a three digit reference numeral indicates the series of figures in which the element first appears. Likewise the first two digits in a four digit reference numeral.

Accordingly the services gatekeeper includes pre built specialized components the communication services to allow third party developers and application partners to easily access the operator s telecommunication network capabilities. The network capabilities supported by the communication services include for example messaging call control terminal location payment profile and presence.

Services gatekeeper includes an authorization server which provides an authorization service. The conventional OAuth protocol allows controlled access to user resources for example picture files identified by a uniform resource identifier URI . Services gatekeeper includes extended functionality supplied by authorization server in conjunction with resource server and service interceptors for controlling access and exposure of communication services enabling third party applications to access subscribers users resources such as location and charging. For example this extended functionality allows an application to charge on behalf of the subscriber assuming the subscriber has explicitly provided approval for this application to do so. Subscribers however retain complete control by enabling usage of their personal resources on a granular time specific basis and can revoke this access at any time. In accordance with embodiments of the present invention authorization server also supports delegated authentication and authorization enabling subscriber verification through custom communication channels such as short message service SMS and unstructured supplementary service data USSD with third party authentication server . In addition authorization server also enables operators to offer authentication as a service thereby allowing subscribers to more easily log into third party applications and websites by using their subscriber ID.

To enable the extended functionality of authorization server services gatekeeper includes a system for mapping and protecting communication services Application Programming Interface APIs . The system supports granular authorization of API access utilizing the authorization server . Services gatekeeper map communication services into an authorization server resource. The resource is defined based on the interface and the method of the communication services . The resource can be defined either in a fine grain and or coarse grain level using a flexible mapping structure. The flexible mapping structure can be used to map a plurality of different communication services to provide scoped access to subscriber information. This scoped access allows the subscriber to provide access to specific portions of their information e.g. provide access to only location information or charging information without providing access to all information. Thus the services gatekeeper enables mapping communication services to authorization scopes and automatically protecting subscriber data exposed by the communication services with fine granular control API level method level parameter level using authorization tokens. This solution provides flexible control of API exposure of subscriber data using authorization server . The use of authorization server to provided scoped access to communications services is described in U.S. patent application Ser. No. 13 557 478 filed Jul. 25 2012 entitled SYSTEM AND METHOD OF MAPPING AND PROTECTING COMMUNICATION SERVICES WITH OAUTH which is incorporated herein by reference.

The standard OAuth protocol provides a method by which a client application can access a protected resource such as user photographs or files with the permission of the resource owner user . In general before the client application can access the protected resource it must first obtain an authorization grant from the resource owner and then exchange the authorization grant for an access token understood by the resource server. The access token is a proxy which replaces different authorization constructs e.g. username and password which need not be disclosed to the client application. The access token can specify a scope and duration. Moreover the resource server need not interpret and validate diverse authentication schemes as it can rely on the access token alone. However the conventional OAuth implementation provides a co located authorization server and authentication server. That is to say the standard OAuth authorization flow is strongly coupled to the private authentication mechanism as an integrated solution. The authentication and authorization functionality is hard to separate and re use with third party authentication servers. This is problematic where a third party authorization authentication service is desired to be initiated used and or changed.

Embodiments of the present invention extend the present standards for authorization authentication by defining a custom authentication authorization flow supporting the separation of authentication and resource owner interaction from authorization in a services gatekeeper see . Services gatekeeper can thereby communicate with third party authentication server . Using this feature the services gatekeeper can integrate any authorization authentication mechanism available in the world for e.g. Facebook Google Subscriber or a custom identity management product . This feature enables operators of the system to use their own custom identity management systems or delegate the authentication service to a third party e.g. Facebook Facebook Google Subscriber or a custom identity management product .

When a client application requests access to protected subscriber communication services the services gatekeeper can communicate with a third party authentication server via a custom protocol for authorization authentication. Authorization server includes an authentication interface which includes a configurable authentication endpoint to which the standard authorization request will be redirected. The re usable authentication endpoint can be developed using any customizable flow including for example HTTP interactive as PHP ASP JSP and HTTP Servlet hosted by the services gatekeeper or any server within the same domain as the services gatekeeper and the authorization server as long as it fulfills the interactive specification of the authorization server . The reusable authentication endpoint functions as an authentication interface with the e.g. third party authentication server . Once authorized the third party authentication server can notify the services gatekeeper system which then grants the application access to the requested protected subscriber resources. The third party authentication server need not be co located may be remote from the services gatekeeper may be outside the direct control of the operator of services gatekeeper . Any custom mechanism and or code and or service can be utilized for authorization and authentication.

As shown in after the subscriber initiates a request which requires access to protected resources for example access to premium third party content for which the third party wishes to charge the subscriber the client application initiates the flow in operation when it directs the subscriber agent to the authorization endpoint of authorization server . The authorization endpoint receives and processes requests by client applications for permission to access protected resources for example communication services of . The client application includes its client identifier requested scope local state and a redirection URI. In operation the subscriber agent transmits the request from the client application to the authorization server .

The authentication interface includes a configurable authentication endpoint to which the standard authorization request will be redirected. As indicated above the re usable authentication endpoint can be developed using any customizable flow including for example HTTP interactive as PHP ASP JSP and HTTP Servlet hosted by any server within the same domain as the authorization server as long as it fulfills the interactive specification of the authorization server . The reusable authentication endpoint functions as an authentication interface with the e.g. third party authentication server .

Once subscriber is authenticated and has approved the access request the request is redirected back to the grant endpoint from which normal authorization flow will continue. The authorization server can therefore have different implementation of the authentication endpoint with various authentication authorization mechanisms including normal username password validation SMS authentication and so on. The different user interfaces can be rendered for the subscriber by the appropriate authentication server . The authorization server does not require knowledge of the authentication mechanism UI performed by the authentication server . The authentication authorization request can thus be performed by the authentication server with no coupling with authorization server .

When a request to access the subscriber information of the subscriber is received from a client application at the authorization server the authorization server defines a configurable authentication endpoint as specified in the authentication interface to which the OAuth request will be redirected and transmits in operation the redirect to the subscriber agent . In operation in accordance with the specifications of the authentication interface the subscriber agent transmits a request to the third party authentication server which includes the configurable authentication endpoint. In operations the third party authentication server verifies the credentials and consent of subscriber . Generally the subscriber grants permission by providing a username and password and selecting attributes or services to expose. An authorization code is granted to the client application once permission is obtained from the subscriber .

As shown in in operation the subscriber provides subscriber credentials and consent if the request is approved to the subscriber agent which relays the subscriber credentials and consent to the third party authentication server . In operation the third party authentication server provides subscriber agent an authorization code. In operation the subscriber agent relays the authorization code to the client application . The redirection URI includes an authorization code and any local state previously provided by the client application .

In operation after receiving the authorization code the client application requests an access token from the authorization server through the token endpoint. The client application authenticates with its client credentials and includes the authorization code received in the previous operation . The client application also includes the redirection URI used to obtain the authorization code for verification. The authorization server validates the client credentials and the authorization code. The server also ensures that the redirection URI received matches the URI used to redirect the client. In operation if valid the authorization server responds with an access token . In operation the client application then provides the access token to the resource server which validates the access token . In operation the resource server responds with the requested access to the specified protected resource s for example communication services of .

Although the invention has been described above with respect to communication services in a telecommunications network the invention also finds application in any situation where its is necessary or desirable to interface with one or more remote and or non co located third party authentication servers.

The present invention may be conveniently implemented using one or more conventional general purpose or specialized digital computer computing device machine or microprocessor and or network of same programmed according to the teachings of the present disclosure.

Appropriate software coding can readily be prepared by skilled programmers based on the teachings of the present disclosure as will be apparent to those skilled in the software art. The invention may also be implemented by the preparation of application specific integrated circuits or by interconnecting an appropriate network of conventional component circuits as will be readily apparent to those skilled in the art.

The various embodiments include a computer program product which is a storage medium media having instructions stored thereon in which can be used to program a general purpose or specialized computing processor s device s to perform any of the features presented herein. The storage medium can include but is not limited to one or more of the following any type of physical media including floppy disks optical discs DVDs CD ROMs microdrives magneto optical disks holographic storage ROMs RAMs PRAMS EPROMs EEPROMs DRAMs VRAMs flash memory devices magnetic or optical cards nanosystems including molecular memory ICs paper or paper based media and any type of media or device suitable for storing instructions and or information. The computer program product can be transmitted in whole or in parts and over one or more public and or private networks wherein the transmission includes instructions which can be used by one or more processors to perform any of the features presented herein. The transmission may include a plurality of separate transmissions. In accordance with certain embodiments however the computer storage medium containing the instructions is non transitory i.e. not in the process of being transmitted but rather is persisted on a physical device.

The foregoing description of the preferred embodiments of the present invention has been provided for purposes of illustration and description. It is not intended to be exhaustive or to limit the invention to the precise forms disclosed. Many modifications and variations can be apparent to the practitioner skilled in the art. Embodiments were chosen and described in order to best explain the principles of the invention and its practical application thereby enabling others skilled in the relevant art to understand the invention. It is intended that the scope of the invention be defined by the following claims and their equivalents.

