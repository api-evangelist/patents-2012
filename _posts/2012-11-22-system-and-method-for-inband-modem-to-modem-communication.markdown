---

title: System and method for in-band modem to modem communication
abstract: Systems, methods and programmed instructions are disclosed useful for transmitting signals representing data messages to and from a wireless handheld telephony device along a first call leg of a communication session previously established between the wireless handheld telephony device and at least one second telephony device, the communication session being controlled by a call control server.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08538397&OS=08538397&RS=08538397
owner: BlackBerry Limited
number: 08538397
owner_city: Waterloo, Ontario
owner_country: CA
publication_date: 20121122
---
This application is a continuation of U.S. patent application Ser. No. 13 445 437 filed Apr. 12 2012 which is a continuation of U.S. patent application Ser. No. 12 754 790 filed Apr. 6 2010 and entitled SYSTEM AND METHOD FOR IN BAND MODEM TO MODEM COMMUNICATION now U.S. Pat. No. 8 180 331 all of which are hereby incorporated by reference in its entirety.

The present application relates generally to mobile communication devices and more particularly to systems and methods for in band modem to modem communications during voice communication sessions.

Technology exists for routing communications originating from a wireless handheld telephony device through a server such as an enterprise server. This can be done for example to make it appear as if the communication originated from a user s place of business or to prevent a party receiving the communication from accessing the wireless user s wireless number. Often such communications will use both an audio or voice channel for relaying a voice communication and a data channel for for example sending control information between the server and the wireless handheld telephony device. For example the server may send a control command to the wireless handheld telephony device informing it of an incoming communication. Similarly the wireless handheld telephony device may send a control command to the server requesting that the current communication be put on hold. These control commands may be sent via the a data channel when such a channel is available.

In some situations however a data channel between the wireless handheld telephony device and the server may be permanently or temporarily unavailable. Some current systems use means such as DTMF transmission detection data over SMS USSD etc. for relaying control or other data when a data channel is unavailable. The use of DTMF protocols and devices for non audio signalling however can be slow and creates issues concerning both missing tones and false detection of tones and is generally limited.

In one aspect the present disclosure provides a system for controlling communications between a call control server a wireless handheld telephony device and at least one second telephony device the system comprising a data processor media readable by the data processor and a communications system the communications system adapted to process signals sent between the wireless handheld telephony device the at least one second telephony device and the data processor and the media readable by the data processor comprising coded program instructions adapted to cause the processor to transmit modulated control signals to the wireless handheld telephony device through the audio channel of a leg of a communication session previously established between the wireless handheld telephony device and at least one second telephony device and upon receipt of modulated response signals from the wireless handheld telephony device transmit the modulated response signals to a modem in communication with the call control server.

In another aspect the present disclosure provides a method enabling a system to transmit signals representing data to and from a wireless handheld telephony device through an audio channel of a first call leg of a communication session previously established between the wireless handheld telephony device and at least one second telephony device the communication session being controlled by a call control server the system comprising a data processor media readable by the data processor and a communications subsystem the communications subsystem adapted to process signals representing communications by and between the wireless handheld telephony device the at least one second telephony device the call control server and the processor and the media readable by the data processor comprising coded program instructions the method comprising upon receipt of modulated control signals representing one or more data messages from the call control server transmitting the modulated control signals to the wireless handheld telephony device through the audio channel of the first call leg and upon receipt of modulated response signals representing one or more data messages from the wireless handheld telephony device transmitting the modulated response signals to a modem device in communication with the call control server.

Other aspects of the present disclosure will be apparent to those skilled in the relevant arts from a review of the following detailed description in conjunction with the drawings.

Embodiments of the present application are not limited to any particular operating systems wireless handheld telephony device architectures server architectures or computer programming languages.

Reference is now made to which shows in block diagram form an example of a system generally designated for the control and management of communications suitable for use in implementing systems and methods disclosed herein. System includes an enterprise or business communications system which may include a local area network LAN . In the description below the enterprise or business system may be referred to as an enterprise network . It will be appreciated that the enterprise network may include more than one network and may be located in multiple geographic areas in some embodiments.

The enterprise network may be connected for example through a firewall to a wide area network WAN such as the Internet. The enterprise network may also be connected to a public switched telephone network PSTN via direct inward dialing DID trunks or primary rate interface PRI trunks.

The enterprise network may also communicate with a public land mobile network PLMN which may also be referred to as a wireless wide area network WWAN or in some cases a cellular network. Connection with the PLMN may be made via a relay as known in the art.

The enterprise network may also provide one or more wireless local area networks WLANs featuring wireless access points. Other WLANs may exist outside the enterprise network . For example WLAN may be connected to WAN .

System may include and or interact with a number of enterprise associated mobile devices only one shown . Mobile device s may include devices equipped for cellular communication through the PLMN mobile devices equipped for Wi Fi communications over one of the WLANs and or dual mode devices capable of both cellular and WLAN communications. WLANs may be configured in accordance with one of the IEEE 802.11 specifications.

It will be understood that mobile devices typically include one or more radio transceivers and associated processing hardware and software to enable wireless communications with the PLMN and or one or more WLANs . In various embodiments PLMN and mobile devices may be configured to operate in compliance with any one or more of a number of wireless protocols including GSM GPRS CDMA EDGE UMTS EvDO HSPA 3GPP or a variety of others. It will be appreciated that a mobile device may roam within the PLMN and across PLMNs in for example any of a variety of known manners as the user moves. In some instances the dual mode mobile devices and or the enterprise network are configured to facilitate roaming between the PLMN and a WLAN and are thus capable of seamlessly transferring sessions such as voice calls from a connection with the cellular interface of the dual mode device to the WLAN interface of the dual mode device and vice versa.

Enterprise network typically includes a number of networked servers computers and other devices. For example the enterprise network may connect one or more desktop or laptop computers one shown . The connection may be wired or wireless in some embodiments. The enterprise network may also connect to one or more digital telephone sets one shown .

The enterprise network may include one or more mail servers such as mail server for coordinating the transmission storage and receipt of electronic messages for client devices operating within the enterprise network . Typical mail servers include the Microsoft Exchange Server and the IBM Lotus Domino server. Each user within the enterprise typically has at least one user account within the enterprise network . Associated with each user account is message address information such as an e mail address. Messages addressed to a user message address are stored on the enterprise network in the mail server . The messages may be retrieved by the user using a messaging application such as an e mail client application. The messaging application may be operating on a user s computer connected to the enterprise network within the enterprise. In some embodiments the user may be permitted to access stored messages using a remote computer for example at another location via the WAN using a VPN connection. Using the messaging application the user may also compose and send messages addressed to others within or outside the enterprise network . The messaging application causes the mail server to send a composed message to the addressee often via the WAN .

Relay serves to route messages received over the PLMN from the mobile device to the corresponding enterprise network . Relay also pushes messages from the enterprise network to the mobile device via the PLMN .

In the embodiment shown enterprise network also includes an enterprise server . Together with the relay the enterprise server can function to redirect copy or relay incoming e mail messages addressed to a user s e mail address within the enterprise network to the user s mobile device and to relay incoming e mail messages composed and sent via the mobile device out to the intended recipients within the WAN and or elsewhere. Among other functions enterprise server and relay together can facilitate push e mail service for the mobile device enabling the user to send and receive e mail messages using the mobile device as though the user were connected to an e mail client within the enterprise network using the user s enterprise related e mail address for example on computer .

As is typical in many enterprises an enterprise network can include one or more Private Branch eXchanges although in various embodiments the PBX s may include standard PBX s or IP PBX s for simplicity the description below uses the term PBX to refer to both having a connection with the PSTN for routing incoming and outgoing voice calls to and from digital and or analog telephones or other telephony devices for the enterprise. PBX is connected to the PSTN via DID trunks or PRI trunks for example. The PBX may use ISDN signaling protocols for setting up and tearing down circuit switched connections through the PSTN and related signaling and communications. In some embodiments PBX may be connected to one or more conventional analog telephones . The PBX may also be connected to the enterprise network and through it to telephone terminal devices such as digital telephone sets softphones operating on computers etc. Within the enterprise each individual may have an associated extension number sometimes referred to as a PNP private numbering plan or direct dial phone number. Calls outgoing from the PBX to the PSTN or incoming from the PSTN to the PBX are typically circuit switched calls. Within the enterprise e.g. between the PBX and terminal devices voice calls are often packet switched calls for example Voice over IP VoIP calls.

Enterprise network may include a Service Management Platform SMP for performing aspects of messaging or session control such as call control and advanced call processing features. SMP may in some cases also perform some media handling. Collectively SMP and PBX may be referred to as a enterprise communications platform generally designated . It will be appreciated that an enterprise communications platform and in particular an SMP can be implemented on one or more servers having suitable communications interfaces for connecting to and communicating with the PBX and or DID PRI trunks. Although the SMP may be implemented on a stand alone server it will be appreciated that it may be implemented into an existing control agent server as a logical software component. As will be described below the SMP may be implemented as a multi layer platform.

For devices such as telephony devices controlled by or otherwise associated with it enterprise communications platform can implement switching to connect session legs and may provide conversion between for example a circuit switched call and a VoIP call or connect legs of other media sessions. Such calls sessions may be set up and modified on behalf of devices and any desired telephony devices within or outside enterprise network including for example devices connected to PSTN . In some embodiments in the context of voice calls the enterprise communications platform provides a number of additional functions including automated attendant interactive voice response call forwarding voice mail etc. It may also implement certain usage restrictions on enterprise users such as blocking international calls or 1 900 calls. In many embodiments Session Initiation Protocol SIP may be used to set up manage and terminate media sessions for voice calls. Other protocols may also be employed by the enterprise communications platform for example Web Services Computer Telephony Integration CTI protocol Session Initiation Protocol for Instant Messaging and Presence Leveraging Extensions SIMPLE and various custom Application Programming Interfaces APIs as will be described in greater detail below.

Among capabilities of enterprise communications platform may be the ability to extend the features of enterprise telephony to mobile device s . For example an enterprise communications platform may allow mobile device s to perform functions akin to those normally available on a standard office telephone such as the digital telephone set or analog telephone set . Example features may include direct extension dialing enterprise voice mail conferencing call transfer call park etc. As further described elsewhere herein enterprise communications platform may be configured to provide functions such as transfer of corresponding ends of existing communications sessions from one or more mobile devices to wired telephony devices associated with platform .

Reference is now made to which show example embodiments of the enterprise communications system . Although references are made below to calls or call centric features it will be appreciated that the architectures and systems depicted and described are applicable to session based e.g. voice communications in general and in some instances to text image or other messaging based communications.

In such embodiments an SMP can assume control over both call processing and the media itself. This architecture may be referred to as First Party Call Control . Many of the media handling functions normally implemented by the PBX may be handled by the SMP in this type architecture. Incoming calls addressed to any extension or direct dial number within the enterprise for example may first be routed to the SMP . Thereafter a call leg may be established from the SMP to the called party within the enterprise and the two legs may be bridged. Accordingly the SMP includes a digital trunk interface and a digital signal processing DSP conferencing bridge . The DSP conferencing bridge performs the bridging of calls for implementation of various call features such as conferencing call transfer etc. The digital trunk interface may be implemented as a plurality of telephonic cards e.g. Intel Dialogic cards interconnected by a bus and operating under the control of a processor. The digital trunk interface may also be partly implemented using a processor module such as for example a Host Media Processing HMP processor.

SMP may implement various scripts for managing call processing. The scripts may be implemented as software modules routines functions etc. stored in non volatile memory and executed by the processor of the SMP . Such scripts may implement call flow logic business logic user preferences call service processes and various feature applications.

The call control server is coupled to the PBX for example through the LAN enabling packet based communications and more specifically IP based communications. In one embodiment communications between the PBX and the call control server are carried out in accordance with SIP. In other words the call control server uses SIP based communications to manage the set up tear down and control of media handled by the PBX . In one example embodiment the call control server may employ a communications protocol conforming to the ECMA 269 or ECMA 323 standards for Computer Supported Telecommunications Applications CSTA .

SIP server can interact with media server using SIP based media handling commands. For example the SIP server and media server may communicate using Media Server Markup Language MSML as defined in IETF document Saleem A. Media Server Markup Language Internet Draft draft saleem msml 07 Aug. 7 2008. The media server may be configured to perform Host Media Processing HMP .

It will be appreciated by those skilled in the relevant arts that a wide variety of architectures or configurations for the enterprise communications system are suitable for use in implementing the systems and methods disclosed herein.

Reference is now made to which shows a schematic block diagram of a wireless handheld telephony device suitable for use in conjunction with the system described above in relation to .

In various embodiments wireless handheld telephony device is a two way mobile communication device having at least voice and data communication capabilities including the capability to communicate with other computer systems. Depending on the functionality ies provided by the wireless handheld telephony device it may be referred to as a data messaging device a two way pager a cellular telephone with data messaging capabilities a wireless Internet appliance a data communication device with or without telephony capabilities a clamshell device or a flip phone. The wireless handheld telephony device may communicate with any one of a plurality of fixed transceiver stations within its geographic coverage area.

The wireless handheld telephony device may incorporate a communication subsystem which can include a receiver transmitter and associated components such as one or more antenna elements and local oscillators LOs and one or more processing modules such as a digital signal processor DSP . In various embodiments antenna elements and may be embedded or internal to the wireless handheld telephony device . As will be apparent to those skilled in the relevant arts the particular design of the communication subsystem will depend in part on the system s such as enterprise network the PLMN and or the WLANs with which the wireless handheld telephony device is intended to communicate.

The wireless handheld telephony device may send and receive communication signals to and from for example an enterprise server through for example the PLMN and or one of the WLANs . Signals received by the antenna may be input to the receiver which may perform such common receiver functions as signal amplification frequency down conversion filtering channel selection etc. as well as analog to digital A D conversion. A D conversion of a received signal allows more complex communication functions such as demodulation and decoding to be performed in the DSP . In a similar manner signals to be transmitted are processed including modulation and encoding for example by the DSP . Such DSP processed signals may be input to the transmitter for digital to analog D A conversion frequency up conversion filtering amplification and transmission via the antenna . The DSP not only processes communication signals but also provides for receiver and transmitter control. For example gains applied to communication signals in the receiver and the transmitter may be adaptively controlled through automatic gain control algorithms implemented in or by the DSP .

Network access may be associated with a subscriber or user of the wireless handheld telephony device via a memory module such as a memory module which may include a Subscriber Identity Module SIM card for use in a GSM network or a Universal Subscriber Identity Module USIM card for use in a Universal Mobile Telecommunication System UMTS . Such a SIM card may be inserted in or connected to an interface of the wireless handheld telephony device . Alternatively or in addition the wireless handheld telephony device may have an integrated identity module for use with systems such as Code Division Multiple Access CDMA systems.

The wireless handheld telephony device may also include a battery interface for receiving one or more rechargeable batteries . The battery provides electrical power to at least some of the electrical circuitry in the wireless handheld telephony device and the battery interface provides a mechanical and electrical connection for the battery . The battery interface is coupled to a regulator not shown which provides power V to the circuitry of the wireless handheld telephony device .

Wireless handheld telephony device can include one or more microprocessors for control of the overall operation of the wireless handheld telephony device . for example under control of mircroprocessor s communication functions including at least data and voice communications may performed through the communication subsystem . Microprocessor s may also interact with additional device subsystems such as modem primary display optional secondary display flash memory random access memory RAM read only memory ROM auxiliary input output I O subsystems data port s such as Universal Serial Bus USB port keyboard or keypad speaker or audio port s for connecting to for example a set of headphones or an earpiece microphone clickable thumbwheel or thumbwheel open close sensor short range communications subsystem and any other device subsystem s generally designated as . Some of the subsystems shown in perform communication related functions whereas other subsystems may provide resident or on device functions. Notably some subsystems such as the keypad the primary display the secondary display and the clickable thumbwheel for example may be used for both communication related functions such as displaying notifications or entering a text message for transmission through for example the PLMN and or one of the WLANs and executing device resident functions such as a clock a calculator or a task list. Operating system software used by the microprocessor is preferably stored in a persistent store such as the flash memory which may alternatively be the ROM or similar storage element. Those skilled in the art will appreciate that the operating system specific device applications or parts thereof may be temporarily loaded into a volatile store such as the RAM .

Microprocessor in addition to its operating system functions may enable execution of software applications on the wireless handheld telephony device . A predetermined set of applications that control basic device operations including data and voice communication applications will normally be installed on the wireless handheld telephony device during or after manufacture. The wireless handheld telephony device may include a personal information manager PIM application having the ability to organize and manage data items relating to a user such as but not limited to instant messaging email calendar events voice mails appointments and task items. One or more memory stores may be available on the wireless handheld telephony device to facilitate storage of information such as the flash memory the RAM the ROM the memory module or other types of memory storage devices or FLASH memory cards represented by the other device subsystems such as Secure Digital SD cards or mini SD cards etc.

PIM and or media applications may have the ability to implement sending and receiving of data items via PLMN and or one of the WLANs or via a link to a computer system. Suitable communications links to involved computer systems may be established via a serial port and or a short range communications subsystem . In some embodiments PIM and or media data items are seamlessly combined synchronized and updated for example through the PLMN and or one of the WLANs with the wireless handheld telephony device user s corresponding data items stored and or associated with a host computer system thereby creating a mirrored or partially mirrored host computer on the wireless handheld telephony device with respect to such items. This may be advantageous where for example the host computer system is the wireless handheld telephony device user s office computer system. Additional applications may also be loaded onto the wireless handheld telephony device through for example the PLMN and or one of the WLANs the auxiliary I O subsystem the serial port the short range communications subsystem or any other suitable subsystem and installed by a user in the RAM or a non volatile store such as the ROM for execution by the microprocessor . Such flexibility in application installation increases the functionality of the wireless handheld telephony device and may provide enhanced on device functions communication related functions or both. For example secure communication applications may enable electronic commerce functions and other such financial transactions to be performed using the wireless handheld telephony device .

In a data communication mode a received data signal representing information such as a text message an email message a media file to be transferred or Web page download can be processed by the communication subsystem and input to the microprocessor . The microprocessor can further process the signal for output to the primary display secondary display or alternatively to the auxiliary I O device . A user of the wireless handheld telephony device may also compose data items such as email messages for example using the keypad and or the clickable thumbwheel in conjunction with the primary display and possibly the auxiliary I O device . The keypad maybe either a complete alphanumeric keypad or telephone type keypad. These composed items may be transmitted through the communication subsystem or via the short range communication subsystem .

For voice communications the overall operation of the wireless handheld telephony device is similar except that the received signals may be output to the speaker or audio port and signals for transmission can be generated by a transducer such as the microphone . Alternative voice or audio I O subsystems such as a voice message recording subsystem may also be implemented on the wireless handheld telephony device . Although voice or audio signal output is typically accomplished primarily through the speaker or audio port the primary display or the secondary display may also be used to provide an indication of the identity of a calling party or the communication type duration of a voice call or other voice call related information. Stereo headphones or an earpiece may also be used in place of the speaker .

USB port is normally implemented in a personal digital assistant PDA type communication device for which synchronization with a user s computer is a desirable albeit optional component. USB port can enable a user to set preferences through an external device or software application and can extend the capabilities of the wireless handheld telephony device by providing for information or software downloads to the wireless handheld telephony device other than through the PLMN and or one of the WLANs . The alternate download path may for example be used to load software or data files onto the wireless handheld telephony device through a direct reliable and trusted connection.

Short range communications subsystem is an additional optional component which can provide for communication between the wireless handheld telephony device and different systems or devices which need not necessarily be similar devices. For example the subsystem may include an infrared device and associated circuits and components or a wireless bus protocol compliant communication mechanism such as a Bluetooth communication module to provide for communication with similarly enabled systems and devices Bluetooth is a registered trademark of Bluetooth SIG Inc. . In further embodiments the short range communications subsystem may include a wireless networking communications subsystem conforming for example to IEEE 802.11 standards such as one or more of 802.11b 802.11g and or 802.11n.

Modem device may for example comprise a low bandwidth modem which can modulate and demodulate data signals to be transmitted over a voice channel. For example the modem could be a high speed low bandwidth modem such as for example the 3GPP modem TS 26.267 or TS 26.268 . The modem may also comprise a coder decoder also referred to as a codec .

Reference is now made to which shows in schematic block diagram form an example of a system suitable for transmitting data to a wireless handheld telephony device in accordance with this disclosure. In the example shown system comprises or is configured to operate in conjunction with a wireless handheld telephony device which may for example be engaged in an ongoing or otherwise previously established communication session with one or more second telephony device s through a gateway . Second telephony device s may include telephony device s such as for example digital telephony device s analogue telephony device s and or other wireless handheld telephony device s . Second telephony device s may include any telephony device s wireline or wireless suitable for use in cojunction with the systems and methods disclosed herein.

Gateway facilitates communication between the wireless handheld telephony device and one or more second telephony device s . Gateway may include or comprise component s such as for example a PBX as well as a communication network such as PSTM or PLMN of . Gateway may for example be incorporated as a part of an enterprise system or may be hosted by a wireline or wireless carrier.

A communication session between the wireless handheld telephony device and the second telephony device s may include two call legs a first call leg between the wireless handheld telephony device and the gateway and a second call leg between the gateway and each of second telephony device s . Each call leg may comprise at least an audio stream to and from the gateway and optionally one or more control signal streams. The gateway may anchor each call leg at a location that is controllable by the call control server and may transfer or otherwise direct voice and other data signals from one call leg to another call leg. This may be performed for example using Session Description Protocol SDP RFC 2327 Shuffling.

In some embodiments a call control server may be employed to facilitate and control the communication session between the two call legs. For example when an internal call is made from a corporate desk phone illustrated here as second telephony device to an employee s cellular phone the corporate desk phone may dial only the internal extension of the cell phone user. The call control server may convert the internal number to an external cellular phone number or use outside an enterprise environment.

A call control server may manipulate call legs via a media path manager . For example the media path manager may be used to request that pairs or other sets of call legs be joined together in order to connect an end to end call. Call control server and media path manager may for example form part of an SMP of . Functions of a call control server may be provided by for example various components of an enterprise communications platform shown in and described above.

For many cellular technologies such as CDMA 1x EVDO GSM GPRS EDGE etc. once a voice communication is established maintenance of a data channel between the call control server and the wireless handheld telephony device is commonly discontinued. Without a data channel messages such as control messages to be transmitted to and from a wireless handheld telephony device such as for example in call feature execution instructions e.g. hold dial new number for conference call waiting etc. must be transmitted by some other means such as via an audio channel in use for transmission of call content signals. The system may use a modem device to provide communication between the call control server and the wireless handheld telephony device using the audio channel. The use of a modem to send data via an audio channel may introduce noise to the ongoing communication for short periods of time e.g. tenths of a second . In contrast it can take three to four seconds to pass a ten digit number using DTMF tones.

A media server may connect a modem device to a gateway by for example constructing a third call leg. In some embodiments the modem device may be implemented as a function on the media server .

A modem device can comprise a modem such as a low bandwidth duplex modem and optionally a coder decoder also referred to as a codec . Codec may for example comprise an encoder for encoding an outgoing signal into a format that is acceptable for processing by for example media server such as for example AMR G.711 G.729 G.722 etc. and a decoder for decoding incoming signals.

The modem may comprise a modulator and a demodulator . Modem may be a high speed e.g. 400 B s low bandwidth voice modem which may be designed to provide reliable delivery on compressed voice wireless audio channels. In some embodiments a modem may use two different clocks an uplink clock for the uplink data path and a downlink clock for the downlink data path which may help ensure that signalling in both directions can occur simultaneously. For example the clocks may be used to ensure that the modulation is performed at different frequencies for the uplink and downlink thus providing duplex communications.

Modulated signals transmitted from the wireless handheld telephony device along the first call leg may be received by gateway and passed to modem device through the media server . Such modulated signals may then be decoded by the decoder of the codec passed through the demodulator of the modem and delivered to the call control server . Similarly signals transmitted from the call control server may be passed through the modulator of the modem encoded by the encoder of the codec passed to the media server and transmitted to the wireless handheld telephony device by the gateway along the first call leg. Data messages are sent when a path is available for example when where the first call leg is appropriately connected to the modem device . On the downlink that is the path from the call control server to the wireless handheld telephony device to ensure data messages are sent when a path is available the media path manager may operate a gate that is open when the path is available. In some embodiments if a message to be sent from the wireless handheld telephony device is in response to a message from the call control server e.g. a synchronous command a path may be available. Alternatively or where a command from the wireless handheld telephony device is asynchronous e.g. not sent in response to a command from the call control server a request such as a DTMF coded instruction signal may be sent by the wireless handheld telephony device before a data message is sent as explained below.

A modem device of the wireless handheld telephony device e.g. see may comprise a similar codec and modem thus allowing the decoding demodulation of control messages to the wireless handheld telephony device and the encoding modulation of response messages from the wireless handheld telephony device .

Among other services a media server may provide conferencing capabilities. In some embodiments for example a conference bridge may be established for each communication between a wireless handheld telephony device and a second telephony device such that a third call leg is established between the gateway and the modem device . In such embodiments data messages may be sent and received between the call control server and the wireless handheld telephony device through the modem device at any time.

In other embodiments a conference bridge may be established by the media server when data is to be transmitted between the wireless handheld telephony device and the call control server . In such embodiments if a message is to be transmitted from the call control server to the wireless handheld telephony device the media path manager may send a request to the media server to establish a conference bridge. Once the message has been transmitted through the modem device the media server may disable the conference bridge. If a message is to be transmitted from the wireless handheld telephony device to the call control server an instruction signal such as one or more suitably configured DTMF tone s may be sent from the wireless handheld telephony device . This signal may for example indicate to the media server that a conference bridge is requested. Once a conference bridge has been established the wireless handheld telephony device may transmit any desired modulated signals representing messages to be transmitted to the call control server via the modem device . Once such modulated signals have been sent the media server may disable the conference bridge.

In further embodiments data may be transmitted by temporarily swapping communications to a third call leg. In such embodiments when a data message is to be transmitted between the wireless handheld telephony device and the call control server the second call leg between the gateway and the second telephony device may be temporarily disconnected or otherwise suspended by the gateway and a third call leg between the gateway and the modem device may be temporarily established. Once the data has been transmitted the third call leg may be disconnected and the second call leg between the wireless handheld telephony device and the second telephony device may be re established. This may require a break in the communication between the wireless handheld telephony device and the second telephony device of for example a few hundred milliseconds. As no conferencing is required in such embodiments the media server may not be required.

Reference is next made to which shows a flow diagram representing an example of a method for transmitting data from a processor such as a call control server to a wireless handheld telephony device engaged in an ongoing communication session with a second telephony device . Embodiments of method are suitable for use for example in conjunction with systems of and or and wireless handheld telephony device s of in implementing aspects of the disclosure herein.

A method can be considered to begin at block where a call control server has a message in the form of signals representing data to be transmitted to a wireless handheld telephony device while the wireless handheld telephony device is engaged in an ongoing communication with a second telephony device for example through a gateway . For example the call control server may wish to send a message to the wireless handheld telephony device when a second incoming call for the wireless handheld telephony device is received. In some situations no data connection exists between the call control server and the wireless handheld telephony device . As explained herein the data may instead be sent in band via the audio channel using modulated data signals.

At it may be determined whether or not a path is available between the modem device and the gateway .

If a path is available at the method proceeds to where the data is modulated. As explained above there are a number of different ways in which the transmission of data between the call control server and the wireless handheld telephony device may be facilitated. For example in some embodiments a conference bridge may be established by for example a media server for each communication involving the wireless handheld telephony device . In other words a third call leg may be established to the modem device from the gateway . In such embodiments a path will be available at and the method continues from block to block . In other embodiments a path will always be available at and the method always always continues from block to block .

If however a path is determined not to be available at at a suitable path is established. For example in some embodiments a temporary conference bridge may be established by for example a media server when a message is to be sent between the call control server and the wireless handheld telephony device . In such embodiments a path may not be available at and may need to be established at . Where the message originates from the call control server the call control server may notify the media path manager to send a request to the media server to establish a conference bridge. Once the conference bridge is established creating a path between the modem device and the gateway the media server may send a notification back to the media path manager that the path is available.

In other embodiments a path may be established between the modem device and the wireless handheld telephony device by creating a temporary call leg between the modem device and the gateway and temporarily disconnecting or otherwise suspending the second call leg from the gateway to the second telephony device . In such embodiments a path may not be available at and may need to be established at . Where the message originates from the call control server the call control server may notify the media path manager to send a request to media server through the gateway to establish the third call leg. Once the third call leg is established to the modem device and the second call leg to the second telephony device is temporarily suspended the gateway may send a notification to the media path manager that the path is available.

Once a path is established at a gate may be opened by the media path manager at allowing data to flow from the call control server to the modem . Once the gate has been opened at the method proceeds to block .

At data from the call control manager may be modulated by a modem into signals which may be transmitted via an audio stream. At the modulated data may be encoded by an encoder into an appropriate format such as for example AMR G.711 G.729 G.722 etc. .

At modulated encoded data may be sent to the gateway to be transmitted to the wireless handheld telephony device through the voice connection between the gateway and the wireless handheld telephony device . The data may then by decoded if necessary and demodulated by a modem device associated with the wireless handheld telephony device at .

In some embodiments a path between modem device and gateway may need to be closed at once data has been sent to the wireless handheld telephony device . For example where a temporary conference bridge has been established in order to facilitate the communication this conference bridge may be disabled by for example the media server once the message has reached the gateway . In other embodiments where a temporary call leg has been established to the modem device as explained above the temporary call leg may be disabled and the second call leg to the second telephony device may be re established at . In either case at the gate may be closed in order to prevent data from being sent from the call control server until a new path is established. In some embodiments where a response is expected from the wireless handheld telephony device the path may remain open until the response is received.

Reference is next made to which shows a flow diagram representing an example of a method for transmitting data from a wireless handheld telephony device to a call control server where the wireless handheld telephony device is engaged in an ongoing communication with a second telephony device . Method is suitable for use for example in conjunction with systems of and or and wireless handheld telephony device of in implementing the disclosure herein.

A method can be considered to begin at block where a wireless handheld telephony device has a message in the form of signals representing data to be transmitted to a call control server and the wireless handheld telephony device is engaged in an ongoing communication with a second telephony device through a gateway . For example where the wireless handheld telephony device has been informed that a second incoming communication is pending the wireless handheld telephony device may wish to send a suitably configured instruction signal to the call control server as to whether the second incoming communication should be accepted or rejected. As explained above in some situations no data connection exists between the call control server and the wireless handheld telephony device . As explained herein data may instead be sent in band via the audio channel using modulated data signals.

At it is determined whether or not a path is available between the modem device and the wireless handheld telephony device .

If a path is available at the method proceeds to where the data is modulated encoded. Again as explained above there are a number of different ways in which the transmission of data between the call control server and the wireless handheld telephony device may be facilitated. For example in some embodiments a conference bridge may be established by for example a media server for each communication involving the wireless handheld telephony device . In other words a third call leg may be established to the modem device from the gateway . In such embodiments a path will always be available at and the method always continues from block to block .

A path may also be available at in other situations such as when the media server leaves the path open in anticipation of a response from the wireless handheld telephony device .

If however a path is determined not to be available at the method proceeds to block where a path is established. For example in some embodiments a temporary conference bridge may be established by for example a media server when a message is to be sent between the call control server and the wireless handheld telephony device . In such embodiments a path may not be available at and may need to be established at . Where the message originates from the wireless handheld telephony device the wireless handheld telephony device may need to notify the media server that a message is forthcoming. This may be done for example by sending an initiating signal to the gateway which may in turn notify the media server that a conference bridge is required. The initiating signal may for example be in the form of a tone such as a DTMF tone. Once the conference bridge is established creating a path between the modem device and the gateway the media server may send a notification back to the gateway which may in turn notify the wireless handheld telephony device that a path is available.

In further embodiments a path may be established between the modem device and the gateway by creating a temporary call leg between the modem device and the gateway and temporarily suspending or holding the call leg from the gateway to the second telephony device . In such embodiments a path may not be available at and may need to be established at . Where the message originates from the wireless handheld telephony device the wireless handheld telephony device may send a signal to the media server through the gateway to establish the third call leg. The signal may for example be in the form of a tone such as a DTMF tone. Once the third call leg is established to the modem device and the second call leg to the second telephony device is temporarily suspended the gateway may send a notification back to the wireless handheld telephony device that the path is available.

At the message data may be modulated and or encoded into signals which may be transmitted via an audio stream by a modem device associated with the wireless handheld telephony device .

At the modulated encoded signals may be sent to the gateway through the first call leg between the gateway and the wireless handheld telephony device . At the modulated encoded signals may be sent to the modem device . The data may be decoded if necessary by codec and demodulated by the demodulator . At the data message may be received by the call control server .

In some embodiments a path between the modem device and the gateway may need to be closed or disabled at once signals have been sent to the modem device . For example where a temporary conference bridge has been established in order to facilitate the transmittance this conference bridge may be disabled by for example the media server . In other embodiments where a temporary call leg has been established to the modem device as explained above the temporary call leg may be disabled and the second call leg to the second telephony device may be re established or unsuspended at .

While the steps of methods and are shown as occurring in a particular order it will be appreciated by those skilled in the relevant arts that many of the process steps and portions thereof are interchangeable and may occur in different orders that that shown without materially affecting the end results of the methods and . It will further be appreciated by such persons that not all of such steps are required in order to accomplish the purposes disclosed herein and that further steps may be optionally implemented.

While the disclosure has been provided in connection with specific presently preferred embodiments many variations and modifications may be made without departing from the spirit and scope of the invention. The disclosure is therefore not to be limited to the exact components or details of methodology or construction set forth above. Except to the extent necessary or inherent in the processes themselves no particular order to steps or stages of methods or processes described in this disclosure including the Figures is intended or implied. In many cases the order of process steps may be varied without changing the purpose effect or import of the methods described. The scope of the claims is to be defined solely by the appended claims giving due consideration to the doctrine of equivalents and related doctrines.

