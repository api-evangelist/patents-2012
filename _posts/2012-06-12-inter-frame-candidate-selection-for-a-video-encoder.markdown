---

title: Inter frame candidate selection for a video encoder
abstract: This disclosure relates to selecting an inter frame candidate for encoding. In particular, one or more previous motion vectors for a current block and a zero valued motion vector are selected. At least one of the one or more previously determined motion vectors is generated for a neighboring block in a current frame. Additionally, an estimated motion vector is determined based at least in part on a sum of absolute difference (SAD) calculation and a penalty value. A cost value for each of the one or more previous motion vectors, the zero valued motion vector and the estimated motion vector are calculated based at least in part on a sum of squared differences (SSD) calculation. Accordingly, a motion vector with a lowest cost value is selected from the one or more previous motion vectors, the zero motion vector and the estimated motion vector as an inter frame candidate for encoding.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09172970&OS=09172970&RS=09172970
owner: GOOGLE INC.
number: 09172970
owner_city: Mountain View
owner_country: US
publication_date: 20120612
---
This application claims priority to U.S. Provisional Patent Application No. 61 652 821 filed on May 29 2012 and entitled INTER FRAME CANDIDATE SELECTION FOR A VIDEO ENCODER . The entirety of the above referenced provisional application is incorporated herein by reference.

This disclosure relates generally to video processing and more specifically to selecting an inter frame candidate for encoding.

The amount of data representing media information for example a still image or a video image can be extremely large. Further transmitting digital video information over communication networks can consume large amounts of bandwidth. The cost of transmitting data from one location to another is a function of bit rate e.g. the number of bits transmitted per second. Typically higher bit transfer rates are associated with increased cost. Higher bit rates can also progressively increase the required storage capacities of memory systems thereby increasing storage cost. Thus for a given desired quality level it can be more cost effective to use fewer bits than more bits to store digital images and videos. It is thus desirable to compress media data for recording transmitting or storing.

In a typical compression scheme achieving higher media quality requires usage of more bits which can increase the cost of transmission and storage. In other words while lower bandwidth traffic is desired so is higher quality media. Regarding compression the devices encoder decoder and codec are typically associated with compression. An encoder is a device capable of encoding e.g. coding and sometimes decoding digital media data. A decoder is a device capable of decoding digital media data. A codec is a device capable of coding and or decoding digital media data. The term codec is derived from a combination of the terms code and decode or the terms compress and decompress. A variety of codecs are commercially available. Generally speaking for example codec classifications include discrete cosine transfer codecs fractal codecs and wavelet codecs. An encoder or codec by encoding the digital media data can reduce the number of bits required to transmit signals thereby reducing associated transmission costs.

The encoding process typically involves using motion estimation to facilitate encoding of digital media data. In most cases consecutive video frames in a sequence of video frames are relatively similar to each other except for small movements of location s of object s within a frame from one video frame to the next video frame. Motion estimation techniques take advantage of similarities between consecutive video frames to more efficiently encode a video frame. For instance an encoder employing a motion estimation technique can use a previous video frame as a reference when encoding a current video frame. The encoder generates motion vectors for the current video frame based on its differences from the previous video frame. The encoder identifies differences between the reference video frame and current video frame and only codes the portions of the current video frame that are different from the reference video frame without coding the portions of the current video frame that are unchanged from the reference video frame. Selectively coding only the portions that are different makes the encoding and decoding processes more efficient. However motion estimation is one of the most computing intensive parts of the video encoding process. The better the motion vector the more the bit rate can be reduced and the more the visual quality can be improved.

The following presents a simplified summary of the specification in order to provide a basic understanding of some aspects of the specification. This summary is not an extensive overview of the specification. It is intended to neither identify key or critical elements of the specification nor delineate any scope of the particular implementations of the specification or any scope of the claims. Its sole purpose is to present some concepts of the specification in a simplified form as a prelude to the more detailed description that is presented later.

In accordance with an implementation a system includes a first predictor component a second predictor component a processing component and a selector component. The first predictor component selects one or more previous motion vectors for a current block by using at least one previously determined motion vector for a neighboring block in a current frame and selects a zero valued motion vector. The second predictor component selects an estimated motion vector determined based at least in part on a sum of absolute difference SAD calculation and a penalty value. The processing component calculates a cost value for each of the one or more previous motion vectors the zero valued motion vector and the estimated motion vector based at least in part on a sum of squared differences SSD calculation. The selector component selects a motion vector with a lowest calculated cost value from the one or more previous motion vectors the zero motion vector and the estimated motion vector as an inter frame candidate.

The following description and the annexed drawings set forth certain illustrative aspects of the specification. These aspects are indicative however of but a few of the various ways in which the principles of the specification may be employed. Other advantages and novel features of the specification will become apparent from the following detailed description of the specification when considered in conjunction with the drawings.

Various aspects of this disclosure are now described with reference to the drawings wherein like reference numerals are used to refer to like elements throughout. In the following description for purposes of explanation numerous specific details are set forth in order to provide a thorough understanding of one or more aspects. It should be understood however that certain aspects of this disclosure may be practiced without these specific details or with other methods components materials etc. In other instances well known structures and devices are shown in block diagram form to facilitate describing one or more aspects.

The amount of data representing media information can be extremely large. Further transmitting digital video information over communication networks can consume large amounts of bandwidth. The cost of transmitting data from one location to another can be a function of number of bits transmitted per second. Typically higher bit transfer rates are associated with increased cost. Higher bit rates also can progressively add to required storage capacities of memory systems which can thereby increase storage cost. Thus at a given quality level it can be more cost effective to use fewer bits as opposed to more bits to store digital images and videos. It therefore can be desirable to compress media data for recording transmitting or storing.

Motion estimation is often used to facilitate encoding digital media data e.g. video content . During the motion estimation process motion vectors for a current raw video frame of a video frame sequence can be generated based on a reference video frame which is typically a prior video frame in the sequence. Identifying the best motion vector can be useful to reduce bit rate and improve video quality. A best motion vector e.g. a best candidate a best motion vector mode can be for example a motion vector e.g. a candidate a motion vector mode that can produce the lowest bit rate for coding blocks of a video frame and or provide the lowest rate distortion RD cost.

Typically there can be a number of factors involved in identifying the best motion vector. For example residual data and or the motion vector itself e.g. motion vector difference can be factors used to facilitate identifying the best motion vector. Generally the smaller residual data is the lower the bit rate and the smaller the motion estimation difference is the lower the bit rate. For residual data the bit rate can be calculated for example by using a mean square type algorithm or other desired algorithm. In some instances the best motion vector can be selected as the motion vector having the smallest residual data. In certain other instances the best motion vector can be selected as the motion vector having for example the smallest motion estimation difference.

However conventional encoders may inefficiently encode motion vectors and or may not encode the best motion vector for a current raw video frame. As a result conventional encoding techniques may use an undesirable number of bits e.g. may use more bits than necessary to encode a block which can undesirably increase the costs of transmission and storage of the video. Further video quality may be undesirably e.g. negatively affected.

To that end techniques for efficient encoding and decoding of video content are presented. Systems and methods disclosed herein relate to selecting an inter frame candidate e.g. a motion vector for a macroblock a motion vector mode a prediction mode . The selection of an inter frame candidate is moved outside the motion estimation process e.g. selection of an inter frame candidate is based on criteria that is different from criteria of the motion estimation process . For example the selection of the inter frame candidate can be based on cost. Cost can be based at least in part on distortion measured by sum of square differences SSD e.g. squared error per pixel and rate measured by approximating the number of bits included in a bitstream e.g. the number of bits generated into a control partition of the bitstream . All inter frame candidates can be processed in parallel and the best inter frame candidate e.g. the inter frame candidate with the lowest cost value can be selected for encoding. Therefore the best inter frame candidate can be selected after the motion estimation process is completed in an encoding pipeline. Accordingly the amount of encoded media data can be reduced and or compression efficiency of a video sequence can be increased.

Referring initially to there is illustrated an example system that can determine a best inter frame candidate for encoding according to an aspect of this disclosure. The inter frame candidate can be a motion vector for a single macroblock. For example the system can calculate distortion for multiple motion vectors e.g. multiple motion vector modes in parallel. The distortion can be calculated using SSD calculation between prediction data and input data. Specifically the system can provide an encoder with a first predictor feature e.g. first predictor component a second predictor feature e.g. second predictor component a processing feature e.g. processing component and a selector feature e.g. selector component . The first predictor feature can select one or more previous motion vectors for a current block. The one or more previous motion vectors can include for example a previously determined motion vector from a neighboring block in the current frame and or a zero valued motion vector that predicts the current block from a corresponding block in a prediction frame. The second predictor feature can select an estimated motion vector for example based at least in part on a sum of absolute difference SAD calculation and or a penalty value. The processing feature can calculate a cost value e.g. a distortion value and or a rate value for each of the one or more previous motion vectors the zero valued motion vector and or the estimated motion vector based at least in part on a SSD calculation. The selector feature can select a motion vector with a lowest calculated cost value from the one or more previous motion vectors the zero valued motion vector and or the estimated motion vector as an inter frame candidate. Accordingly improved compression efficiency can be achieved. The system can be employed by various systems such as but not limited to image and video capturing systems media player systems televisions mobile phones tablets personal data assistants gaming systems computing devices and the like. In one example the system is implemented on an application specific integrated chip ASIC . In another example the system is implemented on a system on a chip SOC . In yet another example the system can be implemented in specialized hardware e.g. a specialized processor a hardware accelerator an application processor etc. that is separate from a central processing unit CPU .

In particular the system can include an encoder component . In the encoder component includes the first predictor component the second predictor component the processing component and the selector component . The encoder component can receive one or more image frames e.g. RAW DATA indicated in . In one example the one or more image frames can be an input video signal represented as a series of video frames.

The first predictor component can generate and or select one or more previous motion vectors e.g. previously determined motion vectors for a current block. The one or more previous motion vectors can include a previously determined motion vector from a neighboring block in the current frame. For example the one or more previous motion vectors can include a nearest motion vector and or a near motion vector e.g. different motion vector modes . The nearest motion vector e.g. the nearest candidate can be a last non zero motion vector from a neighboring macroblock. The near motion vector e.g. the near candidate can be a second to last non zero motion vector from a neighboring macroblock. Therefore the one or more previous motion vectors can be different previously determined motion vectors from a neighboring macroblock in the current frame. Additionally the one or more previous motion vectors can include a zero valued motion vector. The zero valued motion vector can predict the current block from a corresponding block in a prediction frame e.g. the value of the zero valued motion vector is zero . The one or more previous motion vectors can be determined using motion vector encoding. In one example the one or more previous motion vectors can be implemented as 16 16 motion vectors e.g. 16 16 candidates . The nearest motion vector the near motion vector and the zero valued motion vector can each represent a unique motion vector encoding mode e.g. motion vector mode .

The second predictor component can generate and or select an estimated motion vector e.g. a motion estimation result vector . The estimated motion vector can be determined based at least in part on a sum of absolute difference SAD calculation and or a penalty value. The penalty value can be based on motion vector length. The estimated motion vector can be determined using motion estimation e.g. the estimated motion vector can represent a motion vector mode . For example the estimated motion vector can be a differential motion vector. The estimated motion vector can be generated using a new motion estimation mode e.g. different than motion vector modes generated and or selected by the first predictor component or a split block motion estimation mode e.g. a motion estimation mode with subpartitions . The estimated motion vector can be selected from one or more motion vectors e.g. motion estimated motion vectors . Therefore the estimated motion vector can be a best motion vector e.g. the motion vector with the lowest SAD cost from the one or more motion vectors. It is to be appreciated that more than one estimated motion vector can be generated and or selected. For example the best three estimated motion vectors e.g. the three estimated motion vectors with a lowest SAD value can be generated and or selected.

The processing component can calculate a distortion value for each of the one or more previous motion vectors the zero valued motion vector and or the estimated motion vector. The distortion value can be calculated based at least in part on a SSD calculation. For example the SSD can be calculated between inter prediction and input data. The distortion e.g. the SSD computation can be calculated without chrominance data e.g. only luminance data can be used to calculate the distortion . The distortion value for each of the one or more previous motion vectors the zero valued motion vector and the estimated motion vector can be calculated in parallel. The processing component can also calculate and or determine a rate value for each of the one or more previous motion vectors the zero valued motion vector and or the estimated motion vector. Each of the rate values can be fetched e.g. read from one or more rate lookup tables. For example a lambda rate value can be read from a control component to be described in more detail in . The rate values can be utilized by the processing component without additional processing e.g. the rate values can be calculated by the control component . Additionally the processing component can calculate a cost value for each of the one or more previous motion vectors the zero valued motion vector and or the estimated motion vector. The cost value can be calculated based at least in part on the calculated distortion and or the determined rate.

The selector component can select a motion vector with a lowest calculated cost value e.g. a best motion vector from the one or more previous motion vectors the zero valued motion vector and or the estimated motion vector as an inter frame candidate. Therefore the best motion vector e.g. the best candidate can be provided to a next stage in an encoding process e.g. intra inter frame candidate selection . As such a best motion vector mode e.g. a motion vector mode with the lowest rate distortion cost can be determined.

Using this process the encoder component can select or be configured to select an inter frame candidate for one or more encoded blocks and or image frames e.g. ENCODED DATA indicated in .

While depicts separate components in system it is to be appreciated that the components may be implemented in a common component. For example the first predictor component the second predictor component the processing component and or the selector component can be included in a single component. Further it can be appreciated that the design of system can include other component selections component placements etc. to implement inter frame candidate selection. In one example the first predictor component the second predictor component the processing component and the selector component can be implemented on an ASIC chipset. In another example the first predictor component the second predictor component the processing component and the selector component can be implemented on a SOC. The first predictor component the second predictor component the processing component and the selector component can be implemented as hardware and or software. In one example the first predictor component the second predictor component the processing component and or the selector component can be implemented as machine executable component s embodied within machine s e.g. embodied in one or more computer readable mediums or media associated with one or more machines. Such component s when executed by the one or more machines e.g. computer s computing device s etc. can cause the machine s to perform the operations described herein.

Referring to there is illustrated a system according to an aspect of the subject disclosure. The system includes the encoder component . The encoder component includes the first predictor component the second predictor component the processing component and the selector component . The first predictor component includes a nearest motion vector component a near motion vector component and a zero motion vector component .

The nearest motion vector component can generate and or select a nearest motion vector e.g. a nearest candidate from a neighboring macroblock. For example the nearest motion vector can be the last non zero motion vector generated by a neighboring macroblock. The nearest motion vector can be generated and or selected by a motion vector encoding process. In one example the nearest motion vector can be a 16 16 motion vector.

The near motion vector component can generate and or select a near motion vector e.g. a near candidate from a neighboring macroblock. For example the near motion vector can be the second to last non zero motion vector generated by the neighboring macroblock. The near motion vector can be generated and or selected by a motion vector encoding process. In one example the near motion vector can be a 16 16 motion vector.

The zero motion vector component can generate and or select a zero valued motion vector e.g. a motion vector that is zero . The zero valued motion vector can point to a corresponding block in a prediction frame. The zero motion vector can be generated and or selected by a motion vector encoding process. In one example the zero motion vector can be a 16 16 motion vector.

The first predictor component can generate and or select the nearest motion vector the near motion vector and the zero motion vector e.g. unique motion vector modes . In one example the nearest motion vector the near motion vector and the zero motion vector can be implemented as special motion vectors.

Referring to there is illustrated a system according to an aspect of the subject disclosure. The system includes the encoder component . The encoder component includes the first predictor component the second predictor component the processing component and the selector component . The first predictor component includes the nearest motion vector component the near motion vector component and the zero motion vector component . The second predictor component includes a block motion vector component and a split motion vector component . The block motion vector component can generate and or select a block motion vector. Additionally the split motion vector component can generate and or select a split motion vector. The second predictor component can select the block motion vector component or the split motion vector component to implement motion estimation.

The first predictor component can include one or more context values. The context values can be dependent on coding modes and or motion vectors of neighboring macroblocks. The context values can be used to calculate rate estimations for a particular motion vector mode e.g. nearest motion vector near motion vector zero valued motion vector and or estimated motion vector . Rate for a particular motion vector mode can be based on the context values. As such rate e.g. a cost value can be based on the approximated number of bits generated by each motion vector mode.

The block motion vector component can implement motion estimation to find a best motion vector e.g. the block motion vector component can implement a new motion vector mode . For example the block motion vector component can implement motion estimation to find a 16 16 motion vector. The motion estimation process implemented by the block motion vector component can be based on SAD and or penalty values e.g. values based on motion vector length .

The split motion vector component can implement a split motion vector coding mode e.g. a split motion vector mode for motion estimation . For example one or more 4 4 subblocks in a 16 16 macroblock can include a unique motion vector e.g. a 4 4 motion vector . Rate can be calculated based on a partitioning mode and or sub motion vector modes of individual partitions e.g. individual subblocks . The split motion vector component can include or access one or more rate lookup tables e.g. rate constant tables . A rate lookup table can be implemented for split motion vector partitioning. Additionally a rate lookup table can be implemented for subpartition motion vector reference rates. The rate lookup tables can include one or more constant values e.g. one or more rate values . The one or more rate values can be relative bit costs based on fixed probabilities. The split motion vector partitioning lookup table can include different rates for different partitioning modes. For example a 4 4 partitioning mode an 8 8 partitioning mode a 16 8 partitioning mode and an 8 16 partitioning mode can each include a unique rate value.

The subpartition motion vector mode rates can be estimated using per subpartition context. Therefore the subpartition motion vector lookup table can include different rate values based on context for each subpartition motion vector mode. For example one or more subpartition motion vector modes can be implemented with different rate values for different context values. Alternatively the rates for each subpartition motion vector mode can be estimated using weighted averages e.g. without context values .

The second predictor component can select either the block motion vector or the split motion vector as the estimated motion vector based on for example SAD and or penalty values e.g. values based on motion vector length . Furthermore the selector component can select a motion vector with a lowest cost value e.g. determined by the processing component from the nearest motion vector the near motion vector the zero valued motion vector and or the estimated motion vector e.g. the block motion vector or the split motion vector as an inter frame candidate.

Referring to there is illustrated an encoder system according to an aspect of the subject disclosure. The encoder system includes an encoder component and a control component . The encoder component includes the first predictor component the second predictor component the processing component and the selector component . In one example the encoder component can be implemented as a hardware component. The control component includes a first reference frame rate table a second reference frame rate table and a rate multiplier . In one example the control component can be implemented as a control software component e.g. a control partition . In another example the control component can be implemented as a controller e.g. a microcontroller . In yet another example the control component can be implemented in a general purpose processor. The control component can generate one or more inputs e.g. rate for a first reference frame and or rate for a second reference frame for the encoder component . For example the control component can provide one or more inputs via a software hardware interface.

The first reference frame rate table and or the second reference frame rate table can include e.g. store one or more rate values. Values from the first reference frame rate table and or the second reference frame rate table can be presented to the encoder component in a frame header. The rate values from the first reference frame rate table and or the second reference frame rate table can include rate values for inter coded macroblocks. For example the first reference frame rate table can include rate values for a last inter predicted frame. The second reference frame rate table can include rate values for an arbitrary reference frame. Accordingly the encoder component can use the rate values to calculate cost for an intra inter frame candidate decision.

The rate multiplier can provide a rate multiplier for the encoder component . For example the rate multiplier can provide a lambda multiplier. The lambda multiplier can be implemented to calculate cost for the one or more previous motion vectors the zero valued motion vector and or the estimated motion vector e.g. for each motion vector mode .

The processing component can calculate rate and or distortion for each of the candidates e.g. each motion vector candidate . Rate generated by encoding differential motion vectors can be approximated per component e.g. per horizontal component and vertical component . For example rate per component Rc can be calculated using the following equation Rc 512 64 where is the motion vector component in pixel resolution.

Rate for a motion vector can be calculated by combining horizontal and vertical components. For example rate for a motion vector Rmv can be calculated using the following equation 

Rmv 1024 64 ABS hor ABS ver where hor is the horizontal component and ver is the vertical component in pixel resolution.

Additionally the processing component can calculate a cost value for each candidate e.g. nearest motion vector near motion vector zero valued motion vector estimated motion vector etc. . For example a total rate distortion RD cost can be calculated for each candidate e.g. each motion vector mode . For example cost C can be calculated using the following equation 

C R L D where R is rate L is lambda and D is distortion. Lambda e.g. the rate multiplier can be provided by the rate multiplier . The candidate with a lowest cost value can be selected as a final inter frame candidate e.g. best inter frame candidate for the inter intra frame candidate decision.

Referring to there is illustrated an encoder system according to an aspect of the subject disclosure. The encoder system includes an encoder component and the control component . The encoder component includes the first predictor component the second predictor component the processing component the selector component and a third predictor component .

The third predictor component can determine an intra frame candidate. The intra frame candidate can be chosen from one or more intra frame candidates e.g. a particular intra frame candidate can be selected from multiple intra frame candidates . For example the intra frame candidate can be chosen using intra frame prediction e.g. using already coded macroblocks within a current frame . Therefore the chosen intra frame candidate can be a best intra frame candidate.

Referring to there is illustrated an encoder system according to an aspect of the subject disclosure. The encoder system includes an encoder component and the control component . The encoder component includes the first predictor component the second predictor component the processing component the selector component the third predictor component and an output component .

The output component can select an inter frame candidate or an intra frame candidate as a motion vector for an output block e.g. the output component can implement inter intra frame candidate selection . For example the output component can select between the inter frame candidate selected by the selector component and the intra frame candidate selected by the third predictor component . The candidate selected by the output component can be encoded. The output component can select between an inter frame candidate e.g. a best inter frame candidate and an intra frame candidate e.g. a best intra frame candidate using a SAD computation and or a penalty value. For example SAD can be calculated for the inter frame candidate and or the intra frame candidate. If the inter frame candidate is associated with a lower SAD value than the intra frame candidate then the inter frame candidate can be chosen as the motion vector for the output block e.g. the motion vector for a coded block . However if the intra frame candidate is associated with a lower SAD value than the inter frame candidate then the intra frame candidate can be chosen as the motion vector for the output block e.g. the motion vector for a coded block . If the best inter frame candidate is the estimated motion vector then the penalty value can be determined based on the motion vector length of the estimated motion vector. However if the best inter frame candidate is the nearest motion vector the near motion vector or the zero valued motion vector e.g. one of the special motion vectors then the penalty value can be zero.

Referring to there is illustrated an encoder system according to an aspect of the subject disclosure. The encoder system includes the first predictor component the second predictor component the processing component the selector component the third predictor component and the output component . The second predictor component includes the block motion vector component the split motion vector component and a selector component . The processing component includes SSD components 

In the encoder system four separate candidates e.g. ESTIMATED MV NEAREST MV NEAR MV and ZERO MV shown in can be generated. However it is to be appreciated that less than four separate candidates e.g. ESTIMATED MV NEAREST MV and ZERO MV can be generated. It is also to be appreciated that more than four separate candidates e.g. FIRST ESTIMATED MV SECOND ESTIMATED MV NEAREST MV NEAR MV and ZERO MV can be generated. For example more than one estimated motion vector can be generated by the second predictor component . The first predictor component can implement motion vector encoding to generate and or select the nearest motion vector the near motion vector and the zero motion vector. The second predictor component can implement motion estimation to generate and or select one or more estimated motion vectors.

The second predictor component can find a best estimated motion vector based on a SAD computation and or one or more penalty values. The best estimated motion vector can be transformed into a split motion vector candidate via the split motion vector component . A split motion vector candidate can be tested around a 1 pixel area surrounding the best motion vector. The split motion vector component can select and or generate multiple motion vectors for a single block. For example a block e.g. a macroblock can include one or more subblocks. Therefore a unique motion vector can be selected and or generated for each of the one or more subblocks. The selector component can select a candidate from the block motion vector component or the split motion vector component e.g. the candidate with the lowest SAD and or penalty can be selected . As such a best estimated motion vector e.g. a best motion estimation motion vector can be selected by the selector component .

Each of the motion vectors e.g. motion vector modes generated by the first predictor component and the second predictor component can be processed in parallel by the SSD components . In one example the SSD components can be implemented as separate machine executable components. In another example the SSD components can be implemented as separate hardware components. In yet another example the SSD components can be implemented as a combination of hardware and software. Each of the SSD components can measure distortion for a motion vector using a SSD computation. Additionally the processing component can measure rate for a motion vector by approximating the number of bits included in the bitstream for each motion vector.

The selector component can select a motion vector e.g. a motion vector mode with a lowest cost value e.g. a lowest rate distortion cost value . The motion vector with the lowest cost value can be selected as the best inter frame candidate. For example the selector component can select the nearest motion vector the near motion vector the zero valued motion vector or the estimated motion vector e.g. the block motion vector or the split motion vector as the best inter frame candidate. As such motion estimation can skip preference for zero nearest and near motion vectors e.g. a new motion vector can be encoded instead . The third predictor component can generate and or select a best intra frame candidate. The best intra frame candidate can be determined based on intra frame prediction. The output component can select the best inter frame candidate or the best intra frame candidate based on a SAD computation and or a penalty value. The output component can then encode the selected candidate e.g. the best inter frame candidate or the best intra frame candidate . As such SSD can be implemented for inter frame candidate selection and SAD can be implemented for inter intra frame candidate selection.

While implementations and aspects of this disclosure are described herein with regard to blocks this disclosure is not so limited. For example the implementations and aspects disclosed herein in relation to blocks can be used e.g. applied in relation to various types of units or regions of a video frame such as for example macroblocks sub macroblocks coding units motion granularity units partitions and or other types of image compression units and these various types of image compression units are within the scope of this disclosure.

The aforementioned systems and or devices have been described with respect to interaction between several components. It should be appreciated that such systems and components can include those components or sub components specified therein some of the specified components or sub components and or additional components. Sub components could also be implemented as components communicatively coupled to other components rather than included within parent components. Further yet one or more components and or sub components may be combined into a single component providing aggregate functionality. The components may also interact with one or more other components not specifically described herein for the sake of brevity but known by those of skill in the art.

Referring to there illustrated is a methodology for selecting an inter frame candidate according to an aspect of this disclosure. As an example methodology can be utilized in various encoding applications such as but not limited to media capturing systems media displaying systems computing devices mobile phones tablets personal data assistants PDAs laptops personal computers audio video devices etc. Specifically the methodology can select an inter frame candidate based on rate distortion cost of inter frame candidates.

Initially video information can be captured or can be contained within memory e.g. within a buffer . At multiple inter frame candidates can be processed e.g. using a processing component in parallel. For example a nearest motion vector a near motion vector a zero valued motion vector and or one or more estimated motion vectors e.g. various motion vector modes can be processed in parallel. At a squared error per pixel for each of the inter frame candidates can be calculated e.g. using a processing component . For example distortion for each of the inter frame candidates can be calculated using a SAD operation for pixels in each of the inter frame candidates e.g. for each motion vector mode . At cost for each of the inter frame candidates can be calculated e.g. using a processing component based at least in part on the calculated squared error. For example cost for a particular inter frame candidate e.g. a particular motion vector mode can be calculated based on distortion e.g. SAD and rate. At a best inter frame candidate can be selected e.g. using a selector component from the multiple inter frame candidates based on the calculated cost. For example an inter frame candidate e.g. a motion vector mode with a lowest calculated cost value can be selected as the best inter frame candidate.

Referring to there illustrated is a methodology for selecting an inter frame candidate based on measured SSD. At one or more previous motion vectors can be selected e.g. using a first predictor component . For example one or more previously determined motion vectors from a neighboring block in a current frame can be selected. At a zero valued motion vector can be selected e.g. using a first predictor component . For example a motion vector that predicts a current block from a corresponding block in a prediction frame e.g. with zero offset can be selected. At an estimated motion vector can be selected e.g. using a second predictor component based at least in part on a sum of absolute difference SAD calculation and a penalty value. For example a new motion vector can be generated and or selected using motion estimation. At a cost value can be calculated e.g. using a processing component for each of the one or more previous motion vectors the zero valued motion vector and the estimated motion vector. For example a cost value can be calculated for each of the one or more previous motion vectors the zero valued motion vector and the estimated motion vector based at least in part on a sum of squared difference SSD calculation. At a motion vector with a lowest calculated cost can be selected e.g. using a selector component from the one or more previous motion vectors the zero valued motion vector and the estimated motion vector as an inter frame candidate. For example a motion vector with a lowest calculated cost based on SSD and rate can be selected from the one or more previous motion vectors the zero valued motion vector and the estimated motion vector as an inter frame candidate.

Referring to there illustrated is a methodology for selecting an inter frame candidate or an intra frame candidate. At a best inter frame candidate can be selected e.g. using an encoder component . For example the methodology can be implemented at . At a best intra frame candidate can be selected e.g. using a third predictor component . For example an intra frame candidate can be selected using intra frame prediction. At the best inter frame candidate or the best intra frame candidate can be selected e.g. using an output component as a coded macroblock based at least in part on a sum of absolute difference SAD computation. For example SAD can be calculated for the best inter frame candidate and the best intra frame candidate. If the best inter frame candidate has a lower SAD value than the best intra frame candidate then the best inter frame candidate can be encoded. However if the best intra frame candidate has a lower SAD value than the best inter frame candidate then the best intra frame candidate can be encoded.

In order to provide a context for the various aspects of the disclosed subject matter as well as the following discussion are intended to provide a brief general description of a suitable environment in which the various aspects of the disclosed subject matter may be implemented.

With reference to a suitable environment for implementing various aspects of this disclosure includes a computer . The computer includes a processing unit a system memory and a system bus . The system bus couples system components including but not limited to the system memory to the processing unit . The processing unit can be any of various available processors. Dual microprocessors and other multiprocessor architectures also can be employed as the processing unit .

The system bus can be any of several types of bus structure s including the memory bus or memory controller a peripheral bus or external bus and or a local bus using any variety of available bus architectures including but not limited to Industrial Standard Architecture ISA Micro Channel Architecture MSA Extended ISA EISA Intelligent Drive Electronics IDE VESA Local Bus VLB Peripheral Component Interconnect PCI Card Bus Universal Serial Bus USB Advanced Graphics Port AGP Personal Computer Memory Card International Association bus PCMCIA Firewire IEEE 1394 and Small Computer Systems Interface SCSI .

The system memory includes volatile memory and nonvolatile memory . The basic input output system BIOS containing the basic routines to transfer information between elements within the computer such as during start up is stored in nonvolatile memory . By way of illustration and not limitation nonvolatile memory can include read only memory ROM programmable ROM PROM electrically programmable ROM EPROM electrically erasable programmable ROM EEPROM flash memory or nonvolatile random access memory RAM e.g. ferroelectric RAM FeRAM . Volatile memory includes random access memory RAM which acts as external cache memory. By way of illustration and not limitation RAM is available in many forms such as static RAM SRAM dynamic RAM DRAM synchronous DRAM SDRAM double data rate SDRAM DDR SDRAM enhanced SDRAM ESDRAM Synchlink DRAM SLDRAM direct Rambus RAM DRRAM direct Rambus dynamic RAM DRDRAM and Rambus dynamic RAM.

Computer also includes removable non removable volatile nonvolatile computer storage media. illustrates for example a disk storage . Disk storage can include but is not limited to devices like a magnetic disk drive floppy disk drive flash drive tape drive Jaz drive Zip drive LS 100 drive flash memory card or memory stick. The disk storage also can include storage media separately or in combination with other storage media including but not limited to an optical disk drive such as a compact disk ROM device CD ROM CD recordable drive CD R Drive CD rewritable drive CD RW Drive or a digital versatile disk ROM drive DVD ROM . To facilitate connection of the disk storage devices to the system bus a removable or non removable interface is typically used such as interface .

A user enters commands or information into the computer through input device s . Input devices include but are not limited to a pointing device such as a mouse trackball stylus touch pad keyboard microphone joystick game pad satellite dish scanner TV tuner card digital camera digital video camera web camera and the like. These and other input devices connect to the processing unit through the system bus via interface port s . Interface port s include for example a serial port a parallel port a game port and a universal serial bus USB . Output device s use some of the same type of ports as input device s . Thus for example a USB port may be used to provide input to computer and to output information from computer to an output device . Output adapter is provided to illustrate that there are some output devices like monitors speakers and printers among other output devices which require special adapters. The output adapters include by way of illustration and not limitation video and sound cards that provide a means of connection between the output device and the system bus . It should be noted that other devices and or systems of devices provide both input and output capabilities such as remote computer s .

Computer can operate in a networked environment using logical connections to one or more remote computers such as remote computer s . The remote computer s can be a personal computer a server a router a network PC a workstation a microprocessor based appliance a peer device or other common network node and the like and typically includes many or all of the elements described relative to computer . For purposes of brevity only a memory storage device is illustrated with remote computer s . Remote computer s is logically connected to computer through a network interface and then physically connected via communication connection . Network interface encompasses wire and or wireless communication networks such as local area networks LAN wide area networks WAN cellular networks etc. LAN technologies include Fiber Distributed Data Interface FDDI Copper Distributed Data Interface CDDI Ethernet Token Ring and the like. WAN technologies include but are not limited to point to point links circuit switching networks like Integrated Services Digital Networks ISDN and variations thereon packet switching networks and Digital Subscriber Lines DSL .

Communication connection s refers to the hardware software employed to connect the network interface to the bus . While communication connection is shown for illustrative clarity inside computer it can also be external to computer . The hardware software necessary for connection to the network interface includes for exemplary purposes only internal and external technologies such as modems including regular telephone grade modems cable modems and DSL modems ISDN adapters and Ethernet cards.

In accordance with various aspects and implementations the computer can be used to encode data such as digital media data which can be in the form of a sequence of video frames e.g. raw video frames . In some implementations the computer can include a plurality of processors that can be used to process data and perform computing tasks e.g. encoding related tasks and or decoding related tasks etc. . The computer includes an encoder that can contain for example an encoder component e.g. the encoder component the encoder system the encoder system the encoder system the encoder system which can function as more fully disclosed herein. In some implementations the encoder can perform various encoding tasks e.g. generating motion estimations and motion vectors encoding blocks and associated motion vectors determining whether to reuse a prior encoded motion vector to encode a current block identifying a coding mode associated with a current block allocating bits for encoding of a current block etc. on data e.g. sequentially or in parallel . The components of the encoder can be implemented as hardware software and or firmware. For example the encoder can include one or more computer executable components. In one example the computer and or the encoder can be implemented as an ASIC chip. In another example the computer and or the encoder can be implemented as a SOC. It is to be appreciated that the computer can be used in connection with implementing one or more of the systems or components shown and described in connection with .

The system includes a communication framework that can be employed to facilitate communications between the client s and the server s . The client s are operatively connected to one or more client data store s that can be employed to store information local to the client s . Similarly the server s are operatively connected to one or more server data store s that can be employed to store information local to the servers .

It is to be noted that aspects or features of this disclosure can be exploited in substantially any wireless telecommunication or radio technology e.g. Wi Fi Bluetooth Worldwide Interoperability for Microwave Access WiMAX Enhanced General Packet Radio Service Enhanced GPRS Third Generation Partnership Project 3GPP Long Term Evolution LTE Third Generation Partnership Project 2 3GPP2 Ultra Mobile Broadband UMB 3GPP Universal Mobile Telecommunication System UMTS High Speed Packet Access HSPA High Speed Downlink Packet Access HSDPA High Speed Uplink Packet Access HSUPA GSM Global System for Mobile Communications EDGE Enhanced Data Rates for GSM Evolution Radio Access Network GERAN UMTS Terrestrial Radio Access Network UTRAN LTE Advanced LTE A etc. Additionally some or all of the aspects described herein can be exploited in legacy telecommunication technologies e.g. GSM. In addition mobile as well non mobile networks e.g. the Internet data service network such as internet protocol television IPTV etc. can exploit aspects or features described herein.

While the subject matter has been described above in the general context of computer executable instructions of a computer program that runs on a computer and or computers those skilled in the art will recognize that this disclosure also can or may be implemented in combination with other program modules. Generally program modules include routines programs components data structures etc. that perform particular tasks and or implement particular abstract data types. Moreover those skilled in the art will appreciate that the inventive methods may be practiced with other computer system configurations including single processor or multiprocessor computer systems mini computing devices mainframe computers as well as personal computers hand held computing devices e.g. PDA phone tablets microprocessor based or programmable consumer or industrial electronics and the like. The illustrated aspects may also be practiced in distributed computing environments where tasks are performed by remote processing devices that are linked through a communications network. However some if not all aspects of this disclosure can be practiced on stand alone computers. In a distributed computing environment program modules may be located in both local and remote memory storage devices.

As used in this application the terms component system platform interface and the like can refer to and or can include a computer related entity or an entity related to an operational machine with one or more specific functionalities. The entities disclosed herein can be either hardware a combination of hardware and software software or software in execution. For example a component may be but is not limited to being a process running on a processor a processor an object an executable a thread of execution a program and or a computer. By way of illustration both an application running on a server and the server can be a component. One or more components may reside within a process and or thread of execution and a component may be localized on one computer and or distributed between two or more computers.

As used herein the term generate generating or forms thereof may be or include forming identifying or otherwise determining as may be logical based on the particular description.

In another example respective components can execute from various computer readable media having various data structures stored thereon. The components may communicate via local and or remote processes such as in accordance with a signal having one or more data packets e.g. data from one component interacting with another component in a local system distributed system and or across a network such as the Internet with other systems via the signal . As another example a component can be an apparatus with specific functionality provided by mechanical parts operated by electric or electronic circuitry which is operated by a software or firmware application executed by a processor. In such a case the processor can be internal or external to the apparatus and can execute at least a part of the software or firmware application. As yet another example a component can be an apparatus that provides specific functionality through electronic components without mechanical parts wherein the electronic components can include a processor or other means to execute software or firmware that confers at least in part the functionality of the electronic components. In an aspect a component can emulate an electronic component via a virtual machine e.g. within a cloud computing system.

In addition the term or is intended to mean an inclusive or rather than an exclusive or. That is unless specified otherwise or clear from context X employs A or B is intended to mean any of the natural inclusive permutations. That is if X employs A X employs B or X employs both A and B then X employs A or B is satisfied under any of the foregoing instances. Moreover articles a and an as used in the subject specification and annexed drawings should generally be construed to mean one or more unless specified otherwise or clear from context to be directed to a singular form.

As used herein the terms example and or exemplary are utilized to mean serving as an example instance or illustration. For the avoidance of doubt the subject matter disclosed herein is not limited by such examples. In addition any aspect or design described herein as an example and or exemplary is not necessarily to be construed as preferred or advantageous over other aspects or designs nor is it meant to preclude equivalent exemplary structures and techniques known to those of ordinary skill in the art.

Various aspects or features described herein can be implemented as a method apparatus system or article of manufacture using standard programming or engineering techniques. In addition various aspects or features disclosed in this disclosure can be realized through program modules that implement at least one or more of the methods disclosed herein the program modules being stored in a memory and executed by at least a processor. Other combinations of hardware and software or hardware and firmware can enable or implement aspects described herein including a disclosed method s . The term article of manufacture as used herein can encompass a computer program accessible from any computer readable device carrier or storage media. For example computer readable storage media can include but are not limited to magnetic storage devices e.g. hard disk floppy disk magnetic strips . . . optical discs e.g. compact disc CD digital versatile disc DVD blu ray disc BD . . . smart cards and flash memory devices e.g. card stick key drive . . . or the like.

As it is employed in the subject specification the term processor can refer to substantially any computing processing unit or device comprising but not limited to single core processors single processors with software multithread execution capability multi core processors multi core processors with software multithread execution capability multi core processors with hardware multithread technology parallel platforms and parallel platforms with distributed shared memory. Additionally a processor can refer to an integrated circuit an application specific integrated circuit ASIC a digital signal processor DSP a field programmable gate array FPGA a programmable logic controller PLC a complex programmable logic device CPLD a discrete gate or transistor logic discrete hardware components or any combination thereof designed to perform the functions described herein. Further processors can exploit nano scale architectures such as but not limited to molecular and quantum dot based transistors switches and gates in order to optimize space usage or enhance performance of user equipment. A processor may also be implemented as a combination of computing processing units.

In this disclosure terms such as store storage data store data storage database and substantially any other information storage component relevant to operation and functionality of a component are utilized to refer to memory components entities embodied in a memory or components comprising a memory. It is to be appreciated that memory and or memory components described herein can be either volatile memory or nonvolatile memory or can include both volatile and nonvolatile memory.

By way of illustration and not limitation nonvolatile memory can include read only memory ROM programmable ROM PROM electrically programmable ROM EPROM electrically erasable ROM EEPROM flash memory or nonvolatile random access memory RAM e.g. ferroelectric RAM FeRAM . Volatile memory can include RAM which can act as external cache memory for example. By way of illustration and not limitation RAM is available in many forms such as synchronous RAM SRAM dynamic RAM DRAM synchronous DRAM SDRAM double data rate SDRAM DDR SDRAM enhanced SDRAM ESDRAM Synchlink DRAM SLDRAM direct Rambus RAM DRRAM direct Rambus dynamic RAM DRDRAM and Rambus dynamic RAM RDRAM . Additionally the disclosed memory components of systems or methods herein are intended to include without being limited to including these and any other suitable types of memory.

It is to be appreciated and understood that components as described with regard to a particular system or method can include the same or similar functionality as respective components e.g. respectively named components or similarly named components as described with regard to other systems or methods disclosed herein.

What has been described above includes examples of systems and methods that provide advantages of this disclosure. It is of course not possible to describe every conceivable combination of components or methods for purposes of describing this disclosure but one of ordinary skill in the art may recognize that many further combinations and permutations of this disclosure are possible. Furthermore to the extent that the terms includes has possesses and the like are used in the detailed description claims appendices and drawings such terms are intended to be inclusive in a manner similar to the term comprising as comprising is interpreted when employed as a transitional word in a claim.

