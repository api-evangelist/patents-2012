---

title: Combined accumulator and maximum/minimum comparator
abstract: In one embodiment, a method comprises detecting, by a hardware accelerator, that a value has been written to a first location of a memory, the first location identified by a first address. The method further includes adding the value to an accumulated value stored in an accumulator register of the hardware accelerator and storing the result in the accumulator register. The method further includes comparing the value to a maximum value stored in a first register of the hardware accelerator and overwriting the maximum value with the value if the value is greater than the maximum value. The method also includes comparing the value to a minimum value stored in a second register of the hardware accelerator and overwriting the minimum value with the value if the value is less than the minimum value.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09046942&OS=09046942&RS=09046942
owner: Atmel Corporation
number: 09046942
owner_city: San Jose
owner_country: US
publication_date: 20120601
---
A touch sensor may detect the presence and location of a touch or the proximity of an object such as a user s finger or a stylus within a touch sensitive area of the touch sensor overlaid on a display screen for example. In a touch sensitive display application the touch sensor may enable a user to interact directly with what is displayed on the screen rather than indirectly with a mouse or touch pad. A touch sensor may be attached to or provided as part of a desktop computer laptop computer tablet computer personal digital assistant PDA smartphone satellite navigation device portable media player portable game console kiosk computer point of sale device or other suitable device. A control panel on a household or other appliance may include a touch sensor.

There are a number of different types of touch sensors such as for example resistive touch screens surface acoustic wave touch screens and capacitive touch screens. Herein reference to a touch sensor may encompass a touch screen and vice versa where appropriate. When an object touches or comes within proximity of the surface of the capacitive touch screen a change in capacitance may occur within the touch screen at the location of the touch or proximity. A touch sensor controller may process the change in capacitance to determine its position on the touch screen.

An electrode whether a ground electrode a guard electrode a drive electrode or a sense electrode may be an area of conductive material forming a shape such as for example a disc square rectangle thin line other suitable shape or suitable combination of these. One or more cuts in one or more layers of conductive material may at least in part create the shape of an electrode and the area of the shape may at least in part be bounded by those cuts. In particular embodiments the conductive material of an electrode may occupy approximately 100 of the area of its shape. As an example and not by way of limitation an electrode may be made of indium tin oxide ITO and the ITO of the electrode may occupy approximately 100 of the area of its shape sometimes referred to as 100 fill where appropriate. In particular embodiments the conductive material of an electrode may occupy substantially less than 100 of the area of its shape. As an example and not by way of limitation an electrode may be made of fine lines of metal or other conductive material FLM such as for example copper silver or a copper or silver based material and the fine lines of conductive material may occupy approximately 5 of the area of its shape in a hatched mesh or other suitable pattern. Herein reference to FLM encompasses such material where appropriate. Although this disclosure describes or illustrates particular electrodes made of particular conductive material forming particular shapes with particular fill percentages having particular patterns this disclosure contemplates any suitable electrodes made of any suitable conductive material forming any suitable shapes with any suitable fill percentages having any suitable patterns.

Where appropriate the shapes of the electrodes or other elements of a touch sensor may constitute in whole or in part one or more macro features of the touch sensor. One or more characteristics of the implementation of those shapes such as for example the conductive materials fills or patterns within the shapes may constitute in whole or in part one or more micro features of the touch sensor. One or more macro features of a touch sensor may determine one or more characteristics of its functionality and one or more micro features of the touch sensor may determine one or more optical features of the touch sensor such as transmittance refraction or reflection.

A mechanical stack may contain the substrate or multiple substrates and the conductive material forming the drive or sense electrodes of touch sensor . As an example and not by way of limitation the mechanical stack may include a first layer of optically clear adhesive OCA beneath a cover panel. The cover panel may be clear and made of a resilient material suitable for repeated touching such as for example glass polycarbonate or poly methyl methacrylate PMMA . This disclosure contemplates any suitable cover panel made of any suitable material. The first layer of OCA may be disposed between the cover panel and the substrate with the conductive material forming the drive or sense electrodes. The mechanical stack may also include a second layer of OCA and a dielectric layer which may be made of PET or another suitable material similar to the substrate with the conductive material forming the drive or sense electrodes . As an alternative where appropriate a thin coating of a dielectric material may be applied instead of the second layer of OCA and the dielectric layer. The second layer of OCA may be disposed between the substrate with the conductive material making up the drive or sense electrodes and the dielectric layer and the dielectric layer may be disposed between the second layer of OCA and an air gap to a display of a device including touch sensor and touch sensor controller . As an example only and not by way of limitation the cover panel may have a thickness of approximately 1 mm the first layer of OCA may have a thickness of approximately 0.05 mm the substrate with the conductive material forming the drive or sense electrodes may have a thickness of approximately 0.05 mm the second layer of OCA may have a thickness of approximately 0.05 mm and the dielectric layer may have a thickness of approximately 0.05 mm. Although this disclosure describes a particular mechanical stack with a particular number of particular layers made of particular materials and having particular thicknesses this disclosure contemplates any suitable mechanical stack with any suitable number of any suitable layers made of any suitable materials and having any suitable thicknesses. As an example and not by way of limitation in particular embodiments a layer of adhesive or dielectric may replace the dielectric layer second layer of OCA and air gap described above with there being no air gap to the display.

One or more portions of the substrate of touch sensor may be made of polyethylene terephthalate PET or another suitable material. This disclosure contemplates any suitable substrate with any suitable portions made of any suitable material. In particular embodiments the drive or sense electrodes in touch sensor may be made of ITO in whole or in part. In particular embodiments the drive or sense electrodes in touch sensor may be made of fine lines of metal or other conductive material. As an example and not by way of limitation one or more portions of the conductive material may be copper or copper based and have a thickness of approximately 5 m or less and a width of approximately 10 m or less. As another example one or more portions of the conductive material may be silver or silver based and similarly have a thickness of approximately 5 m or less and a width of approximately 10 m or less. This disclosure contemplates any suitable electrodes made of any suitable material.

Touch sensor may implement a capacitive form of touch sensing. In a mutual capacitance implementation touch sensor may include an array of drive and sense electrodes forming an array of capacitive nodes. A drive electrode and a sense electrode may form a capacitive node. The drive and sense electrodes forming the capacitive node may come near each other but not make electrical contact with each other. Instead the drive and sense electrodes may be capacitively coupled to each other across a space between them. A pulsed or alternating voltage applied to the drive electrode by touch sensor controller may induce a charge on the sense electrode and the amount of charge induced may be susceptible to external influence such as a touch or the proximity of an object . When an object touches or comes within proximity of the capacitive node a change in capacitance may occur at the capacitive node and touch sensor controller may measure the change in capacitance. By measuring changes in capacitance throughout the array touch sensor controller may determine the position of the touch or proximity within the touch sensitive area s of touch sensor .

In a self capacitance implementation touch sensor may include an array of electrodes of a single type that may each form a capacitive node. When an object touches or comes within proximity of the capacitive node a change in self capacitance may occur at the capacitive node and touch sensor controller may measure the change in capacitance for example as a change in the amount of charge needed to raise the voltage at the capacitive node by a pre determined amount. As with a mutual capacitance implementation by measuring changes in capacitance throughout the array touch sensor controller may determine the position of the touch or proximity within the touch sensitive area s of touch sensor . This disclosure contemplates any suitable form of capacitive touch sensing where appropriate.

In particular embodiments one or more drive electrodes may together form a drive line running horizontally or vertically or in any suitable orientation. Similarly one or more sense electrodes may together form a sense line running horizontally or vertically or in any suitable orientation. In particular embodiments drive lines may run substantially perpendicular to sense lines. Herein reference to a drive line may encompass one or more drive electrodes making up the drive line and vice versa where appropriate. Similarly reference to a sense line may encompass one or more sense electrodes making up the sense line and vice versa where appropriate.

Touch sensor may have drive and sense electrodes disposed in a pattern on one side of a single substrate. In such a configuration a pair of drive and sense electrodes capacitively coupled to each other across a space between them may form a capacitive node. For a self capacitance implementation electrodes of only a single type may be disposed in a pattern on a single substrate. In addition or as an alternative to having drive and sense electrodes disposed in a pattern on one side of a single substrate touch sensor may have drive electrodes disposed in a pattern on one side of a substrate and sense electrodes disposed in a pattern on another side of the substrate. Moreover touch sensor may have drive electrodes disposed in a pattern on one side of one substrate and sense electrodes disposed in a pattern on one side of another substrate. In such configurations an intersection of a drive electrode and a sense electrode may form a capacitive node. Such an intersection may be a location where the drive electrode and the sense electrode cross or come nearest each other in their respective planes. The drive and sense electrodes do not make electrical contact with each other instead they are capacitively coupled to each other across a dielectric at the intersection. Although this disclosure describes particular configurations of particular electrodes forming particular nodes this disclosure contemplates any suitable configuration of any suitable electrodes forming any suitable nodes. Moreover this disclosure contemplates any suitable electrodes disposed on any suitable number of any suitable substrates in any suitable patterns.

As described above a change in capacitance at a capacitive node of touch sensor may indicate a touch or proximity input at the position of the capacitive node. Touch sensor controller may detect and process the change in capacitance to determine the presence and location of the touch or proximity input. Touch sensor controller may then communicate information about the touch or proximity input to one or more other components such one or more central processing units CPUs of a device that includes touch sensor and touch sensor controller which may respond to the touch or proximity input by initiating a function of the device or an application running on the device . Although this disclosure describes a particular touch sensor controller having particular functionality with respect to a particular device and a particular touch sensor this disclosure contemplates any suitable touch sensor controller having any suitable functionality with respect to any suitable device and any suitable touch sensor.

Touch sensor controller may be one or more integrated circuits ICs such as for example general purpose microprocessors microcontrollers programmable logic devices or arrays application specific ICs ASICs . Touch sensor controller may have an instruction set architecture that facilitates its operation. In particular embodiments touch sensor controller comprises analog circuitry digital logic and digital non volatile memory. In particular embodiments touch sensor controller is disposed on a flexible printed circuit FPC bonded to the substrate of touch sensor as described below. The FPC may be active or passive where appropriate. In particular embodiments multiple touch sensor controllers are disposed on the FPC. Touch sensor controller may include a processor unit a drive unit a sense unit and a storage unit. The drive unit may supply drive signals to the drive electrodes of touch sensor . The sense unit may sense charge at the capacitive nodes of touch sensor and provide measurement signals to the processor unit representing capacitances at the capacitive nodes. The processor unit may control the supply of drive signals to the drive electrodes by the drive unit and process measurement signals from the sense unit to detect and process the presence and location of a touch or proximity input within the touch sensitive area s of touch sensor . The processor unit may also track changes in the position of a touch or proximity input within the touch sensitive area s of touch sensor . The storage unit may store programming for execution by the processor unit including programming for controlling the drive unit to supply drive signals to the drive electrodes programming for processing measurement signals from the sense unit and other suitable programming where appropriate. Touch sensor controller will be described in more detail in connection with . Although this disclosure describes a particular touch sensor controller having a particular implementation with particular components this disclosure contemplates any suitable touch sensor controller having any suitable implementation with any suitable components.

Tracks of conductive material disposed on the substrate of touch sensor may couple the drive or sense electrodes of touch sensor to connection pads also disposed on the substrate of touch sensor . As described below connection pads facilitate coupling of tracks to touch sensor controller . Tracks may extend into or around e.g. at the edges of the touch sensitive area s of touch sensor . Particular tracks may provide drive connections for coupling touch sensor controller to drive electrodes of touch sensor through which the drive unit of touch sensor controller may supply drive signals to the drive electrodes. Other tracks may provide sense connections for coupling touch sensor controller to sense electrodes of touch sensor through which the sense unit of touch sensor controller may sense charge at the capacitive nodes of touch sensor . Tracks may be made of fine lines of metal or other conductive material. As an example and not by way of limitation the conductive material of tracks may be copper or copper based and have a width of approximately 100 m or less. As another example the conductive material of tracks may be silver or silver based and have a width of approximately 100 m or less. In particular embodiments tracks may be made of ITO in whole or in part in addition or as an alternative to fine lines of metal or other conductive material. Although this disclosure describes particular tracks made of particular materials with particular widths this disclosure contemplates any suitable tracks made of any suitable materials with any suitable widths. In addition to tracks touch sensor may include one or more ground lines terminating at a ground connector which may be a connection pad at an edge of the substrate of touch sensor similar to tracks .

Connection pads may be located along one or more edges of the substrate outside the touch sensitive area s of touch sensor . As described above touch sensor controller may be on an FPC. Connection pads may be made of the same material as tracks and may be bonded to the FPC using an anisotropic conductive film ACF . Connection may include conductive lines on the FPC coupling touch sensor controller to connection pads in turn coupling touch sensor controller to tracks and to the drive or sense electrodes of touch sensor . In another embodiment connection pads may be connected to an electro mechanical connector such as a zero insertion force wire to board connector in this embodiment connection may not need to include an FPC. This disclosure contemplates any suitable connection between touch sensor controller and touch sensor .

Processor may be any combination of hardware software and or encoded logic operable to provide either alone or in conjunction with other components touch sensor functionality. Processor may implement one or more of the functions of the processor unit described above in connection with . In particular embodiments processor includes logic for executing instructions such as those making up a computer program. In particular embodiments an instruction may include an opcode or an opcode and one or more operands. As an example and not by way of limitation to execute instructions processor may retrieve or fetch instructions from an internal register an internal cache or memory decode and execute them and then write one or more results to an internal register an internal cache or memory . Examples of operations that instructions may specify include a multiplication of two operands specified by the instruction writing e.g. storing a specified value e.g. a value stored by a register of processor to a specified address in memory and reading e.g. loading a value at a specified address in memory e.g. into a register of processor .

In particular embodiments processor includes one or more internal caches for data instructions or addresses. This disclosure contemplates processor including any suitable number of any suitable internal caches where appropriate. As an example and not by way of limitation processor may include one or more instruction caches one or more data caches and one or more translation lookaside buffers TLBs . Instructions in the instruction caches may be copies of instructions in memory and the instruction caches may speed up retrieval of those instructions by processor . Data in the data caches may be copies of data in memory for instructions executing at processor to operate on the results of previous instructions executed at processor for access by subsequent instructions executing at processor or for writing to memory or other suitable data. The data caches may speed up read or write operations by processor . The TLBs may speed up virtual address translations for processor . In particular embodiments processor includes one or more internal registers for data instructions or addresses. Depending on the embodiment processor may include any suitable number of any suitable internal registers where appropriate. Where appropriate processor may be a multi core processor may be one or more processors or be any other suitable processor.

In the embodiment depicted processor includes arithmetic logic unit ALU and multiplier . ALU may include logic for performing various arithmetic and logical operations. ALU may load data from one or more input registers perform an operation on that data and store the result into an output register.

Multiplier includes logic for performing a multiplication of two operands. Processor may execute a multiply instruction by indicating the operands to multiplier and allowing multiplier to perform the multiplication of the operands. Multiplier may multiply the operands together and store the result in a register. In particular embodiments multiplier is operable to provide a signal in response to a determination that the result of the multiplication is valid i.e. the multiplication operation is complete and the output of the multiplier is the correct result . As depicted multiplier is coupled to hardware accelerator via connection . Connection may be any suitable connection such as one or more traces on a substrate or other suitable conductive interconnect. Connection may carry one or more values to hardware accelerator such as the multiplier result or the signal that indicates that the multiplier result is valid.

Memory may be coupled to processor via connection . Connection may be any suitable connection such as one or more traces on a substrate or other suitable conductive interconnect. Connection may carry one or more values between memory and processor . Memory may include any form of volatile or non volatile memory including without limitation random access memory RAM read only memory ROM flash memory or any other suitable memory component or components. In particular embodiments memory includes random access memory RAM . This RAM may be volatile memory where appropriate. Where appropriate this RAM may be dynamic RAM DRAM or static RAM SRAM . Moreover where appropriate this RAM may be single ported or multi ported RAM or any other suitable type of RAM or memory. Memory may include one or more memories where appropriate. Memory may store any suitable data or information utilized by touch sensor controller including software embedded in a computer readable medium and or encoded logic incorporated in hardware or otherwise stored e.g. firmware .

Touch sensor controller may be capable of loading instructions from another source e.g. storage external to touch sensor controller to main memory . Processor may then load the instructions from main memory to an internal register or internal cache. To execute the instructions processor may retrieve the instructions from the internal register or internal cache and decode them. During or after execution of the instructions processor may write one or more results which may be intermediate or final results to the internal register or internal cache. Processor may then write one or more of those results to main memory . In particular embodiments processor executes only instructions in one or more internal registers or internal caches or in main memory as opposed to storage external to touch sensor controller or operates only on data in one or more internal registers or internal caches or in main memory as opposed to storage external to touch sensor controller .

Herein reference to a computer readable storage medium encompasses one or more tangible computer readable storage media possessing structures. As an example and not by way of limitation a computer readable storage medium may include a semiconductor based or other integrated circuit IC such as for example a field programmable gate array FPGA or an application specific IC ASIC a hard disk an HDD a hybrid hard drive HHD an optical disc an optical disc drive ODD a magneto optical disc a magneto optical drive a floppy disk a floppy disk drive FDD magnetic tape a holographic storage medium a solid state drive SSD a RAM drive a SECURE DIGITAL card a SECURE DIGITAL drive a flash memory card a flash memory drive or any other suitable tangible computer readable storage medium or a combination of two or more of these where appropriate.

Particular embodiments include one or more computer readable storage media implementing any suitable storage. For example a computer readable storage medium may implement one or more portions of processor such as for example one or more internal registers or caches one or more portions of memory one or more portions of storage external to memory or a combination of these where appropriate. In particular embodiments a computer readable storage medium implements RAM or ROM. A computer readable storage medium may implement volatile or persistent memory. In particular embodiments one or more computer readable storage media embody encoded software.

Herein reference to encoded software may encompass one or more applications bytecode one or more computer programs one or more executables one or more instructions logic machine code one or more scripts or source code and vice versa where appropriate that have been stored or encoded in a computer readable storage medium. In particular embodiments encoded software includes one or more application programming interfaces APIs stored or encoded in a computer readable storage medium. Particular embodiments may use any suitable encoded software written or otherwise expressed in any suitable programming language or combination of programming languages stored or encoded in any suitable type or number of computer readable storage media. In particular embodiments encoded software may be expressed as source code or object code. In particular embodiments encoded software is expressed in a higher level programming language such as for example C Perl or a suitable extension thereof. In particular embodiments encoded software is expressed in a lower level programming language such as assembly language or machine code . In particular embodiments encoded software is expressed in JAVA. In particular embodiments encoded software is expressed in Hyper Text Markup Language HTML Extensible Markup Language XML or other suitable markup language.

In particular embodiments memory includes main memory for storing instructions for processor to execute or data for processor to operate on. In various embodiments main memory includes electrically erasable programmable read only memory EEPROM . One or more memory management units MMUs may reside between processor and memory and may facilitate access to memory requested by processor .

Memory also includes input output I O register memory . I O register memory includes various memory locations. These locations may refer to I O registers located within I O register memory . Alternatively these locations may refer to I O registers located within hardware accelerator in which case the locations are simply nets or connections in I O register memory to the physical registers of the hardware accelerator . In the example depicted I O register memory includes maximum minimum store MMST register accumulator store ACCST register counter register shift register control register CR status register accumulator high ACC HIGH register accumulator low ACC LOW register max register min register and other I O registers . Each register may be identified by an address. For example MMST register is located at address 0 ACCST register is located at address 1 and so on. Each I O register is accessible by processor . For example processor may write to or read from MMST register by performing store or load instructions or their equivalent . When a particular I O register is accessed by processor the address of the particular I O register may be specified by the instruction performed by processor . As depicted particular I O registers are coupled to hardware accelerator via connections . Connections may each be any suitable connection such as one or more traces on a substrate or other suitable conductive interconnect. The specific registers depicted in will be described in more detail in connection with the description of hardware accelerator in . Although the embodiment depicted shows a plurality of registers in I O register memory other embodiments may include other types of memory structures accessible by processor according to addresses of the memory. As an example instead of physical registers located in I O register memory each of the I O registers depicted in may simply be nets or connections to physical registers located within hardware accelerator . Thus if processor wrote a value to address 0 the value would be written to a physical register of hardware accelerator rather than a register located in memory . Accordingly references herein to a register of I O register memory e.g. counter register may refer to an actual register located in I O register memory or a corresponding register located in hardware accelerator in which case the register of I O register memory is simply a connection to that register .

Controller also includes hardware accelerator . Hardware accelerator is operable to access various I O registers of I O register memory . Hardware accelerator may perform various operations on values stored by some of these I O registers and may provide results for storage in particular I O registers. Alternatively hardware accelerator may be operable to receive values directly from processor and provide values directly to processor e.g. through connections that pass through I O register memory . These operations are described in more detail in connection with .

Although certain steps are described above as being performed by certain components in general the steps may be performed by any suitable components. Although illustrates a processor memory and hardware accelerator contemplates any number or arrangement of such components for performing operations related to the detection of touches at a touch sensor.

Control register may include logic for controlling various functionality of hardware accelerator . For example control register may select values to pass through multiplexors and may determine whether certain operations result in the incrementing of a counter value stored in counter register may control the order of various operations within hardware accelerator or may provide other suitable functionality.

In the embodiment depicted control register is coupled to control register of memory . Thus one or more bits stored by control register may be linked to one or more bits of control register . The value of control register may be written to control register by hardware accelerator at any suitable time. The processor may access the value stored by the control register by performing a read instruction that specifies the address of control register . In particular embodiments the value of control register may be written to control register in order to set various bits of control register . Thus processor may set these bits by writing to control register of memory . The bits may then be propagated to control register . The bits of control register may also be set to an initial state by applying a reset signal to control register . In an alternative embodiment control register is simply a connection rather than a physical register between memory and control register . Thus processor may directly access control register e.g. by writing to or reading from address 4 that corresponds to control register .

In particular embodiments hardware accelerator performs a maximum comparison and a minimum comparison in response to a detection that a new value has been written to MMST register of memory . Hardware accelerator may detect that a new value has been written to MMST register in any suitable manner. For example hardware accelerator may receive a signal from processor when a write instruction identifying the address of MMST register is performed. As another example hardware accelerator may receive a signal from memory after a write has been performed to the address of MMST register . In response to determining that a new value has been written to MMST register one or more bits of control register may be set in order to pass the value from MMST register through multiplexors and to maximum comparator and minimum comparator . The value from MMST register is compared by maximum comparator against a maximum value stored in max register . If the value from MMST register is greater than the maximum value then the value from MMST register is written to max register and stored as the new maximum value. If the value from MMST register is smaller than the maximum value then the maximum value remains unchanged. The value from MMST register is also compared by minimum comparator against a minimum value stored in min register . If the value from MMST register is smaller than the minimum value then the value from MMST register is written to min register and stored as the new minimum value. If the value from MMST register is larger than the minimum value then the minimum value remains unchanged. The maximum comparison operation and the minimum comparison operation described above may occur in parallel and at least part of the logic for performing the maximum comparison may occur simultaneously with at least part of the logic for performing the minimum comparison.

In the embodiment depicted the max register and the min register are respectively coupled to max register and min register of memory . The values of the max register and the min register may be stored in max register and min register at any suitable time. For example the value of the max register may be written to max register upon a change in the value of max register . As another example the value of max register may be written to max register at periodic intervals. Similarly the value of min register may be written to min register at any suitable time. Processor accesses the maximum value or minimum value by performing a read instruction that specifies the address of max register or min register . In particular embodiments the values of the max register and the min register of memory may be written to max register and min register in order to set these registers to an initial value. Thus processor may initialize the minimum and maximum values by writing to max register and min register of memory . These values may then propagate to max register and min register respectively. The max register and min register may also be set to predetermined values by applying a reset signal to these registers. In an alternative embodiment max register is simply a connection rather than a physical register between memory and max register . Thus processor may directly access max register by writing to or reading from address 8 that corresponds to max register . Similarly min register may be a connection rather than a physical register between memory and min register and processor may directly access min register by writing to or reading from address 9 that corresponds to min register .

In particular embodiments hardware accelerator performs a different set of operations in response to a detection that a new value has been written to ACCST register of memory . For example hardware accelerator may perform a maximum comparison a minimum comparison an accumulation and a counting operation. Hardware accelerator may detect that a new value has been written to ACCST register in any suitable manner. For example hardware accelerator may receive a signal from processor when a write instruction identifying the address of ACCST register is performed. As another example hardware accelerator may receive a signal from memory after a write has been performed to the address of ACCST register . In response to determining that a new value has been written to ACCST register one or more bits of control register may be set to pass the value from ACCST register through multiplexors and to maximum comparator and minimum comparator . The value from ACCST register is compared by maximum comparator against a maximum value stored in max register . If the value from ACCST register is greater than the maximum value then the value from ACCST register is written to max register and stored as the new maximum value. If the value from ACCST register is smaller than the maximum value then the maximum value remains unchanged. The value from ACCST register is also compared by minimum comparator against a minimum value stored in min register . If the value from ACCST register is smaller than the minimum value then the value from ACCST register is written to min register and stored as the new minimum value. If the value from ACCST register is larger than the minimum value then the minimum value remains unchanged. The maximum comparison operation and the minimum comparison operation described above may occur in parallel and at least part of the logic for performing the maximum comparison may occur simultaneously with at least part of the logic for performing the minimum comparison.

In addition to performing the maximum and minimum operations described above hardware accelerator may also perform an accumulation of the value written to ACCST register . The accumulation is performed by accumulator which is any suitable accumulator that accumulates using any suitable logic. By way of example and not limitation accumulator may be operable to perform addition in any suitable base such as binary. Accumulator may be compatible with any suitable representation of numbers such as ones complement two s complement sign and magnitude and excess K. Hardware accelerator also includes an accumulator register that stores an accumulated value. Upon a determination that a value has been written to ACCST register the value stored in accumulator register i.e. the accumulated value is added to the value from ACCST register by accumulator . The result is then stored in accumulator register . The number of bits of the results produced by accumulator and the corresponding number of bits of accumulator register may be any suitable number. In particular embodiments it may be equal to the number of bits in the word size of processor . In other embodiments it may be greater than the number of bits in the word size of processor . In such embodiments the accumulated value may be split into sections which are each stored at a different address in memory . For example in the embodiment depicted the number of bits of accumulator register is twice as many as the number of bits in the word size of processor . In the embodiment depicted the width of registers in memory matches the word size of processor thus two registers ACC HIGH register and ACC LOW register are required to store the accumulated value. Accordingly the output of accumulator register is coupled via accumulator shifting logic in the embodiment depicted though it may be directly coupled in other embodiments to two locations in memory ACC HIGH register and ACC LOW register . In this example ACC HIGH register stores the most significant bits of the accumulated value and ACC LOW register stores the least significant bits of the accumulated value. Alternatively if the accumulator had the same width as the registers in memory ACC HIGH register and ACC LOW register may be replaced with a single register.

In the embodiment depicted the output of accumulator register is coupled to accumulator shifting logic . Accumulator shifting logic is operable to shift the accumulated value by a number of bits specified by shift register . In particular embodiments accumulator shifting logic includes a barrel shifter or other suitable shifter. Accumulator shifting logic may shift the bits of the output of accumulator register to the right effectively reducing the value . A default value of shift register may be zero such that the value provided by accumulator shifting logic that is stored in ACC HIGH register and ACC LOW register of memory is the same value as the output of accumulator register . In other embodiments the accumulated value is shifted by the number of bits specified by shift register . For example this shifting may be provided if the number of bits in the word size of processor is less than the number of bits of the accumulator register . Such shifting may avoid the performance of additional instructions when the shifted value is processed further e.g. as part of a fixed point conversion .

In the embodiment depicted shift register is coupled to shift register . The value of the shift register may be written to shift register by hardware accelerator at any suitable time. The processor may access the shifter value of shift register by performing a read instruction that specifies the address of shift register . In particular embodiments the value of shift register may be written to shift register in order to set the value of shift register . Thus processor may set the shift value by writing to shift register of memory . This value is then propagated to shift register . The value of shift register may also be set to a predetermined value e.g. zero by applying a reset signal to shift register . In an alternative embodiment shift register is simply a connection rather than a physical register between memory and shift register . Thus processor may directly access shift register e.g. by writing to or reading from address 3 that corresponds to shift register .

In the embodiment depicted accumulator shifting logic is coupled to ACC HIGH register and ACC LOW register . The accumulated value which may or may not be shifted stored by accumulator shifting logic may be written to ACC HIGH register and ACC LOW register by hardware accelerator at any suitable time. For example the accumulated value may be written to ACC HIGH register and ACC LOW register upon a change in the accumulated value. As another example the accumulated value may be written to ACC HIGH register and ACC LOW register at a periodic interval. The processor accesses the accumulated value by performing read instructions that specifies the address of ACC HIGH register and ACC LOW register . In an alternative embodiment ACC HIGH register and ACC LOW register are simply connections rather than physical registers between memory and accumulator shifting logic . Thus processor may directly read accumulator shifting logic by reading from addresses 6 and 7 that correspond to ACC HIGH register and ACC LOW register .

ACC HIGH register and ACC LOW register may also be coupled to accumulator register . In particular embodiments the values of ACC HIGH register and ACC LOW register may be written to accumulator register in order to set this register. Thus processor may initialize the accumulated value by writing to ACC HIGH register and ACC LOW register of memory . These values are then propagated to accumulator register . The accumulated value of accumulator register may also be set to a predetermined value by applying a reset signal to accumulator register . In an alternative embodiment ACC HIGH register and ACC LOW register are simply connections rather than physical registers between memory and accumulator . Thus processor may directly write to accumulator by writing to addresses 6 and 7 that correspond to ACC HIGH register and ACC LOW register .

The detection of a value written to ACCST register may also initiate an incrementing operation. For example a counter enable signal may be activated in response to the value being written to ACCST register . This signal is coupled to counter and causes the value stored in counter register to be incremented. Accordingly counter register may track the number of times that ACCST register is written to and the number of accumulations that have been performed. This functionality in combination with the accumulation operations may enable averaging operations to be performed based on the results produced by hardware accelerator .

In the embodiment depicted counter register is coupled to counter register . The value of the counter register may be written to counter register by hardware accelerator at any suitable time. For example the value of counter register may be written to counter register upon a change in the value of counter register . As another example the value of counter register may be written to counter register at a periodic interval. The processor accesses the counter value by performing a read instruction that specifies the address of counter register . In particular embodiments the value of counter register may be written to counter register in order to set this register to an initial value. Thus processor may initialize the counter value by writing to counter register of memory . This value is then propagated to counter register . The counter value of counter register may also be set to a predetermined value by applying a reset signal to counter register . In an alternative embodiment counter register is simply a connection rather than a physical register between memory and counter register . Thus processor may directly access shift register e.g. by writing to or reading from address 2 that corresponds to shift register .

Hardware accelerator may also be operable to accumulate results obtained from a multiplier that is external to hardware accelerator . For example multiplier may be included within processor as depicted in . Processor may perform a multiply instruction utilizing multiplier and the result may be sent to the hardware accelerator across one or more connections . In particular embodiments hardware accelerator includes negating logic that is operable to negate the value received from multiplier . Negating logic may generate the negative value of the multiplier result in any suitable manner. As an example and not by way of limitation negating logic may calculate the two s complement of the multiplier result and present this to multiplexor . Based on a value provided by control register either the multiplier result or the negated multiplier result is passed to the accumulator through multiplexor . The output of multiplexer is added to the accumulated value stored in accumulator register and the result is stored as the new accumulated value in accumulator register . The output of multiplexer may be added to the accumulated value at any suitable time. For example if the value from ACCST register arrives at substantially the same time as the output of multiplexor hardware accelerator will coordinate such that the values are accumulated in succession. As another example if the value from the multiplexor arrives while the value from ACCST is being accumulated hardware accelerator will delay the accumulation of the multiplier result until the value from ACCST register is finished accumulating. Hardware accelerator may also be configured to increment the counter value for each multiplier result that is accumulated for only specific multiplier results that are accumulated or to not increment the counter value for any accumulated multiplier results. In various embodiments processor may control whether or not the accumulation of the multiplier result increments the counter value. For example processor may write a value to a register in memory e.g. control register that indicates whether accumulation of a multiplier result should increment the counter value. This value may be used to set counter enable signal to control whether counter increments the counter value.

In this manner the hardware accelerator enables touch sensor controller to perform a multiply accumulate function in one clock cycle of processor . Such a function is a basic operation used in signal processing such as processing related to touch sensing. As an example in such embodiments hardware accelerator may calculate the weighted average of multiple samples.

Status register stores various indicators. In various embodiments hardware accelerator includes logic for calculating whether the accumulated value stored in accumulator register is valid. For example the accumulated value may be valid until an the accumulation of a new value causes an overflow. The overflow could occur when the maximum value of accumulator register is exceeded or when the accumulated value drops below zero e.g. after an accumulation of a negative multiplier result . The indication of whether the accumulated value is valid may be stored in status register . Status register may include a similar indicator for the validity of the counter value stored in counter register .

In the embodiment depicted status register is coupled to status register . The value of the status register may be written to status register by hardware accelerator at any suitable time. For example the value of status register may be written to status register upon a change in the value of status register . As another example the value of status register may be written to status register at a periodic interval. The processor accesses the status value by performing a read instruction that specifies the address of status register . In particular embodiments the value of status register may be written to status register in order to set this register to an initial value. Thus processor may initialize the status value by writing to status register of memory . This value is then propagated to status register . The status value of status register may also be set to a predetermined value by applying a reset signal to status register . In an alternative embodiment status register is simply a connection rather than a physical register between memory and status register . Thus processor may directly access shift register e.g. by writing to or reading from address 5 that corresponds to shift register .

Although certain steps are described above as being performed by certain components in general the steps may be performed by any suitable components. Although illustrates an accumulator counter maximum comparator and minimum comparator contemplates any number or arrangement of such components for performing operations in response to a detection that a value has been written to a particular memory location. Furthermore any one or more operations e.g. accumulating counting comparing of hardware accelerator may be performed in response to a detection that any suitable I O register has been written to. Thus a particular set of operations could be performed when a particular I O register is written to a different set of operations could be performed when a different I O register is written to and so on. A set of operations may include any one or more of the operations described herein or other suitable operations.

The method begins at step where hardware accelerator detects that a new value has been written to ACCST register . Upon this detection various operations may be performed in parallel. At step it is determined whether the new value is greater than a maximum value stored in max register . This determination is performed by comparator . If the new value is not greater than the maximum value then the maximum value stored by maximum register remains unchanged and this branch of the method ends. If the new value is greater than the maximum value then the new value is saved in max register as the maximum value and this branch of the method ends.

At step it is determined whether the new value is less than a minimum value stored in min register . This determination is performed by comparator . If the new value is not less than the minimum value then the minimum value stored by min register remains unchanged and this branch of the method ends. If the new value is less than the minimum value then the new value is saved in min register as the minimum value and this branch of the method ends.

At step it is determined whether a valid multiplier result from multiplier is waiting to be accumulated. If a multiplier result is waiting it is accumulated at step . This step includes adding by accumulator the multiplier result to an accumulated value stored in accumulator register . The multiplier result that is accumulated may be the actual result from multiplier or the negative value of the result depending on the value of one or more bits of the control register . At step it is determined whether the accumulated value stored in accumulator register is still valid. For example it may be determined whether an overflow has occurred. If the accumulated value is no longer valid status register is updated to reflect this at step . If the accumulated value is still valid the method proceeds to step where the new value written from ACCST register is added to the accumulated value stored in accumulator register . At step it is determined whether the accumulated value stored in accumulator register is still valid. If the accumulated value is no longer valid status register is updated to reflect this at step . At step the accumulated value is obtained by accumulator shifting logic and shifted a number of bits specified by shift register . The shifted value may then be stored in memory for access by processor and this branch of the method ends alternatively processor may directly access the shifted value from accumulator shifting logic .

At step a counter value stored in counter register is incremented in order to track the number of samples that have been accumulated. In various embodiments the counter value is incremented every time a new value is written to ACCST register . In particular embodiments the counter value may or may not be incremented when a multiplier result is added to the accumulated value.

Particular embodiments may repeat the steps of the method of where appropriate. Moreover although this disclosure describes and illustrates particular steps of the method of as occurring in a particular order this disclosure contemplates any suitable steps of the method of occurring in any suitable order. For example the multiplier result may be accumulated after the value from ACCST register is accumulated or upon becoming available regardless of whether ACCST register has recently been written to. Furthermore although this disclosure describes and illustrates particular components devices or systems carrying out particular steps of the method of this disclosure contemplates any suitable combination of any suitable components devices or systems carrying out any suitable steps of the method of . As described above different functions may be performed when different locations in memory are written to. For example if MMST register is written to one or more of steps and may be performed while the other steps illustrated in are omitted.

Particular embodiments of the present disclosure may provide one or more or none of the following technical advantages. In particular embodiments a hardware accelerator may perform various operations in response to a detection that a location in memory has been written to. Particular embodiments may perform different sets of operations based upon which location in memory has been written to. Particular embodiments may significantly decrease the number of processor instructions that are performed to effectuate one or more particular operations.

Herein or is inclusive and not exclusive unless expressly indicated otherwise or indicated otherwise by context. Therefore herein A or B means A B or both unless expressly indicated otherwise or indicated otherwise by context. Moreover and is both joint and several unless expressly indicated otherwise or indicated otherwise by context. Therefore herein A and B means A and B jointly or severally unless expressly indicated otherwise or indicated otherwise by context.

This disclosure encompasses all changes substitutions variations alterations and modifications to the example embodiments herein that a person having ordinary skill in the art would comprehend. Moreover although this disclosure describes and illustrates respective embodiments herein as including particular components elements functions operations or steps any of these embodiments may include any combination or permutation of any of the components elements functions operations or steps described or illustrated anywhere herein that a person having ordinary skill in the art would comprehend. Furthermore reference in the appended claims to an apparatus or system or a component of an apparatus or system being adapted to arranged to capable of configured to enabled to operable to or operative to perform a particular function encompasses that apparatus system component whether or not it or that particular function is activated turned on or unlocked as long as that apparatus system or component is so adapted arranged capable configured enabled operable or operative.

