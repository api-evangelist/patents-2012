---

title: Establishing audio communication sessions
abstract: Systems and techniques for transferring electronic data include enabling instant messaging communication between a sender an at least one recipient through an instant messaging host. In addition, voice communication is enabled between the sender and the recipient through the instant messaging host.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09049159&OS=09049159&RS=09049159
owner: FACEBOOK, INC.
number: 09049159
owner_city: Menlo Park
owner_country: US
publication_date: 20120914
---
This application is a continuation of U.S. application Ser. No. 13 228 373 filed on Sep. 8 2011 now U.S. Pat. No. 8 429 231 which is a continuation of U.S. application Ser. No. 09 810 159 filed on Mar. 19 2001 now U.S. Pat. No. 8 041 768 which claims the benefit of U.S. Provisional Application No. 60 189 974 filed Mar. 17 2000 and U.S. Provisional Application No. 60 239 917 filed Oct. 13 2000. Each of the above identified applications and patent are hereby incorporated by reference in their entirety.

The present invention relates generally to transferring data between subscribers of a communications system and more particularly to transferring audio data between subscribers of an instant messaging host.

Online service providers are constantly offering new services and upgrading existing services to enhance their subscribers online experience. Subscribers have on demand access to news weather financial sports and entertainment services as well as the ability to transmit electronic messages and to participate in online discussion groups. For example subscribers of online service providers such as America Online or CompuServe may view and retrieve information on a wide variety of topics from servers located throughout the world. A server may be maintained by the service provider or by a third party provider who makes information and services available through the worldwide network of computers that make up the online service.

America Online has provided subscribers with the ability to send and receive instant messages. Instant messages are private online conversations between two or more people who have subscribed to the instant messaging service and have installed the necessary software. Because such online conversations take place in essentially real time instant messaging can provide immediate access to desired information. Instant messaging is becoming a preferred means of communicating among online subscribers.

In one general aspect electronic data is transferred between users of a communications system by enabling instant messaging communication between a sender an at least one recipient through an instant messaging host. In addition voice communication is enabled between the sender and the recipient through the instant messaging host.

Implementations may include one or more of the following features. For example implementations may include receiving and authenticating a text instant message from the sender at the instant messaging host determining capabilities of the recipient reporting the capabilities of the recipient receiving a request to establish voice communication from the sender and or the recipient and or authenticating the request. Authenticating may include identifying a screen name and or an IP address of the sender and or the recipient. Determining capabilities of the recipient may include identifying hardware or software associated with the recipient. A user interface may be displayed according to the capabilities of the recipient.

Voice communication may be enabled by establishing a generic signaling interface channel a control channel and an audio channel between the sender and the recipient. A mode UDP test may be attempted on the audio channel. The control channel may include a TCP IP socket. The audio channel may include a UDP or TCP channel.

These and other general aspects may be implemented by an apparatus and or by a computer program stored on a computer readable medium. The computer readable medium may comprise a disc a client device a host device and or a propagated signal.

Other features and advantages will be apparent from the following description including the drawings and from the claims.

For illustrative purposes describe a communications system for implementing techniques for transferring electronic data. For brevity several elements in the figures described below are represented as monolithic entities. However as would be understood by one skilled in the art these elements each may include numerous interconnected computers and components designed to perform a set of specified operations and or dedicated to a particular geographical region.

Referring to a communications system is capable of delivering and exchanging data between a client system and a host system through a communications link . The client system typically includes one or more client devices and or client controllers . For example the client system may include one or more general purpose computers e.g. personal computers one or more special purpose computers e.g. devices specifically programmed to communicate with each other and or the host system or a combination of one or more general purpose computers and one or more special purpose computers. The client system may be arranged to operate within or in concert with one or more other systems such as for example one or more LANs Local Area Networks and or one or more WANs Wide Area Networks .

The client device is generally capable of executing instructions under the command of a client controller . The client device is connected to the client controller by a wired or wireless data pathway capable of delivering data.

The client device and client controller each typically includes one or more hardware components and or software components. An example of a client device is a general purpose computer e.g. a personal computer capable of responding to and executing instructions in a defined manner. Other examples include a special purpose computer a workstation a server a device a component other equipment or some combination thereof capable of responding to and executing instructions. An example of client controller is a software application loaded on the client device for commanding and directing communications enabled by the client device . Other examples include a program a piece of code an instruction a device a computer a computer system or a combination thereof for independently or collectively instructing the client device to interact and operate as described herein. The client controller may be embodied permanently or temporarily in any type of machine component equipment storage medium or propagated signal capable of providing instructions to the client device .

The communications link typically includes a delivery network making a direct or indirect communication between the client system and the host system irrespective of physical separation. Examples of a delivery network include the Internet the World Wide Web WANs LANs analog or digital wired and wireless telephone networks e.g. PSTN ISDN or xDSL radio television cable satellite and or any other delivery mechanism for carrying data. The communications link may include communication pathways that enable communications through the one or more to delivery networks described above. Each of the communication pathways may include for example a wired wireless cable or satellite communication pathway.

The host system includes a host device capable of executing instructions under the command and direction of a host controller . The host device is connected to the host controller by a wired or wireless data pathway capable of carrying and delivering data.

The host system typically includes one or more host devices and or host controllers . For example the host system may include one or more general purpose computers e.g. personal computers one or more special purpose computers e.g. devices specifically programmed to communicate with each other and or the client system or a combination of one or more general purpose computers and one or more special purpose computers. The host system may be arranged to operate within or in concert with one or more other systems such as for example one or more LANs Local Area Networks and or one or more WANs Wide Area Networks .

The host device and host controller each typically includes one or more hardware components and or software components. An example of a host device is a general purpose computer e.g. a personal computer capable of responding to and executing instructions in a defined manner. Other examples include a special purpose computer a workstation a server a device a component other equipment or some combination thereof capable of responding to and executing instructions. An example of host controller is a software application loaded on the host device for commanding and directing communications enabled by the host device . Other examples include a program a piece of code an instruction a device a computer a computer system or a combination thereof for independently or collectively instructing the host device to interact and operate as described herein. The host controller may be embodied permanently or temporarily in any type of machine component equipment storage medium or propagated signal capable of providing instructions to the host device .

Examples of each element within the communication system of are broadly described above with respect to . In particular the host system and communications link typically have attributes comparable to those described with respect to host system and communications link of . Likewise the client system of typically has attributes comparable to and illustrates one possible embodiment of the client system of .

The client device typically includes a general purpose computer having an internal or external storage for storing data and programs such as an operating system e.g. DOS Windows Windows 95 Windows 98 Windows 2000 Windows NT OS 2 or Linux and one or more application programs. Examples of application programs include authoring applications e.g. word processing database programs spreadsheet programs or graphics programs capable of generating documents or other electronic content client applications e.g. AOL client CompuServe client AIM client AOL TV client or ISP client capable of communicating with other computer users accessing various computer resources and viewing creating or otherwise manipulating electronic content and browser applications e.g. Netscape s Navigator or Microsoft s Internet Explorer capable of rendering standard Internet content.

The general purpose computer also includes a central processing unit CPU for executing instructions in response to commands from the client controller . In one implementation the client controller includes one or more of the application programs installed on the internal or external storage of the general purpose computer . In another implementation the client controller includes application programs externally stored in and performed by one or more device s external to the general purpose computer .

The general purpose computer typically will include a communication device for sending and receiving data. One example of the communication device is a modem. Other examples include a transceiver a set top box a communication card a satellite dish an antenna or another network adapter capable of transmitting and receiving data over the communications link through a wired or wireless data pathway . The general purpose computer also may include a TV television tuner for receiving television programming in the form of broadcast satellite and or cable TV signals. As a result the client device can selectively and or simultaneously display network content received by communications device and television programming content received by the TV tuner .

The general purpose computer typically will include an input output interface for wired or wireless connection to various peripheral devices . Examples of peripheral devices include but are not limited to a mouse a mobile phone a personal digital assistant PDA a keyboard a display monitor with or without a touch screen input a TV remote control for receiving information from and rendering information to subscribers and a video input device .

Although illustrates devices such as a mobile telephone a PDA and a TV remote control as being peripheral with respect to the general purpose computer in another implementation such devices may themselves include the functionality of the general purpose computer and operate as the client device . For example the mobile phone or the PDA may include computing and networking capabilities and function as a client device by accessing the delivery network and communicating with the host system . Furthermore the client system may include one some or all of the components and devices described above.

Referring to a communications system is capable of delivering and exchanging information between a client system and a host system through a communication link . Client system typically includes one or more client devices and one or more client controllers for controlling the client devices . Host system typically includes one or more host devices and one or more host controllers for controlling the host devices . The communications link may include communication pathways enabling communications through the one or more delivery networks .

Examples of each element within the communication system of are broadly described above with respect to . In particular the client system and the communications link typically have attributes comparable to those described with respect to client systems and and communications links and of . Likewise the host system of may have attributes comparable to and illustrates one possible embodiment of the host systems and shown in respectively.

The host system includes a host device and a host controller . The host controller is generally capable of transmitting instructions to any or all of the elements of the host device . For example in one implementation the host controller includes one or more software applications loaded on the host device . However in other implementations as described above the host controller may include any of several other programs machines and devices operating independently or collectively to control the host device .

The host device includes a login server for enabling access by subscribers and routing communications between the client system and other elements of the host device . The host device also includes various host complexes such as the depicted OSP Online Service Provider host complex and IM Instant Messaging host complex . To enable access to these host complexes by subscribers the client system includes communication software for example an OSP client application and an IM client application. The OSP and IM communication software applications are designed to facilitate the subscriber s interactions with the respective services and in particular may provide access to all the services available within the respective host complexes.

Typically the OSP host complex supports different services such as email discussion groups chat news services and Internet access. The OSP host complex is generally designed with an architecture that enables the machines within the OSP host complex to communicate with each other and employs certain protocols i.e. standards formats conventions rules and structures to transfer data. The OSP host complex ordinarily employs one or more OSP protocols and custom dialing engines to enable access by selected client applications. The OSP host complex may define one or more specific protocols for each service based on a common underlying proprietary protocol.

The IM host complex is generally independent of the OSP host complex and supports instant messaging services irrespective of a subscriber s network or Internet access. Thus the IM host complex allows subscribers to send and receive instant messages whether or not they have access to any particular ISP. The IM host complex may support associated services such as administrative matters advertising directory services chat and interest groups related to the instant messaging. The IM host complex has an architecture that enables all of the machines within the IM host complex to communicate with each other. To transfer data the IM host complex employs one or more standard or exclusive IM protocols.

The host device may include one or more gateways that connect and therefore link complexes such as the OSP host complex gateway and the IM host complex gateway . The OSP host complex gateway and the IM host complex gateway may directly or indirectly link the OSP host complex with the IM host complex through a wired or wireless pathway. Ordinarily when used to facilitate a link between complexes the OSP host complex gateway and the IM host complex gateway are privy to information regarding the protocol type anticipated by a destination complex which enables any necessary protocol conversion to be performed incident to the transfer of data from one complex to another. For instance the OSP host complex and IM host complex generally use different protocols such that transferring data between the complexes requires protocol conversion by or at the request of the OSP host complex gateway and or the IM host complex gateway .

Referring to a communications system is capable of delivering and exchanging information between a client system and a host system through a communication link . Client system typically includes one or more client devices and one or more client controllers for controlling the client devices . Host system typically includes one or more host devices and one or more host controllers for controlling the host devices . The communications link may include communication pathways enabling communications through the one or more delivery networks . As shown the client system may access the Internet through the host system .

Examples of each element within the communication system of are broadly described above with respect to . In particular the client system and the communications link typically have attributes comparable to those described with respect to client systems and and communications links and of . Likewise the host system of may have attributes comparable to and illustrates one possible embodiment of the host systems and shown in respectively. However describes an aspect of the host system focusing primarily on one particular implementation of OSP host complex . For purposes of communicating with an OSP host complex the delivery network is generally a telephone network.

The client system includes a client device and a client controller . The client controller is generally capable of establishing a connection to the host system including the OSP host complex the IM host complex and or the Internet . In one implementation the client controller includes an OSP application for communicating with servers in the OSP host complex using exclusive OSP protocols. The client controller also may include applications such as an IM client application and or an Internet browser application for communicating with the IM host complex and the Internet .

The host system includes a host device and a host controller . The host controller is generally capable of transmitting instructions to any or all of the elements of the host device . For example in one implementation the host controller includes one or more software applications loaded on one or more elements of the host device . However in other implementations as described above the host controller may include any of several other programs machines and devices operating independently or collectively to control the host device .

The host system includes a login server capable of enabling communications with and authorizing access by client systems to various elements of the host system including an OSP host complex and an IM host complex . The login server may implement one or more authorization procedures to enable simultaneous access to the OSP host complex and the IM host complex . The OSP host complex and the IM host complex are connected through one or more OSP host complex gateways and one or more IM host complex gateways . Each OSP host complex gateway and IM host complex gateway may perform any protocol conversions necessary to enable communication between the OSP host complex the IM host complex and the Internet .

The OSP host complex supports a set of services from one or more servers located internal to and external from the OSP host complex . Servers external to the OSP host complex generally may be viewed as existing on the Internet . Servers internal to the OSP complex may be arranged in one or more configurations. For example servers may be arranged in centralized or localized clusters in order to distribute servers and subscribers within the OSP host complex .

In the implementation of the OSP host complex includes a routing processor . In general the routing processor will examine an address field of a data request use a mapping table to determine the appropriate destination for the data request and direct the data request to the appropriate destination. In a packet based implementation the client system may generate information requests convert the requests into data packets sequence the data packets perform error checking and other packet switching techniques and transmit the data packets to the routing processor . Upon receiving data packets from the client system the routing processor may directly or indirectly route the data packets to a specified destination within or outside of the OSP host complex . For example in the event that a data request from the client system can be satisfied locally the routing processor may direct the data request to a local server . In the event that the data request cannot be satisfied locally the routing processor may direct the data request externally to the Internet or the IM host complex through the gateway .

The OSP host complex also includes a proxy server for directing data requests and or otherwise facilitating communication between the client system and the Internet through. The proxy server may include an IP Internet Protocol tunnel for converting data from OSP protocol into standard Internet protocol and transmitting the data to the Internet . The IP tunnel also converts data received from the Internet in the standard Internet protocol back into the OSP protocol and sends the converted data to the routing processor for delivery back to the client system .

The proxy server also may allow the client system to use standard Internet protocols and formatting to access the OSP host complex and the Internet . For example the subscriber can use an OSP TV client application having an embedded browser application installed on the client system to generate a request in standard Internet protocol such as HTTP HyperText Transport Protocol . In a packet based implementation data packets may be encapsulated inside a standard Internet tunneling protocol such as for example UDP User Datagram Protocol and routed to the proxy server . The proxy server may include a L2TP Layer Two Tunneling Protocol tunnel capable of establishing a point to point protocol PPP session with the client system .

The proxy server also may act as a buffer between the client system and the Internet and may implement content filtering and time saving techniques. For example the proxy server can check parental controls settings of the client system and request and transmit content from the Internet according to the parental control settings. In addition the proxy server may include one or more caches for storing frequently accessed information. If requested data is determined to be stored in the caches the proxy server may send the information to the client system from the caches and avoid the need to access the Internet .

Referring to a communications system is capable of delivering and exchanging information between a client system and a host system through a communication link . Client system typically includes one or more client devices and one or more client controllers for controlling the client devices . Host system typically includes one or more host devices and one or more host controllers for controlling the host devices . The communications link may include communication pathways enabling communications through the one or more delivery networks . As shown the client system may access the Internet through the host system .

Examples of each element within the communication system of are broadly described above with respect to . In particular the client system and the communications link typically have attributes comparable to those described with respect to client systems and and communications links and of . Likewise the host system of may have attributes comparable to and illustrates one possible embodiment of the host systems and shown in respectively. However describes an aspect of the host system focusing primarily on one particular implementation IM host complex . For purposes of communicating with the IM host complex the delivery network is generally a telephone network.

The client system includes a client device and a client controller . The client controller is generally capable of establishing a connection to the host system including the OSP host complex the IM host complex and or the Internet . In one implementation the client controller includes an IM application for communicating with servers in the IM host complex utilizing exclusive IM protocols. The client controller also may include applications such as an OSP client application and or an Internet browser application for communicating with the OSP host complex and the Internet respectively.

The host system includes a host device and a host controller . The host controller is generally capable of transmitting instructions to any or all of the elements of the host device . For example in one implementation the host controller includes one or more software applications loaded on one or more elements of the host device . However in other implementations as described above the host controller may include any of several other programs machines and devices operating independently or collectively to control the host device .

The host system includes a login server capable of enabling communications with and authorizing access by client systems to various elements of the host system including an OSP host complex and an IM host complex . The login server may implement one or more authorization procedures to enable simultaneous access to the OSP host complex and the IM host complex . The OSP host complex and the IM host complex are connected through one or more OSP host complex gateways and one or more IM host complex gateways . Each OSP host complex gateway and IM host complex gateway may perform any protocol conversions necessary to enable communication between the OSP host complex the IM host complex and the Internet .

To access the IM host complex to begin an instant messaging session the client system establishes a connection to the login server . The login server typically determines whether the particular subscriber is authorized to access the IM host complex by verifying a subscriber identification and password. If the subscriber is authorized to access the IM host complex the login server employs a hashing technique on the subscriber s screen name to identify a particular IM server for use during the subscriber s session. The login server provides the client system with the IP address of the particular IM server gives the client system an encrypted key i.e. a cookie and breaks the connection. The client system then uses the IP address to establish a connection to the particular IM server through the communications link and obtains access to that IM server using the encrypted key. Typically the client system will be equipped with a Winsock API Application Programming Interface that enables the client system to establish an open TCP connection to the IM server .

Once a connection to the IM server has been established the client system may directly or indirectly transmit data to and access content from the IM server and one or more associated domain servers . The IM server supports the fundamental instant messaging services and the domain servers may support associated services such as for example administrative matters directory services chat and interest groups. In general the purpose of the domain servers is to lighten the load placed on the IM server by assuming responsibility for some of the services within the IM host complex . By accessing the IM server and or the domain server a subscriber can use the IM client application to view whether particular subscribers buddies are online exchange instant messages with particular subscribers participate in group chat rooms trade files such as pictures invitations or documents find other subscribers with similar interests get customized news and stock quotes and search the Web.

In the implementation of the IM server is directly or indirectly connected to a routing gateway . The routing gateway facilitates the connection between the IM server and one or more alert multiplexors for example by serving as a link minimization tool or hub to connect several IM servers to several alert multiplexors. In general an alert multiplexor maintains a record of alerts and subscribers registered to receive the alerts.

Once the client system is connected to the alert multiplexor a subscriber can register for and or receive one or more types of alerts. The connection pathway between the client system and the alert multiplexor is determined by employing another hashing technique at the IM server to identify the particular alert multiplexor to be used for the subscriber s session. Once the particular multiplexor has been identified the IM server provides the client system with the IP address of the particular alert multiplexor and gives the client system an encrypted key i.e. a cookie . The client system then uses the IP address to connect to the particular alert multiplexor through the communication link and obtains access to the alert multiplexor using the encrypted key.

The alert multiplexor is connected to an alert gate that like the IM host complex gateway is capable of performing the necessary protocol conversions to form a bridge to the OSP host complex . The alert gate is the interface between the IM host complex and the physical servers such as servers in the OSP host complex where state changes are occurring. In general the information regarding state changes will be gathered and used by the IM host complex . However the alert multiplexor also may communicate with the OSP host complex through the IM gateway for example to provide the servers and subscribers of the OSP host complex with certain information gathered from the alert gate .

The alert gate can detect an alert feed corresponding to a particular type of alert. The alert gate may include a piece of code alert receive code capable of interacting with another piece of code alert broadcast code on the physical server where a state change occurs. In general the alert receive code installed on the alert gate instructs the alert broadcast code installed on the physical server to send an alert feed to the alert gate upon the occurrence of a particular state change. Upon detecting an alert feed the alert gate contacts the alert multiplexor which in turn informs the client system of the detected alert feed.

In the implementation of the IM host complex also includes a subscriber profile server connected to a database for storing large amounts of subscriber profile data. The subscriber profile server may be used to enter retrieve edit manipulate or otherwise process subscriber profile data. In one implementation a subscriber s profile data includes for example the subscriber s buddy list alert preferences designated stocks identified interests and geographic location. The subscriber may enter edit and or delete profile data using an installed IM client application on the client system to interact with the subscriber profile server .

Because the subscriber s data is stored in the IM host complex the subscriber does not have to reenter or update such information in the event that the subscriber accesses the IM host complex using new or a different client system . Accordingly when a subscriber accesses the IM host complex the IM server can instruct the subscriber profile server to retrieve the subscriber s profile data from the database and to provide for example the subscriber s buddy list to the IM server and the subscriber s alert preferences to the alert multiplexor . The subscriber profile server also may communicate with other servers in the OSP host complex to share subscriber profile data with other services. Alternatively user profile data may be saved locally on the client device .

Referring to a sender a recipient and a host interact according to a procedure to transfer audio data. The procedure may be implemented by any suitable type of hardware software device computer computer system equipment component program application code storage medium or propagated signal.

Examples of each element of are broadly described above with respect to . In particular the sender and the recipient typically have attributes comparable to those described with respect to client devices and and or client controllers and . The host typically has attributes comparable to those described with respect to host device and and or host controllers and . The sender the recipient and or the host may be directly or indirectly interconnected through a known or described delivery network.

The sender and the recipient are each associated with a subscriber. To allow file transfers each subscriber sets certain preferences for permitting files to be transferred to and from other subscribers. For example the sender and recipient may identify screen names of subscribers who have permission to send files to them or retrieve files from them. Typically each subscriber will be presented with a graphical user interface that permits selection among various transfer preferences. A subscriber s transfer preferences to may be maintained locally at the client or remotely at the host .

In general the sender and the recipient communicate over an open connection such as an open TCP connection established through the host . Typically the sender and the recipient each include a Winsock API for establishing an open TCP connection to the host and a client application for accessing the host . The sender and the recipient connect to the host to establish the connection.

The sender and the recipient use the connection to communicate with the host and with each other. The connection remains open during the time that the sender and the recipient are accessing the host . To access the host the sender and the recipient each send a separate request to the host . The request identifies the associated subscriber to the host and to other subscribers using a unique screen name. The host verifies a subscriber s information e.g. screen name and password against data stored in a subscriber database. If the subscriber s information is verified the host authorizes access. If the subscriber s information is not verified the host denies access and sends an error message.

Upon accessing the host a buddy list is displayed to the subscriber. In general a subscriber s buddy list is a user interface that lists the online status and capabilities of certain screen names i.e. buddies identified the subscriber. In particular the host informs the sender whether identified buddies are online i.e. currently accessing the host . The host also informs any subscriber who has identified the sender as a buddy that the sender is currently online. The buddy list also facilitates instant messaging communication between subscribers. A subscriber can activate an instant messaging message user interface pre addressed to a buddy simply by clicking the screen name of a buddy on the buddy list. If a recipient is not a buddy the first subscriber must activate a blank instant messaging user interface and then address the instant message to the screen name of the intended recipient. When necessary a subscriber can look up the screen name of an intended recipient using the intended recipient s e mail address.

In addition to exchanging instant messages with online buddies the sender may participate in group chat rooms locate other subscribers with similar interests get customized news and stock quotes search the Web and transfer files to and from other subscribers. In one implementation a sender a recipient and a host interact according to a procedure to transfer audio data.

The transfer of audio data extends the functionality of instant messaging by allowing the sender and the recipient to communicate peer to peer via audio i.e. microphone and speaker. In one implementation the sender initiates the process by designating one or more recipients to receive an instant message e.g. a text message . If the intended recipients are buddies of the sender the sender may confirm the online status and capabilities of each recipient prior to sending the video message by viewing the buddy list. After a subscriber composes an instant message and clicks a SEND button the instant message is sent from the sender to the host step .

After receiving the instant message from the sender the host authenticates the instant message step . In addition to the textual body the instant message may include header information identifying the message type the screen name and or IP address of the sender and recipient and a randomly generated security number. The instant message may be authenticated by for example using a reverse look up table to match the screen names and or IP addresses with those of valid subscribers. In the event that either the sender or the recipient is not associated with a valid subscriber the host reports an error message.

Once the instant message is verified the host determines the capabilities of the recipient step . For example the host may monitor and update the online status client version and device type of all connected subscribers in real time. The capability to receive audio data may depend on hardware e.g. device type software e.g. client version and or transfer preferences e.g. blocked screen names . To be talk enabled both the talk software and audio equipment must be available. The host then reports the capabilities of the recipient to the sender step .

Upon receiving the report from the host the sender displays a UI according to the capabilities of the sender and or the recipient step . If the sender is not talk enabled then a standard instant messaging user interface is displayed. If the sender is talk enabled but the recipient is not talk enabled a START TALK UI having a grayed START TALK button is displayed. If both the sender and the recipient are talk enabled a START TALK UI having a functioning START TALK button is displayed.

The process continues with the host sending the instant message to the recipient step . The recipient accepts the initial text message from the host step and displays a UI according to the capabilities of the sender and or the recipient step . If the recipient is not talk enabled then a standard instant messaging UI is displayed. If the recipient is talk enabled but the sender is not talk enabled an instant messaging UI having a grayed START TALK button is displayed. If both the recipient and the sender are talk enabled an instant messaging UI with a functioning START TALK button is displayed.

If both sides are talk enabled both the sender and the recipient have a START TALK UI displayed. When the START TALK UI is displayed a subscriber can initiate a talk session. In one implementation the sender initiates a talk session by sending a talk request to the host step . The talk request may contain information including but not limited to the message type the screen name and or IP address of the sender and recipient and a randomly generated security number. When a the sender clicks the START TALK UI the START TALK UI transitions to an END TALK UI.

Upon receiving the talk request the host authenticates the talk request from the sender step . The host may authenticate the talk request by for example using a reverse look up table to match the screen names and or IP addresses with those of valid subscribers. In the event that either the sender or the recipient is not associated with a valid subscriber the host reports an error message.

After verifying the talk request the host sends the talk request to the recipient step . Upon receiving the talk request the START TALK UT displayed by the recipient transitions to a CONNECT UI step . The CONNECT UI informs the recipient that the sender wants to engage in a talk session. At this point the recipient may ignore the talk request accept the talk request or terminate the instant message session.

If the recipient accepts the talk request by clicking the CONNECT UI step the CONNECT UT transitions to the END TALK UI and the host establishes a talk session step . When a talk session is active users can talk to each other. At this point END TALK UI is displayed by both the sender and the recipient . The talk session steps remains active until one of the users clicks END TALK UI. After one of the users clicks the END TALK LE both the sender and the recipient will display the START TALK UI allowing either side to initiate yet another talk session.

If the sender disengages from the talk session before the recipient connects the CONNECT UI at the recipient transitions back to the START TALK UI. If both users click the START TALK UI simultaneously the host will ignore one of the START TALK clicks such that one user will display the END TALK UI and the other will display the CONNECT UI. If the sender clicks the START TALK UI prior to the recipient accepting the initial text message the recipient does not display the START TALK UI but instead immediately displays the CONNECT UI.

In one implementation a talk tool establishes an active talk session using three communication channels a Generic Signaling Interface GSI channel a control channel and an audio channel. The talk tool uses the GSI channel to establish the initial connection. During this connection the local IP addresses are exchanged. After the initial connection phase is done the GSI channel is no longer used. By using the GSI channel the exchange of local IP addresses is only done when both users permit such an exchange i.e. by clicking on the CONNECT UI. These actions protect users from having their local EP addresses automatically obtained without their consent.

The control channel is a TCP IP socket for which the IP address and port number of the remote side are obtained through the GSI channel. The control channel is used to send receive control attributes of the talk session while the session is active. For example because some firewalls will not allow an external connection to a socket on the inside of the firewall the talk tool attempts a connection from both sides of the session. This action allows a connection to be made if there is a maximum of one firewall within the connection. If there is a firewall on both sides the chances are that no connection can be made and the talk session will fail. To work across two firewalls the user must obtain the port range used by talk such that one of the firewalls can be modified to permit the range to pass through the firewall.

The audio channel is a TCP IP socket used to transport audio packets. This channel can either be UDP or TCP. In general UDP is used since it minimizes latency. However because some firewalls will not pass through UDP packets the audio channel may have to use TCP. The talk tool indicates the mode i.e. TCP UDP or employs an auto mode in which the talk tool attempts a UDP test and resorts to TCP upon failure of UDP.

Talk sessions may work in either full or half duplex. Full duplex is when both users can talk at the same time. Half duplex is where only one user can talk at a time. A client device is determined to be incapable of handling full duplex for example if the CPU is too slow to compress decompress audio simultaneously and or the microphone and speakers cannot be opened simultaneously. If a client device is marked as half duplex then any talk session used by that client device becomes a half duplex session regardless of whether another device can handle duplex mode. In one implementation a TALK LISTEN button on the END TALK UI supports half duplex operation. This button has two states LISTEN or TALK. If the talk session is full duplex this button is not shown. If the button reads TALK at both the sender and the recipient Initial Half Duplex the first user to click TALK is allowed to talk and the other user is forced to listen. The user who is listening has a grayed out TALK button Half Duplex Listen and the user who is talking has a LISTEN button Talking Half Duplex . When the LISTEN button is clicked the user who is talking allows the user who is listening to talk.

The talk tool that enables the audio transfer talk functionality may be any type of client controller e.g. software application program loaded on to a client device. The talk tool supports use by different OSP and IM clients. The talk tool is responsible for responding to user interfaces and translating user commands into the appropriate actions with the client device. For example the talk tool opens reads writes and closes the physical components on the client devices needed for audio. The talk tool also controls audio and control channels with callbacks being executed to indicate status change. When the talk tool is loaded the talk tool determines if the client device is capable of handling full duplex.

The talk tool also may allow the user to control the volume for the speaker and microphone. In one implementation the user speaks into a microphone and the audio data are recorded into memory. While in the record mode the average level of the speaker s voice is indicated on a level meter displayed on a user interface of the talk tool. A slider control is used to adjust the input level to an optimal value. After the speaker stops speaking the speaker s stored speech is played back through the computer s audio output device. The speaker level slider control may be used to adjust the output level to an acceptable volume. If the user starts to speak again the talk tool reverts to the record mode and the cycle repeats. Once the user is satisfied with the settings the user can save the settings for use in subsequent talk sessions.

The talk tool may support additional functionality including but not limited to multi conferencing hold and muting. Multi conferencing allows more than two users to engage in a talk session. Hold allows the suspension of an active talk session in order to connect to another talk session. Muting turns off the microphone to prevent user feedback echo during full duplex mode.

The talk tool also may include security features to protect the integrity of transferred data. For example the talk tool may compress data using a proprietary algorithm or may send the data in a proprietary protocol. To further improve security the talk tool may select the port numbers at random from a large range.

In general an instant messaging talk session is similar to a telephonic session in that it has the same three states not connected hung up connecting ringing and connected talking . As described above these states and the ability to switch among them are supported by corresponding UIs namely a START TALK UI not connected a CONNECT UI ringing and an END TALK UI connected .

