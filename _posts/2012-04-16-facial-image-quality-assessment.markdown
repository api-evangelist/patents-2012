---

title: Facial image quality assessment
abstract: In general, this disclosure describes techniques for assessing image quality of captured facial images. An example method includes capturing an image, generating a facial detection confidence score based in part on a likelihood that a representation of at least a portion of a face is included in the image, generating a facial landmark detection confidence score based at least in part on a likelihood that representations of facial landmarks are accurately identified in the image, and generating a geometric consistency score based at least in part on a difference between a point of intersection between a nose base and a line segment that passes through each eye and a midpoint of the line segment. The method also includes generating an image quality score based in part on a combination of the confidence scores, and the consistency score, and classifying an image quality based on the image quality score.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08254647&OS=08254647&RS=08254647
owner: Google Inc.
number: 08254647
owner_city: Mountain View
owner_country: US
publication_date: 20120416
---
A user may activate or otherwise gain access to functionalities of a mobile computing device by unlocking the device. In some instances a mobile computing device may be configured to permit unlocking based on authentication information provided by the user. Authentication information may take various forms including alphanumeric passcodes and biometric information. Examples of biometric information include fingerprints retina scans and facial images. A mobile computing device may authenticate a facial image input using facial recognition technology.

In one example a method includes capturing by a camera of a mobile computing device an image generating by the mobile computing device a facial detection confidence score based at least in part on a likelihood that a representation of at least a portion of a face is included in the image and generating by the mobile computing device a facial landmark detection confidence score based at least in part on a likelihood that representations of facial landmarks are accurately identified in the image. The method further includes generating by the mobile computing device a geometric consistency score based at least in part on a difference between a point of intersection between a nose base and a line segment that passes through each eye and a midpoint of the line segment in the image generating by the mobile computing device an image quality score based at least in part on a combination of the facial detection confidence score the facial landmark detection confidence score and the geometric consistency score and classifying by the mobile computing device a quality of the image based at least in part on the image quality score.

In another example a computer readable storage medium includes instructions for causing at least one processor to perform operations. The operations include capturing with a camera of the mobile computing device an image generating a facial detection confidence score based at least in part on a likelihood that a representation of at least a portion of a face is included in the image and generating a facial landmark detection confidence score based at least in part on a likelihood that representations of facial landmarks are accurately identified in the image. The operations further include generating a geometric consistency score based at least in part on a difference between a point of intersection between a nose base and a line segment that passes through each eye and a midpoint of the line segment in the image generating an image quality score based at least in part on a combination of the facial detection confidence score the facial landmark detection confidence score and the geometric consistency score and classifying a quality of the image based at least in part on the image quality score.

In another example a mobile computing device includes at least one camera configured to capture an image and at least one processor configured to generate a facial detection confidence score based at least in part on a likelihood that a representation of at least a portion of a face is included in the image and generate a facial landmark detection confidence score based at least in part on a likelihood that representations of facial landmarks are accurately identified in the image. The processor is further configured to generate a geometric consistency score based at least in part on a difference between a point of intersection between a nose base and a line segment that passes through each eye and a midpoint of the line segment in the image generate an image quality score based at least in part on a combination of the facial detection confidence score the facial landmark detection confidence score and the geometric consistency score and classify a quality of the image based at least in part on the image quality score.

The details of one or more examples are set forth in the accompanying drawings and the description below. Other features objects and advantages will be apparent from the description and drawings and from the claims.

In general this disclosure is directed to techniques for evaluating the quality of the images captured during enrollment and authentication when using facial recognition authentication mechanisms. Conventionally facial recognition authentication fails in two basic ways 1 you are the authorized user but the device fails to authenticate you false negative or 2 you are not the authorized user but the device grants you access as if you are an authorized user false positive . Either of the authentication failures may result from poor quality enrollment and or authentication image captures. For example when a mobile phone captures an image of a person s face the pose of the face may be outside the range of poses accounted for by internal models of facial landmarks which may make it difficult to accurately identify the facial landmarks used to align faces when determining whether two different faces match.

Techniques of the disclosure may reduce the frequency of facial recognition authentication failures by identifying image captures of low quality alerting the user and refraining from performing facial recognition authentication or completing enrollment until images of satisfactory quality have been captured. In particular techniques of this disclosure may generate one or more quality scores that a mobile computing device may use to determine whether or not a face is of sufficient quality based on the yaw angle of the face and or the location of facial landmarks. The mobile computing device receives facial detection information e.g. a score that corresponds to the likelihood that a face was detected in the image facial landmark detection information e.g. a score that corresponds to the likelihood that the landmarks are accurately located and a geometric consistency score for three points the center of each eye and the base of the nose. In general faces exhibiting larger yaw will result in lower face detection scores facial landmark detection scores and geometric consistency scores. Based on the three signals the mobile computing device outputs a quality score. The mobile computing device may reject captured images that have a quality score lower than a configurable threshold value.

In the example of mobile computing device may include one or more input devices at least one of which may include a camera . Camera may be part of or coupled to a front facing camera of mobile computing device . In other examples camera may be part of or coupled to a rear facing camera of mobile computing device . One or both of the front facing and rear facing cameras may be capable of capturing still images video or both.

Mobile computing device may further include a template repository . In some examples template repository may comprise a logical and or physical location e.g. a logical location that references a particular physical location such as one or more of storage devices of . In some examples template repository may comprise a directory or file of a file system a database or a sector or block of a hard disk drive solid state drive or flash memory. In an example template repository may also reside at least partially in a memory of storage devices e.g. if the images of template repository are cached for later write through to one or more of storage device .

Mobile computing device may further include output devices . At least one of output devices may display a graphical user interface GUI . In various examples mobile computing device may cause one or more of output devices to update GUI to include different user interface controls text images or other graphical contents. Displaying or updating GUI may generally refer to the process of causing one or more of output devices to change the contents of GUI which may be displayed to the user.

In the example of a user may not currently be authenticated with mobile computing device . However user may wish to authenticate with mobile computing device . User may attempt to authenticate with mobile computing device using facial recognition. GUI may display graphical information related to authenticating a user to mobile computing device using facial recognition according to techniques of this disclosure. In the example of user of mobile computing device may attempt to authenticate with mobile computing device in order to gain access to some or all of the resources of mobile computing device .

In general and in the example of facial recognition may occur in two phases an enrollment phase and an authentication phase. During the enrollment phase user uses camera of mobile computing device to capture captured image . Mobile computing device may generate one or more captured templates based on the captured image . A template may comprise a processed version of an image and or features of an image. A template may further comprise model parameters that may be used in conjunction with facial feature recognition algorithms as well as intrinsic characteristics of what a person looks like. Mobile computing device may store the captured templates in template repository for later use in the authentication phase. More specifically mobile computing device may compare the templates stored in template repository with the captured templates of a user that is trying to authenticate referred to as an authentication user with mobile computing device . The templates stored in template repository may be referred to as reference templates. The process of obtaining and storing one or more template images is referred to as enrollment. 

The authentication phase of facial recognition on a mobile device occurs when user attempts to authenticate him or herself with mobile computing device in order to gain access to resources of mobile computing device . During the authentication phase mobile computing device may compare captured templates of a user with one or more of the reference templates of template repository .

More specifically mobile computing device may compare the features of captured templates against the reference template features. Each template may correspond to one or more features of a user s face. The template may generally correspond to a statistical model of the one or more features. As an example the pixels that form a portion of an image illustrating a person s eye which is one example of a feature may correspond to a particular statistical distribution or relationship of the pixels in the area comprising a particular feature. Mobile computing device may compare the one or more features represented by a captured template with a reference template to determine if the two are similar.

The statistical distributions of a feature may be based on the distribution of coefficients resulting from one or more discrete wavelet transforms DWTs . Wavelet transforms may transform the pixel values of an image into wavelet coefficients. Mobile computing device may compare corresponding features from of the captured templates and one or more templates of template repository to produce a likelihood that the features match based on the similarity of the templates. If the likelihood exceeds a threshold computing device may determine that captured templates match the features of one or more of the templates of template repository . The templates of template repository may include templates that attempt to model a number of different poses and conditions. As some examples the templates may attempt to model different lighting conditions different facial expressions and faces of users with and without glasses.

If mobile computing device determines that captured templates match the features of one or more of the reference templates mobile computing device may grant user access to the resources of mobile computing device . Mobile computing device may determine whether captured templates match the templates of template repository based on whether a combination of scores comparing the two templates exceeds a threshold. In some examples the if mobile computing device determines that the features of captured templates do not match a sufficient number of the templates of template repository mobile computing device may deny user access to the resources of mobile computing device . In some implementations denying user access to the resources can include providing one or more alternative authentication options such as password or gesture entry voice recognition or secure element among others and or providing another opportunity to authenticate using facial recognition.

In both the enrollment and authentication phases mobile computing device may determine that captured image is of low quality which may make captured image and captured templates unsuitable for use in facial recognition. In some cases low quality images may be used despite the low quality of the images which may result in an authorized user being denied access to the resources of the mobile device in some or all instances or may result in an unauthorized user being granted access to the resources of the mobile device in some or all instances both of which are undesirable results. In some examples a computing device may display a warning to user using GUI at the enrollment stage indicating that the captured image is of low quality. The user may dismiss the warning or the user may elect to proceed despite low quality. This disclosure is generally directed toward techniques for determining whether a captured image is suitable for use in facial recognition which may reduce the likelihood that poor quality images are used during the enrollment or authentication process when performing facial recognition.

In the example of user may attempt to authenticate via facial recognition with mobile computing device . In the example of user may be engaged in either the enrollment or authentication phases. As part of the facial recognition process user may use a facial recognition enrollment or unlock interface to cause computing device to acquire captured image of user using the camera . In the example of computing device may determine that captured image is of low quality and therefore unsuitable for use in facial recognition. Computing device may determine that the captured image is of low quality based on one or more of a geometric consistency score a facial landmark detection confidence score and a facial detection confidence score. Each of the three scores is discussed in further detail below.

Based on the determination that a captured image is of low quality mobile computing device may for example alert user by updating GUI with an indication that the captured image is of low quality via a message box control . Computing device may determine that captured image is of low quality based on a low geometric consistency score value that computing device determines. Message box control may include suggestions on how to improve the quality of future images captured by camera of mobile computing device via GUI based on low confidence scores and or failures to match features of the templates. As an example a low facial detection confidence score may indicate that the lighting is bad and computing device may update GUI to suggest taking a picture in better lighting conditions. As another example a low geometric consistency score may indicate significant yaw and mobile computing device may update GUI to suggest that user center his or her face with respect to the camera . In some examples computing device may attempt to capture an additional image some pre determined number of times before alerting the user that captured templates is of low quality.

Captured image may be of low quality for facial recognition due to a number of reasons. As some examples captured image may suffer from alignment issues such as pitch yaw and or roll. Computing device may attempt to detect pitch yaw and or roll and may attempt to fix other issues such as poor lighting or centering. In the example of the face of user may not be aligned straight on with camera . Rather the face of user may be rotated. That is instead of being aligned with camera the face of user may be rotated at some angle around one or more of three different axes. The movement around each of these axes may be referred to as pitch roll and yaw. Each of pitch roll and yaw are further described below with regard to .

Mobile computing devices which may include mobile computing device may especially suffer from capturing images that have pitch roll and or yaw issues. Captured images may suffer from these issues because mobile computing devices are hand held and users often hold mobile computing devices below face level e.g. at chest or waist level . Also because mobile computing devices are small and lightweight users may easily and inadvertently rotate the devices. As an example user may hold mobile computing device below the level of his or her face. Thus when capturing an image of a face of a user camera may acquire a captured image of user with his or her head tilted upward and away from camera . As stated above when the head of user is not properly aligned problems may occur during the enrollment and or authentication phases of facial recognition performed by mobile computing device .

Based on the captured image computing device may produce captured templates . To determine the quality of the captured image mobile computing device may compute one or more confidence scores and or determine one or more other indications of the quality of the captured image . In some examples the values of the confidence scores may be based on a confidence that mobile computing device has successfully recognized various features of a human face in the captured templates . If mobile computing device recognizes features of a face a confidence score may be higher. If mobile computing device does not recognize facial features of a person from captured templates a confidence score may be lower. As described above various features of a human face may be modeled using templates. The templates may comprise statistical models of the various features of the human face. Based on how closely the statistical properties of captured templates match the features of the templates of template repository computing device may produce higher confidence scores. In some examples computing device may determine a template for an entire human face and this template may be used by computing device to produce the facial detection confidence score. Computing device may also determine templates for two eyes and the base of a nose of user . Computing device may use these templates to determine the facial landmark detection confidence score. Based on the distance between the eyes and the base of nose computing device may determine the geometric consistency score. Further details about the geometric consistency score are described below.

As part of determining the quality of the captured image mobile computing device may further determine whether captured templates exhibits pitch yaw and or roll. The process of determining whether a captured templates exhibits pitch yaw and or roll is described in further detail below. Mobile computing device may further alert user of the determined rotational issues that caused the captured templates to be determined as having low quality. As an example mobile computing device may also update GUI to instruct user to look directly at the camera in a case where the geometric alignment determined as part of the geometric consistency score indicates that the head of user is rotated to the left or the right. In another example mobile computing device may alert user that his or her head is pitched too far up or down with GUI to in a case where a geometric consistency facial landmark consistency and or facial detection scores indicate that the head of user is pitched up or down. The mobile device may further attempt to acquire one or more additional images after user has been informed of the quality issues affecting the previously captured templates .

As stated above mobile computing device may calculate confidence scores such that the scores may indicate a likelihood that various features have been found or that various parameters are within an acceptable range. In some examples mobile computing device may calculate a facial detection confidence score a facial landmark detection confidence score and a geometric consistency score. The face detection confidence score may indicate a value that a face of a user has been detected. The facial landmark confidence score may indicate a confidence that various facial landmarks of a user have been detected. In some examples the facial features may comprise a base of the nose and each eye of a user. The geometric consistency score may calculate a confidence value based on measurements of the distances between facial landmarks such as the centers of a user s eyes and the base of the user s nose. The geometric consistency score may be based on a likelihood that the distances between the landmarks are consistent with those of a human face. Each of the face detection confidence score facial landmark confidence score and the geometric consistency scores may indicate whether or not captured image is of high or low quality. The geometric consistency and facial landmark detection scores are further described below with respect to .

Based on the one or more confidence scores that mobile computing device determines mobile computing device may determine an image quality score based at least in part on a combination of the facial detection confidence score the facial landmark detection confidence score and the geometric consistency score. Mobile computing device may also consider other signals when determining the image quality score. Based in part on the image quality score mobile computing device may classify a quality of captured image . As an example mobile computing device may classify captured image as good quality or poor quality based on the image quality score.

Mobile computing device may take a variety of actions responsive to determining a quality of captured image . As an example whether mobile computing device determines that captured image is of high or low quality mobile computing device may output captured image via GUI . In some examples mobile computing device may reject an image classified as a poor quality image and alert that user via message box that captured image has been rejected. Rejecting an image refers to discarding the poor quality image and not performing a comparison of captured templates with the templates of template repository . Mobile computing device may further output recommended actions to increase the quality of future captured images. Some suggestions may include telling the user to hold mobile computing device in alignment with the face of user and instructing user not to tilt his or her head to one side or the other or up and down.

In an example mobile computing device may also output indications of the locations of each eye and the nose base of the template. More specifically mobile computing device may output a graphical indication such as a circle dot square or any other indication that illustrates to user where mobile computing device detected that the eyes and nose of user are located in captured image . The graphical indications may be overlaid atop of captured image so as to give user a better of idea of why captured image was rejected. In various examples where captured image is rejected computing device may update GUI to include alternative authentication methods such as a password screen or a pattern authentication screen in which user draws a pattern or shape on the screen to grant user access to the resources of mobile computing device .

As shown in the specific example of mobile computing device includes one or more processors one or more network interfaces one or more storage devices one or more input devices one or more output devices a template repository and one or more power sources . Mobile computing device also includes one or more operating systems that are executable by mobile computing device .

Facial recognition module may include confidence score module . Confidence score module may analyze the values produced by facial recognition module such as a value indicating a likelihood that a user s face has been detected the likelihood that a user s face and facial features have been detected and the distance between the facial features of the user in order to determine one or more confidence scores and an image quality score.

Mobile computing device may further include one or more applications which the one or more processors may execute. Each of components and may be interconnected physically communicatively and or operatively for inter component communications. One or more processors in one example may be configured to implement functionality and or process instructions for execution within mobile computing device . For example one or more processors may be capable of processing instructions stored on storage devices .

One or more storage devices may be configured to store information within mobile computing device during operation. For instance storage device may include a memory. Storage device in some examples is described as a computer readable storage medium. In some examples storage device may be a temporary memory meaning that a primary purpose of storage device is not long term storage. Storage device may also in some examples be described as a volatile memory meaning that storage device does not maintain stored contents when the computer is turned off. Examples of volatile memories include random access memories RAM dynamic random access memories DRAM static random access memories SRAM and other forms of volatile memories known in the art. In some examples storage device may be used to store program instructions for execution by processors . Storage device may be used by software or applications running on mobile computing device e.g. one or more of applications to temporarily store information during program execution. In some examples facial recognition module may comprise one or more of applications . In some examples a user may download and install the application for example from an app store. Once installed the application may execute in order to authenticate a user via facial recognition in order to allow or deny user access to the resources of mobile computing device .

Mobile computing device in some examples also includes one or more network interfaces . Mobile computing device in one example utilizes one or more network interfaces to communicate with external devices via one or more networks such as one or more wireless networks. Network interface may be a network interface card such as an Ethernet card an optical transceiver a radio frequency transceiver or any other type of device that can send and receive information. Other examples of such network interfaces may include Bluetooth 3G 4G and WiFi radios in mobile computing devices as well as USB. In some examples mobile computing device utilizes network interface to wirelessly communicate with an external device such as a server a mobile phone or other networked computing device.

Mobile computing device in one example also includes one or more input devices . Input devices in some examples may be configured to receive input from a user through tactile audio or video input. In the example of input devices may include at least one camera such as camera . Camera may be a front facing or rear facing camera. Responsive to user input or application input camera may capture digital images which may be stored on storage devices . In some examples camera may be used to capture images which mobile computing device may use to generate templates such as captured templates as part of performing facial recognition. One or more input devices may also be output devices. Examples of input device include a presence sensitive screen a mouse a keyboard a voice responsive system video camera microphone or any other type of device for detecting a command from a user. In some examples a presence sensitive screen includes a touch sensitive screen.

A presence sensitive screen is a screen such as a liquid crystal display LCD plasma screen cathode ray tube CRT or other display which may detect when a user such as user is present at a computing device such as mobile computing device . The presence sensitive screen may include one or more cameras or other sensing devices for detecting the presence of the user. The presence sensitive screen may also detect one or more movements of the user such as a gesture or other motion made by the user. In response to the presence of a user or an action or gesture made by the user the computing device may take one or more actions.

One or more output devices may also be included in mobile computing device . Output devices in some examples may be configured to provide output to a user using tactile audio and or video output. One or more output devices may also be input devices. Output device in one example includes a presence sensitive screen a speaker a motor and may utilize a sound card a video graphics adapter card and or any other type of device for converting a signal into an appropriate form understandable to humans or machines. Additional examples of output device include a touch sensitive screen CRT monitor an LCD and or any other type of device that can generate output to a user.

Mobile computing device in some examples may include one or more power sources which may be rechargeable and provide power to mobile computing device . One or more power sources may be internal to mobile computing device such as a battery or may be an external power source. In some examples where one or more power sources are one or more batteries the one or more batteries may be made from nickel cadmium lithium ion or other suitable material.

Mobile computing device may include one or more operating systems . Operating systems in some examples may control the operation of components of mobile computing device . For example operating systems in one example facilitates the interaction of facial recognition module which may further include confidence score module with processors network interfaces storage devices input devices output devices and power sources . If mobile computing device includes more than one operating system mobile computing device may run one operating system and switch between others and or may virtualize one or more of operating systems .

As shown in facial recognition module may include confidence score module . Confidence score module may include program instructions and or data that mobile computing device may execute. For example confidence score module may include instructions that cause facial recognition module executing on mobile computing device to perform one or more of the operations and actions described in the present disclosure.

In some examples facial recognition module along with template repository and confidence score module may be a part of operating system . In some examples facial recognition module may receive user input from one or more of input device and or camera . Facial recognition module may for example receive captured templates of as part of performing facial recognition. Facial recognition module may comprise instructions that cause the one or more processors to analyze the captured template. In some examples confidence score module may determine one or more confidence scores based on the captured templates . The confidence scores may include a face detection confidence score one or more facial landmark detection confidence scores and a geometric consistency score as described above. Based on the values of the one or more confidence scores confidence score module may determine an image quality score for captured templates . In some examples the image quality score may comprise a weighted average of the face detection confidence score one or more facial landmark detection confidence scores and the geometric consistency score. Facial recognition module may further determine an image quality for captured image . In some examples facial recognition module may classify captured image as either good or poor quality. In an example if any of the face detection confidence score one or more facial landmark detection confidence scores and the geometric consistency score fall below a certain threshold then the image quality score may indicate that the captured image is of poor quality. In some other examples facial recognition module may reject captured image when captured image is classified as a poor quality image.

In the event that a user attempts to authenticate with mobile computing device via facial recognition but is not authorized e.g. due to the determination that captured image is of low quality facial recognition module may deny user access to the resources of mobile computing device such as storage devices input devices network interfaces output device etc. Facial recognition module may further discard captured image and any captured templates . Facial recognition module may also update GUI to indicate a problem with captured templates to user of .

In some examples if facial recognition module determines that captured image exhibit pitch yaw and or roll mobile computing device may update GUI of with information that captured image suffers from the one or more of yaw pitch or roll. Facial recognition module may determine that captured image suffers from pitch yaw and or roll based on the values of the facial landmark detection confidence score facial detection confidence score and the geometric consistency score. As an example if captured image has a low geometric consistency score caused by the eyes of user being too close together facial recognition module may determine that captured image exhibits yaw.

In another example if facial recognition module determines that captured image has a low geometric consistency score due to the eyes of user being at an angle with respect to one another facial recognition module may determine that captured image exhibits roll. Facial recognition module may also determine that captured image exhibits excessive pitch based in part on the geometric consistency score and the geometric relationship between the eyes and nose of user . Pitch yaw and roll detection are described below with respect to .

In some examples mobile computing device may display captured image to user via GUI . In some examples facial recognition module may determine that captured image suffers from pitch and may reclassify captured image as having poor quality. In some examples facial recognition module may also alert user that image is of low quality based on the values of a confidence score. In an example GUI may be updated to alert user that facial recognition module could not detect the face of user his or her facial features and or that the distance between the features of user was not consistent with that of a normal person s facial features. In an example mobile computing device may also output captured image to user via GUI .

If captured image is of high quality facial recognition module may take different actions based on whether or not user is engaged in the authentication phase or the enrollment phase. If user is engaged in the enrollment phase facial recognition module may store captured templates based on captured image in template repository . If user is engaged in the authentication phase facial recognition module may compare captured templates with one or more templates from template repository to determine whether captured templates match one or more of the templates stored in template repository . If the features of captured templates do match one or more of the templates of template repository facial recognition module may grant user access to the resources of mobile computing device . If the features of captured templates do not match one or more images of template repository facial recognition module may deny user access to the resources of mobile computing device such as storage devices input devices network interfaces output device etc.

Responsive to denying user access to the resources of mobile computing device and or alerting user to issues with captured image either due to captured templates being of low quality or because captured templates fail to match one or more of the images of template repository facial recognition module may allow user to use camera to acquire another image of user . If the newly acquired image is of high quality the image may be used e.g. for the purposes of enrollment and any templates derived from the new image may be stored in template repository . If the image is of low quality and the newly captured image does not match one or more of the templates of template repository e.g. in the authentication phase user may be denied access to the resources of mobile computing device and may be denied additional attempts at authenticating to mobile computing device via facial recognition. In some examples after user is denied access GUI may update to display an additional mechanism for authenticating with mobile computing device which may include a pattern unlock screen a numerical password screen or any other method of authenticating with a computing device.

In various examples facial recognition module confidence score module and or template repository may expose propagate and or make available various application programming interfaces APIs and or resources such as templates functions for computing various confidence and image quality scores and for performing image comparisons and other functions and resources that may be used in performing facial recognition and or facial image quality assessment in accordance with techniques of this disclosure. The APIs and functions may be made available to end users such as third party developers such that the developers may utilize the available propagated functions and the functionality of the facial recognition module confidence score module and or template repository . The APIs and functions may be made available using Java Python C C and or any other functional or imperative programming languages as well as native assembly languages and or graphics programming languages.

As described with respect to and illustrated with respect to the facial images captured by camera may suffer from pitch roll and or yaw. With regard to facial recognition pitch roll and yaw may refer a rotation of a user s head about a particular axis. In general roll may refer to a head that is rotated about its vertical axis which is also referred to as rotating the head from side to side. Pitch may refer to a user moving his or her head up and down as if the person were nodding. Yaw may refer to a user rotating his or her head side to side through a vertical axis and with the rotation being in line with a horizontal plane running one ear of the user to the other.

Facial image A is an example of where the head of user is properly aligned. There is no rotation and the face of the user is squarely in alignment with the camera. Facial images B and C illustrate pitch. In facial image B a user s face is tilted up and away from camera . In image C the user s face is tilted down and toward camera . Facial images D and E illustrate roll. In image D the face of user is tilted to the left and in image E the image of user is tilted to the right of camera . Images F I illustrate captured images where the face of user is yawed relative to camera . In image F the head of user is rotated to the left of camera and in facial image G the face of user is also rotated to the left but less so than in facial image F. In image H the face of user is rotated to the right and in facial image I the face of user is rotated even further to the right than in image C.

Techniques of this disclosure are directed toward determining whether a captured image or template used for facial recognition purposes exhibits a large yaw or pitch or roll i.e. the captured image is off axis . A captured image that exhibits a large pitch yaw and or roll may be unsuitable for use with facial recognition. In some examples a captured image that exhibits large yaw may also produce one or more low confidence scores when performing facial recognition.

Because Image A exhibits significant yaw image A may be of low quality and therefore unsuitable for use with facial recognition. As described above mobile computing device may determine that image A is of low quality and reject it from being used during facial authentication. Similarly image A may result in an unsuitable template for use during authentication.

To determine whether images A B are of suitable quality for facial authentication facial recognition module may analyze captured images A and B and produce templates based on captured images A and B. Facial recognition module may base the determination of whether images A or B or templates associated with both of images A B are of low quality based on the values of one or more confidence scores which confidence score module may determine.

Confidence score module may analyze a template to determine a facial detection confidence score. A facial detection confidence score may indicate the likelihood that a face of a person has been detected in a given template. In an example the face detection confidence score value may be based on whether or not facial recognition module is able to determine that a face is present in an image. In an example image A may have a lower face detection confidence score than image B because image A exhibits significant yaw.

In another example confidence score module may determine a facial landmark detection confidence score. The facial detection landmark confidence score may indicate a confidence that various facial features have been detected in an image as described above. In some examples the facial features may include the pupils of the eyes and the base of the nose of a person. However in images exhibiting significant yaw facial recognition module may be less able to detect the eyes and the base of the nose of a user. Because the eyes and base of the nose may be less detectable an image exhibiting yaw may produce a lower facial landmark detection confidence score than an image that does not exhibit significant yaw.

Image A exhibits significant yaw. As a result the eyes A and B of user may not be as easily detected from the template derived from image A as eyes A and B of the template derived from image B. In another example a base of a nose of image A may not as easily be detected as a base of the nose of image B. Because eyes and nose are difficult to detect confidence score module may produce a lower facial feature detection confidence score. In some examples facial recognition module may determine based at least in part on the low facial feature detection confidence score that image A may exhibit significant yaw.

In another example confidence score module may determine a geometric consistency score. Confidence score module may determine the geometric consistency score based on distance measurements taken between facial features of user . The facial features may include a base of the nose and eyes A and B of user . In some examples confidence score module may calculate a distance of a line segment that connects the eyes A B in the image. Confidence score module may also calculate a distance of a line segment that connects the base of the nose and line segment .

Based on a location of the point of intersection of the base of the nose and the line segment connecting the eyes of the user confidence score module may determine that image A exhibits significant yaw. As the distance between line segment that connects the base of nose to line segment connecting eyes moves further away from the midpoint of line segment the geometric consistency score decreases. In an example if the point of intersection between line segment and line segment is between two percentages x and y of the length of the line connecting the eyes confidence score module may produce a geometric consistency score that indicates that image A is of high quality. Confidence score module may further determine a lower geometric consistency score for image A as a yaw angle of the face of user included in image A increases.

Based on one or more low confidence scores facial recognition module may determine that image A exhibits significant yaw. In some examples the confidence scores may comprise a face detection confidence score facial feature confidence detection score and a geometric consistency score. Based on the determination that image A exhibits significant yaw facial recognition module A may update GUI to alert user that image A exhibits significant yaw. Responsive to determining that image A exhibits significant yaw mobile computing device may allow user to use camera in order to capture another image of him or herself. By allowing user to capture another image of him or herself mobile computing device may acquire an image that is of higher quality for the purposes of performing facial recognition.

In some examples mobile computing device may utilize signals in addition to confidence scores in order to determine that image A exhibits significant yaw. Although illustrated as being a single captured image A in various examples a captured image may comprise any image that exhibits significant yaw of any face of any user and or person.

In some examples facial recognition module may determine that image A does not exhibit excessive pitch. Facial recognition module may make this determination based on the ratio between line segment and line segment . In images B and C facial recognition module may similarly determine the ratio between the two line segments and in image B and line segments and in image C. In the case of image B facial recognition module may determine that the image B exhibits excessive pitch based on the ratio between the two line segments and . The ratio that facial recognition module calculates may be smaller in than in because of the shorter distance of segment relative to line segment . In the example of image C facial recognition module may calculate the ratio between line segment and line segment of image C. Based on the calculated ratio facial recognition module may determine that image C exhibits excessive pitch. Facial recognition module may make the determination that image C exhibits excessive pitch based on the determination that the ratio between line segments and is small due to the length of line segment .

In some examples facial recognition module may determine the angle of line segment . Facial recognition module may further determine that line segment does not exceed the threshold angle and therefore that image A does not exhibit significant roll. In images B and C facial recognition module may similarly determine the angle of line segments and relative to horizontal. In the case of image B facial recognition module may determine whether the determined angle of line segment exceeds a threshold maximum angle. If the angle of line segment is greater than the threshold maximum angle facial recognition module may determine that image B is of low quality at least because image B exhibits excessive roll and therefore determine that image B is unsuitable for use in facial authentication. Facial recognition module may perform a similar process with respect to . Specifically facial recognition module may determine the angle of line segment in image C exceeds a threshold maximum angle and therefore may classify image C as a low quality image that is unsuitable for use in facial authentication.

Process may begin when mobile computing device captures an image e.g. captured image . Based on captured image computing device may produce one or more templates e.g. captured templates using camera . . Process may further include confidence score module generating a facial detection confidence score based at least in part on a likelihood that a representation of at least a portion of a face is included in captured image . In some examples the facial detection confidence score may indicate a lower amount of confidence as an absolute value of a yaw angle of the user s face included in the captured image increases.

Process may further include confidence score module of mobile computing device generating a facial landmark detection confidence score based at least in part on a likelihood that representations of facial landmarks are accurately identified in captured image . In some examples the facial landmark detection confidence score may indicate a lower amount of confidence as the absolute value of the yaw angle of the face of user included in the image increases. In some examples the facial landmarks may comprise at least the nose base and each eye of a user e.g. user .

Process may further include confidence score module of mobile computing device generating a geometric consistency score based at least in part on a difference between a point of intersection between a nose base and a line segment that passes through each eye and a midpoint of the line segment of captured image . In some examples the geometric consistency score may indicate a lower amount of consistence as an absolute value of the yaw angle of the face of user included in the image increases or that the representations of facial landmarks have not been located accurately. Process may further include facial recognition module of mobile computing device generating an image quality score based at least in part on a combination of the facial detection confidence score the facial landmark detection confidence score and the geometric consistency score .

Process may further include facial recognition module of mobile computing device classifying a quality of the captured image based in least in part on the image quality score . In some examples process may further include facial recognition module of mobile computing device rejecting the image when the image is classified as a poor quality image. And in some examples when the captured image is classified as a poor quality image output devices of mobile computing device may output an indication that the image was classified as a poor quality image. In an example mobile computing device may output recommended actions to increase the quality of the image when the captured image is classified as a poor quality image.

In some examples the face may be a first face and responsive to the captured image being classified as a good quality image mobile computing device may retrieve a template e.g. one of reference templates that includes at least a portion of a second face. Facial recognition module may further align representations of first face with the second face based at least in part on the facial landmarks of the image and facial landmarks of the template. Facial recognition module may further compare representations of the first face and the second face in order to determine if the representation of the first face matches the representation of the second face and authenticate the user based on the comparison. In a further example a user may be authenticated and granted access to the resources of the mobile computing device when the representations of the first face and the second face are determined to match by facial recognition module . In another example the user may be denied access to the resources of the mobile computing device when the representations of the first face and the second face are determined not to match by facial recognition module .

In an example where the representations of the first face and the second face are determined by mobile computing device not to match the user may be presented with an alternative authentication method to access the resources of mobile computing device . The alternative authentication method may comprise displaying a password screen or a gesture unlock screen or any other method of authenticating a user with a mobile device.

In various examples wherein the image is classified as a good quality image process may further include facial recognition module determining that an amount of pitch of the face in the image is greater than a threshold amount of pitch. Facial recognition module may further reclassify the image as a poor quality image.

In an example process may further include at least one of the facial detection confidence score the facial landmark detection confidence score the geometric consistency confidence score and the image quality score being propagated by mobile computing device via an application programming interface API . In another example process may further include mobile computing device outputting the image. In a further example facial recognition module may cause mobile computing device to output indications of the location of each eye and the nose base of the image.

Techniques described herein may be implemented at least in part in hardware software firmware or any combination thereof. For example various aspects of the described embodiments may be implemented within one or more processors including one or more microprocessors digital signal processors DSPs application specific integrated circuits ASICs field programmable gate arrays FPGAs or any other equivalent integrated or discrete logic circuitry as well as any combinations of such components. The term processor or processing circuitry may generally refer to any of the foregoing logic circuitry alone or in combination with other logic circuitry or any other equivalent circuitry. A control unit including hardware may also perform one or more of techniques of this disclosure.

Such hardware software and firmware may be implemented within the same device or within separate devices to support the various techniques described herein. In addition any of the described units modules or components may be implemented together or separately as discrete but interoperable logic devices. Depiction of different features as modules or units is intended to highlight different functional aspects and does not necessarily imply that such modules or units are realized by separate hardware firmware or software components. Rather functionality associated with one or more modules or units may be performed by separate hardware firmware or software components or integrated within common or separate hardware firmware or software components.

Techniques described herein may also be embodied or encoded in an article of manufacture including a computer readable storage medium encoded with instructions. Instructions embedded or encoded in an article of manufacture including an encoded computer readable storage medium may cause one or more programmable processors or other processors to implement one or more of the techniques described herein such as when instructions included or encoded in the computer readable storage medium are executed by the one or more processors. Computer readable storage media may include random access memory RAM read only memory ROM programmable read only memory PROM erasable programmable read only memory EPROM electronically erasable programmable read only memory EEPROM flash memory a hard disk a compact disc ROM CD ROM a floppy disk a cassette magnetic media optical media or other computer readable media. In general a computer readable storage medium may be any tangible medium that can contain or store a program for use by or in connection with an instruction execution system apparatus or device. Additional examples of computer readable medium include computer readable storage devices computer readable memory and tangible computer readable medium. In some examples an article of manufacture may comprise one or more computer readable storage media.

In some examples computer readable storage media may comprise non transitory media. The term non transitory may indicate that the storage medium is tangible and is not embodied in a carrier wave or a propagated signal. In certain examples a non transitory storage medium may store data that can over time change e.g. in RAM or cache .

Various examples have been described. These and other examples are within the scope of the following claims.

