---

title: System and method for the synchronized transmission of tone sequences
abstract: A computer implemented method for transmitting dual tone multi-frequency (DTMF) tones is disclosed. The method includes sending an indication to a mobile device to start a cyclic ring tone including ring and pause periods. The delay incurred to send a DTMF tone to the mobile device is estimated. The server schedules the transmission of the DTMF tone to be received at the mobile device during a pause period of the cyclic ring tone and the DTMF tone is sent as scheduled.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08483676&OS=08483676&RS=08483676
owner: Research In Motion Limited
number: 08483676
owner_city: Waterloo
owner_country: CA
publication_date: 20120720
---
This application is a continuation of U.S. application Ser. No. 12 693 108 entitled System and Method for the Synchronized Transmission of Tone Sequences and filed on Jan. 25 2010 which is incorporated herein by reference.

The present application relates to voice communications and more particularly to status updating and controlling of voice communications between an enterprise call server and a mobile device.

Private Branch Exchanges PBX have been used to provide enterprise telecommunication capabilities to phones co located with the PBX. More recently PBXes have been implemented using more general purpose computing architectures add in cards and software coincident with the adoption of voice over Internet Protocol VOIP . Still more recently it has become increasingly common to desire to provide enterprise communications capabilities to mobile devices as mobile devices have become an ever more integral means of communication for enterprise workers. In order to provide some services to mobile devices PBXes may need to exchange control and status information with the mobile devices. Communication with mobile devices continues to present challenges that are not of much concern with wired telephony over the PSTN or even in VoIP wired telephony. Therefore continued advancements in such communications continue to be desired.

The following description sets forth examples of aspects relating to providing information such as status and control information from a server e.g. a server functioning as a PBX in that it can provide telephony services to a mobile device. In a particular aspect this disclosure principally is relevant to mobile devices that have trouble detecting Dual Tone MultiFrequency DTMF tones over a voice channel while the devices are producing a DTMF tone that is to be heard locally by a user of the device. For example some mobile devices have difficulty in reliably detecting DTMF tones sent on a voice channel while producing a ring progress tone. Still further although it may be possible in some instances to have a data channel between the server and the mobile device over which most of such status and control information can be transmitted such data channel may not always be available.

Aspects related to these examples will become apparent to those of ordinary skill in the art from a review of the following detailed description in conjunction with the drawings. Embodiments of the present application are not limited to any particular operating system server architecture or computer programming language.

The present application relates to the control status updating and management of communications. Although reference may be made to calls in the description of example embodiments below it will be appreciated that the described systems and methods are applicable to session based communications in general and not limited to voice calls. It will also be appreciated that the systems and methods may not be limited to sessions and may be applicable to messaging based communications in some embodiments.

To initiate communication between mobile devices using mobile private branch exchange PBX server mobility the client server must first be contacted by inputting a desired mobile device phone number. Once a call between a mobile device and the PBX server is connected the server may send messages to perform control and status updating. In some cases the data sent for such control and status updating can be sent by transmitting a dual tone multi frequency DTMF tone sequence over a voice communication path.

For instance if the mobile device does not have access to an active data communication path enterprise call control is performed by transmitting a DTMF tone sequence over a voice communication path. One scenario involves where a mobile device party A can signal a PBX to call a party B device and then bridge the call leg between the PBX and party A and the call leg between PBX and party B. One aspect of call status that is communicated to party A by the PBX is that the party B device has begun to ring. In response the party A device should generate a ring tone which for these purposes comprises a repeating cyclic pattern of ring and pause periods.

In some cases if the PBX wants to send party A further control or status messages using DTMF tones the party A device would be generating the ring tone. It has been found that some devices do not reliability detect such DTMF tones during the ring period. Therefore this disclosure relates to a way to cause a server PBX to schedule DTMF tones over a voice channel so that they are more likely to be processed at the mobile device during a pause period and hence more likely to be detected.

Reference is now made to which shows in block diagram form an example system generally designated for the control and management of communications. The system includes an enterprise or business system which in many embodiments includes a local area network LAN . In the description below the enterprise or business system may be referred to as an enterprise network . It will be appreciated that the enterprise network may include more than one network and may be located in multiple geographic areas in some embodiments.

The enterprise network may be connected often through a firewall to a wide area network WAN such as the Internet. The enterprise network may also be connected to a public switched telephone network PSTN via direct inward dialing DID trunks or primary rate interface PRI trunks.

The enterprise network may also communicate with a public land mobile network PLMN which may also be referred to as a wireless wide area network WWAN or in some cases a cellular network. The connection with the PLMN may be made via a relay as known in the art.

The enterprise network may also provide a wireless local area network WLAN featuring wireless access points. Other WLANs may exist outside the enterprise network . For example WLAN may be connected to WAN .

The system may include a number of enterprise associated mobile devices only one shown . The mobile devices may include devices equipped for cellular communication through the PLMN mobile devices equipped for Wi Fi communications over one of the WLANs or dual mode devices capable of both cellular and WLAN communications. WLANs may be configured in accordance with one of the IEEE 802.11 specifications.

It will be understood that the mobile devices include one or more radio transceivers and associated processing hardware and software to enable wireless communications with the PLMN and or one of the WLANs . In various embodiments the PLMN and mobile devices may be configured to operate in compliance with any one or more of a number of wireless protocols including GSM GPRS CDMA EDGE UMTS EvDO HSPA 3GPP or a variety of others. It will be appreciated that the mobile device may roam within the PLMN and across PLMNs in known manner as the user moves. In some instances the dual mode mobile devices and or the enterprise network are configured to facilitate roaming between the PLMN and a WLAN and are thus capable of seamlessly transferring sessions such as voice calls from a connection with the cellular interface of the dual mode device to the WLAN interface of the dual mode device and vice versa.

The enterprise network typically includes a number of networked servers computers and other devices. For example the enterprise network may connect one or more desktop or laptop computers one shown . The connection may be wired or wireless in some embodiments. The enterprise network may also connect to one or more digital telephone sets one shown .

The enterprise network may include one or more mail servers such as mail server for coordinating the transmission storage and receipt of electronic messages for client devices operating within the enterprise network . Typical mail servers include the Microsoft Exchange Server and the IBM Lotus Domino server. Each user within the enterprise typically has at least one user account within the enterprise network . Associated with each user account is message address information such as an e mail address. Messages addressed to a user message address are stored on the enterprise network in the mail server . The messages may be retrieved by the user using a messaging application such as an e mail client application. The messaging application may be operating on a user s computer connected to the enterprise network within the enterprise. In some embodiments the user may be permitted to access stored messages using a remote computer for example at another location via the WAN using a VPN connection. Using the messaging application the user may also compose and send messages addressed to others within or outside the enterprise network . The messaging application causes the mail server to send a composed message to the addressee often via the WAN .

The relay serves to route messages received over the PLMN from the mobile device to the corresponding enterprise network . The relay also pushes messages from the enterprise network to the mobile device via the PLMN .

The enterprise network also includes an enterprise server . Together with the relay the enterprise server functions to redirect or relay incoming e mail messages addressed to a user s e mail address within the enterprise network to the user s mobile device and to relay incoming e mail messages composed and sent via the mobile device out to the intended recipients within the WAN or elsewhere. The enterprise server and relay together facilitate push e mail service for the mobile device enabling the user to send and receive e mail messages using the mobile device as though the user were connected to an e mail client within the enterprise network using the user s enterprise related e mail address for example on computer .

As is typical in many enterprises the enterprise network includes a Private Branch eXchange although in various embodiments the PBX may be a standard PBX or an IP PBX for simplicity the description below uses the term PBX to refer to both having a connection with the PSTN for routing incoming and outgoing voice calls for the enterprise. The PBX is connected to the PSTN via DID trunks or PRI trunks for example. The PBX may use ISDN signaling protocols for setting up and tearing down circuit switched connections through the PSTN and related signaling and communications. In some embodiments the PBX may be connected to one or more conventional analog telephones . The PBX is also connected to the enterprise network and through it to telephone terminal devices such as digital telephone sets softphones operating on computers etc. Within the enterprise each individual may have an associated extension number sometimes referred to as a PNP private numbering plan or direct dial phone number. Calls outgoing from the PBX to the PSTN or incoming from the PSTN to the PBX are typically circuit switched calls. Within the enterprise e.g. between the PBX and terminal devices voice calls are often packet switched calls for example Voice over IP VoIP calls.

The enterprise network may further include a Service Management Platform SMP for performing some aspects of messaging or session control like call control and advanced call processing features. The SMP may in some cases also perform some media handling. Collectively the SMP and PBX may be referred to as the enterprise communications platform generally designated . It will be appreciated that the enterprise communications platform and in particular the SMP is implemented on one or more servers having suitable communications interfaces for connecting to and communicating with the PBX and or DID PRI trunks. Although the SMP may be implemented on a stand alone server it will be appreciated that it may be implemented into an existing control agent server as a logical software component. As will be described below the SMP may be implemented as a multi layer platform.

The enterprise communications platform implements the switching to connect session legs and may provide the conversion between for example a circuit switched call and a VoIP call or to connect legs of other media sessions. In some embodiments in the context of voice calls the enterprise communications platform provides a number of additional functions including automated attendant interactive voice response call forwarding voice mail etc. It may also implement certain usage restrictions on enterprise users such as blocking international calls or 1 900 calls. In many embodiments Session Initiation Protocol SIP may be used to set up manage and terminate media sessions for voice calls. Other protocols may also be employed by the enterprise communications platform for example Web Services Computer Telephony Integration CTI protocol Session Initiation Protocol for Instant Messaging and Presence Leveraging Extensions SIMPLE and various custom Application Programming Interfaces APIs as will be described in greater detail below.

One of the functions of the enterprise communications platform is to extend the features of enterprise telephony to the mobile devices . For example the enterprise communications platform may allow the mobile device to perform functions akin to those normally available on a standard office telephone such as the digital telephone set or analog telephone set . Example features may include direct extension dialing enterprise voice mail conferencing call transfer call park etc.

Reference is now made to which show example embodiments of the enterprise communications system . Again although references are made below to calls or call centric features it will be appreciated that the architectures and systems depicted and described are applicable to session based communications in general and in some instances to messaging based communications.

In this embodiment the SMP assumes control over both call processing and the media itself. This architecture may be referred to as First Party Call Control . Many of the media handling functions normally implemented by the PBX are handled by the SMP in this architecture. Incoming calls addressed to any extension or direct dial number within the enterprise for example are always first routed to the SMP . Thereafter a call leg is established from the SMP to the called party within the enterprise and the two legs are bridged. Accordingly the SMP includes a digital trunk interface and a digital signal processing DSP conferencing bridge . The DSP conferencing bridge performs the bridging of calls for implementation of various call features such as conferencing call transfer etc. The digital trunk interface may be implemented as a plurality of telephonic cards e.g. Intel Dialogic cards interconnected by a bus and operating under the control of a processor. The digital trunk interface may also be partly implemented using a processor module such as for example a Host Media Processing HMP processor.

The SMP may include various scripts for managing call processing. The scripts are implemented as software modules routines functions etc. stored in non volatile memory and executed by the processor of the SMP . The scripts may implement call flow logic business logic user preferences call service processes and various feature applications.

The call control server is coupled to the PBX for example through the LAN enabling packet based communications and more specifically IP based communications. In one embodiment communications between the PBX and the call control server are carried out in accordance with SIP. In other words the call control server uses SIP based communications to manage the set up tear down and control of media handled by the PBX . In one example embodiment the call control server may employ a communications protocol conforming to the ECMA 269 or ECMA 323 standards for Computer Supported Telecommunications Applications CSTA .

The SIP server interacts with the media server using SIP based media handling commands. For example the SIP server and media server may communicate using Media Server Markup Language MSML as defined in IETF document Saleem A. Media Server Markup Language Internet Draft draft saleem msml 07 Aug. 7 2008. The media server may be configured to perform Host Media Processing HMP .

Other architectures or configurations for the enterprise communications system will be appreciated by those ordinarily skilled in the art.

Reference is now made to which shows another embodiment of the enterprise communications system with a Third Party Call Control architecture. In this embodiment the SMP is a multi layer platform that includes a protocol layer a services layer and an application layer . The protocol layer includes a plurality of interface protocols configured for enabling operation of corresponding applications in the application layer . The services layer includes a plurality of services that can be leveraged by the interface protocols to create richer applications. Finally the application layer includes a plurality of applications that are exposed out to the communication devices and that leverage corresponding ones of the services and interface protocols for enabling the applications.

Specifically the protocol layer preferably includes protocols which allow media to be controlled separate from data. For example the protocol layer can include among other things a Session Initiation Protocol or SIP a Web Services protocol an Application Programming Interface or API a Computer Telephony Integration protocol or CTI and a Session Initiation Protocol for Instant Messaging and Presence Leveraging Extensions or SIMPLE protocol . It is contemplated that the interface protocols are plug ins that can interface directly with corresponding servers in the enterprise network which will be further described below.

For the purposes of this disclosure SIP will be utilized although it is appreciated that the system can operate using the above disclosed or additional protocols. As known by those of ordinary skill in the art SIP is the IETF Internet Engineering Task Force standard for multimedia session management and more specifically is an application layer control protocol for establishing maintaining modifying and terminating multimedia sessions between two or more endpoints. As further known by those of ordinary skill in the art the SIP protocol includes two interfaces for signaling SIP Trunk hereinafter referred to as SIP T and SIP Line hereinafter referred to as SIP L . Specifically the SIP T interface is utilized when the endpoint is a non specific entity or not registered i.e. when communicating between two network entities . In contrast the SIP L interface is utilized when the endpoint is registered i.e. when dialing to a specific extension . The specific operation of the system utilizing SIP will be described in further detail below.

The SMP also includes a plurality of enablers among other things a VoIP enabler a Fixed Mobile Convergence or FMC enabler a conference services enabler a presence enabler and an Instant Messaging or IM enabler . Each of the enablers are used by corresponding services in the services layer that combine one or more of the enablers. Each of the applications in the application layer is then combined with one or more of the services to perform the desired application. For example a phone call service may use the VoIP or PBX enabler and an emergency response application may use the phone call service an Instant Messenger service a video call service and email service and or a conference service.

The application layer may include a conference services application that together with the conference services enabler enables multiple communication devices including desk telephones and personal computers to participate in a conference call through use of a centralized conference server . As seen in the conference server is provided in the enterprise network and is in communication with the conference services enabler preferably through the SIP protocol although it is recognized that additional protocols that control media separate from data may be appropriate such as the Web Services protocol or the CTI protocol . As will be described in further detail below the conference call server is configured for directing media and data streams to and from one or more communication devices i.e. mobile devices telephones and computers .

Turning now to the general operation of the system using SIP as the signaling protocol will be discussed although it is recognized that the present system is not limited to the processes discussed herein. The signaling descriptions that follow are based on Third Party Call Control architecture such as that illustrated in or . It will be appreciated that similar but slightly modified signaling may be used in a First Party Call Control architecture wherein the PBX will pass media through to the SMP for direct media handling by the SMP . Variations in the signaling to adapt to various architectures will be appreciated by those ordinarily skilled in the art.

The SMP then sets up the outgoing call leg to the destination. It does this by sending an invite over SIP L to the PBX with the destination number of the target phone block . SIP L is used so that the call can be correctly attributed to the individual within the organization within any call records that are being maintained by the PBX . When the invite is received the PBX dials the destination number to the target phone block and the target phone answers the call block . When the target phone is answered the PBX sends a 200 OK signal to the SMP indicating that the target phone is ready to receive data block . The SMP then sends an invite over SIP T to the PBX and shuffles the SDP Session Description Protocol as known to those of ordinary skill in the art to connect the call legs block . When the call legs are connected the PBX sends a second 200 OK signal to the SMP block and the users of the device and target phone can communicate with each other.

Note that between the cellular call leg being established and the outgoing call leg being answered the mobile user hears ringing tones. These ringing tones may be provided by the PBX using the presentation of early media from the outgoing call leg or they may be generated locally on the device if early media is not available. In the latter case it will be necessary to localize the ringing tone to match the tone normally heard with a call through the PBX .

The above description is known as a mobile initiated call because the SMP provides the mobile device with the DNIS number into which the mobile device has called. Alternatively the mobile originated call could be PBX initiated as shown in . Specifically in a PBX initiated call upon receipt of the mobile originated call request block the SMP confirms receipt of the call to the mobile device with an ANI number block which the mobile device uses to identify the incoming call from the PBX . The PBX then sends an invite over SIP T to the PBX with the cellular number of the device and the ANI number that is attached to the outgoing call block . Upon receipt of the invite the PBX makes a cellular call to the device block which is answered by the device block . The device checks the ANI number in the incoming call to confirm if the number is actually from the PBX . If the ANI number is stripped for any particular reason then the device may be configured to answer the call as a regular cellular call or it may reject the call as unknown. When the device answers the PBX initiated call the PBX sends a 200 OK signal to the SMP indicating that the call leg to the device is established block .

In response the SMP sends an invite over SIP L with the destination number of the target phone to the PBX block . When the invite is received at the PBX the PBX dials the destination number to the target phone block the target phone picks up the call block and a 200 OK signal is sent from the PBX to the SMP block indicating that the target phone is also ready to receive data. In response to the 200 OK the SMP sends an invite to the PBX shuffling the SDP to connect the call legs block . Finally when the call legs are connected the PBX sends a second 200 OK signal to the SMP and the users of the device and target phone are able to communicate with each other.

In both instances the SMP is performing third party call control of the two call legs the PBX remaining in control of the call. The decision of whether to proceed with a mobile initiated call or a PBX initiated call can be set by policy. Specifically the option to select either mobile initiated or PBX initiated calls is a feature provided in the SMP and an administrator for the enterprise network can determine which setting to use. For example in some cases it may be more cost effective for the corporation to utilize PBX initiated calls rather than mobile initiated calls and vice versa. However it is appreciated that the system is not limited to the above processes.

In response to the invite the SMP sends a call request with the DNIS number and source details to the device block which is confirmed to the SMP block . In addition to confirming the call the mobile device sends a cellular call to the DNIS number at the PBX block . Again as the DNIS number is routed in the dialing plans to the SMP upon receipt of the cellular call the PBX sends an invite over SIP T to the SMP with the DNIS number block . In response to the invite a 200 OK signal is sent over SIP T from the SMP to the PBX acknowledging that the call leg to the mobile device is established block . Finally the initial invite block is acknowledged with the 200 OK signal with the cellular SDP at which point the call legs are joined and the target phone and device can communicate with each other on the call.

The diagram shown in illustrates a mobile initiated call because as discussed above with respect to the SMP presents the mobile device with the DNIS number at the PBX into which to call. However it is also possible to employ a PBX initiated mobile terminated call as shown in where the PBX sends an incoming call to the device with the ANI number of the target phone .

Specifically similar to the mobile initiated call described above and shown in the target phone sends an incoming call to the destination number of the device which is received at the PBX block . Upon receipt of the call the PBX sends an invite over SIP L to the SMP block with the source number of the target phone . In response to the invite the SMP sends a call request with the source number to the device block with the ANI number the device should expect in the incoming call the call request being confirmed by the device block . At this point in the PBX initiated call the SMP sends an invite over SIP T to the PBX with the cellular number and ANI number to use block prompting the PBX to make a cellular call to the device with the ANI number block prompting the device to ring. The device answers the call block and a 200 OK signal is sent from the PBX to the SMP acknowledging that the cellular call leg to the device is established block . In response a 200 OK signal is also sent from the SMP to the PBX acknowledging that the call leg to the target phone is also established block . The SMP shuffles the SDP to connect the call legs the call legs are joined and the target phone and device can communicate with each other on the call.

As discussed above with respect to the SMP remains in control of the signaling between the target phone and the mobile device in both the mobile initiated and PBX initiated calls. Again the decision to proceed with a mobile initiated call or a PBX initiated call is based on policy and may be set by a system administrator. In some cases it may be more efficient or cost effective for the administrator to decide that PBX initiated calls should be used and in other cases it may be more efficient or cost effective for mobile initiated calls to be utilized. As these policy decisions may vary by organization and are not imperative to the scope of the present application they will not be discussed in further detail.

Server also comprises a mass storage module and a processing module . The processing module may include a programmable processor and memory to be used during processing such as cache memories . Processing module can be operatively coupled to local output module such as to display to display output thereon.

Mass storage can be composed of a Random Access Memory and of non volatile memory . Non volatile memory can be implemented with one or more of Flash memory PROM EPROM and so on. Non volatile memory can be implemented as flash memory ferromagnetic phase change memory and other non volatile memory technologies. Non volatile memory also can store programs device state various user information one or more operating systems device configuration data and other data that may need to be accessed persistently.

Call module identifies a logical organization of modules which can be used for implementing aspects described herein. A speech coder can do one or more of coding and decoding speech obtained and transmitted on the voice channel . Speech coder can provide inputs to a voice channel processing layer . Both data channel processing layer and voice channel processing layer can send and receive data to and from transport protocol s layer which in turn communicates with MAC PHY . Control module can control functionality of the call module in response to commands received through voice channel . Status information received through voice channel also can be used in updating outputs or other information for a user of device . Control module can provide outputs to and receive inputs from user interface UI which can comprise a display speech output a speaker and so on.

In particular DTMF tones transmitted to device over the voice channel are received at the DTMF tone receiver . A tone buffer may store tones for reception and also can be used for storing tone data that will be used by DTMF tone synthesizer for synthesizing tones to be transmitted over voice channel . Thus by way of explanation a tone transmitted from server transits voice channel enters device through MAC PHY through voice channel processing and is decoded by DTMF tone receiver which can provide information encoded in such tone or tones to control module which can use that information. Tone buffer can be used both by receiver and by synthesizer and in some instances these aspects are directed to situations where tone buffer is being used by synthesizer during certain times to generate a ring tone and during those times receiver will have difficulty recognizing DTMF tones that may arrive from voice channel .

A computer readable medium e.g. mass storage can store instructions for programming the processor within the server to transmit DTMF tones to the mobile device over voice channel established using a communications network. The processor sends a ring tone start indication from the communication module over the voice channel and to the mobile device . The ring tone start indication may include a DTMF tone that triggers the mobile device to start the cyclic ring tone. The cyclic ring tone may include a series of ring and pause periods.

The processor estimates a delay incurred between the time at which the ring tone start indication is sent to the mobile device and the time at which the cyclic ring tone starts. The delay may include a network transmission delay incurred during transmission of the ring tone start indication from the server over the voice channel and to the mobile device . The network transmission delay may be empirically estimated on the enterprise network or another network with the use of test software. A default network transmission delay may also be assumed.

The delay may also include a processing delay incurred during processing of the ring tone start indication at the mobile device . The processing delay may include the time required for the ring tone start indication to travel through the voice channel processing layer and the tone receiver and the time required to synthesize the ring tone start indication at the tone synthesizer before it is sent to the control module . The processor can estimate a cyclic ring tone start time by recording the initial transmission time of the ring tone start indication and adding the delay incurred to send the indication and start the cyclic ring tone at device .

The processor can schedule the transmission of a DTMF tone to be received at the mobile device . The algorithm is used to estimate when the DTMF tone will arrive at the mobile device based on the cyclic ring tone start time the estimated delay and the cadence of ring and pause periods of the cyclic ring tone. The cadence of ring and pause periods of the cyclic ring tone may be determined by sending a description of the cadence of the ring and pause periods of the cyclic ring tone from the mobile device to the server for processing. A default cadence of ring and pause periods of the cyclic ring tone may also be assumed. If the DTMF tone is estimated to arrive at the mobile device during a pause period then the server sends the DTMF tone over the voice channel to the mobile device as scheduled. If the DTMF tone is estimated to arrive at the mobile device during a ring period then the server reschedules the transmission of the DTMF tone to the mobile device to be received during a pause period. The DTMF tone is sent to the mobile device as rescheduled over the voice channel .

In step the server estimates a delay incurred between the time the ring tone start indication is sent to the mobile device and the time at which the cyclic ring tone starts. The delay may include a network transmission delay incurred during transmission of the ring tone start indication from the server to the mobile device. The network transmission delay may be empirically estimated on the enterprise network or another network with the use of test software. A default network transmission delay may also be assumed. The delay may also include a processing delay incurred during processing of the ring tone start indication at the mobile device. In step a cyclic ring tone start time at which the cyclic ring tone begins is estimated by recording at the server an initial transmission time at which the ring tone start indication is sent and by adding the delay incurred. An exemplary algorithm for calculating the cyclic ring tone start time is as follows 

In step the server schedules the transmission of a DTMF tone to be received at the mobile device. In step the server estimates an arrival time of the DTMF tone at device here arrival meaning that device has received and processed the tone so that it can be outputted or otherwise used in control functions . In step the server determines based on the estimated arrival time of the tone whether the DTMF tone will arrive at device while device is outputting a ring tone. Examples of how such a determination can be made are described in further detail below. In general the determination is made based on the cyclic ring tone start time the estimated delay and the cadence of ring and pause periods of the cyclic ring tone.

The cadence of ring and pause periods of the cyclic ring tone may be determined by sending a description of the cadence of the ring and pause periods of the cyclic ring tone from the mobile device to the server. A default cadence of ring and pause periods of the cyclic ring tone may also be assumed. If the DTMF tone is estimated to arrive at the mobile device during a pause period then the server sends the DTMF tone to the mobile device as scheduled in step . If the DTMF tone is estimated to arrive at the mobile device during a ring period then the server reschedules the transmission of the DTMF tone to the mobile device to be received at the mobile device during a pause period in step . In step the DTMF tone is sent to the mobile device as rescheduled.

For step an exemplary algorithm for scheduling and rescheduling the transmission of a DTMF tone to a mobile device is as follows 

In accordance with the embodiment illustrated in the algorithm may be extended to reschedule the transmission to any pattern of cyclic ring tone. The server can record the cyclic ring tone start time time that the server estimates device started to ring in response to a signal e.g. a tone to do so with the use of the following algorithm 

The cadence of ring and pause periods of the cyclic ring tone may be determined by providing a description of the cadence of the ring and pause periods of the cyclic ring tone to the server. A default cadence of ring and pause periods of the cyclic ring tone may also be assumed. An exemplary algorithm describing the cadence of a cyclic ring tone including ring periods and pause periods is as follows 

The cyclic ring tone may have any number of ring and pause periods per cycle and more generally pause period timing per cycle may be calculated with the following algorithm ring pause period ring duration pause duration .

The server schedules the transmission of a DTMF tone to be received at the mobile device by first estimating the time within a cycle within a frame of a cycle at which the tone will arrive at the mobile device by using the following algorithm because the ring tone repeats a modulo calculation provides the time within a given cycle at which the tone will be expected to arrive 

To determine if the transmission of the DTMF tone should be rescheduled the server determines if the estimated arrival of the tone overlaps with any ring periods of the cyclic ring tone by using the following algorithm 

If the DTMF tone is estimated to arrive at the mobile device during a ring period the server reschedules the transmission of the tone to arrive at the device during a pause period by using the following algorithm 

The above formulas and other pseudocode are exemplary and those of ordinary skill in the art would be able to use these examples to produce adaptations and changes to arrive at particular variations that remain within the scope of these disclosures.

Also block diagrams and examples of system components and functional modules were provided as examples and not by way of any express or implied limitation as to how any aspect disclosed can be practiced in a particular embodiment.

The above description occasionally describes relative timing of events signals actions and the like as occurring when another event signal action or the like happens. Such description is not to be construed as requiring a concurrency or any absolute timing unless otherwise indicated. Certain adaptations and modifications of the described embodiments can be made. Aspects that can be applied to various embodiments may have been described with respect to only a portion of those embodiments for sake of clarity. However it is to be understood that these aspects can be provided in or applied to other embodiments as well. Therefore the above discussed embodiments are considered to be illustrative and not restrictive.

