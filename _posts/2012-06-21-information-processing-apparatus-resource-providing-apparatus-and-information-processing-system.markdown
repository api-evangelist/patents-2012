---

title: Information processing apparatus, resource providing apparatus, and information processing system
abstract: There is provided an information processing apparatus which the communication unit receives a usage request of a resource described in a first format from a program providing apparatus, the conversion unit identifies a resource providing apparatus having the resource as indicated and converts the usage request described in the first format into the usage request described in a second format that can be interpreted by the resource providing apparatus identified, the communication unit transmits the usage request described in the second format to the resource providing apparatus and receives a processing result of the usage request described in the second format from the resource providing apparatus, the conversion unit converts the processing result described in the second format into the processing result described in the first format, and the program execution unit performs an operation according to the processing result described in the first format.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09122544&OS=09122544&RS=09122544
owner: KABUSHIKI KAISHA TOSHIBA
number: 09122544
owner_city: Tokyo
owner_country: JP
publication_date: 20120621
---
This application is based upon and claims the benefit of priority from the prior Japanese Patent Application No. 2011 177660 filed on Aug. 15 2011 the entire contents of which are incorporated herein by reference.

Embodiments described herein relate to an information processing apparatus a resource providing apparatus and an information processing system.

W3C Device API is a technique for accessing an internal resource function or information of a terminal such as PC and smartphone via a Web page on a site operated by a service provider. A typical example is Geolocation API that accesses GPS information in a smartphone to make it possible to provide services based on locational information. As an example of the Device API technique here indicates a technique that uses an internal function of a terminal which basically cannot be used from a Web page a technique is known in which UPnP function that realizes Plug and Play of a rooter and an AV device on a home network is used from a Web page. When this technique is used it is possible to realize mash up cooperation of a Web page provided by a service provider and a home appliance resource on a home network.

A Web browser acquires components included in Web contents from a site on a network and displays the Web contents. In this case an optimization method is known in which only the data to be displayed is acquired from a server and layout information and templates of static image data are previously cached.

However when the technique described above is used the service provider directly accesses devices on a home network via a Web page so that there are some problems.

First the service has to know the presence of a device to be accessed a resource providing apparatus . In other words a device including Web browser such as a PC and a smartphone has to disclose device information on the home network to the service.

Second the service has to use access methods that may be different for each device on the home network.

The above problems will be described with reference to a specific example. For example a case is considered in which a service provider operates an electronic program guide service on the Internet. It is assumed that a recording reservation button is set in each program field in the displayed electronic program guide on a Web page of the electronic program guide service and when a user displays the electronic program guide service on a Web browser in a home PC and presses the recording reservation button the user can make a recording reservation of the program on a digital TV in home.

At this time when realizing this use case by the technique described above a program JavaScript script code embedded in the Web page of the electronic program guide service directly uses a function of DLNA Digital Living Network Alliance from the Web page. Therefore the presence of the digital TV on the home network on which the PC is installed is detected by DLNA Discovery detailed information of the detected digital TV is directly acquired from the digital TV by DLNA Description and a DLNA Action command for the recoding reservation is transmitted so that the recording reservation from the Web page is realized.

However in the series of sequences the program provided by the service provider can easily acquire a list of devices located on user s home network and detailed information of the devices. In other words if a logic that the program uploads acquired information to a server of the service provider is embedded personal information what devices the user has and the like is leaked to the service provider.

Further if devices that use other protocols such as ECHONET in addition to DLNA are to be operated the above described program has to include codes compatible with a plurality of protocols. In particular the types of devices present on home networks are unknown so that the service provider has to handle all transmission protocols and further all authentication permission methods that may be supported by the devices. Thus the service provider has to spend high development costs.

As described above in the conventional art there is a problem that the service provider has to know the presence of the devices to be accessed.

According to an embodiment there is an information processing apparatus including a communication unit a program execution unit and a conversion unit.

The communication unit communicates with a program providing apparatus and a resource providing apparatus and receives a usage request of a resource described in a first format from the program providing apparatus.

The conversion unit identifies a resource providing apparatus having the resource indicated by the usage request and converts the usage request described in the first format into the usage request described in a second format that can be interpreted by the resource providing apparatus identified.

The communication unit transmits the usage request described in the second format to the resource providing apparatus identified by the conversion unit and receives a processing result of the usage request described in the second format from the resource providing apparatus.

The conversion unit converts the processing result described in the second format into the processing result described in the first format.

The program execution unit performs an operation according to the processing result described in the first format.

First a user browses a Web page of a service the electronic program guide service described above on the Internet and presses a record button of a program field of which the user wants to make a recording reservation. When the button is pressed JavaScript code embedded in the Web page being browsed is executed and recording reservation function at PC peripheral AV device is called as an internal function of a PC. As an internal process in the PC actually an NPVR Network Personal Video Recorder network recording reservation cloud service on the Internet is used and a specified program is recorded on the cloud service.

In the use case described above the PC is an information processing apparatus according to the present embodiment the electronic program guide service is a program providing apparatus and the NPVR service is a resource providing apparatus. Hereinafter the details of the present embodiment will be described.

The network is the Internet or an IP Internet. Protocol network such as NGN Next Generation Network which is a quality guaranteed closed network. In the present embodiment the network is assumed to be the Internet.

The information processing apparatus has a normal computer hardware configuration including a CPU a main storage an auxiliary storage and I O interfaces such as a display and keyboard. Specifically the information processing apparatus is a PC a smartphone a slate device or the like. In the present embodiment the information processing apparatus is assumed to be a laptop PC.

The program providing apparatus an access request source or access requestor also has a normal computer hardware configuration in the same manner as the information processing apparatus . Specifically the program providing apparatus is a digital home appliance a PC or a server apparatus. In the present embodiment the program providing apparatus is a server apparatus used in a data center or the like. The program providing apparatus provides Web services sites on the Internet. Specifically it is assumed that the program providing apparatus provides the electronic program guide service described above. It is assumed that this service can make a recording reservation on a device or an external service on which a recording reservation can be made and which is owned by a user who browses an electronic program guide.

The program provided by the program providing apparatus is a JavaScript program embedded in an HTML Hyper Text Markup Language document. Or the program may be Flash contents. The program is not limited to existing web contents and may be a program based on another markup language such as XML and BML Broadcast Markup Language and a program description language other than JavaScript. In the present embodiment the program is assumed to be a JavaScript program.

The resource providing apparatus also has a normal computer hardware configuration in the same manner as the program providing apparatus . Specifically the resource providing apparatus is a PC or a server apparatus. In the present embodiment the resource providing apparatus is a server apparatus used in a data center or the like. The resource providing apparatus provides NPVR services on the Internet. The NPVR service is assumed to be a service in which a member user of the service can make a recording reservation of a TV program into a storage on the server.

The resource provided by the resource providing apparatus is assumed to be functions and information in an apparatus. The resource is accessed via an API Application Programming Interface which the resource providing apparatus makes public to the outside of the apparatus. In the present embodiment the resource is provided via Web API made public on the Internet.

Next various functions realized when the CPU of the information processing apparatus executes various programs stored in the main storage and the auxiliary storage will be described with reference to . The information processing apparatus includes a first communication unit a program execution unit a GUI display unit a GUI operation unit a device information storage and a conversion unit . These units are generated on the main storage such as a RAM when the CPU executes a program. The execution program of the CPU is stored in a recording medium such as a hard disk and a CD ROM. The execution program is read from the recording medium and developed on the main storage. The execution program may be downloaded to the information processing apparatus via a network such as the Internet.

Among these units the device information storage is a database management system. This may be a relational database or may be an XML eXtensible Markup Language database. The device information storage need not be constructed by a single database management system but may use a plurality of database management systems in parallel. The device information storage may be constructed on a single physical storage or may be a database management system configured by a plurality of physical auxiliary storages such as NAS Network Attached Storage and SAN Storage Area Network . A data storage area may be non volatile or volatile. If the device information storage has a means that can obtain an information unit entry of data stored in each storage the device information storage may be a simple data management module based on a list structure generated on the main storage when the CPU executes a program may be a management module of a CSV format file or may include a Key Value store.

The first communication unit communicates with the program providing apparatus and the resource providing apparatus on a first network. The first communication unit receives a request from the program execution unit transmits a request of Web contents such as an HTML document including a program to the program providing apparatus and receives the Web contents the Web contents may be contents of other formats as described above . The first communication unit transmits a resource usage request inputted from the conversion unit to the resource providing apparatus and receives a processing result of the resource providing apparatus . A communication protocol with the program providing apparatus and the resource providing apparatus may be based on a TCP protocol such as HTTP and FTP or may be based on a UDP protocol such as RTP and FLUTE. The communication protocol is not limited to a specific protocol. In the present embodiment the first communication unit is an HTTP client communicating with the program providing apparatus and the resource providing apparatus by HTTP S .

The program execution unit processes the Web contents including a program received from the program providing apparatus . The program execution unit inputs a resource usage request embedded in the program to the conversion unit . The format of the resource usage request corresponds to a first format. In the present embodiment and all the embodiments described later the program execution unit is a Web browser engine. However the program execution unit is not limited to a Web browser but may be a BML browser or another application platform including an execution environment of the program. When the program execution unit is a Web browser the resource usage request is a JavaScript API call that realizes an access to an internal resource in the information processing apparatus or a message transmission using a communication API that can be called from a Web browser such as AJAX and WebSocket. In the present embodiment the resource usage request is assumed to be realized as a JavaScript API call. In the present embodiment it is assumed that for example the JavaScript API PVRDevice.reserve as described below is called as the JavaScript program called when the recording reservation button is pressed.

The parameters included in this function are a set of identification information that specifies a TV program. The program execution unit outputs identification information of the API an API name PVRDevice.reserve and the like as the API identification information and parameter information network id service id transport stream id and event id to the conversion unit described later.

The GUI display unit performs rendering to the display included in the information processing apparatus by a command from the program execution unit . When the GUI display unit needs selection acceptance of a user the GUI display unit displays an interface of selection acceptance pop up screen or the like according to a request from the conversion unit via the program execution unit .

The GUI operation unit outputs an operation signal inputted via a keyboard a mouse or a touch panel included in the information processing apparatus to the program execution unit . The program execution unit converts the operation signal into a selection acceptance result of the user this is a function of the Web browser .

The device information storage stores information of the resource providing apparatus as device information. The device information may be inputted by the user via the GUI of the information processing apparatus . When the service is not a service on a home network but a service on the Internet as in the present embodiment the device information may be preset in the apparatus or may be accumulated in the information processing apparatus when joining and registering in the service. shows an example of a data structure according to the present embodiment. As shown in the device information includes a device identifier a common API identifier a location of a device dependent API conversion rule information conversion mechanism to a device dependent API. Here these attributes included in the device information will be described.

First the device identifier is information for identifying a device that is the resource providing apparatus. The device identifier may be information having any format which can uniquely identify the resource providing apparatus such as a URI Universal Resource Identifier a UUID Universal Unique Identifier a MAC Media Access Control address a combination of a type name and a production number of the device and an IPv6 address. In the present embodiment the device identifier is a URI that specifies the device an NPVR service in the present embodiment .

The common API identifier is information for identifying the JavaScript API through which the program providing apparatus sends a resource usage request. The API is premised on that the information processing apparatus and the program providing apparatus share a common specification. Therefore it is assumed that the API specification is standardized or a manufacturer of the information processing apparatus which accesses the resource providing apparatus by proxy defines a proprietary API specification and makes the specification public. Under this assumption the API identifier may be information having any format if the information processing apparatus can uniquely identify each common API by the information. If the API is an open proprietary API of a device manufacturer a unique number is given to the open API and the number may be used as the API identifier. In the present embodiment a method character string class name.method name of an API is used as the API identifier PVRDevice.reserve as a recording reservation function of a device having a recording reservation function .

The device dependent API location is information that indicates a location of an individual API of the resource providing apparatus corresponding to the common API described above. The device dependent API location may have a different format for each resource providing apparatus. In the present embodiment the device dependent API location is a URI http npvr.service.com webapi reserve indicating a Web API provided by the NPVR service.

The conversion rule to a device dependent API is information for converting a resource usage request first format using a common API into an actual resource usage request second format of each device dependent API. The conversion rule to a device dependent API is used by the conversion unit . The conversion rule information may include for example sequence information of arguments correspondence table information of argument formats and correspondence table information of return value information formats and error codes or may be an implementation of the common API itself internally converted into a device dependent API call. The conversion rule information may have any format if the conversion rule information includes minimum information which can convert a common API call into a device dependent API call. In the present embodiment as illustrated in the conversion rule information has a conversion table of arguments for request and a format conversion table of response code message for response.

Although the information accumulated by the device information storage is as shown in in the present embodiment the information is not limited to the data structure shown in . The information may include other information. For example it is assumed to manage information necessary to use a resource depending on a protocol supported by a device or manage version information assuming a revision of API. The information may be managed by a separate table as a database. For example the information may have a hierarchical structure as a table configuration such as associating class object information that bundles functions with Service information of DLNA.

The conversion unit converts the resource usage request inputted from the program execution unit by using the device information accumulated in the device information storage . In other words the conversion unit converts a resource usage request having the first format into the second format. The resource providing apparatus transmits the resource usage request which is generated by the conversion to the resource providing apparatus . When the resource providing apparatus receives a processing result for example a notification indicating that the resource providing apparatus makes a recording reservation via the first communication unit the resource providing apparatus converts the processing result according to an output format of JavaScript API and outputs the converted processing result to the program execution unit if necessary.

Next an operation of the information processing apparatus according to the present embodiment will be described with reference to and . shows a basic sequence between system components including the information processing apparatus according to the present embodiment. is a flowchart of a process of the conversion unit according to the present embodiment.

It is assumed that a user uses a browser on the information processing apparatus . The user joins an NPVR service that realizes a recording reservation of a TV program on a cloud service and the device information of the resource providing apparatus is registered in the device information storage in the information processing apparatus .

First the user accesses the electronic program guide service developed on the program providing apparatus via the browser step S . The browser transmits an HTTP GET request to the program providing apparatus step S and the program providing apparatus returns Web contents of the electronic program guide service step S . As described above a TV program table is displayed in the Web contents and a recording reservation button is arranged in each program field.

Here when the user presses a recording reservation button in a program field of a TV program of which the user wants to make a recording reservation step S the program execution unit executes a JavaScript code including a resource usage request embedded in the Web contents step S . Here the JavaScript API PVRDevice.reserve described above is called and inputted into the conversion unit along with parameter information. In the conversion unit the JavaScript API call on the Web contents is converted into an actual resource usage request recording reservation request depending on device service step S .

Here an internal process of the conversion unit will be described on the basis of . First the program execution unit notifies the conversion unit that a resource usage request occurs the program execution unit inputs API identification information and parameter information into the conversion unit step S . The conversion unit inquires of the device information storage about a device including an API identifier here API name pvrDevice.reserve by using the API identifier as a key step S . If there is no corresponding device service NO in step S the conversion unit returns an error indicating that there is no corresponding device step S . Here there is the NPVR service on the Internet YES in step S so that the device information of the NPVR service is acquired. The conversion unit is included in the device information.

The conversion unit generates a recording reservation request a device dependent resource usage request to the NPVR service described below by using location information of the API and parameter conversion information step S .

Subsequently the conversion unit transmits the generated resource usage request to the first communication unit step S receives a processing result step S converts the processing result into a response message of JavaScript API step S returns the response message of JavaScript API step S and completes the process. The conversion to the response message is performed by for example storing a conversion table of response data and error code in the device information storage in the same manner as in the case of request and using the conversion table. For example if the response of the NPVR is XML format and the response of the JavaScript API is JSON format the format conversion is performed in step S described above.

Here let us return to the entire sequence of . The sequence after the resource usage request conversion will be described.

When the conversion unit transmits the generated resource usage request to the first communication unit in step S in the first communication unit transmits the resource usage request to the resource providing apparatus as an HTTP S GET request step S . The resource providing apparatus makes a recording reservation of the program based on the received request step S and returns a result step S . The first communication unit inputs a received response message into the conversion unit . The conversion unit converts the inputted response message into a response message of JavaScript API and outputs the converted response message to the program execution unit . On the other hand the program execution unit returns the response message to the Web contents program step S .

For example if the response message is a successful response of the recording reservation the program displays a message such as for example the recording reservation of the program is successfully made on a screen step S .

As described above according to the information processing apparatus of the present embodiment the recording reservation can be made without disclosing to the electronic program guide service the program providing apparatus that the user joins in the NPVR service the resource providing apparatus . In other words it is possible to carry out a service for mashing up associating a Web service of a service provider and a resource of a device to be accessed without disclosing information of the device to be accessed to the service provider.

Next a second embodiment of the information processing apparatus will be described. The same components as those of the first embodiment will be described by giving the same reference numerals or the descriptions thereof will be omitted.

First a user browses a Web page of a service the electronic program guide service described above on the Internet and presses a record button of a program field of which the user wants to make a recording reservation. When the button is pressed JavaScript code embedded in the Web page being browsed is executed and recording reservation function at PC peripheral AV device is called as an internal function of a PC. When the internal function is performed a specified program is recorded in a home digital TV in which a recording reservation function is implemented. The difference from the first embodiment is that a recording reservation is made on a digital TV on a home network instead of the NPVR service on the Internet.

In the above use case the digital TV is the resource providing apparatus and the home network is a second network. Hereinafter the details of the present embodiment will be described.

The network is a wireless or wired IP network a peripheral device connection network such as USB HDMI and IEEE1394 a near field wireless network or a close proximity wireless network such as Transfer Jet and an infrared network or various networks and interfaces that can transmit and receive information to and from an information processing apparatus such as an SD card a storage such as an external HDD and a disk medium such as CD and DVD. In the present embodiment the network is assumed to be a LAN Local Area Network forming a home network.

The resource providing apparatuses and have the same hardware configuration as that of the resource providing apparatus of the first embodiment. In the present embodiment the resource providing apparatuses and are digital home appliances. Specifically the resource providing apparatus is a digital TV and the resource providing apparatus is a hard disk recorder the resource providing apparatus of the first embodiment is assumed to be a server apparatus on the Internet . The digital TV has a recording function of DLNA SRS Scheduled Recording Service .

Next the information processing apparatus has a hardware configuration similar to that of the first embodiment. However as new functional blocks a device information acquisition unit a second communication unit a device selection unit and a user approval unit are added. These units are generated on the main storage such as a RAM when the CPU executes a program. Following the addition of the functional blocks the data configuration of the device information stored in the device information storage and the process flow of the conversion unit are extended.

The device information acquisition unit detects a resource providing apparatus on the network and acquires the device information of the resource providing apparatus. The device information acquisition unit performs functions of a Discovery step and a Description step in the DLNA. The device information acquisition unit may be configured to periodically transmit a search message to the network via the second communication unit may be configured to monitor the network at all times and catch an announcement message DLNA Advertise message flowing on the network or may be configured to transmit a search message according to a request from the conversion unit when a resource usage request is inputted into the conversion unit . In the present embodiment the device information acquisition unit periodically collects device information independently from the process of the conversion unit .

The second communication unit communicates with the resource providing apparatuses and on the network . The second communication unit performs communication for detecting or discovering a resource providing apparatus on the network by the device information acquisition unit described later and communication for using a resource by a program via the conversion unit . In the present embodiment the second communication unit is a communication unit of an HTTP client and a DLNA client control point .

When a plurality of devices to which a resource usage request is transmitted are detected the device selection unit displays a user interface for selecting a device on the GUI display unit via the program execution unit acquires a selection result of the user from the program execution unit and inputs the result into the conversion unit .

When user s approval is required to use a resource including resources peripheral device information on the information processing apparatus the user approval unit displays a user interface for approving the use on the GUI display unit via the program execution unit acquires an approval result of the user from the program execution unit and inputs the result into the conversion unit . Further the user approval unit can be configured to store the approval result of the user and use the approval result for a certain period or for good.

Next modifications of the data structure in the device information storage will be described. shows an example of the data structure according to the present embodiment. The difference from the first embodiment is that device name necessity or not of user approval date and time of user approval result of user approval and validity period of user approval are added. The additional items will be described in turn.

The device name information is display character string information that represents device names listed on a user selection interface generated by the device selection unit .

The necessity or not of user approval information is a Boolean value indicating whether or not an approval of the user who operates the information processing apparatus is required to use a resource of the resource providing apparatus.

The date and time of user approval information indicates date and time when the user approval is obtained to use the resource of the resource providing apparatus.

The result of user approval is result information of the user approval and is a Boolean value indicating approval or denial.

The validity period of user approval information is information indicating a period in which the result of user approval is applied. In the example of the validity period of user approval information is specified in seconds. The validity period information can indicate an indefinite period. For example when a negative value or 0 is specified the validity period is set to an indefinite period.

Next an operation of the information processing apparatus according to the present embodiment will be described with reference to and . is a flowchart showing a process flow of the conversion unit according to the present embodiment. shows a basic sequence between system components including the information processing apparatus according to the present embodiment.

First before the user accesses the electronic program guide service developed on the program providing apparatus via the browser the device information acquisition unit periodically obtains information of the resource providing apparatuses on the network . Specifically the device information acquisition unit transmits a Search message of DLNA via the second communication unit step S . The resource providing apparatuses and on the network receive the Search message and transmit an Advertise message steps S and S . When receiving the Advertise message the device information acquisition unit recognizes the presence of the resource providing apparatuses and and transmits an acquisition request message of detailed device information to each of the resource providing apparatuses and steps S and S . Each of the resource providing apparatuses and returns the device information steps S and S . When the resource providing apparatuses provides a plurality of services the device information acquisition sequence steps S S S S may occur a plurality of times.

Here in the same manner as in the first embodiment the user accesses the program providing apparatus the electronic program guide service and presses a recording reservation button of a program of which the user wants to make a recording reservation so that a program embedded in the Web contents is executed steps S to S . This is the same as steps S to S in the first embodiment so that the description thereof will be omitted.

Here an internal process of the conversion unit will be described on the basis of . First the program execution unit notifies the conversion unit that a resource usage request occurs the program execution unit inputs API identification information and parameter information into the conversion unit step S . When receiving the resource usage request the conversion unit determines whether or not to obtain an approval to access the peripheral device information on the network home network from the user step S . The conversion unit may be configured to obtain the approval every time as described above may be configured to set a validity period and obtain the approval again when the validity period expires or may be configured not to obtain the approval which is obtained once unless it is initialized the validity period is managed by the user approval unit . If it is determined that the approval is required the conversion unit causes the user approval unit to display a user approval interface. The user approval unit displays an interface pop up screen or the like to obtain the approval from the user on the GUI display unit via the program execution unit . For example words such as Web page requests to use peripheral device information. May the Web page use the information OK NG are displayed and the user is prompted to select one of the options. The user approval unit obtains the selection result of the user via the program execution unit and outputs the selection result to the conversion unit . If the user denies the access step S the conversion unit determines that a permission error occurs returns an error to the program execution unit and completes the process step S . On the other hand if the user approves the access the conversion unit obtains the device information of the resource providing apparatus having a resource corresponding to the API from the device information acquisition unit step S . Here the resource providing apparatuses and are a digital TV and a hard disk recorder respectively. If both apparatuses have a recording function there are a plurality of corresponding devices step. S so that the conversion unit requests the device selection unit to display a device selection interface. The device selection unit displays the device selection interface via the program execution unit to cause the user to select a device step S . Here if the user selects the digital TV the conversion unit determines whether or not the approval to access the device needs to be obtained step S in the same manner as in step S. In this determination the information of whether the approval is required or not the information of the validity period and the like which are included in corresponding API information of the corresponding device in the device information storage may be used. If it is determined that the approval needs to be obtained the user approval unit displays an approval interface on the screen and returns an input result of the user to the conversion unit step S . If the user denies the access the conversion unit returns a permission error to the API call and completes the process step S . On the other hand if the user approves the access the conversion unit converts the JavaScript API call into an Action command SOAP message of DNLA in the present embodiment performs the process of steps S to S in of the first embodiment and returns the result to the program execution unit step S .

As described above according to the present embodiment the recording reservation can be made without disclosing the information including the presence of the digital home appliances the resource providing apparatuses arranged on the home network to the electronic program guide service the program providing apparatus . In other words co operation between a Web service and home appliances that is the mash up service can be realized without disclosing information related to privacy such as what devices the user has to the Web service while preventing unauthorized access from an external Web service to the home appliances. Also according to the present embodiment resource related to the co operation function can be used on the basis of the user s approval.

Next a third embodiment of the information processing apparatus will be described. The same components as those of the first and the second embodiments will be described by giving the same reference numerals or the descriptions thereof will be omitted.

The present embodiment is almost the same as the second embodiment except that the resource providing apparatus digital TV requires a user s authentication permission. Specifically a resource use target device is determined on the information processing apparatus PC and then the digital TV requires user authentication and an access permission of the user. Regarding the permission process it can be considered that an access permission apparatus for example a user support service site operated by a manufacturer of the digital TV on the network the Internet performs by proxy the user authentication and the access permission of the user. However in the present embodiment as an example a case in which the digital TV itself performs basic authentication will be described. The information processing apparatus PC presents information hereinafter referred to as a ticket which verifies that authentication permission issued by the digital TV is obtained to the digital TV. The digital TV confirms the validity of the presented ticket and returns a resource only to the information processing apparatus in which the user authentication is successfully performed and the access permission of the user is obtained.

Next the information processing apparatus has a hardware configuration similar to that of the first and the second embodiments. However as new functional blocks an authentication permission processing unit and a resource providing apparatus start up unit are added.

These units are generated on the main storage such as a RAM when the CPU executes a program. Following the addition of the functional blocks the data configuration of the device information stored in the device information storage and the process flow of the conversion unit are extended.

The authentication permission processing unit receives an authentication permission processing request and performs authentication permission processing to use a resource by using the first communication unit the second communication unit and the user approval unit on the basis of an access authentication permission method information of the corresponding resource providing apparatuses and stored in the device information storage . It is assumed that the authentication permission processing is basic authentication or digest authentication performed on the resource providing apparatus OAuth authentication that realizes an access permission by proxy on an external device an access permission apparatus different from the resource providing apparatus or the like. The authentication permission processing unit behaves as an authentication client thereof.

The resource providing apparatus start up unit starts up a resource providing apparatus that is in a sleep state on the network by using Wake On LAN or the like and changes the state of the resource providing apparatus to be able to perform communication. The resource providing apparatus start up unit is called by the conversion unit when an apparatus to which a resource usage request should be transmitted is not detected.

Next modifications of the data structure in the device information storage will be described. show an example of the data structure according to the present embodiment. The difference from the second embodiment is that protocol type access authentication permission method information ticket information ticket validity period and MAC address are added. The additional items will be described in turn.

The protocol type information is information of communication protocols supported by the resource providing apparatus such as DLNA IEEE1394 and ECHONET that is a protocol for large household electrical appliances on the network . Although in the present embodiment the protocol type is limited to the DLNA it is assumed that various protocols other than those described above are used. The device information acquisition unit collects device information in accordance with each protocol.

The access authentication permission method information is information indicating an authentication method required by the resource providing apparatus such as the basic authentication the digest authentication or the OAuth authentication. If the method has a plurality of versions it can be considered that the version information is also stored.

The ticket information is information indicating that permission is obtained and is information to be presented to the resource providing apparatus. In the same manner as the license information the ticket information has different information and format required for each piece of the access authentication permission method information. In the present embodiment the ticket information indicates that permission is given in accordance with the OAuth authentication.

Finally the MAC address of a device is used to start up a device that is in a sleep state. The MAC address is not necessary when the device identifier information can be used instead of the MAC address.

Although only four items are added to the device information of the present embodiment further information may be required according to the authentication permission method so that it is assumed that various information can be held which is required for an access authentication permission procedure necessary for the information processing apparatus to access the resource providing apparatus.

Next an operation of the information processing apparatus according to the present embodiment will be described with reference to and . is a flowchart showing a process flow of the conversion unit according to the present embodiment. shows a basic sequence between system components including the information processing apparatus according to the present embodiment.

First the procedure S to S for the device information acquisition unit to collect the device information is the same as steps S to S in the second embodiment so that the description thereof is omitted here. The device information acquisition unit obtains the device information of the resource providing apparatuses and on the basis of for example a procedure of Discovery and Description steps of the DLNA and stores the device information in the device information storage . When the procedure to collect the device information follows other protocols such as ECHONET used for large household electrical appliances and IEEE1394 a mechanism for detecting a device in each protocol may be used.

The processes from the subsequent Web contents acquisition process including acquisition of a resource usage program from the program providing apparatus to the start of execution of the resource usage program which is started when a user presses the recording reservation button in the Web contents are the same as those in the second embodiment S to S . The processes described above including the device information acquisition process are the same as those of steps S to S in the second embodiment.

Here a resource usage request conversion process step S performed by the conversion unit will be described with reference to . In the same manner as in the second embodiment the conversion unit performs device selection and approval of use of resource of the device selected by the user on the basis of the information in the device information storage steps S to S . These processes are also the same as those of steps S to S of the second embodiment shown in . In the present embodiment the conversion unit converts the resource usage request into a device dependent request message step S and transmits the request message to the device step S . Thereafter if the address of the transmission destination cannot be solved and the transmission fails step S the conversion unit requests the resource providing apparatus start up unit to remote start the corresponding resource providing apparatus. The resource providing apparatus start up unit receives the request from the conversion unit transmits a Wake On LAN packet to the corresponding device and starts up the corresponding resource providing apparatus over the Ethernet step S . The resource providing apparatus start up unit repeats the transmission until the resource usage request transmission is successfully performed and the apparatus starts or the number of retransmission times reaches an upper limit. If the number of retransmission times reaches the upper limit YES in step S the conversion unit returns a communication error to the program execution unit step S and completes the process step S . If the transmission of the resource usage request to the resource providing apparatus is successfully performed in the present embodiment the conversion unit receives information indicating that access authentication basic authentication is required from the resource providing apparatus as an error response. This is realized by for example an HTTP 1.1 401 Authorization Required response. However this is not limited to this response when the access authentication is not the basic authentication or the digest authentication and this may be realized by an individual method. Further it is possible to store information indicating whether or not the access authentication permission is required on the device in the device information storage and employ a method for directly performing the authentication permission without receiving the 401 response on the basis of the stored information. When receiving an access authentication request the conversion unit requests the authentication permission processing unit to perform the authentication permission processing and the authentication permission processing unit performs the authentication permission processing step S . When the authentication permission processing is successfully performed the resource is actually used and the conversion unit converts a received processing result and returns a response to the program execution unit so that a series of processes are completed steps S to S .

Here the authentication permission processing in step S in the flowchart of will be described with reference to the sequence diagram of . First the authentication permission processing unit receives a 401 response of HTTP steps S and S and displays a pop up screen requesting input of a user account and a password set on the resource providing apparatus digital TV via the program execution unit . When the user inputs a user account and a password onto the pop up screen step S the two inputted values are connected by the connected values are encoded into data using Base64 and the data is specified as an authentication header and transmitted step S . When the specified user account and password are correct the resource providing apparatus transmits a response message requesting the user to approve the resource usage request from the information processing apparatus along with a response indicating that the authentication is successfully performed step S . The authentication permission processing unit displays a pop up screen requesting the user to permit the request via the program execution unit in the same manner as in the authentication. For example the authentication permission processing unit displays a message confirmation screen such as Recording reservation message from PC to digital TV is received. Do you approve the recording reservation OK NG . When the user clicks OK to approve the access that is use of the resource step S the approval of the user is transmitted to the resource providing apparatus step S . When receiving the approval of the user the resource providing apparatus returns a confirmation response step S . The confirmation response may include temporary permission being information ticket information indicating approval of access and the validity period of the approval. In the present embodiment the ticket information is assumed to be character string information as illustrated in . However the format of the ticket information is not limited. When the resource providing apparatus returns a response such as the ticket information the response format may be stored in a header Authorization header of authentication permission of HTTP response or an individual extended header or may be stored in a response body in XML format or JSON format. When using an existing header the same data as the data specified in the authentication permission on the pop up screen may be used as a ticket when the authentication is the basic authentication data obtained by encoding user ID and password using Base64 may be used as a ticket . The authentication permission processing unit returns the ticket information and the validity period information to the conversion unit . The conversion unit includes the ticket information and the validity period information in a resource usage request massage and transmits the resource usage request massage step S . The resource providing apparatus verifies the specified ticket information executes the resource usage request step S and returns a result step S . The subsequent processes are the same as those of steps from S to S in the flowchart of . Specifically the conversion unit converts the resource usage request processing result in accordance with a conversion rule stored in the device information storage and returns the conversion result to a program executed on the program execution unit . Then the program displays the result on a screen step S and step S .

As described above according to the present embodiment in addition to the effects described in the first and second embodiments there is an effect that the program providing apparatus can use a resource not only when the user approval to the resource usage is required on the information processing apparatus but also even when the resource providing apparatuses and request the user authentication and permission. The conversion unit realizes access authentication and permission processing to resources of various device types so that the program providing apparatus need not handle each authentication permission method. The series of authentication permission processes are executed as internal processes of a call of a common API so that the program providing apparatus cannot know what authentication permission processes are performed when using a resource. In other words the program providing apparatus cannot know the information of the user account and the password inputted by the user in the present embodiment. Therefore even when an individual device requires user authentication and permission it is possible to realize use of resource mash up service between Web contents and a home appliance resource without disclosing user s confidential information related to these processes to the program.

Next a fourth embodiment of the information processing apparatus will be described. The same components as those of the first the second and the third embodiments will be described by giving the same reference numerals or the descriptions thereof will be omitted.

The present embodiment is almost the same as the third embodiment except that the resource providing apparatus digital TV performs user authentication and access permission by using a service on the Internet and the user authentication permission to the digital TV requires a permission to the program providing apparatus instead of the information processing apparatus PC .

The former difference is that in the present embodiment an access permission apparatus for example a user support service site operated by a manufacturer of the digital TV on the network the Internet performs by proxy the user authentication and the access permission of the user whereas in the third embodiment when the digital TV requires the user authentication and the access permission of the user the digital TV itself performs the basic authentication. At this time the information processing apparatus PC presents information hereinafter referred to as a token which verifies that authentication permission issued by the access permission apparatus is obtained to the digital TV. When the digital TV confirms the validity of the presented token the digital TV returns a resource only to the information processing apparatus in which the user authentication is successfully performed and the access permission of the user is obtained.

The latter difference is that the digital TV requires permission to access from the electronic program guide service in the present embodiment whereas the digital TV requires approval to access from PC in the third embodiment.

The access permission apparatus also has a normal computer hardware configuration in the same manner as the program providing apparatus . Here the access permission apparatus is a server apparatus used in a data center or the like. As described above the access permission apparatus of the present embodiment is operated by a manufacturer that manufactures and sells the resource providing apparatus digital TV and the access permission apparatus provides a user support service. The service provides update information of a product and the like to a user who purchased the product and performed user registration using product information type name production number and the like of the purchased product and also provides an access authentication permission service to usage of a resource in the product from a Web site on the Internet as realized in the present embodiment.

The hardware configuration and the functional blocks of the information processing apparatus are substantially the same as those of the third embodiment.

On the other hand although the resource providing apparatus has the same hardware configuration as that of the second and the third embodiments the resource providing apparatus requires an access permission to the electronic program guide service the program providing apparatus instead of the PC the information processing apparatus as described above so that the resource providing apparatus includes a communication unit a resource providing unit an access request source information storage an access control unit and an approval result verification unit . These units are generated on the main storage such as a RAM when the CPU executes a program. Hereinafter each unit will be described.

The communication unit communicates with the information processing apparatus on the network . The communication unit receives a request for discovery of the resource providing apparatus on the network by the device information acquisition unit on the information processing apparatus a request to use a resource by a program via the conversion unit and an authentication permission request associated with the use of the resource. In the present embodiment the communication unit is a communication unit of an HTTP server and a DLNA device.

The resource providing unit provides a resource corresponding to a resource usage request received via the communication unit .

The access request source information storage stores information of an access request source or an access requestor that is information of the program providing apparatus that provides Web contents in which a resource usage request program is embedded instead of the information of the information processing apparatus . As illustrated in the data structure of the information accumulated in the access request source information storage of the present embodiment includes an access request source identifier an access target resource identifier a user identifier access permission refusal information a user approval result permission information and a permission validity period.

The access request source identifier is identification information of the program providing apparatus . In the present embodiment the access request source identifier is URL of the electronic program guide service.

The access target resource identifier is information for identifying the resource the use of which is requested by the access request source. The access target resource identifier is information corresponding to the device dependent API location in the device information storage .

The user identifier is information for identifying the user on the resource providing apparatus . When there is no user account in the resource providing apparatus this information need not be included.

The access permission refusal information is information indicating whether the resource can be used by the access request source which is determined by the user the owner of the resource providing apparatus . The access permission refusal information includes two values of permission and refusal or three values of permission refusal and not yet permitted. When an external access permission apparatus is used the access permission refusal information indicates permission or refusal of the access by the access permission apparatus so that if an external access permission apparatus is not used the access permission refusal information is not required.

The user approval result is information indicating a determination result of permission or refusal of the access by the user the owner of the resource providing apparatus . The user approval result includes two values of permission and refusal or three values of permission refusal and not yet permitted.

The permission information is ticket information indicating that an external access permission apparatus provides an approval when the external access permission apparatus is assumed to be used in the same manner as the access permission refusal information. The permission information is ticket information included in data on the device information storage see on the information processing apparatus . The resource providing apparatus determines permission or refusal of the access by comparing the permission information and the ticket information which the information processing apparatus presents along with a resource usage request.

The permission validity period indicates the validity period of the permission information. The permission validity period is also used to determine permission or refusal of the access.

The access control unit obtains access request source information included in the resource usage request. When the access control unit receives an access request from an access request source for which the access permission refusal information is not yet set the access control unit requests the information processing apparatus to obtain access permission of the user. The access control unit receives an approval result of the access permission refusal of the user from the information processing apparatus via the communication unit stores the result in the access request source information storage and performs access control using the approval result.

When the resource providing apparatus uses an external apparatus access permission apparatus for the access permission the approval result verification unit obtains permission information ticket information from the access permission apparatus and verifies whether or not the approval is actually obtained by comparing the obtained permission information with the ticket information included in the resource usage request from the information processing apparatus .

Next a difference between the information processing apparatuses will be described. The internal processing of the conversion unit and the data structure of the device information storage in the present embodiment are different from those in the third embodiment.

Although in the first to the third embodiments the conversion unit converts the resource usage request and the response in accordance with the conversion rule stored in the device information storage in the present embodiment the conversion unit only loads a conversion program conversion mechanism provided by each resource providing apparatus.

Next modifications of the data structure in the device information storage will be described. shows an example of the data structure according to the present embodiment. The difference from the third embodiment is that the protocol type and the conversion rule information are not included a location of a conversion program is included instead of the conversion rule and license information license information secret key is added. The additional items will be described in turn.

First the location information of the conversion program is not the conversion rule described in the first to the third embodiments but includes conversion codes themselves. Therefore the conversion unit need not perform a process to interpret a rule and perform conversion. By only executing the conversion program a common API call is converted into an appropriate device dependent resource usage request and also the obtained processing result can be converted.

The license information license information secret key is information indicating that the information processing apparatus has a right to obtain access permission which is necessary to obtain the access permission. Necessary license information and the format thereof are different for each access authentication permission method information. For example the license information may be an X509 client certificate or pair information of client identification information issued by the access permission apparatus for each client and a secret key. The format is not limited. In the present embodiment the license information is assumed to be a client credential client identification information and secret key information in accordance with the OAuth authentication.

The ticket information is information indicating that permission is obtained and is information to be presented to the resource providing apparatus. In the same manner as the license information the ticket information has different information and format required for each piece of the access authentication permission method information. In the present embodiment the ticket information is assumed to be token information indicating that permission in accordance with the OAuth authentication is given.

The ticket validity period information validity period of the access permission is information indicating the validity period of the ticket. In the present embodiment the ticket validity period information is validity period information of a token in accordance with the OAuth authentication.

Finally the MAC address of a device is used to start up a device that is in a sleep state. The MAC address is not necessary when the device identifier information can be used instead of the MAC address.

Further information may be required according to the authentication permission method. In this case it is assumed that the device information can include various information which is required for an access authentication permission procedure necessary for the information processing apparatus to access the resource providing apparatus.

Next an operation of the information processing apparatus and the resource providing apparatus according to the present embodiment will be described with reference to and . shows an example of the data configuration of the device information stored in the device information storage according to the present embodiment. shows an outline of the program Web contents provided by the program providing apparatus according to the present embodiment. shows an example of a library pseudocode that defines a resource usage API provided by the conversion unit . shows an example of a conversion program pseudocode provided by the resource providing apparatus . shows a basic sequence between system components including the information processing apparatus according to the present embodiment. The process of the conversion unit is the same as that of the third embodiment and the process follows the flowchart shown in .

Hereinafter a procedure will be described on the basis of the sequence diagram of . Only the differences from the third embodiment will be described.

First the difference in device information acquisition steps S to S is that when the information processing apparatus acquires information of the resource providing apparatuses and the conversion unit adds a code to dynamically load each conversion program to a resource usage API definition library provided by the conversion unit on the basis of the device identification information and the location information of the conversion program included in the device information. Specifically the conversion unit adds a code from the eighth line to the twelfth line in the case of the resource providing apparatus and adds a code from the thirteenth line to the sixteenth line in the case of the resource providing apparatus . The conversion unit only performs the above processes.

Subsequently the user accesses the electronic program guide service provided by the program providing apparatus and the user presses the recording reservation button of a specific program step S .

Here an outline of the configuration of the Web contents of the electronic program guide service will be briefly described on the basis of . As shown in the Web contents provided by the program providing apparatus calls in the Web contents a program file useResource.js that uses a resource here a program file useResource.js that calls a reserve function that calls a recording reservation function of a home TV set and a library file deviceAPI.js that defines the reserve function that is called by the useResource.js in the seventh line and tenth line in respectively . The former useResource.js is disposed on the program providing apparatus and the latter deviceAPI.js disposed in the information processing apparatus in the present embodiment. As described above the latter file is dynamically rewritten by the conversion unit when a device is detected or removed.

Next the conversion processing of the conversion unit in step S will be described. Although the process flow is similar to that of the third embodiment and follows the conversion processing itself steps S to S in is mainly different from that of the third embodiment. This is because the conversion program provided by each resource providing apparatus performs the conversion processing in the present embodiment whereas the conversion processing is performed by the conversion unit in accordance with the conversion rule in the third embodiment.

The conversion processing will be described with reference to and . The resource usage request input S corresponds to a call of the resource usage API reserve function provided by the information processing apparatus . The process of the subsequent steps S to S corresponds to an internal process of an internal prepare function the fourth line in . Here identification of the device and the authentication permission processing are completed and the identification information of the resource use target device is returned to the library deviceApi.js . Here the resource of the resource providing apparatus is used so that a code from the eighth line to the twelfth line in embedded by the conversion unit is called and a conversion program http 192.168.0.10 8888 upnp control pvr srs ctrl js transcode.js on the resource providing apparatus is loaded and used. As shown in all the processes from the conversion and transmission of the request to the reception and conversion of the response steps S to S in can be performed in the conversion program.

Subsequently the conversion unit on the information processing apparatus transmits a resource usage request including the identification information http www.iepg.com from of the electronic program guide service of the providing source of the resource usage request program to the resource providing apparatus by a call of the conversion code step S . The communication unit on the resource providing apparatus receives a resource usage request message and transfers the resource usage request message to the access control unit . The access control unit refers to corresponding information in the access request source information storage and detects that the access permission refusal information is not yet set. The access control unit determines that access permission is required on the access permission apparatus and transmits information indicating that the access authentication OAuth authentication is required as an error response. Specifically the access control unit requests the conversion unit to redirect to an access permission page on the access permission apparatus on the network . This is realized by for example an HTTP 1.1 302 Found response step S . At this time the access control unit includes a callback URL to redirect again redirect from the access permission apparatus to the resource providing apparatus and the identification information of the resource providing apparatus UUID MAC address serial number model number and the like in the redirect destination URL.

When the conversion unit on the information processing apparatus receive receives a redirect request the conversion unit requests the authentication permission processing unit to obtain the authentication permission step S . The authentication permission processing unit accesses an access permission screen on the access permission apparatus according to the HTTP response redirect request step S . Here the user does not log in to the access permission apparatus the user support service of the device manufacturer and the authentication permission processing unit is further redirected to a user authentication screen step S . The authentication permission processing unit displays the user authentication screen in a pop up manner via the program execution unit . When the user inputs a user account and a password on the access permission apparatus the user support service of the device manufacturer and presses an OK button step S the authentication permission processing unit transmits an authentication request message to the access permission apparatus step S and receives an authentication result step S . The received authentication result is the access permission screen which the authentication permission processing unit requested to access first. The authentication permission processing unit displays the access permission screen in a pop up manner. In this screen for example a message such as Electronic program guide service X requests to make a recording reservation on digital TV Y. Do you approve the request OK NG is displayed. Here if the user presses the OK button step S the authentication permission processing unit transmits an access authentication request message step S and receives a response from the access permission apparatus step S . The response message requests redirect to the callback URL specified by the resource providing apparatus in step S HTTP 1.1 302 Found . The response message includes ticket information indicating the access permission or Verification Code for acquiring the ticket information . In the present embodiment it is assumed that the response message includes the ticket information. However if the response message includes the Verification Code it is possible to present the Verification Code to the access permission apparatus using a secure communication path such as HTTPS and acquire the ticket. At this time the authentication permission processing unit may present that the authentication permission processing unit has a right to obtain access permission to the access permission apparatus by using the license information stored in the device information storage .

The authentication permission processing unit transmits a request to the callback URL that is a Web API call to use a resource step S . The request message includes ticket information in addition to access request source information. The ticket information may be configured to include a hash value of confidential information that verifies validity of the ticket along with character string data representing the ticket.

Here the access control unit on the resource providing apparatus extracts the access request source information and the ticket information included in the received resource usage request. At this point if the ticket information is not stored in the access request source information storage the access control unit requests the approval result verification unit to verify the validity of the acquired ticket. The approval result verification unit transmits a request message of the access permission result of a corresponding device to the access permission apparatus via the information processing apparatus step S . When the resource providing apparatus is located on the network the approval result verification unit directly transmits the request message to the access permission apparatus . The access permission apparatus receives the request and returns approval result information of the resource providing apparatus of the request source step S . When the same ticket as that received in step S is included in the returned approval result information the approval result verification unit determines that the ticket is valid and returns a response accordingly to the access control unit step S and stores information related to the permission attribute information listed in in the access request source information storage . The access control unit approves the access on the basis of the response and the resource providing unit provides a resource to be accessed steps S and S .

Thereafter the conversion unit calls the conversion code stored in the device information storage corresponding to the resource usage request processing result and returns the conversion code conversion result to a program executed on the program execution unit and then the program displays the result on the screen step S step S .

As described above according to the present embodiment in addition to the effect described in the third embodiment there is an effect that the resource providing apparatuses and can perform access control according to the access request source program providing apparatus . Further it is possible to perform access control not only on the resource providing apparatuses but also on the basis of an access permission using an external access permission service. Furthermore the series of authentication permission processes are executed as internal processes of a call of a common API in the same manner as in the first to the third embodiments so that the program providing apparatus cannot detect what authentication permission processes are performed when using a resource. In other words the program providing apparatus cannot know the information of the user account and the password inputted by the user in the present embodiment. Therefore even when an individual device requires user authentication and permission by using an external authentication permission service it is possible to realize use of resource mash up service between Web contents and a home appliance resource without disclosing user s confidential information related to these processes to the program.

In the present embodiment each resource providing apparatus provides conversion processing so that it is possible to perform more flexible and complex processing which is not limited by a static mapping based on a simple conversion table. Further the program may be disposed not only on the resource providing apparatus but also on a site of the manufacturer of the resource providing apparatus so that there is an advantage that the program can be easily deployed and easily changed.

While certain embodiments have been described these embodiments have been presented by way of example only and are not intended to limit the scope of the inventions. Indeed the novel embodiments described herein may be embodied in a variety of other forms furthermore various omissions substitutions and changes in the form of the embodiments described herein may be made without departing from the spirit of the inventions. The accompanying claims and their equivalents are intended to cover such forms or modifications as would fall within the scope and spirit of the inventions.

