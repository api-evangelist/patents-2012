---

title: Systems and methods for generating compensated speed values for doppler-enabled device
abstract: Implementations relate to systems and methods for generating compensated speed values for a Doppler-enabled device. A portable wireless device can contain a GPS navigation engine () to capture position data () and Doppler speed data () from positioning satellites. The device can also generate position-based speed values from successive position readings and time intervals, to determine the current speed independently of the Doppler-based speed values. During degraded signal conditions, the Doppler-based speed values can drop to invalid levels. The device incorporates a combiner module () which compares the position-based and Doppler-based speed values and performs combination operations on those quantities to produce a compensated speed value (). By selecting the maximum or otherwise combining those values, extreme excursions in speed values are avoided and accuracy promoted.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09164179&OS=09164179&RS=09164179
owner: GOOGLE TECHNOLOGY HOLDINGS LLC
number: 09164179
owner_city: Mountain View
owner_country: US
publication_date: 20121101
---
The present teachings relate to systems and methods for generating compensated speed values for a Doppler enabled device and more particularly to platforms and techniques for generating a speed value for a device that may be experiencing degradation in receipt of Global Positioning System GPS or other position signals.

In competitive running and personal recreation applications a person wearing or using a mobile device may use satellite positioning platforms including global positioning satellite GPS systems to track location and speed. In some mobile devices device speed may be calculated from Doppler shifts in the carrier wavelengths of received positioning signals. In these Doppler enabled devices the shift in carrier wavelength of the set of positioning signals due to the relative motion of the device as compared to the motion of the set of GPS satellites can be used to determine a speed of the device.

At times however the signals from GPS satellites can be obscured by trees buildings weather or other types of interference or obstructions. When Doppler GPS tracking is degraded the speed value that is output by the device tends to be reduced to a significant degree. The resulting speed value may not reflect or even reasonably approximate the user s true speed during those conditions. Users may not have a positive experience with speed tracking services that generate invalid speed values at unpredictable times due to signal degradation.

There is an opportunity to provide methods and systems for generating compensated speed values for a Doppler enabled device in which a value of a user s speed while running or performing other activities can be generated during degraded Doppler GPS conditions while maintaining a comparatively high degree of accuracy.

Implementations of the present teachings relate to systems and methods for generating compensated speed values for a Doppler enabled device. More particularly implementations relate to platforms and techniques for generating determining or estimating the speed of a device worn or carried by a user. The device can be equipped with sensing and tracking devices and or modules including a navigation engine and a speed comparison module along with radio frequency RF circuitry to receive and or communicate with GPS wireless wide area networks WWANs wireless local area networks WLANs and or other services. During operating conditions where the device is in the clear to receive signals from positioning satellites the device can process a set of received Doppler shifted carrier signals to generate an accurate Doppler based value of the speed of the device.

The device can also be configured to track position data based on a set of timing and location values derived from the positioning signals and then calculate values for current speed directly from receiver position and time stamp data. In those speed calculations the speed values are calculated by dividing elapsed distance by elapsed time. In implementations one or both of the Doppler based speed data and the position based speed data can be filtered to remove outliers in the stream of computed speed values. The use of a filter on one or both speed data streams can promote smooth speed variations rather than abrupt speed changes.

A combiner module in the device can combine the Doppler based speed values and the position based speed values using a predetermined set of combination rules. The combination rule or rules can in implementations include the selection of the greater or higher value between the Doppler based and position based speed values. The use of a rule that selects the maximum value from the Doppler based speed data and position based speed data over the same time period can tend to increase the determined speed to an accurate value during periods when Doppler based speeds are sagging due to degradation in receipt of GPS signals. The user can thus receive and or view a set of compensated speed values on the device that avoids spurious or inconsistent readings under difficult operating conditions including those in which GPS or other positioning signals may be obscured degraded or briefly unavailable.

Reference will now be made in detail to exemplary implementations of the present teachings which are illustrated in the accompanying drawings. Where possible the same reference numbers will be used throughout the drawings to refer to the same or like parts.

The device can have a small form factor such as a watch style device an arm band device a belt style device or a head set device. As shown the electronic device can be portable and host or incorporate a number of hardware software and or other resources including a display and an operating system .

The display can be or include a light emitting diode LED display a liquid crystal display LCD and or other types of displays having other types of panels or illumination elements. In some implementations the display can incorporate hardware based input components such as for example a capacitive or resistive touch sensitive panel allowing the user to enter data based on touch points or other actions on the screen. As noted the device can be configured in a comparatively small form factor but the touch screen or display screen may be larger for low vision applications or other use cases. The device can incorporate other input and output components such as for example audio output via a speaker audio input via a microphone visual input via a camera and or control input via mechanical buttons or switches.

As shown the electronic device can host or incorporate further hardware software and or other services or resources to provide an overall framework for operating the device and conducting input communications and or other activity. The resources of the electronic device can include for example an operating system installed on the electronic device and controlling the data storage processing communications and or other resources of the electronic device and or accessed via the electronic device . The device can incorporate radio frequency RF circuitry along with one or more antennas to enable wireless signaling with personal area networks local area networks wide area networks positioning satellites and or other networks nodes or stations.

The device can also incorporate resources related to the capture storage analysis and tracking of speed related data. Those integrated resources can include as illustrated a navigation engine and a speed comparison module . In implementations the navigation engine can be or include a GPS chip platform service and or module capable of receiving signals from associated satellite and or terrestrial base stations and translating those signals into position location speed elevation time and or other data with a comparatively high degree of accuracy. In implementations the navigation engine can be or include other types or classes of location or position hardware software and or services such as location modules based on the known geographic location of cellular towers or their sectors location modules that operate based on radio triangulation techniques or others. In implementations for example the navigation engine can additionally or alternately be based on the Galileo satellite tracking system and or others.

The speed comparison module of the device can be configured to track and calculate a compensated and or otherwise computed speed of the device and display the speed value on the display . In implementations the speed value can be displayed in miles per hour as shown but can also be configured to be displayed in feet per second kilometers per hour and or other units or measures. Pace values namely minutes per mile or other time over distance values can also or alternately be displayed. In implementations the speed comparison module and or other hardware module application and or service can be configured to display the speed value on the display continuously at regular intervals upon receiving an input or selection from the user and or at other times or under other conditions.

The speed comparison module and or other hardware module application and or service can incorporate processor memory logic software and or other resources to generate all speed values and conduct other operations as described herein.

In one illustrative operating environment and as for instance illustrated in the device can be worn attached to and or carried by a user located in an environment such as an outdoor trail track park and or other set of surroundings that permits the receipt of a set of position signals from a set of satellites . The position signals may have two features 1 a carrier frequency that can be used to compute a speed for the device using Doppler calculations and 2 timing and location e.g. GPS satellite phase and ephemeris information that can be used to compute the position of the device at a particular time and these calculations can be used to develop a position based speed for the device .

The set of navigation satellites can be or include a set of GPS satellites or others. Although this implementation obtains position signals from satellites for both Doppler based speed calculations and position based speed calculations other implementations may use terrestrial base stations for Doppler based speed calculations and GPS satellites for position based speed calculations or vice versa . Alternately position signals from terrestrial base stations may be used for both Doppler based speed calculations and position based speed calculations.

The user can use or operate the device in connection with a variety of activities including merely for example long distance running events hiking on public trails and other athletic personal recreation and or other activities. While in motion during those or other activities the device can capture various data to generate compute or estimate a current speed of the user and or device . According to implementations the set of position signals and associated information can be used to derive the current speed value of the device using multiple techniques. One technique will be referred to as a Doppler based speed calculation which uses knowledge of the Doppler Effect to calculate speed based on a carrier frequency shift of the received position signals . Another technique will be referred to as a position based speed calculation which uses the definition of change in distance over change in time to calculate speed.

The data used to produce a position based speed value can include as shown a set of receiver position data with associated time stamps for each position. The set of receiver position data can be received or derived from the timing and location data in a set of position signals received from the set of position satellites . The set of position signals and or associated information can be received and initially processed by the navigation engine of the device to extract location or position time and or other values for a series of position and timing measurements for the device .

The speed comparison module can generate a position based speed value by direct calculation of the distance between measured receiver positions divided by the time stamp values for successive positions of the device . In implementations the current position based speed value can be averaged over a predetermined number of position measurements and or can be computed using other techniques using the position and time information from the received set of position data . In implementations the speed comparison module can be configured to continuously or periodically generate the position based speed values and combine those values with Doppler based speed values from the navigation engine to generate a more accurate and or more fade resistant speed output.

More specifically in certain conditions or environments the set of position signals received by the navigation engine can be obscured faded or degraded for example due to signal interference caused by densely constructed areas of a city e.g. urban canyons heavy foliage severe weather conditions and or other phenomena or conditions. In those types of environments or others the navigation engine may be unable to generate accurate Doppler based speed data from the position signals .

In order to compensate for adverse operating conditions and inaccurate Doppler speed data and as shown for example in the speed comparison module of the device can be configured to perform certain operations independently on the Doppler based speed data and the position based speed data. In implementations the speed comparison module can contain host and or access a set of resources to perform combination operations on position based and Doppler based speed data. In implementations as shown those resources can include processing modules dedicated to position based speed calculations and Doppler based speed calculations respectively as well as to combination operations. Those modules as illustrated can include a position based speed module and a Doppler speed module along with other modules logic services and or hardware.

More particularly the speed comparison module can generate a filtered Doppler based speed value using the Doppler speed module . The Doppler speed module receives the set of Doppler speed data from the navigation engine and operates on that data to derive filtered Doppler based speed data . The filter can be or include a Kalman filter and or can be implemented using other types or classes of filtering algorithms or techniques. The filter can generate the filtered Doppler based speed value as an output based on Kalman and or other filtering operations.

The position based speed module of the speed comparison module can be configured to derive a filtered position based speed value independently of the filtered Doppler based speed value . To generate that value the position based speed module can communicate with the navigation engine to receive the set of receiver position data derived from the timing and location information in the set of position signals . The position based speed module can host and or execute a set of speed related operations which are conducted on the set of position data . The set of speed related operations can include a distance calculation operation in which the position based speed module determines the distance traveled between two position readings reflected in the set of position data . In implementations the two position values or readings can be successive or consecutive readings of the position of the device for instance at successive time increments but can also or instead be or include readings or values taken at multiple time increments.

The set of speed related operations can include a clamping operation on the distance value determined from the set of position data to limit values of the calculated distance to predetermined ranges which are deemed to represent realistic or reasonable changes in position by a user who is walking running or otherwise traveling with the device . Thus for instance the calculated distance can be clamped to a maximum traveled distance of one and one half times the previously determined speed multiplied by the time since the last position measurement. The set of speed related operations can further include a speed calculation operation based on the clamped or limited distance value determined in the set of speed related operations . The speed calculation operation can represent the direct division of the distance traveled over the time interval during which that distance was traveled yielding a position based speed value. That value can again be expressed in different units such as miles per hour or meters per second. After generating a position based speed or initial speed derived from position values the position based speed module can apply a filter to that speed value to produce a filtered position based speed value .

In implementations the filter can be or include a Kalman filter and or can be implemented using other types or classes of filtering algorithms or techniques. The filter can generate the filtered position based speed value as an output based on Kalman and or other filtering operations.

According to aspects the filtered position based speed values and filtered Doppler speed values or sets of such values when generated using Kalman filtering techniques in the filters and respectively exhibit a better balance between noise suppression and response time than could be obtained using more traditional filters such as finite and infinite impulse response FIR and IIR filters. These conditions are necessary to provide acceptable speed and pace information to the user of device via display . Note that although the two filters may both be Kalman filters they would be implemented or tuned independently.

In low signal conditions which affect the signal strength of the set of received position signals the filtered position based speed value processed by the position based speed module may be less adversely affected than the set of filtered Doppler speed data . illustrates a graph of further empirical data measured by the inventors during investigations of the subject matter herein. As shown in that data as a result of operations described herein the filter and or the filter can be tuned to the variance of its source in this case the position based speed data and Doppler based speed data from and in which position based outliers can be clamped by previous speed and elapsed time values. As shown and recalling that the user of the device was moving at a steady 3 meters per second the filtered Doppler based speed data more clearly exhibits drops in value compared to the filtered position based speed data . The filtered position based speed and filtered Doppler based speed can be combined by a combiner module see to select the maximum of the two values to reduce Doppler dips or other artifacts shown as the max speed data .

More particularly in implementations the combiner module of the speed comparison module can perform combination operations on the filtered position based speed value s and the filtered Doppler based speed value s to generate compensated speed value s that are more accurate under degraded signal conditions than the filtered Doppler speed value alone. In implementations the combiner module can be configured to receive both the filtered position based speed value s and the filtered Doppler based speed value s and combine those values using a predetermined rule or rules. In implementations the set of rules can be or include the identification or selection of the largest or greatest value of those two speed values as the compensated speed value . Again this type of combination may be motivated by the tendency of the filtered Doppler based speed value s to undergo drops during signal fade in comparison to the filtered position based speed value s . It will be appreciated however that other combination rules and or types of combination operations can be performed by the combiner module . Those further combination rules or operations can include for example an averaging of the filtered position based speed value s and the filtered Doppler based speed value s with or without static or dynamic weighting a thresholding operation applied to one or both of those values and or others.

In terms of the characteristics of the compensated speed value s as noted the combination operations applied by the combiner module can tend to smooth out the excursions in speed values that would be present in the filtered Doppler based speed value s alone. illustrates an example of a speed output history for a user of the device over a series of time increments t t t t . . . t in which the compensated speed value s are the greater of the filtered position based speed value s and the filtered Doppler based speed value s . In examples as shown the compensated speed value s that are generated and shown to the user via display of the device or otherwise can remain within a consistent range of values 6.6 6.7 miles per hour even during periods of temporary signal fade or degradation leading to one or more spurious values for the filtered Doppler based speed value s illustratively a drop to 3.4 miles per hour at t . Other values increments and histories can be reflected in the speed output history for a given user or users but in general the compensated speed value s can reflect a more consistent set of speed readings than with the filtered Doppler based speed value s alone.

In step within step the position based speed module can generate and or calculate a traveled distance for the device based on the set of position data and time data associated with the set of position data such as time stamps recording the date and time at which each position was recorded or identified based on the set of position signals .

In optional step a determination can be made by the position based speed module whether the traveled distance exceeds a predetermined distance limit. The predetermined maximum distance limit can reflect the greatest increment of distance that a user of device can be expected to travel within a given time interval. For instance for a user who is operating device while running the distance clamp and or other limit can be set to a value of merely for illustration one and one half times the previously determined speed multiplied by the time since the last position measurement. The optional clamp or limit is designed to represent the largest distance that a user moving at the previously determined speed could be expected to cover in the following interval of time. In implementations the distance clamp and or other limit can be set to other fixed or non fixed values such as a distance value of no more than 10 greater than that possible at the user s previously recorded top speed or a maximum speed of 15 miles per hour. Other values ranges parameters and or functions can be used to determine the distance clamp and or other limit. Different distance clamp and or other limit values can be used for different users of the same device and or different devices.

If the determination in step is no processing can proceed to step . If the determination in step is yes processing can proceed to step . In step the traveled distance can be set to the distance limit or clamp value and or to another maximum value. After step processing can proceed to step .

In step the position based speed module can generate and or calculate the current position based speed of the device based on the traveled distance or the distance limit if the distance clamp was applied in steps and . The calculation can be or include the change in distance divided by the change in time. In step the position based speed module can filter the calculated position based speed using the filter to generate a filtered position based speed value . In implementations the filter used by the position based speed module can be or include a Kalman filter but it will be appreciated that other types or classes of filters can be applied to the position based speed data generated from position values.

In step within step the Doppler speed module of the speed comparison module can receive the set of Doppler speed data from the set of position signals transmitted by the set of navigation satellites . In step the Doppler speed module can apply the filter to the received set of Doppler speed data . In implementations the filter used by the Doppler speed module can be or include a Kalman filter but it will be appreciated that other types or classes of filters can be applied to the Doppler speed data.

In step the Doppler speed module can generate and or calculate filtered Doppler based speed value s based on the output of the filter such as a Kalman filter.

In step the filtered Doppler based speed value s and the filtered position based speed value s for the same distance and or time period can be received or accessed by the combiner module . In step the combiner module can combine the filtered Doppler based speed value s and the filtered position based speed value s by selecting a maximum of those two values and or performing other operations on or applying other rules to those two sets of quantities. The combiner module can generate a compensated speed value or a set of such values as a result of the selection and or other operation s .

In step the speed comparison module can store the compensated speed value s and or other data recording speed activity for the user of device for instance in local memory of the device . In implementations the compensated speed value s and or other data can be uploaded or transmitted to other local or remote storage associated with the user of the device for instance to a network database or a cloud repository. In optional step the speed comparison module can show the compensated speed value s via the display and or other output component. In step processing can repeat return to a prior processing point jump to a further processing point or end.

It will be appreciated that while various processing activity logical decisions and or other operations illustrated in have been described as taking place in steps that two or more of those operations or activities can be combined into one operation or activity and that any one or more of those operations or activities can be divided into two or more operations or activities. Moreover while those various operations or activities have been illustrated and described as occurring in a certain order it will be appreciated that in implementations those same and or other operations or activities can take place in a different order or orders. Further while various operations or activities have been described as being carried out by certain hardware software service and or other resources it will be appreciated that in implementations the same activities and or operations can be carried out by other hardware software service and or other resources.

It will be appreciated that various hardware software and other resources can be used in implementations of systems and methods for generating compensated speed values for a Doppler enabled device according to implementations. For instance in implementations the device can comprise a platform including a processor communicating with memory such as electronic random access memory operating under control of or in conjunction with the operating system . The processor in implementations can be incorporated in one or more microprocessors microcontrollers chips servers clusters and or other computers or hardware resources and or can be implemented using cloud based resources. The operating system can be for example a distribution of the Linux operating system the Unix operating system or other open source or proprietary operating system or platform. The RF circuitry of the device can include resources such as a transceiver a modulator demodulator and an application programming interface API which can interface to a set of applications such as communications messaging texting telephony browser and or other applications or services. The processor of device can also interface with a data store such as a database stored on a local hard drive or drive array to access or store position data speed data and or subsets of selections thereof along with other content media or other data. The processor can in general be programmed or configured to execute control logic and to control various processing operations including to generate and or interface to the speed comparison module and or other hardware module application and or service and or other model engine logic application and or service the navigation engine and or other resources. Other configurations of the device associated radio frequency hardware or software network connections and other hardware software and service resources are possible.

The foregoing description is illustrative and variations in configuration and implementation may occur to persons skilled in the art. For example while implementations have been described in which the position based speed module and the Doppler speed module each incorporate one filter filter and filter respectively in implementations those modules can incorporate multiple filters and or other processing units modules and or nodes. In implementations for further example more than one module can perform the same operations as each of the individual position based speed module and the Doppler speed module . Other resources described as singular or integrated can in implementations be plural or distributed and resources described as multiple or distributed can in implementations be combined. The scope of the present teachings is accordingly intended to be limited only by the following claims.

