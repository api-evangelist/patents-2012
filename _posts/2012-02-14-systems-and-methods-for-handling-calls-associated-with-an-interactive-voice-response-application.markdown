---

title: Systems and methods for handling calls associated with an interactive voice response application
abstract: A method for processing a call is provided. The method includes receiving an inbound call leg via a network device. The inbound call leg is processed using an interactive voice response (IVR) device, and an outbound call leg is generated based on processing the inbound call leg. The outbound call leg is made available to the network device. The inbound call leg and the outbound call leg are handed off from the IVR device to the network device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08750467&OS=08750467&RS=08750467
owner: Verizon Patent and Licensing Inc.
number: 08750467
owner_city: Basking Ridge
owner_country: US
publication_date: 20120214
---
This application is a continuation of U.S. patent application Ser. No. 11 115 374 filed Apr. 27 2005 the disclosure of which is incorporated by reference herein in its entirety.

Implementations consistent with the invention relate generally to communication networks and more particularly to systems and methods for implementing call handoffs associated with an interactive voice response IVR application operating in an Internet protocol environment.

Historically voice based telephone communications have been handled via dedicated networks such as the public switched telephone network PSTN while data communications have been handled via dedicated packet networks such as Internet protocol IP networks. A current trend is to converge these two types of networks where telephone voice traffic and other forms of real time media are converted into digital form and carried by a packet data network along with other forms of data. These converged networks may offer many advantages such as lower operating costs as compared to maintaining separate voice and data networks greater flexibility regarding service offerings to customers such as multimedia conferencing and more efficient use of network resources such as network hardware and software.

Conventional telephones may employ dual tone multifrequency DTMF signals for placing calls to a called party. DTMF techniques assign dual tones to each number on a keypad associated with a telephone handset. When a user depresses a number a unique dual tone signal may be generated. The PSTN uses DTMF signals to route calls through appropriate intermediary devices such as central offices and switches to arrive at a desired destination associated with a called party. Converged networks may employ telephone gateways for converting PSTN signals such as DTMF signals into packetized data for use in a data network such as the Internet. Telephone gateways may digitize DTMF signals and encode them into standardized formats for use with portions of the network running packet protocols.

Users of converged network telephone services may use DTMF tones for dialing destination phone numbers and for performing other applications on converged networks. For example users may require assistance and or information from service providers corporations institutions and or government agencies using a telephone device. In many instances a user may interact with an interactive voice response IVR system while obtaining assistance and or information.

IVR systems may be used for processing incoming calls. For example a customer may call a telephone company to report a problem with a telephone line. The telephone company may employ an IVR system for processing incoming calls. When the call is received at the telephone company an IVR system may answer the call and prompt the user to enter for example a telephone number associated with a malfunctioning line via a recorded message. The IVR system may detect a series of DTMF signals associated with a sequence of digits depressed by the user in response to the IVR prompts. Efficiently operating IVR systems may require that operators of these systems attempt to handle calls in a cost effective manner.

In accordance with an aspect of the invention a first network device for establishing a communication session with a destination is provided. The first network device may include a first network interface configured to receive a first inbound portion of an inbound call leg and make the first inbound portion available to a second network device where the first inbound portion between the first network device and the second network device is referred to as a second inbound portion. The first network device may include a second network interface configured to receive a first outbound portion of an outbound call leg that originates from the second network device and make the first outbound portion available to the destination where the first outbound portion between the first network device and the destination is referred to as a second outbound portion. The first network device may include a processor operatively associated with the first network interface and the second network interface. The processor may be configured to make the second inbound portion available to the second network device receive the first outbound portion when the second network device has interacted with the second inbound portion and bridge the first inbound portion to the second outbound portion.

In accordance with another aspect of the invention a media server is provided. The media server may include an interactive voice response IVR module for processing a dual tone multifrequency DTMF signal associated with an inbound call leg. The media server may include a first network interface for receiving the inbound call leg and a second network interface for making an outbound call leg available to a network device. The media server may include a processor configured to make the inbound call leg available to the IVR module establish the outbound call leg based on the processing performed by the IVR module and handoff the inbound call leg and the outbound call leg to the network device.

In accordance with still another aspect of the invention a system configured to establish a communication session in a communications network is provided. The system may include a media server having a first media server port and a second media server port. The system may include a media firewall configured to receive an inbound call leg via the network the received inbound call leg being a first inbound call leg make the inbound call leg available to the first media server port to form a second inbound call leg receive an outbound call leg from the second media server port the received outbound call leg being a first outbound call leg make the outbound call leg available to a destination device to form a second outbound call leg and bridge the first inbound call leg to the second outbound call leg where the bridging causes the media server to be removed from the communication session.

In accordance with yet another aspect of the invention a method for processing a call is provided. The method may include receiving an inbound call leg via a network device and processing the inbound call leg using an interactive voice response IVR device. The method may include generating an outbound call leg based on processing of the inbound call leg and making the outbound call leg available to the network device. The method may include handing off the inbound call leg and the outbound call leg from the IVR device to the network device.

The following detailed description of implementations consistent with the principles of the invention refers to the accompanying drawings. The same reference numbers in different drawings may identify the same or similar elements. Also the following detailed description does not limit the invention. Instead the scope of the invention is defined by the appended claims and their equivalents.

Implementations consistent with the principles of the invention may provide call bridging in IVR applications using media firewall ports in lieu of media server ports. In this way the media server may be freed up to perform other functions.

Data network may include one or more networks such as the Internet an intranet a local area network LAN a metropolitan area network MAN a wide area network WAN or another type of network that is capable of transmitting data from a source device to a destination device. Telephone network may include one or more public switched telephone networks PSTNs or other types of switched networks. Telephone network may also include one or more wireless networks.

Telephone device may include any device capable of making and or receiving calls using PSTN compatible signals. For example telephone device may include a plain old telephone system POTS handset. Telephone device may include a landline telephone device or a wireless telephone device. Telephone device may be implemented as a standalone telephone device or may be integrated with other devices such as an intercom device a two way messaging system a display terminal a personal organizer etc.

Network gateway may include one or more devices that allow divergent transport networks to cooperatively carry traffic. Network gateway may provide for interoperation between different signaling schemes and between different media forms. For example network gateway may adapt between SS7 signaling of telephone network and SIP or H.323 protocols used by data network . At the same time network gateway may adapt analog voice signals in a telephone bearer channel to a packetized data stream suitable for transport over data network . Moreover network gateway may convert DTMF signals into RFC 2833 compatible digital representations for use in data network .

Service controller may include one or more devices configured to facilitate control of media server and media firewall . For example service controller may operate to coordinate initial routing of a voice path through media firewall in route to media server . In addition service controller may operate to re route or drop inbound call legs to media server . Service controller may also operate to re route or drop outbound call legs originating at media server . Implementations of service controller may be configured as a SIP application server having proxy server functionality that facilitates the establishment of SIP calls and or location server functionality that provides a repository for end user information to enable for example address validation feature status and real time subscriber feature configuration. SIP is a signaling protocol for initiating managing and terminating voice and video sessions across packet networks. SIP may be used to facilitate flexible system architectures capable of handling media types in substantially real time such as voice video and images.

Media server may include a server configured to receive data or requests from devices such as conventional telephones SIP device mobile phones facsimile machines computers and or personal digital assistants PDAs . Media server may support advanced processing of voice and or media streams. For example media server may provide for voice announcements multi party conferencing messaging text to speech TTS speech recognition and IVR.

Media server may employ circuit media via a telephony interface such as legacy T1 digital signal DS 3 and call control protocols and or packet media such as IP media. Media server may utilize application programming interfaces APIs and protocols for controlling media resources at the server or platform level. For example voice extensible markup language VoiceXML speech application language tags SALT or Java based APIs such as S.410 may be used for implementing APIs. In one implementation media server may operate to provide IVR capabilities to a contact center such as a help desk associated with a telephone company. As used herein contact center refers to any destination e.g. a called party that uses DTMF signals alone or in combination with other techniques for receiving inputs from a calling party. For example a contact center may be a financial institution a voice mail system an ordering application a human resources application an educational institution and or a government entity that employs DTMF signaling to process a portion of a call received from a calling party. Contact centers may use DTMF signals exclusively or they may use DTMF signals in conjunction with other signaling techniques such as voice recognition text and or specialized signaling devices.

Media firewall also referred to as a session border controller SBC may include a device operating as a firewall and or a signaling and media routing platform. In one implementation media firewall may operate at a network border. For example media firewall may operate at the border of data network to protect media server from unauthorized packets. Media firewall may have a public side or interface and a private side or interface. The public side may be coupled to an unsecured or untrusted network such as the Internet while the private side may be coupled to a trusted network such as a corporate LAN. Media firewall may allow only authorized packets to pass from the public side to the private side. Media firewall may be configured to handle network address translation NAT traversal issues so that quality of service QoS sensitive applications may be used such as voice over IP VoIP and real time media. Media firewall may also be adapted to allow peering with other network devices such as network gateway . Media firewall may support multiple protocols such as SIP H.323 signaled real time protocol RTP media and processing of DTMF signals.

Media firewall may be implemented as a media pivot in one implementation. Media pivot as used herein refers to a device capable of performing DTMF detection and or bridging an input port to an output port. For example a media pivot may be implemented in software to provide DTMF detection at a low per port cost as compared with media firewall ports and or media server ports.

SIP device may include any client e.g. a computer device a web appliance etc. that is configured to provide SIP telephone functions. SIP device may be implemented in a standalone device such as a dedicated SIP phone and or SIP device may be incorporated with other devices such as a SIP PSTN hybrid phone. SIP device may also include a software client that may run for example on a conventional personal computer PC laptop computer or personal digital assistant PDA .

Although implementations consistent with the principles of the invention are described below in the context of a SIP and or an IP based network one of ordinary skill in the art will recognize that implementations consistent with the invention may be generally applicable to other equivalent or analogous communication protocols e.g. International Telecommunication Union ITU H.323 and or types of transport networks e.g. asynchronous transfer mode ATM frame relay etc. . Both the ITU H.323 standard and the IETF s SIP are examples of protocols that may be used for establishing a communications session among terminals such as telephone like devices that may be connected to a network. The SIP protocol is described in IETF document RFC 2543 and its successors RFC 3261 et al. .

Processor may include any type of conventional processor or microprocessor that interprets and executes instructions. Memory may include a random access memory RAM or another type of dynamic storage device that stores information and instructions for execution by processor . Memory may also be used to store temporary variables or other intermediate information during execution of instructions by processor .

ROM may include a conventional ROM device and or another type of static storage device that stores static information and instructions for processor . Storage device may include a magnetic disk or optical disk and its corresponding drive and or some other type of magnetic or optical recording medium and its corresponding drive for storing information and or instructions.

Input device may include any conventional mechanism or combination of mechanisms that permits the operator to input information to media server such as a keyboard a mouse a microphone a pen based pointing device a biometric input device such as a voice recognition and or a finger print scanning device. Output device may include any conventional mechanism or combination of mechanisms that outputs information to the operator including a display a printer a speaker etc.

Communication interface may include any transceiver like mechanism that enables media server to communicate with other devices and or systems such as media firewall . For example communication interface may include a modem and or an Ethernet interface or port. Alternatively communication interface may include other mechanisms for communicating via a data network such as network .

Media server may implement the functions described below in response to processor executing software instructions contained in a computer readable medium such as memory . A computer readable medium may be defined as one or more memory devices and or carrier waves. In alternative embodiments hardwired circuitry may be used in place of or in combination with software instructions to implement features consistent with the principles of the invention. Thus implementations consistent with the principles of the invention are not limited to any specific combination of hardware circuitry and software.

Bus may include one or more conventional buses that permit communication among the components of media firewall . Processor may include any type of conventional processor or microprocessor that interprets and executes instructions. Memory may include a RAM or another type of dynamic storage device that stores information and instructions for execution by processor . Memory may also be used to store temporary variables or other intermediate information during execution of instructions by processor .

Communication interface may include any transceiver like mechanism that enables media firewall to communicate with other devices and or systems such as media server . For example communication interface may include a network interface card NIC a communications port a hardwired connection etc. Alternatively communication interface may include other mechanisms for communicating via a data network such as network .

Media firewall may implement the functions described below in response to processor executing software instructions contained in a computer readable medium such as memory . In alternative embodiments hardwired circuitry may be used in place of or in combination with software instructions to implement features consistent with the principles of the invention. Thus implementations consistent with the principles of the invention are not limited to any specific combination of hardware circuitry and software.

In implementations consistent with principles of the invention media firewall may receive an inbound call from a user such as a user of telephone device and pass the inbound call to media server . Media firewall may also receive outbound calls from media server and pass them on to other devices and or users on a network such as a contact center or a gateway. Media firewall may further perform call handoffs with media server where media firewall bridges an inbound call leg with an outbound call leg using one or more ports and or a bridging technique. Implementations consistent with principles of the invention may free up media server ports through the use of bridged media firewall ports. The free media server ports may be available to service additional inbound call legs.

Media firewall may receive inbound leg from network via network gateway . An inbound leg may consist of a calling session originated by telephone device and or SIP device . For example a user may place a call to a contact center to obtain assistance. The contact center may be operatively associated with IVR module . The user s call may arrive at media firewall as an inbound leg having a destination associated with IVR module on media server . Inbound leg may arrive at a network interface such as firewall port . Media firewall may pass inbound leg to a network interface associated with media server such as server port as portion A. Portion A and B refer to portions of an inbound or outbound call leg respectively. Portion A and B may be carried over a link however the terms portion A and portion B are not intended to refer to the physical link itself but rather refer to data exchanged between media firewall and media server over a link connecting them.

Media server may process inbound leg using IVR module . IVR module may play for example recorded messages asking the user to input DTMF signals using a keypad associated with telephone device . IVR module may process the DTMF signals generated by the sequence of digits depressed by the user referred to as a digit sequence . Based on the digit sequence IVR module may for example route inbound leg to an operator associated with the contact center. For example IVR module may route the user to a customer service representative after identifying the digit sequence received from the user. The user may carry on a conversation with the customer service representative to facilitate processing of the user s request.

The customer service representative may determine that inbound leg should be routed to another destination to further process the user s request. The customer service representative may dial a sequence of digits associated with a forwarded destination. Forwarded destination may refer to a calling destination that is contacted after an initial inbound leg is processed by an initial destination which in the example above is the customer service representative. For example IVR module may detect the DTMF signals received from the customer service representative initial destination and generate an outbound leg for connecting the user with a forwarded destination.

Media server may originate outbound leg using a server port such as server port . Outbound leg may be routed through a port of media firewall in route to the forwarded destination. For example outbound leg may be connected to firewall port . Media firewall may direct outbound leg to the forwarded destination using firewall port .

Media servers such as media server may run complex software applications that interact with numerous interfaces such as server ports . For example a media server may run multiple IVR applications text to speech TTS applications call forwarding applications messaging applications and multimedia applications in conjunction with numerous server ports . This complexity may result in relatively high per port costs for media server ports such as server ports to N. If server ports are not used efficiently operating costs may remain above a desired level.

For example a calling session may consist of the activities shown in Table 1 each taking the indicated amount of time on a respective media server port to N. In this example assume an inbound leg is received on a first media server port e.g. server port and an outbound leg is originated using a second media server port e.g. server port .

Media firewall may maintain the call between the user and the forwarded destination by bridging the firewall port associated with the inbound leg to the firewall port associated with the outbound leg. For example media firewall may use bridge to connect inbound leg associated with firewall port to outbound leg associated with firewall port . Bridge may be implemented in hardware software and or a combination of hardware and software. The handoff from media server to media firewall may be transparent to the user and to an operator at a destination. The handoff of portion A and portion B may be controlled in whole or in part by service controller .

In one implementation media firewall may bridge firewall port to firewall port based on a handoff message received from media server and or service controller . When firewall port and are bridged a user may participate in a communication session with a forwarded destination using the bridged communication session. Bridged communication session refers to a call or communication session routed through media firewall without requiring substantial ongoing DTMF monitoring and or intervention by other network devices such as media server .

By way of comparison the call example illustrated in Table 1 used one media server port for 380 seconds and another media server port for 310 seconds. An implementation consistent with the principles of the invention may employ a bridged communication session where media firewall bridges an inbound leg and an outbound leg together to remove media server from a portion of the calling or communication session. For example referring to the example associated with Table 1 the port usages shown in Table 2 may be realized when using a bridged communication session in conjunction with media firewall .

Media server port usage may be reduced from 380 seconds to 80 seconds for a first port associated with an inbound leg and from 310 seconds to 10 seconds for a second port associated with an outbound leg. As seen from these examples significant reductions in media server port usage may be realized when media firewall bridges an inbound leg to an outbound leg and performs DTMF signal detection on the bridged calling session.

Referring back to media firewall may monitor the bridged communication session for DTMF signals. When a DTMF signal is detected media firewall may process the signal before reestablishing inbound leg i.e. portion A and or outbound leg i.e. portion B with media server or media firewall may reestablish inbound leg and or outbound leg with media server whenever a DTMF tone is detected. Media server may process DTMF signals when media firewall does not process DTMF signals or both media firewall and media server may process a DTMF signal.

Media firewall may detect DTMF signals using digital signal processing DSP techniques known in the art and or by looking for encoded DTMF signals within packets passing through firewall ports . For example DTMF signals may be encoded in IP packets using industry standard protocols such as RFC 2883. Use of encoded DTMF signals in packets facilitates efficient and inexpensive monitoring for DTMF signals since DSP cards and or interfaces may not be required.

Implementations of modern contact centers may employ a technique called take back and transfer TNT . TNT allows a destination such as the forwarded destination to transfer a call back to media server and or another destination such as in call forwarding or conference calling. TNT may be accomplished using a special sequence of DTMF signals. For example TNT may be initiated when a party dials 8 using a keypad associated with a telephone device. When a processing device detects DTMF signals associated with 8 inbound leg may be connected to IVR module using a server port to N by way of TNT inbound leg . Dialing 8 may further cause the forwarded destination to be connected to IVR module by way of TNT outbound leg . A processing device associated with firewall and or media server may monitor the duration of the bridged communication session to ensure that TNT digit sequences are promptly detected.

Implementations consistent with the principles of the invention may implement processing functions associated with DTMF signal detection including TNT in media firewall . Implementing DTMF signal detection in media firewall may have advantages as compared to performing TNT detection in media server . For example performing DTMF signal detection in media firewall may associate DTMF detection with ports having lower costs as compared to media server ports and or performing DTMF signal detection in media firewall may reduce the amount of time that media server ports are used to monitor calls.

Media firewall may connect inbound leg to a server port to N associated with a media server act . For example media firewall may connect inbound leg to server port .

Media server may perform IVR interactions on inbound leg using IVR module act . For example IVR module may request that the user enter a customer number or a serial number associated with the broken computer. In response to the request the user may enter a digit sequence by for example entering the appropriate digits on telephone device . Media server may receive and process DTMF signals produced by the user entering the digit sequence and perform an action based on the processing. For example IVR module may connect the user with a customer service representative after processing DTMF signals received from the user. The customer service representative may ask the user to provide details about a problem with the computer. Assume for example that the user has described a problem associated with the operating system of the computer in response to questions asked by the customer service representative. The customer service representative may determine that the user needs to be connected to a specialist having expertise with the particular operating system running on the user s computer. The customer service representative may dial a sequence of digits associated with the appropriate specialist and IVR module may detect the DTMF signals generated by the customer service representative.

In response media server may establish an outbound leg using a server port and a port associated with firewall act . Media server may establish outgoing leg so as to connect the user with the specialist located at a forwarded destination. In one implementation outbound leg may be established using different ports on media server and media firewall than were used for inbound leg . Assume for example that outbound leg is established using server port and firewall port .

Media firewall may bridge inbound leg with outbound leg using bridge act . Media firewall may bridge firewall port to firewall port and may drop portion A of inbound leg and portion B of outbound leg See . The handoff from media server to media firewall may be transparent to the user the operating system specialist and or the forwarded destination.

Media firewall may monitor inbound leg and or outbound leg for DTMF signals act . When a DTMF signal is detected media firewall may handoff inbound leg and or outbound leg to media server using TNT inbound leg and or TNT outbound leg act . For example media firewall may support a bridged communication session between the user and the operating system specialist using firewall port firewall port and bridge . Media firewall may detect a DTMF signal including a digit sequence such as 8 . When 8 is detected media firewall may reestablish inbound leg and or outbound leg with media server via TNT inbound leg and or TNT outbound leg respectively.

Media server may perform additional processing of inbound leg or outbound leg using IVR module act . Media server may also process the retrieved legs using other techniques such as by using a human operator a TTS module and or a voice recognition module. Media server may connect inbound leg and or outbound leg to an additional outbound leg for establishing a call with a second forwarded destination.

For example the customer service representative may determine that the user was able to solve only a portion of the computer problem by speaking with the operating system specialist. The customer service representative may determine that the user needs to speak with the operating system specialist and a hardware specialist simultaneously. Media server may keep inbound leg and outbound leg active while initiating a second outbound leg to the hardware specialist. After making contact with the hardware specialist media server may handoff inbound leg outbound leg and the second outbound leg to media firewall . Media firewall may bridge all three legs together in a conference call using one or more bridges operating in conjunction with firewall ports . Media firewall may monitor the bridged legs for DTMF signals. If DTMF signals are detected media firewall may hand off inbound leg outbound leg and or the second outbound leg to media server .

To initiate the signaling flow of service controller may receive an INVITE request from network gateway in response to a user dialing a sequence of digits. INVITE request may indicate that the called party is being invited to participate in a session. The INVITE request may provide the called party with enough information to join the session. For example INVITE request may include a session description protocol SDP portion. SDP is a short structured textual description of the name and purpose of the session and the media protocols codec formats timing and transport information that are used to decide whether a session is likely to be of interest. SDP may further include information for informing the called device how to start media tools to participate in the session. INVITE request may also indicate the type of media that the calling party s telephone device is able to receive and or possibly the media that the calling party s telephone device is willing to send.

In response to INVITE request service controller may transmit a create resource command CRR to media firewall . Media firewall may respond with a CRR response . CRR response may include information relating to source and destination firewall ports. For example CRR response may include an address associated with source and destination firewall ports. The source port may include a port to which an inbound leg may be established and the destination port may include a port from which an inbound leg may be established between media firewall and media server . This port information may be used to construct an SDP that is included in an INVITE message that may be sent from service controller to media server . Media server may use the media firewall source port information associated with inbound leg to construct an SDP for inclusion in a 200 OK response message sent from media server to service controller . The 200 OK response message may indicate that the INVITE message was successfully received and acknowledged and may include media server port information to which the inbound leg is to be established.

Service controller may respond to the 200 OK response with an acknowledgement ACK message indicating that the 200 OK message was received. Service controller may send a 200 OK response to network gateway . 200 OK response may include information relating to the media firewall source port. Network gateway may acknowledge receipt of the 200 OK response with an ACK message . The above signaling may result in an inbound leg being established between network gateway and media firewall via a source port associated with media firewall and between media firewall and media server via a destination port associated with media firewall . Inbound leg may include an RTP session for facilitating voice communication.

Service controller may send a CRR message to media firewall . Media firewall may respond with a CRR response that may include information about source and destination firewall port to be used for outbound leg . CRR response may be sent from firewall to service controller . Service controller may send an INVITE request to network gateway . INVITE request may include an SDP containing information about media firewall . The SDP of INVITE request may include for example information about the type of session being requested. INVITE request may be directed to a device associated with a forwarded destination. For example INVITE request may be directed to a telephone device associated with the operating system specialist associated with the example discussed in conjunction with .

Service controller may receive a 200 OK message from network gateway . 200 OK response may indicate that INVITE request was successfully received and acknowledged and may include gateway port information to which outbound leg is to be established. Service controller may respond to 200 OK response with an ACK response . ACK response may constitute an acknowledgement that the 200 OK response was received by service controller . ACK response may also act as the final message exchange between network gateway and service controller when establishing an outbound call leg.

Service controller may send an INVITE message to media server . INVITE message may include an SDP containing information about the requested session. For example the SDP may include information about firewall being used to establish the outbound leg. For example the SDP may include information identifying a destination port associated with media firewall . Media server may respond to receipt of INVITE message by sending a 200 OK message . 200 OK message may indicate that INVITE message was successfully received and may identify a port on media server from which outbound leg is to be established. Service controller may respond to receipt of the 200 OK message by sending an ACK message . ACK message may operate as a final handshake in the message exchange between service controller and media server before establishing outbound leg using media firewall .

Processing may begin with service controller receiving a message requesting that one or more call legs be released from media server . For example an application server residing on network may contact service controller and request that portion A of inbound leg and portion B of outbound leg be released. The application server may send a release message to service controller to initiate the release of portion A and portion B of the respective call legs. Service controller may issue a response message to the application server indicating that the release message has been received.

Service controller may issue an inbound leg BYE request to media server . Inbound leg BYE request may include information useful for effectuating the release of portion A of inbound leg . Media server may respond with an inbound leg 200 OK response to acknowledge that BYE request was received. Service controller may issue an outbound leg BYE request to media server . Outbound leg BYE request may include information useful for effectuating the release of portion B of outbound leg . Media server may respond with an outbound leg 200 OK response to acknowledge that BYE request was received.

Service controller may send an INVITE request to network gateway regarding outbound leg . For example INVITE request may include a SDP containing information about retaining inbound leg during and or after portion A is dropped and bridge is in place for the call. INVITE request may operate as a re invitation sent from service controller to network gateway to reestablish outbound leg via bridge . Implementations may include a re invitation for inbound leg in addition to or in lieu of the re invitation for outbound leg .

Network gateway may respond to INVITE request with a 200 OK response . 200 OK response may indicate that INVITE request was received by network gateway and may include information identifying the gateway port to which outbound leg is established. Service controller may respond with an ACK response to acknowledge receipt of the 200 OK response . ACK response may act as the final handshake in the exchange between network gateway and service controller .

Portion A of inbound leg and portion B of outbound leg may be dropped after the message exchange messages between service controller and network gateway . Bridge may be employed to maintain connectivity between inbound leg and outbound leg using one or more firewall ports. Firewall may monitor inbound leg and outbound leg for DTMF signals while bridge is in place as set forth above with respect to .

Media firewall may detect a DTMF signal and send a notify DTMF NTF DTMF message to service controller . NTF DTMF message may include information about the leg on which the DTMF signal was detected and information about the digit sequence responsible for the DTMF signals. Service controller may respond with a notify response message . Service controller may send a CRR message to media firewall . Media firewall may respond with a CRR response . CRR response may include information about the firewall ports required to establish TNT inbound leg and or TNT outbound leg with media server .

Media firewall may send an INVITE request to network gateway . INVITE request may include an SDP containing information about a call leg that will be reconnected to media server using one of the TNT legs. In one implementation the SDP may include information identifying a source port of media firewall with which the leg is associated. INVITE request may operate as a re invitation request for outbound leg . INVITE request may cause outbound leg to be associated with a new and or separate port on media firewall when communicating with media server . Implementations may employ a re invitation request associated with inbound leg if desired. For example a re invitation request may cause inbound leg to become associated with a new and or separate port on media firewall .

Network gateway may respond with a 200 OK response indicating that INVITE request was received and understood. In one implementation 200 OK response may include information identifying a port of gateway . Media firewall may respond to receipt of 200 OK response with an ACK response .

Service controller may send an INVITE message to media server . INVITE message may include an SDP containing information about the firewall ports used for establishing TNT legs to media server . For example the SDP may include information pertaining to an invitation for connecting inbound leg to a session with media server . Media server may respond by sending a 200 OK message to service controller . 200 OK message may indicate that INVITE message was received and understood by media server and may include information identifying the port of media server to which inbound leg is to be established. Service controller may send an ACK message to indicate that the 200 OK message was received.

Media server may generate and send an INVITE message to session controller . INVITE message may include an SDP containing information about a call leg associated with one or more TNT legs. For example the SDP of INVITE message may include information for associating outbound leg with TNT leg and or information about a server port used for receiving TNT leg . Service controller may respond to INVITE message by sending a 200 OK message to media server . 200 OK message may indicate that INVITE message was received and understood and may identify the port of media server from which outbound leg is to be established. Media server may send an ACK message to service controller to acknowledge receipt of 200 OK message . ACK message may act as a final handshake message in the exchange between media server and session controller .

TNT leg and or TNT leg may be established between firewall and media server using firewall ports and media server ports . After establishing TNT legs and IVR module may operate on inbound leg and or outbound leg to further process DTMF signals associated with the calling session.

Implementations consistent with the principles of the invention employing signaling flows such as those illustrated in may reduce the amount of time media server ports are used to support a particular calling session. In particular implementations may operate to substantially restrict use of media server ports to those portions of a call requiring DTMF signal processing and or IVR interaction. As a result implementations may enable a given number of media server ports to service a larger number of calls than might be possible if media firewall did not operate to bridge an inbound call leg to an outbound call leg.

Implementations consistent with the principles of the invention may be used to facilitate re origination requests using for example pre paid calling cards. For example a user may make a first call using an account number associated with for example a conventional calling card and or a pre paid calling card. At the end of the first call the user may dial a special digit sequence such as 2. The DTMF signals created by the digit sequence 2 may act as a re origination request. The re origination request may let the user dial a new number associated with a called party without hanging up the handset and or without having to re enter information about the calling card such as a serial number an account number and or authorization number. Media firewall may detect 2 and cause portion B to be dropped cause media server to establish a new outbound leg and cause firewall to drop portion A and B after bridging the new outbound leg with the current inbound leg.

Implementations consistent with the principles of the invention may be used to facilitate enhanced call routing features such as call forwarding call take back call give back and signal transfer. These enhanced call routing features may be facilitated using media firewall and DTMF signal detection and or processing associated with one or more media firewall ports.

Systems and methods consistent with the principles of the invention allow for the handoff of call legs from a media server to a media firewall to thereby free up the media server to perform other functions.

The foregoing description of exemplary embodiments of the invention provides illustration and description but is not intended to be exhaustive or to limit the invention to the precise form disclosed. Modifications and variations are possible in light of the above teachings or may be acquired from practice of the invention. For example while series of acts have been described with respect to the order of the acts may be varied in other implementations consistent with the invention. Moreover non dependent acts may be implemented in parallel.

No element act or instruction used in the description of the application should be construed as critical or essential to the invention unless explicitly described as such. Also as used herein the article a is intended to include one or more items. Where only one item is intended the term one or similar language is used. Further the phrase based on is intended to mean based at least in part on unless explicitly stated otherwise.

