---

title: Device and method for controlling an input signal of a power amplifier
abstract: A method for controlling an input signal of a power amplifier is provided. The method comprise applying CFR to the input signal to obtain a processed input signal; determining a minimum CFR threshold; comparing the peak power of the power amplifier and an allowable peak power; and if the peak power is below the allowable peak power, determining a final CFR threshold by increasing the minimum CFR threshold, or if the peak power is not below the allowable peak power, reducing the average output power until peak power reaches the allowable peak power.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09148096&OS=09148096&RS=09148096
owner: Telefonaktiebolaget L M Ericsson (publ)
number: 09148096
owner_city: Stockholm
owner_country: SE
publication_date: 20120222
---
This nonprovisional application is a U.S. National Stage Filing under 35 U.S.C. 371 of International Patent Application Serial No. PCT CN2012 071460 filed Feb. 22 2012 and entitled Device and Method for Controlling an Input Signal of a Power Amplifier. 

This invention is related to crest factor reduction CFR in communication systems particularly crest factor reduction in signal transmitter.

Current wireless communication systems use spectral efficiency modulation of RF carriers e.g. W CDMA LTE WiMAX and MSR . In these systems radio downlink signal is characterized to have high peak to average ratio PAR . To amplify such signal it is required to use high linearity power amplifier PA which results in low PA efficiency and high cost. CFR algorithms are widely used to reduce PAR. CFR with proper threshold can significantly reduce PAR while having acceptable error vector magnitude EVM degradation leading to improved efficiency and reduced cost.

Different CFR thresholds result in different EVM performance and PAR values. Higher threshold means worse higher PAR but better EVM while lower threshold means better lower PAR and worse EVM. EVM is limited by modulation accuracy requirement and PAR is limited by average power level and PA peak power capability. CFR thresholds and average power level should be properly selected so that good EVM can be achieved while peak power value which can be calculated as the sum of PAR and average power level do not exceed PA peak power capability.

PAR and EVM is decided not only by CFR threshold but also by carrier configurations for example carrier radio standards carrier numbers modulation types carrier frequency spacing and power allocation among carriers.

CFR thresholds and average power levels are normally predefined for different carrier configurations. This is all right when radio units support limited carrier configurations. But now modern radio units are expected to support complex carrier configurations including multi standards radio multi carrier numbers different modulation types wide instantaneous band width IBW and flexible power allocation among different carriers. See . There are thousands of different carrier combinations so it is impossible to set or predefine CFR threshold and average power level for every possible carrier configuration.

One possible solution is to divide all carrier configurations into several groups and use a general rule for each group. In order to have all carrier configurations in the group to meet EVM and PA peak power capability requirement the worst carrier configuration defines CFR threshold and average power level settings. Drawback is that the settings are not optimized for each carrier configuration. This results in hardware capability waste and it is a time consuming task to find general rules for different groups.

And since the same clipping thresholds are used for all radio units radio unit with the lowest PA peak power capability is used to define target PAR for clipping. This results in waste of hardware performance.

The document CN101969423A describes a method for setting CFR threshold based on the output of PA. The disclosed embodiments improve the efficiency and precise of PA. However this document focuses on TD SCDMA and LTE communication systems only and it is questionable as to whether it is applicable to other systems. Besides the disclosed solutions can not obtain optimized EVM.

A method for controlling an input signal of a power amplifier is provided. The method comprise applying crest factor reduction to the input signal to obtain a processed input signal determining a minimum crest factor reduction threshold such that an error vector magnitude degradation caused by crest factor reduction reaches a maximum acceptable error vector magnitude degradation comparing Peak to Average Ratio of the processed input signal plus an average output power of the power amplifier and an allowable peak power of the power amplifier and if the Peak to Average Ratio plus the average output power is below the allowable peak power determining a final crest factor reduction threshold by increasing the minimum crest factor reduction threshold until the Peak to Average Ratio plus the average output power reaches the allowable peak power or if the Peak to Average Ratio plus the average output power is not below the allowable peak power determining the final crest factor reduction threshold to be the minimum crest factor reduction threshold and reducing the average output power until Peak to Average Ratio plus the average output power reaches the allowable peak power.

A device for controlling an input signal of a power amplifier is provided. The device comprises a crest factor reduction unit for applying crest factor reduction to the input signal to obtain a processed input signal a minimum crest factor reduction threshold determiner configured for determining a minimum crest factor reduction threshold such that an error vector magnitude degradation caused by crest factor reduction reaches a maximum acceptable error vector magnitude degradation a power comparator configured for comparing Peak to Average Ratio of the processed input signal plus an average output power of the power amplifier and an allowable peak power of the power amplifier a final crest factor reduction threshold determiner configured for determining the final crest factor reduction threshold by increasing the minimum crest factor reduction threshold until Peak to Average Ratio plus the average output power reaches the allowable peak power if the Peak to Average Ratio plus the average output power is below the allowable peak power or determining the final crest factor reduction threshold to be the minimum crest factor reduction threshold if Peak to Average Ratio plus the average output power is not below the allowable peak power and an average output power control unit configured for reducing the average output power until Peak to Average Ratio plus the average output power reaches the allowable peak power if the Peak to Average Ratio plus the average output power is not below the allowable peak power.

A computer readable medium with computer code thereon for controlling an input signal of a power amplifier is provided. The computer readable medium comprises instructions for applying crest factor reduction to the input signal to obtain the processed input signal instructions for determining a minimum crest factor reduction threshold such that an error vector magnitude degradation caused by crest factor reduction reaches a maximum acceptable error vector magnitude degradation instructions for comparing Peak to Average Ratio of the processed input signal plus an average output power of the power amplifier and an allowable peak power of the power amplifier instructions for determining a final crest factor reduction threshold by increasing the minimum crest factor reduction threshold until Peak to Average Ratio plus the average output power reaches the allowable peak power when Peak to Average Ratio plus the average output power is below the allowable peak power and instructions for determining the final crest factor reduction threshold to be the minimum crest factor reduction threshold and reducing the average output power until Peak to Average Ratio plus the average output power reaches the allowable peak power when Peak to Average Ratio plus the average output power is not below the allowable peak power.

A device for controlling an input signal of a power amplifier is provided. The device comprises a crest factor reduction unit an average power meter connected with an output of the crest factor reduction unit a peak power meter connected with the output of the crest factor reduction unit a Peak to Average Ratio meter configured for determining Peak to Average Ratio according to outputs of the average power meter and the peak power meter and for determining whether Peak to Average Ratio plus an average output power of the power amplifier is below an allowable peak power of the power amplifier a error vector magnitude calculator with inputs from both the output of the average power level controller and the output of the crest factor reduction unit a threshold determiner configured for determining crest factor reduction threshold based on outputs of the Peak to Average Ratio meter and the error vector magnitude calculator and an average power level controller configured for controlling average power level of the input signal based on the output of the Peak to Average Ratio meter.

A signal transmitter is provided. The signal transmitter comprises a signal source a power amplifier a signal processor for processing a signal from the signal source for the power amplifier wherein the signal processor comprising a crest factor reduction unit an average power meter connected with the output of the crest factor reduction unit a peak power meter connected with the output of the crest factor reduction unit a Peak to Average Ratio meter configured for determining Peak to Average Ratio according to an output of the average power meter and the peak power meter and for determining whether Peak to Average Ratio plus an average output power of the power amplifier is below an allowable peak power of the power amplifier a error vector magnitude calculator with inputs from both the output of the average power level controller and the output of the crest factor reduction unit a threshold determiner configured for determining crest factor reduction threshold based on the output of the Peak to Average Ratio meter and the error vector magnitude calculator and an average power level controller configured for controlling average power level of the signal from the signal source based on the output of the Peak to Average Ratio meter.

A detailed description is now provided with reference to the accompanying drawings. One skilled in the art may realize that the following description is illustrative only and is not in any way limiting. Other embodiments of the present invention may readily suggest themselves to such skilled persons having the benefit of this disclosure.

The transmitter device may include a CFR device a digital predistortion device DPD a digital to analog converter DAC a frequency up converter a power amplifier a couple and a transmitter observer receiver . The digital to analog converter is a device that converts a digital signal which in is the output of the DPD to an analog signal. The frequency up converter or radio frequency modulator is a device that takes a baseband input signal and outputs a radio frequency modulated signal. The power amplifier is a type of electronic amplifier used to convert a low power radio frequency signal into a larger signal of significant power. The coupler is a passive device used to couple a defined amount of the radio frequency power in a transmission line to another port where it can be used in Transmitter Observer Receiver .

The CFR device further includes a Peak to Average Ratio meter and an error vector magnitude calculator . They are used to provide reference information for the threshold determiner to make the decision. The Peak to Average Ratio meter determines Peak to Average Ratio of the output of the CFR unit . The average power of the output of the CFR unit is obtained by the average power meter . The peak power of the output of the CFR unit is obtained by the Peak power meter . The average power meter and the Peak power meter provide outputs into the Peak to Average Ratio meter . Besides the Peak to Average Ratio meter also determines whether Peak to Average Ratio plus an average output power of the power amplifier is below an allowable peak power of the power amplifier. The EVM calculator compares the input and the output of the CFR unit to calculate the EVM value.

The CFR device further includes an average power level controller to control the average power level of the input of the CFR unit . It is possible that after CFR threshold adapting process error vector magnitude degradation caused by crest factor reduction reaches a maximum acceptable error vector magnitude degradation and Peak to Average Ratio plus the average output power is not below the allowable peak power. Under this situation the average power level controller can control average power level of the input of the CFR unit to resolve this problem. As shown in the average power level controller takes signal from the PAR meter as reference to decide when to function.

The CFR device may further include a hard limiter to limit the output of the CFR unit . This is to avoid overly high output of the CFR unit during the CFR threshold adapting process which may damage the subsequent components e.g. the digital predistortion the digital to analog converter the frequency up converter the power amplifier etc as shown in .

The CFR device may further include a delay unit . As shown in the delay unit can be disposed between the average power level controller and the error vector magnitude calculator . The delay unit delays the signal from the average power level controller to compensate for the time taken to perform CFR at the CFR unit. The delay unit can help the EVM calculator to obtain a better result and consequently improve the precise of the CFR threshold adjustment.

In step S crest factor reduction is applied to the input signal to obtain a CFR processed input signal. The crest factor reduction is performed with a initial crest factor reduction threshold and the performance may be not acceptable at the initial time but can be improved through the following steps.

In step S a minimum crest factor reduction threshold is determined under the requirement that an error vector magnitude degradation caused by crest factor reduction reaches maximum acceptable error vector magnitude degradation. As a general rule lower threshold means worse EVM. So when the EVM is just at the critical value the corresponding CFR threshold is the minimum CFR threshold.

In step S Peak to Average Ratio of the processed input signal PAR and the average output power of the power amplifier Pnom are added. The result i.e. the peak power is compared with a predetermined allowable peak power of the power amplifier PApeak .

If the Peak to Average Ratio plus the average output power is below the allowable peak power it is determined that there is still room to optimize the EVM. Under this situation the process goes to step S in which a final crest factor reduction threshold is determined by increasing the minimum crest factor reduction threshold until the Peak to Average Ratio plus the average output power reaches the allowable peak power. At this point optimized EVM is obtained while the peak power of the output of the PA is within safe area.

Or otherwise if the Peak to Average Ratio plus the average output power is not below the allowable peak power then the process goes to step S in which the final crest factor reduction threshold is determined to be the minimum crest factor reduction threshold and the average power of the input signal is reduced until Peak to Average Ratio plus the average output power reaches the allowable peak power.

Through these steps CFR threshold and average power level are automatically optimized leading to guaranteed EVM performance and wanted PAR.

Step S can be performed through among others the following operations. First the error vector magnitude degradation caused by crest factor reduction is compared with the maximum acceptable error vector magnitude degradation. Second if the error vector magnitude degradation is below the maximum acceptable error vector magnitude degradation the crest factor reduction threshold is decreased until the error vector magnitude degradation reaches the maximum acceptable error vector magnitude degradation or if the error vector magnitude degradation is not below the maximum acceptable error vector magnitude degradation the crest factor reduction threshold is increased until the error vector magnitude degradation reaches the maximum acceptable error vector magnitude degradation. With these steps the minimum crest factor reduction threshold can be obtained without recognizing and analyzing the details of carrier configurations.

The method for controlling the input signal of a power amplifier can further comprises limiting the processed input signal. This is to avoid overly high output of the processed input signal. This undesired situation may appear during the adaptive process and can damage the related components. With this limiting step the safety of the components can be further enhanced.

In step S the minimum crest factor reduction threshold can be increased step by step. The step length can be determined based on difference between Peak to Average Ratio plus the average output power and the allowable peak power. For example if the difference is relative large the step can be set to be longer. On the other hand if the difference is relative small the step can be set to be shorter. Likewise when decreasing or increasing the crest factor reduction threshold the step length can also be determined based on the current value and the target value. The variable step length configuration provides fast and meanwhile precious adjustment.

The method as shown in can be implemented by a device for controlling an input signal of a power amplifier. The device includes a CREST FACTOR REDUCTION unit a minimum CREST FACTOR REDUCTION threshold determiner a power comparator a final CREST FACTOR REDUCTION threshold determiner and an average output power control unit.

The CREST FACTOR REDUCTION unit applies CREST FACTOR REDUCTION to the input signal to obtain a processed input signal the minimum CREST FACTOR REDUCTION threshold determiner configured for determining a minimum CREST FACTOR REDUCTION threshold such that an ERROR VECTOR MAGNITUDE degradation caused by CREST FACTOR REDUCTION reaches a maximum acceptable ERROR VECTOR MAGNITUDE degradation the power comparator configured for comparing Peak to Average Ratio of the processed input signal plus an average output power of the power amplifier and an allowable peak power of the power amplifier the final CREST FACTOR REDUCTION threshold determiner configured for determining the final CREST FACTOR REDUCTION threshold by increasing the minimum CREST FACTOR REDUCTION threshold until Peak to Average Ratio plus the average output power reaches the allowable peak power if the Peak to Average Ratio plus the average output power is below the allowable peak power or determining the final CREST FACTOR REDUCTION threshold to be the minimum CREST FACTOR REDUCTION threshold if Peak to Average Ratio plus the average output power is not below the allowable peak power and the average output power control unit configured for reducing the average output power until Peak to Average Ratio plus the average output power reaches the allowable peak power if the Peak to Average Ratio plus the average output power is not below the allowable peak power.

In the above described device the minimum CREST FACTOR REDUCTION threshold determiner can comprise an ERROR VECTOR MAGNITUDE comparator and a CREST FACTOR REDUCTION threshold adjuster.

The ERROR VECTOR MAGNITUDE comparator is configured for comparing the ERROR VECTOR MAGNITUDE degradation caused by CREST FACTOR REDUCTION with the maximum acceptable ERROR VECTOR MAGNITUDE degradation the CREST FACTOR REDUCTION threshold adjuster is configured for decreasing the CREST FACTOR REDUCTION threshold until the ERROR VECTOR MAGNITUDE degradation caused by CREST FACTOR REDUCTION reaches the maximum acceptable ERROR VECTOR MAGNITUDE degradation if the ERROR VECTOR MAGNITUDE degradation caused by CREST FACTOR REDUCTION is below the maximum acceptable ERROR VECTOR MAGNITUDE or increasing the CREST FACTOR REDUCTION threshold until the ERROR VECTOR MAGNITUDE degradation caused by CREST FACTOR REDUCTION reaches the maximum acceptable ERROR VECTOR MAGNITUDE degradation if the ERROR VECTOR MAGNITUDE degradation caused by CREST FACTOR REDUCTION is not below the maximum acceptable ERROR VECTOR MAGNITUDE degradation.

The above described device can further comprise a hard limiter for limiting the processed input signal.

In step S EVMcfr is compared with EVMmax which is the maximum acceptable error vector magnitude degradation. If EVMcfr

In step S the CFR threshold is increased. Step S prevents the CFR threshold to be overly decreased at the last S S cycle and aims to ensure the CFR threshold to be the lowest acceptable value.

In step EVMcfr is compared with EVMmax again if it does not hold still then the process goes back to step S again. Or otherwise the process goes to step S.

In step S the sum of PAR and Pnom which is the average output power of the PA is compared with PApeak which is the allowable peak power. If the sum

In step S the CFR threshold is decreased by a predetermined amount so as to prevent the CFR threshold to be overly increased at the last S S cycle and the finally determined CFR threshold is the optimized value.

In step S the average power of the input signal is controlled by applying the power back off value. Then the final peak power is equal to the allowable peak power.

According to embodiments of the invention CFR threshold is adjusted based on input signal rather than output signal of a power amplifier and thus can support all kinds of carrier configurations such as WiMAX and multi standards scenarios.

Although the present disclosure has been described with exemplary embodiments various changes and modifications may be suggested to one skilled in the art. It is intended that the present disclosure encompasses such changes and modifications as fall within the scope of the appended claims.

