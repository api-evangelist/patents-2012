---

title: System and method for accessing operating system and hypervisors via a service processor of a server
abstract: The present disclosure relates to a server that makes use of a host central processing unit (CPU) which accesses a production network to enable communications with a remotely located subsystem using the production network. A USB host system may be operably associated with the host CPU. A service processor may also be incorporated in the server, which is configured to communicate with an out of band network. A service processor USB system may be operably associated with the service processor and may communicate with the USB host system. This enables access to either an operating system or a hypervisor running on the host CPU via the out of band network, using an Ethernet-over-USB protocol.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09553776&OS=09553776&RS=09553776
owner: AVOCENT HUNTSVILLE, LLC
number: 09553776
owner_city: Huntsville
owner_country: US
publication_date: 20120516
---
This application is a 371 U.S. National Stage of PCT International Application No. PCT US2012 038093 filed on May 16 2012 which claims the benefit of U.S. Provisional Patent Application No. 61 486 482 filed on May 16 2011. The entire disclosures of the above applications are incorporated herein by reference.

The present disclosure relates to systems and methods for communicating with servers operating within a data center and more particularly to a system and method for enabling communication with a service processor of the server processor via an out of band connection to allow access and control over an operating system or Hypervisor running on the server.

The statements in this section merely provide background information related to the present disclosure and may not constitute prior art.

Present day servers e.g. storage and blade servers almost always incorporate a service processor . A service processor typically is a microcontroller embedded in the server or a server blade chassis and used for remote management purposes. Frequently the service processor is located on a motherboard of a server or on a PCI card. The service processor is completely independent from the main CPU and the system operating system of the server. Thus it is able to operate fully independently of the server s CPU and operating system even if the server s CPU or operating system is locked up or otherwise inaccessible. Service processors are often used to perform one or more of following valuable functions operations 

The service processor may include a component that is often referred to as a BMC Baseband Management Controller . The Avocent Corporation provides the firmware for BMCs to various major server manufacturers. Some major service processor technologies include 

Service processors are typically accessible through either a dedicated Ethernet interface i.e. out of band or a shared data Ethernet interface i.e. sideband . Most of the features provided by service processors as outlined above are not new and many of these features are available in some shape or form through other remote management solutions such as console servers KVM switches IPDUs etc. In fact virtually all of the benefits provided by remote out of band management tools are available through service processors lower Mean Time To Repair MTTR operating cost savings and improved asset productivity. However one key difference is that in the case of service processors the complete feature set needed to reap those benefits is already included in the server and furthermore is accessible through a single interface. Moreover the single interface is Ethernet the most ubiquitous network interface in the IT marketplace. This greatly simplifies the deployment of the remote server management infrastructure making it easier for information technology managers to take advantage of these technologies. Additionally the fact that service processors are embedded inside the server provides more granular and thorough visibility of the server s status which allows for proactive and preventive management as well as greater control of the overall server infrastructure. Features such as hardware environmental monitoring and platform event traps are a direct result of the internal presence of service processors in the server.

From the foregoing it should be appreciated that service processors can significantly improve the management of servers by reducing the Mean Time To Resolve an outage. In a world where the availability demands of the IT Network are gradually rising each year the need to diminish the impact of outages is becoming more and more important. And while the costs of servers may be dropping slightly each year the cost of data center management has a tendency to rise.

This section provides a general summary of the disclosure and is not a comprehensive disclosure of its full scope or all of its features.

In one aspect the present disclosure relates to a server comprising a host central processing unit CPU . The host CPU may be configured to communicate with a production network to enable communications with a remotely located subsystem using the production network. A USB host system may be used which is operably associated with the host CPU. A service processor may also be incorporated in the server which is configured to communicate with an out of band network. A service processor USB system may be operably associated with the service processor and configured to communicate with the USB host system. This enables access to at least one of an operating system or a hypervisor running on the host CPU via the out of band network using an Ethernet over USB protocol.

In another aspect the present disclosure relates to a server having a host central processing unit CPU where the host CPU is configured to communicate with a production network to enable communications with a remotely located subsystem using the production network. A USB host system may be included which may have a USB host subsystem and a host Ethernet over USB driver both being operably associated with the host CPU. A service processor may be configured to communicate with an out of band network. A service processor USB system may be included which has a service processor USB subsystem and a service processor Ethernet over USB driver both being operably associated with the service processor and configured to communicate with the USB host system. This enables bidirectional communications via the out of band network with at least one of an operating system or a hypervisor running on the host CPU.

In still another aspect the present disclosure relates to a system for communicating with a host CPU of a computer controlled electronic component via either one of a first network or an independent second network. The system may comprise a USB host system in communication with the host CPU of the computer controlled electronic component the host CPU being configured to communicate with the first network. A service processor may be included in the system which is in communication with the independent second network. The service processor may have a service processor USB system for enabling the service processor to communicate with the host CPU via a Ethernet over USB protocol with the USB host system. This enables communications with the host CPU via the service processor and the independent second network.

In still another aspect the present disclosure relates to a method for communicating with a computer controlled electronic component having a host CPU. The method may include using a USB host system with the host CPU to enable Ethernet over USB communications with the host CPU. The host CPU may be used to communicate with a first network. A service processor may be used with the computer controlled electronic component to communicate with at least one sensor used for monitoring at least one of a health or performance of the computer controlled electronic component. A service processor USB system may be used to communicate with the USB host system to thus enable access to one of an operating system or a hypervisor running on the host CPU via the service processor. An independent second network in communication with the service processor may be used to access the host CPU via the USB host system and the service processor USB system.

The following description is merely exemplary in nature and is not intended to limit the present disclosure application or uses. It should be understood that throughout the drawings corresponding reference numerals indicate like or corresponding parts and features.

Referring to there is shown a server in accordance with one implementation of the present disclosure. The server may be in communication with a production network and a maintenance network which may both be in communication with a central data center management system . The production network represents the primary network by which applications access the server . The maintenance network can be thought of as an out of band network by which various types of useful information may be collected from the server without consuming bandwidth on the production network . The maintenance network also forms a means by which data center personnel can gain access to the server to perform power down and restarts for the server in addition to other troubleshooting and maintenance work even if the production network goes down. An optional remote access appliance is also shown in for enabling remote access to the server .

The server may include a USB port a serial port a mouse port a video port and a keyboard port . Any of the ports and may be accessed via the remote access appliance . The server may include a motherboard to which a service processor is connected via a PCI connector . A host CPU may also be mounted to the motherboard . For convenience the host CPU will be referred to throughout the following discussion simply as the host .

The motherboard may include at least one cooling fan controller for cooling the various components within the server at least one temperature sensor for sensing a temperature within various areas of the server and at least one voltage sensor for providing a voltage signal corresponding to at least one internal component of e.g. power supply of the server. In practice it will be appreciated that a plurality of fans a plurality of temperature sensors and a plurality of voltage sensors may be included within the server . The signals from the fan controller the temperature sensor and the voltage sensor may be provided to the motherboard or possibly input directly to the service processor . An identification LED may also be included which may be turned on remotely via a command sent through the out of band maintenance network and the service processor to aid a data center worker in identifying the server if service or maintenance work is required on the server.

The service processor may include a NIC network interface controller which enables communication with the maintenance network . The service processor may also include a service processor USB system having an Ethernet over USB driver which is in bidirectional communication with a USB subsystem . The service processor USB subsystem may include a USB connector . An optional real time analytics engine may be included for processing the various information received from the fan controller the temperature sensor the voltage sensor as well as information received from the host as will be described in greater detail momentarily.

With further reference to the USB subsystem may be coupled via a suitable independent cable to a USB host subsystem having a host Ethernet over USB driver . The USB host subsystem may be similar to the service processor USB subsystem in that it may include a port . The Ethernet over USB driver may be in communication with either an operating system running on the host or alternatively a Hypervisor that is running on the host . A WMI Windows Management Instrumentation system not shown could also be running in the operating system if the operating system is a Microsoft WINDOWS operating system.

It is a principal advantage that the USB subsystems and the Ethernet over USB drivers enable the service processor to bidirectionally communicate with the software i.e. operating system or Hypervisor running on the host . In this manner the operating system or the Hypervisor may communicate via their normal Ethernet processes but will be using the USB host subsystem via the Ethernet over USB driver . To the operating system or the Hypervisor it makes no difference whether it is communicating via a typical Ethernet device such as a NIC or communicating via the Ethernet over USB driver and USB host subsystem . The components and enable transparent port forwarding between the out of band Ethernet maintenance network and the host . In this manner if a management software application needs to access the host it may do so via the maintenance network and the service processor or via the production network . Thus any information concerning the performance of the server or its components that would normally be obtainable from the host using the production network will be obtainable as well using the maintenance network . This is especially advantageous in the event that the production network or the remote access appliance should go down. The changeover to the out of band maintenance network if the production network should go down may occur automatically transparently and smoothly. The changeover from the down production network to the maintenance network allows continued access to the operating system and the Hypervisor without any action on the part of a user. The automatic changeover may be commanded by a client device receiving a client connection failure message from the server indicating that the production network has gone down and the user s network connection has been lost. Optionally however the changeover could be selected manually by the user from his her client device. Still another advantage is that the management software application may use standard application programming interfaces APIs or Web Service in band to access the operating system or the Hypervisor when the production network is not operational.

The inclusion of the real time analytics engine enables information from any one or more of the fan controller the temperature sensor and the voltage sensors to be analyzed relative to performance metrics obtained from the host to gain even further intelligence as to how the server is operating. For example consider the situation where the temperature sensor is configured to sense the temperature of the host and the signal from temperature sensor increases a significant degree indicating the operating temperature of the host has increased significantly. Without more information it may be difficult to determine if a hardware malfunction is occurring with the host or if the host is simply being heavily utilized during a given period of time. But since the service processor is able to access and communicate with the operating system or the Hypervisor web service real time performance metrics concerning the utilization of the host may be obtained by the service processor . If this information indicates that the host utilization is high then one may assume that the increase in temperature is not due to some malfunction such as a problem with the fan controller . Those skilled in the art will appreciate that a wide variety of other performance metrics available from the host will be highly valuable in analyzing the performance of various aspects of the server .

Referring to a server is shown that is similar to the server . Components of the server in common with those of the server are denoted with the same reference numbers that also include a prime symbol. The difference between the server and the server is that with the server both the service processor and the host are directly physically mounted on the motherboard . Otherwise the operation of the various components of the server is the same as that described for the server . Since the service processor and the host are both directly physically mounted on the motherboard rather than using the independent cable a bus may be formed directly on the motherboard to couple these two components for bidirectional communication. Accordingly it will be appreciated that the implementation of the service processor or is not limited to mounting in any specific configuration within the server or as long as it is able to communicate with the host or .

Referring to an example of a service processor is shown that incorporates an application layer a platform layer and an interface layer . In this example the application layer includes a real time analytical engine that incorporates a power consumption and anomaly detection model. The application layer specifically may also include an OEM applications module Email SNMP Alert Management module and a sensor interface . The interface layer may include a manageability protocol subsystem a command line interface a SNMP subsystem an IMPI standard Commands subsystem a serial over LAN subsystem an IPMI OEM commands subsystem a remote presence subsystem and a Web GUI subsystem . The platform layer may include a security subsystem an event distribution subsystem a license feature management subsystem a remote session management subsystem a firmware update subsystem a process management subsystem a configuration database and an inter process communication subsystem . The service processor may also include a real time operating system layer and hardware . The power consumption and anomaly detection model enables a plurality of useful features such as 

Can provide power consumption for a specified user or for a specific task or potentially from all applications started by a specific user 

It will be appreciated that other forms of machine learning may also be incorporated into the analytics engine of the service processor to meet changing server health monitoring needs or requirements.

While various embodiments have been described those skilled in the art will recognize modifications or variations which might be made without departing from the present disclosure. The examples illustrate the various embodiments and are not intended to limit the present disclosure. Therefore the description and claims should be interpreted liberally with only such limitation as is necessary in view of the pertinent prior art.

