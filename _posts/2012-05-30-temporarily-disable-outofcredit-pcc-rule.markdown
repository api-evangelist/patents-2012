---

title: Temporarily disable out-of-credit PCC rule
abstract: Various exemplary embodiments relate to a method performed by a policy and charging rules node (PCRN), the method comprising: receiving an event trigger from a policy and charging enforcement node (PCEN) indicating that a subscriber is out of credit; installing temporary PCC rules to handle the out of credit status of the subscriber; receiving an indication that the subscriber has completed a reallocation of credit action; uninstalling the temporary PCC rules and restoring the original PCC rules after receiving an indication of reallocation of credit.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08983429&OS=08983429&RS=08983429
owner: Alcatel Lucent
number: 08983429
owner_city: Boulogne-Billancourt
owner_country: FR
publication_date: 20120530
---
Various exemplary embodiments disclosed herein relate generally to controlling usage of a subscriber in telecommunications networks.

As the demand increases for varying types of applications within mobile telecommunications networks service providers must constantly upgrade their systems in order to reliably provide this expanded functionality. What was once a system designed simply for voice communication has grown into an all purpose network access point providing access to a myriad of applications including text messaging multimedia streaming and general Internet access. In order to support such applications providers have built new networks on top of their existing voice networks leading to a less than elegant solution. As seen in second and third generation networks voice services must be carried over dedicated voice channels and directed toward a circuit switched core while other service communications are transmitted according to the Internet Protocol IP and directed toward a different packet switched core. This led to unique problems regarding application provision metering and charging and quality of experience QoE assurance.

In an effort to simplify the dual core approach of the second and third generations the 3rd Generation Partnership Project 3GPP has recommended a new network scheme it terms Long Term Evolution LTE . In an LTE network all communications are carried over an IP channel from user equipment UE to an all IP core called the Evolved Packet Core EPC . The EPC then provides gateway access to other networks while ensuring an acceptable QoE and charging a subscriber for their particular network activity.

The 3GPP generally describes the components of the EPC and their interactions with each other in a number of technical specifications including the following components Policy and Charging Rules Function PCRF Policy and Charging Enforcement Function PCEF and Bearer Binding and Event Reporting Function BBERF of the EPC. These specifications further provide some guidance as to how these elements interact in order to provide reliable data services and charge subscribers for use thereof.

Within these communication networks metering may be used to measure usage of the communication network by subscribers. When a prepaid subscriber reaches their usage limit the telecommunication network must provide a way for the subscriber to continue for example a call when they run out of credit.

A brief summary of various exemplary embodiments is presented below. Some simplifications and omissions may be made in the following summary which is intended to highlight and introduce some aspects of the various exemplary embodiments but not to limit the scope of the invention. Detailed descriptions of a preferred exemplary embodiment adequate to allow those of ordinary skill in the art to make and use the inventive concepts will follow in later sections.

Various exemplary embodiments relate to a method performed by a policy and charging rules node PCRN the method comprising receiving an event trigger associated with a first set of policy and charging control PCC rules from a policy and charging enforcement node PCEN indicating that a subscriber is out of credit determining that the original policy and charging control PCC rules with the Final Unit Indication AVP in a Charing Rule Report AVP has a temporarily inactive status installing temporary FCC rules to handle the out of credit status of the subscriber receiving an indication that the subscriber has received a reallocation of credit and uninstalling the temporary rules after receiving an indication that the subscriber has received a reallocation of credit.

Various exemplary embodiments relate to a policy and charging rules node PCRN comprising a network interface configured to receive an event trigger associated with a first set of policy and charging control PCC rules from a policy and charging enforcement node PCEN indicating that a subscriber is out of credit and receive an indication that the subscriber has received a reallocation of credit a PCC rules engine configured to install a second set of rules to handle the out of credit status of the subscriber and uninstall the second set of rules after receiving an indication that the subscriber has completed the reallocation of credit operation.

Various exemplary embodiments relate to a non transitory machine readable storage medium of claim further comprising instructions for determining that the first set of FCC rules associated with the event trigger has an active status or PCC rule status is not found in a corresponding charging rule report AVP instructions for setting a flow status for the first set of PCC rules to disabled and instructions for after receiving an indication that the subscriber has received a reallocation of credit setting the flow status for the first set of PCC rules to enabled after receiving an indication that the subscriber has received a reallocation of credit.

To facilitate understanding identical reference numerals have been used to designate elements having substantially the same or similar structure and or substantially the same or similar function.

The description and drawings merely illustrate the principles of the invention. It will thus be appreciated that those skilled in the art will be able to devise various arrangements that although not explicitly described or shown herein embody the principles of the invention and are included within its scope. Furthermore all examples recited herein are principally intended expressly to be only for pedagogical purposes to aid the reader in understanding the principles of the invention and the concepts contributed by the inventors to furthering the art and are to be construed as being without limitation to such specifically recited examples and conditions. Additionally the term or as used herein refers to a non exclusive or i.e. and or unless otherwise indicated e.g. or else or or in the alternative . Also the various embodiments described herein are not necessarily mutually exclusive as some embodiments can be combined with one or more other embodiments to form new embodiments.

User equipment may be a device that communicates with packet data network for providing the end user with a data service. Such data service may include for example voice communication text messaging multimedia streaming and Internet access. More specifically in various exemplary embodiments user equipment is a personal or laptop computer wireless email device cell phone tablet television set top box or any other device capable of communicating with other devices via EPC .

Base station may be a device that enables communication between user equipment and EPC . For example base station may be a base transceiver station such as an evolved nodeB eNodeB as defined by 3GPP standards. Thus base station may be a device that communicates with user equipment via a first medium such as radio waves and communicates with EPC via a second medium such as Ethernet cable. Base station may be in direct communication with EPC or may communicate via a number of intermediate nodes not shown . In various embodiments multiple base stations not shown may be present to provide mobility to user equipment . Note that in various alternative embodiments user equipment may communicate directly with EPC . In such embodiments base station may not be present.

Evolved packet core EPC may be a device or network of devices that provides user equipment with gateway access to packet data network . EPC may further charge a subscriber for use of provided data services and ensure that particular quality of experience QoE standards are met. Thus EPC may be implemented at least in part according to various 3GPP standards. Accordingly EPC may include a serving gateway SGW a packet data network gateway PGW a policy and charging rules node PCRN and a subscription profile repository SPR .

Serving gateway SGW may be a device that provides gateway access to the EPC . SGW may be the first device within the EPC that receives packets sent by user equipment . SGW may forward such packets toward PGW . SGW may perform a number of functions such as for example managing mobility of user equipment between multiple base stations not shown and enforcing particular quality of service QoS characteristics for each flow being served. In various implementations such as those implementing the Proxy Mobile IP standard SGW may include a Bearer Binding and Event Reporting Function BBERF . In various exemplary embodiments EPC may include multiple SGWs not shown and each SGW may communicate with multiple base stations not shown .

Packet data network gateway PGW may be a device that provides gateway access to packet data network . PGW may be the final device within the EPC that receives packets sent by user equipment toward packet data network via SGW . PGW may include a policy and charging enforcement function PCEF that enforces policy and charging control PCC rules for each service data flow SDF . Therefore POW may be a policy and charging enforcement node PCEN . POW may include a number of additional features such as for example packet filtering deep packet inspection and subscriber charging support. PGW may also be responsible for requesting resource allocation for unknown application services.

Policy and charging rules node PCRN may be a device or group of devices that receives requests for application services generates PCC rules and provides PCC rules to the PGW and or other PCENs not shown . PCRN may be in communication with AF via an Rx interface. As described in further detail below with respect to AF PCRN may receive an application request in the form of an Authentication and Authorization Request AAR from AF . Upon receipt of AAR PCRN may generate at least one new PCC rule for fulfilling the application request.

PCRN may also be in communication with SGW and PGW via a Gxx and a Gx interface respectively. PCRN may receive an application request in the form of a credit control request CCR not shown from SOW or PGW . As with AAR upon receipt of a CCR PCRN may generate at least one new PCC rule for fulfilling the application request . In various embodiments AAR and the CCR may represent two independent application requests to be processed separately while in other embodiments AAR and the CCR may carry information regarding a single application request and PCRN may create at least one PCC rule based on the combination of AAR and the CCR. In various embodiments PCRN may be capable of handling both single message and paired message application requests.

Upon creating a new PCC rule or upon request by the PGW PCRN may provide a PCC rule to PGW via the Gx interface. In various embodiments such as those implementing the PA HP standard for example PCRN may also generate QoS rules. Upon creating a new QoS rule or upon request by the SOW PCRN may provide a QoS rule to SGW via the Gxx interface. These QoS rules may be applied based upon usage information received from the OCS . When the OCS indicates that certain usage thresholds have been reached the PCRF may change the QoS related to a subscriber and apply updated QoS rules to the PCEF .

The PCRN may include network interfaces for communication with other network node a PCC rule engine and PCC rule storage. For example the PCRN may receive an OUT OF CREDIT trigger event via the network interface and pass that event to the PCC rule engine for processing. The PCC rule engine may make decisions regarding existing rules and to create new rules based upon the trigger event. Any new rules or changes to rules may be noted in the PCC rule storage.

Subscription profile repository SPR may be a device that stores information related to subscribers to the subscriber network . Thus SPR may include a machine readable storage medium such as read only memory ROM random access memory RAM magnetic disk storage media optical storage media flash memory devices and or similar storage media. SPR may be a component of PCRN or may constitute an independent node within EPC . Data stored by SPR may include an identifier of each subscriber and indications of subscription information for each subscriber such as bandwidth limits charging parameters and subscriber priority.

Packet data network may be any network for providing data communications between user equipment and other devices connected to packet data network such as AF . Packet data network may further provide for example phone and or Internet service to various user devices in communication with packet data network .

Application function AF may be a device that provides a known application service to user equipment . Thus AF may be a server or other device that provides for example a video streaming or voice communication service to user equipment . AF may further be in communication with the PCRN of the EPC via an Rx interface. When AF is to begin providing known application service to user equipment AF may generate an application request message such as an authentication and authorization request AAR according to the Diameter protocol to notify the PCRN that resources should be allocated for the application service. This application request message may include information such as an identification of the subscriber using the application service an IP address of the subscriber an APN for an associated IP CAN session and or an identification of the particular service data flows that must be established in order to provide the requested service. AF may communicate such an application request to the PCRN via the Rx interface.

OCS may be used to track pre paid usage of subscribers. For pre paid usage charging occurs in real time where the service cost is deducted from the subscriber balance while the service is in operation. The OCS may receive usage information from the PGW . Further the OCS may install monitoring keys in the PGW to monitor certain types of subscriber usage. The OCS receives information related to usage limits associated with the subscriber. Further the OCS may receive threshold information based upon various desired usage thresholds. When a threshold is reached certain policies may become applicable. The OCS may also communicate with the PCRN via the Sy interface. The OCS may send usage information to the PCRN . The OCS may send indications when various thresholds have been exceeded such as for example an OUT OF CREDIT event to the PGW and the PGW may then send an OUT OF CREDIT event trigger to the PCRN .

Typically a pre paid subscriber of the subscriber network may have a metering limit that defines a limit on the amount of resources that the subscriber may use. For example a subscriber may have purchased minutes. Other usage for example data usage may be metered as well.

For example when a pre paid subscriber places a call they may be informed by a voice message that indicates how many remaining call minutes that the subscriber has. Alternatively such a voice reminder may only occur when the remaining minutes of the pre paid subscriber is less than a threshold amount. If during a call the pre paid subscriber runs out of minutes the network may do one of three things first terminate the call second suspend the call and redirect the subscriber to purchase more minutes and third provide free minutes to the subscriber to complete the call. Because the PCRN makes rule decisions the PCRN may receive an OUT OF CREDIT event trigger when the pre paid subscriber has exceeded their usage limit. The PCRN may then apply rules to achieve a desired response to the OUT OF CREDIT event trigger.

Next the PCRN may create a second PCC rule PCC rule and the status of that rule may be set to ACTIVE . The action indicated by PCC rule may be based upon the value of the FUA received with the OUT OF CREDIT trigger event. If the FUA was RESTRICT ACCESS REDIRECTION then PCC rule may be used to redirect the pre paid subscriber to purchase more minutes. For example the pre paid subscriber may be connected with an operator or an automated system where more minutes may be purchased. Also a pre paid subscriber may be directed to a website in order to purchase more minutes. PCC rule may also be used to allow the pre paid subscriber to continue their call. In such a situation the priority QoS or other performance parameters may be decreased for this subscriber and implemented in the PCC rule . Then the PCRN may send a message to the PCEN to install PCC rule .

Once the pre paid subscriber has purchased more minutes the PCEN may receive a notification. As a result the PCEN may set the rule status of PCC rule to ACTIVE. Next the PCEN may then send a REALLOCATION OF CREDIT trigger event to the PCRN . Upon the receipt of the REALLOCATION OF CREDIT event trigger the PCRN may remove PCC rule . Next the PCRN may send a message to the PCEN to uninstall PCC rule from the PCEF .

Accordingly when an OUT OF CREDIT event trigger occurs for a pre paid subscriber the PCRN may use a second PCC rule in order to carry out a desired action as specified by the FUA. Further because the rule status of PCC rule was indicated as TEMP INACTIVE the PCRN knows that the pre paid subscriber may not continue a call.

It should be noted that due to the ambiguity in related 3GPP specifications it is possible that some PCENs may not use PPC rule status value to implement to indicate out of credit event. For example the PCEN may not include PCC rule status AVP or may set it to ACTIVE in the Charging Rule Report AVP for the effected PCC rules for the out of credit event. A second embodiment as described in accounts for this situation.

Next the PCRN may set the flow status for PCC rule to DISABLED . This may be done because the rule status received by the PCRN indicates that the usage of the pre paid subscriber related to PCC rule may still be available to the pre paid subscriber. Thus by setting the flow status for the PCC rule to DISABLED the PCRN may be assured that the usage of the pre paid subscriber related to PCC rule has been stopped.

Further the PCRN may create a second PCC rule PCC rule and the rule status of that rule may be set to ACTIVE . The action indicated by PCC rule may be based upon the value of the FUA received with the OUT OF CREDIT event trigger. If the FUA was RESTRICT ACCESS or REDIRECTION then PCC rule may be used to redirect the pre paid subscribe to purchase more minutes. For example the pre paid subscribe may be connected with an operator or an automated system where more minutes may be purchased. Also a pre paid subscriber may be directed to a website in order to purchase more minutes. Further if the FUA is RESTRICT ACCESS the PCC rule constructed based on provided Restriction Filter Rule may be used to allow the pre paid subscriber to access free services when the subscriber is in out of credit state. In such a situation the priority QoS or other performance parameters may be decreased for this subscriber and implemented in PCC rule . Then the PCRN may send a message to the PCEN to install PCC rule and to update PCC rule .

Once the pre paid subscriber has purchased more minutes the PCEN may receive a reallocation of credit notification from OCS. As a result the PCEN may set the rule status of PCC rule to ACTIVE. Next the PCEN may then send a REALLOCATION OF CREDIT trigger event to the PCRN . Upon the receipt of the REALLOCATION OF CREDIT trigger event the PCRN may remove PCC rule and set the flow status of PCC rule to ENABLED. Next the PCRN may send a message to the PCEN to uninstall PCC rule from the PCEF and to update PCC rule .

Accordingly when an OUT OF CREDIT trigger event occurs for a pre paid subscriber the PCRN may use a second PCC rule in order to carry out a desired action as specified by the FUA. In this embodiment flow status may be used to ensure that the usage of the pre paid subscriber has been prevented because either the status of FCC rule is either active or unknown.

The PCRN then may determine if the status of the first PCC rule associated with the event trigger is TEMP INACTIVE . If so then the PCRN may create a second PCC rule . The second PCC rule may implement an action based upon an FUA received with the OUT OF CREDIT event trigger. The PCRN may then install the second PCC rule in the PCEN .

Next the PCRN may receive a REALLOCATION OF CREDIT event trigger . In response the PCRN may uninstall the second PCC rule . The method may then end at .

If the status of the first PCC rule associated with the event trigger is ACTIVE or the rule status is not provided then the PCRN may set the flow status for the first PCC rule to DISABLED . The PCRN then may update the first PCC rule which may include sending the update of the first PCC rule to the PCEN . Next the PCRN may create a second PCC rule . The second PCC rule may implement an action based upon an FUA received with the OUT OF CREDIT event trigger. The PCRN may then install the second PCC rule in the PCEN .

Next the PCRN may receive a REALLOCATION OF CREDIT event trigger . In response the PCRN may set the flow status for the first PCC rule to ENABLED . Then the PCRN may update the first PCC rule . Next the PCRN may uninstall the second PCC rule . The method may then end at .

While the above method was described as being carried out by a PCRN other hardware elements that may implement the PCRF may be used to carry out the method as well.

When reference is made to PCC rule and PCC rule PCC rule and PCC rule may also encompass sets of rules.

It should be apparent from the foregoing description that various exemplary embodiments of the invention may be implemented in hardware and or firmware. Furthermore various exemplary embodiments may be implemented as instructions stored on a machine readable storage medium which may be read and executed by at least one processor to perform the operations described in detail herein. A machine readable storage medium may include any mechanism for storing information in a form readable by a machine such as a personal or laptop computer a server or other computing device. Thus a tangible and non transitory machine readable storage medium may include read only memory ROM random access memory RAM magnetic disk storage media optical storage media flash memory devices and similar storage media.

It should be appreciated by those skilled in the art that any block diagrams herein represent conceptual views of illustrative circuitry embodying the principles of the invention. Similarly it will be appreciated that any flow charts flow diagrams state transition diagrams pseudo code and the like represent various processes which may be substantially represented in machine readable media and so executed by a computer or processor whether or not such computer or processor is explicitly shown.

Although the various exemplary embodiments have been described in detail with particular reference to certain exemplary aspects thereof it should be understood that the invention is capable of other embodiments and its details are capable of modifications in various obvious respects. As is readily apparent to those skilled in the art variations and modifications can be effected while remaining within the spirit and scope of the invention. Accordingly the foregoing disclosure description and figures are for illustrative purposes only and do not in any way limit the invention which is defined only by the claims.

