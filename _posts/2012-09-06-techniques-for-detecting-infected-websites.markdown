---

title: Techniques for detecting infected websites
abstract: Techniques for detecting infected websites are disclosed. In one particular embodiment, the techniques may be realized as a method for detecting an infected website comprising receiving at least one redirection report from at least one security agent, receiving at least one malware report from the at least one security agent, analyzing correlation between the at least one redirection report and the at least one malware report, aggregating information from the at least one redirection report, the at least one malware report, and the correlation analysis, and detecting an infected website based on the aggregated information.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08997228&OS=08997228&RS=08997228
owner: Symantec Corporation
number: 08997228
owner_city: Mountain View
owner_country: US
publication_date: 20120906
---
The present disclosure relates generally to websites that may be or become infected and more particularly to techniques for detecting infected websites.

Websites are susceptible to infection. Malicious hackers may use exploit kits or other techniques to infect websites. The infection may occur by changing a web server s configuration files or content. Some infections manifest themselves to users by redirecting the users to malicious websites. A redirection may be in the form of an HTTP response status code 302 Found with the URL to which the user should be redirected.

For example a user may attempt to navigate to a website such as http www.acme insecurity.com. In some cases the infected website might redirect the user to an obviously malicious website such as http www.malware makers.com. The malicious website may display unwanted advertising pornography violence or otherwise offensive content. The malicious website may attempt to transfer a virus or other malware to a redirected user. Additionally redirections may eventually cause degrading machine hygiene as measured by rate or history of infections.

In other cases the infected website might redirect the user to a more subtle malicious website such as http www.acme insecurity.com. In this example the malicious website is located at an address that uses an underscore instead of the hyphen in the legitimate website address which a redirected user might not notice. The malicious website may attempt to mimic the legitimate website to trick a redirected user into revealing sensitive or otherwise private information through a phishing or other social engineering attack. For example the malicious website might attempt to steal a user s password by mimicking or spoofing the legitimate website so that a redirected user may attempt to login before realizing that the malicious website is fake.

Increasingly websites are infected in such a way that users will be redirected only when certain conditions are satisfied. In some cases an infected website may contain malicious code that redirects users to a malicious website only if the users arrived at the infected website by way of a particular search engine or social networking website. For example if a user navigates to http www.search engine.com searches for Acme Insecurity and clicks a link in the search results for http www.acme insecurity.com then the malicious code will detect that the referring website was Search Engine.com. This referrer may satisfy the condition in the malicious code that triggers a redirect to the malicious website. In contrast if the user navigates to http www.acme insecurity.com directly then it may not satisfy any of the conditions to trigger a redirect. This user may continue browsing http www.acme insecurity.com as if the legitimate website was not infected at all.

Conventional website infection detection techniques may fail to take conditional redirection into account making it difficult or even impossible for conventional techniques to reproduce verify or collect information about a website infection. Additionally conventional techniques may also be more likely to detect false positives because they fail to determine when a redirect may be intentional by the legitimate website and not a result of an infection.

In view of the foregoing it may be understood that there may be significant problems and shortcomings associated with current website infection detection technologies.

Techniques for detecting infected websites are disclosed. In one particular embodiment the techniques may be realized as a method for detecting an infected website comprising receiving at least one redirection report from at least one security agent receiving at least one malware report from the at least one security agent analyzing correlation between the at least one redirection report and the at least one malware report aggregating information from the at least one redirection report the at least one malware report and the correlation analysis and detecting an infected website based on the aggregated information.

In accordance with further aspects of this particular embodiment the method may comprise sending redirection protection information for the infected website based on the aggregated information to the at least one security agent.

In accordance with additional aspects of this particular embodiment the method may comprise determining at least one condition for redirection based on the aggregated information wherein the redirection protection information comprises condition information based on the at least one condition.

In accordance with additional aspects of this particular embodiment the method may comprise receiving at least one protected URL registration for at least one URL sending protected URL information to the at least one security agent based on the at least one protected URL registration and sending an infected website notification to contact information based on the at least one protected URL registration.

In accordance with additional aspects of this particular embodiment the method may comprise wherein analyzing correlation further comprises comparing a redirection time based on the at least one redirection report to a malware detection time based on the at least one malware report.

In accordance with additional aspects of this particular embodiment the method may comprise wherein detecting an infected website further comprises determining that a difference between the malware detection time and the redirection time is less than a threshold period of time.

In accordance with additional aspects of this particular embodiment the method may comprise wherein the correlation analysis comprises a low correlation between the at least one redirection report and the at least one malware report and wherein the infected website is detected regardless of the low correlation.

In accordance with additional aspects of this particular embodiment the method may comprise wherein the infected website comprises an infected advertisement from an advertising network independent from the infected website.

In another particular exemplary embodiment the techniques may be realized as a system for detecting an infected website comprising one or more processors communicatively coupled to a network wherein the one or more processors are configured to receive at least one redirection report from at least one security agent receive at least one malware report from the at least one security agent analyze correlation between the at least one redirection report and the at least one malware report aggregate information from the at least one redirection report the at least one malware report and the correlation analysis and detect an infected website based on the aggregated information.

In accordance with additional aspects of this particular embodiment the one or more processors may be further configured to send redirection protection information for the infected website based on the aggregated information to the at least one security agent.

In accordance with additional aspects of this particular embodiment the one or more processors may be further configured to determine at least one condition for redirection based on the aggregated information wherein the redirection protection information comprises condition information based on the at least one condition.

In accordance with additional aspects of this particular embodiment the one or more processors may be further configured to receive at least one protected URL registration for at least one URL send protected URL information to the at least one security agent based on the at least one protected URL registration and send an infected website notification to contact information based on the at least one protected URL registration.

In accordance with additional aspects of this particular embodiment wherein analyze correlation further comprises comparing a redirection time based on the at least one redirection report to a malware detection time based on the at least one malware report.

In accordance with additional aspects of this particular embodiment wherein detect an infected website further comprises determining that a difference between the malware detection time and the redirection time is less than a threshold period of time.

In yet another particular exemplary embodiment the techniques may be realized as an article of manufacture for detecting an infected website the article of manufacture comprising at least one non transitory processor readable storage medium and instructions stored on the at least one medium wherein the instructions are configured to be readable from the at least one medium by at least one processor and thereby cause the at least one processor to operate so as to receive at least one redirection report from at least one security agent receive at least one malware report from the at least one security agent analyze correlation between the at least one redirection report and the at least one malware report aggregate information from the at least one redirection report the at least one malware report and the correlation analysis and detect an infected website based on the aggregated information.

In accordance with additional aspects of this particular embodiment the instructions may cause the at least one processor to operate further so as to send redirection protection information for the infected website based on the aggregated information to the at least one security agent.

In accordance with additional aspects of this particular embodiment the instructions may cause the at least one processor to operate further so as to determine at least one condition for redirection based on the aggregated information wherein the redirection protection information comprises condition information based on the at least one condition.

In accordance with additional aspects of this particular embodiment the instructions may cause the at least one processor to operate further so as to receive at least one protected URL registration for at least one URL send protected URL information to the at least one security agent based on the at least one protected URL registration and send an infected website notification to contact information based on the at least one protected URL registration.

In accordance with additional aspects of this particular embodiment wherein analyze correlation further comprises comparing a redirection time based on the at least one redirection report to a malware detection time based on the at least one malware report.

In accordance with additional aspects of this particular embodiment wherein detect an infected website further comprises determining that a difference between the malware detection time and the redirection time is less than a threshold period of time.

The present disclosure will now be described in more detail with reference to particular embodiments thereof as shown in the accompanying drawings. While the present disclosure is described below with reference to particular embodiments it should be understood that the present disclosure is not limited thereto. Those of ordinary skill in the art having access to the teachings herein will recognize additional implementations modifications and embodiments as well as other fields of use which are within the scope of the present disclosure as described herein and with respect to which the present disclosure may be of significant utility.

With reference to computer system of modem network interface or some other method may be used to provide connectivity from one or more of client systems and to network . Client systems and may be able to access information on server A or B using for example a web browser or other client software not shown . Such a client may allow client systems and to access data hosted by server A or B or one of storage devices A N B N and or N .

Networks and may be local area networks LANs wide area networks WANs the Internet cellular networks satellite networks or other networks that permit communication between clients servers and other devices communicatively coupled to networks and . Networks and may further include one or any number of the exemplary types of networks mentioned above operating as a stand alone network or in cooperation with each other. Networks and may utilize one or more protocols of one or more clients or servers to which they are communicatively coupled. Networks and may translate to or from other protocols to one or more protocols of network devices. Although networks and are each depicted as one network it should be appreciated that according to one or more embodiments networks and may each comprise a plurality of interconnected networks.

Storage devices A N B N and or N may be network accessible storage and may be local remote or a combination thereof to server A or B. Storage devices A N B N and or N may utilize a redundant array of inexpensive disks RAID magnetic tape disk a storage area network SAN an internet small computer systems interface iSCSI SAN a Fibre Channel SAN a common Internet File System CIFS network attached storage NAS a network file system NFS optical based storage or other computer accessible storage. Storage devices A N B N and or N may be used for backup or archival purposes.

According to some embodiments clients and may be smartphones PDAs desktop computers a laptop computers servers other computers or other devices coupled via a wireless or wired connection to network . Clients and may receive data from user input a database a file a web service and or an application programming interface.

Servers A and B may be application servers archival platforms backup servers network storage devices media servers email servers document management platforms enterprise search servers or other devices communicatively coupled to network . Servers A and B may utilize one of storage devices A N B N and or N for the storage of application data backup data or other data. Servers A and B may be hosts such as an application server which may process data traveling between clients and and a backup platform a backup process and or storage. According to some embodiments servers A and B may be platforms used for backing up and or archiving data. One or more portions of data may be backed up or archived based on a backup policy and or an archive applied attributes associated with the data source space available for backup space available at the data source or other factors.

According to some embodiments clients and or may contain one or more portions of software for infected website detection such as for example infected website detection module . As illustrated one or more portions of infected website detection module may reside at a network centric location. For example server A may be a server a firewall a gateway or other network element that may perform one or more actions to scan web applications for vulnerabilities. According to some embodiments network may be an external network e.g. the Internet and server A may be a gateway or firewall between one or more internal components and clients and the external network. According to some embodiments infected website detection module may be implemented as part of a cloud computing environment.

Bus allows data communication between central processor and system memory which may include read only memory ROM or flash memory neither shown and random access memory RAM not shown as previously noted. The RAM may be the main memory into which the operating system and application programs may be loaded. The ROM or flash memory can contain among other code the Basic Input Output system BIOS which controls basic hardware operation such as the interaction with peripheral components. Applications resident with computer system may be stored on and accessed via a computer readable medium such as a hard disk drive e.g. fixed disk an optical drive e.g. optical drive a floppy disk unit or other storage medium. For example infected website detection module may be resident in system memory .

Storage interface as with the other storage interfaces of computer system can connect to a standard computer readable medium for storage and or retrieval of information such as a fixed disk drive . Fixed disk drive may be a part of computer system or may be separate and accessed through other interface systems. Modem may provide a direct connection to a remote server via a telephone link or to the Internet via an internet service provider ISP . Network interface may provide a direct connection to a remote server via a direct network link to the Internet via a POP point of presence . Network interface may provide such connection using wireless techniques including digital cellular telephone connection Cellular Digital Packet Data CDPD connection digital satellite data connection or the like.

Many other devices or subsystems not shown may be connected in a similar manner e.g. document scanners digital cameras and so on . Conversely all of the devices shown in need not be present to practice the present disclosure. The devices and subsystems can be interconnected in different ways from that shown in . Code to implement the present disclosure may be stored in computer readable storage media such as one or more of system memory fixed disk optical disk or floppy disk . Code to implement the present disclosure may also be received via one or more interfaces and stored in memory. The operating system provided on computer system may be MS DOS MS WINDOWS OS 2 OS X UNIX Linux or another known operating system.

Power manager may monitor a power level of battery . Power manager may provide one or more APIs Application Programming Interfaces to allow determination of a power level of a time window remaining prior to shutdown of computer system a power consumption rate an indicator of whether computer system is on mains e.g. AC Power or battery power and other power related information. According to some embodiments APIs of power manager may be accessible remotely e.g. accessible to a remote backup management module via a network connection . According to some embodiments battery may be an Uninterruptable Power Supply UPS located either local to or remote from computer system . In such embodiments power manager may provide information about a power level of an UPS.

Referring to there is shown a infected website detection module in accordance with an embodiment of the present disclosure. As illustrated the infected website detection module may contain one or more components including protected URL management module redirection report aggregation module malware report correlation module and redirection protection module .

The description below describes network elements computers and or components of a system and method for infected website detection that may include one or more modules. As used herein the term module may be understood to refer to computing software firmware hardware and or various combinations thereof. Modules however are not to be interpreted as software which is not implemented on hardware firmware or recorded on a processor readable recordable storage medium i.e. modules are not software per se . It is noted that the modules are exemplary. The modules may be combined integrated separated and or duplicated to support various applications. Also a function described herein as being performed at a particular module may be performed at one or more other modules and or by one or more other devices instead of or in addition to the function performed at the particular module. Further the modules may be implemented across multiple devices and or other components local or remote to one another. Additionally the modules may be moved from one device and added to another device and or may be included in both devices.

According to some embodiments protected URL management module may manage a list of protected URLs. For example a security vendor may provide a service to register a website as a protected URL. The protected URL management module may process and track registrations of websites as protected URLs within the security vendor s service. In some embodiments the infected website detection module will enable detecting infections for websites registered with the protected URL management module . In some embodiments the protected URL management module may maintain contact information for administrators of registered websites to enhance the infection notification services. For example if an infection is detected in a registered website the protected URL management module may notify or alert an administrator about the possible infection. The notification may include details about the type circumstances severity or other information about the infection. Additionally the protected URL management module may allow for a website administrator to designate certain redirections from certain URLs as intentional or safe.

In some embodiments the protected URL management module may provide information regarding protected URLs to users. For example a user may be using a security agent from the security vendor. The security agent may be a network security engine such as an intrusion protection system IPS engine that can detect or monitor redirects from a protected URL to any other website based on the protected URL information sent by the protected URL management module .

According to some embodiments the redirection report aggregation module may aggregate redirection reports submitted by a plurality of security agents detecting redirects for the user. In some embodiments the redirection report aggregation module may be in communication with the protected URL management module to determine whether a particular redirection report is analyzed or whether a particular redirection report contains an intentional and safe redirection. In some embodiments the redirection report aggregation module may prioritize when a particular redirection report is analyzed based on whether the redirection report contains a redirection from a protected URL.

In some embodiments the redirection report aggregation module may analyze a redirection report to assess the conditions in which the redirection may have occurred. For example the redirection report may include a set of site navigation parameters including HTTP parameters such as the Referrer or the User Agent. The redirection report aggregation module may also analyze conditions across a plurality of redirection reports such as the time elapsed between subsequent redirection reports. In some embodiments the redirection report aggregation module may aggregate data across a plurality of redirection reports analyzing intersections of redirections details from a plurality of redirected users to detect whether a website is infected and determine the conditions that may have been satisfied to trigger the redirection more accurately.

According to some embodiments the malware report correlation module may be in communication with the redirection report aggregation module to correlate malware reports received from a plurality of users with the redirection reports received from the plurality of users. For example the user s security agent may also scan for malware on the user s system. A scan may occur periodically or a scan may be triggered when the security agent detects a redirect. In some embodiments the malware report correlation module may receive reports from the security agent when malware is first detected on the user s system. A malware report may include information about the circumstances in which the security agent detected the malware. For example the malware report may include the date and time at which the malware was first detected in the user s system.

In some embodiments the malware report correlation module may correlate malware reports from users with infections of particular malware to redirection reports from those users redirected from a particular website. The correlation may enable the redirection report aggregation module to detect infected websites more accurately. For example if users redirected from a particular website are also infected with a particular malware it may be more likely that the malware infection resulted from a malicious redirection due to a website infection.

In some embodiments the malware report correlation module may use the date and time information in a malware report to improve the correlation of malware infections with redirections. For example if a redirection report indicates that a user s security agent detected a redirection at a first time and the security agent subsequently detected new malware on the system within a predetermined threshold period of time following the redirection it may be more likely still that the new malware infection resulted from a malicious redirection due to a website infection. For example the threshold may be one minute ten minutes or any length of time suitable to improve the accuracy of correlating malware report information with redirection report information.

According to some embodiments the redirection protection module may be in communication with the redirection report aggregation module to facilitate protecting users from malicious redirections due to infected websites. For example the redirection protection module may send information regarding possible infection to users security agents which the security agents may use to protect the users from malicious redirection such as by blocking access to infected websites or redirected users to safe landing websites instead of malicious websites.

In some embodiments the redirection protection module may include information regarding the conditions that must be satisfied to trigger a malicious redirection for a particular infected website to enable more selective protection. For example the redirection protection module may report that a particular infected website only causes a malicious redirection when a user the referring website is a particular search engine. With this information a security agent may selectively permit access to the infected website when the known conditions for triggering a malicious redirection are not satisfied.

Additionally in SafeWeb URLs may be marked with security information. In some embodiments SafeWeb URLs with specific redirect parameters on a given target URL may be marked as a security risk while URLs without those redirect parameters may be marked as safe.

In some embodiments the infected website detection module may detect redirections due to malicious advertisements published to advertisement networks. Advertisement networks that fail to prevent malicious advertisement placement may be rated poorly in an advertisement network rating system. In some embodiments the redirection protection module may send information about an advertising network s rating to the security agents. The security agents may vary the degree of protection when a user encounters an advertising or other content publishing network based on an implied risk associated with a particular rating.

Referring to there is depicted a method for detecting an infected website in accordance with an embodiment of the present disclosure. At block the method may begin.

At block the one or more received malware reports may be correlated with the one or more security agents. In some embodiments correlation may be based on the type of malware reported or the amount of time elapsed between detecting the redirection and detection the malware.

At block information from the one or more received reports may be aggregated and the aggregated received reports may be analyzed to detect whether a particular website is infected.

At decision block if an infected website was not detected at block then the method may return to block so additional reports may be received for aggregation and analysis. If an infected website was detected at block then the method may proceed to block .

At block after an infected website has been detected one or more conditions that must be satisfied to trigger a malicious redirection may be determined based on the analysis at block .

At block redirection protection information may be sent to the security agents. If a condition was determined at block the determined condition may be included as part of the redirection protection information sent to the security agents.

At block if the infected website is a registered protected URL the contact registered to the infected protected URL may be notified. In some embodiments if the infected website is not a registered protected URL an appropriate point of contact may be determined and notified if possible.

After the contact is notified then the method may return to block so additional reports may be received for aggregation and analysis so that further detection of additional infected websites may proceed.

At this point it should be noted that infected website detection in accordance with the present disclosure as described above may involve the processing of input data and the generation of output data to some extent. This input data processing and output data generation may be implemented in hardware or software. For example specific electronic components may be employed in a infected website detection module or similar or related circuitry for implementing the functions associated with infected website detection in accordance with the present disclosure as described above. Alternatively one or more processors operating in accordance with instructions may implement the functions associated with infected website detection in accordance with the present disclosure as described above. If such is the case it is within the scope of the present disclosure that such instructions may be stored on one or more non transitory processor readable storage media e.g. a magnetic disk or other storage medium or transmitted to one or more processors via one or more signals embodied in one or more carrier waves.

The present disclosure is not to be limited in scope by the specific embodiments described herein. Indeed other various embodiments of and modifications to the present disclosure in addition to those described herein will be apparent to those of ordinary skill in the art from the foregoing description and accompanying drawings. Thus such other embodiments and modifications are intended to fall within the scope of the present disclosure. Further although the present disclosure has been described herein in the context of at least one particular implementation in at least one particular environment for at least one particular purpose those of ordinary skill in the art will recognize that its usefulness is not limited thereto and that the present disclosure may be beneficially implemented in any number of environments for any number of purposes. Accordingly the claims set forth below should be construed in view of the full breadth and spirit of the present disclosure as described herein.

