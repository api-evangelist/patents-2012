---

title: Bayesian modeling of pre-transplant variables accurately predicts kidney graft survival
abstract: An embodiment of the invention provides a method for determining a patient-specific probability of renal transplant survival. The method collects clinical parameters from a plurality of renal transplant donor and patient to create a training database. A fully unsupervised Bayesian Belief Network model is created using data from the training database; and, the fully unsupervised Bayesian Belief Network is validated. Clinical parameters are collected from an individual patient/donor; and, such clinical parameters are input into the fully unsupervised Bayesian Belief Network model via a graphical user interface. The patient-specific probability of disease is output from the fully unsupervised Bayesian Belief Network model and sent to the graphical user interface for use by a clinician in pre-operative organ matching. The fully unsupervised Bayesian Belief Network model is updated using the clinical parameters from the individual patient and the patient-specific probability of transplant survival.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09561006&OS=09561006&RS=09561006
owner: The United States of America as represented by the Secretary of the Navy
number: 09561006
owner_city: Washington
owner_country: US
publication_date: 20121027
---
This application claims the benefit of U.S. Patent Application No. 61 553 876 filed on Oct. 31 2011 and is related to U.S. patent application Ser. No. 13 083 090 filed on Apr. 8 2011 U.S. patent application Ser. No. 13 123 406 filed May 7 2011 and U.S. patent application Ser. No. 13 083 184 filed on Apr. 8 2011 which claimed the benefit of U.S. Patent Application No. 61 105 786 filed on Oct. 15 2008 and U.S. Patent Application No. 61 166 245 filed on Apr. 2 2009 which are hereby incorporated by reference.

The present invention relates to a model for providing patient specific prognosis of disease or a medical treatment using clinical data. More particularly the present invention relates to a fully unsupervised machine learned cross validated dynamic Bayesian Belief Network model that utilizes clinical parameters for a determination of patient specific probability of organ transplant.

Within this application several publications are referenced by Arabic numerals within brackets. Full citations for these and other publications may be found at the end of the specification immediately preceding the claims. The disclosures of all these publications in their entireties are hereby expressly incorporated by reference into the present application for the purposes of indicating the background of the present invention and illustrating the state of the art.

An organ transplant surgery replaces a failing organ with a healthy organ. The success rates of transplant surgery have improved remarkably from its start but growing shortages exist in the supply of organs and tissues available for transplantation. Organs and tissues that are transplanted within the same person s body are called autografts. Transplants that are performed between two subjects of the same species are called allografts. Allografts can either be from a living or cadaveric source.

The immune system is capable of discerning a cell as being self or non self according to that cell s serotype. In humans that serotype is largely determined by human leukocyte antigen HLA the human version of the major histocompatibility complex. Cells determined to be non self are usually recognized by the immune system as foreign resulting in an immune response. Serotypes differ widely between individuals. Therefore if organ from one human are introduced into another human the organ is oftentimes determined to be non self because it do not match the self serotype and rejected by the recipient s immune system. Critical decisions must be made prior to organ transplantation to appropriately match donors and recipients.

In some situation this rejection can be reduced by serotyping both recipient and potential donors to determine the closest HLA match. The United Network for Organ Sharing UNOS facilitates organ sharing for transplantation using policies developed by a committee of experts and approved by the Secretary of Health and Human Services. These policies define the criteria by organ type for organ matching procurement and distribution. http optn.transplant.hrsa.gov policiesAndBylaws policies.asp . For example in kidney transplantation cases the matching system allocates organs based on time on list human leukocyte antigen HLA A locus B locus and DR locus matching and whether recipient is suitable for an extended criteria donor ECD kidney. However the tools currently used to make final allocation decisions are inadequate and subjective which may result in sub optimal graft survival. Acute rejection of the graft by the host s immune system remains an unsolved problem in allograft organ transplant. Immunosuppressive drugs are used to help to prevent and manage acute rejection episodes in many situations.

However as in the case of kidney transplantation the expansion of the wait list far exceeds the number of available donor organs contributing to the stress on the allocation system. In 2007 approximately 72 000 patients were listed with the United Network for Organ Sharing UNOS with only 17 513 receiving transplants which was a 3 decrease over the previous year. Of those patients transplanted with deceased donor grafts approximately 10 of the grafts will fail in the first year with an additional 32 failing at five years and 61 at 10 years which would return those patients to the wait list. In an effort to bridge this gap medical professionals are relying on extended criteria donors ECD as well as donation after cardiac death DCD . With the use of a greater number of these grafts the ability to accurately predict graft failure becomes increasingly critical to maximize donation to the most suitable recipient and to minimize the flow of patients returning to the already burdened wait list. This application describes an objective tool that transplant surgeon may use for pairing donor organs with appropriate recipients to optimize outcomes.

As evidence based medicine is becoming the standard of care clinicians look towards prognostic tools to assist in decision making. 3 Machine learning can enable the development of a predictive model that incorporates multiple variables for a systems approach to organ allocation. Nomograms neural networks and decision trees have become popular methods for creating more objective ways to predict transplant outcomes 3 5 9 11 . While there are several publications on various models to predict allograft survival these models rely on either both pre and post operative variables or use only a handful of pre operative variables for model functionality. Some of the models including nomograms neural networks and tree modeling offer positive predictive values for graft survival of 43.5 82.1 and 76 . 3 5 However these models have not yet been implemented routinely in clinical setting.

Bayesian statistics is well suited to the analysis of large numbers of variables to predict outcomes. Originally developed in the 18th century advances in computing power have made it practical today. Bayesian methodology has been used to predict survival in liver transplant patients whereby using pre transplant variables the authors were able to predict 90 day survival with a positive predictive value PPV of 91 and an area under the curve AUC of 0.681. 6 The Bayesian modeling approach has not yet been applied to outcome prediction in renal allograft surgeries. Unlike traditional or frequentist statistical methods Bayesian statistics lends itself to use with large databases can tolerate missing values and incomplete variables and can graphically describe the probability distributions of outcomes 7 . In other words this type of statistical analysis allows for the use of an unlimited number of variables and not only shows the relationship between each variable and the targeted outcome but also the contribution of inter variable relationships to the probability of each outcome.

This disclosure describes a machine learning tool to generate a minimized Bayesian network that accurately predicts graft failure one and three years after transplantation based solely on pre operative variables.

An embodiment of the invention provides a highly predictive clinical decision support tool to assist physicians in rendering personalized organ matching and care decisions to improve graft survival. For instance in at least one embodiment a Bayesian Belief Network model is trained using a machine learning algorithm applied to large specific patient study population with pre transplant variables. A broad statistically validated network structure of multiple clinical variables provides a universal method to produce individual prediction on transplant outcome graft survival . This predictive risk assessment tool refines clinical decision making using multiple available parameters as well as partial information by providing case specific risk scores in an operationally computational manner. The risk assessment tool and predictive model is updated continuously to include new clinical treatment and outcome information in order to expand its decision support capability. The dynamic quantitative case specific predictions made by the predictive model allow the clinical decision support tool to be adapted to the specific needs and capabilities of a given medical clinic. Given the following enabling description of the drawings the apparatus should become evident to a person of ordinary skill in the art.

The method collects clinical parameters from patients to create a training database . As described more fully below examples of the clinical parameters include but not limited to a plurality of patient age blood type body mass index donor age BMI blood type gender pre operative assessment Serum Creatinine of Cadaveric Donor cause of death of Cadaveric Donor length of time on dialysis drug cigarette use and or history of diabetes or hypertension. Although in some embodiments not all of the example clinical parameters are used in a particular BBN ML

A fully unsupervised Bayesian Belief Network model is created using data from the training database and the BBN ML is validated . In at least one embodiment the structure of the BBN ML is a directed acyclic graph that is learned natively from prior probabilities resident in the training database. Each node in the directed acyclic graph represents a clinical parameter and includes two or more bins. Each bin represents a value range for the clinical parameter e.g. bin 1 gene expression level less than or equal to 1.0 bin 2 gene expression level greater than 1.0 . As described below a node can be created such that each bin in the node includes an equal number of data points. For example the value ranges of bins 1 3 can be created such that 33 of the training population is in each bin. In at least one embodiment cross validation is performed wherein the data is randomized into groups of matched training and test data a classifier is trained on each of the training sets created in the data preparation step using the same data discretization and modeling parameters. Then each corresponding test set is used to create a set of case specific predictions. A Receiver Operating Characteristic ROC curve is plotted for each test exercise to estimate model robustness and classification accuracy. Upon completion the best model structure is documented in for example XML format for deployment as the BBN ML. In at least one embodiment the relevant learning parameter and modeling log files are stored if future audits are performed.

The method in at least one embodiment collects the clinical parameters from an individual patient which is received into the BBN ML . The patient specific probability of surgical success is output from the BBN ML to a graphical user interface for use by a clinician in pre operative planning . As described more fully below the Bayesian models are in an interactive format such that a clinician can select an outcome or relative clinical variable by clicking on the graphical user interface and observing corresponding changes to the probability distribution of the remaining variables. The graphical user interface is also used to enter current patient specific data and receive an evidence based prediction of diagnosis e.g. transplant survival in 1 to 3 years thus enabling patient risk stratification and clinical decision.

The method updates the BBN ML using the clinical parameters from the individual patient and the patient specific probability of transplant graft survival . As illustrated in according to at least one embodiment the ongoing process of model development and deployment is one of data collection model development model validation model deployment i.e. prognosis prediction and iteration . This process is not static it includes constant update validation and improvement. As new data is collected models are updated and QC QA documented.

The following description provides example of using the systems and methodologies of the embodiments of the invention for predicting renal graft survival using pre operative variables. Data used for model building was obtained from the USRDS database 2004 .

A total of 1 266 494 cases were screened for data analysis SPSS 16 SPSS Inc. Chicago Ill. . Data was curated for accuracy and completeness. The Cohort selection scheme for model construction and validation is shown in Table 1. Inclusion criteria were first time graft 18 years of age or older and deceased donor kidney only recipient. The cohort was further narrowed by selecting transplants performed between 2000 2001 as this time period reflects current medication practices and allows for follow up. All cases in which outcome was unable to be determined were removed. Thus 7 418 patients remained of which 7 000 were randomly selected for model construction and validation. There were a total of 793 pre and post transplant variables extracted from the database which were ultimately narrowed to 52 variables based on clinical expertise global modeling and excluding those variables collected during follow up appointments that did not directly describe outcome. This process minimizes the complexity of the model and elucidates the value of variables that power outcome prediction. However it may also eliminate variables previously considered individually associated with graft survival.

All data processing was done with either SPSS v. 16 18 or EXCEL 2007 Microsoft Corp. Redmond Wash. . Outcomes of interest were 1 3 and 3 year survival. Graft survival was calculated as time from transplant date to graft failure date. In the absence of a graft failure date surrogates for failure were used a return to maintenance dialysis a second transplant or recipient date and cause of death. Grafts that did not fail within the confines of our dataset were given a survival length using their latest follow up date as a report of minimum survival. If a patient did not have a follow up date reported or was lost to follow up without a report of graft failure then that patient was removed from analysis.

Machine learning software is also used to retrain the model with new data. The machine learning software includes a configurations file which contains the settings for learning. The model is an XML model that specifies structure and joint probability distributions. The batch inference API uses the model and individual patient data from the patient database to produce patient specific predictions. A graphical user interface GUI e.g. web based or client server receives the patient specific predictions in the form of reports.

The current network model was constructed using a minimum description length MDL gain a weighting of the MDL or the Bayesian information criterion that trades off goodness of fit for model complexity of 0.5. An MDL gain of 1.0 leads to a relatively equal weighting of representation of the known data and complexity to yield a robust model. Continuous variables were divided into two bins based on equal areas under the distribution curves use of three bins was also investigated and did not result in added benefit. Binning continuous variables has the benefit of reducing noise in the data but also loses information. An additional bin was included for missing data where appropriate.

The network was queried to provide estimates for posterior probabilities given a priori knowledge and the model accuracy was validated using data from 2 204 patients withheld from the initial training dataset. Probability of graft survival was calculated using only variables whose values could be known prior to transplantation and ignoring all post transplant variables. Model performance was evaluated using receiver operator characteristic curves ROC . The area under the curve AUC is calculated as a measure of classification accuracy with 0.5 representing random chance i.e. the model is right just as often as it is wrong and 1.0 or 0.0 indicating perfect classification of both the positive and negative outcomes.

A 10 fold internal cross validation was used to assess robustness. It was then externally validated with an additional 2204 patients from the same time period to evaluate functionality. Finally an additional cohort of patients randomly selected from the years 1997 2002 and 2003 and meeting the same selection criteria as the model training cohort were used as a test set to evaluate model robustness with respect to transplant year.

As a demonstration of utility the model was used to estimate the number of grafts that could have been reallocated for improved predicted graft survival. Two Organ Procurement Transplantation Networks OPTN OPTN 2 Washington D.C. New Jersey Maryland West Virginia and Pennsylvania with a long wait time and OPTN 6 Hawaii Washington Oregon Alaska Montana and Idaho with a short wait time were evaluated. As a matter of reference based on OPTN data as of Apr. 29 2011 for kidney registrations listed 1999 2004 OPTN 2 had a median waiting time of 1 357 days Caucasian recipients 2003 2004 and OPTN 6 had a median waiting time of 831 days via optn.transplant.hrsa.gov on May 5 2011 .

Finally the donor information from a graft that failed within the first year was applied to other recipients in this same two year cohort to demonstrate how the model may be used as an allocation tool.

The donor and recipient characteristics for key variables from the 5000 patient model training dataset and the 2000 patient external validation dataset were compared. Both populations were well matched for donor and recipient age gender race and BMI p 0.05 . The recipients were well matched for time on dialysis and graft survival p 0.05 Table 1 . The internal 10 fold cross validation confirmed model robustness as measured by area under the curve AUC for both one year and three year graft failure 0.59 and 0.60 respectively . This exercise yielded a sensitivity and specificity for graft failure of 24.3 and 83.4 respectively one year and 30.6 and 80.2 respectively three years post transplantation using a threshold of 8.35 one year failure or 14.3 three year failure probability for a positive test.

The external validation also demonstrated predictive accuracy for identifying one year and three year graft failure AUC 0.63 and 0.63 . The embodiment model successfully identified 55 of the 138 grafts that failed within one year following current allocation practices. ROC curves are shown superimposed in . Using the thresholds mentioned above for a positive test for graft failure our model had a sensitivity of 39.9 and specificity of 79.9 . This was maintained for three year graft failure with a sensitivity of 39.8 specificity of 80.2 . Positive and Negative predictive values differed greatly between a balanced test cohort which has an equal number of cases in each graft failure class and one that is representative of the incidence rate but is over representative of graft survival data not shown . The latter was pursued in order to present the most conservative model one that considers the largest cohort available and demonstrates the promise of a machine learning approach to donor recipient matching.

BBN demonstrated that recipient BMI gender race and donor age drive predictive outcome. The Bayesian Belief Network BBN consisted of 48 nodes with 37 nodes representing pre transplant variables 12 representing post op variables and 3 nodes representing outcomes of 1 3 and 3 y survival Table 2 .

The model showed recipient BMI gender race and donor age to be the pre transplant variables with strongest association with survival as illustrated by being primary or secondary nodes of the graft survival nodes in the model . Of those nodes one donor age was classified as a parent of an outcome node while the remaining nodes were classified as having a shared child with or are grandparents or children of the outcome nodes. Although time on dialysis a surrogate for time on list and HLA matching are both associated with graft survival as can be seen in the network they are not as closely related to outcome as the aforementioned variables .

Model performance is affected by sampling time. The effect of sampling timeframe on model performance was tested using data from 4422 patients from 1997 3615 from 2002 and 423 from 2003 which were the total number of records meeting the selection criterion as per the 2000 2001 cohort. The performance as measured by AUC was 0.59 for 1997 0.597 for 2002 and 0.50 for 2003 for 1 year failure. The predictive performance for 3 year failure for 1997 was 0.59 and for 2002 was 0.60 as measured by AUC. Three year survival was not evaluated for 2003 as the USRDS data obtained for our investigation concluded with January 2005.

The model was applied to two OPTNs to demonstrate the potential for region specific graft recovery. For the years 2000 and 2001 in OPTN 2 New Jersey Pennsylvania Maryland District of Columbia Delaware and West Virginia 890 transplants meeting the selection criteria were performed. Of those 77 failed within the first year using the same probability thresholds as the validation exercises the model predicted 37 of those as failures with a sensitivity of 48.1 and specificity of 70.2 . This equates to a potential 4 graft re allocation. One hundred and twenty four grafts failed in the first three years. The model predicted 60 of those failures with a sensitivity of 48.4 and specificity of 70.5 . When applied to OPTN 6 Washington Oregon Idaho Montana and Hawaii with a shorter wait time the results were similar. Of the 279 grafts in this cohort transplanted in 2000 or 2001 19 grafts failed in the first year. This model predicted 4 of those failures which would suggest that an additional 1.43 of available organs or 21.1 of those failures should be re allocated to another candidate recipient.

To demonstrate this a patient whose graft failed in the first year post transplant was selected randomly from the OPTN 2 data. The donor information was then applied to all recipients in the above described cohort n 890 . Seventy seven grafts in this sub cohort failed within the first year thirty of which the model predicted would survive had that recipient received the example organ. Interestingly this re allocation was predicted to lead to three year survival for twenty five of these new donor recipient pairs with probabilities ranging from 0.105 to 0.143 for graft failure. Additionally 51 of the remaining 813 recipients all of whose grafts survived the first year were also predicted to have survived with the example organ with 0.916 probability.

With regard to three year graft survival the model identified 18 recipients whose graft survived longer than one year but failed in less than three years that might have survived greater than three years with a re allocation of the example organ 

This is the first study that uses BBN to predict outcomes in deceased kidney transplantation and places donor age as one of the most important pre transplant predictors of outcome 14 16 . Recipient BMI gender and race are also influential predictors of outcome in the model while wait time and HLA matching are shown to be much less associated with outcome. This is illustrated in the model graphic as donor age DAGE is a primary variable of or shares an arc with graft survival greater than three years graft survival over3yr while recipient gender RSEX and BMI BMI are secondary variables to a minimum of one year graft survival graft survival 1yr . The influence of combinations of these factors on one and three year outcome can be seen explicitly in Table 3.

BBN was able to weigh how each variable in the network major or minor influence each other to affect outcome in contrast to other more traditional nomograms. In essence BBN takes raw data in the form of individual probability distributions and refines that into a fluid network that accurately predicts renal transplant outcomes.

This model accurately predicts those donor recipient matches that will have a poor one year outcome as illustrated by the sensitivity of 40 . Furthermore for those donor recipient pairs that were already a good match the embodiment model did not overly predict them incorrectly as failures as seen by the high specificity of 80 . In other words the model would be able to reclaim or re allocate two fifth of the renal allografts that may have been lost in the first year due to a less than idea recipient selection. Another benefit of the Bayesian model is that while individual variables such as recipient gender may not reliably predict outcome these same variables populating a network can accurately predict graft outcomes.

While this model s performance decreases slightly with time from transplant it maintains a high survival predictive value 87 as well as a high specificity 77 . As the used threshold values that would provide for at least 40 identification of failed grafts we interpret this as correctly predicting those grafts that would fail while not incorrectly classifying good matches as failures. Although not all of the grafts that failed were captured under the current allocation system the identification of poor matches is improved by 40 for one year and three year failures and potentially warrants re allocation of the organ to another qualified recipient. Even though there is a low percent failure rate for cadaveric donor transplants within the first few years avoid graft failure in an additional 40 of those that failed within the first year translates into 500 additional grafts annually and thus a potentially significant reduction in the number of recipients returning to the wait list.

The practical effect of using the BBN as a decision making tool in renal allograft allocation may be multifold. Less organ waste and reduced cold ischemic times. Currently nearly 20 of all donor kidneys are discarded the majority being of marginal quality 19 . However with this model the pre transplant characteristics of the particular donor and the proposed recipients can be compared for a prediction of outcome. And as this model can be deployed in XML format a center could enter the known donor characteristics into a web based interface and compare the risk of failure based on each prospective recipient s characteristics.

For example with a kidney donation from a 44 year old White male without a history of diabetes and with a BMI of 30 a 39 year old White female without diabetes and with a BMI of 22 each of these values or evidence is entered directly into the model is associated with 83.45 probability of greater than 3 years graft survival. A 55 year old Black male with non insulin dependent diabetes and a BMI of 29 is associated with 74.67 probability. Finally a 39 year old Black female with non insulin dependent diabetes and a BMI of 32 is associated with a 72.5 probability of graft survival over 3 years.

This model can be used to augment the current allocation system. The current UNOS system should continue to be used to generate the short list of candidate recipients matching a particular donor organ. This model would then be applied as a mathematical equation that uses the donor s and recipients information to determine which match would result in the longest term outcome. The proposed method of matching may have the potential to save more than 40 of grafts that fail within their first year.

The invention can take the form of an entirely hardware embodiment or an embodiment containing both hardware and software elements. In at least one exemplary embodiment the invention is implemented in a processor or other computing device loaded with software which includes but is not limited to firmware resident software microcode etc.

A representative hardware environment for practicing at least one embodiment of the invention is depicted in . This schematic drawing illustrates a hardware configuration of an information handling computer system in accordance with at least one embodiment of the invention. The system includes at least one processor or central processing unit CPU . The CPUs are interconnected via system bus to various devices such as a random access memory RAM read only memory ROM and an input output I O adapter . The I O adapter can connect to peripheral devices such as disk units and tape drives or other program storage devices that are readable by the system. The system can read the inventive instructions on the program storage devices and follow these instructions to execute the methodology of at least one embodiment of the invention. The system further includes a user interface adapter that connects a keyboard mouse speaker microphone and or other user interface devices such as a touch screen device not shown to the bus to gather user input. Additionally a communication adapter connects the bus to a data processing network and a display adapter connects the bus to a display device which may be embodied as an output device such as a monitor printer or transmitter for example.

Computer program code for carrying out operations of the present invention may be written in a variety of computer programming languages. The program code may be executed entirely on at least one computing device or processor as a stand alone software package or it may be executed partly on one computing device and partly on a remote computer. In the latter scenario the remote computer may be connected directly to the one computing device via a LAN or a WAN for example Intranet or the connection may be made indirectly through an external computer for example through the Internet a secure network a sneaker net or some combination of these .

It will be understood that each block of the flowchart illustrations and block diagrams and combinations of those blocks can be implemented by computer program instructions and or means. These computer program instructions may be provided to a processor of a general purpose computer special purpose computer application specific integrated circuit ASIC or other programmable data processing apparatus to produce a machine such that the instructions which execute via the processor of the computer or other programmable data processing apparatus create means for implementing the functions specified in the flowcharts or block diagrams.

The invention has industrial applicability to predict a patient specific diagnosis of disease. The invention utilizes a fully unsupervised cross validated and dynamic BBN ML that utilizes clinical parameters for determining the patient specific diagnosis which can be utilized to alter or improve the patient s lifestyle or to adjust therapy in a proactive manner.

