---

title: Method and apparatus for authoring stereoscopic 3D video information, and method and apparatus for displaying such stereoscopic 3D video information
abstract: A method and an apparatus for authoring stereoscopic 3D video information comprising a 3D video stream and 3D overlay graphics are described. A depth range in z-space for the stereoscopic presentation of the 3D video stream is determined for a plurality of time codes. A reference plane in z-space for placing the 3D overlay graphics is then determined such that depth conflicts between the 3D video and the reference place are reduced. A comfort zone surrounding a display screen plane and comprising the reference plane is defined, wherein the comfort zone specifies a depth range in z-space for preferable presentation of the stereoscopic 3D video information. It is then determined whether a depth conflict between the reference plane and the 3D video stream remains for the respective time codes and/or whether a depth conflict exists between the comfort zone and the 3D overlay graphics for the respective time codes. In this way a set of conflict intervals is generated, which is stored on a media source comprising the 3D video stream and the 3D overlay graphics. The set of conflict intervals is used during playback to adapt a presentation of the 3D video stream or a presentation of the 3D overlay graphics.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09547928&OS=09547928&RS=09547928
owner: THOMSON LICENSING
number: 09547928
owner_city: Issy les Moulineaux
owner_country: FR
publication_date: 20120217
---
This application claims the benefit under 35 U.S.C. 365 of International Application PCT EP2012 052791 filed Feb. 17 2012 which was published in accordance with PCT Article 21 2 on Sep. 7 2012 in English and which claims the benefit of European patent application No. 11305218.7 filed Mar. 1 2011.

The invention relates to a method and an apparatus for authoring stereoscopic 3D video information comprising a 3D video stream and 3D overlay graphics. Further the invention relates to a method and an apparatus for displaying such stereoscopic 3D video information.

With the recent box office success of stereoscopic 3D movies it is desired to bring 3D video to home entertainment too. One of the first solutions available is the Blu ray 3D format. Preferably the 3D movie is displayed inside a so called comfort zone. Determination of the comfort zone is still an area of active research. Typically the comfort zone describes an interval in z space extending from somewhere behind the screen to a minimal distance to a viewer in front of the screen. One option for determination of this comfort zone is the so called diopter rule. Further the range of the comfort zone according to the diopter rule depends on the distance between the viewer or user and the screen. Reproduction of 3D elements outside the comfort zone should be limited to special scenes and should be done with care to avoid user discomfort.

The Blu ray 3D format not only supports stereoscopic 3D video it also supports stereoscopic 3D auxiliary information such as stereoscopic 3D interactive applications like a user menu which are preferably written in the Java programming language.

An interactive menu may allow the user to select a certain scene a different audio track etc. Further 3D subtitles or an information text may be added to the stereoscopic reproduction. Such information which is typically presented in front of a main video stream shall be referred to as overlay graphics.

One technical challenge so as to provide a pleasant 3D user experience is to coordinate visual non video elements i.e. overlay graphics such as the aforementioned interactive menus with the main video stream in z space. In general so called depth conflicts should be avoided and overlay graphics should be placed in front of the 3D main video stream. Preferably interactive graphics should be placed in front of the subtitles if possible. A depth conflict between e.g. a main video stream and a user menu occurs if at least parts of both elements take the same place in z space. In such a conflicting area the user s viewing experience may be unpleasant.

Document WO 2009 083863 A1 discloses a method for display of 3D overlay graphics that are presented in front of a 3D main video stream. In order to prevent occlusions due to depth conflicts the available depth range in z space is split up into separate sub ranges. A respective sub range in z space is reserved for overlay data the main video stream subtitles etc.

It is an object of the invention to provide a method for displaying stereoscopic 3D video information comprising a 3D video stream and 3D overlay graphics a reproduction device and a system for displaying the stereoscopic 3D video information comprising the reproduction device and a media source allowing a more comfortable and flexible reproduction of the 3D video information.

According to a first aspect of the invention a method for displaying stereoscopic 3D video information comprising a 3D video stream and 3D overlay graphics comprises the steps of 

a retrieving a set of conflict intervals associated to the 3D video stream from a media source comprising the 3D video stream and the 3D overlay graphics wherein the set of conflict intervals is provided together with the stereoscopic 3D video information and wherein a conflict interval indicates that for certain time codes of the 3D video stream a depth conflict between the 3D video stream and a reference plane of the 3D overlay graphics or a depth conflict between the 3D overlay graphics and a comfort zone defined in the authoring process exists and b adapting a presentation of the 3D video stream or a presentation of the 3D overlay graphics for time codes of the 3D video stream that are located in one of the conflict intervals so as to resolve the corresponding depth conflict.

In order to implement the method according to the invention a reproduction device for displaying stereoscopic 3D video information comprising a 3D video stream and 3D overlay graphics is configured to 

a retrieve a set of conflict intervals associated to the 3D video stream from a media source comprising the 3D video stream and the 3D overlay graphics wherein the set of conflict intervals is provided together with the stereoscopic 3D video information and wherein a conflict interval indicates that for certain time codes of the 3D video stream a depth conflict between the 3D video stream and a reference plane of the 3D overlay graphics or a depth conflict between the 3D overlay graphics and a comfort zone defined in the authoring process exists and b adapt a presentation of the 3D video stream or a presentation of the 3D overlay graphics for time codes of the 3D video stream that are located in one of the conflict intervals so as to resolve the corresponding depth conflict.

According to the invention a set of conflict intervals is handed over to a reproduction device. A depth conflict exists between the 3D overlay graphics and the reference plane if the depth in z space for any feature of the 3D video stream conflicts with the reference plane in z space. Similarly a depth conflict exists between the 3D overlay graphics and the comfort zone if the depth in z space for any feature of the 3D overlay graphics is outside the comfort zone. The reproduction of the 3D video stream or the 3D overlay graphics is adapted for time codes of the 3D video stream that are located in one of the conflict intervals so as to resolve the depth conflict between presentation of the 3D video stream and the reference plane. The solution according to the invention thus avoids fixed depth spaces for presentation of either the 3D video stream or the 3D overlay graphics. Instead of this static solution reproduction of either the main video stream or the overlay graphics is adapted in order to prevent user discomfort. Advantageously depth conflicts are avoided on a per frame basis or in predetermined time intervals by simply checking the set of conflict intervals.

Preferably the set of conflict intervals is retrieved from a media source comprising the 3D video stream and the 3D overlay graphics. For this purpose the media source comprises a set of conflict intervals in addition to a 3D video stream and 3D overlay graphics. The set of conflict intervals indicates those intervals for which a depth conflict exists between the 3D video stream and a reference plane of the 3D overlay graphics or between the 3D overlay graphics and a comfort zone. Advantageously the set of conflict intervals is determined and stored on the media source during authoring of the 3D video stream and the 3D overlay graphics.

Advantageously the step of adapting the presentation of the 3D overlay graphics comprises determining a shifted reference plane that is different from an initial reference plane for a conflict interval wherein a position in z space for the shifted reference plane is selected such that the depth conflict is resolved. In this way occlusions and artifacts are be avoided since the overlay graphics is placed in front of the 3D video stream. Preferably the reference plane is shifted back to its initial position if the video depth information indicates that the depth of the three dimensional presentation of the main video stream does no longer exceed the reference plane. Further preferably the respective conflict interval is eliminated from the set of conflict intervals.

Favorably the step of adapting the presentation of the 3D overlay graphics comprises varying a z space expansion of the 3D overlay graphics such that the depth conflict between the 3D overlay graphics and the comfort zone is resolved. By dynamically adjusting the depth of the 3D overlay data the best user experience is safeguarded. On the one hand the user enjoys a 3D presentation of overlay data and on the other hand the comfort zone is not exceeded and a comfortable viewing experience is guaranteed.

Alternatively the step of adapting the presentation of the 3D overlay graphics comprises switching a presentation mode for the 3D overlay graphics or for the 3D video stream from a stereoscopic 3D mode to a flat 2D mode. By switching the presentation mode from the preferred 3D mode to a 2D or flat presentation mode depth conflicts between the 3D overlay graphics and the 3D video stream may be avoided. In case the presentation mode for the 3D video stream is switched to a 2D or flat presentation mode the 3D effect of the main video stream is sacrificed for a period of time. However this may be acceptable since the primary user focus will likely be on the 3D overlay graphics rather than on the video stream. Preferably the presentation mode is switched back to 3D presentation at a later runtime of the video stream. This is performed if the respective conflict interval indicates that the 3D presentation of the video stream does no longer exceed the reference plane or violates the comfort zone. Advantageously the 3D video effect is sacrificed only as long as necessary i.e. for a minimum time. The user enjoys 3D presentation of the main video stream as well as 3D presentation of the overlay graphics as long as possible.

According to another aspect of the invention the step of adapting the presentation of the 3D overlay graphics comprises adapting a transparency value for at least a part of the 3D overlay graphics. Preferably the transparency value is adapted for a part of the 3D overlay graphics which causes the depth conflict. Advantageously at least the conflicting parts of the overlay graphics are more transparent or even invisible so as to not disturb the presentation of the video stream.

Favorably the step of adapting the presentation of the 3D overlay graphics comprises delaying a user request for presentation of 3D overlay data until the end of the conflict interval. Often user menus are organized in so called pop up menus that are activated due to a user command. In the particular case the user tries to open such a menu and preferably a graphical indicator such as a sand glass or the like indicates that the respective menu will open after a short period of time. Consequently the full depth of the main video stream as well as a reasonable depth for the 3D menu are possible because at the later runtime of the video stream there will not occur any depth conflict.

According to another aspect of the invention a method for authoring stereoscopic 3D video information comprising a 3D video stream and 3D overlay graphics comprises the steps of 

a determining a depth range in z space for the stereoscopic presentation of the 3D video stream for a plurality of time codes 

b determining a reference plane in z space for placing the 3D overlay graphics such that depth conflicts between the 3D video and the reference plane are reduced 

c defining a comfort zone surrounding a display screen plane and comprising the reference plane wherein the comfort zone specifies a depth range in z space for preferable presentation of the stereoscopic 3D video information 

d determining whether a depth conflict between the reference plane and the 3D video stream remains for the respective time codes and or whether a depth conflict exists between the comfort zone and the 3D overlay graphics for the respective time codes 

e determining a set of conflict intervals defined by the respective time codes for which a depth conflict remains between the reference plane and the 3D video stream and or for which a depth conflict exists between the comfort zone and the 3D overlay graphics and f storing the set of conflict intervals on a media source comprising the 3D video stream and the 3D overlay graphics.

Similarly an apparatus for authoring stereoscopic 3D video information comprising a 3D video stream and 3D overlay graphics is configured to 

a determine a depth range in z space for the stereoscopic presentation of the 3D video stream for a plurality of time codes 

b determine a reference plane in z space for placing the 3D overlay graphics such that depth conflicts between the 3D video and the reference plane are reduced 

c define a comfort zone surrounding a display screen plane and comprising the reference plane wherein the comfort zone specifies a depth range in z space for preferable presentation of the stereoscopic 3D video information 

d determine whether a depth conflict between the reference plane and the 3D video stream remains for the respective time codes and or whether a depth conflict exists between the comfort zone and the 3D overlay graphics for the respective time codes 

e determine a set of conflict intervals defined by the respective time codes for which a depth conflict remains between the reference plane and the 3D video stream and or for which a depth conflict exists between the comfort zone and the 3D overlay graphics and f store the set of conflict intervals on a media source comprising the 3D video stream and the 3D overlay graphics.

In a first step a depth range in z space for stereoscopic presentation of the 3D video stream is determined for a plurality of time codes. Determination of the depth range may be performed by disparity estimation from a stereo pair of images or can be derived from the 3 dimensional virtual environment in case of computer generated content. Then a reference plane is set to a certain point in z space. The 3D overlay graphics are presented in a depth interval in z space ranging from the reference plane to an upper threshold facing a viewer. The reference plane is set in such way that depth conflicts between the 3D video and the reference plane are avoided to a certain extent. In addition a comfort zone surrounding a display screen plane and comprising the reference plane is defined. The comfort zone defines a depth range in z space for preferable presentation of the stereoscopic 3D video information. Subsequently the remaining depth conflicts between the reference plane and the 3D video stream are determined wherein a depth conflict exists between the 3D overlay graphics and the reference plane if the depth in z space for any feature of the 3D video stream conflicts with the reference plane in z space. Alternatively or in addition depth conflicts between the comfort zone and the 3D overlay graphics are determined wherein a depth conflict exists between the comfort zone and the 3D overlay graphics if any feature of the 3D overlay graphics conflicts in z space with an upper threshold of the comfort zone facing a viewer. The determined conflict intervals are added to a set of conflict intervals.

The comfort zone takes the aspect of a pleasant 3D viewing experience into account. Boundaries of the comfort zone in z space may be empirical values. Another option is a definition of the comfort zone by help of the diopter rule and a reference viewing environment. This aims to limit the convergence accommodation conflict. The comfort zone describes an interval in z space around a position of the screen Zscreen i.e. the user s 3D TV. It extends from somewhere behind the screen to somewhere in front of the screen. The comfort zone further depends on the distance between the user and the screen. Placement of 3D elements outside the comfort zone should be limited and be done with care to avoid user discomfort.

While for a period of time before t the video stream VS and the overlay graphics OD may be presented both within the available comfort zone at ta depth conflict arises. Such a depth conflict may lead to user discomfort. At a later time t the depth of the main video stream VS steps back behind the depth of the reference plane Zref and the depth conflict is resolved. However within the time span t tthe user may have an unpleasant viewing experience. Further as illustrated in for most of the time the overlay graphics OD is positioned closer to the viewer than necessary. In other words there is z space left between the minimum distance Zv min t of the video stream VS and the depth of the reference plane Zref. In stereo 3D presentation there is a desire to position non video graphical elements as close as possible to the screen plane to minimize so called ghosting artifacts. From a technical point of view these are crosstalk effects between the left and right channel.

The z space position Zref t of the reference plane is variable over time and is adapted to the depth of the reproduction of the video stream VS as it is indicated between tand tby the dashed line following the minimum distance Zv min t of the main video stream VS. The adaption of the reference plane Zref is preferably performed on a per frame basis e.g. during authoring. However it may likewise be performed on the fly during reproduction. In this case the frequency and accuracy of the corresponding adaption of the depth range for the overlay graphics OD may vary for different systems. In real time capable systems updates may be possible on a per frame basis leading to the best user experience. However in case interactive applications must be implemented on a non real time Java platform the depth adjustments may not be perfectly synchronized to the video frames. Also computational power of the consumer equipment embedded processes may be limited. In such cases depth updates may not be possible for each frame of the main video stream and may not be accurate with respect to timing. However even with a lower than a per frame update frequency and possibly timing imperfect adjustments the user experience will still be significantly better than without any adjustments. Further the programmer author can foresee a safety margin between the position of the reference plane Zref t and the minimum depth of the main video stream Zv min t to take into account that the update of the reference plane Zref t is not done on a per frame basis.

In between tand tthe reference plane Zref t is shifted to avoid depth conflicts between the main video stream VS and the overlay data OD. However at tthe minimum depth of the overlay data ZOD min t is in conflict with the minimum depth of the comfort zone Zcomfort min. In order to not exceed the comfort zone the depth range for the presentation of the overlay graphics is reduced to the available depth between the reference plane Zref t and the minimum depth of the comfort zone Zcomfort min. Accordingly between tand t the depth range for presentation of the overlay graphics OD is flattened to a lower depth while at tthe depth conflict between the presentation of the overlay graphics OD and the minimum comfort zone Zcomfort min is resolved and the overlay graphics can return to its original depth. At t the depth of the main video stream VS steps back behind the reference plane Zref t and the presentation of the overlay graphics OD returns to its original depth.

For dynamic depth adjustments the necessary data can be retrieved in various ways by the respective application or by a respective reproduction device for playback of stereoscopic 3D video information. The media time i.e. the runtime or time codes of the main video is usually retrievable through an application programming interface API . The position of the reference plane in z space may also be retrievable via an API at application runtime or may be provided to the application through a data file. A list of conflict intervals may be handed over to a reproduction unit. For a certain runtime of the main video stream if e.g. the user requests presentation of a 3D menu the reproduction device checks the list of conflict intervals. If a depth conflict has to be avoided suitable countermeasures are performed.

The embodiment according to has the advantage that it is easy to realize because the position of the reference plane Zref in z space does not need to be updated. No adjustments of the interactive application s 3D depth are necessary.

According to another aspect of the invention two further embodiments are described by making reference to . shows a scenario similar to . Between tand ta depth conflict between the main video stream VS and the overlay graphics OD is present. To resolve this depth conflict at least a part of the overlay graphics is made transparent. Preferably solely the respective parts or pixels of the overlay graphics causing the depth conflict with the main video stream are transparent. In this is illustrated by the intersection between the area for VS between tand t and the hashed area indicating the presentation of the overlay graphics OD. Preferably the overlay graphics or a part of it is set fully transparent in order to not disturb the visibility of the main video stream VS. In other words the overlay data vanishes in part or completely. Presentation of the main video stream VS has priority. Alternatively instead of rendering the overlay graphics information OD in a fully transparent manner it may be decided to completely remove the respective parts of the 3D graphical output.

According to between tand t there is a conflict between the presentation of the main video stream VS and the presentation of the overlay graphics OD. Between tand tan exceptional conflict occurs. The main video stream VS e.g. due to a desired special effect infringes the minimum depth of the comfort zone Zcomfort min. Accordingly there is no space left at all for presentation of the overlay graphics OD. Accordingly the depth of the presentation of the overlay graphics OD may be reduced to a flat 2D presentation preferably located at the minimum depth of the comfort Zcomfort min. Alternatively the overlay graphics OD may be transparent in the respective time interval.

Although the invention has been described hereinabove with reference to a specific embodiment it is not limited to this embodiment and no doubt further alternatives will occur to the skilled person that lie within the scope of the invention as claimed.

