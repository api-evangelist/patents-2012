---

title: Method and device for retinal image analysis
abstract: The present application provides methods and devices for diagnosing and/or predicting the presence, progression and/or treatment effect of a disease characterized by retinal pathological changes in a subject.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08787638&OS=08787638&RS=08787638
owner: The Chinese University of Hong Kong
number: 08787638
owner_city: Hong Kong
owner_country: CN
publication_date: 20120406
---
This application claims the benefit of U.S. Provisional Patent Applications No. 61 473 027 filed on Apr. 7 2011 and No. 61 588 815 filed on Jan. 20 2012 the contents of which are hereby incorporated by reference in their entireties.

The present application generally relates to a method and device for diagnosing and or predicting the presence progression and or treatment effect of a disease. In particular the present application relates to a method and device for diagnosing and or predicting the presence progression and or treatment effect of a disease characterized by retinal pathological changes in a subject.

Color retina image is the only way with direct inspection of blood vessel and its pathology change through the whole body. It not only reflects retina disease but also reflects risks of systemic diseases such as stroke.

Large epidemiological studies showed many retina characteristics which related to long term hypertension and or diabetes were associated with stroke incidence or prevalence. Those retina characteristics detected included retina vessel diameter arteriole venule nipping retinopathy etc. However there are new retina characteristics that could provide more information on stroke patient classification such as vessel tortuosity vessel asymmetry. Furthermore the interaction of the retina characteristics also provided very important information to classify patients with stroke from those without stroke. We have shown in our clinical study that the result contributed to the classification of patients with stoke from those without stroke using retina vessel tortuosity and asymmetry and interactions of retina characteristics.

Apart from the new retina information we detected manually for stroke classification computerized automatic analytical system based on fractal analysis high order spectral analysis and statistical texture analysis can also classify patients with stroke from those without stoke based on the analysis of color retina images. The data extracted from the automatic system correlated well with the clinical retina characteristics and their interaction. With such correlations we demonstrated that the automatic analytical system captured the clinically important characteristics over and above the level that can be done manually this can be expanded to other eye diseases with possible clinical interpretation.

The retinal pathological changes have been shown to be associated with many diseases including systematic diseases e.g. stroke hypertension diabetes cardiovascular diseases including coronary heart disease and cerebral vascular disease and eye diseases e.g. glaucoma retinopathy due to prematurity papilloedema macular hole and age related macular degeneration.

Many important eye diseases as well as systemic diseases manifest themselves in the retina. Cardiovascular disease manifests itself in the retina in a number of ways. Hypertension and atherosclerosis cause changes in the ratio between the diameter of retinal arteries and veins known as the A V ratio. A decrease in A V ratio such as thinning of the arteries and widening of veins is associated with an increased risk of stroke b1 . Recent research has also shown that the branching pattern of retinal arterial and venous systems have fractal characteristics b2 . For instance Patton N Aslam T and et al. suggested that retinal vascular image analysis is a potential screening tool for cerebrovascular disease. They mentioned that the fractals offer a natural global comprehensive description of the retinal vascular tree because they take into account both the changes in retinal vessel caliber and changes in branching pattern. Other studies related with retinal vessels characteristics are also provided by Mainster M. A. and Daxer A. they pointed out that the retinal arterial and venous patterns have fractal dimensions of 1.62 0.05 and 1.7 0.07 also the fractal dimension of retinal vessel patterns with neovascularisation at or near the optic disc NVD is about 1.8 comparing with the control group of about 1.7 b3 4 . However MacGillivary T. J. Doubal F. N. and et. compared monofractal and multifractal analysis of human retinal vasculature and they indicated that multifractal approach is more efficient for detecting small changes to the retinal vasculature. Therefore it is reasonable to believe that monofractal and multifractal analysis of human retinal vasculature are both necessary. Hence fractal geometry provides a global and more accurate description of anatomy of the eye than classical geometry. Fractal patterns characterize how vascular patterns span the retina and can therefore provide information about the relationship between vascular pattern and retinal disease.

Recently Hsu W. Lee M. L. and Wong T. Y. have developed a platform patented for automated analysis of a retinal image including automatically tracing one or more paths of one or more vessels of a retinal image and such obtained information may be useful in forming a diagnosis of a medical condition b5 . It also developed an automated retinal image analysis system and or used the fractal analysis technique to provide disease risk prediction such as hypertension. However the approach of tracing vessels is quite retinal image quality dependent comparing to other approaches. Also the zone defining vessel measurements lack flexibility in practical applications i.e. the image has to have the optic disc in the middle of the image it may not cover all useful information if the optic disc is not placed in the middle. Moreover some useful or partially useful non retinal vasculature related information may have been missed and more importantly almost all of retinal image analysis ignored the effect from the interactions between factors of the vessel measurements and or with other factors such as High order spectra HOS and texture analysis related risk factors. Acharya R. Chua C. K. and et al. have found the application of non linear features of the HOS was more suitable for the detection of shapes and thus they apply this technique for the identification of diabetes Retinopathy stages b6 . Dobrescu R. Dobrescu M. and et al. applied the method based on combined texture and fractal analysis automatic to detect the malignancy of skin lesions b7 . However until now there is no comprehensive technique approach using retinal images to provide disease risk prediction based on their complexity of characteristics i.e. interaction between shapes intensity directionality and etc. .

We developed an automated disease detection system using retinal images. We first generate all possible risk factors from color images that may associated with diabetes retinopathy stroke and or other diseases. This includes some characteristics from the aspect of intensity changes such as high order spectra entropy and etc. and also from Gray Level Co occurrence Matrix or Haralick and run length matrix Texture Features. For instance our previous study for retinal vessel patterns with neovascularisation detection has shown that there are number of significant of interactions among some high order spectra features and features related to the shape of vessels. Secondly we stored all generated factors and applied penalized supervised logistic regression to reduce the dimension or use random forest approach to extract important features . This procedure is used to generate potentially significant features associated with stroke and other diseases. Next we applied multi model inference with Generalized Linear Models MIGLM to select the best model that generated all possible factors with their pairwise interactions. Finally we applied the Random Forest to assess its stroke classification performance. The advantage of using penalized supervised logistic regression and MIGLM are their interactive effects preserving properties. Random Forest approach is considerable a suitable method for non linear classification in high dimensional space b8 .

In one aspect disclosed herein there is provided a method for diagnosing and or predicting the presence progression and or treatment effect of a disease characterized by retinal pathological changes in a subject comprising the steps of 

 b converting the image to a gray level image and or extracting vessels from the image to obtain the gray level image and or the vessel image 

 c performing one or at least two or more analyses on the gray level image and or the vessel image and generating one or more factors wherein the one or at least two or more analyses are selected from the group consisting of

 d comparing the one or more factors obtained from step c with those of a control a change of the factors is an indication of the presence progression and or treatment effect of the disease in the subject.

In another aspect there is provided a method for generating one or more factors associated with retinal image changes in a subject comprising the steps of 

 b converting the image to a gray level image and or extracting vessels from the image to obtain the gray level image and or the vessel image and

 c performing one or at least two or more analyses on the gray level image and or the vessel image and generating one or more factors wherein the one or at least two or more analyses are selected from the group consisting of

In one embodiment of the methods disclosed herein step b includes using mathematical morphological operations and or dual tree complex wavelet transform technique.

In some embodiments the methods disclosed herein comprise performing fractal analysis on the image and generating features associated with the fractal. In one embodiment the fractal analysis may include using complex wavelet methods preferably complex wavelet Leader multifractal analysis. In another embodiment the fractal analysis may include using multifractal spectrum analysis. In one embodiment the factor generated by the fractal analysis is selected from the group consisting of Sum Average Cluster Shade Hausdorff dimension and any combination thereof.

In some embodiments the statistical texture analysis may include using gray level co occurrence matrix GLCM and or run length matrix RLM to generate texture features including normalized Homogeneity normalized Entropy normalized Contrast normalized 4moment and normalized Run percentage. In some embodiments the higher order spectral HOS features obtained from the higher order spectral HOS analysis may include Entropy1 HOS features at degree of 100 Entropy2 HOS features at degree of 160 Entropy3 HOS features at degree of 40 Entropy3 HOS features at degree of 140 and 160 Entropy Phase HOS features at degree of 40 140 160 and 180 Entropy Magnitude HOS features at degree of 0 20 40 60 100 120 140 160 and 180. In a preferred embodiment the method disclosed herein comprises performing statistical texture analysis in combination with higher order spectral HOS analysis on the gray level image and generating features associated with the texture.

In other embodiments the methods disclosed herein further include analyzing the blood vessels properties from the gray level image and or the vessel image and generating a factor associated with the blood vessels properties. The factor associated with the blood vessels properties may be artery vein ratio AVR where AVR Central Retinal Artery Equivalent CRAE Central Retinal Vein Equivalent CRVE .

In other embodiments the method disclosed herein comprises performing abnormal pattern analysis on the gray level image and or the vessel image and generating features associated with the abnormal patterns. In one embodiment the abnormal pattern analysis may include using a wavelet algorithm based on wavelet transform preferably a dual tree complex wavelet transform and a wavelet based Radon transform. In another embodiment the abnormal pattern analysis may include using higher order spectral analysis in combination with a wavelet algorithm based on wavelet transform preferably a dual tree complex wavelet transform and a wavelet based Radon transform. In some embodiments the abnormal patterns may include hemorrhages exudates new vessels microaneurysm proliferative vitreoretinopathy or any combination thereof. In a particular embodiment the abnormal patterns are hemorrhages.

In some embodiments of the methods disclosed herein the disease is selected from the group consisting of stroke subclinical brain lesion white matter lesion dementia hypertension diabetes cardiovascular diseases including coronary heart disease and cerebral vascular disease glaucoma prematurity papilloedema and common retina disease such as macular hole age related macular degeneration. In one embodiment the disease is stroke and step c includes performing at least two of the four analyses on the gray level image and or the vessel image and generating one or more factors. In one embodiment the disease is diabetes and step c includes performing at least two of the four analyses on the gray level image and or the vessel image and generating one or more factors. In another embodiment the disease is diabetes and step c includes performing statistical texture analysis and abnormal pattern analysis on the gray level image and or the vessel image and generating one or more factors.

In a further embodiment the methods disclosed herein may be used to grade the retinal pathological changes in a subject. In one embodiment the retinal pathological changes are diabetic retinal pathological changes.

In another aspect disclosed herein there is provided a device for diagnosing and or predicting the presence progression and or treatment effect of a disease characterized by retinal pathological changes in a subject comprising 

a conversion module for converting the image to a gray level image and or extracting vessels from the image to obtain said gray level image and or vessel image 

an analysis module comprising one or at least two or more submodules for performing analysis on the gray level image and or vessel image and generating one or more factors wherein the one or at least two or more submodules are selected from the group consisting of

optionally a comparison module for comparing the factors obtained from the analysis module with those of a control.

In one embodiment of the device disclosed herein the conversion module is configured to carry out mathematical morphological operations and or dual tree complex wavelet transform technique.

In some embodiments the analysis module comprises a fractal analysis submodule for performing fractal analysis on the image and generating features associated with the fractal. In one embodiment the fractal analysis submodule is configured to carry out complex wavelet methods preferably complex wavelet Leader multifractal analysis. In another embodiment the fractal analysis submodule is configured to carry out multifractal spectrum analysis. In one embodiment the factor generated by the fractal analysis submodule is selected from the group consisting of Sum Average Cluster Shade Hausdorff dimension and any combination thereof.

In some embodiments the statistical texture analysis submodule is configured to carry out gray level co occurrence matrix GLCM and or run length matrix RLM to obtain texture features including normalized Homogeneity normalized Entropy normalized Contrast normalized 4moment and normalized Run percentage. In some embodiments the higher order spectral HOS features generated by the high order spectra analysis submodule may include Entropy1 HOS features at degree of 100 Entropy2 HOS features at degree of 160 Entropy3 HOS features at degree of 40 Entropy3 HOS features at degree of 140 and 160 Entropy Phase HOS features at degree of 40 140 160 and 180 Entropy Magnitude HOS features at degree of 0 20 40 60 100 120 140 160 and 180. In some embodiments the analysis module comprises a statistical texture analysis submodule and or a high order spectra analysis submodule for performing texture analysis on the gray level image and or the vessel image and generating a factor associated with the texture. In a preferred embodiment the statistical texture analysis submodule is used in combination with the high order spectra analysis submodule.

In other embodiments the analysis module further comprises a blood vessel property analysis submodule for analyzing the blood vessels properties from the gray level image and or the vessel image and generating a factor associated with the vessels properties. The factor associated with the vessels properties may be artery vein ratio AVR where AVR Central Retinal Artery Equivalent CRAE Central Retinal Vein Equivalent CRVE .

In other embodiments the analysis module comprises an abnormal pattern analysis submodule for detecting the abnormal patterns from the gray level image and or the vessel image and generating features associated with the abnormal patterns. In one embodiment the abnormal pattern analysis submodule is configured to carry out a wavelet algorithm based on wavelet transform preferably a dual tree complex wavelet transform and a wavelet based Radon transform. In another embodiment the abnormal pattern analysis submodule is configured to carry out higher order spectral analysis in combination with a wavelet algorithm based on wavelet transform preferably a dual tree complex wavelet transform and a wavelet based Radon transform. In some embodiments the abnormal patterns may include hemorrhages exudates new vessels microaneurysm proliferative vitreoretinopathy or any combination thereof. In a particular embodiment the abnormal patterns are hemorrhages.

In some embodiments of the device disclosed herein the disease is selected from the group consisting of stroke subclinical brain lesion white matter lesion dementia hypertension diabetes cardiovascular diseases including coronary heart disease and cerebral vascular disease glaucoma prematurity papilloedema and common retina disease such as macular hole age related macular degeneration. In one embodiment the disease is stroke and the analysis module comprises at least two of the four submodules. In one embodiment the disease is diabetes and the analysis module comprises at least two of the four submodules. In another embodiment the disease is diabetes and the analysis module comprises a statistical texture analysis submodule and an abnormal pattern analysis submodule.

In a further embodiment the devices disclosed herein may be used to grade the retinal pathological changes in a subject. In one embodiment the retinal pathological changes are diabetic retinal pathological changes.

In another aspect disclosed herein there is provided a method for screening or grading diabetic retinopathy in a subject the method comprising the steps of

b preprocessing the images to enhance the image contrast using mathematical morphological operations and wavelet transform 

d detecting and analyzing abnormal patterns related to diabetic retinopathy in the preprocessed image wherein the abnormal patterns are analyzed using wavelet algorithm and

e integrating the detection results and grading the severity of diabetic retinopathy based on the integrated results.

In another aspect disclosed herein there is provided a system for screening or grading diabetic retinopathy in a subject comprising

b a second module for receiving and preprocessing the images to enhance the image contrast using mathematical morphological operations and wavelet transform 

c a third module for locating optic disc and macula in the preprocessed images by morphological analysis 

d a fourth module for detecting and analyzing abnormal patterns related to the retinopathy in the preprocessed image which optionally comprises multiple units to detect different abnormal patterns wherein the abnormal patterns are analyzed using wavelet algorithm and

e a fifth module for integrating the analyzed results and grading the retinopathy based on the integrated results.

Further scope of the applicability of the present invention will become apparent from the detailed description and drawings provided below. It should be understood however that the following detailed description and examples while indicating preferred embodiments of the invention are given by way of illustration only since various changes and modifications within the spirit and scope of the invention will become apparent to those skilled in the art from the following detailed description and are defined in the claims appended below.

As used herein the term comprising means including . Variations of the word comprising such as comprise and comprises have correspondingly varied meanings. Thus for example a module comprising a unit may consist exclusively of that unit or may include one or more additional units.

As used in this application the singular form a an and the include plural references unless the context clearly dictates otherwise. In particular where the indefinite article is used the specification is to be understood as contemplating plurality as well as singularity unless the context requires otherwise.

As used herein the terms subject and patient are used interchangeably referring to a mammal including a non primate e.g. a camel donkey zebra cow pig horse cat dog rat and mouse and a primate e.g. a monkey chimpanzee and a human . In certain embodiments the subject or patient suffers or is susceptible to suffer from a disease characterized by a change of retinal pathology.

Reference throughout this specification to one embodiment or an embodiment or in another embodiment or some embodiments or other embodiments means that a particular referent feature structure or characteristic described in connection with the embodiment s is included in at least one embodiment. Thus the appearance of the phrases in one embodiment or in an embodiment or in another embodiment or in some embodiments or other embodiments in various places throughout this specification are not necessarily all referring to the same embodiment s . Furthermore the particular features structures or characteristics may be combined in any suitable manner in one or more embodiments.

The term abnormal patterns refers to the image signals which are not present in normal retinal image and are associated with diabetic retinopathy. Such abnormal patterns includes but not limited to hemorrhage exudates new vessels microaneurysm and proliferative vitreoretinopathy.

The following descriptions further illustrate the above one or more embodiments in detail and any section of the descriptions can be solely used and combined in any suitable manner in one or more embodiments.

In one aspect disclosed herein there is provided a method for diagnosing and or predicting the presence progression and or treatment effect of a disease characterized by retinal pathological changes in a subject comprising the steps of 

 b converting the image to a gray level image and or extracting vessels from the image to obtain the gray level image and or the vessel image 

 c performing one or at least two or more analyses on the gray level image and or the vessel image and generating one or more factors wherein the one or at least two or more analyses are selected from the group consisting of fractal analysis 

 d comparing the one or more factors obtained from step c with those of a control a change of the factors is an indication of the presence progression and or treatment effect of the disease in the subject.

In another aspect there is provided a method for generating one or more factors associated with retinal image changes in a subject comprising the steps of 

 b converting the image to a gray level image and or extracting vessels from the image to obtain the gray level image and or the vessel image and

 c performing one or at least two or more analyses on the gray level image and or the vessel image and generating one or more factors wherein the one or at least two or more analyses are selected from the group consisting of

In one embodiment of the methods disclosed herein step b includes using mathematical morphological operations and or dual tree complex wavelet transform technique.

In some embodiments the methods disclosed herein comprise performing fractal analysis on the image and generating features associated with the fractal. In one embodiment the fractal analysis may include using complex wavelet methods preferably complex wavelet Leader multifractal analysis. In another embodiment the fractal analysis may include using multifractal spectrum analysis. In one embodiment the factor generated by the fractal analysis is selected from the group consisting of Sum Average Cluster Shade Hausdorff dimension and any combination thereof.

In some embodiments the statistical texture analysis may include using gray level co occurrence matrix GLCM and or run length matrix RLM to generate texture features including normalized Homogeneity normalized Entropy normalized Contrast normalized 4moment and normalized Run percentage. In some embodiments the higher order spectral HOS features obtained from the higher order spectral HOS analysis may include Entropy1 HOS features at degree of 100 Entropy2 HOS features at degree of 160 Entropy3 HOS features at degree of 40 Entropy3 HOS features at degree of 140 and 160 Entropy Phase HOS features at degree of 40 140 160 and 180 Entropy Magnitude HOS features at degree of 0 20 40 60 100 120 140 160 and 180. In a preferred embodiments the method disclosed herein comprises performing statistical texture analysis in combination with higher order spectral HOS analysis on the gray level image and generating features associated with the texture.

In other embodiments the methods disclosed herein further include analyzing the blood vessels properties from the gray level image and or the vessel image and generating a factor associated with the blood vessels properties. The factor associated with the blood vessels properties may be artery vein ratio AVR where AVR Central Retinal Artery Equivalent CRAE Central Retinal Vein Equivalent CRVE .

In other embodiments the method disclosed herein comprises performing abnormal pattern analysis on the gray level image and or the vessel image and generating features associated with the abnormal patterns. In one embodiment the abnormal pattern analysis may include using a wavelet algorithm based on wavelet transform preferably a dual tree complex wavelet transform and a wavelet based Radon transform. In another embodiment the abnormal pattern analysis may include using higher order spectral analysis in combination with a wavelet algorithm based on wavelet transform preferably a dual tree complex wavelet transform and a wavelet based Radon transform. In some embodiments the abnormal patterns may include hemorrhages exudates new vessels microaneurysm proliferative vitreoretinopathy or any combination thereof. In a particular embodiment the abnormal patterns are hemorrhages.

In some embodiments of the methods disclosed herein the disease is selected from the group consisting of stroke subclinical brain lesion white matter lesion dementia hypertension diabetes cardiovascular diseases including coronary heart disease and cerebral vascular disease glaucoma prematurity papilloedema and common retina disease such as macular hole age related macular degeneration. In one embodiment the disease is stroke and step c includes performing at least two of the four analyses on the gray level image and or the vessel image and generating one or more factors. In one embodiment the disease is diabetes and step c includes performing at least two of the four analyses on the gray level image and or the vessel image and generating one or more factors. In another embodiment the disease is diabetes and step c includes performing statistical texture analysis and abnormal pattern analysis on the gray level image and or the vessel image and generating one or more factors.

In a further embodiment the methods disclosed herein may be used to grade the retinal pathological changes in a subject. In one embodiment the retinal pathological changes are diabetic retinal pathological changes.

In another aspect disclosed herein there is provided a device for diagnosing and or predicting the presence progression and or treatment effect of a disease characterized by retinal pathological changes in a subject comprising 

a conversion module for converting the image to a gray level image and or extracting vessels from the image to obtain said gray level image and or vessel image 

an analysis module comprising one or at least two or more submodules for performing analysis on the gray level image and or vessel image and generating one or more factors wherein the one or at least two or more submodules are selected from the group consisting of

optionally a comparison module for comparing the factors obtained from the analysis module with those of a control.

In one embodiment of the device disclosed herein the conversion module is configured to carry out mathematical morphological operations and or dual tree complex wavelet transform technique.

In some embodiments the analysis module comprises a fractal analysis submodule for performing fractal analysis on the image and generating features associated with the fractal. In one embodiment the fractal analysis submodule is configured to carry out complex wavelet methods preferably complex wavelet Leader multifractal analysis. In another embodiment the fractal analysis submodule is configured to carry out multifractal spectrum analysis. In one embodiment the factor generated by the fractal analysis submodule is selected from the group consisting of Sum Average Cluster Shade Hausdorff dimension and any combination thereof.

In some embodiments the statistical texture analysis submodule is configured to carry out gray level co occurrence matrix GLCM and or run length matrix RLM to obtain texture features including normalized Homogeneity normalized Entropy normalized Contrast normalized 4moment and normalized Run percentage. In some embodiments the higher order spectral HOS features generated by the high order spectra analysis submodule may include Entropy1 HOS features at degree of 100 Entropy2 HOS features at degree of 160 Entropy3 HOS features at degree of 40 Entropy3 HOS features at degree of 140 and 160 Entropy Phase HOS features at degree of 40 140 160 and 180 Entropy Magnitude HOS features at degree of 0 20 40 60 100 120 140 160 and 180. In some embodiments the analysis module comprises a statistical texture analysis submodule and or a high order spectra analysis submodule for performing texture analysis on the gray level image and or the vessel image and generating a factor associated with the texture. In a preferred embodiment the statistical texture analysis submodule is used in combination with the high order spectra analysis submodule.

In other embodiments the analysis module further comprises a blood vessel property analysis submodule for analyzing the blood vessels properties from the gray level image and or the vessel image and generating a factor associated with the vessels properties. The factor associated with the vessels properties may be artery vein ratio AVR where AVR Central Retinal Artery Equivalent CRAE Central Retinal Vein Equivalent CRVE .

In other embodiments the analysis module comprises an abnormal pattern analysis submodule for detecting the abnormal patterns from the gray level image and or the vessel image and generating features associated with the abnormal patterns. In one embodiment the abnormal pattern analysis submodule is configured to carry out a wavelet algorithm based on wavelet transform preferably a dual tree complex wavelet transform and a wavelet based Radon transform. In another embodiment the abnormal pattern analysis submodule is configured to carry out higher order spectral analysis in combination with a wavelet algorithm based on wavelet transform preferably a dual tree complex wavelet transform and a wavelet based Radon transform. In some embodiments the abnormal patterns may include hemorrhages exudates new vessels microaneurysm proliferative vitreoretinopathy or any combination thereof. In a particular embodiment the abnormal patterns are hemorrhages.

In some embodiments of the device disclosed herein the disease is selected from the group consisting of stroke subclinical brain lesion white matter lesion dementia hypertension diabetes cardiovascular diseases including coronary heart disease and cerebral vascular disease glaucoma prematurity papilloedema and common retina disease such as macular hole age related macular degeneration. In one embodiment the disease is stroke and the analysis module comprises at least two of the four submodules. In one embodiment the disease is diabetes and the analysis module comprises at least two of the four submodules. In another embodiment the disease is diabetes and the analysis module comprises a statistical texture analysis submodule and an abnormal pattern analysis submodule.

In a further embodiment the devices disclosed herein may be used to grade the retinal pathological changes in a subject. In one embodiment the retinal pathological changes are diabetic retinal pathological changes.

In some embodiments of the methods or devices disclosed herein the Hausdorff dimension is associated with or statistically significant associated with normalized diameter of arterioles NadjustedCRAE Vasymmetry by NadjustedCRAE mean venules Vasymmetry and hemorrhage with adjusted diameter of arterioles and or the Hausdorff dimension is associated with atrial fibrillation hypertension hemorrhage diabetes vessel tortuosity and arteriole venule nicking

In some embodiments of the methods or devices disclosed herein the fractal related texture features Sum Average and Cluster Shade are statistically significant associated with normalized diameter of arterioles NadjustedCRAE Vasymmetry by NadjustedCRAE mean venules Vasymmetry and hemorrhage with adjusted diameter of arterioles.

In some embodiments of the methods or devices disclosed herein the texture feature of normalized Homogeneity is statistically significant associated with stroke related features Vasymmetry by NadjustedCRAE NadjustedCRAE mean venules Vasymmetry hemorrhage with adjusted diameter of arterioles and vasymmetry with tortuosity.

In some embodiments of the methods or devices disclosed herein the texture feature of normalized Entropy is statistically significant associated with stroke related features Vasymmetry by NadjustedCRAE NadjustedCRAE mean venules Vasymmetry hemorrhage with adjusted diameter of arterioles and Vasymmetry with tortuosity.

In some embodiments of the methods or devices disclosed herein the texture feature of normalized Contrast is statistically significant associated with stroke related features Vasymmetry by NadjustedCRAE NadjustedCRAE mean venules Vasymmetry hemorrhage with adjusted diameter of arterioles and Vasymmetry with tortuosity.

In some embodiments of the methods or devices disclosed herein the texture feature of normalized 4moment is statistically significant associated with stroke related features Vasymmetry by NadjustedCRAE NadjustedCRAE mean venules Vasymmetry hemorrhage with adjusted diameter of arterioles and Vasymmetry with tortuosity.

In some embodiments of the methods or devices disclosed herein the texture feature of normalized Run percentage is statistically significant associated with stroke related features Vasymmetry by NadjustedCRAE NadjustedCRAE mean venules Vasymmetry hemorrhage with adjusted diameter of arterioles and Vasymmetry with tortuosity.

In some embodiments of the methods or devices disclosed herein the texture feature of normalized Entropy is large value of Odd ratio associated with stroke related features nipping.

In some embodiments of the methods or devices disclosed herein the HOS feature of Entropy1 at degree of 100 is statistically significant associated with stroke related features NadjustedCRAE and or the HOS feature of Entropy2 at degree of 160 is statistically significant associated with stroke related features hemorrhage with adjusted diameter of arterioles and or the HOS feature of Entropy3 at degree of 160 is statistically significant associated with stroke related features Vasymmetry by NadjustedCRAE and NadjustedCRAE alone.

In some embodiments of the methods or devices disclosed herein the HOS feature of Entropy Phase at degree of 140 is statistically significant associated with stroke related features Vasymmetry by NadjustedCRAE and or the HOS feature of Entropy Phase at degree of 160 is statistically significant associated with stroke related features NadjustedCRAE and or the HOS feature of Entropy Phase at degree of 180 is statistically significant associated with stroke related features NadjustedCRAE alone and Vasymmetry by NadjustedCRAE.

In some embodiments of the methods or devices disclosed herein the HOS feature of Entropy Magnitude at degree of 0 is statistically significant associated with stroke related features vasymmetry with tortuosity and or the HOS feature of Entropy Magnitude at degree of 20 is statistically significant associated with stroke related features vasymmetry with tortuosity and or the HOS feature of Entropy Magnitude at degree of 40 is statistically significant associated with stroke related features NadjustedCRAE and or the HOS feature of Entropy Magnitude at degree of 60 is highly statistically significant associated with stroke related features NadjustedCRAE and or the HOS feature of Entropy Magnitude at degree of 100 is statistically significant associated with stroke related features vasymmetry with tortuosity Vasymmetry by NadjustedCRAE and mean venules Vasymmetry and or the HOS feature of Entropy Magnitude at degree of 120 is highly statistically significant associated with stroke related features NadjustedCRAE alone and hemorrhage with adjusted diameter of arterioles and or the HOS feature of Entropy Magnitude at degree of 140 is statistically significant associated with stroke related features NadjustedCRAE alone and Vasymmetry by NadjustedCRAE and or the HOS feature of Entropy Magnitude at degree of 160 is highly statistically significant associated with stroke related features NadjustedCRAE alone and vasymmetry with tortuosity and or the HOS feature of Entropy Magnitude at degree of 180 is highly statistically significant associated with stroke related features Vasymmetry by NadjustedCRAE and Vasymmetry with tortuosity.

In some embodiments of the methods or devices disclosed herein the HOS feature of Entropy Phase at degree of 180 is statistically significant associated with stroke related features AF and or other HOS features that highly associated with stroke related feature of hypertension are Entropy Magnitude at degree of 40 60 100 120 and 140 and or HOS features that are associated with stroke related features of diabetes are Entropy3 at degree of 40 and 140 Entropy Phase at degree of 140 Entropy Magnitude at degree of 100 and 120 and or HOS features associated with stroke related features of hemorrhage are Entropy1 at degree of 0 and 160 and Entropy Magnitude at degree of 120 and or HOS features that are associated with stroke related features of tortuosity01 are Entropy1 at degree of 0 Entropy Magnitude at degree of 40 and 140.

In another aspect of the present application it is directed to a system for screening or grading diabetic retinopathy in a subject comprising

b a second module for receiving and preprocessing the images to enhance the image contrast using mathematical morphological operations and wavelet transform 

c a third module for locating optic disc and macula in the preprocessed images by morphological analysis and

d a fourth module for detecting and analyzing abnormal patterns related to the retinopathy in the preprocessed image which optionally comprises multiple units to detect different abnormal patterns wherein the abnormal patterns are analyzed using wavelet algorithm and

e a fifth module for integrating the analyzed results and grading the retinopathy based on the integrated results.

The first module can be any imaging unit suitable for capturing retina images which is preferably integrated to other modules. In an embodiment the first module is digital fundus camera.

In an embodiment the second module for preprocessing is configured to detect and reduce non uniform illumination of the captured images and enhance the image contrast using mathematical morphological operations and wavelet transform.

In a preferred embodiment the second module is configured to detect and reduce non uniform illumination of the captured images using the decorrelation stretching method with hybrid median filtering top hat bottom hat and morphological enhancement operators for grey level.

In another preferred embodiment the second module is configured to enhance the image contrast using mathematical morphological operations and dual tree complex wavelet transform DTCWT .

In an embodiment the third module locating optic disc and macula conducts a morphological analysis which comprises using dilation and erode preprocessed image with structure element on disk shape for filtering non circular shape like spots.

In a preferred embodiment the wavelet algorithm conducted by the fourth module is an algorithm based on wavelet transform. More preferably the wavelet algorithm is selected from dual tree complex wavelet transform and a wavelet based Radon transform. Most preferably the fourth module is configured to conduct higher order spectral analysis which is combined with the wavelet algorithm.

In an embodiment the system for screening or grading diabetic retinopathy in a subject further comprises a sixth module to extract and remove vessels prior to the detection of abnormal patterns.

Preferably the sixth module is configured to identify and extract the vessels using vascular based techniques selected from mathematical morphological operations with dual tree complex wavelet transformation DTCWT methodology morphological filters matched filters and combinations thereof.

In another embodiment the system for screening or grading diabetic retinopathy in a subject further comprises a seventh module for analyzing the texture in the preprocessed image in order to detect the abnormal patterns accurately.

In a preferred embodiment the seventh module is configured to analyze the texture using statistical texture analysis techniques and higher order spectral analysis. More preferably the statistical texture analysis techniques can be selected from a gray level co occurrence matrix GLCM approach and run length matrix RLM approach.

In another preferred embodiment the seventh module is configured to analyze the texture using a wavelet transform in combination with higher order spectral analysis. More preferably the wavelet transform is wavelet based Radon transform and the higher order spectral features is 3rd order spectral analysis.

For the purpose of convenience multiple modules can be integrated together for screening diagnosing or grading diabetic retinopathy.

In another aspect of the present application it is directed to a method for screening or grading retinopathy in a subject comprising the following steps 

b preprocessing the images to enhance the image contrast using mathematical morphological operations and wavelet transform 

d detecting and analyzing abnormal patterns related to retinopathy in the preprocessed image wherein the abnormal patterns are analyzed using wavelet algorithm and

e integrating the detection results and grading the severity of retinopathy based on the integrated results.

In one embodiment pre processing of the captured image includes image clarity assessment automatic assessment of imported image and enhancement of the qualified image contrast using wavelet transform analysis. In a preferred embodiment the image clarity assessment includes detecting non uniform illumination and reducing it. In a more preferred embodiment reducing non uniform illumination of the images is based on the decorrelation stretching method with hybrid median filtering top hat bottom hat and morphological enhancement operators. Preferably the image enhancement included within the step of pre processing is conducted by mathematical morphological operations and wavelet transform to denoise and enhance the contrast at same time.

i detecting and reducing non uniform illumination using retinex related technique for colored original image and gradient field with histogram equalization for grey level 

ii assessing the captured images quality automatically based on clarity and field definition see Fleming A. D. et al. Automated assessment of diabetic retinal image quality based on clarity and field definition. Invest Ophthalmol Vis Sci 2006. 47 3 p. 1120 5 and

iii enhancing the qualified image contrast with mathematical morphological operations and dual tree complex wavelet transform DTCWT .

In an embodiment the location of optic disc can be based on known processes in the art which can distinguish between the retinal anatomical structures and the lesions. For example Osareh A. . PhD thesis. Department of Computer Science University of Bristol 2004 described the identification of optic disc based on its compactness feature Compactness region border length area wherein a boundary tracing algorithm see Sonka M. V. Hlavac and R. Boyle Image processing analysis and machine vision. 2nd ed. 1999 PWS Pub can be employed to obtain the region border length. Alternatively roundness detection with Hough circle method geometrical structured ellipse location method or highest intensity region detection can be employed to detect and locate the optic disc in retina images.

In a preferred embodiment locating the optic disc is carried out by morphological analysis which preferably comprises using dilation and erode preprocessed image with structure element on disk shape for filtering non circular shape like spots.

In certain embodiments the macular detection is based on similar means to those for detecting optic disc excepting for reversing the background color grey level and then applying the constant distance 2.5 diameters from OD to find darkest region as the macular usually appears as a darkened region and at a distance of approximately 2.5 times the optic disc diameter from the centre of the optic disc. It is known in the art that localization of macular contributes to early detection of lesions that threaten visual acuity and increase accuracy of lesion detection.

In one embodiment the system or method for screening or grading retinopathy further comprises a module or a step of extracting and removing vessels prior to the detection of abnormal patterns so as to facilitate the accuracy of abnormal pattern lesions detection. The imaging of vessels can take place by means of optical imaging technique with optical electronic image conversion or by means of electronic image generating technique e.g. scanning of photographic vessel images. Furthermore dilatation measurements of vessels in the back of the eye can be based on the use of optical precision measurement techniques in an ophthalmoscopic image the use of precision optical measurement techniques and densitometry of the photographic negative or based on photoelectric measurement methods. Other devices or methods for identifying vessels are known in the art see for example Suzuki Y. Surv. Ophthalmol. 1995 May 39 Suppl. 1 57 65 Schack et al. Mustererkennung 1994 Springer Pub. 475 481 DE 3 839 272 U.S. Pat. No. 5 031 632 and U.S. Pat. No. 6 621 917 .

Alternatively or additionally examples of the vascular based techniques can include for example mathematical morphological operations with dual tree complex wavelet transformation DTCWT methodology morphological filters matched filters and combinations thereof.

In another preferred embodiment the system or method further comprises a module or a step of analyzing the texture in the retina image in order to detect the abnormal patterns including HE and exudates accurately. Texture can be described as an attribute representing the spatial arrangement of the gray levels of the pixels in a region of a digital image. In texture analysis its tasks are to carry out classification segmentation and synthesis. For example statistical geometrical features and tree structured wavelet transform can be used for texture analysis and classification. see for example Chen Y. Q. M. S Nixon and D. W. Thomas Texture Classification Using. Image Processing 1994 p. 446 450 1050 and Chang T. and C. C. J. Kuo Texture analysis and classification with tree structured wavelet transform. Ieee Transactions on Image Processing 1993. 2 4 p. 429 441 .

In another preferred embodiment approaches for analyzing texture can include but not limited to statistical texture analysis techniques structural texture analysis techniques model based texture analysis techniques and transform based texture analysis techniques.

Specifically examples of statistical texture analysis techniques can include but not limited to a gray level co occurrence matrix GLCM approach which is based on the use of second order statistics of the grayscale image histograms and run length matrix RLM approach which encompasses higher order statistics of the gray level histogram. Example of the structural texture analysis include using different shapes of structuring elements and conceiving real textures as distorted versions of ideal textures see for example Indahl U. G. and T. Naes . Journal of Chemometrics 1998. 12 4 p. 261 278 . Example of model based texture analysis techniques include autoregressive AR models Markov random fields MRF see Cross G. R. and A. K. Jain 1983. 5 1 p. 25 39 and fractal models. Transform based texture analysis techniques convert the image into a new form using the spatial frequency properties of the pixel intensity variations. Preferable examples of such techniques include Gabor filters wavelet transforms analysis and Angle measure technique AMT . Particularly features derived from a set of Gabor filters can be used in texture analysis for image segmentation. Wavelet transform methods of feature extraction can be used to characterize texture and to treat the problems of texture segmentation and classification. Furthermore AMT can be used to extract textural features from unfolded image pixel values in order to characterize and predict externally measured reference textures using multivariate statistical techniques.

In a preferable embodiment the texture in the retina image is analyzed by statistical texture analysis techniques such as GLCM and RLM and higher order spectral HOS features from digital fundas image for example the 3rd moment of threshold feature s intensity. It will be understood by the skilled person in the art that the expected area of threshold intensity value for extracted features over whole image area i.e. mean or probability of intensity can be considered as the 1st order statistic. GLCM can be a 2nd order measure because it measures the relationship between neighborhood pixels.

In a more preferable embodiment a combination of wavelet transformation and HOS is used to analyze the texture in the retina image. Most preferably the texture is analyzed by the wavelet based Radon transform in combination with HOS. It is known that HOS consists of moment and cumulant spectra and can be used for both deterministic signals and random process. There are total six HOS parameters features which can be extracted based on bi spectral invariants. The bi spectral invariants contain information about shape of the waveform within the window and are invariant to shift and amplification. Five parameters are Entropy1 entropy mean Entropy2 entropy variance Entropy3 entropy 3rd moment Entropy phase Entropy magnitude. The extra information provided by HOS would lead to better estimation of parameters and shed light on nonlinearities in the source of signal. Furthermore the use of higher order spectra can result in good noise immunity.

In a preferred embodiment detection of abnormal patterns also comprises quantitatively counting the number area and location of the abnormal patterns.

Preferably abnormal patterns as defined herein are detected and analyzed by a wavelet approach. In a more preferred embodiment the abnormal patterns are detected by the wavelet processing in combination with higher order spectral analysis. Most preferably the wavelet processing is wavelet based Radon transform or dual tree complex wavelet transform and higher order spectral feature is the 3rd order spectral analysis.

As described above the abnormal patterns include but not limited to hemorrhage exudates new vessels microaneurysm and proliferative vitreoretinopathy PVR . Such patterns have clear definition in size shape roughness edge sharpness brightness and color Table 1 see Yen G. G. and W. F. Leong . IEEE Trans Inf Technol Biomed 2008. 12 1 p. 118 30 and thus can be measured by computer program.

Diabetic retinopathy as disclosed herein can be divided into two categories non proliferative diabetic retinopathy and proliferative diabetic retinopathy. The existence of new vessels is the landmark for proliferative diabetic retinopathy. The non proliferative diabetic retinopathy can be further divided into three classes which is graded by the existence of MA HE and exudates and their severity reflected by the number and area. The diagnosis and follow up scheme of diabetic retinopathy can be based on the guideline of diabetic retinopathy management of American Academy of Ophthalmology 2007 Table 2 .

One specific example of the abnormal patterns in diabetic retina image is exudates which appear as bright yellow white deposits on the retina due to the leakage of blood abnormal vessels. Their shape and size will vary according to different retinopathy stages. In one embodiment the detection of exudates comprises first processing the green component of the original colored image for uniformity and then applying morphological image processing to remove the blood vessels and identify the exudates region.

Another typical example of the abnormal patterns in diabetic retina image is hemorrhage which is an important feature to be detected in screening or grading diabetic retinopathy. In a preferable embodiment a morphology based technique is used for detection of hemorrhages. The technique applies morphology opening and erosion for the binary mask of dark regions produced as the output in the segmentation phase. Particularly the opening can be performed iteratively with an increasing structuring element general six times from 0 to 5 is enough for example until all hemorrhage lesions can be separated from the blood vessels and hemorrhage is turned into binary data black and white .

As described above the existence of new vessels is the landmark for proliferative diabetic retinopathy and new vessels is also one kind of abnormal pattern in diabetic retina image. It is known in the art the features which are used for new vessel detection include segment length gradient the mean Sobel gradient magnitude along the segment the Sobel gradient variance along the segment segment direction tortuosity 1 sum of absolute change in direction tortuosity 2 maximum difference in angular direction along segment tortuosity 3 mean change in angular direction per pixel the normalised mean segment grey level Grey Level variance along the segment distance of segment centroid from disc centre vessel density number of segments mean ridge strength kappa mean estimated vessel width and mean estimated vessel wall gradient.

In some embodiments a process for detecting new vessels is comprised in the system or method disclosed herein and can be performed based on statistical techniques or transform based techniques for extracting vessel features. For example the statistical techniques can apply the mean gradient magnitude with different directions along the segment using a wavelet approach. Preferably the wavelet approach is DTCWT. In another preferred embodiment transform based techniques can involve different order of spectral at most 3rd order such as HOS applied on extracted vessels in grey levels or the technique of a wavelet approach such as DTCWT used for extracting vessels.

In an embodiment a page with Matlab software as a graphics interface between users and computer GUI with tools development is created which has capability to storage data in files. The validation for diagnosis testing is given by using ROC curve with sensitivity specificity checking

The system or method as described in the application can be applied in the detection or diagnosis of other types of retinopathy besides diabetic retinopathy for example those related to cardiovascular diseases including stroke and coronary heart disease.

The automatic computer system provides more detailed information than human grading regarding severity of diabetic retinopathy and thus can be applied for detecting any abnormal patterns so as to screen diagnose and grading diabetic retinopathy.

In certain embodiments the automatic computer system can automatically select good quality images and can be able to tell if the quality is acceptable in real time basis.

The retinal photo can be taken again to ensure a reliable result is obtained. By means of the algorithms mass screening for diabetic retinopathy can be carried out to reduce workload and cost and increase coverage of screening program.

1. Stroke symptoms numbness paralysis slurring of speech blurring of vision etc. and the diagnosis was confirmed by experienced neurologists 

Patients were diagnosed as stroke case with the 1criteria with or without the examination of brain MRI or CT. There were totally 122 stroke cases in this study. The cases of stroke were from two sources 64 of them were from diabetic retinopathy screening program. The screening program was started in January 2008 and diabetic patients followed in the Prince of Wales Hospital were invited to be screened for diabetic retinopathy. There were 64 patients with prevalent stroke have their color retina image record in this screening program. Another 58 stroke cases were acute stroke patients from Acute Stroke Unit in Prince of Wales Hospital from January 2010 to July 2010. These patients were diagnosed as either ischemic stroke or hemorrhage stroke and they had adequate sitting balance to tolerate retinal photography. Written informed consent was obtained from patients or from their next of kin and the project was approved by the human research ethics committees of the respective hospital. There were 17 patients from the acute stroke unit suffering from diabetes. So there were totally 81 stroke cases with diabetes.

1. age 80 years old. Patients who were older than 80 years usually had optical opacity which was not suitable for color retina capturing. And this age group patients got more complication and more survival bias would occur if they were included.

2. The quality of the color retina images were too poor to be judged the existence of retina characteristics.

3. Patients with eye disease that had influence on the retina vessel structures or spot characteristics such as glaucoma trauma uveitis choroid new vessels etc.

122 controls were selected to compare with the stroke cases. Controls were from two sources patients without stroke in diabetic retinopathy screening program in Prince of Wales Hospital. Other controls were patients without stroke and obvious eye diseases that influenced retina vessel structure or spot patterns in Eye Outpatient Clinics in Prince of Wales Hospital. The mean follow up period from the date of retina image capturing to July 2011 was 4.3 years. The proportion of diabetes patients in stroke cases were high in this case control study. And diabetes has special characteristics in retina which is called diabetic retinopathy. As described in the introduction about 40 diabetes patients got diabetic retinopathy after ten year history of diabetes whereas very small amount patients without diabetes got retinopathy. In this study 81 stroke cases suffered from diabetes. To minimize the confounding effect of diabetes we selected 81 diabetic patients without stroke as controls. And the other 43 patients without diabetes as controls. All the controls were aged from 50 to 80 years old.

1. Patients with retina diseases that influence retina vessel structure or pattern characteristics. Any eye diseases that are related to the diameter changes of vessels such as glaucoma central branch retina vein arteriole occlusion severe myopia O D ratio 0.5 tumor any disease that leads to hemorrhages or exudates such as choroidal new vessel idiopathic polypoidal choroidal vasculopathy. Only patients with routine eye checkup recovered central serous chorioretinopathy mild quiet age related maculopathy confirmed by Fluorescein and Indocyanine Green Angiography were included as controls. Other eye diseases such as glaucoma occult choroid new vessels optic disc atrophy or edema etc were excluded.

3. Patients with diseases that influence vessel morphology such as rheumatoid diseases peripheral vascular disease.

Stroke risk factors including age gender hypertension diabetes history of cardiovascular complications myocardial infarction angina cardiac syndrome X atrial fibrillation blood lipid level level of HbA1c in diabetes patients smoking status were recorded for all subjects in this study. The stroke types such as ischemic stroke transient ischemic attack hemorrhage stroke and their manifestation in MRI and or CT were also recorded. The stroke type was judged by the CT MRI at acute phase or later in the follow up.

The formula developed by Knudtson et alwas used to summarize the diameters of arterioles in one retina image. The methods were described elsewhere Ref . in concise a circle was drawn around the edge of optic disc. The diameter of optic disc was measured. Six largest arterioles within the circle 0.5 to 1 diameter apart from the edge of optic disc were selected. A line perpendicular to the edge of vessel walls was drawn and measured as the diameter of the arteriole. With these six diameters we summarized one parameter CRAE by Knudtson s formula to represent the arteriole diameter of the retina. Similarly CRVE was used to summarized the venule diameters. AVR arteriole venule ratio was calculated as the ratio of CRAE to CRVE.

Hemorrhage and exudates were recorded as either exist or not. Other retinopathy including microaneurysms new vessels cotton wool spots was extracted from the images but was not included into analysis. microaneurysms were not included was due to its detection was prone be have measurement error. The other retinopathy s occurrence in the images was very low. Hemorrhage and exudates were key determinants for the severity of diabeteic retinopathy they were found to be associated with stroke and they are less suffered from interobserver variability. That is why hemorrhages and exudates were extracted from the color retina images

The sample size was not large enough to demonstrate the association of the severity of the spot characteristics with stroke.

Tortuosity was assessed by visual grading of one fovea centred and one disc centred fundus image from each eye displayed on a computer display and viewed by a medical doctor first of this paper with 3 years of experience in ophthalmology research especially trained in evaluating retinal blood vessels in fundus photographs. A grading scale was developed for the study based upon a preliminary inspection of the study photographs which indicated that an acceptable reproducibility could be achieved using a two level scale for arterial tortuosity. The grading levels for retinal arterial tortuosity were Category 1 predominantly straight arteries Category 2 mild to severe tortuosity with at least one inflections of at least one major artery The first author examined all images twice at an interval of 2 months in random order masked to disease status. The intra observer variability Kappa is 0.869.

Branching coefficient BC or area ratio is the ratio of the sum of the cross sectional areas of the daughter vessels of a bifurcation to that of the parent stem. Branching angle is the angle between the two daughter branches. Asymmetry index AI is the ratio of diameters of two daughter branches. Their calculation is below . 

Where D D Dare the diameter of trunk the smaller branch and the larger branch of one bifurcation point.

Niall Patton et alshowed that the bifurcation coefficients of different bifurcation of vessels in the same retina image did not correlate to the eccentricity to the edge of optic disc. So not all bifurcations of the all branches of arterioles or venules were selected to calculate to bifurcation coefficients. The population in this study were elderly aged from 50 to 80 years old with mean age of 66 years old. The optic media was opaque to some extent. The smaller branches of vessels were not visualized clearly in most of the images. The vessels that were smaller than 4 pixels were difficult to measure correctly. Lastly the methods to summarize diameter CRAE and CRVE focus on the vessels near optic disc. In this study we focus on summarizing the information of larger branches so we extracted the bifurcation of three sets of branches of arterioles and three sets of bifurcation of venules which were closest to optic disc.

The continuous retina parameters include the information of vessel diameters and bifurcations. The perimeters of optic disc were used as scale to adjust the magnification effect of retina cameras. There might be more than one bifurcation information in one retina to relatively reduce the selection bias of the bifurcations the mean of bifurcation coefficients and bifurcation angle and branch asymmetry were used for the analysis. The meaning of parameters were summarized below 

Aasymmetry mean asymmetry index of arterioles the lesser the value the bigger of arteriole asymmetry 

Canon non mydriatic retinal camera CR 1 with the angle of view of 45 degree was used in the diabetic retinopathy screening program. Topcon Retinal Camera TRC 50IX with angle of view of 50 degree was used in eye outpatient clinics to take color retina image. Photographs of the retina were taken of 1 randomly selected eye after 5 minutes of dark adaptation.

Retina images were from two sources where two different retina cameras were used. The original retina images taken by Canon non mydriatic retinal camera CR 1 were stored originally as TIFF format with 1536 1024 pixels. And the retina images taken by Topcon Retinal Camera TRC 50IX were originally stored as JPG format with 1365 1024 pixels. The parameters of bifurcation coefficient bifurcation angle branch asymmetry aterio venule ratio were dimensionless parameters. They were not influenced by magnification of retina images. The parameters of spot characteristics such as microaneurysms hemorrhages exudates cotton wool spots new vessels were judged as existence or not. They were also not influenced by the magnification of retina photos. The parameter of CRAE or CRVE was influenced by the magnification of retina images. Even for the same retina photos different axial length refractive error and eye to camera distance would have effect on the magnification which made the direct comparisons of CRAE or CRVE between different subjects not accurately. To adjust the magnification effect and directly compare the difference of CRAE and CRVE which were probably correlated to stroke event among different subjects we first resized and adjusted all retina images into JPG format with 1365 1024 pixels. Then we assumed that the diameter of optic disc was the same among different subjects. And the ratio of CRAE or CRVE to the diameter of optic disc was calculated as adjusted CRAE and adjusted CRVE . We used the adjusted CRAE and adjusted CRVE to represent the arteriole diameters and venule diameters of retina images and compare them in different subjects directly.

All continuous parameters are measured by ImageJ by pixels. Retina images were adjusted to the same resolution of 1365 1024 pixels by ImageJ. The length and angle measurement tools of ImageJ were used to measure the length and angle of vessels.

Intraclass correlation coefficient was used to test the intra observer reliability of the parameters measured by software ImageJ including CRAE CRVE bifurcation coefficient of arterioles bifurcation coefficient of venules branching angle of arterioles branching angle of venuels asymmetry index of arterioles asymmetry index of venules diameter of optic disc.

For univariate analysis the continuous parameters were compared between cases and controls by two sample independent t test. The categorical data was analysis by chi squire test. Logistic regression was used to select variables that were different between the two groups controlling for the demographic data. All data were analyzed by SPSS 16.0.

Eighteen color images were randomly selected from the control to test the intra observer variability. The first author measured all the parameters in the interval of two months.

The intraclass correlation coefficients of each parameter of two measurements were summarized in Table 3.

From the table above we could see that the intraclass correlation coefficients of CRAE CRVE Aangle Vangle OD were high enough that we might feel confident that intra observer reliability of these parameters was high. The intraclass correlation coefficient of Vasymmetry was 0.579 for single measurement and 0.733 for average measurements which might be acceptable for the further analysis of its relationship with stroke. Other parameters including BCA BCV Asymmetry had quite low intraclass correlation coefficients. New methods had to be developed to summarize these parameters to reach acceptable intra observer and inter observer reliability.

A total 244 patients were recruited in this study and 122 of them with event of stroke and the other 122 patients without stroke. Among all subjects there were 10 patients suffered from hemorrhage stroke others suffered from ischemic stroke or transient ischemic attack. The demographic data were given in Table 4. Since the status of diabetes and age were matched between the two groups as the design of the study there was no difference of age diabetes smoking status cardiac complications and hyperlipidemia between the two groups. Among the stroke patients ten of them suffered from hemorrhage stroke and others were ischemic stroke.

Difference of atrial fibrillation might be due to bias of body checkup. All stroke patients will have electrocardiogram to detect whether they have ischemic heart disease and atrial fibrillation. The ischemic heart disease manifested as chest pain could be demonstrated by patients whereas the symptoms of atrial fibrillation may be occult. The lower proportion of atrial fibrillation in controls may be under reported. The proportion of hypertension was lower in control group.

From the results of univariate analysis we can see that CRAE CRVE OD were significantly different between the two groups. This difference should be due to the magnification effect of retina camera. So we should use the parameters adjustedCRAE adjustedCRVE for direct comparisons of arteriole diameters or venule diameters between the two groups. We could see that both of the adjustedCRAE and adjustedCRVE were significantly smaller in the stroke group than the control group. The AVR were also significantly smaller in the stroke group. We could judge that both arterioles and venules were smaller in stroke patients while the arteriole diameters reduced much more than venule diameters. BCV was significantly different between the two groups. The Vasymmetry was marginally significant with P 0.132. Other parameters such as BCA Aangle Vangle Aasymmetry were not significantly different between the two groups.

There were totally 25 color retina images that no diameters were recorded. And 10 of them were in the control group the other 15 were in stroke group. Some of them were due to the opacity of the media and it was difficult to record the diameters. Some of them were due to eye vascular abnormalities that it was impossible to measure the diameters.

The retina characteristics including vessel tortuosity arteriole venule nicking hemorrhages exudates and arteriole occlusion were marked as existed or not. So they were regarded as categorical parameters in this study. the frequency of their existence were summarized and compared in the Table 6.

The occurrence of arteriole venuous nicking vessel tortuosity hemorrhages exudates and arteriole occlusion were all significantly higher in the stroke group than in the control group.

The aim of the risk model building is to detect the important retina characteristics associated with stroke and their risk modifier effects of each other. The risk model for stroke had main effects and retina characteristics. The main effects were well known risk factors of stroke. The main effects included diabetes hypertension hyperlipidemia history of ischemic disease atrial fibrillation smoking age and gender. The variables of retina characteristics were adjustedCRAE adjustedCRVE AVR BCA BCV Aangle Vangle Aasymmetry Vasymmetry arteriole venule nicking tortuosity hemorrhages exudates ateriole occlusion. In this case control study we controlled the status of diabetes and age. So this study can t address the risk of diabetes and age for stroke. But diabetes and age were left in the model for controlling confoundings. Parameters of BCA BCV Aasymmetry were found to have poor intra observer reliability. Aangle and Vangle were not significantly different between controls and stroke cases. They were not included into the risk model. The rest retina characteristics were discussed below separately 

The steps of risk model establishment were presented in Table 7. All variables of retina characteristics were statistically significant in the model two. The interaction between retina characteristics and diabetes or hypertension was not statistically significant when control for the main effects and retina characteristics. And the model with interaction of retina characteristics and diabetes or hypertension did not get higher accuracy of classification. The interaction of Vasymmetry by adjustedCRAE adjustedCRAE by hemorrhage Vasymmetry by tortuosity was statistically significant in step 5. And the model in step 5 had higher accuracy in classification than model 2 which means that the interaction between retina characteristics was important for the classification of stroke patients from patients without stroke. In model 3 the main effects which were not statistically significant and no contribution in the accuracy were removed from the model in step 5. And the model 3 had the highest accuracy of classification.

Model 3 was presented below Logic 10.895 0.281 hypertension 0.773 diabetes 2.815 20.683 adjustedCRAE 21.987 Vasymmetry 10.087 tortuosity 1.154 nipping 8.135 hemorrhage 39.021 Vasymmetry by adjustedCRAE 14.302 adjustedCRAE by hemorrhage 15.590 Vasymmetry by tortuosity Receiver Operating Characteristic ROC Analysis of the Risk Models

We measure the individual risk predictivity of the risk model 3 by the area under curve AUC the ROC. The probability that a person who had stroke event would have a higher risk score than a person who did not have an event. The area under curve was 0.836 95 confidence interval was 0.7800.892 using SPSS cross validation method which may an over estimation. When we use random forrest method for validation of this model we obtained AUC 0.74 sensitivity of 0.76 and specificity of 0.73.

2.2.1 Blood vessels features vessels width and the Arteriolar to Venular diameter Ratio AVR we may also consider part e as one of the blood vessel feature.

2.2.4 Fractal Analysis Other features including retinal arteriolar narrowing arteriole venule nicking and vessel tortuosity which any irregular shape related to stroke may be too complicate measured extracted from image . We use fractal analysis to deal with such kind of features.

We would like to carry out a stable and reliable medical evaluation from a single fundus photograph. In general the clinical usefulness of an image is highly dependent on its quality. In the image processing techniques we mainly focus on image quality assessment and enhancement. Previous studies on retinal images that do quality assessment focus mainly on two aspects image clarity and field definition. These aspects depend on features of various diseases. However almost all of these studies image clarity and field definition are based on a numerical quantification of image sharpness and illumination. In this project we develop an automatic method to carry out the quality evaluation on quality of digital fundus photographs.

At first we use the techniques for the automatic image quality assessment of retinal fundus image based on structural criteria and generic criteria. Structural criteria include the level of recognition of optic disc structure and vessel structure. Generic criteria include level on homogeneous illustration and also bright and high contrast background. Other than applying some clustering method sharpness metric and texture features Haralick texture features we developed a new assessment method based on fractal analysis from both grey level images and vessel extracted binary black and white images. The detailed procedure is given in the following 

Step 1 Preprocessing the original input image convert to gray level image in simply removed noise without shift variance problem by using dual tree complex wavelet DT CWT technique.

Remark We can enhance the qualified image contrast with color histogram and dual tree complex wavelet transform DTCWT . This technique will benefit almost all features extracted for Stroke in the retinal image. The reason we applied color histogram with statistical properties because of its well presenting of color properties. The DTCWT method transform without decimation can overcome the problem of the traditional ordinal discrete wavelet transform because it is not shift invariant and the decimation operation during the transform can be dealt with. A small shift in the input signal can cause very different output wavelet coefficients. This will provide benefit for the denoising process and enhance the contrast at the same time. In other words we can keep the detailed information of the features without having the noise involved.

Step 2 Automatic image quality assessment from two aspects on gray level image and on vessel extracted image. For gray level image we apply the method consists of a sharpness metric Haralick texture featuresand fractal analysis related parameters. For the extracted vessel image we apply the fractal analysis again. All of these results parameters will be generated and used to classify the level of acceptability of the qualified image AQI NAQI while AQI NQAI is provided by professional Ophthalmology experts justified from their screening results.

Step 3 Finally we will apply some statistical methods such as logistic regression generalized linear model or improved logistic regression method supervised penalized logistic regression and Random forest to determine important parameters. At the same time a prediction model with these parameters is obtained. validation using the ROC curve with the area under ROC curve plus the sensitivity and specificity will be provided to justify the results.

A dataset of 143 subjects are classified by an experienced eye specialist. There are total of 88 retinal images that are qualified for further screening while 55 retinal images are not qualified. I

From above result we can see that with a total 143 subjects of retinal images with 88 good and 55 poor quality images for quality assessment identification after 20 random sampling with replacement from original retinal images 70 for training and 30 for testing there is an average of AUC almost 99 accuracy. We also obtain a sensitivity of about 94 and a specificity of about 98 as detected by the automatic system. To obtain this result we first applied supervised penalized logistic regression method to extract significant features from total 26 texture and fractal features. Five of the significant features such as maximum probability Sum average correlation from texture related features and Hausdorff dimension from binary retinal image of vessels box counting with Fourier fractal dimension slope and intercept from gray level retinal image fractal analysis that are extracted. The validation of classification based on random forest is given and the accuracy is measured by the area under the ROC curve This result is considered as excellent accuracy for classification of the quality of the retinal images for the diagnosis purpose.

In addition the wavelet based multi fractal analysis approach will applied to improve the result as well in future study.

Abnormalities of retinal vasculatures may indicate poor health conditions in the body. The width ratio of arteries and veins A V ratio on the retinal fundus images may help physicians in diagnosis of hypertensive retinopathy which related to stroke. Other features related to stroke include bifurcation and tortuosity. Referring to previous study retinopathy vessel diameter arteriole venule nicking artery occlusion venule occlusion have been reported to be related to stroke. Since two components of the Central Retinal Artery Equivalent CRAE and the Central Retinal Vein Equivalent CRVE involve most of the above information. We will focus on CRAE CRVE or AVR where AVR CRAE CRVE. Rest of stroke related risk factors will be obtained from other two methods texture analysis and fractal analysis.

Recall that the manual computation of AVR is a tedious process since it involves repeated measurements of the diameters of all arterioles and venules in the region by human graders. To facilitate large scale clinical use an accurate rapid and efficient system to compute AVR is required. This project simply used the vessel network traced by a vessel tracking algorithm and then the vessel caliber is estimated. Vessels are then classified as either arteries or veins and AVR parameter is then obtained. The detailed procedure is given as follows 

Step 1 After Vessel segmentation extracted using techniques in previous project diabetes we work on thinning the vessel centerline detection and find the optic disc center point to obtain the region of interest ROI a circle within 0.5 to 1 diameter apart from the edge of optic disc . Then each vessel width measurement is obtained within the ROI by using Ai Li where Ai is the total area for vessel i and Li is the pixel length for center line of that vessel.

To enable separate analysis of the arteries and the veins in the image the previously detected vessel segments need to be assigned to one of these two classes. We used a supervised system such as Random Forest improved logistic regression method i.e. trained with examples. After a one time training procedure the method can be used to classify previously unseen centerline pixels into either artery or vein AV classification . Notice that an expert indicated whether a given major vessel was an artery or vein for each of the training images. Referring to the method inwith Random Forest it improved on the logistic regression as we can classify Artery Vein A V .

From the arteriolar and venular calibers estimated by the above steps the CRAE and CRVE parameters can be computed by the formula AVR CRAE CRVE. Notice that the AVR can provide an indication of a possible generalized arteriolar narrowing. Simply the widest 6 veins and arteries these do not have to be paired are entered although fewer total numbers of widths can be used in case not enough measurement points are available.

Step 4 Compare to the tested manual AVR Estimation and after validation we can use it for the detection of stroke.

Efficient feature extraction is one of the most significant aspects of texture analysis in computer vision applications. Most existing feature extraction methods provide efficient tool for shape and pattern classification in the images Chen Nixon Thomas 1994 Pietikainen Ojala Xu 2000 Tianhorng Kuo 1993 . But the situation becomes complicated while both size and shape of particles in the images come into a focus of public attention.

Although one can intuitively associate several image properties such as smoothness coarseness depth regularity etc. with texture there is no formal or complete definition of texture. Many researchers have described texture using various definitions. Russloosely defined image texture as a descriptor of local brightness variation from pixel to pixel in a small neighborhood through an image. Alternatively texture can be described as an attribute representing the spatial arrangement of the gray levels of the pixels in a region of a digital image. Texture analysis its tasks are mainly classification segmentation and synthesis.

The approaches for analyzing texture are very diverse and differ from each other mainly by the method used for extracting textural features. Four categories can be defined 1 statistical methods 2 structural methods 3 model based methods and 4 transform based methods.

Statistical texture analysis techniques primarily describe texture of regions in an image through higher order moments of their grayscale histograms. Probably the most frequently cited method for texture analysis is based on extracting various textural features from a gray level co occurrence matrix GLCM . The GLCM approach is based on the use of second order statistics of the grayscale image histograms. Alternatively the run length matrix RLM encompasses higher order statistics of the gray level histogram. The RLM texture analysis approach characterizes coarse textures as having many pixels in a constant gray level run and fine textures as having few pixels in such a run. Besides traditional statistical texture analysis multivariate statistical methods have also been proposed for textural feature extraction. Considering an image as a matrix the Singular Value Decomposition SVD spectrum is a summary vector of image texture represented by its singular values. The SVD spectrum has been used as a textural feature vector for image classification.

Structural texture analysis techniques describe a texture as the composition of well defined texture elements such as regularly spaced parallel lines. The properties and placement rules of the texture elements define the image texture. Various structural texture analysis approaches have been proposed ranging from using different shapes of structuring elementsto conceiving real textures as distorted versions of ideal textures. However these methods appear to be limited in practicality since they can only describe very regular textures.

Model based texture analysis techniques generate an empirical model of each pixel in the image based on a weighted average of the pixel intensities in its neighborhood. The estimated parameters of the image models are used as textural feature descriptors. Examples of such model based texture descriptors are autoregressive AR models Markov random fields MRF and fractal models.

Finally transform based texture analysis techniques convert the image into a new form using the spatial frequency properties of the pixel intensity variations. The success of these latter techniques lies in the type of transform used to extract textural characteristics from the image. Indhal and Naesillustrated the use of spectra from 2 D Fast Fourier Transform FFT magnitude images for textural feature extraction. Image classification using Multi way Principal Component Analysis MPCA on 2 D FFT magnitude images to extract features from various images was used by Geladi. The Gabor or Wavelet transforms have been preferred recently in image texture analysis due to their space frequency decomposition abilities. Features derived from a set of Gabor filters have been widely used in texture analysis for image segmentation. Wavelet transform methods of feature extraction have been used to characterize texture and to treat the problems of texture segmentation and classification. The Angle Measure Technique AMT has been used to extract textural features from unfolded image pixel values in order to characterize and predict externally measured reference textures using multivariate statistical techniques.

Therefore we may consider Texture is a representation of the surface and structure of an image. It is also defined as a common pattern on a surface. Image textures provide information about the spatial arrangement of colors or intensities such as tone variation shape size color brightness etc.

In this project we proposed a novel method for stroke detection using a combination of texture and higher order spectral HOS features from digital fundas image. Statistical texture analysis techniques such as GLCM and RLM and the 3moment of threshold feature s intensity are used. At first statistical texture features for the image samples are grouped according to their classes herein we have the classes of control and stroke the classes for grading of stroke will be considered in future study normalized and into independent t test or Analysis of Variance to test the hypothesis between the classes. At this stage we first extract Gray level Co occurrence Matric Texture features which include mean of Homogeneity Energy entropy Contrast Symmetry Correlation 1Moment 2moment to 4moment and etc. Other features come from the difference statistical features such as Angular 2moment and etc. features from Run Length Matrix Texture including Mean Short Long Run Emphasis and etc. total about 32 features and the most significance features from all GLCM and RLM related that are highly associated with stroke. In fact the RLM are shown to be more useful for image quality assessment but not in stroke detection. On the other hands for HOS features extraction we used similar approach as we did in diabetic retinopathy study HOS elicits both amplitude and phase information of a given signal. It offers good noise immunity and yields good results even for weak and noisy signals. It consists of moment and cumulant spectra and can be used for both deterministic signals and random process. First we applied image enhancement techniques using DTCWT with histogram equalization and Random transform was performed for HOS feature extraction. Notice that Radon transform is used to detect features within an image. There are total six HOS parameters features can be extracted based on bi spectral invariants. The bi spectral invariants contain information about shape of the waveform within the window and are invariant to shift and amplification and robust to time scale changes. Five parameters are Entropy1 entropy mean Entropy2 entropy variance Entropy3 entropy 3moment Entropy phase Entropy Magnitude.

One of the advantages of using HOS would be that the extra information provided by HOS leads to better estimation of parameters and sheds light on nonlinearities in the source signal. It can also be useful because they suppress addictive colored Gaussian noise of an unknown power spectrum. They identify non minimum phase signals. They are useful in extracting information that cannot be done by other methods. Lastly they detect and characterize nonlinear properties in signals. The use of higher order spectra results in good noise immunity as verified with synthetic and real images.

The early study A Case control result based on this approach is provided as follows Texture and high order spectra related automatic extracted features 

With a total 244 sample size of Case control study for stroke disease including 122 samples are control and 122 samples are strokes. We applied supervised penalized logistic regression method to extract significant texture related features from total 32 texture features. Five of significant features such as normalized Homogeneity nHo Entropy nEnt Contrast nCo 4moment nm4 from GLCM features and Run percentage nRunPer from RLM features that are extracted. The validation of classification based on Random Forest is given and the accuracy is measured by the area under the ROC curve which is about 0.74 with sensitivity and specificity of 0.86 and 0.58 respectively. This is considered as a quite fair accuracy for classification of stroke.

Similarly procedure we worked on high order spectra analysis and obtained the AUC is about 0.69 with sensitivity and specificity of 0.89 and 0.52 which is close to the fair accuracy for classification of stroke. The significant features from total 52 features are given as follows 

The following tables provide the results for the association between computer generated factors from texture analysis and clinical screening factors.

Fractals are objects with irregular auto similar features with details that can be noticed at any scale of representation. Biofractals are the fractal textures contours in biology tissues neurons leaves etc. . The similarity between fractals and the natural objects suggests that fractal properties such as fractal dimension may be used as a classifier in biology. Since many natural phenomena are so complicated and irregular that they cannot be modeled well using traditional classical techniques. Those irregular sets and functions can be regarded as a class to which a general theory can be applicable known as Fractal geometry . This class represents many natural phenomena much better than figures of classical geometry do and theory provides us with the concepts and practical techniques needed for the analysis of these phenomena. Many studies have been proposed that retinal vessels are fractal and that fractal analysis could be applied in automated diagnosis for retinal diseases. Some of related studies are proposed. In many studies the Box counting method has been largely used to estimate fractal dimensions of measures but this procedure has been pointed out as problematic due to memory and time limitation Hou et al. 1990 . It definitely will cause the problem when used in automatic computer system to detect stroke signs. Traditionally vascular patterns have been described using variety of simple measures including the mean diameter of vessels mean length of vessel segments branch angle vessel area density the fraction of image area occupied by the vessels and vessel length density the fraction of image area occupied by the skeleton of the vessels .

The recent study for Fractal Analysis of the Retinal Vasculature is proposed by Azemin M. Z. Kumar D. K. Wong T. Y. and et al. They proposed the method of Fourier Fractal dimension on these preprocessed images and do not require any segmentation of the vessels. This method can be used to extract the complexity of the retinal vasculature enhanced at different wavelet scales and a model was formulated for stroke prediction.

Based on the spirit of this approach and the advantage of wavelet transform over Fourier transform on multiscale analysis Wavelets often give a better signal information representation using Multiresolution analysis with balanced resolution at any time and frequency . In this project we have used two approaches to work on stroke prediction problem. One is based on qualified enhancing gray level image to apply the wavelet based fractal analysis to extract the most important features to detect stroke. The technique we used is complex wavelet Leader multifractal analysis since wavelet Leader multifractal analysis WLMF allows us to perform an accurate complete and low computational and memory costs multifractal characterization of textures in images. The other approach is to apply multifractal spectrum MFS . This method can provide an efficient framework combining global spatial invariance and local robust measurements. Besides these some parameters of monofractal analysis will also be generated. Overall all fractal analysis related parameters will be integrated and to classify the stroke cases. Finally the important significant factors will be gained also see .

Remarks Fractal analysis related parameters will be used in the detection of vascular change as a result of conditions such as stroke disease. At previous stage we mainly use three fractal parameters average intercepts and average slope dimension determined from all 24 directions of retinal gray level enhanced image Fourier Fractal dimension technique is used . Also the parameter of Hausdorff dimension is in a similar way determined as in above two parameters except it applies in a binary image for vessels. In the future study we will apply more advanced and accurate method based on the above mentioned wavelet techniques.

Similar to the above Case control study with texture analysis with HOS for stroke disease the supervised penalized logistic regression method is used to extract significant features from fractal texture combined features. Three of the significant features such as Hausdorff dimension Hdfdimension from binary retinal image of vessels Sum average savgh and Cluster Shade cshad are extracted. The validation results using the classification based on Random Forest is given and the accuracy is measured by the area under the ROC curve which is about 0.755 with standard deviation of 0.039 see Table 14 third column . This is considered as a quite fair accuracy for classification of stroke. See the following Table 14.

The following tables are the results of the association between computer generated factors and clinical screening factors

We will adopt the Hemorrhages extraction method in previous DR project. This is part of vessel features stated in . Notice that the measurement of Hemorrhages can be either present absent or the area calculated in pixels.

Remark the purpose of above procedure is to generate significant factors associate with stroke based on fractal analysis. Similarly for texture properties instead of generating fractal analysis factors fractal dimension slope intercept and etc. we generate texture features such as GLCM GLDM features and high order spectral related factors that highly correlate to stroke. Finally we integrate all significant factors parameters from sections 3.2 to 3.5 and apply the Random Forest combined with generalized linear model GLM to work on the diagnosis of stroke. Overall our new proposed features will cover much more useful information compare to previous studies.

We combined all three approaches using all the extracted features and applied supervised penalized logistic regression and Random Forest classification. The results show that the automated computer system using all features except DR features already has a very high AUC under ROC curve and have high sensitivity. However the specificity is low. When automatic computer system using all features including DR features the AUC of ROC curve achieves on average 0.88 with a sensitivity of 0.89 and specificity of 0.76. Table 17 

The significant features extracted without hemorrhage See Auto detected features A1 are e3r3 e3r9 ePRes10 amRes1 amRes7 amRes9 Hausdorff dimension from binary retinal image of vessels and normalized Homogeneity. With hemorrhage and DM involving we have the AUC 0.858 which has a comparable the most accuracy result. The significant features extracted are e3r9 amRes2 amRes9 Hausdorff dimension from binary retinal image of vessels normalized Homogeneity normalized 4moment hemorrhage and Diabetes.

We have reviewed the background information on using retinal images as risk assessment tools for predicting stroke. There is strong scientific rationale of the relationship of vascular circulation on the relationship between retina and brain where it is likely that stroke can be predicted by observing the retinal images. We have already tackled the automation problem using retinal images for diabetic retinopathy. A similar approach is now extended to this application including novel characteristics determined specifically for stroke for example vessel bifurcation vascular bifurcation angles vascular tortuosity and number of vessel branches.

We have also carried out manual assessment to evaluate the concept of using manually quantified parameters for the detection of stroke using existing and novel parameters we developed. The results of the case control study using retinal assessment alone have an AUC value of 0.73 under the ROC curve. The sensitivity is about 0.73 with a specificity of 0.73. Including the clinical information the sensitivity was increased to 0.76.

The automatic computer method we developed in this project included image quality assessment process. The program will then process four components of analyses including blood vessels parameters texture approach fractal analysis and diabetic retinopathy related parameters. With the information extracted from the program a classification is then performed to evaluate if the patient is likely to have a stroke. We used the case control study data for validation. The results using just the stroke characteristics determined in this project have an AUC value of 0.81 with a sensitivity of 0.97 and a specificity of 0.49. However if we included the diabetic retinopathy parameters the AUC value increased to 0.88 with a sensitivity of 0.89 and specificity of 0.76.

Since the random forest method is a more conservative we also carried out the SPSS cross validation analysis as a comparison to the manual classification. The AUC for the automatic detection is 0.92 95 confidence interval from 0.89 to 0.95 with a sensitivity of 0.83 and a specificity of 0.84 .

Public dataset DIARETDB0 Kauppi T. et. al 0. Technical report is used to train the system of the application. This database consists of 130 color retina images of which 20 are normal and 110 contain signs of the diabetic retinopathy. Characteristics of the dataset are summarized in Table 18. redsmalldots hemorrhages hardexudates softexudates and neovascularisation represent microaneurysms hemorrhages hard exudates cotton wool spots and new vessels respectively.

In the system utilized in the Example the first module is digital fundus camera integrated to other modules the second module is configured to conduct color histogram and dual tree complex wavelet transform DTCWT analysis and the seven module for analyzing texture and the units comprised in the fourth module for exudates and hemorrhage detection are configured to conduct a wavelet based Radon transform and 3rd order spectral analysis and the unit comprised in the fourth module for new vessels detection is configured to conduct DTCWT and 3rd order spectral analysis.

For testing the accuracy of the system the accuracy of detection of hemorrhage or exudates is determined with the given results of the dataset as reference. For testing the accuracy of DR grading 110 retina images without new vessels are used to determine whether the system can classify hemorrhage and exudates into three severity grading with the grading criteria in Early Treatment Diabetic Retinopathy Study ETDRS as reference see the following list .

Grade two hemorrhages less or equal to standard photograph 2 but more than standard photograph 1 in ETDRS.

Grade two exudates equal or more than standard photograph 3 and less than standard photograph 4 in ETDRS.

The system was also tested for the accuracy of grading of DR into grade one to grade three as described above. The 20 retina images with new vessels were used to test whether the system can detect new vessels accurately.

Student t test ANOVA will be used as significance test and ROC curve with accuracy sensitivity specificity will be used as validation test.

All 130 retina images in the dataset are used to test the sensitivity and specificity of exudates detection by the above system. The sensitivity and specificity are 97.18 and 89.83 respectively. The accuracy is 93.85 . Table 19 

In the 110 retina images without new vessels there are 61 images 44 images and 5 images in grade one grade two and grade three respectively in the severity of exudates graded by ophthalmologists. The above system detected the area in pixels of the exudates in each group Table 20 . There is a statistical significant difference in area among the three groups F 9.638 P

All 130 retina images in the dataset are used to test the sensitivity and specificity of hemorrhage detection by the system as described in the section Materials and Methods . The sensitivity and specificity are 98.78 and 85.42 respectively. And the accuracy is 93.85 . Table 22 

In the 110 retina images without new vessels there are 63 images 33 images and 14 images in grade one grade two and grade three respectively in the severity of hemorrhages graded by ophthalmologist. The above system detected the area in pixels of the hemorrhages in each group Table 23 . There is statistical significant difference in area among the three groups F 15.179 P

Referring to the grading criteria of American Association of Ophthalmology retina images without new vessels 110 images are graded by the above system into three grades where 58 in grade one 33 in grade two and 19 in grade three. In the univariate analysis area of exudates and hemorrhages texture of the image including third moment and high spectrum entropy ep1 ep2 ep4 are significantly different among the three grades Table 25 and Table 26 .

55 retina images were randomly selected as training group to train neural network and the other 55 retina images were used to test the accuracy. The above steps were repeated 20 times. The mean of accuracy is 97.2 .

The key feature of proliferative diabetic retinopathy PDR is the existence of new vessels. The system as described in the section Materials and Methods was used to detect normal retina image and retina image with new vessel.

The results obtained by the system demonstrate that retina image with new vessel exhibits curl small new vessels on optic disc which is distinctly different from the normal retina image . Therefore the system of the application can detect new vessels on optic disc accurately .

Compared with the existing results the system of the application successfully detects hemorrhages and exudates automatically and the accuracy is 93.85 based on the database DIARETDB0 with 110 retina images. The accuracy of referral rate is also 93.85 . The results obtained by the system of the application are much better than current available systems.

In general these experimental data clearly demonstrate that the system can detect abnormal patterns in the retina image and grade the severity of diabetic retinopathy more accurately. Specifically the preprocessing step using biostatistical methods greatly improved the efficiency of the subsequent image recognition processes and the development of texture parameters and the location information have increased the accuracy of both HE and exudates detection and allowing quantify the outcome. Furthermore the system incorporating the texture techniques increased the accuracy of detecting new vessels.

All of the above patents patent applications and non patent publications referred to in this specification are incorporated herein by reference in their entirety.

From the foregoing it will be appreciated that although specific embodiments of the application have been described herein for purposes of illustration various modifications or variations may be made by those skilled in the art without deviating from the spirit and scope of the appended claims.

