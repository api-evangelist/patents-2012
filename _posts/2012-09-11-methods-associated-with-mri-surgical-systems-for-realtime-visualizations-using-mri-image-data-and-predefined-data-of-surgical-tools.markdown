---

title: Methods associated with MRI surgical systems for real-time visualizations using MRI image data and predefined data of surgical tools
abstract: MRI-Surgical systems include: (a) at least one MRI-compatible surgical tool; (b) a circuit adapted to communicate with an MRI scanner; and (c) at least one display in communication with the circuit. The circuit electronically recognizes predefined physical characteristics of the at least one tool to automatically segment MR image data provided by the MRI scanner whereby the at least one tool constitutes a point of interface with the system. The circuit is configured to provide a User Interface that defines workflow progression for an MRI-guided surgical procedure and allows a user to select steps in the workflow, and wherein the circuit is configured to generate multi-dimensional visualizations using the predefined data of the at least one tool and data from MRI images of the patient in substantially real time during the surgical procedure.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09314305&OS=09314305&RS=09314305
owner: MRI Interventions, Inc.
number: 09314305
owner_city: Irvine
owner_country: US
publication_date: 20120911
---
This application is a divisional application of U.S. patent application Ser. No. 12 236 854 filed Sep. 24 2008 which is a continuation in part of U.S. application Ser. No. 12 134 412 filed Jun. 6 2008 which issued on May 8 2012 as U.S. Pat. No. 8 175 677 and also claims priority to U.S. Provisional Application Ser. No. 60 974 821 filed Sep. 24 2007 the contents of which are hereby incorporated by reference as if recited in full herein.

The present invention relates to MRI guided diagnostic or interventional systems that may be particularly suitable for placement localization of interventional medical devices and or therapies in the body. Embodiments of the present invention may be particularly suitable for placing neuromodulation leads such as Deep Brain Stimulation DBS leads placing implantable parasympathetic or sympathetic nerve chain leads and or CNS stimulation leads and or for delivering therapies to target internal locations in the body including atrial fibrillation AFIB therapies.

Deep Brain Stimulation DBS is becoming an acceptable therapeutic modality in neurosurgical treatment of patients suffering from chronic pain Parkinson s disease or seizure and other medical conditions. Other electro stimulation therapies have also been carried out or proposed using internal stimulation of the sympathetic nerve chain and or spinal cord etc.

One example of a prior art DBS system is the Activa system from Medtronic Inc. The Activa system includes an implantable pulse generator stimulator that is positioned in the chest cavity of the patient and a lead with axially spaced apart electrodes that is implanted with the electrodes disposed in neural tissue. The lead is tunneled subsurface from the brain to the chest cavity connecting the electrodes with the pulse generator. These leads can have multiple exposed electrodes at the distal end that are connected to conductors which run along the length of the lead and connect to the pulse generator placed in the chest cavity.

It is believed that the clinical outcome of certain medical procedures particularly those using DBS may depend on the precise location of the electrodes that are in contact with the tissue of interest. For example to treat Parkinson s tremor DBS stimulation leads are conventionally implanted during a stereotactic surgery based on pre operative MRI and CT images. These procedures can be long in duration and may have reduced efficacy as it has been reported that in about 30 of the patients implanted with these devices the clinical efficacy of the device procedure is less than optimum.

Some embodiments of the present invention are directed to MRI guided systems that can generate substantially real time patient specific visualizations of the patient and one or more surgical tools in logical space and provide feedback to a clinician to improve the speed and or reliability of an intrabody procedure.

The visualizations can be based in part on predefined data of the tool s which define a point of interface for the system e.g. software based on predefined characteristics of the tool s e.g. dimensions shape or configuration and or known rotational translational and or other functional and or dynamic behavior of one or more surgical tools. The visualizations can include patient function data e.g. fMRI data electrical activity active regions of a brain during a defined stimulation fiber tracks and the like .

The system can be configured to interrogate and segment image data to locate fiducial markers and generate successive visualizations of the patient s anatomical structure and tool s using MRI image data and a priori data of the tool s to provide substantially real time visualizations of the patient.

Some embodiments are directed to MRI guided surgical systems. The systems include a at least one MRI compatible surgical tool b a circuit adapted to communicate with an MRI scanner and c at least one display in communication with the circuit. The circuit electronically recognizes predefined physical characteristics of the at least one tool to automatically segment MR image data provided by the MRI scanner whereby the at least one tool constitutes a point of interface with the system. The circuit is configured to provide a User Interface that defines workflow progression for an MRI guided surgical procedure and allows a user to select steps in the workflow and wherein the circuit is configured to generate multi dimensional visualizations using the predefined data of the at least one tool and data from MRI images of the patient in substantially real time during the surgical procedure.

Other embodiments are directed to methods for performing an MRI guided surgical procedure. The methods include a defining dimensional and or functional data of at least one MRI compatible surgical tool b obtaining MRI image data of the patient c electronically segmenting the MRI image data to identify known fiducial markers on the at least one tool based on the defining step d generating visualizations of the at least one tool registered to patient anatomical structure e electronically generating directions on adjustments for a pitch roll or X Y actuator to adjust a trajectory of a trajectory guide and f guiding the tool to a location in the patient using patient MRI image data the directions for adjustment and the visualizations thereby facilitating an MRI guided surgical procedure.

Still other embodiments are directed to computer program products for facilitating an MRI guided surgical procedure. The computer program product includes a computer readable storage medium having computer readable program code embodied in the medium. The computer readable program code includes a computer readable program code that comprises predefined physical data of a plurality of different surgical tools b computer readable program code that communicates with an MRI scanner to obtain MRI image data of a patient and c computer readable program code that generates visualizations of the patient using data from the tools and the image data of the patient in substantially real time.

Yet other embodiments are directed to MRI guided interventional deep brain systems. The systems include a an MRI Scanner b a clinician workstation with a circuit and a display the workstation in communication with the MRI Scanner c at least one flexible patch with a grid thereon configured to releasably attach to a patient s skull and d at least one trajectory guide attachable to a skull of a patient. The guide has a base with an aperture configured to reside over a burr hole formed in a patient s skull. The base aperture provides a mechanical center of rotation for a pivot axis associated with the trajectory guide the base having a plurality of fiducial markers spaced apart about the base aperture. The circuit comprises physical data regarding the patch and is configured to interrogate patient imaging data provided by the MRI Scanner and segment the image data to define a burr hole location that intersects the patch with a desired intrabrain trajectory. The circuit comprises tool specific data of the trajectory guide and is configured to interrogate patient imaging data provided by the MRI Scanner and interactively generate visualizations of the patient s brain and the trajectory guide to the display.

In some embodiments the circuit is configured to provide a default trajectory for the trajectory guide on the display that extends through a center location of the grid patch.

Embodiments of the invention can provide output to a user such as one or more of a electronic generated warnings to alert an improper planned trajectory for a trajectory guide b warnings regarding a physical interference with a planned projected trajectory associated with the MRI bore size and isocenter position and optionally patient head size and angle s or configuration of a surgical tool c electronic instructions on what grid entry location to use to obtain a desired trajectory or entry point into the patient brain d calculate and provide suggested physical adjustments to actuators to obtain a desired trajectory orientation and generate instructions on what adjustments to make to X Y pitch and roll adjustment mechanisms e.g. rotate X button or dial left or right potentially with a number of rotations or increments and the like associated with the trajectory guide to obtain the desired trajectory and e generate electronic data of electrode offset values for stimulation leads in the brain to define where the electrodes are anatomically positioned whereby pulse generator programming may be accelerated over conventional techniques.

Some embodiments of the present invention can provide visualizations to allow more precise control delivery and or feedback of a therapy so that the therapy or a tool associated therewith can be more precisely placed delivered confirmed and visualized.

The present invention will now be described more fully hereinafter with reference to the accompanying drawings in which embodiments of the invention are shown. This invention may however be embodied in many different forms and should not be construed as limited to the embodiments set forth herein rather these embodiments are provided so that this disclosure will be thorough and complete and will fully convey the scope of the invention to those skilled in the art. Like numbers refer to like elements throughout. It will be appreciated that although discussed with respect to a certain embodiment features or operation of one embodiment can apply to others.

In the drawings the thickness of lines layers features components and or regions may be exaggerated for clarity and broken lines such as those shown in circuit of flow diagrams illustrate optional features or operations unless specified otherwise. In addition the sequence of operations or steps is not limited to the order presented in the claims unless specifically indicated otherwise.

The terminology used herein is for the purpose of describing particular embodiments only and is not intended to be limiting of the invention. As used herein the singular forms a an and the are intended to include the plural forms as well unless the context clearly indicates otherwise. It will be further understood that the terms comprises and or comprising when used in this specification specify the presence of stated features steps operations elements and or components but do not preclude the presence or addition of one or more other features steps operations elements components and or groups thereof. As used herein the term and or includes any and all combinations of one or more of the associated listed items.

Unless otherwise defined all terms including technical and scientific terms used herein have the same meaning as commonly understood by one of ordinary skill in the art to which this invention belongs. It will be further understood that terms such as those defined in commonly used dictionaries should be interpreted as having a meaning that is consistent with their meaning in the context of the specification and relevant art and should not be interpreted in an idealized or overly formal sense unless expressly so defined herein. Well known functions or constructions may not be described in detail for brevity and or clarity.

It will be understood that when a feature such as a layer region or substrate is referred to as being on another feature or element it can be directly on the other element or intervening elements may also be present. In contrast when an element is referred to as being directly on another feature or element there are no intervening elements present. It will also be understood that when a feature or element is referred to as being connected or coupled to another feature or element it can be directly connected to the other element or intervening elements may be present. In contrast when a feature or element is referred to as being directly connected or directly coupled to another element there are no intervening elements present. Although described or shown with respect to one embodiment the features so described or shown can apply to other embodiments.

The term electroanatomical visualization or refers to a visualization or map of the anatomical structure e.g. brain or heart typically a volumetric 3 D map or 4 D map that illustrates or shows electrical activity of tissue correlated to anatomical and or coordinate spatial position. The visualization can be in color and color coded to provide an easy to understand map or image with different measures or gradients of activity in different colors and or intensities. The term color coded means that certain features electrical activity or other output are shown with defined colors of different color and or intensity to visually accentuate different tissue different and similar electrical activity or potential in tissue and or to show abnormalities or lesions in tissue versus normal or non lesion tissue. In some embodiments the systems can be configured to allow a clinician to increase or decrease the intensity or change a color of certain tissue types or electrical outputs e.g. in high contrast color and or intensity darker opacity or the like.

The actual visualization can be shown on a screen or display so that the map and or anatomical or tool structure is in a flat 2 D view and or in 2 D what appears to be 3 D volumetric images with data representing features or electrical output with different visual characteristics such as with differing intensity opacity color texture and the like. A 4 D map illustrates time dependent activity such as electrical activity or blood flow movement.

The systems are configured to operate based on known physical characteristics of one or more surgical tools such that the hardware is a point of interface for the circuit or software. The systems can communicate with databases that define dimensions configurations or shapes and spacing of components on the tool s . The defined physical data can be obtained from a CAD model of a tool. The physical characteristics can include dimensions or other physical features or attributes and may also include relative changes in position of certain components or features upon a change in position of a tool or portion thereof. The defined physical characteristics can be electronically programmatically accessible by the system or known a priori and electronically stored locally or remotely and used to automatically calculate certain information and or to segment image data. That is the tool data from the model can be used to segment image data and or correlate a position and orientation of a tool and or provide trajectory adjustment guidelines or error estimates warnings of improper trajectories and the like. For example a grid for marking a burr hole location and or a trajectory guide that adjusts an intrabrain path for placing a diagnostic or therapy device and such can be input transposed and or overlayed in a visualization of the tool and patient structure or otherwise used such as for example to project the information onto a patient s anatomical structure or determine certain operational parameters including which image volume to obtain high resolution MRI image data that include select portions of the targeting canula. At least some of the resulting visualizations are not merely an MRI image of the patient during a procedure.

The visualizations are rendered visualizations that can combine multiple sources of data to provide visualizations of spatially encoded tool position and orientation with anatomical structure and can be used to provide position adjustment data output so that a clinician can move a controller a certain amount to obtain a desired trajectory path thereby providing a smart adjustment system without requiring undue guess work on what adjustments to make to obtain the desired trajectory.

The term animation refers to a sequence or series of images shown in succession typically in relatively quick succession such as in about 1 50 frames per second. The term frame refers to a single visualization or static image. The term animation frame refers to one image frame of the different images in the sequence of images. The term ACPC coordinate space refers to a right handed coordinate system defined by anterior and posterior commissures AC PC and Mid Sagittal plane points with positive directions corresponding to a patient s anatomical Right Anterior and Head directions with origin at the mid comissure point.

The term grid refers to a pattern of crossed lines or shapes used as a reference for locating points or small spaces e.g. a series of rows and intersecting columns such as horizontal rows and vertical columns but orientations other than vertical and horizontal can also be used . The grid can include associated visual indicia such as alphabetical markings e.g. A Z and the like for rows and numbers for columns e.g. 1 10 or the reverse. Other marking indicia may also be used. The grid can be provided as a flexible patch that can be releasably attached to the skull of a patient. For additional description of suitable grid devices see co pending co assigned U.S. patent application Ser. No. 12 236 621.

The term fiducial marker refers to a marker that can be electronically identified using image recognition and or electronic interrogation of MRI image data. The fiducial marker can be provided in any suitable manner such as but not limited to a geometric shape of a portion of the tool a component on or in the tool a coating or fluid filled component or feature or combinations of different types of fiducial markers that makes the fiducial marker s MRI visible with sufficient signal intensity brightness for identifying location and or orientation information for the tool and or components thereof in space.

The term RF safe means that the lead or probe is configured to safely operate when exposed to RF signals particularly RF signals associated with MRI systems without inducing unplanned current that inadvertently unduly heats local tissue or interferes with the planned therapy. The term MRI visible means that the device is visible directly or indirectly in an MRI image. The visibility may be indicated by the increased SNR of the MRI signal proximate the device.

The system can include an intrabody MRI receive imaging probe antenna to collect signal from local tissue. The term MRI compatible means that the so called component s is safe for use in an MRI environment and as such is typically made of a non ferromagnetic MRI compatible material s suitable to reside and or operate in a high magnetic field environment. The term high magnetic field refers to field strengths above about 0.5 T typically above 1.0 T and more typically between about 1.5 T and 10 T. MRI Scanners are well known and include high field closed bore and open bore systems.

Embodiments of the present invention can be configured to carry out diagnostic and interventional procedures such as to guide and or place interventional devices to any desired internal region of the body or object but may be particularly suitable for neurosurgeries. The object can be any object and may be particularly suitable for animal and or human subjects. Although primarily described with respect to placement of stimulation leads in the brain the invention is not limited thereto. For example the system can be used for gene and or stem cell based therapy delivery or other neural therapy delivery and allow user defined custom targets in the brain or to other locations. In addition embodiments of the systems can be used to ablate tissue in the brain or other locations. In some embodiments it is contemplated that the systems can be configured to treat AFIB in cardiac tissue and or to deliver stem cells or other cardio rebuilding cells or products into cardiac tissue such as a heart wall via a minimally invasive MRI guided procedure while the heart is beating i.e. not requiring a non beating heart with the patient on a heart lung machine .

Examples of known treatments and or target body regions are described in U.S. Pat. Nos. 6 708 064 6 438 423 6 356 786 6 526 318 6 405 079 6 167 311 6 539 263 6 609 030 and 6 050 992 the contents of which are hereby incorporated by reference as if recited in full herein.

Embodiments of the present invention may take the form of an entirely software embodiment or an embodiment combining software and hardware aspects all generally referred to herein as a circuit or module. In some embodiments the circuits include both software and hardware and the software is configured to work with specific hardware with known physical attributes and or configurations. Furthermore the present invention may take the form of a computer program product on a computer usable storage medium having computer usable program code embodied in the medium. Any suitable computer readable medium may be utilized including hard disks CD ROMs optical storage devices a transmission media such as those supporting the Internet or an intranet or other storage devices.

Computer program code for carrying out operations of the present invention may be written in an object oriented programming language such as Java Smalltalk or C . However the computer program code for carrying out operations of the present invention may also be written in conventional procedural programming languages such as the C programming language. The program code may execute entirely on the user s computer partly on the user s computer as a stand alone software package partly on the user s computer and partly on another computer local and or remote or entirely on the other local or remote computer. In the latter scenario the other local or remote computer may be connected to the user s computer through a local area network LAN or a wide area network WAN or the connection may be made to an external computer for example through the Internet using an Internet Service Provider .

The present invention is described in part below with reference to flowchart illustrations and or block diagrams of methods apparatus systems and computer program products according to embodiments of the invention. It will be understood that each block of the flowchart illustrations and or block diagrams and combinations of blocks in the flowchart illustrations and or block diagrams can be implemented by computer program instructions. These computer program instructions may be provided to a processor of a general purpose computer special purpose computer or other programmable data processing apparatus to produce a machine such that the instructions which execute via the processor of the computer or other programmable data processing apparatus create means for implementing the functions acts specified in the flowchart and or block diagram block or blocks.

These computer program instructions may also be stored in a computer readable memory that can direct a computer or other programmable data processing apparatus to function in a particular manner such that the instructions stored in the computer readable memory produce an article of manufacture including instruction means which implement the function act specified in the flowchart and or block diagram block or blocks.

The computer program instructions may also be loaded onto a computer or other programmable data processing apparatus to cause a series of operational steps to be performed on the computer or other programmable apparatus to produce a computer implemented process such that the instructions which execute on the computer or other programmable apparatus provide steps for implementing the functions acts specified in the flowchart and or block diagram block or blocks.

The flowcharts and block diagrams of certain of the figures herein illustrate exemplary architecture functionality and operation of possible implementations of embodiments of the present invention. In this regard each block in the flow charts or block diagrams represents a module segment or portion of code which comprises one or more executable instructions for implementing the specified logical function s . It should also be noted that in some alternative implementations the functions noted in the blocks may occur out of the order noted in the figures. For example two blocks shown in succession may in fact be executed substantially concurrently or the blocks may sometimes be executed in the reverse order or two or more blocks may be combined depending upon the functionality involved.

Generally stated embodiments of the systems are configured to provide a substantially automated or semi automated and relatively easy to use MRI guided systems with defined workflow steps and interactive visualizations. In particular embodiments the systems define and present workflow with discrete steps for finding target and entry point s localizing the entry point s to a physical identified grid position guiding the alignment of the targeting canula to a planned trajectory monitoring the insertion of the probe and adjusting the X Y position in cases where the placement needs to be corrected. During steps where specific MR scans are used the circuit or computer module can display data for scan plane center and angulation to be entered at the console. The workstation circuit can passively or actively communicate with the MR scanner. The system can also be configured to use functional patient data e.g. fiber tracks fMRI and the like to help plan or refine a target surgical site.

Embodiments of the present invention will now be described in further detail below with reference to the figures. illustrates an MRI guided interventional system with an MRI scanner a clinician workstation with at least one circuit at least one display and at least one MRI compatible interventional and or surgical tool . An MRI scanner interface may be used to allow communication between the workstation and the scanner . The interface and or circuit may be hardware software or a combination of same. The interface and or circuit may reside partially or totally in the scanner partially or totally in the workstation or partially or totally in a discrete device therebetween. The system can be configured to render or generate real time visualizations of the target anatomical space using MRI image data and predefined data of at least one surgical tool to segment the image data and place the tool in the rendered visualization in the correct orientation and position in 3D space anatomically registered to a patient. The tool can include or cooperate with tracking monitoring and or interventional components. The system can optionally include a reader that can electronically read e.g. optically such as via a bar code or otherwise electronically read such a via an RFID tag a label or tag or other indicia to confirm that the hardware is authentic or compatible to inhibit counterfeit hardware and potential misuse of the system as the system is configured so that certain hardware define a point of interface with the software or circuit . Alternatively or additionally the system can allow a user to manually input the tool hardware indicia. Proper operation of the system requires that the proper hardware having the specific predefined characteristics used by the system is used for the surgical procedure.

The system can be configured to provide workflow for a unilateral or bilateral or even trilateral or more procedure. Selection of the procedure type can initiate the associated work flow presented. illustrates an example of a workstation control panel on display screen . The panel can illustrate a current workflow step and allow a user to go to a step directly such as via a drop down list or selection of a workflow step in a toolbar or the like and can be presented adjacent different views of the intrabody trajectory and patient anatomy. Tabs or other user selectable features with visual feedback on status of a step for each side can be used for steps with laterality e.g. left or right for bilateral procedures to allow a user to control selection of laterality such as left and right to complete trajectory planning for each side independently or to allow a user to toggle back and forth while maintaining control over each side . The display can include viewer tools such as zoom pan width level magnifier etc.

The MRI scanner can include a console that has a launch application or portal for allowing communication to the circuit of the workstation . The scanner console can acquire volumetric T1 weighted post contrast scan data or other image data e.g. high resolution image data for a specific volume of a patient s head or other anatomy. In some embodiments the console can push DICOM images or other suitable image data to the workstation and or circuit . The workstation and or circuit can be configured to passively wait for data to be sent from the MR scanner and the circuit workstation does not query the Scanner or initiate a communication to the Scanner. In other embodiments a dynamic or active communication protocol between the circuit workstation and the Scanner may be used to acquire image data and initiate or request particular scans and or scan volumes. Also in some embodiments pre DICOM but reconstructed image data can be sent to the circuit workstation for processing or display. In other embodiments pre reconstruction image data e.g. substantially raw image data can be sent to the circuit workstation for Fourier Transform and reconstruction.

Generally described for some unilateral scenarios the user will proceed through a set of discrete workflow steps to load MR image data identify a target point identify an entry point verify the planned trajectory and align the targeting canula. A target point or region can also be planned or refined based on real time functional image data of a patient. The functional image data can include but is not limited to images of fiber tracks images of activity in brain regions during vocalization e.g. reading singing talking or based on physical or olefactory or sense based stimulation such as exposure to electrical discomfort shock input heat and or cold light or dark visual images pictures or movies chemicals scents taste and sounds or the like and or using fMRI or other imaging techniques. The enhanced visualization gives neurosurgeons a much clearer picture of the spatial relationship of a patient s brain structures. The visualizations can serve as a trajectory guide for surgical procedures such as brain tumor removal and epilepsy surgery. In some embodiments the visualizations can be generated using data collated from different types of brain imaging methods including conventional magnetic resonance imaging MRI functional MRI fMRI diffusion tensor imaging DTI and even hyperpolarized noble gas MRI imaging. The MRI gives details on the anatomy fMRI or other active stimulation based imaging protocol can provide information on the activated areas of the brain and DTI provides images of the network of nerve fibers connecting different brain areas. The fusion of one or all of these different images and the tool information can be used to produce a 3 D display with trajectory information that surgeons can manipulate.

Thus a target location and trajectory can be planned confirmed or refined based in part on functional information of the patient. This functional information can be provided in real time visualizations of the patient with the trajectory guide tools for trajectory path and target planning e.g. visualize a patient s fiber track structures and or functional information of a patient s brain for a surgeon s ease of reference. This information can also be selected or suppressed from views via a UI selection such as Show Fiber Tracks Fand or Show Functional Output F e.g. toolbar option as shown in . It is noted that the patient functional information can be shown automatically without requiring a user selection or in response to a stage of a procedure or when selecting certain steps. In addition such information may be shown or selected in any appropriate display or step described herein although not specifically described with respect to that particular step or screen display. Knowing where susceptible or sensitive brain regions are or where critical fiber tracks are in the patient s brain can allow a surgeon to plan a better less risky or less intrusive trajectory and or allow a surgeon to more precisely reach a desired target site and or more precisely place a device and or deliver a planned therapy e.g. implant a stimulation lead ablate tissue and or treat a tumor site and or excise a tumor deliver a gene and or stem cell therapy and the like.

To align the targeting canula scan volumes can be defined by the system based on known dimensions of the canula such as a canula length a position of a proximal or distal marker on the canula and angulation and lateral X Y pivot limit. In particular embodiments the user can then gradually advance a probe and a peel away sheath that is configured to guide an interventional device to a desired location along the defined trajectory and acquire images to check for hemorrhage and to verify the trajectory and or avoid functionally sensitive structure. When the probe has been advanced to the target point high resolution confirmation images can be obtained to verify the tip location relative to the planned location. If actual placement is unacceptable the probe can be withdrawn. At that point either the X Y placement can be adjusted appropriately e.g. by moving a platform or stage an amount to cause the desired adjustment or a trajectory angulation can be re planned and a second attempt can be made.

For some bilateral scenarios the above steps can be repeated for both left and right sides with the additional goal that the patient should not be moved into or out of the scanner. To satisfy that goal trajectory planning should be completed for both sides prior to removing the patient from the scanner. Also burring and frame attachment the member that holds the trajectory guide to the patient s head should be completed for both sides prior to moving the patient back into the scanner to promote speed of the procedure.

The system can be configured with a hardware interface that provides a network connection e.g. a standard TCP IP over Ethernet network connection to provide access to MR scanner such as the DICOM server. The workstation can provide a DICOM C STORE storage class provider. The scanner console can be configured to be able to push images to the workstation and the workstation can be configured to directly or indirectly receive DICOM MR image data pushed from an MR Scanner console. Alternatively as noted above the system can be configured with an interface that allows for a dynamic and interactive communication with the Scanner and can obtain image data in other formats and stages e.g. pre DICOM reconstructed or raw image data .

As noted above the systems are configured so that hardware e.g. one or more specific surgical tools constitute a point of interface with the system software or computer programs because the circuit is configured with predefined tool data that recognizes physical characteristics of specific tool hardware.

As shown in to assure proper operation the system can be configured to require entry of a valid identifier and or revision controlled based part number to validate that the hardware planned for use is appropriate for use in the system or at least that version of the system . Thus a reader associated with the workstation can be configured to read a single group identifier that can be placed on the kit package or provided with the kit and or the reader can be configured to read each tool that has predefined characteristics to confirm the appropriate part and version is in the kit. Alternatively or additionally the system can allow a user to manually input the tool hardware identifier data e.g. hardware version and or part number into a UI associated with the circuit . The workstation can include a look up chart of a correlation table that confirms the correct hardware is in the kit or otherwise provided for use. Thus the workstation can be configured with a user interface I shown as a Tool Version Identifier Panel that requires a user to electronically or manually enter the identifier and or to acknowledge compliance with the tool specific operation of the system . It is envisioned that the circuit can be configured with updates and backward compatibility for future controlled changes to the specific tools and or with the ability to use different module versions of the system according to the version of the tool or tools then in use at the surgical site.

To inhibit the use of counterfeit hardware with the system the identifier may include indicia that can be keyed to a particular authorized use site and or authorized user. The system may be configured to require a user to certify that the hardware is OEM hardware or authorized hardware to be able to receive an electronic key to be able to activate the system. A user may be required to contact the OEM or other authorized party to obtain an electronic key or identifier to allow use of the hardware with the system .

As shown in in some embodiments the system is programmatically configured to recognize defined physical characteristics of different tools. Those tools that can be provided as a kit typically a single use disposable hardware or in other groups or sub groups or even individually typically provided in suitable sterile packaging. The tools can include at least one marking grid also referred to as a grid patch a targeting canula with a distal marker and an opposing proximal portion of the canula . The targeting canula can include an open center lumen or passage . The distal maker typically includes a substantially spherical fluid filled component . The proximal portion of the canula can include a marker but is typically identified in the image data based at least in part on the distal maker and its known distance and orientation with respect thereto based on the physical characteristics of the targeting canula . Still referring to the system can also include a trajectory guide with a plurality of MRI visible frame fiducial markers m around a base thereof. The system may also include a stylet that can communicate with a peel away sheath and an imaging probe that provides an intrabody receive antenna that can be slidably introduced via the passage of the targeting canula . Certain components of the kit may be replaced or omitted depending on the desired procedure. Certain components can be provided in duplicate for bilateral procedures. As shown in a therapy delivery device may optionally be provided also with an identifier such as a label or tag . The device can be configured to flowably introduce and or inject a desired therapy e.g. gene therapy or stem cell or other therapy type or obtain a biopsy and the like.

As shown in in some embodiments the depth stop is attached to a peel away sheath see also probe and can be configured to receive and guide an elongated interventional device such as a stylet or imaging probe therethrough. As shown in the sheath can include opposing tabs that when pulled apart cause the sheath to peel away for removal from the targeting canula . In other embodiments the depth stop can be attached to a stimulation lead to allow for a defined insertion depth see e.g. below or other device where insertion depth control is desired.

As shown in the targeting canula can be attached to the trajectory guide . The targeting canula can include a through passage . The distal end of the targeting canula has a fiducial marker shown as a substantially spherical or round cross section marker shape. The proximal end can be configured with a fluid filled channel concentric with the passage that can define a cylindrical fiducial marker. Along the axis of the canula there is the lumen or passage through which another device can be slidably introduced and or withdrawn e.g. a stylet imaging probe therapy delivery or diagnostic device and DBS stimulation leads for implantation can be advanced into the brain.

With reference to the amplitude of the background noise in the input image stack can be estimated. To do so a histogram of the stack can be constructed. The first negative maximum of the slope of the histogram can be located. The first peak to the left of this maximum can be located this can be termed the noise peak . The difference between the noise peak and the first negative maximum of the slope can approximate the standard deviation of the noise. The noise threshold can be obtained using the following Equation 1 . noise threshold noise peak 4 noise standard deviation EQUATION 1 

The above can be considered as a first step in the grid segmentation of the image data. Steps 2 5 can be carried out as described below to place the grid in position and deform to curvature of the skull for the grid segmentation.

Some or all of these operations illustrated in or described with respect to may be carried out behind the scene e.g. not actually displayed . illustrates an exemplary histogram with a noise region. illustrates a cross section of an imaged frame marker. illustrates a result of fitting a circle to the edge mask shown in . The frame marker segmentation can define the orientation of the trajectory guide on the patient that can be correlated to mechanical output to cause the trajectory guide to translate to provide a desired trajectory e.g. rotations and or direction left right counterclockwise or clockwise or other translation for moving the actuators to change pitch and or roll or X Y location .

With reference to the amplitude of the background noise in the input image stack can be estimated. To do so a histogram of the stack can be constructed the first negative maximum of the slope of the histogram can be located the first peak to the left of this maximum can be located this is the noise peak . The difference between the noise peak and the first negative maximum of the slope can approximate the standard deviation of the noise. The noise threshold can be obtained using the Equation 1 above. Again this can be considered a first step in segmentation. Then Steps 2 6 can be carried out with respect to the frame marker segmentation based on fit of an expected fiducial geometry to the observed fiducial positions because the fiducial markers are arranged with a fixed geometric relationship inside the volume.

At this point if the number of clumps found for each frame where bilateral procedures are used there are two frames is not exactly 3 then the segmentation is deemed to have failed.

In some embodiments circuit can be configured so that the program application can have distinct ordered workflow steps that are organized into logical groups based on major divisions in the clinical workflow as shown in Table 1. A user may return to previous workflow steps if desired. Subsequent workflow steps may be non interactive if requisite steps have not been completed. The major workflow groups and steps can include the following features or steps in the general workflow steps of start plan entry plan target navigate and refine ultimately leading to delivering the therapy here placing the stimulation lead .

TABLES 2A 2P provide additional examples of some exemplary operations that may be associated with exemplary workflow steps according to some embodiments of the present invention.

The AC PC and MSP locations can be identified in any suitable manner. In some embodiments the AC PC step can have an automatic electronic AC PC MSP Identification Library. The AC PC and MSP anatomical landmarks define an AC PC coordinate system e.g. a Talairach Tournoux coordination system that can be useful for surgical planning. This library can be used to automatically identify the location of the landmarks. It can be provided as a dynamic linked library that a host application can interface through a set of Application Programming Interface API on Microsoft Windows . This library can receive a stack of MR brain images and fully automatically locates the AC PC and MSP. The success rate and accuracy can be optimized and typically it takes a few seconds for the processing. The output is returned as 3D coordinates for AC and PC and a third point that defines the MSP. This library is purely computation and is typically UI less. This library can fit a known brain atlas to the MR brain dataset. The utility can be available in form of a dynamic linked library that a host application can interface through a set of Application Programming Interface API on Microsoft Windows . The input to this library can contain the MR brain dataset and can communicate with applications or other servers that include a brain atlas or include a brain atlas e.g. have an integrated brain atlas . The design can be independent of any particular atlas but one suitable atlas is the Cerefy atlas of brain anatomy note typically not included in the library . The library can be configured to perform segmentation of the brain and identify certain landmarks. The atlas can then be fitted in 3D to the dataset based on piecewise affine transformation. The output can be a list of vertices of the interested structures.

In some embodiments the mid sagittal plane MSP is approximated using several extracted axial slices from the lower part of the input volume e.g. about 15 equally spaced slices. A brightness equalization can be applied to each slice and an edge mask from each slice can be created using a Canny algorithm. A symmetry axis can be found for each edge mask and identify the actual symmetry axis based on an iterative review and ranking or scoring of tentative symmetry axes. The ranking scoring cam be based on whether a point on the Canny mask reflected through the symmetry axis lands on the Canny mask if so this axes is scored for that slice . An active appearance model AAM can be applied to a brain stem in a reformatted input stack with the defined MSP to identify the AC and PC points.

The MSP plane estimate can be refined as well as the AC and PC points. The MSP plane estimate can be refined using a cropped image with a small region that surrounds a portion of the brain ventricle and an edge mask using a Canny algorithm. The symmetry axis on this edge mask if found following the procedure described above. The AC and PC points are estimated as noted above using the refined MSP and brightness peaks in a small region e.g. 6 6 mm around the estimate are searched. The largest peak is the AC point. The PC point can be refined using the PC estimate above and the refined MSP. A Canny edge map of the MSP image can be computed. Again a small region e.g. about 6 mm 6 mm can be searched for a point that lies on a Canny edge and for which the image gradient is most nearly parallel to the AC PC direction. The point is moved about 1 mm along the AC PC direction towards PC. The largest intensity peak in the direction perpendicular to AC PC is taken to be the PC point.

At this point holes have been burred at the entry points and the trajectory guides have been attached. NOTE Because the patient has been moved points defined in the previous image coordinate system may no longer be valid. Also brain shift may occur at this point.

In the event that the placement is not acceptable the user may opt to proceed to the X Y Adjustment workflow step.

When displaying images or visualizations that were created with the imaging probe where used the circuit may electronically apply a sigma correction to correct for a volcano or halo shaped intensity distortion. That is in some particular embodiments the imaging probe antenna or coil may introduce a distortion in the images that are created with it that may be described as a bright halo around the probe itself where it appears in the image. Thus when images from the imaging probe have such a feature the circuit can be configured to electronically automatically apply a correction to cancel out the halo or at least reduce it . This feature will only affect the small field high resolution images that are created via the imaging probe itself. Images obtained using the main head coil do not typically have such a distortion.

Referring to the circuit can be configured with a single control tool bar that is displayed on the display that allows the user to select what group and step to go to and also shows which groups and steps have been completed. shows an example of the workflow control tool bar with the Plan Entry group selected and the Define Target enlarged as the current step. The tool bar can include a color border that can be used to partially or totally surround a button to illustrate completion of a step. For bilateral procedures the border can be color enhanced on one side when a task for that side is completed e.g. on the left side when the left target is complete in the Define Target step.

As the user works through the procedure certain clinical information is stored to be incorporated into a procedure report that may be reviewed at the end of the procedure and or archived as a patient record. The circuit can be configured to provide a user interface UI I that provides viewing tools such as one or more of the following features.

Bore size is used in the step Plan Entry Trajectory. If the user selects a trajectory such that the probe cannot be inserted into the canula because it will not physically fit inside the scanner bore a warning is generated visual on the display and or audible . See Plan Entry Trajectory step above.

The top two views of show the coronal and sagittal views aligned along the current trajectory line. The user drags the trajectory line and it rotates freely about the target point. The bottom left view shows the plane perpendicular to the trajectory at the level of the green line in the coronal and sagittal views. This is the probe s eye view. To advance the probe s eye view along the trajectory in addition to dragging the green line along the trajectory line or using the mousewheel onscreen VCR style controls can provide an animated fly through.

After the X Y adjustments are made the Insert Probe of the Refine Placement workflow group is selected and carried out in the same manner as the Navigate Insert Probe step described above.

The circuit may also be configured to determine where individual electrodes on the DBS leads are situated in ACPC coordinates. Given the tip position in MR coordinates the circuit can ill in the planned position but the user may change it the user will provide a set of offset values that represent the distance of each electrode from the lead tip. In other embodiments a lead type can be selected such as from a pull down list and those values can automatically be input based on the manufacturer and lead type e.g. design thereof . The circuit can be configured so that the UI displays the corresponding electrode positions in ACPC coordinates.

The system may also include a decoupling tuning circuit that allows the system to cooperate with an MRI scanner and filters and the like. See e.g. U.S. Pat. Nos. 6 701 176 6 904 307 and U.S. Patent Application Publication No. 2003 0050557 the contents of which are hereby incorporated by reference as if recited in full herein. As noted above one or more of the tools can include an intrabody MRI antenna that is configured to pick up MRI signals in local tissue during an MRI procedure. The MRI antenna can be configured to reside on the distal portion of the probe. In some embodiments the antenna has a focal length or signal receiving length of between about 1 5 cm and typically is configured to have a viewing length to receive MRI signals from local tissue of between about 1 2.5 cm. The MRI antenna can be formed as comprising a coaxial and or triaxial antenna. However other antenna configurations can be used such as for example a whip antenna a coil antenna a loopless antenna and or a looped antenna. See e.g. U.S. Pat. Nos. 5 699 801 5 928 145 6 263 229 6 606 513 6 628 980 6 284 971 6 675 033 and 6 701 176 the contents of which are hereby incorporated by reference as if recited in full herein. See also U.S. Patent Application Publication Nos. 2003 0050557 2004 0046557 and 2003 0028095 the contents of which are also hereby incorporated by reference as if recited in full herein.

In some embodiments the implanted leads and or intrabody tools can be configured to allow for safe MRI operation so as to reduce the likelihood of undesired deposition of current or voltage in tissue. The leads or tools can include RF chokes such as a series of axially spaced apart Balun circuits or other suitable circuit configurations. See e.g. U.S. Pat. No. 6 284 971 the contents of which are hereby incorporated by reference as if recited in full herein for additional description of RF inhibiting coaxial cable that can inhibit RF induced current. The conductors connecting electrodes or other components on or in the tools can also include a series of back and forth segments e.g. the lead can turn on itself in a lengthwise direction a number of times along its length and or include high impedance circuits. See e.g. U.S. patent application Ser. Nos. 11 417 594 12 047 602 and 12 090 583 the contents of which are hereby incorporated by reference as if recited in full herein.

Although not shown in some embodiments one or more of the surgical tools can be configured with one or more lumens and exit ports that deliver desired cellular biological and or drug therapeutics to the target area such as the brain. The tools may also incorporate transseptal needles biopsy and or injection needles as well as ablation means. The lumens where used may receive extendable needles that may exit the probe from the distal end or from the sides proximal distal or even through the electrodes to precisely deliver cellular biological therapeutics to the desired anatomy target. This delivery configuration may be a potential way to treat patients where the cellular biological therapeutics can be delivered into the desired anatomy to modify their cellular function. The cells e.g. stem cells may improve function. MRI can typically be effectively used to monitor the efficacy and or delivery of the therapy.

The system can include circuits and modules that can comprise computer program code used to automatically or semi automatically carry out operations to generate visualizations and provide output to a user to facilitate MRI guided diagnostic and therapy procedures. is a schematic illustration of a circuit or data processing system that can be used with the system . The circuits and or data processing systems may be incorporated in one or more digital signal processors in any suitable device or devices. As shown in the processor communicates with an MRI scanner and with memory via an address data bus . The processor can be any commercially available or custom microprocessor. The memory is representative of the overall hierarchy of memory devices containing the software and data used to implement the functionality of the data processing system. The memory can include but is not limited to the following types of devices cache ROM PROM EPROM EEPROM flash memory SRAM and DRAM.

As shown in illustrates that the memory may include several categories of software and data used in the data processing system the operating system the application programs the input output I O device drivers and data . The data can also include predefined characteristics of different surgical tools and patient image data . also illustrates the application programs can include a Visualization Module Interventional Tool Data Module a Tool Segmentation Module such as segmentation modules for a grid patch a targeting canula and a trajectory guide frame and or base and a workflow group User Interface Module that facilitates user actions and provides guidance to obtain a desired trajectory such as physical adjustments to achieve same .

As will be appreciated by those of skill in the art the operating systems may be any operating system suitable for use with a data processing system such as OS 2 AIX DOS OS 390 or System390 from International Business Machines Corporation Armonk N.Y. Windows CE Windows NT Windows95 Windows98 Windows2000 or other Windows versions from Microsoft Corporation Redmond Wash. Unix or Linux or FreeBSD Palm OS from Palm Inc. Mac OS from Apple Computer LabView or proprietary operating systems. The I O device drivers typically include software routines accessed through the operating system by the application programs to communicate with devices such as I O data port s data storage and certain memory components. The application programs are illustrative of the programs that implement the various features of the data processing system and can include at least one application which supports operations according to embodiments of the present invention. Finally the data represents the static and dynamic data used by the application programs the operating system the I O device drivers and other software programs that may reside in the memory .

While the present invention is illustrated for example with reference to the Modules being application programs in as will be appreciated by those of skill in the art other configurations may also be utilized while still benefiting from the teachings of the present invention. For example the Modules and or may also be incorporated into the operating system the I O device drivers or other such logical division of the data processing system. Thus the present invention should not be construed as limited to the configuration of which is intended to encompass any configuration capable of carrying out the operations described herein. Further one or more of modules i.e. Modules can communicate with or be incorporated totally or partially in other components such as a workstation an MRI scanner an interface device. Typically the workstation will include the modules and the MR scanner with include a module that communicates with the workstation and can push image data thereto.

The I O data port can be used to transfer information between the data processing system the circuit or workstation the MRI scanner and another computer system or a network e.g. the Internet or to other devices controlled by or in communication with the processor. These components may be conventional components such as those used in many conventional data processing systems which may be configured in accordance with the present invention to operate as described herein.

In the drawings and specification there have been disclosed embodiments of the invention and although specific terms are employed they are used in a generic and descriptive sense only and not for purposes of limitation the scope of the invention being set forth in the following claims. Thus the foregoing is illustrative of the present invention and is not to be construed as limiting thereof. More particularly the workflow steps may be carried out in a different manner in a different order and or with other workflow steps or may omit some or replace some workflow steps with other steps. Although a few exemplary embodiments of this invention have been described those skilled in the art will readily appreciate that many modifications are possible in the exemplary embodiments without materially departing from the novel teachings and advantages of this invention. Accordingly all such modifications are intended to be included within the scope of this invention as defined in the claims. In the claims means plus function clauses where used are intended to cover the structures described herein as performing the recited function and not only structural equivalents but also equivalent structures. Therefore it is to be understood that the foregoing is illustrative of the present invention and is not to be construed as limited to the specific embodiments disclosed and that modifications to the disclosed embodiments as well as other embodiments are intended to be included within the scope of the appended claims. The invention is defined by the following claims with equivalents of the claims to be included therein.

