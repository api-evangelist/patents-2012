---

title: Method and device for managing a secure element
abstract: A method and system for managing, from a communication device, a secure element for contactless transactions such as mobile payment applications. The communication device includes a memory for storing one or more device applications. The method includes determining that an application stored on the secure element does not have an association with any of the device applications, and in response to the determining, sending a communication to a server to delete the application from the secure element.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08984648&OS=08984648&RS=08984648
owner: BlackBerry Limited
number: 08984648
owner_city: Waterloo
owner_country: CA
publication_date: 20120829
---
This application claims the benefit of U.S. Application No. 61 576 162 filed Dec. 15 2011 the contents of which are herein incorporated by reference.

Example embodiments relate to the field of contactless transaction systems such as for mobile payments.

Some mobile payment systems include a device having a secure element which can be used for secure transactions for example to purchase an item using the device rather than a credit card. The secure element may have a limited amount of space for applications to be installed.

In some existing conventional systems a user may delete or de activate a user application or device application involved in the mobile payment system. However the user may be unaware that secure information may remain in the secure element.

Additional difficulties with existing systems may be appreciated in view of the detailed description below.

Example embodiments generally relate to contactless transaction systems such as for mobile payments. Example embodiments generally relate to the managing of a secure element from a communication device which includes the removal of any orphaned applets from the secure element which are not associated with any of the device applications.

In accordance with an example embodiment there is provided a method for managing from a communication device a secure element the communication device having a memory for storing one or more device applications. The method includes determining that an application stored on the secure element does not have an association with any of the device applications and in response to said determining sending a communication to a server to delete the application from the secure element.

In accordance with another example embodiment there is provided a communication device including a processor memory for storing one or more device applications a secure element a communication subsystem for sending and receiving communications with a server. The processor is configured for determining that an application stored on the secure element does not have an association with any of the device applications and in response to said determining sending a communication to the server to delete the application from the secure element.

In accordance with another example embodiment there is provided a non transitory computer readable medium having stored thereon instructions executable by a processor for managing a secure element the medium storing one or more device applications. The instructions include instructions for determining that an application stored on the secure element does not have an association with any of the device applications and in response to said determining sending a communication to a server to delete the application from the secure element.

Reference is first made to which shows in block diagram form a communication system in which example embodiments can be applied. The communication system comprises a number of mobile communication devices mobile devices which may be connected to the remainder of system in any of several different ways. Accordingly several instances of mobile communication devices are depicted in employing different example ways of connecting to system . Mobile communication devices are connected to a wireless communication network which may comprise one or more of a Wireless Wide Area Network WWAN and a Wireless Local Area Network WLAN or other suitable network arrangements. In some embodiments the mobile communication devices are configured to communicate over both the WWAN and WLAN and to roam between these networks. In some embodiments the wireless network may comprise multiple WWANs and WLANs .

The WWAN may be implemented as any suitable wireless access network technology. By way of example but not limitation the WWAN may be implemented as a wireless network that includes a number of transceiver base stations one of which is shown in where each of the base stations provides wireless Radio Frequency RF coverage to a corresponding area or cell. The WWAN is typically operated by a mobile network service provider that provides subscription packages to users of the mobile communication devices . In some embodiments the WWAN conforms to one or more of the following wireless network types Mobitex Radio Network DataTAC GSM Global System for Mobile Communication GPRS General Packet Radio System TDMA Time Division Multiple Access CDMA Code Division Multiple Access CDPD Cellular Digital Packet Data iDEN integrated Digital Enhanced Network EvDO Evolution Data Optimized CDMA2000 EDGE Enhanced Data rates for GSM Evolution UMTS Universal Mobile Telecommunication Systems HSDPA HSUPA High Speed Downlink Packet Access High Speed Uplink Packet Access Long Term Evolution LTE by 3rd Generation Partnership Project 3GPP IEEE 802.16e also referred to as Worldwide Interoperability for Microwave Access or WiMAX or various other networks. Although WWAN is described as a Wide Area network that term is intended herein also to incorporate wireless Metropolitan Area Networks WMAN and other similar technologies for providing coordinated service wirelessly over an area larger than that covered by typical WLANs.

The WWAN may further comprise a wireless network gateway which connects the mobile communication devices to transport facilities and through the transport facilities to a wireless connector system . Transport facilities may include one or more private networks or lines the public internet a virtual private network or any other suitable network. The wireless connector system may be operated for example by an organization or enterprise such as a corporation university or governmental department which allows access to a network such as an internal or enterprise network and its resources or the wireless connector system may be operated by a mobile network provider or mobile network operator MNO . In some embodiments the network may be realised using the internet rather than an internal or enterprise network.

The wireless network gateway provides an interface between the wireless connector system and the WWAN which facilitates communication between the mobile communication devices and other devices not shown connected directly or indirectly to the WWAN . Accordingly communications sent via the mobile communication devices are transported via the WWAN and the wireless network gateway through transport facilities to the wireless connector system . Communications sent from the wireless connector system are received by the wireless network gateway and transported via the WWAN to the mobile communication devices .

The WLAN comprises a wireless network which in some embodiments conforms to IEEE 802.11x standards sometimes referred to as Wi Fi such as for example the IEEE 802.11a 802.11b and or 802.11g standard. Other communication protocols may be used for the WLAN in other embodiments such as for example IEEE 802.11n IEEE 802.16e also referred to as Worldwide Interoperability for Microwave Access or WiMAX or IEEE 802.20 also referred to as Mobile Wireless Broadband Access . The WLAN includes one or more wireless RF Access Points AP one of which is shown in that collectively provide a WLAN coverage area.

The WLAN may be a personal network of the user an enterprise network or a hotspot offered by an internet service provider ISP a mobile network provider or a property owner in a public or semi public area for example. The access points are connected to an access point AP interface which may connect to the wireless connector system directly for example if the access point is part of an enterprise WLAN in which the wireless connector system resides or indirectly via the transport facilities if the access point is a personal Wi Fi network or Wi Fi hotspot in which case a mechanism for securely connecting to the wireless connector system such as a virtual private network VPN may be required . The AP interface provides translation and routing services between the access points and the wireless connector system to facilitate communication directly or indirectly with the wireless connector system .

The wireless connector system may be implemented as one or more servers and is typically located behind a firewall . The wireless connector system manages communications including email messages to and from a set of managed mobile communication devices . The wireless connector system also provides administrative control and management capabilities over users and mobile communication devices which may connect to the wireless connector system .

The wireless connector system allows the mobile communication devices to access the network and connected resources and services such as a messaging server for example a Microsoft Exchange IBM Lotus Domino or Novell GroupWise email messaging server and optionally other servers . The other servers may comprise a content server for providing content such as internet content or content from an organization s internal servers to the mobile communication devices in the wireless network an application server for implementing server based applications such as instant messaging IM applications or a web server for providing content accessible by a web browser.

The wireless connector system typically provides a secure exchange of data e.g. email messages personal information manager PIM data and IM data with the mobile communication devices . In some embodiments communications between the wireless connector system and the mobile communication devices are encrypted. In some embodiments communications are encrypted using a symmetric encryption key implemented using Advanced Encryption Standard AES or Triple Data Encryption Standard Triple DES encryption. Private encryption keys are generated in a secure two way authenticated environment and are used for both encryption and decryption of data.

Encryption keys used for communications or for encrypting data stored on the device can be protected via various means such as a password or hardware based protections such as those afforded by hardware based key stored mechanisms.

The wireless network gateway is adapted to send data packets received from the mobile device over the WWAN to the wireless connector system . The wireless connector system then sends the data packets to the appropriate connection point such as the messaging server or other servers . Conversely the wireless connector system sends data packets received for example from the messaging server or other servers to the wireless network gateway which then transmit the data packets to the destination mobile device . The AP interfaces of the WLAN provide similar sending functions between the mobile device the wireless connector system and network connection point such as the messaging server or other servers .

The network may comprise a private local area network metropolitan area network wide area network the public internet or combinations thereof and may include virtual networks constructed using any of these alone or in combination.

A mobile device may alternatively connect to the wireless connector system using a computer such as desktop or notebook computer via the network . A link may be provided for exchanging information between the mobile device and computer connected to the wireless connector system . The link may comprise one or both of a physical interface and short range wireless communication interface. The physical interface may comprise one or combinations of an Ethernet connection Universal Serial Bus USB connection Firewire also known as an IEEE 1394 interface connection or other serial data connection via respective ports or interfaces of the mobile device and computer . The short range wireless communication interface may be a personal area network PAN interface. A personal area network is a wireless point to point connection meaning no physical cables are required to connect the two end points. The short range wireless communication interface may comprise one or a combination of an infrared IR connection such as an Infrared Data Association IrDA connection a short range radio frequency RF connection such as one specified by IEEE 802.15.1 or the Bluetooth special interest group IEEE 802.15.3a also referred to as UltraWideband UWB a direct mode communication Near Field Communication NFC or other PAN connection.

It will be appreciated that the described communication system is provided for the purpose of illustration only and that the above described communication system comprises one possible communication network configuration of a multitude of possible configurations for use with the mobile communication devices . Example embodiments may be employed in connection with any other type of network and associated devices that are effective in implementing or facilitating wireless communication. Suitable variations of the communication system will be understood to a person of skill in the art and are intended to fall within the scope of the present example embodiments.

Reference is now made to which illustrates a mobile communication device in which example embodiments can be applied. The mobile device is a two way communication device having data and optionally voice communication capabilities and the capability to communicate with other computer systems for example via the Internet. Depending on the functionality provided by the mobile device in various embodiments the device may be a multiple mode communication device configured for both data and voice communication a smartphone a mobile telephone or a PDA personal digital assistant enabled for wireless communication or a computer system with a wireless modem.

The mobile device includes a case not shown housing the components of the device . The internal components of the device are constructed on a printed circuit board PCB . The mobile device includes a controller comprising at least one processor such as a microprocessor which controls the overall operation of the device . The processor interacts with device subsystems such as a wireless communication subsystem for exchanging radio frequency signals with the wireless network to perform communication functions. The processor interacts with additional device subsystems including a display screen such as a liquid crystal display LCD screen input devices such as a keyboard and control buttons flash memory random access memory RAM read only memory ROM auxiliary input output I O subsystems data port such as serial data port such as a Universal Serial Bus USB data port speaker microphone short range communication subsystem and other device subsystems generally designated as . Some of the subsystems shown in perform communication related functions whereas other subsystems may provide resident or on device functions.

The device may comprise a touchscreen display in some embodiments. The touchscreen display may be constructed using a touch sensitive input surface connected to an electronic controller and which overlays the display screen . The touch sensitive overlay and the electronic controller provide a touch sensitive input device and the processor interacts with the touch sensitive overlay via the electronic controller.

The mobile device may communicate with any one of a plurality of fixed transceiver base stations of the wireless network within its geographic coverage area. The mobile device may send and receive communication signals over the wireless network after the required network registration or activation procedures have been completed.

In some embodiments the mobile device includes a removable memory card or memory typically comprising flash memory and a memory card interface . The mobile device may include a secure element stored on the removable memory card in some example embodiments. In other example embodiments the secure element is stored or embedded in the mobile device . A contactless element illustrated as Near Field Communication NFC module may communicate with the secure element and may act as a communication proxy for any desired communications or configurations made to the secure element .

In some example embodiments the secure element includes one or more secure element applications which may implement secure services or functions which may also be referred to as applets . An applet may be identified by an applet identifier AID . A card manager of the secure element may be designated to manage functions on an Issuer Security Domains ISD to provide card management functions on the secure element . Example card management functions may relate to the applets such as addition modification or deletion of an applet .

The processor operates under stored program control and executes software modules stored on memory such as persistent memory for example in the flash memory . As illustrated in the software modules comprise operating system software and software applications which for example may include an application manager and one or more device applications . The application manager may include an application program interface API for specifically communicating with the NFC module and typically indirectly e.g. via a proxy with the applets .

In some example embodiments the communication device may implement Java for interfacing with the secure element for example using JSR to access secure elements and JSR to access the NFC module . In some example embodiments the communication device may not support Java and a similar or equivalent implementation of APIs may be used to access the secure element and NFC module .

Other example software applications include a short messaging application e.g. instant messaging SMS Short Message Service MMS Multimedia Messaging Service etc. a web browser and an email messaging application. In some example embodiments the functions performed by each of the applications may each be realized as a plurality of independent elements and any one or more of these elements may be implemented as parts of other software applications .

In some examples the software applications may be implemented using a number of services which define the communication protocols used to communicate between a server and an application on the communication device . Some applications may only connect to a single type of server using the same communication protocol settings and will therefore only operate using a single service while other applications may connect to a variety of servers using different communication protocols and will require multiple services.

The software modules or parts thereof may be temporarily loaded into volatile memory such as the RAM . The RAM is used for storing runtime data variables and other types of data or information. Although specific functions are described for various types of memory this is merely one example and a different assignment of functions to types of memory could also be used.

In some embodiments the auxiliary input output I O subsystems may comprise an external communication link or interface for example an Ethernet connection. The mobile device may comprise other wireless communication interfaces for communicating with other types of wireless networks for example a wireless network such as an orthogonal frequency division multiplexed OFDM network or a GPS Global Positioning System subsystem comprising a GPS transceiver for communicating with a GPS satellite network not shown . The auxiliary I O subsystems may comprise a pointing or navigational tool input device such as a clickable trackball or scroll wheel or thumbwheel or a vibrator for providing vibratory notifications in response to various events on the device such as receipt of an electronic message or incoming phone call or for other purposes such as haptic feedback touch feedback .

In some embodiments the mobile device is provided with a service routing application programming interface API which provides an application with the ability to route traffic through a serial data i.e. USB or Bluetooth Bluetooth is a registered trademark of Bluetooth SIG Inc. connection to the host computer system using standard connectivity protocols. When a user connects their mobile device to the host computer system via a USB cableor Bluetooth connection traffic that was destined for the wireless network is automatically routed to the mobile device using the USB cableor Bluetooth connection. Similarly any traffic destined for the wireless network is automatically sent over the USB cableor Bluetooth connection to the host computer system for processing.

The mobile device also includes a battery as a power source which is typically one or more rechargeable batteries that may be charged for example through charging circuitry coupled to a battery interface such as the serial data port . The battery provides electrical power to at least some of the electrical circuitry in the mobile device and the battery interface provides a mechanical and electrical connection for the battery . The battery interface is coupled to a regulator not shown which provides power V to the circuitry of the mobile device .

The short range communication subsystem is an additional component which provides for communication between the mobile device and different systems or devices which need not necessarily be similar devices. In some example embodiments the mobile device may implement near field communications NFC using the NFC module . In some example embodiments the subsystem may include an infrared device and associated circuits and components or a wireless bus protocol compliant communication mechanism such as a Bluetooth communication module to provide for communication with corresponding or similarly enabled systems and devices.

A predetermined set of applications that control basic device operations including data and possibly voice communication applications will normally be installed on the mobile device during or after manufacture. Additional applications and or upgrades to the operating system or software applications may also be loaded onto the mobile device through the wireless network the auxiliary I O subsystem the serial port the short range communication subsystem or other suitable subsystem . The downloaded programs or code modules may be permanently installed for example written into the program memory i.e. the flash memory or written into and executed from the RAM for execution by the processor at runtime. Such flexibility in application installation increases the functionality of the mobile device and may provide enhanced on device functions communication related functions or both. For example secure communication applications may enable electronic commerce functions and other such financial transactions to be performed using the mobile device .

The mobile device may provide two principal modes of communication a data communication mode and an optional voice communication mode. In the data communication mode a received data signal such as a short message e.g. short message service SMS Multimedia Messaging Service MMS an email message or Web page download will be processed by the communication subsystem and input to the processor for further processing. For example a downloaded Web page may be further processed by a browser application or an email message may be processed by the email messaging application and output to the display . A user of the mobile device may also compose data items such as email messages for example using the input devices in conjunction with the display screen . These composed items may be transmitted through the communication subsystem over the wireless network .

In the voice communication mode the mobile device provides telephony functions and operates as a typical cellular phone. The overall operation is similar except that the received signals would be output to the speaker and signals for transmission would be generated by a transducer such as the microphone . The telephony functions are provided by a combination of software firmware i.e. the voice communication module and hardware i.e. the microphone the speaker and input devices . Alternative voice or audio I O subsystems such as a voice message recording subsystem may also be implemented on the mobile device . Although voice or audio signal output is typically accomplished primarily through the speaker the display screen may also be used to provide an indication of the identity of a calling party duration of a voice call or other voice call related information.

Reference is now made to which illustrates a mobile payment system in accordance with an example embodiment. In some example embodiments the mobile payment system may generally use the secure element to securely enable payments facilitated by the NFC module of the communication device . The mobile payment system may generally be used to provide services which may include at least a provisioning security service and a mobile transaction security service .

Still referring to the provisioning security service is generally used to provide security information such as user information or credit card account information to the secure element of the communication device . For example the provisioning security service may include a service provider server a trusted service manager TSM server a mobile network operator MNO and the communication device .

Example embodiments of the provisioning security service may include secure communication protocols such as using public key infrastructure PKI and encryption based on Secure Sockets Layer SSL Transport Layer Security TLS . In some example embodiments the secure communication protocols may include virtual private network VPN . Generally in order to securely deliver financial data or account information to the communication device the data from the service provider server is passed securely through the TSM server to the secure element .

Referring again to the service provider server may sometimes be operated by an issuer . The service provider server may in some example embodiments be provided by an issuing financial institution.

The TSM server may be used as a trusted source to perform key management and security. The key management process maintains security of the keys. The TSM server may include both physical security and logical security. For example physical security may prevent physical access to a key management server KMS and related hardware security module HSM . Physical security may include the use of man traps physical barriers and alarm systems. Logical security may include processes procedures and software used to safeguard the keys. Examples of logical security include password requirements key import requirements and procedures firewall rules and the use of proxy systems for communications.

In some example embodiments of the provisioning security service the TSM server stores user account information in an encrypted database. When the communication device requires set up or provisioning of the account information the following three separate layers of encryption may be established with a packet data connection 

1 The mobile device establishes an over the air OTA packet connection across the MNO s radio access network RAN . This OTA communication is encrypted at OSI layer based on protocols established by both the CDMA and GSM standards as understood in the art. Security at this point is controlled by the MNO because the MNO manages the keys used to encrypt the data traffic. Data encryption on the MNO network facilitates privacy and confidentiality for data traffic between the MNO and the communication device . The OTA encryption layer adds another barrier to the potential for custody breach of account data due to radio sniffing.

2 Once the packet connection is established the application manager of the communication device establishes a TLS secure communication session to the TSM server at OSI layer using credentials issued by a trusted certificate authority CA .

3 When this connection is established the TSM server initiates another secure connection to the NFC module to access the secure element using a secure channel protocol which can be implemented at OSI layer . This layer of encryption is secured by keys that belong to the service provider server e.g. issuer or a financial institution .

In some example embodiments the application layer security leverages multiple protection levels. After the last connection is established at least one logical layer of encryption secured by the issuing server s keys protects the data between the TSM server s and the secure element . In some example embodiments at least two layers of encryption protect the data across the secured communication channels. While data is traveling over the air it may always be secured by these three layers of encryption.

Still referring to the mobile transaction security service is generally used to process a payment transaction using the account information from the secure element . For example the mobile transaction security service may include the communication device a contactless reader such as a point of sale POS terminal an acquiring server and the service provider server .

While the POS terminal and the secure element are in communication the NFC module may implement a card emulation mode. For example the POS terminal communicates with the NFC module to identify which card is being emulated. The POS terminal may then send commands appropriate for a card type e.g. Visa payWave MasterCard PayPass American Express Discover Zip or other card to start communication with a specific applet . The payment transaction may then be performed much like a contactless credit or debit card transaction. The communication device is presented to the POS terminal at the point at which a contactless payment card would be presented. The POS terminal may initiate the transaction rather than the communication device and the POS terminal may not attempt to read the communication device until the transaction is initiated. When transaction communication between the communication device and the POS terminal is being processed or is completed the terminal may output a suitable message on a display. Similarly a device application of the communication device may output a suitable message on the display .

Referring still to the POS terminal may communicate using a contactless security protocol for example using ISO 7816 and ISO 14443 as understood in the art. The data structure for the communication may include an application protocol data unit APDU as defined by ISO 7816 4 as understood in the art. The POS terminal may communicate to implement Europay MasterCard and VISA EMV as understood in the art.

Referring again to an example of a device application is an application which facilitates a user making a payment transaction and may require the user to enter a passcode or present a fingerprint to an input device of the communication device to initiate or respond to the terminal s transaction initiation or to validate the transaction from the perspective of the NFC module . If the communication device has multiple device applications each may have different user requirements for conducting a transaction.

For example a communication device may include the following configuration options always allow access to the applet e.g. card is always available allow access to the applet only after user confirmation and only allow access to the applet upon input of the correct passcode or fingerprint.

In some example embodiments more than one applet is installed in the secure element and a mobile wallet application may be used to manage the multiple applets . The wallet application enables the user to select a preferred payment or issuer brand for each transaction analogous to a consumer opening a wallet or purse and selecting the card to use for a transaction.

The mobile wallet application may also enable the user to designate one brand as a default payment brand. For example if a user primarily uses a specific credit or debit card that application can be set as the default payment brand. To use a different payment account in a retail outlet the user may select a different payment brand.

In some example embodiments a MIDlet may be used when the communication device is configured for Java based implementations. For example the communication device may be configured to automatically open a MIDlet that displays a particular logo when a certain application or applet is selected. For example when a bank payment application is used the logo of that bank may then be displayed on the communication device during or immediately after the transaction.

In an example implementation the POS terminal initiates communication with the NFC module of the communication device . The POS terminal may be configured to not constantly scan a scanning area for the communication device rather the POS terminal may only attempt to locate the communication device when the POS terminal prompts the user to present the communication device . Once the communication device is located communication between the POS terminal and the communication device may take place. In some example embodiments the scanning area may be e.g. a two to four square inch range.

When a transaction is completed a final command or communication may be sent to the communication device by the POS terminal . In some example embodiments the POS terminal does not consider the communication to be complete until the communication device is moved out of the scanning area. For example another transaction cannot take place until the communication device that executed the previous transaction is moved completely away from the scanning area and the cashier or vendor initiates a new transaction.

Proximity mobile payments may use the standard ISO IEC 14443 as understood in the art which governs communication between a contactless credit or debit payment device and a terminal. Payment transactions invoke additional layers of security during transaction processing. For example the first layer of security is provided by the secure element itself which protects the payment applet by storing it in restricted access memory. The payment applet generates a dynamic cryptogram that is integrated into the transaction messaging communication process with the POS terminal . The POS terminal communicates with the acquirer server to verify the transaction. The acquirer server verifies with the service provider server that the card number and transaction amount are both valid and then the POS terminal processes the transaction with the communication device .

Referring still to in some example embodiments the secure element of the communication device may only be configured or managed by instructions received from the TSM server either directly or indirectly e.g. via the NFC module . For example referring again to the addition modification or removal of an applet may only be controlled by the TSM server in some example embodiments. Communications or instructions from the TSM server may be authenticated using at least the PKI. Accordingly in some example embodiments the secure element may not be directly configurable by the application manager or any of the device applications . For example the application manager or the device applications may not have access to the appropriate keys.

Referring still to generally some example embodiments of the mobile device may utilize the NFC module and the secure element to facilitate secure applications or services such as mobile payment. In some example embodiments secure data may also be stored on the secure element . In some example embodiments associated secure data may be encapsulated within an applet . In some example embodiments deletion of an applet results in associated data encapsulated within that applet to also be deleted.

Referring still to in some example embodiments secure element may be protected by way of software based encryption and or hardware based security protection. This may include the use of the secure element within Universal subscriber identity module USIM or SIM cards using smart chips embedded secure elements or Secure Digital SD cards.

In some example embodiments the smart chips include multi layer security architecture. Security features may be manufactured into the secure microcontrollers used in smart card chips which may prevent attackers from accessing sensitive information stored on the card. The smart card chips may include built in tamper resistance. The smart card chips may include a variety of hardware and software capabilities that detect and react to tampering attempts and help counter possible attacks. For example the smart card chips may be manufactured with features such as extra metal layers sensors to detect thermal and UV light attacks and additional software and hardware circuitry to prevent differential power analysis. In some example embodiments similar security features may be used for embedded secure elements .

Referring again to the secure element may include a security domain architecture to enable the service provider server to perform key management and applet verification during load and installation processes. The secure element may include an issuer security domain ISD which generally allows an applet to be loaded into the secure element . The ISDs may be managed by the card manager . In some example embodiments the secure element may also include one or more supplemental security domains SSDs .

The ISD is the portion of the secure element in which the MNO may store the keys for OTA provisioning card content management and security domain management. The ISD has privileges for global management authorized management and security domain management for the secure element . In some example embodiments the ISD may be created at the manufacturing level by a device manufacturer not shown and the key for card content management is securely transferred from the manufacturer to the MNO . The ISD may authorize the creation of any SSDs. In some example embodiments only the ISD has the privileges to create an SSD and assign authorized or delegated management privileges.

The SSDs can be security domains assigned to the TSM server or to the service provider servers such as credit card ticket prepaid loyalty card or transit card issuers . In addition the secure element may have a controlling authority security domain CASD . Each SSD may have its own card manager key for loading applications. The ISD can assign different sets of privileges based for example on different business relationships to the SSD designated as the TSM security domain and the SSD designated as the service provider security domain.

Additional configurations of the mobile communication device will now be described with reference to B C and D. shows an example configuration of the mobile communication device A in accordance with another example embodiment. As shown in the secure element is embedded in the mobile communication device A. The NFC module acts as a proxy or router with the applets of the secure element . The application manager communicates with the applets via the NFC module . The application manager may also communicate with a subscriber identity module SIM card .

Referring again to it would be appreciated that the described mobile payment system is provided for the purpose of illustration only and that the described mobile payment system comprises one possible communication network configuration of a multitude of possible configurations for use with the mobile communication devices . Example embodiments may be employed in connection with any other type of network and associated devices that are suitable in implementing contactless services. Suitable variations of the system will be understood to a person of skill in the art and are intended to fall within the scope of the present example embodiments.

A difficulty with some existing conventional systems is that a user may delete a device application which has an association with an applet . However in some of such systems merely the device application is removed and the user may be unaware that the applet and any encapsulated data may remain in the secure element . This may result in wastage of limited space within the secured element and may result in a breach of security.

In some example embodiments there is generally provided the removal of any orphaned applets from the secure element which are not associated with any device applications .

Reference is now made to which shows an example method or conversation for managing the secure element in accordance with an example embodiment. As shown the conversation may involve one or more device applications one shown the application manager the card manager the NFC module the TSM server and the service provider server . Generally the conversation may generally include determining that an applet does not have an association with any of the device applications and in response to making that determination sending a communication to the TSM server to delete the applet from the secure element .

In some example embodiments the conversation begins at event which is the application manager detecting a trigger event such as a start up of the communication device . For example the communication device may be turned on from an off state. In another example the communication device has been reset for example due to the installation or removal of a device application . Other example triggers include the installation or removal of a device application .

In some example embodiments one or more of the device applications may be associated with one of the applets . For example an indication or applet identifier AID of an applet may be used to determine the association. An example of such a device application is a mobile wallet application which may include a user interface. The mobile wallet application may interact with an applet and facilitate payment transaction logging or tracking user prompting additional passwords etc. In some example embodiments more than one device application may each be associated with more than one applet many to many . In some example embodiments other example relationships between the device applications and applets may include one to one one to many and many to one.

At event any of the device applications which are associated with a particular applet each send a communication to the application manager indicating association with one or more applets and identifying those applets using the AID.

At event in some example embodiments the application manager stores all of the received indications in a registry contained in memory. In some example embodiments the application manager stores one or more such indications of the received associations in a volatile memory such as RAM . For example the indications of the stored associations may be cleared upon shut down or reset of the communication device .

At event the application manager determines from the indications which applets do not have an association with any of the device applications . For example those applets may be identified using the AID. Such applets may be considered to be orphaned and flagged for removal. At event those applets are then listed onto a pending deletion list which may be stored on the flash memory .

In some other example embodiments at event applets are identified which do not have an association with any of the device applications for a specified number of successive start ups of the communication device . For example the specified number may be two successive start ups. For example an initial installation of an application may require a reset of the communication device . Upon reset an association with between a device application and the applet may not have been established yet. By determining an applet has been orphaned for two successive start ups this assists in avoiding any applets from being accidently flagged for the deletion list. The first instance of any identified orphaned applets may be stored on a persistent memory such as flash memory in such example embodiments. Similarly the instances of any identified orphaned applets prior to the specified number of successive start ups may be stored on the persistent memory.

Referring still to at event the application manager sends a communication to the TSM server for deletion of the applets on the pending deletion list identified using the AID. For example in some example embodiments the secure element may only be configured or managed by instructions received from the TSM server . At event the TSM server sends a communication to the NFC module to delete the identified applet s from the secure element . At event the communication is passed through to the card manager .

At event the card manager deletes the identified applet s from the secure element . In some example embodiments deletion of the applet results in associated data encapsulated within that applet to also be deleted. In some example embodiments deletion further includes deletion of appropriate emulation layers drivers and tokens. At event the card manager sends a communication to the NFC module which confirms deletion of the applet s which is forwarded to the TSM server at event .

At event the TSM server sends a communication to each service provider server that the associated applet has been deleted. At event the service provider server sends a communication to the TSM server confirming receipt.

At event the TSM server sends a communication to the application manager confirming deletion of the identified applet s . The communication at event may also include an instruction to remove the applet s from the pending deletion list. At event the application manager removes the applet s from the pending deletion list. At event the application manager sends a communication to the TSM server confirming receipt and deletion.

Referring still to in some other example embodiments at event the application manager stores the received associations in a persistent registry in a persistent memory such as flash memory .

At event the application manager determines that one or more applets stored on the secure element do not have an association with any of the device applications . The applets which are orphaned may be identified using the applet identifier AID . In some example embodiments event may include receiving from one or more device applications communications indicating association with one or more of the applets . At event the application manager in response to satisfaction of the determining at event sends a communication to the TSM server to delete the identified applet s from the secure element .

At event the NFC module receives a communication from the TSM server to delete the applet from the secure element . At event in response the NFC module communicates with the card manager to delete the applet s and any associated encapsulated data from the secure element .

While some example embodiments have been described as relating to mobile payment systems it would be appreciated that some example embodiments may be applied to other applications or services which may use a secure element and or a contactless element including without limitation exchanging data peer to peer communications configuration or Bluetooth pairing vending machines service maintenance loyalty or couponing information posting or retrieval ticketing medical home care web applications access control mobile signature and or security badge identification for building access.

While some of the present embodiments are described in terms of methods a person of ordinary skill in the art will understand that present embodiments are also directed to various apparatus such as a handheld electronic device including components for performing at least some of the aspects and features of the described methods be it by way of hardware components software or any combination of the two or in any other manner. Moreover an article of manufacture for use with the apparatus such as a pre recorded storage device or other similar non transitory computer readable medium including program instructions recorded thereon or a computer data signal carrying computer readable program instructions may direct an apparatus to facilitate the practice of the described methods. It is understood that such apparatus articles of manufacture and computer data signals also come within the scope of the present example embodiments.

While some of the above examples have been described as occurring in a particular order it will be appreciated to persons skilled in the art that some of the messages or steps or processes may be performed in a different order provided that the result of the changed order of any given step will not prevent or impair the occurrence of subsequent steps. Furthermore some of the messages or steps described above may be removed or combined in other embodiments and some of the messages or steps described above may be separated into a number of sub messages or sub steps in other embodiments. Even further some or all of the steps of the conversations may be repeated as necessary. Elements described as methods or steps similarly apply to systems or subcomponents and vice versa. Reference to such words as sending or receiving could be interchanged depending on the perspective of the particular device.

The term computer readable medium as used herein includes any medium which can store instructions program steps or the like for use by or execution by a computer or other computing device including but not limited to magnetic media such as a diskette a disk drive a magnetic drum a magneto optical disk a magnetic tape a magnetic core memory or the like electronic storage such as a random access memory RAM of any type including static RAM dynamic RAM synchronous dynamic RAM SDRAM a read only memory ROM a programmable read only memory of any type including PROM EPROM EEPROM FLASH EAROM a so called solid state disk other electronic storage of any type including a charge coupled device CCD or magnetic bubble memory a portable electronic data carrying card of any type including COMPACT FLASH SECURE DIGITAL SD CARD MEMORY STICK and the like and optical media such as a Compact Disc CD Digital Versatile Disc DVD or BLU RAY R Disc.

Variations may be made to some example embodiments which may include combinations and sub combinations of any of the above. The various embodiments presented above are merely examples and are in no way meant to limit the scope of this disclosure. Variations of the innovations described herein will be apparent to persons of ordinary skill in the art having the benefit of the present disclosure such variations being within the intended scope of the present disclosure. In particular features from one or more of the above described embodiments may be selected to create alternative embodiments comprised of a sub combination of features which may not be explicitly described above. In addition features from one or more of the above described embodiments may be selected and combined to create alternative embodiments comprised of a combination of features which may not be explicitly described above. Features suitable for such combinations and sub combinations would be readily apparent to persons skilled in the art upon review of the present disclosure as a whole. The subject matter described herein intends to cover and embrace all suitable changes in technology.

