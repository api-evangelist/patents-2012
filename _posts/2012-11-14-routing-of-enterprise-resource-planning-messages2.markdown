---

title: Routing of enterprise resource planning messages
abstract: An Enterprise Resource Planning (ERP) gateway is provided for routing of ERP messages to Manufacturing Execution System (MES) applications. The gateway can receive a message from an ERP system via a manufacturing services bus specifying a business objective requiring action at a control level of an enterprise. The received message can be routed to a selected MES application capable of carrying out the business objective based on attributes within the message. Message routing can be based on location tags contained in the message. The message can also be routed to a selected subset of MES applications based on an analysis of respective capabilities and control contexts of the MES applications. Messages can be routed between the ERP system and the MES applications via the manufacturing services bus, which can manage protocol transformations for a heterogeneous set of applications.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09588503&OS=09588503&RS=09588503
owner: Rockwell Automation Technologies, Inc.
number: 09588503
owner_city: Mayfield Heights
owner_country: US
publication_date: 20121114
---
This application claims the benefit of U.S. Provisional Patent Application Ser. No. 61 560 218 filed on Nov. 15 2011 and entitled ROUTING OF ENTERPRISE RESOURCE PLANNING MESSAGES. This application also claims the benefit of U.S. Provisional Patent Application Ser. No. 61 560 216 filed on Nov. 15 2011 and entitled ROUTING OF ENTERPRISE RESOURCE PLANNING MESSAGES. The entireties of these applications are incorporated herein by reference.

The subject application relates generally to industrial control and more particularly to a manufacturing services bus architecture for routing Enterprise Resource Planning ERP messages to selected Manufacturing Execution System MES applications.

Industrial controllers and their associated control programming are central to the operation of modern industrial automation systems. These controllers interact with field devices on the plant floor to carry out controlled processes relating to such objectives as manufacture of a product material handling batch processing waste water treatment and other such processes. Industrial controllers store and execute user defined control programs to effect decision making in connection with the controlled process. Such programs can include but are not limited to ladder logic sequential function charts function block diagrams structured text or other such platforms.

The various control systems that make up an enterprise are sometimes collectively managed by a Manufacturing Execution System MES which monitors real time data from the plant floor and issues control management instructions in view of higher level business considerations such as order management resource management inventory scheduling etc. In an enterprise comprising multiple production areas or multiple geographically diverse facilities the MES system may comprise multiple MES applications corresponding to the respective areas or facilities.

Plant floor operations including control of industrial processes by the industrial controllers described above represent one component of a larger business enterprise. On a higher level business operations such as financial analysis marketing sales order management long term business planning resource management inventory management and the like collectively represent another element of the enterprise. Many organizations employ an Enterprise Resource Planning ERP system or similar business system to correlate and manage these business level functions in a cohesive manner.

Although business level and plant floor level operations are related to and dependent upon one another the two levels are often only loosely integrated with slow e.g. non real time non automated information exchange between the two. Moreover efforts to integrate higher level business systems with plant side control can be hindered by the need for specialized programming code necessitating involvement of experienced programmers or IT personnel who may have limited understanding of both the business side and plant side operations compared with management or factory personnel.

The above described deficiencies of today s industrial control and business systems are merely intended to provide an overview of some of the problems of conventional systems and are not intended to be exhaustive. Other problems with conventional systems and corresponding benefits of the various non limiting embodiments described herein may become further apparent upon review of the following description.

The following presents a simplified summary in order to provide a basic understanding of some aspects described herein. This summary is not an extensive overview nor is intended to identify key critical elements or to delineate the scope of the various aspects described herein. Its sole purpose is to present some concepts in a simplified form as a prelude to the more detailed description that is presented later.

One or more embodiments of the present disclosure relate to the use of a gateway and bus architecture to route received ERP messages to one or more MES applications. To this end a manufacturing services bus can provide a platform by which business level requests such as those generated by an ERP system can be transformed and routed to selected MES applications or other enterprise applications subscribed to the bus to facilitate execution of the request at the control level. The manufacturing services bus can include an ERP gateway which can receive and analyze the ERP request in view of current control contexts reported by the respective MES applications. The gateway can include an optimization algorithm that considers the contents of the ERP request together with the current control statuses reported by the MES applications e.g. machine or facility statuses energy or material constraints work schedules etc. and determines a preferred set of one or more MES applications to which the ERP message is to be routed to best achieve the desired result given a specified set of decision criteria.

To the accomplishment of the foregoing and related ends certain illustrative aspects are described herein in connection with the following description and the annexed drawings. These aspects are indicative of various ways which can be practiced all of which are intended to be covered herein. Other advantages and novel features may become apparent from the following detailed description when considered in conjunction with the drawings.

The subject disclosure is now described with reference to the drawings wherein like reference numerals are used to refer to like elements throughout. In the following description for purposes of explanation numerous specific details are set forth in order to provide a thorough understanding thereof. It may be evident however that the subject disclosure can be practiced without these specific details. In other instances well known structures and devices are shown in block diagram form in order to facilitate a description thereof.

As used in this application the terms component system platform layer controller terminal station node interface are intended to refer to a computer related entity or an entity related to or that is part of an operational apparatus with one or more specific functionalities wherein such entities can be either hardware a combination of hardware and software software or software in execution. For example a component can be but is not limited to being a process running on a processor a processor a hard disk drive multiple storage drives of optical or magnetic storage medium including affixed e.g. screwed or bolted or removably affixed solid state storage drives an object an executable a thread of execution a computer executable program and or a computer. By way of illustration both an application running on a server and the server can be a component. One or more components can reside within a process and or thread of execution and a component can be localized on one computer and or distributed between two or more computers. Also components as described herein can execute from various computer readable storage media having various data structures stored thereon. The components may communicate via local and or remote processes such as in accordance with a signal having one or more data packets e.g. data from one component interacting with another component in a local system distributed system and or across a network such as the Internet with other systems via the signal . As another example a component can be an apparatus with specific functionality provided by mechanical parts operated by electric or electronic circuitry which is operated by a software or a firmware application executed by a processor wherein the processor can be internal or external to the apparatus and executes at least a part of the software or firmware application. As yet another example a component can be an apparatus that provides specific functionality through electronic components without mechanical parts the electronic components can include a processor therein to execute software or firmware that provides at least in part the functionality of the electronic components. As further yet another example interface s can include input output I O components as well as associated processor application or Application Programming Interface API components. While the foregoing examples are directed to aspects of a component the exemplified aspects or features also apply to a system platform interface layer controller terminal and the like.

As used herein the terms to infer and inference refer generally to the process of reasoning about or inferring states of the system environment and or user from a set of observations as captured via events and or data. Inference can be employed to identify a specific context or action or can generate a probability distribution over states for example. The inference can be probabilistic that is the computation of a probability distribution over states of interest based on a consideration of data and events. Inference can also refer to techniques employed for composing higher level events from a set of events and or data. Such inference results in the construction of new events or actions from a set of observed events and or stored event data whether or not the events are correlated in close temporal proximity and whether the events and data come from one or several event and data sources.

In addition the term or is intended to mean an inclusive or rather than an exclusive or. That is unless specified otherwise or clear from the context the phrase X employs A or B is intended to mean any of the natural inclusive permutations. That is the phrase X employs A or B is satisfied by any of the following instances X employs A X employs B or X employs both A and B. In addition the articles a and an as used in this application and the appended claims should generally be construed to mean one or more unless specified otherwise or clear from the context to be directed to a singular form.

Furthermore the term set as employed herein excludes the empty set e.g. the set with no elements therein. Thus a set in the subject disclosure includes one or more elements or entities. As an illustration a set of controllers includes one or more controllers a set of data resources includes one or more data resources etc. Likewise the term group as utilized herein refers to a collection of one or more entities e.g. a group of nodes refers to one or more nodes.

Various aspects or features will be presented in terms of systems that may include a number of devices components modules and the like. It is to be understood and appreciated that the various systems may include additional devices components modules etc. and or may not include all of the devices components modules etc. discussed in connection with the figures. A combination of these approaches also can be used.

One or more control systems can operate within respective production areas at the control level. Exemplary types of control systems can include but are not limited to batch control systems e.g. mixing systems continuous control systems e.g. PID control systems or discrete control systems These control systems can include one or more industrial controllers that facilitate monitoring and control of their respective processes. The controllers exchange data with the field devices using native hardwired I O or via a plant network such as Ethernet IP Data Highway Plus ControlNet Devicenet or the like. A given controller typically receives any combination of digital or analog signals from the field devices indicating a current state of the devices and their associated processes e.g. temperature position part presence or absence fluid level etc. and executes a user defined control program that performs automated decision making for the controlled processes based on the received signals. The controller then outputs appropriate digital and or analog control signaling to the field devices in accordance with the decisions made by the control program. These outputs can include device actuation signals temperature or position control signals operational commands to a machining or material handling robot mixer control signals motor control signals and the like. The control program can comprise any conceivable type of code used to process input signals read into the controller and to control output signals generated by the controller including but not limited to ladder logic sequential function charts function block diagrams structured text or other such platforms.

Manufacturing Execution System MES can monitor and manage control operations on the control level given higher level business considerations. An exemplary MES system can be provided with information relating one or more of scheduling work order management and execution business operating procedures resource management quality criteria inventory management and the like. Given this high level business information MES system can monitor control systems and or and issue control management instructions designed to align operations at the control level with medium term or long term goals of the organization as a whole.

Production areas can represent different areas within a single plant corresponding for example to different segments of a given manufacturing process different products etc. Alternatively or in addition Production areas can represent facilities located at different geographical locations associated with a given enterprise. In such architectures a central MES system can monitor and manage multiple control systems at different geographically diverse facilities providing coordination between the facilities in view of a common business objective.

While a single MES system is illustrated in the overview of it is to be appreciated that a given enterprise may comprise multiple MES systems. For example an enterprise comprising multiple plant facilities may employ an MES system at each facility where each MES system collectively manages the control systems that make up that system s facility. Since these different facilities collectively comprise the control level of a common enterprise a single ERP system or other business level system can execute collective business planning functions for the enterprise as a whole and dispatch business driven requests to all the MES systems making up the enterprise. As will be discussed in more detail infra the ERP gateway and manufacturing services bus architecture of the present disclosure can facilitate intelligent routing of ERP messages to the various MES applications.

ERP system or a similar business system can issue an ERP request to MES system . Such requests can include but are not limited to production requests business goals customer order information resource allocation requests or other such requests. A production request can comprise for example a request from the ERP system to produce a specified quantity of a product. In such cases ERP system may not have knowledge of the particular control architecture or statuses of control system machine availability work schedules or other plant floor variables involved in fulfilling the request. Given its ability to monitor and maintain these control side factors MES system can receive this production request from the ERP system and determine one or more possible workflows for producing the desired amount of the indicated product based on an analysis of the overall control system architecture machine availabilities work schedules or other plant floor variables involved in fulfilling the request. For example the MES system can determine which machines are available and capable of producing the desired amount of the product a suitable control strategy to be executed by the machines to satisfy the order e.g. a batching sequence a number of batches that must be run to produce the desired amount etc. . The ERP can then transform a suitable workflow into an output executable by the control system to implement the workflow using techniques to be described in more detail infra. Upon completion of or during the workflow the MES system can provide the ERP system with report feedback at a desired level of granularity.

A business goal can comprise more a complicated request involving correlation of a plurality of factors. For example the ERP system can issue a request to the MES system to minimize energy consumption for the plant as a whole during a specified range of hours while simultaneously maximizing production of an indicated product given the energy constraint. As with the production request this request can be processed by MES system and mapped to an appropriate control system workflow. Other exemplary ERP requests can include customer order requests resource allocation requests or any other business request generated by ERP system .

As noted above MES system can map incoming ERP request to a suitable workflow for execution by the MES system. In connection with generating this workflow MES system can identify machines or devices that can be leveraged to fulfill the business request as well as their associated controllers. MES system can then translate the workflow to an executable output capable of execution by the identified controllers. This executable output can comprise any suitable format understandable by the controllers including without limitation sequential function charts ladder logic function block diagrams structured text distributed control agents and the like. Executable output can also comprise control output signals mapped to tags or other I O associated with the controllers.

In addition to providing workflow instructions MES system can monitor and receive control data from control system . Examples of such control data include production data machine statuses alarms process measurements e.g. telemetry values resource statuses or other data made available by control system . Among other uses MES system can employ this control data to update system models used to select suitable workflows. MES system can also employ the control data to generate report data for provision to ERP system . Report data can include result data relating to implementation of the ERP request presented at a desired level of granularity. For example ERP system may only require an indication that a production request specified by ERP request was fulfilled but does not require details regarding the particular equipment used or number of production cycles run in connection with completing the request. Accordingly MES system can be configured to omit such production details from report data .

It is to be appreciated that any suitable communication protocol can be used to affect the data exchanges described above. For example ERP requests can be received by the MES system in Business to Manufacturing Markup Language b2MML which is an XML implementation of the ANSI ISA 95 family of standards. However other suitable communication formats and protocols are also contemplated and are within the scope of the present disclosure.

The foregoing is intended to provide a general overview of the relationships and types of data exchange between the ERP system MES system and control system. One or more embodiments of the present disclosure provide an ERP gateway configured to receive an ERP request such as ERP request of and to route the request via a manufacturing services bus to one or more selected MES systems for execution. To this end the ERP gateway can collect current control context information from the various MES systems subscribed to the bus. This control context information can include for example machine statuses and availability facility or production line work schedules resource inventory statuses energy constraints at a given facility process capabilities at the respective facilities or production lines or other such control level context information. The ERP gateway can then leverage an optimization algorithm to select one or more MES systems best suited to execute the ERP request based on the control contexts and information included in the ERP request. These aspects are discussed in more detail below.

MES applications can respectively comprise MES systems corresponding to different manufacturing facilities of an enterprise or different work areas within a single facility. Each MES application can provide coordinated management of respective control systems . Each control system can comprise multiple control systems of a given facility under the collective management of an MES application . ERP system or a similar business system integrates information from multiple departments of the enterprise e.g. finance sales marketing order processing human resources etc. and performs enterprise resource planning functions for the enterprise as a whole based on this business side information. One such function involves generation of business requests for distribution to the control level for execution. Exemplary business requests generated by ERP system can include but are not limited to requests for a specified amount of an indicated product to be produced a customer order to be filled a business driven constraint on plant operation e.g. a request to minimize overall plant energy usage at specified peak hours of the week while maximizing output of a preferred product or other such business level objectives requiring altered operation at the control level.

To facilitate routing of messages from ERP system the manufacturing services bus can include an ERP gateway configured to receive transform and route messages from ERP system . Upon receipt of an ERP message ERP gateway can determine a preferred set of one or more MES applications for carrying out the business request encoded in the ERP message perform any necessary format transformations in view of the destination applications and route the message to the identified subset of MES applications via manufacturing services bus . Upon receipt of the message MES applications execute necessary workflows for carrying out the request including providing instructions to control systems to facilitate execution of the request as will be discussed in more detail infra . When the MES applications have confirmed completion of the workflows or upon completion of intermediate milestone steps during execution of the workflows MES applications can send report data back to the ERP gateway via the manufacturing services bus . ERP gateway can transform the received MES data to the format utilized by the ERP system and deliver the message.

As illustrated in other applications can be subscribed to manufacturing services bus including but not limited to process optimization application and visualization application . Through their subscription to the manufacturing services bus these applications can also receive messages from ERP gateway . For example ERP gateway can route business request messages to the visualization application to be rendered in human readable form for review by business level or plant level personnel. In the opposite direction parameter or instruction data entered by a user at the visualization application can be routed to ERP gateway for entry in the ERP system . ERP gateway can also transform and route ERP request messages to process optimization application which can leverage neural networking and one or more process models to predict how one or more business level or control level variables will be impacted as a result of carrying out the ERP request. Other exemplary applications that can be subscribed to manufacturing services bus can include without limitation data historians reporting applications human machine interfaces HMIs and the like.

Upon receipt of ERP message ERP gateway can pass the request to incoming transform component which can convert a data format of the ERP message to a format compatible with MES application s . For example the ERP system from which ERP message was received may be configured to send business requests in the form of B2MML Business to Manufacturing Markup Language messages while one or more MES applications may be configured to receive messages using Java Message Service JMS . Accordingly incoming transform component can convert the B2MML message for communication using JMS. Although B2MML and JMS are described in this example it is to be appreciated that any suitable messaging format is within the scope of the present disclosure.

After transformation the converted ERP message is provided to message routing component to be routed to one or more selected MES applications. In order to identify which MES applications are to receive and process the ERP message the ERP message is provided to a parsing component which can parse the message to identify attributes within the message that can be leveraged to dynamically identify one or more destination MES applications . According to one or more embodiments ERP message can include one or more location tags indicating which MES application should receive the message for processing. These attribute tags can embedded into ERP message by the ERP system when ERP message is generated. Parsing component can extract these location tags and pass them to location component which can identify the appropriate destination MES application based on data contained in the location tags .

In one or more embodiments location tags can specify the destination MES application explicitly. Alternatively location tags can indicate a particular control system plant facility production line machine or other plant side element to be involved in executing the business objective specified in ERP message . In such cases location component can cross reference the indicated control element specified by the location tag with the particular MES application that manages the control element and instruct the message routing component to deliver the message to the identified application. In order to determine which MES application is responsible for managing the indicated control element one or more embodiments of ERP gateway can poll MES applications directly to ascertain which application is responsible for managing the control element. Alternatively ERP gateway can maintain a lookup table that defines associations between location tags and MES applications and location component can access this lookup table upon receipt of the location tags to identify the appropriate destination application. Once location component has resolved the destination application based on the location tags the location component can direct the message routing component to route the message to the identified destination application.

In the reverse direction MES applications can send messages via manufacturing services bus for delivery to the ERP system. These messages can comprise for example report data generated by the MES applications in response to execution of a business goal defined in ERP message . Messages from MES applications can be received by message routing component of ERP gateway and delivered to an outgoing transform component which can convert a data structure of the outgoing message to a format compatible with the ERP system. For example if an MES application delivers a message using Java Message Service JMS outgoing transform component can convert such messages to B2MML for delivery to the ERP system as report data .

To these ends message routing component can route incoming messages in accordance with instructions provide by an associated location component which identifies applications to be leveraged for execution of the business objective specified by ERP message based on a number of factors to be explained in more detail below. ERP message is passed to parsing component either directly upon receipt of the message or after translation into a suitable data format by incoming transform component . The parsing component can analyze the message to identify the business request encoded in the message and any parameters or criteria associated therewith. For example if the business request of ERP message is a customer order for a defined quantity of a specified product parsing component can identify the specified product the quantity and any timeframe information included in the request e.g. a deadline to fulfill the order . In another example if the business request is a mandate that production of a specified product is to be given production priority given a defined energy constraint during peak energy hours parsing component can break down the request to identify the preferred product to be optimized the energy constraint e.g. the maximum desired energy consumption for the plant as a whole and the hours for which the energy constraint is to be in effect. Parsing component can also identify any location tags encoded within the message if such tags are present.

These identified elements of the business request can then be passed to an optimization component for correlation with a number of additional factors to facilitate selection of MES applications best suited to carry out the business request. In one or more embodiments optimization component can leverage substantially real time control context information provided by the MES applications . This context information can comprise information regarding the capabilities architecture and statuses of the control systems associated with the respective MES applications . Exemplary control context information can include but are not limited to machine statuses capabilities of the respective control systems or unexpected or planned machine downtimes. This context information can be retrieved from the MES applications by an MES query component which can query the MES applications for the desired information and provide the control contexts to the optimization component for correlation with the business request parameters generated by the parsing component .

Optimization component can comprise an algorithm configured to correlate the business request parameters with the current control context information provided by the MES applications to identify a subset of MES applications best capable of satisfying the business request defined in ERP message . In one or more embodiments optimization component can make this selection in accordance with one or more defined criteria . An exemplary criterion can include for example a stipulation that the subset of MES applications should be selected to achieve the business objective in the least amount of time. When guided by such a criterion optimization component may determine that multiple combinations of MES applications and associated control systems are capable of satisfying the business objective and will select the combination identified as being capable of satisfying the objective in the least amount of time. In another example criterion can stipulate that minimization of energy consumption should be the overriding selection factor. Accordingly the combination of MES applications capable of achieving the business goal with the least consumption of energy will be selected from the multiple possible combinations by the optimization component. Other exemplary criteria can include without limitation minimization of man hours minimization of material cost smallest impact on production of a specified product or other suitable criteria.

These criteria can be generated by the ERP system as part of the business objective and included in ERP message . Alternatively criteria can be configured as one or more rules defined on the ERP gateway . In such embodiments ERP gateway can be configured to process all incoming ERP messages in view of the selection criteria . Moreover one or more embodiments of ERP gateway can dynamically select a criterion from a set of criteria based on information included in the ERP message such as a category of business request a criterion selection field metadata associated with the message or other such information. One or more embodiments of ERP gateway can also allow different criteria to be associated with different times of day or days of the week such that the criteria considered by the optimization component is a function of the time at which ERP message is received. For example in order to control energy costs by shaving peak energy demand a user may desire that all control level activities be subservient to the goal of minimizing energy usage during specified peak demand hours. Accordingly optimization component can be configured to employ minimize energy consumption as the criterion for MES application selection during peak demand hours and to employ minimize time as the criterion at all other times. In this way ERP messages can be automatically routed to suitable MES applications according to dynamically changing criteria in accordance with business preferences.

Based on one or more of information contained in the ERP message context information and criteria optimization component can identify a subset of MES applications best capable of satisfying the business goal defined by ERP message while simultaneously satisfying criteria . These results can be passed to the location component which can instruct message routing component to route the message to the one or more MES applications identified by the optimization component.

Although the preceding examples have been described in terms of communication of ERP data to one or more MES applications it is to be appreciated that ERP data can be routed to any type of application subscribed to manufacturing services bus including visualization applications process optimization applications data historians reporting systems and the like. As noted above the manufacturing services bus can be configured to perform the necessary data format conversions to facilitate message exchange between a range of heterogeneous applications.

The ERP gateway can provide a flexible mechanism for interfacing MES system with substantially any type of business system for exchange of business and production information. The ERP gateway can manage format transformation and routing of the business request to the MES system to be mapped to one or more suitable activity sets.

To facilitate flexible configuration of the MES system for operation with a range of ERP or other business systems ERP gateway can be configured prior to deployment for compatibility with a specific business system in use. An associated graphical interface can guide a developer through this configuration process. In one or more embodiments ERP gateway can be pre bundled with selectable configurations corresponding to common existing ERP or other business systems. Graphical interface can also allow selection of an expected data format e.g. b2MML in which data is to be exchanged between the MES system and the ERP system. During runtime business request can be received by the configured ERP gateway and transformed by an associated transform component from a data format used by the ERP system e.g. B2MML to a format understandable by MES system . In one or more embodiments the transform component can convert the business request for communication to the MES system using Java Message Service JMS although any suitable messaging format is within the scope of the present disclosure.

The transformed business request can pass the transformed business request to routing component or routing to the MES system . The target MES application is determined by location component based in part on contents of the business request e.g. parameters identified within the request location tags embedded in the request message etc. . Location component can also determine a destination MES application based in part on an analysis by optimization component which can correlate one or more of the request contents current control context reported by one or more MES applications or one or more selection criteria provided in the request or preconfigured in the gateway configuration. Upon resolution of a destination MES system location component can instruct routing component to send the resulting executable request to the identified application via manufacturing services bus . Details of the business request can be archived in local storage associated with ERP gateway . The archived business request information can be viewed graphical interface for later review or accessed by optimization component as criteria for routing future messages.

Executable request can be passed to a mapping component of the MES system which analyzes the request in view of the current control context of the plant in order to match a subset of activity sets with the request . An activity set can define a series of activities or a workflow for achieving a particular business goal. The activity set can define the activities in terms of the control or business functions to be performed the order of operation for the steps the designated machines or devices required to perform each step or any other information required to fully define the control activity represented by the activity set. The scope of a given activity set can be limited to a single device or can encompass multiple machines coordinated by the MES system to perform a distributed control operation in response to a received business request. The workflow defined by an activity set can encompass both control level activities and higher business level activities acting in conjunction thereby coordinating all levels of the enterprise to the end of satisfying the defined business goal. To this end in addition to control operations the activity sets can define interactions to be performed between the MES system and the ERP system relative to the defined sequence of control instructions. For example it may be desired to provide validation feedback to the ERP system when a particular step of the control sequence associated with the activity set has been completed or to provide an error message to the ERP system if a particular step of the control sequence fails or times out. Such feedback steps can be encoded in the activity set together with the control sequence activities. MES system can include a library of generalized industry specific activity sets which can be bound to a user s particular control context via controller tag mapping during initial configuration.

Activity sets can comprise customized activity sets that have been bound to selected controller tags of the control system. Based on the content of executable request and the control context mapping component can select a suitable activity set capable of satisfying the business request represented by executable request . Control context can include such pre configured or substantially real time information as machine statuses and availability the architecture and capabilities of the control system current machine or system downtime information work schedules or other information relevant to execution of the business request. Control context can be provided manually by a user or generated automatically based on real time monitoring of the control system by the MES system .

As an example of how control context can be used to facilitate selection of an activity set consider a business request representing a customer order for a specified quantity of a selected product. In this example the order is received from an ERP system as business request and routed to MES system by ERP gateway . Since the ERP system has no knowledge of the particular control context on the plant floor for fulfilling this request the request includes no indication of which particular machines or process lines are to be used to satisfy the order. Upon receiving executable request corresponding to business request mapping component can leverage the control context to identify machines capable of fulfilling the request the process that must be executed on these machines to produce the desired quantity of the product and the current status and availability of the respective machines. Based on this information mapping component can select an activity set corresponding to the identified process for execution on the identified machines. In some cases the stored activity sets may include different activity sets corresponding to the same process but intended for execution on different machines e.g. two different mixers having different control characteristics . If the different machines are capable of producing the ordered product mapping component can leverage control context to determine a preferred machine on which to execute the order based on efficiency respective machine availabilities maintenance cycles load balancing or other such considerations made available by control context . In another example the same activity set may be executable on different machines. Therefore rather than selecting an activity set corresponding to a preferred machine MES system can select the activity set common to the different machines and select a target machine for the activity set based on the control context . Moreover since a product quantity is associated with the customer order this product quantity information can be passed from the executable request to the selected activity set as a variable since the selected activity set may be generalized in terms of product quantity.

In this example ERP message is received at gateway from the ERP system via bus . Although an ERP message is depicted in this example message can also comprise a message from another business level or control level application subscribed to bus . ERP message can comprise a business driven request or objective generated by the ERP system such as a production request a customer order a resource allocation request an instruction to minimize plant energy consumption during indicated hours specification of a product to be given manufacturing preference given a resource constraint or other such requests.

Visualization system may wish to subscribe to receive the ERP message in order to render the message on a display screen. For example visualization system may be configured to receive ERP messages and render them in a graphical form for review by management or plant personnel. Optimization system may be configured to leverage neural networking and one or more process models to predict how one or more business level or control level variables will be impacted as a result of carrying out the ERP request encoded in the message. Data historian may be configured to archive a history of ERP request and associated report data and is therefore subscribed to manufacturing services bus to receive the ERP messages.

Upon receipt of ERP message gateway can pass the request to incoming transform component which can convert the message to a format compatible with one of the visualization system the optimization system or the data historian . For example the ERP system from which ERP message was received may be configured to send business requests in the form of B2MML Business to Manufacturing Markup Language messages while one or more of applications and may be configured to receive messages using Java Message Service JMS . Accordingly incoming transform component can convert the B2MML message for communication using JMS. Although B2MML and JMS are described in this example it is to be appreciated that any suitable messaging format is within the scope of the present disclosure.

After transformation the converted ERP message is provided to message routing component to be routed to one or more selected applications. In order to identify which applications are to receive and process the ERP message the ERP message is provided to a parsing component which can parse the message to identify attributes within the message that can be leveraged to dynamically identify one or more destination applications. As in previous examples ERP message can include one or more location tags indicating which MES applications should receive the message for processing. These attribute tags can embedded into message by the ERP system when the message is generated. Parsing component can extract these location tags and pass them to location component which can identify the appropriate destination applications based on data contained in the location tags .

In the reverse direction applications and can send messages via bus for delivery to the ERP system. These messages can comprise for example user input data from the visualization system optimization recommendations generated by the optimization system or data being retrieved from data historian . Messages from applications subscribed to the bus can be received by the routing component of gateway and delivered to an outgoing transform component which can convert a data structure of the outgoing message to a format compatible with the ERP system or other destination system . For example if an application delivers a message using Java Message Service JMS outgoing transform component can convert such messages to B2MML for delivery to the ERP system as return data .

At it is determined whether the message is in a format compatible with the MES system to receive the message. If not the message is transformed to a format compatible with the MES system at . For example message can be converted from b2MML format to a format compatible with JMS Java Message Service for transfer of the message to the MES system. In one or more embodiments this transformation can be performed by an ERP gateway prior to delivery to the MES system. At the message is routed to the identified MES application. In one or more embodiments the message can be routed via a manufacturing services bus to which the MES application is subscribed.

At multiple MES applications are queried in order to determine control contexts associated with the respective applications. This control context information can include for example machine statuses and availability facility or production line work schedules resource inventory statuses energy constraints at a given facility process capabilities at the respective facilities or production lines or other such control level context information. At one or more MES applications capable of satisfying the business objective are selected in view of a defined criterion. The defined criterion can include for example a request to satisfy the business objective by the most energy efficient means by the fastest means etc.

At a determination is made regarding whether the message is in a format compatible with the selected one or more MES applications. If not the message is transformed to s suitable format at . At the message is routed to the one or more selected MES applications.

Embodiments systems and components described herein as well as industrial control systems and industrial automation environments in which various aspects set forth in the subject specification can be carried out can include computer or network components such as servers clients programmable logic controllers PLCs communications modules mobile computers wireless components control components and so forth which are capable of interacting across a network. Computers and servers include one or more processors electronic integrated circuits that perform logic operations employing electric signals configured to execute instructions stored in media such as random access memory RAM read only memory ROM a hard drives as well as removable memory devices which can include memory sticks memory cards flash drives external hard drives and so on.

Similarly the term PLC as used herein can include functionality that can be shared across multiple components systems and or networks. As an example one or more PLCs can communicate and cooperate with various network devices across the network. This can include substantially any type of control communications module computer Input Output I O device sensor actuator and human machine interface HMI that communicate via the network which includes control automation and or public networks. The PLC can also communicate to and control various other devices such as I O modules including analog digital programmed intelligent I O modules other programmable controllers communications modules sensors actuators output devices and the like.

The network can include public networks such as the internet intranets and automation networks such as control and information protocol CIP networks including DeviceNet ControlNet and Ethernet IP. Other networks include Ethernet DH DH Remote I O Fieldbus Modbus Profibus CAN wireless networks serial protocols and so forth. In addition the network devices can include various possibilities hardware and or software components . These include components such as switches with virtual local area network VLAN capability LANs WANs proxies gateways routers firewalls virtual private network VPN devices servers clients computers configuration tools monitoring tools and or other devices.

With reference to an example operating environment for implementing various aspects of the aforementioned subject matter includes a computer . The computer includes a processing unit a system memory and a system bus . The system bus couples system components including but not limited to the system memory to the processing unit . The processing unit can be any of various available processors. Dual microprocessors and other multiprocessor architectures also can be employed as the processing unit .

The system bus can be any of several types of bus structure s including the memory bus or memory controller a peripheral bus or external bus and or a local bus using any variety of available bus architectures including but not limited to 8 bit bus Industrial Standard Architecture ISA Micro Channel Architecture MSA Extended ISA EISA Intelligent Drive Electronics IDE VESA Local Bus VLB Peripheral Component Interconnect PCI Universal Serial Bus USB Advanced Graphics Port AGP Personal Computer Memory Card International Association bus PCMCIA and Small Computer Systems Interface SCSI .

The system memory includes volatile memory and nonvolatile memory . The basic input output system BIOS containing the basic routines to transfer information between elements within the computer such as during start up is stored in nonvolatile memory . By way of illustration and not limitation nonvolatile memory can include read only memory ROM programmable ROM PROM electrically programmable ROM EPROM electrically erasable PROM EEPROM or flash memory. Volatile memory includes random access memory RAM which acts as external cache memory. By way of illustration and not limitation RAM is available in many forms such as synchronous RAM SRAM dynamic RAM DRAM synchronous DRAM SDRAM double data rate SDRAM DDR SDRAM enhanced SDRAM ESDRAM Synchlink DRAM SLDRAM and direct Rambus RAM DRRAM .

Computer also includes removable non removable volatile non volatile computer storage media. illustrates for example a disk storage . Disk storage includes but is not limited to devices like a magnetic disk drive floppy disk drive tape drive Jaz drive Zip drive LS 100 drive flash memory card or memory stick. In addition disk storage can include storage media separately or in combination with other storage media including but not limited to an optical disk drive such as a compact disk ROM device CD ROM CD recordable drive CD R Drive CD rewritable drive CD RW Drive or a digital versatile disk ROM drive DVD ROM . To facilitate connection of the disk storage to the system bus a removable or non removable interface is typically used such as interface .

It is to be appreciated that describes software that acts as an intermediary between users and the basic computer resources described in suitable operating environment . Such software includes an operating system . Operating system which can be stored on disk storage acts to control and allocate resources of the computer . System applications take advantage of the management of resources by operating system through program modules and program data stored either in system memory or on disk storage . It is to be appreciated that one or more embodiments of the subject disclosure can be implemented with various operating systems or combinations of operating systems.

A user enters commands or information into the computer through input device s . Input devices include but are not limited to a pointing device such as a mouse trackball stylus touch pad keyboard microphone joystick game pad satellite dish scanner TV tuner card digital camera digital video camera web camera and the like. These and other input devices connect to the processing unit through the system bus via interface port s . Interface port s include for example a serial port a parallel port a game port and a universal serial bus USB . Output device s use some of the same type of ports as input device s . Thus for example a USB port may be used to provide input to computer and to output information from computer to an output device . Output adapter is provided to illustrate that there are some output devices like monitors speakers and printers among other output devices which require special adapters. The output adapters include by way of illustration and not limitation video and sound cards that provide a means of connection between the output device and the system bus . It should be noted that other devices and or systems of devices provide both input and output capabilities such as remote computer s .

Computer can operate in a networked environment using logical connections to one or more remote computers such as remote computer s . The remote computer s can be a personal computer a server a router a network PC a workstation a microprocessor based appliance a peer device or other common network node and the like and typically includes many or all of the elements described relative to computer . For purposes of brevity only a memory storage device is illustrated with remote computer s . Remote computer s is logically connected to computer through a network interface and then physically connected via communication connection . Network interface encompasses communication networks such as local area networks LAN and wide area networks WAN . LAN technologies include Fiber Distributed Data Interface FDDI Copper Distributed Data Interface CDDI Ethernet IEEE 802.3 Token Ring IEEE 802.5 and the like. WAN technologies include but are not limited to point to point links circuit switching networks like Integrated Services Digital Networks ISDN and variations thereon packet switching networks and Digital Subscriber Lines DSL .

Communication connection s refers to the hardware software employed to connect the network interface to the system bus . While communication connection is shown for illustrative clarity inside computer it can also be external to computer . The hardware software necessary for connection to the network interface includes for exemplary purposes only internal and external technologies such as modems including regular telephone grade modems cable modems and DSL modems ISDN adapters and Ethernet cards.

What has been described above includes examples of the subject innovation. It is of course not possible to describe every conceivable combination of components or methodologies for purposes of describing the disclosed subject matter but one of ordinary skill in the art may recognize that many further combinations and permutations of the subject innovation are possible. Accordingly the disclosed subject matter is intended to embrace all such alterations modifications and variations that fall within the spirit and scope of the appended claims.

In particular and in regard to the various functions performed by the above described components devices circuits systems and the like the terms including a reference to a means used to describe such components are intended to correspond unless otherwise indicated to any component which performs the specified function of the described component e.g. a functional equivalent even though not structurally equivalent to the disclosed structure which performs the function in the herein illustrated exemplary aspects of the disclosed subject matter. In this regard it will also be recognized that the disclosed subject matter includes a system as well as a computer readable medium having computer executable instructions for performing the acts and or events of the various methods of the disclosed subject matter.

In addition while a particular feature of the disclosed subject matter may have been disclosed with respect to only one of several implementations such feature may be combined with one or more other features of the other implementations as may be desired and advantageous for any given or particular application. Furthermore to the extent that the terms includes and including and variants thereof are used in either the detailed description or the claims these terms are intended to be inclusive in a manner similar to the term comprising. 

In this application the word exemplary is used to mean serving as an example instance or illustration. Any aspect or design described herein as exemplary is not necessarily to be construed as preferred or advantageous over other aspects or designs. Rather use of the word exemplary is intended to present concepts in a concrete fashion.

Various aspects or features described herein may be implemented as a method apparatus or article of manufacture using standard programming and or engineering techniques. The term article of manufacture as used herein is intended to encompass a computer program accessible from any computer readable device carrier or media. For example computer readable media can include but are not limited to magnetic storage devices e.g. hard disk floppy disk magnetic strips . . . optical disks e.g. compact disk CD digital versatile disk DVD . . . smart cards and flash memory devices e.g. card stick key drive . . . .

