---

title: Passive imaging correction system using feedback including a variable aperture with plural settings and method thereof
abstract: A method and system for image processing comprising an opening for entrance of light for forming an image by the system; at least one optical element through which the light passes; a variable aperture operatively associated with the at least one optical element placed in the optical train at an image plane and comprising a plurality of settings comprising first mask settings for shielding portions of the light and second mask settings for selectively masking portions of the light that pass through the first mask settings; an imager, the at least one processor being operatively connected to the variable aperture and imager for controlling the passage of the light through the variable aperture by selecting one of plurality of first mask settings and associated second mask settings, obtaining image results using the settings, comparing image results obtained by the respective mask settings, and determining the optimal first mask setting.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09006633&OS=09006633&RS=09006633
owner: The United States of America as represented by the Secretary of the Army
number: 09006633
owner_city: Washington
owner_country: US
publication_date: 20121102
---
The embodiments herein may be manufactured used and or licensed by or for the United States Government without the payment of royalties thereon.

The present invention is directed to inter alia passive correction of turbulence affected incoherent imaging using an optical system and methodology for inter alia reducing the effects of short exposure blur due to atmospheric optical turbulence.

Optical signals passing through a time varying inhomogeneous medium such as the Earth s lower atmosphere can become significantly distorted when propagating over ranges of even as short as several hundred meters. The primary mechanism of this distortion is due to temperature fluctuations driven by heating and cooling of the air which is most severe at the Earth s surface. In such cases several optical distortion effects impact propagating optical waves and signals. Coherent propagation is significantly affected by turbulent scintillation amplitude fluctuation effects and beam wander of propagating laser beams. For incoherent wave sources being viewed by passive imaging systems three effects occur Short exposure images show blurring of point sources in the object plane. Point objects also appear to wander in position due to angle of arrival variations. Thirdly point sources separated by angular distances exceeding a characteristic value the isoplanatic angle appear to wander independently.

Systems for correcting for turbulence effects on imaging through use of an imaging system containing a Spatial Light Modulator SLM to modify the phase of the incoming radiation have been disclosed such as for example M. A. Vorontsov G. W. Carhart and J. C. Ricklin Adaptive phase distortion correction based on parallel gradient descent optimization Opt. Lett. 22 907 909 1997 hereby incorporated by reference and G. W. Carhart J. C. Ricklin V. P. Sivokon and M. A. Vorontsov Parallel perturbation gradient descent algorithm for adaptive wavefront correction in Adaptive Optics and Applications R. Tyson and R. Fugate eds. Proc. SPIE 3126 221 227 1997 hereby incorporated by reference . These methods described in these papers focus on two aspects the use of a Spatial Light Modulator or deformable mirror which functions in a similar fashion and use of the Parallel Gradient Descent PGD optimization method which has now evolved to be known as the Stochastic Parallel Gradient Descent SPGD method.

Ground to ground imaging through turbulence problems essentially involve image blur which is caused primarily by turbulence close to the system receiving aperture and image distortion which is due to turbulence weighted toward the target object that is under observation by the system. Because the atmospheric optical turbulence strength is greatest close to the ground the dominant effect impacting ground based imaging systems is turbulence induced blur close to the system aperture. As used herein the terminology blur signifies to make indistinct and hazy in outline or appearance reducing high angular frequency detail as opposed to obscuration which affects contrast which reduces all angular frequency detail equally. As used herein the terminology distort as it relates to optics means a change in the shape of an image resulting from variations in the perceived relative angular positions of different scene features of a given viewed object.

To correct for image blur various system configurations have been proposed in past work. These usually involve active system implementations that feature some sort of illumination device to produce what is commonly known as a guide star. A guide star is a compact illumination source of known geometry and phase that can be imaged through the turbulent atmosphere by the imaging system. The system then analyzes the propagated characteristics of this guide star and uses the results of this diagnosis to formulate a correction to the optical system. This correction always involves a deformable optical device either a deformable mirror or a spatial light modulator SLM . The guide star can be formed by an illumination beam propagated by the system itself producing an illuminated spot in the object field of view or by an illumination source placed in the imaged object field of view and oriented toward the receiver optics. The following patent materials rely on the use of guide stars and or the use of a wave front sensor U.S. Published Application No. 2004 0208595 Free Space Communication System with Common Optics and Fast Adaptive Tracking by Fai Mok and James Kent Wallace U.S. Published Application No 2005 0045801 State Space Wavefront Reconstructor for an Adaptive Optics Control by Carey A. Smith U.S. Published Application No 2006 0049331 Adaptive Optics Control System by Carey A. Smith U.S. Pat. No. 7 038 791 Signal to Noise Ratio Tuned Adaptive Optics Control System by Carey A. Smith U.S. Published Application No 2010 0080453 A1 System for Recovery of Degraded Images by Nicholas George and U.S. Pat. No. 6 163 381 Dual Sensor Atmospheric Correction System by Donald W. Davies Mark Slater and Richard A. Hutchin.

Unfortunately there are several problems with the use of guide stars. First a guide star approach is not a passive solution. Active systems that require the illumination of a target scene prior to detection of significant targets are not stealthy and are undesirable in most tactical situations that are of interest in a military situation. Second many imaged objects may not have useful reflective properties that will work properly with an illumination beacon. To provide a proper guide star an object would need to have a corner reflecting or shallow convex specular surface a glint target nearby. Most natural objects are diffuse reflectors and thus do not return glints. Many man made objects are also diffuse reflectors or have specular surfaces that are sharply curved and thus only return a very weak glint. Other alternatives such as placing an illuminator in the object plane requiring objects of interest to mount glint reflectors or forming laser induced fluorescence LIF guide stars on target surfaces are obviously not practical from an Army application standpoint. Another difficulty with the guide star approach is that the coherent propagating wave from a guide star is affected by turbulent scintillation which is most strongly weighted at the center of the optical path not at the system receiver. Thus the guide star method is not optimized to produce a useful result for removing turbulent blur.

Therefore a means is needed to image objects through turbulent blur that does not require an active illumination beacon a guide star and is optimized to sense turbulent blur perturbations on imaged incoherent radiation.

As opposed to active wave front sensing techniques U.S. Published Application No 2005 0151961 Surface Layer Atmospheric Turbulence Differential Image Motion Measurement by John T. McGraw Peter C. Zimmer and Mark R. Ackermann simply attempts to sense the image distorting effects of the atmosphere without actually attempting to modify or correct for turbulence effects.

Two known exceptions to the general approach of active wave front sensing are Patent 2010 0053411 A1 Control of Adaptive Optics based on Post Processing Metrics by M. Dirk Robinson and David G. Stork and the method proposed in G. W. Carhart J. C. Ricklin V. P. Sivokon and M. A. Vorontsov Parallel perturbation gradient descent algorithm for adaptive wavefront correction in Adaptive Optics and Applications R. Tyson and R. Fugate eds. Proc. SPIE 3126 221 227 1997 . Both of these propose a system or a method to performs wavefront correction based on post processing of received imagery to produce a metric that is then used in guiding the correction of images. The former proposed a system. The latter proposed a processing approach based on an algorithm. Both based their corrections on image analysis alone.

As indicated above the guide star concept is generally not preferred in ground to ground imaging applications for blur correction. In assessing the impact of turbulence on boundary layer imaging two observations are manifest. First the turbulence that is causing the most image blur is close to the sensing aperture. Second scene elements that are separated in the scene by a significant angular separation experience anisoplanatic effects limiting the ability of a system to correct turbulent image perturbations at large angular separation from the guide star. Anisoplanatism means that turbulent perturbations in different parts of the atmospheric field are causing different turbulent perturbations in different parts of an imaged scene. This effect impairs the performance of guide star based systems because turbulent perturbations on the guide star wavefront in one part of the image frame are not the same turbulent perturbations that impact scene elements in another part of the image frame. Guide star based systems thus do not do well at correcting for turbulent blur in different parts of an imaged scene underscoring the need for a passive method that can correct for turbulence sequentially in different parts of the image.

Unlike systems that rely on a coherent guide star signal to provide a sufficient density of photons to feed a wavefront detection process atmospheric boundary layer imagers typically observe light emerging from a plurality of decorrelated emission sources. In particular source points present on surfaces that are rough on the order of a single wavelength of the propagating radiation will not produce a single coherent source even in a point source sense. In this instance a second type of solution to compensating for turbulence has been sought. This second form of solution involves a purely passive approach of varying implementations generally involving one or more post imaging processing procedures for detected signals to remove the impacts of turbulence. One such algorithmic approach entails dewarping of the imaged field to remove image distortion based on analysis of the temporally varying apparent positions of objects. Another approach uses long term averaging of images to essentially remove the angle of arrival variations followed by inverse filtering using a best guess of the long exposure atmospheric MTF. Various combinations of these two approaches can be constructed including analysis of and segmentation of images to separately study constant regions of images and regions that are considered to be temporally evolving that may contain scene elements of interest. Many of these procedures fall under the category termed the lucky pixel or lucky patch method initially proposed by D. L. Fried Probability of getting a lucky short exposure image through turbulence J. Opt. Soc. Am. 68 1651 1658 1978 . However whereas Fried s initial proposal suggested capturing complete distortion free images later implementations of this concept e.g. Carhart G. and M. Vorontsov Opt. Lett. 23 745 747 1998 or Vorontsov M. JOSA A 16 1623 1637 1999 first segment the images into a series of sections analyze each section separately to determine the relative clarity spatial frequency content based on an image quality metric of each and then on a section by section basis proceed to composite a complete reduced turbulence equivalent image as a mosaic. Unfortunately for many terrestrial ground to ground imaging scenarios the probability of obtaining any portion of an image that is free of significant turbulence may be so small as to provide a negligible chance of obtaining a set of null turbulence patches sufficient to construct an unperturbed image. One means of rapidly evaluating the overall quality of either an image portion or a complete imaged scene involves constructing a sum of squares of the normalized image scene pixels N. Mahajan J. Govignon and R. J. Morgan Adaptive optics without wavefront sensors SPIE Proc. Active Optical Devices and Applications 63 69 1980 . As Mahajan et al. explained the variance of the image information is related to the area under the combined atmosphere plus system MTF. Using this metric it is possible to gauge the level of spatial frequency energy in a scene. Also while D. L. Fried Probability of getting a lucky short exposure image through turbulence J. Opt. Soc. Am. 68 1651 1658 1978 focused on only the probability of detecting a lucky short exposure image of a scene a later study by R. E. Huffiagel The Probability of a Lucky Exposure Tech. Memo. REH 0155 The Perkin Elmer Corp. 1989 hereby incorporated by reference considered how this capability is enhanced for signals that have been partially corrected through the removal of an increasing number of phase perturbation aberration modes. In particular Hufnagel considered cases involving 0 short exposure image only 3 2nd order aberrations 7 2nd and 3rd order aberrations and 12 2nd through 4th order aberrations corrected modes compensated. Hufnagel s study interpreted for the lucky patch problem indicates that while the lucky patch method acting on a short exposure image series could provide significant improvement for cases where the ratio of the diameter of the optics to the coherence radius X D r0 is no more than three by correcting aberration modes the lucky patch correction technique would be one million times more likely to find a lucky patch at X 10. This implies that the lucky patch approach could be extended to turbulence conditions ten times stronger triple the range of the baseline lucky patch method alone.

In U.S. Published Patent Application No. 2010 0053411 entitled Control of Adaptive Optics based on Post Processing Metrics by M. Dirk Robinson and David G. Stork a system is proposed that performs wavefront correction based on post processing of received imagery to produce a metric that is then used in guiding the correction of images. The system appears to only apply to static targets.

However it would appear that if one attempts to correct imagery based solely on analysis of received imagery the number of phase perturbation aberration modes expressed in terms of Zernike expansion functions e.g. V. N. Mahajan Zernike annular polynomials and optical aberrations of systems with annular pupils Appl. Opt. 33 8125 8127 1994 or G. M. Dai and V. N. Mahajan Zernike annular polynomials and atmospheric turbulence J. Opt. Soc. Am. A 24 139 155 2007 present at the system aperture gives rise to a problem. That problem is a limitation on how frequently a given mode may be corrected given a specific rate of image collection by the optical system in combination with the strength of aberration due to a specific mode. To assess the effective number of active perturbation modes present one must be able to evaluate the statistical state of the wavefront present at the system aperture. D. L. Fried Optical resolution through a randomly inhomogeneous medium for very long and very short exposures J. Opt. Soc. Am. 56 1372 1379 1966 suggested that an appropriate measure of the decorrelation in the phase front present in the system aperture is the turbulent coherence diameter designated r. This length is a width measured in a plane transverse to the direction of wave propagation over which the wave phase coherence decays by a value of exp 1 . For many common long range surveillance receiving systems imaging objects at several kilometers distance the wavefront will become decorrelated within the diameter of the receiver aperture at even moderate optical turbulence levels characterized by the dimensionless ratio X D r where D is the diameter of the system aperture . In the case where X significantly exceeds unity the wave will exhibit random phase fluctuations that can cause image blurring effects even accounting for short exposure imaging Tofsted D. H Reanalysis of turbulence effects on short exposure passive imaging Opt. Eng. 50 01 6001 2011 hereby incorporated by reference . To describe these decorrelations in the propagating phase front various orthonormal families of basis functions may be utilized e.g. V. N Mahajan Zernike annular polynomials and optical aberrations of systems with annular pupils Appl. Opt. 33 8125 8127 1994 . Fried Statistics of a Geometric Representation of Wavefront Distortion J. Opt. Soc. Am. 55 1427 1431 1965 . As the ratio X exceeds unity the effective number of non zero expansion modes needed to describe the wave perturbation function increases approximately as X. Therefore for any given degree of turbulent perturbation one must have a specific plan to enable phase corrections see detailed discussions of and through based on an organized methodology.

A further example of prior art is the application of the stochastic parallel gradient descent technique in tracking the effects of turbulent fluctuations. This stochastic method attempts to adjust a sequence of deformable mirror pistons by performing random fluctuations of the current choice of piston settings and adaptively modifying the best guess of the correction state based on the outcome of each stochastic perturbation. Weighting methods may be used to selectively focus the algorithm on the correction of lower order modes. The limitation of this approach is the high number of image samples to be collected rapidly enough several thousand sample images per second to track the evolving state of the various perturbation modes. This is because the method is relatively inefficient relying on a stochastic adjustment procedure. Because the maximum sampling rate of an image at an adequate signal to noise ratio is limited by the amount of ambient light available to produce the image and the system s light gathering capability sufficiently high frame rates may not be possible without the augmentation of the system by a high intensity light source in the imaged scene to provide the necessary illumination. This amenity may not be available in military or in many other contexts.

The present invention is directed to an improved adaptive optics control system utilizing adaptive aperture techniques with or without phase compensation techniques. A preferred embodiment system comprises a variable aperture such as for example a controllable mirror placed in an image plane of the system aperture to perform adaptive apodization a wavefront corrector and a feedback system based on analysis of image quality to determine updated settings to apply to the apodization mirror and deformable wavefront corrector. The wavefront corrector may comprise a surface controlled by a plurality of actuators which may be programmed to approximate a sum of weighted Zernike modes selected to approximate the conjugate of the current short exposure blur deformation to the propagated phase perturbations in the system apodized aperture. Specific settings of the phase map may be governed by a calculation based on a programmed sequence of sub aperture measurements of phase to produce an estimate of the current atmospheric perturbations affecting a given sub image frame region of the observed scene. Feedback response may be used to determine the evolution of the current atmospheric state and to adapt the phase correction for different sub frame regions of the image field of view. The system variable aperture or apodization may be separately tuned to reduce the effective number of Zernike perturbation modes that must be tracked by the system. The annular setting of the apodization pattern provides control of both the maximum angular frequency response of the apodized system aperture as well as controlling the number of Zernike perturbation modes necessary to drive the wavefront corrector.

A preferred embodiment of the present invention is directed to an optical signal modification system designed to remove and correct severe amplitude and phase distortions in propagated fields emitted from a plurality of incoherent object plane source points based on the combined operation of a digital micro mirror device DMD with or without a spatial light modulator SLM and a processing subsystem using image plane feedback to optimize the choice of SLM and DMD settings based on passive inputs. In a preferred embodiment a dynamic feedback system may be based on an ordered search procedure designed to sense subframe image shifts of observed objects through selected sub aperture regions in combination with modeling of the conjugate phase necessary to drive the correction settings for a plurality of Zernike perturbation modes from 2nd to 4th order. Coupled to this rapid Zernike computation method is a radial model sampling method for controlling the system aperture apodization function involving setting of an inner and outer edge of an annular entrance pupil apodization pattern. The primary perturbations this design is configured to address are short exposure blur effects related to the atmospherically degraded apparent imaging system modulation transfer function MTF . A primary objective of a preferred embodiment of the present invention is to best approximate the conjugate of the atmospheric perturbations affecting image quality. To form a coordinated pair of correction signals applied simultaneously to the SLM and DMD elements of the optical correction system a master sequencing program is designed to 1 assess feedbacks from sub aperture sample image processing results 2 assign current settings for the SLM and DMD subsystems 3 select successive sub frame image regions on which to focus the correction algorithm and 4 schedule sequences of sub frame sub aperture image collections for analysis and full frame full apodized aperture image collections for output based on optimized SLM and DMD computed settings.

In an alternative embodiment the SLM is absent and the DMD is programmed to only model a variable system aperture with or without an annular shape. The resulting system will select an optimized effective system aperture diameter based on the current state of turbulence which is determined by feedback based on image quality. In both embodiments the image quality for computing the settings of the system aperture apodization is assessed using a sum of squares of image pixel values of a contrast stretched image which thereby reflects the current level of correction of blur quantifying the approach of the system plus atmospheric modulation transfer function MTF toward an optimal setting.

Alternatively when computing the sum of squares the image data can be multiplied by a regional weighting function that focuses on a particular portion of the image field. This method permits the apodization control system to selectively enhance different specific portions of the image that may be at different ranges experiencing different levels of turbulence induced blur thereby permitting the system to either focus on a single area of interest or to progressively scan across the full image field and generate a series of image patches that may be stitched together to produce a complete clear image.

The preferred method comprises an adaptive system based on a passive analysis of scene content and optimization of the same through the augmentation of the basic optics of a receiver system lenses mirrors and stops through the introduction of three specific additional elements. The first element is a digital micro mirror device suitably integrated into the optical path and connected and interfaced to a computer or microprocessor control unit. This element adapts the shape of the wave front that is permitted to pass through the optical train to the final lens and be focused onto the image plane. The second element is a spatial light modulator suitably integrated into the optical path and connected and interfaced to a computer or microprocessor control unit. This element controls the phase of the light across the wave front. The third element is a feedback control circuit designed to test the current state of clarity of the images being produced by the current settings of the optical adjustments of the optical system to adjust settings on the adaptive optical DMD and SLM elements to obtain sub aperture sub frame image sequences to perform pattern matching of sub aperture sub frame images to determine relative angle of arrival offsets between different sub aperture sub frame images to compute a conjugate phase model based on measured angle of arrival offsets to apply this conjugate phase correction model to the SLM to collect full frame full apodized aperture images to supply said full images to an image output channel and to sequentially control and or react to user directed control to select new sub frame regions of interest on which to focus the feedback control circuit processing. The overall goal is to reduce wave front perturbations through aperture apodization removal of perturbation modes and optimize the wave front conjugation that mitigates the effects of diffraction and turbulent distortions on the propagated object scene.

In an alternative embodiment the SLM is absent and the feedback control circuit is programmed only to optimize the variable system aperture apodization setting for the DMD with or without an annular shape. The resulting system will select an optimized effective system aperture diameter based on the current state of turbulence which is determined by feedback based on image quality for a selected sub frame region. In the embodiments with and without the SLM the image quality may be assessed as a sum of squares of image pixel values of a contrast stretched image which thereby reflects the current level of correction of blur quantifying the approach of the system plus atmospheric modulation transfer function toward an optimal setting Alternatively when using the sum of squares methodology the sum of squares image data can be multiplied by a regional weighting function that focuses on a particular portion of the image field. This method permits the Zernike tracking system to selectively enhance different specific portions of the image thereby permitting the system to either focus on a single area of interest or to progressively scan across the full image field and generate a series of image patches that may be stitched together to produce a complete clear image.

The invention may be optionally designed as a surface based imaging system for observing objects within the boundary layer and or surface layer portions of the atmosphere. The preferred embodiments may be operated in concert with post image acquisition processing methods which are capable of further enhancing the obtained imagery.

The embodiments herein and the various features and advantageous details thereof are explained more fully with reference to the non limiting embodiments that are illustrated in the accompanying drawings and detailed in the following description. Descriptions of well known components and processing techniques are omitted so as to not unnecessarily obscure the embodiments herein. The examples used herein are intended merely to facilitate an understanding of ways in which the embodiments herein may be practiced and to further enable those of skill in the art to practice the embodiments herein. Accordingly the examples should not be construed as limiting the scope of the embodiments herein.

The methodology of a preferred embodiment does not utilize any randomized search procedure nor does it utilize any form of specialized emitting source in the object plane. Rather a systematic search technique is proposed in combination with an adaptive aperture control system permitting the collecting of a sequence of sub aperture images constituting a sequence of circular mask images evenly arranged over the region of the main annular mask of a type illustrated in to be used for collecting full frame images typical sets consist of four 4 six 6 or eight 8 sub aperture masks to be sequentially applied by the DMD to collect information regarding the current phase perturbation state around the currently selected annular mask from which a complete phase correction solution can be computed. This optimized approach permits tracking fewer perturbation modes in the controlled adapted apodized aperture at higher levels of turbulence than would be required for an un apodized aperture or a randomized search procedure. A preferred methodology both simplifies the overall problem by restricting the number of active turbulent modes in the adapted aperture and can be handled more efficiently through use of a sampling method using a sequential series of sub aperture sub frame sample images. The rationale for this assessment is that method of the present invention both simplifies the overall problem by restricting the number of active turbulent modes in the adapted aperture and can be handled more efficiently through analysis of the series of sequential sub aperture images. This optimized approach permits tracking fewer perturbation modes at higher levels of turbulence than are sustainable using a full aperture conjugation approach. The addition of inter alia the Digital Micromirror Device forms a critical new element that fundamentally changes the approach to producing the correction for turbulence induced image distortion. The Digital Micromirror Device facilitates the optimized use of a Spatial Light Modulator making the solution simpler to evaluate and the conjugate correction easier to generate. That is any imaging system must balance the rate of acquisition of full frames of image data against the noise produced at a given light level and the image sample dwell time. A given order of turbulence for a given aperture size and shape will require at least one data sample per perturbation term in the aperture. The available light level and the aperture settings determine the ability to correct for a given level of turbulence. The ability to reduce the number of turbulence perturbation modes and to efficiently correct for those modes provide the rationale for the preferred embodiments optimized to light levels for viewing naturally illuminated objects.

When optical turbulence denoted as block is present along the optical path between the object plane and the receiving aperture the presence of refractive turbulence turbulent temperature fluctuations in the atmosphere induce changes in the refractive index of the air shown as block create random small tilts in the propagating direction of photons travelling through the air between the object plane and the system aperture . These tilts cause different photons arriving at different portions of the system aperture to be focused onto different points of the image plane creating a blurred image spot that may also be displaced from its original image point.

Another way of picturing the image distortion effects of the turbulence is by considering the phase perturbations imposed by the atmosphere due to propagation of light from a single image point. In bottom left phase perturbations e.g. are shown pictorially as light and dark patches varying across the system entrance pupil or aperture . The complete aperture has an entrance pupil diameter D . Typical phase perturbations illustrated as a series of patches of type are considered to have a characteristic width termed the turbulent coherence diameter r naught or r . It is common practice to characterize the turbulence impact on a system with aperture diameter D using the ratio X D r. R naught is formally defined as the distance over which the propagating wavefront from a point source decorrelates by a factor of exp 1 . Of particular interest is the performance of a system with no turbulence correction. If no turbulence were present a larger diameter aperture will always resolve greater image detail according to the value of the ratio D which determines the maximum angular frequency resolvable by the system. When turbulence is present though is unchanged the system s ability to image is degraded such that for X D r 3 the system performance actually decreases due to turbulent blur effects when D is increased. This behavior is computed based on the Resolution the integrated volume under the system s Modulation Transfer Function MTF for either short exposure snap shot or long exposure astronomical long exposure imaging cases in . The Response functions are plotted for a standard circular aperture system for varying X parameter values for different imaging scenarios where Q D L is a measure of the diffraction influence on the system.

As illustrated graphically in the peak performance of a system occurs when X is approximately 3. For most imaging applications the Q parameter is between 2 and 6 meaning that for most systems diffraction variations in performance are minimal when X 2.

To understand how the present invention can improve the capability for turbulent phase correction one first must introduce a model for describing perturbations in the system aperture. The most commonly used model is that of Zernike polynomials a set of orthonormal expansion functions for a circular aperture .

With that in mind any true corrections to remove turbulence blur effects will start with the n 2 row of the table. The term Degrees of Correction or DoC denotes the number of Zernike terms being corrected conjugated . This term expresses the concept that the optical system sets a phase adjustment to the SLM that is such that it exactly within the degree capable for the SLM device used removes a given Zernike perturbation component. DoC 3 refers to removal of all n 2 row Zernike elements. DoC 7 refers to removal of all n 2 and n 3 elements. DoC 12 refers to removal of n 2 through n 4 elements. Lastly DoC 0 refers to simply collecting short exposure imagery where no phase conjugation has been applied to remove any perturbations.

These conjugation categories were used by R. Huffiagel Huffiagel R. E. The Probability of a Lucky Exposure Tech. Memo. REH 0155 The Perkin Elmer Corp. 1989 to quantify the ability to avoid turbulent image degradations when a given number of turbulent perturbation modes had been corrected conjugated . A portion of Hufnagel s main figure has been re digitized and re formatted as . Hufnagel s paper considered the problem of acquiring lucky images i.e. images that were substantially free of turbulence induced blur. He distinguished the results he obtained according to the number of degrees of freedom or as in the re interpreted result plotted in the number of degrees of correction DoC partially conjugated or corrected in the imagery collected. Hufnagel s zero DoC line corresponds to acquiring short exposure imagery i.e. no adaptive correction . Hufnagel s calculations indicate a zero DoC system is ineffective beyond X D r 3 corresponding to the peak of the system response curve of . For cases involving adaptive partial conjugation Hufnagel s DoC 3 7 and 12 curves indicate significant improvement is possible even if only some of the active wavefront perturbation modes are corrected. Since the coherence diameter r is proportional to range L to the th power the DoC 3 curve illustrates that for the same degree of resolution as the DoC 0 case the system effective range is double the uncorrected performance actually 1.752 . Hufnagel s DoC 7 curve corresponds to a tripled actual 2.66 range capability while the DoC 12 curve corresponds to an approximately quadrupled actual 3.72 range capability.

Therefore a system that could correct for only 3 7 or 12 Zernike terms could perform imaging tasks out to D rvalues of 5.5 7.5 or 9.5 versus the same performance of the DoC 0 case operating out to D r

Schematically most major active systems can be considered to be represented by an optics diagram of the type shown in . The system contains additional features designed to mitigate turbulence effects beyond the basic system shown in . In addition to the object plane turbulent atmosphere perturbed propagating photons main system entrance pupil and fixed lens system and imaging plane a secondary set of lenses and is used to create a Fourier plane parallel region between them. Light travelling between lens and can have its phase manipulated by a Spatial Light Modulator or other similar phase perturbation means such as for example a deformable mirror. Usage of a deformable mirror or alternatively a spatial light modulator may involve various attempts to adjust a sequence of deformable mirror pistons by performing fluctuations of the current choice of piston settings or alternatively SLM modulations and adaptively modifying the best guess of the correction state based on the outcome of each stochastic perturbation.

In the optical train of provided for the purposes of comparison there may exist several reflecting mirrors as symbolized by the plane mirror guiding the light through the final focusing lens onto the image plane. Not shown in this figure is a sensing system that usually comprises a wavefront sensor WFS typically a Shack Hartmann device or in some cases a Linear Shearing Interferometer or sometimes both. Regardless of the method used to sense the wavefront there is always the requirement that a coherent source must always exist in the object plane or near it in order to provide the known radiation source that can be sensed by the WFS. Without such a known source none of these active methods work. Often such embodiments require a laser source in the vicinity of the scene to be sensed leading to a severe limitation on the utility of such techniques instruments.

Consider next the optical train that is provided by a preferred embodiment of the present invention shown in . In a Digital Micro mirror Device DMD has been located at an image plane of the system entrance pupil such that a point in the entrance pupil will have a corresponding focus point denoted by focusing rays in the Digital Micro mirror Device DMD . To facilitate this goal a second positive lens may be added between the system s main telescope symbolized here as the single lens .

The location of the optical element and the particular values of the focal lengths of the lenses and are instrumental in the operation of the instrument depicted in . illustrates in schematic or abstract fashion a preferred embodiment adaptive optics control system for removing the effects of short exposure image blur of incoherent imaged scenes. The object plane to be viewed is seen through an evolving optically turbulent medium . Rays of light pass through the medium and are randomly delayed as they enter the system s entrance pupil . The system s telescopic or refractive lens optical train is represented in this figure solely by lens . To prepare the incident radiation for the apodizing and phase modulating steps the incident radiation is passed through at least two shaping lenses and . These result in a wave that is propagating approximately as a plane wave that is directed against a Digital Micro mirror Device DMD . Though the shows the passage through the DMD following straight lines in actuality the beam would be reflected from at a finite angle. The plane wave would then be directed against a Spatial Light Modulator SLM further directed through the optical system via one or more reflective surfaces eventually reaching a focusing lens and directed to imaging plane.

The positioning of the DMD is chosen such that the plane of occurs at a real focal plane of the system entrance pupil as denoted by light ray lines .

In brief the upper left portion of schematically illustrates the basic problem to be solved where turbulent phase perturbations of the turbulent atmosphere cause image distortions blur and angle of arrival problems . The aperture in the bottom left corner of schematically depicts or represents the shape and physical extents of these perturbations. The lower right portion of is a diagrammatic attempt to show graphically the pattern of the Zernike polynomials but the representation of these functions is actually much better in the color of the plot. Each Zernike pattern is shown where color is used to show varying function value. Red is positive blue is negative and green is zero. As was pointed above the Zpattern labeled piston along with the tip and tilt terms do not affect image quality. They are labeled with an X in because they do not need to be corrected since they do not impact blur.

Shown in the upper portion of is a preferred embodiment image correction optical system comprising an Adjustable Apodizer AKA DMD optical element . Utilizing DMD the center of the system aperture is variably obscured the descriptions associated with A F illustrate this concept . Given that the center of the aperture can be obscured the benefits include those depicted in box ZR of . Moreover the aperture in the lower leftmost aperture depicts the unobstructed aperture whereas the aperture having the central portion removed represents the obstructed aperture. Note that there are 15 perturbation regions in the leftmost aperture while in the centrally obstructed aperture to the right there are only 9 perturbation regions. Blocking part of the aperture removes perturbations. By so doing the problem of correcting for the turbulence becomes easier by removing several perturbation modes that one no longer needs to track.

The schematic drawing in the lower right section of schematically illustrates this effect as three of the Zernike terms are blocked out with the letter X. The central obscuration is depicted in both the Zrow and the Zrow of the lower right section of . As represented by the arrows with the central obscuration in place the patterns Zand Z Zand Z and Zand Zare virtually identical. That is in representing the aperture it will not be necessary to track all 6 of the identified terms only 3 the other 3 map into the same space as the upper three when the aperture is sufficiently apodized. The arrow pointing from the apodized circle inside the rectangle ZR and the Zernike polynomial representations is designed to indicate that it is common that the phase is expanded in terms of a weighted sum of Zernike terms and that under the circumstances of an apodized aperture fewer terms are needed to represent the same phase pattern.

The upper right section of correlates in part to of the disclosure. Arrows are used to depict the highlights of the phase modulation and apodization control for performing the adaptive part of a preferred embodiment solution. a system block diagram of a preferred embodiment attempts to show how the control flow of the invention would work as opposed to which depicts the general concept of a preferred embodiment optical system.

In the positive lenses and of are expanded as a Cassegrain system telescope and a field lens . . provides a more detailed picture of the functioning of a reflector telescope embodiment of the system.

In light arriving from the object plane passes through the system entrance pupil and is reflected from the telescope s main mirror effectively a positive lens . The light then travels to the secondary mirror where it is again reflected and passes out through the back aperture stop of the telescope . The converging light will eventually reach some focal point natural image plane but before this can occur an additional positive lens is positioned in the optical path to cause the focal point to occur at a shorter range. This causes the light rays emerging from the focal plane to diverge more strongly. Positive lens must be placed prior to the focal point of the exiting rays in order to cause the rays to diverge more rapidly beyond focal point. The reason for requiring this extra lens to be present can be seen in .

This optical system supports the exploitation of the DMD also designated as Adaptive Aperture in the preferred method of blur correction system schematically illustrated in as constructed in accordance with the principles of the present invention.

The Optical System in the embodiment depicted in comprises an optical train including the Telescope and Fixed Optics described previously the adaptive aperture the DMD and hardware interface the adaptive phase an SLM and hardware interface and an Image Capture means. The Adaptive Aperture comprises the DMD and its hardware interface and cabling. One source for DMD devices is Texas Instruments Digital Micromirror Device DMD . A DMD can be connected to a PC class computer using Logic PD s DLP LightCommander Development Kit. The Texas Instruments DLP Kit permits interfacing to the DMD through a PC whereby up to 1792 1 bit black or white XGA resolution 1024 by 768 images can be stored in the system memory. These images can be indexed to permit rapid control of the 1024 by 768 resolution micro mirror surface. The Series 450 DMD micro mirror control permits selection of the reflected region timing of the choice of region selected for reflection and is user controllable.

As described in Wikipedia a digital micromirror device or DMD is an optical semiconductor that is the core of DLP projection technology and was invented by Dr. Larry Hornbeck and Dr. William E. Ed Nelson of Texas Instruments TI in 1987. The DMD project began as the Deformable Mirror Device in 1977 using micromechanical analog light modulators. A DMD chip has on its surface several hundred thousand microscopic mirrors arranged in a rectangular array which correspond to the pixels in the image to be displayed. The mirrors can be individually rotated 10 12 to an on or off state. In the on state light from the incoming ray bundle is reflected into the lens making the pixel appear bright on the screen. In the off state the light is directed elsewhere usually onto a heatsink making the pixel appear dark. The mirrors are made out of aluminum and are around 16 micrometers across. Each one is mounted on a yoke which in turn is connected to two support posts by compliant torsion hinges. In this type of hinge the axle is fixed at both ends and literally twists in the middle. Further according to Wikipedia two pairs of electrodes control the position of the mirror by electrostatic attraction. Each pair has one electrode on each side of the hinge with one of the pairs positioned to act on the yoke and the other acting directly on the mirror. The majority of the time equal bias charges are applied to both sides simultaneously. Instead of flipping to a central position as one might expect this actually holds the mirror in its current position. This is because attraction force on the side the mirror is already tilted towards is greater since that side is closer to the electrodes. To move the mirrors the required state is first loaded into an SRAM cell located beneath each pixel which is also connected to the electrodes. Once all the SRAM cells have been loaded the bias voltage is removed allowing the charges from the SRAM cell to prevail moving the mirror. When the bias is restored the mirror is once again held in position and the next required movement can be loaded into the memory cell. The bias system is used because it reduces the voltage levels required to address the pixels such that they can be driven directly from the SRAM cell and also because the bias voltage can be removed at the same time for the whole chip so every mirror moves at the same instant.

As depicted in in addition to the components of a basic optics system e.g. lenses mirrors and stops three additional elements are used in conjunction with the preferred embodiments which can be used separately or in combination with one another. The first element is a digital micro mirror device e.g. DMD suitably interfaced and connected to a computer or microprocessor control unit into the optical path. This element adapts the shape of the wave front that is permitted to pass through the optical train to the final lens and be focused onto the image plane. The second element is a spatial light modulator SLM or deformable mirrors suitably interfaced to a computer or microprocessor control unit into the optical path. This element controls the phase of the light across the wave front. The third element is a feedback control circuit designed to test the current state of clarity of the images being produced by the current settings of the optical adjustments of the first and second elements. Based on the latest observed clarity previously tested settings and a controller algorithm connected between the feedback circuit and the controlling algorithms running the first and second elements the computer invokes a series of corrective adjustments to the first two elements seeking a best fit to optimize the wave front conjugation that mitigates the effects of diffraction propagation and turbulent distortions.

The feedback system utilizes an analysis of image quality to determine updated settings to apply to the apodization mirror DMD and deformable wavefront corrector e.g. spatial light modulator SLM or deformable mirrors . The wavefront corrector has a surface controlled by a plurality of actuators. These actuators are programmed to approximate a sum of weighted Zernike modes selected to approximate the conjugate of the current short exposure blur deformation to the propagated phase perturbations in the system aperture. Specific settings the phase map are governed by a programmed sequence of perturbations designed to produce a basic estimate of each of N Zernike modes over a series of N 1 sample images. Feedback response is used to selectively modify the mean settings of the Zernike modes according to the current atmospheric state with modifications to the present setting based on response from individual image responses to new modified settings. The system apodization e.g. DMD may be separately tuned to reduce the effective number of Zernike modes that must be tracked by the system. An annular setting on the apodization pattern permits the maximum angular frequency response of the complete system aperture while simplifying the modeling of the Zernike perturbations used to drive the wavefront corrector e.g. spatial light monitor SLM or deformable mirror .

The Adaptive Phase component in may be referred to in conjunction with the terminology wavefront corrector and comprises a spatial light modulator SLM and associated interface hardware. For example Thorlabs sells a kit for an SLM device which could be adapted to provide a prototype device the enabling capability necessary for a proof of principle demonstration of the invention. This SLM is capable of 5 kHz operational variations which is greater than the 1 2 kHz envisioned necessary to support ground level correction of turbulence.

The Image Capture element comprises an imaging camera and associated frame grabber or other hardware interface and associated cabling. An example of the type of camera suitable for development purposes is the Basler Ace acA2000 340kc camera capable of 340 frames per second full image capture rate but also up to several thousand frames per second capture for reduced subframe region of interest image captures. In conjunction with this camera the EPIX PIXCI E8 Frame Grabber with dual coaxial cables provides a data collection capability sufficient to capture the image data produced by the Basler camera.

In addition to the optical system that has been the focus of the discussion up to this point a controller software package including several sub modules will be located on a PC type computer. These sub modules interact through a main controlling software program termed the Master Adaptive Controller . The sub modules of this main control software could potentially be either contained on the same computer or be subtasked to independent micro controllers in communications with the SLM and DMD submodules. These two modules are the Aperture Controller and the Phase Controller . Each module can take simple information produced by the Master Adaptive Controller and translate this information into specific control inputs required by each hardware sub module to set the hardware to its desired dynamic setting.

The Image Capture module contains the camera and frame grabber equipment but it also includes a small module to either a collect a full frame image and pass it out to be displayed to the user or b collect subframe region of interest images and pass these on to the Image Processing module that determines the image state metrics and passes the results of this analysis to the Master Adaptive Controller.

The methods used in the processing of the data as well as the means of modifying the DMD in support of the phase correction solution are next described. Referring to the model of the phase variations present in a system aperture as illustrated in the lower left corner of the perturbations in the phase had a certain characteristic length scale that tended to shrink as turbulence worsened. Here the impact of applying a given aperture mask to that perturbation pattern in the form of an Annular Apodization will be considered.

An alternative choice to the selection of an annular apodization pattern n annular apodization pattern might be to simply choose an apodization pattern that restricts the aperture so only on average a single mode of turbulence is present i.e. X 1 . As shown in graphically in bottom left corner such a choice is close to the diffraction limited behavior that is in the language of the short exposure resolution R approximately equals the diffraction limited behavior of X . But by choosing to stop the aperture down the maximum frequency passed by the system entrance pupil given by D is significantly reduced when the new entrance pupil diameter D may be considerably smaller than the original system diameter D.

An annular apodization pattern has two advantages over an unobstructed circular pattern. First as comparison between right annulus B and bottom left corner reveals by applying a central mask several independent phase perturbation regions will be removed from the central region of the entrance pupil in the illustration six perturbation regions are masked off . This masking reduction simplifies the determination of the dynamic perturbation pattern for a given region of the object plane. Secondly regardless how large the central obscuration is the annular pupil system will always have the same maximum angular resolution as an unobstructed system of the same outer diameter. This is because the outer diameter always determines the maximum angular frequency response. This point is illustrated in which plots the MTF of an imaging system for a central obscuration of relative diameter c D D where Dand Dare the inner diameter and outer diameter in part A .

Referring once again to a preferred embodiment system comprising an SLM for phase correction and a DMD this system is more effective than a system featuring a Wavefront Sensing system since such systems are practically impossible to implement in the atmospheric boundary layer because one can never guarantee the presence of a guide star in the object plane unless one places such a beacon there. In general one must simply use the available light arising from natural scene elements without any artificial augmentation. To exemplify this situation consider the scene illustrated in .

The intent for using such a sub image region in the image plane is to broadly simulate the behavior of a wavefront sensor without requiring the presence of a known light source in the object field. In any event the placement of a single beacon or guide star in the object plane would not be very useful if one wished to generate corrections in different portions of the image plane in moderate to high turbulence. Anisoplanatism in the turbulent field would limit the angular region over which any active beacon correction would be valid since each beacon source is only useful for diagnosing turbulence errors in a relatively small angular region about its own position. Thus for an image containing multiple ROI s such a single known active beacon would be relatively meaningless.

To apply a passive correction several further pieces of information are needed. The first is the time scale in which the atmosphere is expected to vary significantly. A typical number cited is 100 Hz for ground based observations. A number of factors will cause this figure to vary in our favor. One factor is that the wind speed is slowest closest to the ground so that the turbulent field along a given path is replaced more slowly near the surface where ground based sensors are designed to function. Another factor is that the path weighting function for the image distortion and blur effects is largest near the system aperture which will be typically the closest point to the ground due to terrain effects. Finally turbulence is a function of height which is strongest close to the ground which is the source of heating or cooling of the air. Thus the strongest turbulence that has the most effect on the image degradation is also the slowest evolving.

A second factor of consideration is an efficient approach to approximating the function of a wavefront sensor. To address this problem reference is made to part A . If an annular aperture pattern that features a width i.e. D D 2 that is of the order of the coherence diameter is selected then it is expected that phase perturbations across the annulus will be roughly linear but may vary around the annulus. This suggests a pair of relationships. The phase around the inner diameter D and outer diameter edges of the annular region is modeled using the following two formulas 

Here constants A0 through D4 are to be determined. By choosing this model it is possible to include up to 8 perturbation regions around the annulus which is sufficient to correct for the first 12 Zernike terms or effectively cover a quadrupling of the range capability.

From a practical standpoint however the variables and are only placeholders for the actual model of phase we wish to estimate given by 1 where instead of dealing with the inner and outer edge phases the phase about the central ring of the annulus in part A is modeled over which the mean phase is modeled 2 and the radial component of the phase perturbation based on the variable 2

The reason for using a different variable type X versus is that Xcarries a dimension of phase per delta distance. The use of these functions requires a coordinate system in the system annular aperture illustrated in . The radii of the inner diameter D1 and outer diameter D2 are the same as in but the radial variable has been introduced such that 1 along the inner radius and 1 along the outer radius while the azimuthal coordinate has been selected to vary in a clockwise manner.

To measure the tilt in each sub aperture region of the annular aperture a series of sub aperture masks is applied to the aperture in succession. illustrates two examples of subdivision of an annular region into eight sub aperture sampling regions for two different ratios of c D D.

In these figures the dark circular region in the center having diameter D is the central obscuration zone of the main annular aperture. The eight overlapping circles between the inner and outer circles represent the sub aperture circles e.g. A B to be tested in separate rapid image frame captures. Given that the atmosphere is evolving at a rate of 100 Hz the eight 8 images that must be captured to determine the current state of the phase perturbations over the annular aperture mask must be taken at a significantly higher frame rate. The Basler camera cited above can sample at rates above 3 kHz for subframe image acquisition. At a rate of 2 kHz the Basler camera or suitable alternative camera could sample the 8 sub aperture regions in 0.004 seconds a rate fast enough to keep pace with the atmospheric evolution.

To begin prior to each image being sampled the DMD is given a particular sub aperture mask that will include a given sub region of the total annular aperture. There are 8 sub aperture masks total seen along the line of masks indicated by through in but where the gray regions are only to highlight the relative position of the windowed region in white as compared to the original aperture extent bounded by the black regions. For each sub aperture selected a sub frame image is collected as illustrated by Region of Interest in . As shown in because each sub aperture image is being taken through a different portion A B of the overall aperture the apparent location of the main feature of interest in the sub frame will tend to be shifted slightly from image to image due to differences in the wavefront tilt experienced by light arriving from the object field in different portions of the system aperture. This shifting in position can be tracked by using matched filtering techniques that are well known in the image processing field. The result of this pattern matching is that a vector may be assigned in each sub aperture image to the centroid of the main object of interest . This vector points from a specific location on the edge of each sub frame to the apparent centroid of the dominant image feature in the sub frame . The set of eight vectors may be collectively referred to as V where the index variable i varies from 1 to 8 i 1 . . . 8 . Each Vvector is two dimensional. Therefore from 8 sub aperture sub frame images 1 8 one obtains 8 vectors that contain a total of 16 elements of data.

However as was pointed out when discussing the Zernike tip and tilt terms as shown in the overall shift in location of an object does not affect image quality. That is from the standpoint of the above sampled 8 sub aperture images it does not matter where the edge of the sub frame begins since the relative positions are all that matter. One way to remove such shifts in position is to compute and subsequently remove the effects of the origin of such vectors. This is accomplished by computing the mean or average position of the dominant feature. The average is denoted as 8 This mean shift is then subtracted from the raw vectors to produce the perturbation vectors 

Removal of the mean vector however means that the sum of the Vi vectors is now zero and two degrees of freedom have been lost since the sum of the x and y components of the vectors are now separately zero and therefore knowing 7 of the vectors one can always compute the 8th. This might lead to problems because the inner and outer phase models introduced just prior to Equation 1 seem to show eighteen 18 associated coefficients whereas only 14 independent data elements remain. However it will be shown below that at the resolution of our measurements only 10 independent variables are required.

Consider first the mean phase function. When coefficients A0 and C0 from the inner and outer radius phase models are added an average phase is obtained. The tilt created by this average will be zero. It is therefore unmeasureable and is in fact not needed in the correction process it is a piston effect which does not affect image quality .

Next observe that the model of both the sin 1 and cos 1 terms in both the mean and delta terms is generated by a tilt that is constant over the annulus. Thus these terms are eliminated when removing the mean. Therefore anywhere sin 1 and cos 1 terms appear in the mean or delta expansions they may be ignored. The models of the mean and delta terms may thus be written 

To produce the equations for these 13 coefficients one must first translate the measured shifts given in pixels of shift into phase form. First let IFOV denote the instantaneous field of view of a single pixel in radians. Then a relative shift of V pixels will equate to an angular shift of A IFOV V . illustrates the conversion of A to a phase.

If given an angular shift A in the radial delta direction then over a distance in half width between the center of the annulus and the edge A is simply the i th angle of type A the shift that will occur in the wavefront will be A . But a shift of equates to a phase shift of 2 . That is the physical shift translates into a phase shift of A k where k is the wavenumber k 2 . The length is used to denote the physical size of half the width of the annular ring in the SLM where this phase shift must be implemented. 

In general A will not be directed in solely the radial direction. Therefore the radial component of A must be evaluated. In the following discussion these angular vectors shall be denoted A in order to remind us of their vector nature. It therefore remains to determine the radial component of each sample tilt vector. The following symbology is used to represent the dot scalar product between the angular vector and the corresponding radial unit vector pointing from the system aperture center to the center of the sub aperture in the same angular system as in for the i th sub aperture image. Once the component in the radial direction is known one may generate a phase shift for this radial component given by where the i 1 4 i 1 . . . 8. The Xcoefficients thus can be modeled directly and the series of values obtained can be used to compute the expansion coefficients G0 through H4 directly. Note that sin 4 0 at each of the sample locations so no contribution is obtained from evaluating H4. Therefore H4 is set to zero H4 0 .

The process is not as straightforward for the mean phase function. The principle issue is that a tilt is sampled rather than an actual phase. In this case there may be successive azimuthal mean shifts in magnitude between successive sub aperture images. Nonetheless because the mean phase could be removed it means one can always arbitrarily shift the phase pattern produced in the azimuthal direction up or down such that the average is zero. The mean shift removal also removes the first order sine and cosine dependencies. But one must still stitch together subsequent samples of the tilt to produce an overall function that is periodic over 2 it. A typical result is shown in .

To be more specific the azimuthal component of the tilt vector for each sample is written using the following equation Here is the unit vector in the azimuthal direction for the i th tilt sample. Then A is the tilt magnitude in the azimuthal direction for the i th sample. Because turbulence perturbations are typically weak the magnitude of these tilts will not be very large. As can be seen in the sum of these tilts must add to zero for otherwise the curve will not be periodic. To impose this restriction it may be necessary to apply a correction to the set of A s such that the mean tilt can be computed as 8 and a corrected set of tilts can be defined as 

Such a set of azimuthal tilts ensures that any pathological non zero curl cases are eliminated which are mathematically possible but which are meaningless in terms of physically realizable phase models. The reason for their impossibility stems from the fact that the phase is a real valued continuous function. The tilt is a gradient operating on this function. But the gradient of a scalar must have a zero curl.

To construct a phase model illustrated one begins by computing the A components. Then a plot is constructed whose total length is R1 R2 which is the length around the central line Dor of of the annulus. Starting at the origin at the left end of the plot a line is traced to the point R1 R2 16 A 1 R1 R2 16 and continuing for the remaining points across the graph. That is the 8 line segments are concatenated end to end to form a complete azimuthal function. This graph is then equivalent to a functional form that can be mathematically modeled and used to generate the mean phase coefficients through mathematical integration directly or more simply through a quadrature method.

It should be noted however that while it is proposed to automatically remove the mean A by computing this mean there is an independent check of the fidelity of the method. Should this quantity become large it is an indicator that there are phase fluctuations that are not being accounted for in the 8 sub aperture sampling set.

The Texas Instruments Digital Micromirror Device DMD can store approximately 1792 pre loaded digital binary images in XGA format. This suggests that the methodology described previously in this section can be implemented by developing several series of related image mask templates i.e. 1 bit images in XGA format that are downloaded to the DMD .

However these image mask sets perform three separate tasks only two of which have been described so far. The three tasks involve different selections of positions of the windows in the aperture depending on the function and also on the underlying optical telescope for which these operations are performed. Consequently different mask models are needed for both refractor and reflector telescopes without or with a pre existing central obscuration .

Using templates similar to those shown in sets of masks of different sizes and orientations may be generated and loaded onto the DMD. These masks may then be referenced by index number to act as a programmable aperture window function at any time.

The mask set shown in may be used to initialize the system prior to main sub aperture testing phase. This set some 50 to 100 masks in total as the dots indicate intermediate forms of the mask are not shown would be employed to sense the level of turbulence and to select a reasonable initial aperture size based on the transverse coherence length.

The mask set shown in illustrates the most basic annular aperture mask set. It would be the default obscuration approach in which a variable amount of the center of the system aperture would be blocked in producing a variable annulus width. Again there could be approximately 20 of these masks loaded although the precise number may vary as determined by those of ordinary skill in the art without departing from the scope of the invention.

The mask set shown in would be an alternative to the set shown in . Here instead of masking off a variable portion of the center of the aperture but keeping the maximum outer radius if turbulence conditions are strong enough it may be necessary to instead mask off the outer edge of the aperture by a variable amount. Again there could be approximately 20 of these main masks loaded on the DMD although the precise number may vary as determined by those of ordinary skill in the art without departing from the scope of the invention.

The mask set shown in is the series of sub aperture models that would be associated with the main annular mask set shown in . For each main mask of the mask set there need to be 8 sequential masks of the type to provide sub aperture sampling. The mask set shown in serves the same function for the set as the set in serves for the set shown in .

Lastly the set shown in could be used as a further option under extreme turbulence conditions in case the central obscuration of the system was too large to permit characterization of the sub apertures around it.

One might also consider models of 6 sub aperture samples rather than 8 in order to increase system speed and frame rate. The resultant sub aperture models would look similar but would not provide the full angular resolution of the 8 sub aperture sample model.

The aforementioned effects of the atmosphere on a propagating wave and the features of an optical system that could be used to detect and correct for atmospheric phase perturbations motivate a preferred embodiment system that may be utilized for sensing and modeling the atmospheric phase present in the system aperture. In accordance with the principles of the present invention the system s spatial light modulator SLM or deformable mirror can be configured to conjugate this measured or modeled atmospheric phase and significantly reduce turbulent image distortion further down the optical train. However the method for choosing the model of the system mask to be used must first be defined based upon the numerous choices of mask that exist see for example .

For any given range wavelength and turbulence strength a coherence length may be defined 3 and from the data plotted in it is known that the peak of the system resolution curve will occur around X D r 3. Using the series of DMD masks shown in a series of images of a scene may be taken. Let DX i be the equivalent aperture diameter of the i th mask. As long as the objects in the scene are not moving rapidly for each image in the series one may create the sum of squares of the pixel values after adjusting for the mean brightness in an ROI in the image. This sum will be a maximum for the clearest image which will correspond to X 3. For each image DX i will vary but ris expected to be approximately constant this will provide a measure of the coherence length. 20 images of different sizes should suffice. At a 100 frames per second rate this should take 0.2 seconds. This operation will only need be performed occasionally while imaging for example once per minute.

D DX imax is set as the value of DX i that produced the maximum response of the system i.e. i imax . It is anticipated that Dwill be slightly larger than r. One of the annular masks is selected where D2 D1 2 Dfrom one of the annular mask sets from or as illustrated schematically in .

A primary limitation in the choice of the mask that may be used derives from the fact that D1 D2 2 will be the circumference around the mean radius. Under the assumed constraints the system must not require that more than 8 sample images be taken around that circumference. This implies that 8 2 D 8 D2 D1 must not be less than it D2 D1 2 or 21 21 16 Each aperture mask will thus have a restriction on the range of its D1 and D2 diameters as well as an average mask size that is related to the full aperture size. Overall Procedure

 A Downloading a series of aperture mask patterns to the DMD Aperture controller optionally selectable using an index number to the Aperture Controller 

 B Selecting the aperture wherein 1 the master adaptive controller or equivalent directs the adaptive aperture controller or equivalent to select one of a series of aperture masks of the type illustrated for example in 2 The master adaptive controller or equivalent directs the Adaptive Phase Controller or equivalent to set the SLM to neutral no phase adjustment .

 D Transferring the image to the image processing module or equivalent and producing a vector set of image quality metrics.

 E Determining the suitability of the current type mask by using the master adaptive controller or equivalent .

 F Repeating steps A through E directing different choices of type aperture masks until it determination of an optimum aperture mask that maximizes resolution.

 H Using the master adaptive controller or equivalent and the optimum type mask size DR the master adaptive controller or equivalent sets the choice of main annular mask based on a choice of one of the model masks from or annular mask sets.

 I Using the master adaptive controller or equivalent selecting a region of interest ROI in the image frame ROI s should cycle through the complete image but may focus on active areas exhibiting changing characteristics from full frame to full frame .

 J Using the master adaptive controller or equivalent directing the adaptive aperture control or equivalent to select one of the 8 sub aperture masks associated with the main annular mask model determined in Step H above.

 L Using the master aperture control or equivalent directing the image processing module or equivalent to load the i th sub aperture frame and through pattern matching compare this sub aperture frame to the other 7 sub aperture frames.

 M Using the image capture module or equivalent capturing an image and passing the sub frame image to the image processing module or equivalent .

 N Using the image processing module or equivalent upon receipt of all 8 sub frame sub aperture images performing pattern matching and vector generation tasks as described in the foregoing. The perturbation vector information V is passed back to the master aperture control or equivalent .

 O Computing the phase model of the phase correction using the master aperture control or equivalent in conjunction with the V image metric data passed back by the image processing module or equivalent . The conjugate of this information is passed to the Adaptive Phase Controller which translates this information into a phase model that is then set on the SLM .

 P Using the master aperture control or equivalent directing the adaptive aperture controller to select the complete annular aperture mask.

 Q Using the master aperture control or equivalent directing the image capture module to collect a full frame image using a full frame sampling dwell time of 1 200second and making the resulting full frame image available to an external monitor.

Steps I through Q are repeated for numerous full frame images. Recomputation of the turbulence state following the aperture selection procedure of steps B through H is accomplished periodically perhaps every 10 15 20 30 or 60 seconds depending on the statistical fluctuations of turbulence effects.

The preferred embodiments are effective in reduction of turbulence effects such as short exposure blur image distortion through angle of arrival variations scintillation effects and image decorrelation anisoplanatism . The importance of these effects depends on their path weighted impacts. For ground based sensors however short exposure blur effects are dominant. illustrates the weighting functions of different turbulence effects blur angle of arrival scintillation and anisoplanatism . For this daytime slant path case the area under the blur curve is significantly greater than that of any other effect. Also note that the weighted effect is significantly focused near the 0 end of the non dimensional path where 0 is at the system receiving aperture and 1 is at the object plane. Because the blur effect is strongly dependent on turbulence close to the aperture i.e. nearer to the ground the wind speed causing turbulence evolution will be slower thus reducing the temporal tracking requirement.

The rate of evolution of turbulence features and their effects on image phase perturbations can also be gauged relative to several features. Referring back to the diagram of the Zernike polynomials it was noted that in Tofsted D. H Outer scale effects on beam wander and angle of arrival variances Appl. Opt. 31 5865 5870 1992 hereby incorporated by reference the angle of arrival term tip and tilt terms or n 1 row were dominated by the length of the outer scale of turbulence. Typical values of the outer scale are on the order of 10 m. For a typical crosswind speed between 1 and 2 m s this means the evolution rate for the tip and tilt line of the Zernike diagram is of the order of 1 2 Hz for transit of a significant portion of a wavelength . Analysis of the focus and astigmatism terms is shown in which shows the weighted impact of turbulent spatial frequencies of wavenumber normalized relative to the system diameter D. This graph reveals that the most significant wavelength affecting focus and astigmatism is approximately 3 times the diameter.

Hence for a system aperture of 10 cm the most significant wavelength is 30 cm. At a crosswind speed of 1.5 m s this most significant wavelength evolves at a rate of 10 20 Hz. Hence the evolution rate of turbulence is higher for higher order Zernike terms but the higher order terms have less and less effect on the overall phase. Generally the evolution rate of 100 Hz is considered typical for ground based sensors. The proposed system is designed to provide corrections within this time scale. In effect the passive equivalent of an active type wavefront sensor is produced under conditions where wavefront sensing systems are effectively infeasible.

This system thus has the capability to perform corrections rapidly and the capacity to control both the system aperture thus removing certain turbulence modes as well as providing a means of correcting the phase which will produce a clean er image than could be produced by simply reducing the aperture size.

In the preferred embodiment system no external radiation of energy is necessary. It thus is not a search light or laser illuminating system which reduces the number of systems with which it might be compared greatly. Likewise the system is designed to address a limited topic namely the correction of received imagery for the effects impacts of optical turbulence and primarily the impacts of image blur that has a path weighting function that is focused just in front of the receiving aperture. Also our system is primarily for use in ground level observation. It thus does not involve mounting the device on an aircraft or moving rapidly through the atmosphere.

These considerations significantly reduce the number of practical systems that may have a similar claim to solving the turbulence problem for ground based sensors. Nevertheless the resulting problem space is not a simple one and involves the worst case scenario a ground based sensor observing distant objects through the heaviest strength turbulence in the atmosphere. This problem is variously titled the deep turbulence problem or alternatively the candlestick problem because of the shape of the 3D atmospheric envelope where systems sensors can viably operate. In this alternative picture a near surface observer can view objects vertically through the atmosphere at much longer ranges than can be done for horizontal paths.

One key to the preferred embodiment system is that no artificial guide star is used. The system is thus truly passive as no illumination beacon is propagated. For Army applications this means that our system is as stealthy as practical.

By not relying on a guide star the preferred embodiment system is not based on the detection of a coherent wavefront. The system of the present invention is significantly different from other systems because it does not require the usage of a Shack Hartmann wavefront sensor or any other kind of wavefront sensing device. Indeed incoherent radiation from any naturally illuminated or self radiating source does not have a wavefront that can be characterized by any practical wavefront sensor. This is very important because our sensor can thus function with natural illumination while other correction methods cannot.

A system developed in accordance with the principles of the present invention provides a way for sequential compensation for turbulence effects in different portions of an imaged scene. Active or glint based systems are only truly able to correct for the portion of a scene that contains the guide star or glint itself and may be restricted to a region of only a few centimeters about that main region due to the impacts of anisoplanatism in moderate optical turbulence. Conversely the fact that turbulence close to the system aperture causes the greatest blur means that the preferred embodiment system corrects for turbulent perturbations that have the greatest overlap for different portions of the imaged scene.

A further innovation derives from how the proposed passive system goes about determining the correction it applies to its SLM. Prior art has typically relied on a method termed the SPGD Stochastic Parallel Gradient Descent method. The SPGD method essentially attempts to guess the appropriate settings to place on the SLM to effect the adaptive correction. It then uses a feedback loop to decide how well its latest guess was at correcting for the current state of the atmosphere. Consequently an SPGD system is limited by several considerations. First system performance is limited by frame rate. The shorter the dwell time of each frame the noisier the image will become. Second the selected size of the system aperture is subject to two competing optimizations. A larger aperture will allow more light to enter reducing noise and therefore permitting shorter dwell times per image frame. However turbulence near the system entrance pupil causes the light entering the system to experience different transit time delays at different points in the aperture creating a wave that becomes increasingly difficult to focus increased blur . In terms of a functional analysis of the incident wavefront a larger system aperture requires more Zernike expansion terms to describe the wavefront. But even an efficient sampling system would require roughly as many image samples as there are Zernike components in the incident wavefront in order to successfully analyze it. The SPGD system being merely a guessing hunting technique is far less efficient than a straightforward analysis such as is achieved by the Shack Hartmann wavefront sensing technique. Thus to support an SPGD based passive correction system would require an imager capable of sampling tens of thousands of frames per second under high turbulence ground to ground imaging conditions. What is needed is an efficient imaging system that is capable of both reducing the complexity of the imaging problem through a reduction in the number of active Zernike modes and that uses a more efficient search algorithm than the SPGD method.

The system of the present invention is optimized to require a minimum number of image samples to be collected in order to track the evolving state of the turbulent atmosphere. The result is reduced overall noise.

A further innovation is based on an exploitation of a feature of the aperture apodization technique. Because an annular aperture is formed using the DMD 1 the number of active Zernike modes in the remaining aperture is reduced thereby reducing the number of sample images that must be collected in order to make a current atmospheric state analysis and 2 the means of analyzing the phase perturbations present in the aperture is simplified producing a method that can track the atmospheric perturbations even more efficiently than a simple circular aperture. The reason the number of active Zernike modes is reduced is because the annular shaped apodization pattern effectively causes a number of Zernike modes to map onto one another. It therefore makes the process of assessing the state of the turbulent blur perturbations easier.

Moreover an annular aperture also allows the system to have a larger effective aperture for a given pupil area. That is for a given number of active Zernike modes because the annular aperture causes certain modes to overlap one another for a given total area assuming the same number of modes per unit area an aperture with a hole in the center will feature an overall wider outer radius. But the maximum angular frequency response of the system depends on the maximum diameter passed. Therefore an annular aperture of equal area as a circular aperture will always feature a higher maximum frequency response and therefore a greater image resolution all other things being equal. And with greater angular frequency resolution overall an annular system s range capability is automatically greater than that of a circular aperture system of equal area.

Another innovation is the placement of the system apodization control device the DMD inside the system optical train. This appears to be unique i.e. using a DMD to provide automatic aperture apodization control. Also because a DMD is used the speed of the aperture response is virtually instantaneous. This permits the system to perform a series of aperture adjustments for studying the properties of turbulence arriving at various portions of the system aperture in a manner analogous to the wavefront sensing techniques used in active systems but where the DMD is substituted for the operations of the Shack Hartmann sensor.

The apodization control both limits the degree of complexity of the atmospheric correction problem to facilitate the correction sensing process and optimizes both the solution speed and frequency response function of the system. To achieve this apodization control the DMD is used as a surrogate for the actual system aperture is if the DMD is placed at a real image plane of the system aperture. The mechanism whereby this real image plane can be formed is by using at least two positive lenses. The first of these lenses must be placed close to the exit pupil of the system s telescope prior to its natural focal point so that the focal point is shortened creating a more rapidly diverging wave subsequent to the focal point. This beam is then passed through a second positive lens that produces a parallel beam similar to the wavefront upon entry through the system s entrance pupil prior to reaching the first primary mirror. The DMD is then placed at a focal point of the system aperture so that when the DMD aperture is modified it cuts off an equivalent amount of light from the original wave entering the system.

Attention is now turned to the question of the feasibility of the method itself to track either 7 or 9 Zernike terms providing corrections sufficient to remove these terms from the incident phase front. To address this issue this is first discussed in general terms the nature of the problem being addressed and the expected rate of evolution of the various terms.

Considering the previous scenario assuming a wind speed at 2 m equal 2rn s. This is a nominal speed often seen on hot desert days when turbulence strength is highest. Under this condition the most effective wavelength for impacting focus and astigmatism would evolve at 2.0rn s 0.3 m or 6.7 Hz. For a 1 m outer scale the tip and tilt variations would occur at a rate of approximately 2 Hz. Hence successive rows of Zernike polynomials appear to exhibit increasing rates of evolution. Conversely higher order terms appear to have a diminishing effect on image clarity. Thus the job of tracking perturbations should be within the realm of the achievable given an imaging system that can operate at a frame rate 10 20 times faster than the rate of evolution sufficient to produce several guesses of the correct current settings of the Zernike coefficients within the evolution timeframe of each evolving term to be tracked.

Note that the effects of anisoplanatism objects extending to dimensions larger than an isoplanatic region affect every adaptive system creating independently wandering patches of the imaged object in the image plane. Therefore any imaging system may need to be augmented by a separate image post processing system that stitches clear sub images together i.e. a lucky patch technique and dewarping of the image. However such a system is inadequate to remove the impacts of short exposure blur which is the principle objective of the current invention. Based on the scenario outlined above one expects that for the indicated turbulence level the value of the parameter X will be somewhere between 5 and 15 indicating that the performance of any lucky image based system will be severely degraded by the atmospheric scenario presented.

Equally true for active adaptive systems involving laser illumination of an object plane one of two situations will occur Either the illumination pulse will be focused within a single isoplanatic region on the object plane or it will not. The first case may also be considered to include the case of an active illuminator placed directly at the object plane to serve as a guide star type source. If the first instance occurs then the active imager s wavefront detection based solution will be strictly applicable only for the particular isoplanatic patch from which the guide beacon emerges. If the second instance obtains then the active imager s solution will be derived from multiple independent isoplanatic regions exhibiting independent statistics making it difficult to imagine how the solution from these independently emitting regions can produce anything resembling a coherent wave at the receiver system s aperture suitable for analysis by a Shack Hartmann wavefront sensor. Hence although a passive sensor system might initially appear inferior to an active adaptive system for extended scene objects which are larger than the isoplanatic patch size a non illuminating passive approach appears at least as reasonable and entailing less risk than any active system approach.

Also included in are lines extending from the outer edges of the entrance pupil to outer edges of the viewed object. These extended lines illustrate that there is a region of the path in which lines from opposing sides of the aperture pass through approximately identical optical turbulence particularly turbulence of the size scales that most affect the lowest order modes of the Zernike perturbation expansion functions. This region is approximately of length and represents a greater or lesser portion of the path depending on the extent of separation of the points considered in the object plane. However notice that for the scenario considered above a region consisting of a single isoplanatic patch of dimension 5 cm is a size that is less than the diameter of the aperture and thus corresponds in the figure a region of extent connected to the aperture via dashed lines . For such a section of the image the corresponding atmospheric elements accounting for virtually all of the blurring effects over this section are identical for this section of the object plane. A passive system could thus be directed by a control software program to direct its blur corrections to addressing a single portion of the image and systematically work to improve image quality over a mosaic of the object plane in any sort of static imaging scenario. For dynamically varying portions of any object scene it would be possible to track these dynamic elements by focusing the system s correction attentions on a particular portion or even a dynamically changing portion.

It is noted that the assemblies described herein could work in association with either a reflector telescope or a refractor telescope. In addition the reflector system with reflector mirror objective or refractor telescope system with refractor lens or off axis mirror without central obstruction combination could be connected to either a DMD only embodiment or a DMD SLM embodiment thereby creating four possible embodiments. That would seem to make 4 possible embodiments etc. In addition a preferred embodiment could operate with a deformable mirror instead of the SLM in addition to the DMD . A preferred embodiment combination may operate using a control software operating using a single sum of squares metric for the full image or b control software operating using a sum of squares metric multiplied by a Gaussian window focusing on a portion of the image frame. A preferred embodiment combination DMD only embodiment or a DMD SLM embodiment may optionally include a system in which the user may select a region of interest for weighted improvement scheme. Optionally a preferred embodiment combination DMD only embodiment or a DMD SLM may optionally include mosaicing software to merge image portions. Optionally a preferred embodiment combination DMD only embodiment or a DMD SLM may optionally include monitoring software to assess portions of an image frame which appear to have significantly changed triggering focused relook and update. Optionally a preferred embodiment combination DMD only embodiment or a DMD SLM may optionally include image dewarp procedure applied to deblurred image.

As used herein the terminology target means a person or persons or portion thereof animal or animals thing object or a combination thereof.

As used herein the terminology point of interest or points of interest refer to an signature or area in the image which appears to be a target but may or may not be a target i.e. potentially the point of interest may be a target subject to further processing or testing.

As used herein the terminology adjustable apodizer includes but is not limited to the Digital Micro mirror Device DMD . One key to the adaptive aperture controller or DMD is that the center of the system aperture is variably obscured.

As used herein the terminology processor includes computer controller CPU microprocessor multiprocessor minicomputer main frame personal computer PC coprocessor and combinations thereof or any machine similar to a computer or processor which is capable of processing algorithms.

As used herein the terminology apodization means changing the shape of a mathematical function an electrical signal or an optical transmission.

As used herein the terminology the terminology process means an algorithm software subroutine computer program or methodology.

As used herein the terminology target signature means the characteristic pattern of a target displayed by detection and identification equipment.

As used herein the terminology algorithm means sequence of steps using computer software process software subroutine computer program or methodology.

As used herein the terminology optical train or optical assembly means the arrangement of lenses and or elements to guide light through the system to form an image at the image plane. The position and angle of lenses or elements may be adjustable to guide light along the optical path.

As used herein the terminology plane of incidence is the plane spanned by the surface normal to the optical axis. In wave optics the latter is the k vector of the incoming wave.

As used herein the terminology image plane means the plane in which an image produced by an optical system is formed if the object plane is perpendicular to the optical axis the image plane will ordinarily also be perpendicular to the axis. As used herein the terminology principal plane means a plane that is perpendicular to the axis of a lens mirror or other optical system and at which rays diverging from a focal point are deviated parallel to the axis or at which rays parallel to the axis are deviated to converge to a focal point.

The foregoing description of the specific embodiments are intended to reveal the general nature of the embodiments herein that others can by applying current knowledge readily modify and or adapt for various applications such specific embodiments without departing from the generic concept and therefore such adaptations and modifications should and are intended to be comprehended within the meaning and range of equivalents of the disclosed embodiments. It is to be understood that the phraseology or terminology employed herein is for the purpose of description and not of limitation. Therefore while the embodiments herein have been described in terms of preferred embodiments those skilled in the art will recognize that the embodiments herein can be practiced with modification within the spirit and scope of the appended claims.

