---

title: Asymptotically optimal modulation classification method for software defined radios
abstract: A method for identifying the modulation scheme of a software defined radio in real-time without pilot symbols between transmitters and receivers, includes providing a predetermined look-up table (LUT) in the software-defined radio wherein the LUT is prepared by pre-calculating discrete likelihood ratio test (DLRT) function values; storing the pre-calculated DLRT values in said LUT; and indexing the pre-calculated DLRT values by addresses.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08750425&OS=08750425&RS=08750425
owner: The United States of America, as represented by the Secretary of the Army
number: 08750425
owner_city: Washington
owner_country: US
publication_date: 20120503
---
This application is a continuation of and claims priority to U.S. patent application Ser. No. 12 590 862 issued as U.S. Pat. No. 8 223 890 that was filed on Oct. 30 2009.

The invention described herein may be manufactured used imported sold and licensed by or for the Government of the United States of America without the payment to me of any royalty thereon.

The present invention is directed to a likelihood test based modulation classification method used for identifying the modulation schemes of a software defined radio SDR in real time without a pilot symbol or any hand shaking between the transmitter and the receiver. The invention is also directed to an asymptotically optimal estimation approach using pre calculated look up tables for rapid processing.

With the revolution of digitizing communications ever closer to the antenna software defined radios SDRs with programmable modulation schemes and transmission rates have become a practical wireless communication platform. The concept is to exploit the radio transmission environment and choose the best modulation scheme to maximize the channel capacity and minimize the interferences in real time. The general principles of SDRs and modulation classifications or schemes are presented in the following publications which are incorporated herein in their entirety Y. Huang and A. Polydoros Likelihood methods for MPSK modulation classification. . vol. 43 1493 1504 J. Sills Maximum likelihood modulation classification for PSK QAM. 99 1999 57 61 K. Umebayshi et al. Blind estimation of the modulation scheme adapted to noise power based on a concept of software define radio in Proc. in European Wireless 2002 EW2002 pp. 829 834 2002 02 O. Menguc and F. Jondral Air interface recognition for a software radio system exploiting cyclostationarity in Proc. of the 15th IEEE Personal Indoor and Mobile Radio Communications Vol. 3 September 2004 pp. 1947 1951. When the signal data transmitted frame by frame the modulation scheme in each data frame was chosen depending upon the channel SNR. The adaptive modulation scheme maintains the bit error rate BER below a certain threshold to ensure the quality of service QoS in data transmission. In pilot symbol based adaptive demodulation a known pilot symbol is used in the transmitted data frame to indicate the modulation scheme for proper demodulation at the receiver. The disadvantage is that the pilot symbol occupies the bandwidth. In order to eliminate the pilot symbol and use the bandwidth efficiently some research works have been conducted to migrate the military modulation classification techniques to commercial applications in selecting the modulation schemes automatically and blindly without the redundant pilot symbols.

The transmitted radio frequency RF signal should be demodulated at the receiver in real time to ensure the continuous communication. However the prior art automatic modulation classification methods are developed for signal surveillance purposes which does not intend to demodulate the signal on the fly. Those methods are extremely time consuming and complicated so that a large delay is introduced in computation and data processing. This delay may cause data collisions in the real time transmission and degrade the QoS.

This invention proposes a rapid processing and classification method to solve the time consuming and computationally intensive problems.

The present invention is directed to a demodulation device comprising means for preparing a symbol corresponding to a signal means converting said symbol to an address of a predetermined look up table LUT means for loading the pre calculated values of the test functions for the likelihood ratio test and means for producing the estimated modulation scheme in real time.

In one embodiment a system is disclosed comprising an implementation that is at least in part a hardware implementation. The implementation is configured to load an address that is mapped to a signal with an unknown modulation scheme into a first look up table to produce a first result as well as load the address into a second look up table for a second result wherein the first look up table and the second look up table are not the same look up table. The implementation is also configured to determine a first value that corresponds to the address in the first look up table and determine a second value that corresponds to the address in the second look up table. The implementation is configured to make a decision on a selected value from among the first value and the second value and designate a modulation scheme associated with the selected value as a modulation scheme for the signal.

In one embodiment a system is disclosed comprising a radio that loads an address that is mapped to a signal with an unknown modulation scheme into a first look up table to produce a first result and loads the address into a second look up table for a second result wherein the first look up table and the second look up table are not the same look up table. The radio also determines a first value that corresponds to the first result and determines a second value that corresponds to the second result. In addition the radio makes a decision on a selected value from among the first value and the second value and designates a modulation scheme associated with the selected value as a modulation scheme for the signal.

In one embodiment a storage medium is disclosed that is encoded with a software program where execution of the software program causes implementation of a method the method comprising loading an address that is mapped to a signal with an unknown modulation scheme into a first look up table wherein a first value is produced from the loading with regard to the first look up table. The method also comprises loading the address into a second look up table for a second value wherein a second value is produced from the loading with regard to the second look up table and wherein the first look up table and the second look up table are not the same look up table. In addition the method comprises making a decision on a selected value from among the first value and the second value and designating a modulation scheme associated with the selected value as a modulation scheme for the signal.

The software defined radio can further comprise means for data processing. At least one software program can be included in the data processing means for implementing operation of the various means of the software defined radio. The software defined radio can include at least one storage medium. The at least one software program can be encoded in the at least one storage medium. The storage medium can also be pre loaded with the pre calculated values of the test functions for the discrete likelihood ratio test DLRT . In a preferred embodiment the at least one software program can be configured and adapted for determining the estimated modulation scheme in real time when the likelihood ratio test function is a maximum

The present invention is also directed to a method for processing and classifying an unknown modulation scheme in a signal received by a software defined radio comprising preparing a symbol corresponding to the signal converting said symbol to an address of a predetermined look up table LUT loading the pre calculated values of the test functions for the likelihood ratio test and demodulating the data in real time.

In another preferred alternative embodiment of a method of the present invention preparing a symbol includes preprocessing the signal. Also converting the symbol comprises quantizing the signal and mapping the symbol to a predetermined set of L number of parallel LUTs or number of hypothetical modulation schemes. Converting the symbol can also comprise normalizing the signal before quantization and address mapping. The L number of hypothetical modulation schemes is several of a plurality of modulation schemes including at least PSK4 PSK8 PSK16 QAM8 QAM16 QAM 32 and QAM 64.

In another preferred embodiment of a method of the present invention producing the estimated modulation scheme comprises providing parallel accumulators adapted and configured to calculate the likelihood ratios associated to the L number of hypothetical modulation scheme hypotheses.

Preferably the method further comprises determining the modulation scheme when the likelihood ratio test function is a maximum. In preparing the LUT the method comprises pre calculating a discrete likelihood ratio test DLRT function without depending on the input data storing the pre calculated DLRT values in said LUT and indexing the pre calculated DLRT values by addresses.

In an alternative embodiment of the present invention the method for identifying the modulation scheme of a software defined radio in real time without pilot symbols between transmitters and receivers comprises converting an unknown signal symbol to an address of a look up table loading the pre calculated values of the test functions for the likelihood ratio test and demodulating the data in real time.

The method for identifying the modulation scheme of a software defined radio in real time can further comprise providing a means for data processing. At least one software program can be provided in the data processing means for implementing operation of the software defined radio. The software defined radio can include at least one storage medium encoded with the at least one software program. The storage medium also can be pre loaded with the pre calculated values of the test functions for the discrete likelihood ratio test DLRT .

In yet another alternative embodiment the method further comprises configuring and adapting at least one software program for determining the estimated modulation scheme in real time when the likelihood ratio test function is a maximum. The method can further comprise using the estimated modulation scheme in real time to choose a demodulator in the software defined radio for signal demodulation.

In known SDR systems the automatic modulation classification can be described as a statistical process in estimating the modulation scheme of an unknown signal based on multiple matching templates. The goal is to identify the modulation scheme of a transmitted signal with a high probability of success within a short observation time. A common practice is to embed an automatic modulation estimator into the receiver of a SDR . The modulation estimator works in parallel with a programmable demodulator in the receiver as shown in . A frame of signal data is transmitted in radio frequency RF through the air and the modulation scheme of the data frame of the RF signal is determined by the transmitter and is not known at the receiver. The receiver collects the RF signal from an antenna and preprocesses such as frequency down conversion band pass filtering analog to digital conversion phase and timing synchronizations etc. it to baseband signal for demodulation . Since the modulation scheme is not known the preprocessed signal data frame is stored in a delayer memory to wait for the demodulation decision from the automatic modulation classification. At the same time the preprocessed digital baseband signal is fed to the automatic modulation classification processor and the modulation scheme of the transmitted data frame is classified and the software defined demodulator will be cued to change the demodulation scheme accordingly. Then the data frame in the delayer is released for demodulation process . If the signal delay is sufficiently small or the modulation classification processing is sufficiently fast the real time data output is achieved at the receiver.

Automatic modulation classification is a critical component in estimating the unknown modulation scheme so that an appropriated demodulator is used to demodulate the signal. Average logarithmic ratio test ALRT is a very popular prior art and is an optimal method to automatically classifying linear modulation schemes including various phase shift keying PSK and quadrature amplitude modulation QAM . The ALRT treats a noisy preprocessed signal symbol denoted by r k as a random variable this random valuable is compared with Mnumber of known values denoted as b j 1 2 . . . M under the ihypothesis H. The errors between the r k and bare assumed to have Gaussian distributions and the logarithmic likelihood test function is formed using the joint probability distribution functions PDFs described by 

1. It is computationally intensive. The statistical estimation usually involves massive additions multiplies and exponential logarithmic calculations.

2. It is time consuming in calculation. The computation in Equations 1 and 2 are very difficult to be implemented in parallel or be calculated off line.

This invention unlike the prior art converts an unknown signal symbol to an address of the look up table loads the pre calculated values of the test functions for likelihood ratio test and produces the estimated modulation scheme in real time. The estimated modulation scheme is used to choose the appropriate demodulator in the software defined radio for signal demodulation. This invention proposes an asymptotically optimal classification method for rapid processing and classification of the unknown modulation schemes. A discrete likelihood ratio test DLRT function is proposed such that the values of the DLRT function can be pre calculated without depending on the input data. These pre calculated values are stored in a look up table LUT and are indexed by addresses. A preprocessed digital baseband data a symbol is quantized and mapped to an address which points to a set of L number of parallel LUTs. The pre calculated DLRT values are loaded from L LUTs based on the address for likelihood ratio test. Most of computations are done off line and the real time process are in a parallel structure. The modulation scheme is estimated and fed to demodulation process and an appropriate demodulator is chosen at the SDR for the realtime demodulation of the transmitted signal.

 1 L number of hypothetical modulation schemes such as PSK4 PSK8 PSK16 QAM8 QAM16 QAM 32 and QAM 64 are chosen by assuming the modulation scheme of the transmitted signal fits one of the hypotheses. The constellation point b i 1 2 . . . L and j 1 2 . . . of the ihypothetical modulation scheme is established based on known definition and the constellation points are normalized to unity average power. The expected range of the signal to noise ratio is chosen based on the application so that the expected range of the normalized two sided power spectral density of the additive white Gaussian noise can be calculated.

 2 A 3D grid with Q Q U number of cells is established as shown in . The cell is addressed by indices p 1 2 . . . Q q 1 2 . . . Q and u 1 2 . . . U. Therefore the pqu cell is bounded by interval in x axis interval in y axis and interval in z axis as shown in . The values of Q and U are determined by user based on the resolution requirement and complexity of the hypothetical constellation. The larger the values of Q and U the more expansive the LUT. The value of is determined such that the expected range of the normalized amplitude of the unknown input and all the normalized hypothetical modulation constellations are bounded by interval in both x axis and y axis and lies at the center of the x y coordinate . The value of is determined such that the expected range of the normalized two sided power spectral density is bounded by the interval .

 3 A value of the LUT is calculated by denoting xas the center of the pelements between interval in x axis yas the center of the qelements between interval in y axis and zas the center of the uelements between interval in z axis that is 

Notice that for the ith hypothesis Hi the value of Tis determined by three indices p q and u of the address cell and depends neither on time index k nor on the value of r k . Therefore it can be calculated off line and stored in the LUT used for real time process.

Under the definition of the Q Q U grid address structure and LUTs for every hypotheses the digitized complex valuable r k sampled after the matched filtering at the receiver is normalized to the unit average power and quantized by Q Q grid. The real value of the quantized and normalized r k corresponds to an appropriate index p the imaginary value of the quantized and normalized r k corresponds to an appropriate index q and the estimated value of q is normalized to the average signal amplitude and quantized by U grid. The quantized and normalized q corresponds to an appropriate index u. Therefore the inputs r k and map to the indices p q and u of the pqu th cell which are used to load the value of i 1 2 . . . L.

Denote T k as the value of Tloaded at the instance k the likelihood test function of the quantized r k can be calculated by accumulating all the values of Tloaded from the LUT for all instances that is k 1 2 . . . K. Mathematically 

Therefore the decision of modulation classification is made based on the criterion choose i I 1 I L as the modulation scheme if L H r k is a maximum. The likelihood ration function L H r k can be calculated using parallel accumulators to speed up the process. The estimated modulation scheme is reported and fed to the demodulation process at the SDR for choosing an appropriate demodulator. The transmitted signal with unknown modulation scheme is demodulated in real time.

where D p 1 2 . . . Q q 1 2 . . . Q u 1 2 . . . U is the number of element of the quantized r k for k 1 2 . . . K that falls into the pq th cell which can be obtained by applying the joint histogram operation to the quantized r k . The joint histogram is constructed from a density table with the intervals shown on the x y axis and the number of occurrences in each x y interval represented by the height of a rectangular bin located above the x y interval.

Equation 6 implies that the likelihood test function of Hcan be approximated by the summation of Q Q product terms each term is the average template of PDF in the pq cell multiples the number of occupancy of Tin the pq cell denoted by D. Since Dis the joint histogram of r k with Q Q bins. Equation 6 acts as the correlation of the joint histogram of r k and the logarithmic joint PDF of the templates of the ihypothetical modulation scheme. If the resolution of the grid is sufficiently small the histogram quantization periods approaches the sampling periods the joint histogram approaches the joint PDF and the results of the histogram test approach the results of the ALRT that is 7 

The rapid automatic modulation classification method can be implemented either in software or hardware. The software implementation can be developed by using Equation 6 by first calculating the joint histogram Dof the signal with unknown modulation scheme and then correlating it with L known templates denoted by T for maximizing the likelihood function L H r k . The modulation scheme is determined if the associated likelihood ratio is a maximum.

The hardware implementation of the rapid automatic modulation classification process is described by a conceptual block diagram in . The RF signal is collected from an antenna pass through a preprocessing procedure. The preprocessing can be implemented using various existing methods which may includes band pass filters frequency down conversion with coherent local oscillator a matched filter and the pulse timing . The noise power is estimated . Both the signal symbol from the matched filter and estimated noise are normalized and quantized by the Q Q U grid scale to obtain indices p q and u. Those indices provide an address used to load the values of the pre calculated likelihood ratio functions from L number of parallel LUTs . The values from LUTs are sent to parallel accumulators Acc to calculate the likelihood ratios associated to the L hypotheses. A decision is made after the maximum likelihood ratio test. Confidence check is conducted. If the confidence level is below the given threshold determined by user the estimation is failed. Otherwise the estimated modulation scheme is reported and fed to a demodulation process e.g. the demodulation process of after choosing an appropriate demodulator e.g. the demodulator of . The demodulation process is not shown in .

If dimension of the hypothesis set is large overlapped subsets are recommended to group the hypothetical modulation schemes requires the similar bit error rate in order to achieve the better performance. demonstrates an example with hypotheses of PSK2 PSK4 PSK8 QAM16 QAM32 and QAM64. The RF signal is collected from an antenna pass through a preprocessing procedure as described in the last example in . A threshold is introduced to separate SNR to high and low . Both the signal symbol from the matched filter and estimated noise power are normalized and quantized by Q Q U grid scale to obtain the indices p q and u. Those indices give an address used to load the values of the pre calculated likelihood ratio functions from L parallel LUTs . With the high SNR the values from LUTs of PSK8 QAM16 QAM32 and QAM64 hypotheses are loaded. Or with the low SNR the values from LUTs of PSK2 PSK4 PSK8 and QAM16 hypotheses are loaded. It is remarkable that the hypotheses of PSK8 and QAM16 is overlapped to both high and low SNR in order to provide a buffer area between two groups to improve the classification result. The values of LUTs are sent to L parallel accumulators Acc to calculated the likelihood ratios associated to L hypotheses. A decision is made after the maximum likelihood test . Confidence check is conducted. If the confidence level is below the given threshold determined by user the estimation is failed. Otherwise the estimated modulation scheme is reported and fed to demodulation process after choosing an appropriate demodulator . The demodulation process is not shown in .

The overlapped subsets concept relaxed the crowdedness of the hypothetical set reduced the computational complexity and increase the calculation speed by eliminating the unnecessary hypothesis and increased the estimation reliability by large the distance between modulation features. More than two overlap sets may be used if needed.

The automatic modulation classification method of the present invention is also discussed in Real time Modulation Classification Based on Maximum Likelihood by Wei Su Jefferson L. Xu and Mengchu Zhou. This publication was presented to the IEEE with a publication year of 2008 and is incorporated herein in its entirety. Further discussion of software defined radio and modulation recognition is presented in Software Defined Radio Equipped with Rapid Modulation Recognition by Jefferson L. Xu Wei Su which is also incorporated herein in its entirety.

The transmitted signal is sent frame by frame a block . The modulation scheme in every frame is determined by the transmitter and may be different at each frame. The modulation scheme in the received data frame is not known at the receiver in non cooperative SDR and it needs to be identified in real time. The automatic modulation scheme is built into the software defined radio to classify the modulation scheme so that the demodulator in the SDR is cued to choose an appropriate demodulator. Hence the signal is demodulated in real time. The invention proposes a rapid processing automatic modulation classification process with asymptotically optimal estimation performance to overcome the computational extensive and time consuming processing issues in the prior art.

This invention has commercial applications in developing the next generation software defined radios with automatic modulation scheme classification capability and has military application in developing faster signal identification systems.

The preferred embodiments of the present invention described above are not intended to limit the applicability of the present invention. Rather a person skilled in the art would appreciate that various modifications of the arrangements and types of components and steps described would fall within the scope and spirit of the claimed invention. Accordingly all expedient modifications readily attainable by one of ordinary skill in the art from the disclosure set forth herein or by routine experimentation therefrom are deemed to be within the spirit and scope of the invention as defined by the appended claims.

