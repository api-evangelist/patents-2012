---

title: Method, system and apparatus for dynamic quality of service modification
abstract: A method and apparatus for dynamically modifying the quality of service (QoS) provided to a mobile communication device are disclosed. In one embodiment, a mobile communication device comprises a secure channel driver operable to establish a secure tunnel between the mobile communication device and a remote network via a wireless network, the secure tunnel operable to support multiple sockets opened therein; a first application operable to communicate with the remote network via a first socket within the secure tunnel and associated with a first QoS; a second application operable to communicate with the remote network via a second socket within the secure tunnel and associated with a second QoS, different from the first QoS; a QoS monitor operable to identify when the second QoS is appropriate to support the second application; and a QoS modification module operable to request the second QoS from the wireless network.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08730972&OS=08730972&RS=08730972
owner: BlackBerry Limited
number: 08730972
owner_city: Waterloo
owner_country: CA
publication_date: 20120417
---
This nonprovisional application is a continuation application claiming the benefit of the following prior United States patent application entitled Method System and Apparatus for Dynamic Quality of Service Modification filed Apr. 4 2007 application Ser. No. 11 732 565 the contents of which are incorporated herein by reference.

The present disclosure generally relates to wireless packet data service networks. More particularly and not by way of any limitation the present disclosure is directed to a mobile communication device and related data service network capable of updating the quality of service provided to the mobile communication device as required.

The present disclosure is directed toward efficient utilization of wireless resources for communication between a network and a mobile communication device. The resources available for wireless communication are necessarily limited. It is therefore desirable to provide only the resources required for a given communication in order to conserve and optimize available bandwidth. To this end certain wireless messaging networks provide for a default quality of service QoS . Although this default quality of service is generally suitable for certain types of communications it may not be suitable for other types of communication.

A system and method of the present disclosure will now be described with reference to various examples of how the embodiments can best be made and used. Identical reference numerals are used throughout the description and several views of the drawings to indicate identical or corresponding parts wherein the various elements are not necessarily drawn to scale.

The present disclosure relates to a device method and system for dynamically modifying a quality of service QoS level within a wireless packet data service network. According to a first embodiment a mobile communication device comprises a secure channel driver operable to establish a secure tunnel between the mobile communication device and a remote network via a wireless network the secure tunnel operable to support multiple sockets opened therein a first application operable to communicate with the remote network via a first socket within the secure tunnel and associated with a first QoS a second application operable to communicate with the remote network via a second socket within the secure tunnel and associated with a second QoS different from the first QoS a QoS monitor operable to identify when the second QoS is appropriate to support the second application and a QoS modification module operable to request the second QoS from the wireless network.

In certain embodiments the quality of service monitor is further operable to identify when the second quality of service is no longer appropriate. In other embodiments the quality of service modification module is further operable to request the first quality of service from the network when the second quality of service is no longer appropriate. In other embodiments the mobile communication device may comprise a virtual private network VPN driver operable to open and close at least the first and second sockets within the secure tunnel.

In another embodiment a method operable on a mobile communication device comprises establishing a secure tunnel between the mobile communication device and a remote network via a wireless network the secure tunnel operable to support multiple sockets opened therein opening a first socket within the secure tunnel the first socket communicating with a first quality of service opening a second socket within the secure tunnel determining that a second quality of service different from the first quality of service is appropriate to support communication via the second socket and requesting from a network node associated with the wireless network the second quality of service.

According to another aspect a mobile communication device includes a secure channel driver operable to establish a secure channel between the mobile communication device and a remote network via a wireless network the secure channel operating to support an end to end secure tunnel a first client application operable to communicate with a first server application via the secure tunnel and associated with a first quality of service a second client application operable to communicate with a second server application via the secure tunnel and associated with a second quality of service different from the first quality of service a quality of service monitor operable to identify when the second quality of service is appropriate and a quality of service modification module operable to request the second quality of service from the wireless network when the second quality of service is appropriate.

In certain embodiments the first application is one of a messaging application a contacts management application a calendar management application or a browser application. In certain embodiments the second application is one of a streaming audio client a streaming video client a VoIP client or an FTP client. In certain embodiments the wireless network is a GSM network or others such as an Enhanced Data Rates for GSM Evolution EDGE network an Integrated Digital Enhanced Network IDEN a Universal Mobile Telephone System UMTS network a Code Division Multiple Access CDMA network or any 3rd Generation 3G network. In certain embodiments the quality of service monitor and quality of service module comprise a portion of a transport stack within the mobile communication device.

Referring now to the drawings and more particularly to depicted therein is an exemplary network environment including a wireless packet data service network wherein an embodiment of the present system may be practiced. An enterprise network which may be a packet switched network can include one or more geographic sites and be organized as a local area network LAN wide area network WAN or metropolitan area network MAN et cetera for serving a plurality of corporate users.

A number of application servers through N disposed as part of the enterprise network are operable to provide or effectuate a host of internal and external services such as email video mail Internet access corporate data access messaging calendaring and scheduling information management and the like. In particular application server is a messaging server and is a streaming video server. Accordingly a diverse array of personal information appliances such as desktop computers laptop computers palmtop computers et cetera although not specifically shown in may be operably networked to one or more of the application servers i 1 2 . . . N with respect to the services supported in the enterprise network .

Additionally a remote services server may be interfaced with the enterprise network for enabling a corporate user to access or effectuate any of the services from a remote location using a suitable mobile communication device . Mobile communication device may be any communications device capable of communicating via wireless means including but not limited to a cellular telephone a wireless personal digital assistant a wireless pager or a wireless enabled laptop computer as examples. By way of example mobile communication device may be a data enabled handheld device capable of receiving and sending messages web browsing interfacing with corporate application servers et cetera. A secure communication link with end to end encryption may be established that is mediated through an external IP network i.e. a public packet switched network such as the Internet as well as the wireless packet data service network operable with mobile communication device via suitable wireless network infrastructure that includes a base station BS . In one embodiment a trusted relay network may be disposed between the Internet and the infrastructure of wireless packet data service network .

For purposes of the present disclosure the wireless packet data service network may be implemented in any known or heretofore unknown mobile communications technologies and network protocols. For instance the wireless packet data service network may be comprised of a General Packet Radio Service GPRS network that provides a packet radio access for mobile devices using the cellular infrastructure of a Global System for Mobile Communications GSM based carrier network. In other implementations the wireless packet data service network may comprise an Enhanced Data Rates for GSM Evolution EDGE network an Integrated Digital Enhanced Network IDEN a Universal Mobile Telephone System UMTS network a Code Division Multiple Access CDMA network or any 3rd Generation 3G network. By way of providing an exemplary embodiment the teachings of the present disclosure will be illustrated with a GPRS based carrier network although those skilled in the art should readily recognize that the scope of the present disclosure is not limited thereby.

It is well known that GPRS uses a packet switching technique to transfer both high speed and low speed data and signaling in an efficient manner over GSM radio networks. Packet switching means that GPRS radio resources are used only when users are actually sending or receiving data. Rather than dedicating a radio channel to a mobile data user e.g. mobile communication device for a fixed period of time the available radio channels can be concurrently shared between several users. Therefore GPRS is designed to support from intermittent and bursty data transfers e.g. web browsing to occasional transmission of large volumes of data e.g. File Transfer Protocol FTP communications . Allocation of GPRS radio channels can be flexible from 1 to 8 radio interface timeslots can be allocated per one Time Division Multiple Access TDMA frame. Typically timeslots are shared by the active users and uplinks and downlinks are allocated separately. Various radio channel coding schemes are available to allow a range of data bit transfer rates.

Two additional network nodes are provided within a GSM network in order to implement a packet switched data transfer service. A Serving GPRS Support Node SGSN which is coupled to a Home Location Register HLR and disposed at the same hierarchical level as a Mobile Switching Center MSC of the circuit switched cellular network not shown is operably coupled to base station and keeps track of the location of a GPRS user such as the user of mobile communication device . Further SGSN is responsible for performing security functions and handling access control with respect to mobile communication device . A Gateway GPRS Support Node GGSN provides interworking with the internet and is operably coupled to one or more SGSNs e.g. SGSN via an IP based GPRS backbone network.

In order to access the packet data service mobile communication device makes its presence known to the network by performing what is known as a GPRS Attach. Thereafter to send and receive packet data mobile communication device activates the packet data address that it wants to use. This operation renders mobile communication device visible in the corresponding GGSN and interworking with external data networks can then begin. User data is transferred transparently between mobile communication device and the external data networks with a method known as encapsulation and tunneling wherein data packets are equipped with GPRS specific protocol information and transferred transparently between mobile communication device and GGSN .

A second integration layer B is provided for interfacing between the transport stack and a number of user applications supported on mobile communication device which include messaging client calendar scheduler client contacts management client browser streaming video client streaming audio client VoIP client and FTP client . It will be understood by those of skill in the art that mobile communication device may include more applications or fewer applications. Although not specifically shown the transport stack may also be interfaced with the operating system of mobile communication device . In another implementation the transport stack may be provided as part of a data communications client module operable as a host independent virtual machine on a mobile device.

The bottom layer Layer 1 of the transport stack is operable as an interface to the wireless network s packet layer. Layer 1 handles basic service coordination within the exemplary network environment shown in . For example when mobile communication device roams from one carrier network to another Layer 1 verifies that the packets are relayed to the appropriate wireless network and that any packets that are pending from the previous network are rerouted to the current network. The top layer Layer 4 exposes various application interfaces to the services supported on the mobile communication device. The remaining two layers of the transport stack Layer 2 and Layer 3 are responsible for datagram segmentation reassembly and security compression and routing respectively.

Mobile communication device incorporates a QoS monitoring module and a QoS modification module . It will be understood by those of skill in the art that the separate modules are depicted in this manner only for convenience and that the functionality represented by these modules will generally be incorporated into one of the other modules depicted in . QoS monitoring module incorporates the functionality to determine the current and immediate future QoS needs of mobile communication device . QoS modification module incorporates the functionality to modify the QoS when needed. The manner of operation of each of QoS modules is discussed in further detail below.

A microprocessor providing for the overall control of an embodiment of mobile communication device is operably coupled to a communication subsystem which includes a receiver and transmitter as well as associated components such as one or more local oscillator LO modules and a processing module such as a digital signal processor . As will be apparent to those skilled in the field of communications the particular design of the communication module may be dependent upon the communications network with which the mobile communication device is intended to operate.

In one embodiment the communication module is operable with both voice and data communications. Regardless of the particular design however signals received by antenna through base station are provided to receiver which may perform such common receiver functions as signal amplification frequency down conversion filtering channel selection analog to digital A D conversion and the like. Similarly signals to be transmitted are processed including modulation and encoding for example by digital signal processor and provided to transmitter for digital to analog D A conversion frequency up conversion filtering amplification and transmission over the air radio interface via antenna .

Microprocessor also interfaces with further device subsystems such as auxiliary input output I O serial port display keyboard speaker microphone random access memory RAM a short range communications subsystem and any other device subsystems generally labeled as reference numeral . To control access a Subscriber Identity Module SIM or Removable User Identity Module RUIM interface is also provided in communication with the microprocessor .

In one implementation SIM RUIM interface is operable with a SIM RUIM card having a number of key configurations and other information such as identification and subscriber related data. Operating system software and transport stack software may be embodied in a persistent storage module i.e. non volatile storage such as flash memory . In one implementation flash memory may be segregated into different areas e.g. storage area for computer programs as well as data storage regions such as device state address book other personal information manager PIM data and other data storage areas generally labeled as reference numeral . QoS monitor and QoS modification module are also shown disposed in flash memory though those of skill in the art will appreciate that these components could be disposed in alternate locations.

Within mobile communication device applications which include messaging client calendar client contacts client browser client streaming video client streaming audio client VoIP client and FTP client are operably connected to session management SM layer via socket application programming interface API and virtual private network VPN driver . SM layer in turn communicates with base station via radio layer .

QoS monitor module and QoS modify module are operably connected to SM layer VPN driver and socket API as well as to one another. In certain embodiments all or a portion of these modules may be disposed within transport stack described above. In alternate embodiments all of these modules may be disposed external to transport stack . Those of skill in the art will appreciate that the above described modules are intended to represent particular functions and the functions represented may be embodied within more or fewer logic modules in a given application. The interaction and functional behavior of these modules is described in detail in connection with below.

After initial handshaking with GGSN is complete mobile communication device can contact enterprise network via VPN accumulator in order to establish the secure communications tunnel. This communication is represented by message from VPN driver to VPN accumulator and message from VPN accumulator to VPN driver . After this handshaking process is complete communications between mobile communication device and enterprise network will be encrypted between VPN driver and VPN accumulator . This means that GGSN and other nodes along the communication path between mobile communication device and enterprise network will not have access to the content of the communications between mobile communication device and enterprise network . GGSN will not therefore have access to sufficient information to modify the QoS provided to mobile communication device in order to provide an optimal level of service to mobile communication device . If the communications between mobile communication device and enterprise network were not encrypted GGSN would be able to identify when the nature of the communications between mobile communication device and enterprise network are such that a higher QoS is necessary. Owing to the fact that these communications are encrypted GGSN has no such ability to monitor the type of communications being shared and to adjust the QoS as necessary.

In order to allow for a dynamic QoS capable of being adjusted on demand the present disclosure provides for additional functionality within mobile communication device suitable for requesting a different QoS when suitable and for returning to the default QOS when the default QOS is more suitable. In the embodiment shown in VPN driver is operable to open multiple sockets within the secure tunnel as necessary to close sockets as appropriate and to modify the QoS provided to mobile communication device as required by the demands of the applications running on mobile communication device .

Subsequent to the establishment of the secure tunnel between mobile communication device and enterprise network messaging client requests a socket via VPN driver . This is represented by message from messaging client to socket API and message from socket API to VPN driver . Upon receipt of the request VPN driver compares the details of the socket request to the current QoS provided by GGSN . If VPN driver determines that a different QoS is suitable VPN driver can request a different QoS from GGSN . If VPN driver determines that a different QoS is not suitable VPN driver will not request a different QoS from GGSN . In the present case VPN driver has determined that the service demands of messaging client fit within the presently provided QoS. Accordingly VPN driver will not request a different QoS from GGSN . VPN driver acknowledges the request as represented by message from VPN driver to socket API and message from socket API to messaging client . Once the socket is opened messaging client and messaging server can communicate as represented by message from messaging client to messaging server and message from messaging server to messaging client .

Subsequently streaming video client requests a socket from VPN driver . This is represented by message from streaming video client to socket API and message from socket API to VPN driver . In this case based on the characteristics of the request VPN driver will determine that a different QoS is set in order to conduct this communication. In this case a higher QOS is required. This may be for example a request for a socket suitable for VoIP or streaming video. It will be clear to those of skill in the art that a wide variety of communication types might require a different QoS than that required for messaging or browsing.

Whatever the details of the communication VPN driver will need to request the modified QoS from GGSN in order to open a socket having the requested characteristics. VPN driver first acknowledges the socket open request from streaming video client as represented by message from VPN driver to socket API and message from socket API to streaming video client . Then VPN driver requests the modified QoS from GGSN as represented by message from VPN driver to session management layer and message from session management layer to GGSN .

In certain cases the communication between mobile communication device and enterprise network may be initiated prior to the acknowledgment by GGSN of the modified QoS. This is represented by message from streaming video client to streaming video server . Subsequent to the initiation of the communication GGSN modifies the QoS and acknowledges the modification to mobile communication device as represented by message from GGSN to session management layer and message from session management layer to VPN driver .

Having established a secure channel having an acceptable QoS for streaming video traffic streaming video server and streaming video client conduct a streaming video session as represented by message from streaming video server to streaming video client and message from streaming video client to streaming video server . Once the streaming video session is complete streaming video client notifies VPN driver via socket API that the enhanced QoS is no longer necessary. This is represented by message from streaming video client to socket API and message from socket API to VPN driver . VPN driver then acknowledges the notification as represented by message from VPN driver to socket API and message from socket API to streaming video client .

After receiving the notification of reduced QoS requirements VPN driver notifies GGSN of the reduced requirement as represented by message from VPN driver to session management layer and message from session management layer to GGSN . GGSN then acknowledges the notification as represented by message from GGSN to session management layer and message from session management layer to VPN driver .

In block the most suitable QoS is determined. Process flow from decision block depends upon whether there is a match between the QoS most suitable and the QoS provided. If there is a mismatch process flow proceeds to block wherein a QoS modification is requested. If there is not a mismatch process flow proceeds directly to block where the requested socket is opened.

At a later point in time a request is received to close the socket as represented by block . The QoS that will be required once the socket is closed is determined in block . Process flow from decision block depends on whether there is a match between the resources which will be most suitable after the socket is closed and the current resources provided. If there is a mismatch between the suitable resources and the resources provided process flow proceeds to block where a QoS modification is requested. If there is not a mismatch process flow proceeds directly to block where the socket is closed.

It is believed that the operation and construction of the embodiments of the present disclosure will be apparent from the Detailed Description set forth above. As noted above while the foregoing disclosure explicitly relates to the use of a Virtual Private Network VPN as an example those of skill in the art will appreciate that the arrangement and methodology disclosed therein is generally applicable to architectures employing a number of different types of secure communication channels including but not limited to virtual private networks. While the exemplary embodiments shown and described may have been characterized as being preferred it should be readily understood that various changes and modifications could be made therein without departing from the scope of the present disclosure as set forth in the following claims.

