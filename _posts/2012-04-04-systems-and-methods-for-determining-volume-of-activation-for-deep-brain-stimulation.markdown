---

title: Systems and methods for determining volume of activation for deep brain stimulation
abstract: This document discusses, among other things, systems and methods for determining volume of activation for deep brain stimulation (“DBS”) using a finite element model (FEM) circuit to determine a FEM of an implanted electrode and a tissue medium in which the electrode is implanted, a Fourier FEM solver circuit to calculate a potential distribution in the tissue medium using information from the FEM circuit and a capacitive component of at least one of the implanted electrode and the tissue medium, and a volume of activation (VOA) circuit to predict a VOA using the potential distribution and a neuron model.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09020789&OS=09020789&RS=09020789
owner: The Cleveland Clinic Foundation
number: 09020789
owner_city: Cleveland
owner_country: US
publication_date: 20120404
---
This patent application is a continuation of U.S. patent application Ser. No. 11 715 829 filed Mar. 8 2007 which claims the benefit of priority under 35 U.S.C. Section 119 e to McIntyre et al. U.S. Provisional Patent Application Ser. No. 60 743 445 entitled SYSTEMS AND METHODS FOR DETERMINING VOLUME OF ACTIVATION FOR DEEP BRAIN STIMULATION filed on Mar. 9 2006. This patent application is also a continuation in part application of U.S. patent application Ser. No. 13 087 587 filed Apr. 15 2011 which is a continuation of U.S. patent application Ser. No. 12 287 471 filed Oct. 9 2008 which is a continuation of U.S. patent application Ser. No. 12 070 521 filed Feb. 19 2008 now U.S. Pat. No. 7 904 134 which is a continuation of U.S. patent application Ser. No. 10 885 982 filed Jul. 7 2004 now U.S. Pat. No. 7 346 382.

The subject matter described herein was made with support from the U.S. Government under funding provided by National Institutes of Health NIH Grant Numbers NS 50449 and NS 52042. The United States Government may have certain rights to the invention.

This patent application pertains generally to neurosurgery and more particularly but not by way of limitation to systems and methods for determining volume of activation such as for deep brain stimulation DBS .

Deep brain stimulation DBS has rapidly emerged as an effective clinical treatment such as for movement disorders thereby revolutionizing the field of functional neurosurgery and virtually replacing tissue ablation for the treatment medically refractory movement disorders. However little is known about the neural response or therapeutic mechanisms of the stimulation. The subthalamic nucleus STN represents a target for DBS electrodes. However the STN is a small nucleus surrounded by a variety of fiber tracts many of which are responsible for stimulation induced side effects.

The present inventors have recognized that there exists a significant need to characterize the effects of DBS on the underlying neural tissue and to improve or optimize electrode design to enhance the therapeutic effectiveness of DBS which represents a therapy for essential tremor Parkinson s disease dystonia and other movement disorders. In addition DBS may be useful in the treatment of epilepsy obsessive compulsive disorder and depression. However the understanding of the neural effects of DBS are limited and significant opportunities exist to improve or optimize electrode design to enhance therapeutic effectiveness. To address these issues we have developed computational tools such as to predict the neural response to stimulation.

In an illustrative example electrostatic approximation can be applied in neural stimulation modeling by treating the electrode as a perfect current source and the neural tissue as a purely conductive medium. However clinical DBS electrodes are typically voltage controlled use an asymmetrical biphasic stimulus waveform and are generally surrounded by a three dimensional 3D anisotropic inhomogenous tissue medium. Failing to account for these conditions can lead to overestimating the volume of activation VOA e.g. by 30 compared to voltage controlled stimulation for typical therapeutic stimulation parameter settings. This overestimation is generally directly related to the electrode capacitance and the stimulation pulse width. Thus there exists a need among other things to accurately predict the effects of DBS.

To more accurately model DBS the present inventors have developed among other things a finite element model FEM of the electrode and tissue medium. A Fourier FEM solver determines the potential distribution in the tissue in time and space concurrently. In certain examples electric field data from the determined potential distribution can be coupled to a multi compartment neuron model to predict neural activation or determined extracellular voltages can be applied to detailed multi compartment cable models of myelinated axons to determine neural activation. Generally neural activation volumes can be calculated as a function of one or more stimulation parameters and a magnitude of one or more capacitive components of the tissue electrode interface.

This overview is intended to provide an overview of the subject matter of the present patent application. It is not intended to provide an exclusive or exhaustive explanation of the invention. The detailed description is included to provide further information about the subject matter of the present patent application.

The following detailed description includes references to the accompanying drawings which form a part of the detailed description. The drawings show by way of illustration specific embodiments in which the invention may be practiced. These embodiments which are also referred to herein as examples are described in enough detail to enable those skilled in the art to practice the invention. The embodiments may be combined other embodiments may be utilized or structural logical and electrical changes may be made without departing from the scope of the present invention. The following detailed description is therefore not to be taken in a limiting sense and the scope of the present invention is defined by the appended claims and their equivalents.

In this document the terms a or an are used as is common in patent documents to include one or more than one regardless of other instances where one or more or at least one are recited. In this document the term or is used to refer to a nonexclusive or such that A or B includes A but not B B but not A and A and B unless otherwise indicated. Furthermore all publications patents and patent documents referred to in this document are incorporated by reference herein in their entirety as though individually incorporated by reference. In the event of inconsistent usages between this document and those documents so incorporated by reference the usage in the incorporated reference s should be considered supplementary to that of this document for irreconcilable inconsistencies the usage in this document controls.

Generally a first step toward understanding the effects of deep brain stimulation DBS includes characterizing the electric field and volume of tissue activated by the stimulation. The electric field is typically dependent on the shape of the electrode and the electrical conductivity properties of the tissue medium. In addition when using a voltage controlled stimulation as can be the case with certain clinical DBS systems the electrode capacitance can substantially affect the time course and amplitude of the stimulus waveform. As such the present inventors have developed among other things a DBS modeling system that in certain examples can integrate time dependent components of an applied electric field and the three dimensionally complex anisotropy and inhomogeneity of the tissue electrical properties to predict the volume of activation VOA as a function of the stimulation parameters.

In an example neural stimulation was estimated with an integrated computer model that combined a finite element based electric field solution with a multi compartment cable model of myelinated axons. In this example the Poisson equation was solved to determine voltage within the tissue medium and then interpolated onto cable model neurons. The cable models were used to define threshold values of the stimulation voltage for generating action potentials. Then activating function values were determined from a second difference of the voltage solution at the stimulation threshold for each axon at the site of action potential initiation. Finally in this example the activating function values were coupled to an analytical function providing a spatial map for predicting VOA which can be displayed to a clinical user.

At an activating function relationship was determined. The activating function relationship displays activating function values and a resulting power relation or other fit as a function of a threshold characterized by the relationship

At the activating function values were coupled to an analytical function e.g. a bioelectric field solver such as BioPSE Scientific Computing and Imaging Institute that provided a predicted spatial map for the VOA using information from the activating function relationship .

In an example three dimensionally complex tissue anisotropy and inhomogeneity can be incorporated into the computer implemented model such as by using conductivity tensors which can be derived from human diffusion tensor magnetic resonance images DTI of the STN and surrounding structures.

At the anatomical volumes of the thalamus and the STN are shown co registered with the electrode and a first selected region of conductivity tensors .

At the electrode is shown surrounded by a set of selected regions of conductivity tensors representing a highly complex 3D anisotropic and inhomogeneous tissue medium.

In an example a Fourier FEM can separate the stimulus waveform into component frequencies can solve the Poisson equation at a particular component frequency by using a complex stiffness matrix e.g. that includes a reactive component rather than merely including conductive components can scale or phase shift the results and can reassemble the time dependent solution.

At the FEM can be solved using a computer providing a potential distribution as a function of space at each frequency component of the solution. An example of the potential distribution at is shown at a second contact of an electrode .

At the relationship can be recorded. The relationship includes an FEM waveform shown in relation to time ms and voltage V . In this example the inverse Fourier transform of the FEM solution generated the stimulation voltage as a function of space and time in the tissue medium surrounding the electrode e.g. the nervous tissue of the brain .

Using the examples of methods discussed above the present inventors have recognized among other things that including capacitive effects of DBS can substantially affect the estimated VOA for a stimulation. For example the present inventors have recognized that electrostatic models of DBS will tend to overestimate VOAs. In certain examples the amount of error caused by the electrostatic approximation can depend on electrode capacitance or stimulation pulse width. As an illustrative example suppose that the capacitance of a DBS electrode can be 3.3 F. Further suppose that a clinically effective stimulus pulse duration can range from 60 450 s. The largest electrostatic model errors typically occur when using longer pulse widths or smaller electrode capacitance values. Smaller capacitance values can cause the model to have a shorter time constant which can magnify the amount of the electrostatic error. Additionally larger electrostatic model errors typically occur when using larger stimulation voltages.

Generally theoretical analysis of neural stimulation yields the following 1 the electric field generated by the stimulation typically depends on the shape of the electrode the distribution of cathode s and anode s and the biophysical properties of the tissue medium and 2 the neural response to the applied electric field is generally related to the second spatial derivative of the extracellular potentials distributed along a neural process.

Certain models of neurostimulation ignore the effects of electrode and tissue capacitance instead treating the electrode as a perfect voltage or current source and the surrounding tissue as a purely conductive medium this can be referred to as a quasistatic or electrostatic assumption . The errors induced by this assumption may be significant in certain forms of neurostimulation such as brain stimulation where even small changes e.g. 1 mm in the spread of activation can have dramatic consequences on desired therapeutic effects or on undesired side effects induced by the stimulation. Thus to quantitatively evaluate the volume of tissue activation VTA or VOA as a function of the stimulation parameters the present inventors have provided a model that can accurately account for one or more such components of neurostimulation.

Neurostimulation devices can use current controlled or voltage controlled pulse generators. In certain examples such as during reversible non faradic reactions at the electrode tissue interface electrode capacitance can influence the electric field transmitted to the tissue during voltage controlled stimulation and conversely tissue capacitance can influence the electric field transmitted to the tissue during current controlled stimulation. These reactive components can affect the shape and amplitude of the stimulus waveform delivered to the tissue medium and can modulate the neural response to the applied electric field. Previously ignored these capacitive components of the electrode tissue interface may be useful in more accurately estimating the VTA or VOA.

The present inventors have developed an integrated spatiotemporal model of current controlled or voltage controlled neurostimulation such as in the context of DBS that quantifies the activation of axons surrounding the electrode. Myelinated axons typically represent highly excitable neural elements surrounding an extracellular stimulating electrode. The therapeutic response to DBS is typically linked with axonal activation.

In an example determining the role of capacitance on the volume of axonal tissue activated with clinical DBS parameters can use a computer model of neurostimulation that integrates finite element based electric field solutions and multi compartment cable models of myelinated axons.

In an example the Poisson equation was solved with the Fourier FEM to determine the voltage distribution in the tissue medium which was then interpolated onto the model axons. These model axons were used to search for threshold stimulus amplitudes for generating action potentials. This model can be used to predict the individual or combined effect of electrode capacitance and bulk tissue capacitance on neural activation such as in using DBS electrodes in the context of voltage controlled or current controlled stimulation.

As an illustrative example axisymmetric finite element models of DBS electrodes were created using multiphysics modeling software e.g. FEMLAB 3.1 COMSOL Inc. Burlington Mass. . The example of the model included variable resolution meshes of 13 201 nodes for monopolar stimulation and 17 229 nodes for bipolar stimulation. In this example the axisymmetric volume conductor measured 10 cm tall by 5 cm wide. The tissue medium was at least initially modeled as homogeneous and isotropic with conductivity of 0.3 S m a representative value for brain tissue. The electrode geometry was based on the Medtronic 3387 89 DBS electrode having the contact dimensions 1.5 mm height and 1.27 mm diameter. Voltage or current sources were specified at the electrode contact and the electrode shaft was modeled as an electrical insulator. The Poisson equation was solved using direct matrix inversion e.g. UMFPACK solver at various component frequencies of the stimulus waveform to determine the potential distribution V generated within the tissue medium stiffness matrix based on a collection of sources I Eq. 1 

In a monopolar stimulation example to mimic the effects of an indifferent return electrode ground nodes were placed around the exterior boundary of the finite element mesh. In a bipolar stimulation example a second electrode was added with a 1.5 mm gap between contacts and the ground nodes were removed from the exterior boundary of the finite element mesh. Dirichlet and von Neumann boundary conditions can be imposed to control voltage or current values at the electrode surface and to confine current flow to within the finite element model respectively.

The Fourier FEM can be used to calculate time dependent and space dependent voltages within bioelectric volume conductors. This can include four parts for a particular solution see e.g. . First the stimulus waveform to be applied through the electrode contact can be constructed in the time domain. The stimulus can include an arbitrarily complex waveform. Second the waveform can be converted from the time domain to the frequency domain such as by using a discrete Fourier transform DFT . This can be accomplished using simulation software e.g. Matlab Mathworks Natick Mass. which can provide the magnitude and phase of a set of frequency components that correspond to the time domain stimulus. Third the Poisson equation can be solved at one or all of the frequency components of the DFT such as by using direct matrix inversion. A Poisson equation with purely conductive elements and does not allow reactive components represents an electrostatic solution. To address this a complex stiffness matrix i can be constructed that takes into account the capacitive components of the electrode tissue or both. The result at each component frequency can be scaled and phase shifted such as by using the results of the DFT. Fourth the resulting waveform can be converted back to the time domain such as by using an inverse Fourier transform provided by simulation software e.g. Matlab . As an illustrative example solutions can be calculated at 1024 frequencies between 0 and 1 2 dt Hz where dt specifies the waveform time step size of 1 10s for voltage controlled stimulation and 1 10s for current controlled stimulation.

The capacitance value for a DBS can be approximated as 3.3 F. In an example the capacitance values of 3.3 F 1.65 F and 6.66 F were tested such as to characterize the sensitivity of the results on the value of this parameter. The electrode can be treated as purely capacitive with reversible non faradic reactions occurring at the electrode tissue interface. The tissue capacitance value for neural tissue can be estimated with upper and lower bounds for the dielectric constant K between 1 10and 1 10for frequencies below 1 kHz. The relationship between permittivity and dielectric constant is given by Eq. 2 where is the permittivity of free space 8.85 10C N m . Therefore permittivity values of 8.85 10F m 8.85 10F m and 8.85 10F m can be employed with corresponding time constants of 0.3 10s 3 10s and 30 10s.

At the stimulus waveform is converted to the frequency domain such as by using a discrete Fourier transform. This results in an FFT magnitude shown with respect to frequency kHz and magnitude and an FFT phase shown with respect to frequency kHz and phase rad .

At a Fourier FEM solver is used to model a current controlled stimulation. Estimated results for tissue capacitances having a dielectric constants K between 1 10and 1 10 are shown with respect to time sec and volts .

At a Fourier FEM solver is used to model a voltage controlled stimulation. Estimated results for DBS electrode capacitance values of 1.65 F 835 3.3 F 840 and 6.66 F 845 are shown with respect to time sec and volts .

In an example a field axon simulation can be conducted using a Fourier FEM DBS electrode model coupled to 5.7 m diameter myelinated axon models see e.g. . In this example a collection of 119 model axons were distributed in a 17 7 matrix oriented perpendicular to the electrode shaft. In other examples other numbers of model axons in other matrix orientations in other spatial orientations can be used. The perpendicular orientation of the axons to the electrode shaft can be used to identify the spatial extent of activation in the vertical and horizontal directions relative to the electrode shaft localization of activation in axons oriented parallel to the shaft would be ambiguous in the vertical direction . In this example the modeled axons were placed from 1 mm to 4 mm lateral to the modeled electrode and from 4 mm above to 4 mm below the center of the modeled electrode contact see e.g. though other distances can be used. The four model axons labeled with a C were used to evaluate strength duration time constants see . In this illustrative example each model axon included 21 nodes of Ranvier with 0.5 mm internodal spacing. The voltage values from the Fourier FEM solution can be interpolated onto the length of the cable model and the time dependent transmembrane potential variations induced by the stimulation can be calculated using a neural simulator e.g. NEURON www.neuron.yale.edu . A range of square wave pulse widths from 60 s is to 450 s were used in the simulations corresponding to the range available from an implantable pulse generator e.g. a Medtronic DBS pulse generator . At each axon and for each stimulus waveform threshold stimulus amplitudes can be defined that generated action potentials in a one to one ratio with the stimulus frequency. The threshold values can be used to create two dimensional contours to define the boundary of activation as a function of the stimulus amplitude. In this example these two dimensional boundary of activation contours can be swept around the axis of the electrode to determine the VTA.

In an example strength duration curves can be generated for individual model axons using a range of pulse widths from 60 s to 450 s. In each case the model axon can be oriented perpendicular to the shaft of the electrode at distances of 1 mm 2 mm 3 mm or 4 mm lateral from the axis of the electrode see model axons . In an example the chronaxie estimates can be determined from the Weiss Equation modified for voltage controlled stimulation Eq. 3 where Vis a threshold voltage PW is a cathodic pulse width Vis a rheobase voltage and Tis a chronaxie. In this example four conditions were assessed 1 an electrostatic model with monophasic waveforms under monopolar stimulation 2 a capacitive electrode model with monophasic waveforms under monopolar stimulation 3 a capacitive electrode model with Medtronic waveforms under monopolar stimulation and 4 a capacitive electrode model with Medtronic waveforms under bipolar stimulation. In this example the Medtronic waveforms include waveforms based on direct measurements from a Medtronic Itrel II neurostimulator. In other examples other experimental conditions can be tested. In this example the modeled waveforms e.g. Medtronic Itrel II modeled waveforms were 1 based on direct measurements from an actual stimulator 2 biphasic and 3 charge balanced with a cathodic pulse equal to a user defined pulse width followed by an anodic recharge pulse. In this example the anodic pulse began 0.4 ms after the end of the cathodic pulse and ended 4 ms before the beginning of the next cathodic pulse. Further the pulse generator voltage was equal to the peak to peak voltage between the cathodic phase and the anodic phase of the stimulus waveform.

Generally the effects of electrode capacitance and bulk tissue capacitance on the VTA can be quantified during voltage controlled and current controlled DBS. Using the examples above the effects of time dependence of the electric field stimulation waveform and electrode configuration monopolar or bipolar on axonal stimulation thresholds can be addressed as well as the influence of electrode capacitance on the strength duration relationship generated under voltage controlled DBS. Further the results of these examples can be compared to clinical measurements.

Bulk tissue capacitance can generally influence the time course of the electric field generated in a tissue medium under the context of current controlled stimulation. The difference in time course between the electrostatic model and the bulk tissue capacitance model can cause a difference in the VTA. This difference can be a function of the stimulation parameter settings. In an example during current controlled stimulation larger errors can occur with shorter pulse widths due at least in part to the difference between the electrostatic and capacitive waveforms. Generally the electrostatic and capacitive waveforms are greatest at the beginning of the cathodic phase. The difference between the capacitive and electrostatic models can be positively correlated with the dielectric value and stimulus amplitude and can be diminished for longer pulse widths.

At graphs are shown that display the volume in cubic millimeters by which the electrostatic model overstates the VTA Vol Err mm compared to each dielectric value. Each graph is shown with respect to the stimulation current consistent with their respective column pulse width and current I ma from the time dependent voltage waveforms at . Further the results are shown with respect to different dielectric values K 1eand K 1ehaving corresponding time constants r 3 s and 30 s.

At the percent by which the electrostatic model overstates VTA Volume Err for each pulse width and capacitance value across all current levels is shown as a function of pulse width for the current controlled stimulations. The results are shown with respect to different dielectric values K 1eand K 1ehaving corresponding time constants 3 s and 30 s. In an example the electrostatic model for DBS stimulation parameter setting 3 mA 90 s 130 Hz and K 1e overestimates the VTA by 18 mm or 20 . This effect can be modulated by the dielectric constant of the tissue medium and the impedance of the volume e.g. the impedance of this model is 400 . Larger dielectric values can cause the system to have a longer time constant RC which can exacerbate the magnitude of the electrostatic error.

Electrode capacitance can generally influence the time course and amplitude of a stimulus waveform transmitted to a tissue medium under the context of voltage controlled stimulation. The differences between the stimulus waveforms of the electrostatic and electrode capacitance models can result in different VTAs as a function of the stimulation parameters. In an example during voltage controlled stimulation the difference between the capacitive and electrostatic models can be inversely proportional to the capacitance value and can be greater for longer pulse widths and larger stimulus amplitudes.

At graphs are shown that display the volume in cubic millimeters by which the electrostatic model overstates the VTA Vol Err mm compared to each capacitance value. Each graph is shown with respect to the stimulation voltage consistent with their respective column pulse width and voltage V from the time dependent voltage waveforms at . Further the results are shown with respect to different capacitance values C 1.7 F C 3.3 F and C 6.7 F having corresponding time constants 0.67 ms 1.3 ms and 2.7 ms.

At the percent by which the electrostatic model overstates VTA Volume Err for each pulse width and capacitance value across all current levels is shown as a function of pulse width for the voltage controlled stimulations. The results are shown with respect to different capacitance values C 1.7 F C 3.3 F and C 6.7 F having corresponding time constants 0.67 ms 1.3 ms and 2.7 ms. In an example the electrostatic model for DBS stimulation parameter setting 3 mA 90 s 130 Hz and a standard electrode capacitance value of C 3.3 F overestimates the VTA by 30 mm or 20 . This effect can be modulated by the dielectric constant of the tissue medium and the impedance of the volume e.g. the impedance of this model is 400 . Smaller capacitance values cause the system to have a shorter time constant RC which can exacerbate the magnitude of the electrostatic error.

In this example a 3 mm electrode to axon distance resulted in calculated threshold voltages comparable to those recorded in clinical DBS strength duration experiments. However it should be noted that in this example the impedance of the model 400 is lower than the commonly observed clinical measurement 1000 . In turn the VTA for a given stimulus voltage in this example is an overestimation of the VTA generated with higher impedance electrodes.

In the example of graph shows strength duration curves for the four cases with respect to pulse width s and volts . During this example independent of the impedance of the model the threshold amplitudes progressively increased and Tprogressively decreased from Case through Case for an axon stimulated at 130 Hz while Case and Case had substantially similar results see graph . These results show that incremental changes in the model realism can generate measurable changes in model output. In addition typical experimental estimates of T 100 s from DBS subjects match most closely with our more realistic DBS models.

Chronaxie values were also dependent on electrode to axon distance stimulus waveform and stimulation frequency. In an example the Tof axons 1 mm 2 mm 3 mm and 4 mm lateral from an electrode axis were 238 s 296 s 333 s and 356 s respectively for 130 Hz stimulation under the conditions of Case . In other examples the chronaxie values between Case Case and Case were also compared at 100 Hz generally the lowest recommended frequency for typical clinical DBS for movement disorders 130 Hz a common frequency for clinical DBS and 185 Hz the maximum frequency for the Medtronic pulse generator . The results of these examples are summarized in Table 1 for axons located 3 mm from the electrode axis and generally show that Tis dependent on both stimulus waveform and frequency. The Medtronic waveform generated a decreasing Twith increasing stimulation frequency while the monophasic waveform exhibited a slight increase in Tover the same frequency range.

Explicit representation of electrode capacitance is helpful for accurate estimation of the VTA generated by voltage controlled stimulation. Explicit representation of the bulk tissue capacitance can be helpful for accurate estimation of the VTA generated by current controlled stimulation depending on the dielectric constant of the tissue medium. Further DBS strength duration time constants are dependent on capacitive components of the electrode tissue interface and the actual Medtronic stimulation waveform versus a monophasic waveform . Although the examples above were concentrated on DBS technology they are applicable to the field of neurostimulation in general.

In an example electrical circuit models of the electrode tissue interface typically include a double layer capacitance C of the electrode in parallel with a lumped non linear complex impedance Z . Ztypically becomes activated when the stimulation exceeds the charge carrying capacity of the C. In this example the electrode was modeled as a pure capacitor. In this example the source electrode and tissue medium was modeled with a set of circuit diagrams see e.g. . In this example the electrode contact is perfectly polarizable and only non faradaic reversible reactions are occurring at the electrode tissue interface. The charge storage capacity of platinum iridium electrodes as used in DBS is 100 C cm sufficiently exceeding a 30 C cmlimit typically employed in clinical neurostimulation. The neural tissue medium can be crudely represented with bulk capacitance and conductivity values.

The parameters of this example generally limit the effects of the capacitive components to specific stimulation types. In an example the tissue capacitance will only exert an influence during constant current stimulation because the electrode and tissue components behave as independent circuits. Independent of the stimulus waveform all of the stimulus current will pass through the tissue and as such the electrode capacitance can be ignored. In an example using monophasic waveforms does not allow the capacitance to discharge resulting in voltage increases during each pulse. In another example using charge balanced biphasic waveforms serves to discharge the capacitance during each waveform cycle. In other examples the effects of the tissue capacitance can be ignored during voltage controlled stimulation because capacitance of the DBS electrode can be of a value two orders of magnitude greater than the tissue capacitance. As a result during voltage controlled stimulation the voltage change across the neural tissue capacitance is much smaller than across the electrode capacitance.

Tissue capacitance values are generally a property of a neural medium and as such the tissue capacitance values are unlikely to change substantially in different experimental conditions. Electrode capacitance on the other hand is generally a function of the electrode material and size. In certain examples electrodes with limited charge carrying capacity or small size can reduce the electrode capacitance to a point where interaction between both tissue and electrode capacitances may affect the stimulus waveform transmitted to the tissue. Greater VTA errors typically result from smaller capacitance values and smaller electrode time constants. In an example both of the electrode and tissue capacitances can be discharged at the onset of a stimulation pulse. In this example the voltage changes at the rate dV dt the tissue resistance is momentarily ignored . The equivalent capacitance of the system for two capacitors in series is given by 1 2 12 Eq. 4 and the current is given by CdV dt Eq. 5 

Thus in this example the total current is limited by the rise time of the voltage which is infinite in theory but finite valued in model experiments due to nonzero dt values and in actual DBS pulse generators. The voltage across each capacitor can now be calculated from 

This equation demonstrates that the voltage across each capacitor at the end of the stimulus onset is inversely proportional to its capacitance value. Therefore in this example the electrode and tissue capacitors act as an effective voltage divider generally reducing the maximum amplitude of the stimulus applied to the tissue. In certain examples this can further exacerbate the differences between the electrostatic and Fourier FEM models. In examples using DBS electrodes this effect can cause a difference of 1 in the amplitude of the tissue voltage waveform. In an example using an electrode 1 10the size of the DBS electrode this effect can cause a 10 amplitude reduction in the tissue voltage waveform. Further in an example using an electrode 1 100the size of the DBS electrode this effect can cause a 50 amplitude reduction in the tissue voltage waveform.

Generally detailed computer modeling techniques can provide insight into the fundamental mechanisms of electrical stimulation of the central nervous system. In addition limitations in the understanding of the therapeutic mechanisms of DBS make it interesting to use neurostimulation modeling to estimate the VTA during therapeutic and non therapeutic stimulation. In an example this information can be used to develop correlations between activation of anatomical nuclei and either therapeutic outcomes or side effects of the stimulation.

Clinical neurostimulation pulse generators can use either voltage controlled or current controlled stimulation. In either of these cases the capacitance can modulate the time dependent properties of the stimulus waveform transmitted to the tissue medium. Failure to represent these reactive components in neurostimulation models can in certain circumstances cause significant errors in VTA calculations. In certain examples this can be particularly relevant during DBS where an error of 30 mm overestimation with quasistatic assumption and typical Therapeutic stimulation parameters could account for 15 of a target volume such as the subthalamic nucleus.

In certain examples qualitative comparisons can be made between our results and clinical records and such useful comparisons may only become evident with a model that explicitly accounts for the actual stimulus waveform and electrode capacitance effect such as for voltage controlled stimulation. In certain examples the calculation of Tfor axonal stimulation best matches clinical results with the more detailed model that accounts for stimulus waveform and electrode capacitance. In addition including the specific Medtronic waveform in the model caused decreasing neuronal activation thresholds and decreasing Twith increasing stimulus frequency. These examples highlight the value of incorporating details that have previously been ignored in neurostimulation modeling such as capacitance of the electrode tissue interface and actual stimulus waveforms generated by clinical devices.

The use of the quasistatic electrostatic assumption can cause significant errors in estimating neural activation during current controlled or voltage controlled stimulation. The differential effects between voltage controlled and current controlled stimulation can be caused by electrode capacitance and tissue capacitance respectively. The errors typically induced by ignoring the capacitance of the electrode tissue interface can be a function of the stimulus waveform stimulus amplitude and the magnitude of the reactive components. Thus the development of realistic estimates of the VTA from clinical neurostimulation devices should incorporate bioelectric field models that account for one or both of the electrode or bulk tissue capacitance.

DBS can excite axons surrounding the electrode. While correlations between axonal activation and the therapeutic mechanisms of DBS remain unclear it is believed that high frequency stimulation overrides underlying pathological neural activity patterns. However a wide range of factors can influence the clinical response to DBS including the disease state of the subject the anatomical target selected for stimulation the location of the electrode within the target the electrode geometry and the selection of stimulation parameters e.g. voltage pulse width and frequency . In clinical DBS devices using voltage controlled stimulation the amount of current delivered to the tissue can depend on the electrode impedance. Clinical measurements of DBS electrode impedance typically range from 500 to 1500 . However the factors that influence this variability or how this range of electrode impedance affects the spatial extent of neural stimulation are unclear.

Several factors can contribute to DBS electrode impedance values including the connections between an implanted pulse generator IPG and an electrode the surface area of the electrode or the IPG the conductivity or thickness of an encapsulation layers that surround the electrode or the IPG and the conductivity of the bulk tissue medium. FDA approved DBS devices include the quadripolar Medtronic 3387 89 DBS electrode and IPG system. The Medtronic Itrel II and Soletra IPGs can record impedances of up to 2 000 while the Medtronic Kinetra measures up to 4 000 . High impedance values are often associated with lead breakage or some other mechanical failure especially if the current is less than 15 A. Alternately very low impedance values 250 mA can be associated with a short circuit in the hardware. Between these extremes little clinical attention is typically paid to the impedance when selecting therapeutic stimulation parameter settings for individual subjects. However the large range of impedances suggests that current delivery and the subsequent neural response to DBS could be substantially different from subject to subject and from contact to contact.

In an example the sensitivity of electrode impedance e.g. from the range of 500 to 1500 typically observed with clinical DBS can be observed such as to detect changes in the properties of electrode s and tissue medium and determine how the variable electrode impedance affects the VTA.

In an example the origin and impact of electrode impedance in DBS can be addressed such as by primarily focusing on the electrode tissue interface. A range of detailed computer models can be developed with various geometrical and electrical properties to characterize likely sources of impedance variability in clinical DBS devices. Models of neurostimulation that integrate finite element based electric field solutions and multi compartment cable models of myelinated axons can be used to predict the VTA generated by DBS under different impedance conditions.

Several models were created to explore the effects of different geometrical properties and conductivities on DBS impedance. The model can include a cathode the DBS electrode contact and an anode the indifferent or return electrode of the IPG case to mimic the monopolar stimulation condition commonly used in clinical practice. Variable density FEM meshes can be used to increase solution accuracy by providing a mesh density that is highest where the electric field gradient is largest. The voltage within the volume can be determined using a Fourier FEM solver that solves the Poisson equation in time and space concurrently. In an example the solver can be used to combine the actual DBS waveform and the capacitance of the electrode tissue interface into the bioelectric field model. In this example the Poisson equation can solved using direct matrix inversion UMFPACK solver such as at frequencies between 0 Hz DC and 5000 Hz to determine the potential distribution Ve generated within the tissue medium stiffness matrix based on a collection of sources I Eq. 7 The Fourier FEM solver can use the solution of the Poisson equation at each component frequency along with the fast Fourier transform FFT of the stimulation waveform to determine the time dependent waveform at various locations in the axisymmetric volume.

As an illustrative example the sensitivity of electrode impedance to several model parameters can be observed by manipulating a model having an impedance of 1003 specified in Table 2 and . The model can be used to analyze the sensitivity of impedance to changes in dimensions of the volume conductor. Variations in length L from 50 300 mm and height H from 20 120 mm are intended to reflect the path of allowable current flow between the IPG and the electrode contact . In certain examples the length L can be representative of the distance from the DBS electrode contact to the IPG while the height h can be representative of the diameter of the head and neck. In certain examples tissue conductivity was varied from 0.15 0.3 S m.

In other examples the model can additionally or alternatively be used to analyze the effects of changes in electrode contact size. The dimensions of the electrode e.g. the cylindrical Medtronic 3387 89 DBS electrode contacts can be specified as 1.5 mm height by 1.27 mm diameter as an example. However these values can vary up to 0.1 mm in height or diameter such as due to manufacturing tolerances. Further the model can also be used to analyze the effects of varied thickness and conductivity of the encapsulation layer around the electrode contact t and respectively and around the IPG t and respectively . In this example modeled encapsulation thickness t ranged from 0.1 1.0 mm and modeled encapsulation conductivity t ranged from 0.05 0.15 S m.

The example of shows an equivalent circuit diagram of the DBS system. For each model a 1 V DC stimulus can be applied using a source located between the cathodal contact and the LPG and the voltage distribution within the volume can be determined. Current density can be integrated around the contact surface such as to determine the current injected into the volume. Ohms law can be used to determine the impedance from Z V I. The equivalent circuit of can include a wire resistance R and R e.g. 40 and 40 respectively and a capacitance of the electrode contact C to enable a more accurate comparison with clinical DBS impedance measurements. This example also models an electrode encapsulation layer impedance R a bulk tissue impedance R and an IPG encapsulation layer impedance R . In this example the model impedances can be calculated at the onset of the cathodic phase of the stimulation pulse and can therefore be independent of voltage or pulse width.

In an example field axon simulations were conducted using Fourier FEM DBS electrode models coupled to 5.7 m diameter myelinated axon models. In this example a collection of 119 model axons were distributed in a 17 7 matrix which can be oriented perpendicular to the electrode shaft. This orientation of axons can be used to identify the spatial extent of activation in the vertical and horizontal directions relative to the electrode shaft localization of activation in axons oriented parallel to the shaft would be ambiguous in the vertical direction . In this example the modeled axons were placed from 1 mm to 4 mm lateral to the modeled electrode and from 4 mm above to 4 mm below the center of the modeled electrode contact. In this example each axon included 21 nodes of Ranvier with 0.5 mm internodal spacing.

The stimulus waveforms can be based on modeled waveforms e.g. Medtronic Itrel II modeled waveforms . Such waveforms can be biphasic and charge balanced with a cathodic pulse equal to the user defined pulse width followed by an anodic recharge pulse. The anodic pulse began 0.4 ms after the end of the cathodic pulse and ended 4 ms before the beginning of the next cathodic pulse. The IPG output voltage can be equal to the peak to peak voltage between cathodic and anodic phases of the stimulus waveform. The time dependent potential distribution generated in the tissue medium from the Fourier FEM solution can be interpolated onto the length of each cable model and the time dependent transmembrane potential variations induced by the stimulation can be calculated in a neural simulator e.g. NEURON v5.7 . Threshold stimulus amplitudes can be defined to generate action potentials in a one to one ratio with the stimulus frequency. The threshold stimulus values can be used to create 2D contours to define a boundary of activation as a function of the stimulus amplitude. These 2D boundary of activation contours can be swept around the axis of the electrode to determine the VTA volume. Three dimensional renderings and VTA calculations relative to the thalamus can be performed using a bioelectric field solver e.g. BioPSE .

Factors that influence DBS electrode impedance can be identified and the effects of the DBS electrode impedance variability on the VTA during voltage controlled DBS can be quantified.

At the inset of the relationship between tissue resistivity m and the DBS electrode impedance is illustrated. Hence the bulk tissue e.g. tissue conductivity. and the electrode contact e.g. contact encapsulation conductivity will likely have a strong effect on clinically observed DBS electrode impedance.

In the example of the low medium and high impedance models generated substantially different VTAs with clinically relevant stimulation parameter settings e.g. 1.5 V to 3 V pulse amplitude 90 s pulse duration and 130 Hz stimulus train . The spread of activation for the VTA was inversely correlated with the impedance value. In this example the VTA volumes included 230 mm 146 mm and 110 mmfor the low medium and high impedance models at 3V stimulation respectively. The reduction in VTA volume with increasing impedance was related to the reduction in both the vertical and lateral spread of the stimulus. Current densities at the electrode contact and the corresponding charge densities were also inversely correlated with impedance values. The average charge densities for 3V 90 s stimulus pulses in the low medium and high impedance models were 6 4.5 and 3.6 C cm phase respectively. These values are well below a 30 C cm2 phase limit for safe stimulation but will typically increase linearly with increases in voltage or pulse width.

Generally the electrode impedance influences the current delivered to the tissue during voltage controlled DBS. Much of the impedance variability recorded with clinical DBS devices can be accounted for with varying degrees of tissue encapsulation. Impedance values are typically most sensitive to the thickness and conductivity of the encapsulation around the electrode contact. Lower encapsulation conductivities and thicker encapsulation layers can reduce the VTA by increasing the voltage gradient within the encapsulation thereby decreasing the stimulating influence of the applied electric field within the bulk tissue medium. Clinically relevant impedance variability can substantially alter the VTA size and shape for typical therapeutic stimulation parameter settings. Therefore attempts to quantify the spread of stimulation in DBS should explicitly incorporate electrode impedance in the calculations and consideration should be given to the electrode impedance when selecting therapeutic stimulation parameter settings for individual subjects.

Sources of impedance variability can include the variance in the volume of a conductor and the size of an electrode. Other sources could also have substantial effects on impedance including wire impedance e.g. the 80 impedance of the Medtronic lead and extension wiring which can increase dramatically due to poor mechanical or electrical coupling between the IPG and the extension or between the extension and lead. Additionally in certain examples each of the four individual wires within the extension and lead can be made up of a group of individual filars and breakage of one or more of these filars can dramatically increase resistance. Increases in impedance resulting from these hardware issues can reduce the voltage drop within the tissue medium which can reduce the VTA.

In other examples monopolar stimulation and bipolar stimulation can result in different impedance values. For example an axisymmetric model of DBS predicts that impedance values during bipolar stimulation will be higher than during monopolar stimulation. In certain bipolar stimulation examples in a model of cathode and anode on adjacent electrode contacts the Medtronic 3389 electrode 0.5 mm contact spacing and the Medtronic 3387 electrode 1.5 mm contact spacing had model impedances of 1478 and 1641 respectively. Adding an inactive contact between the cathode and anode increased the impedance to 2000 for both electrode types. Like the monopolar stimulation results bipolar impedances were most strongly influenced by the encapsulation layer around the electrode contact and by the tissue conductivity.

An axisymmetric model of DBS can simulate a chronic and stable DBS electrode tissue interface. The use of homogeneous isotropic subdomains of the encapsulation and bulk tissue medium are simplifications of the three dimensionally complex tissue micro and macro structure surrounding implanted electrodes. A more accurate representation of the tissue medium will undoubtedly introduce additional variability in the impedance. Further the electrode surface of the model is typically smooth it neglects any electrode corrosion and resulting surface modification that may occur due to prolonged stimulation. Hence the surface area specified in the electrode models may underestimate the actual surface area of clinical electrodes however analysis of post mortem or explanted DBS electrodes generally does not show any visible surface modification of the metal electrode contacts.

Tissue conductivity generally influences DBS impedance measurements however a great deal of variability exists in estimates of tissue conductivity. Mean values typically include 0.15 S m for white matter 0.45 S m for gray matter and 0.17 S m as a mean conductivity. In other examples however mean conductivity is estimated as 0.3 S m. Moreover variation in human brain conductivity or tissue impedances can generally vary up to 33.3 from subject to subject.

An additional source of variability can include the conductivity of the electrode encapsulation. Encapsulation is generally the final stage of the body s reaction to the presence of a foreign body in which the body attempts to destroy or isolate any non native substance. The tissue response typically includes both an early anti inflammatory response due to insertion trauma and a sustained response induced in part by one or more of micromotion tethering and device biocompatibility. Generally encapsulation thickness around the DBS electrode lead is believed to be at least 25 m and typically not greater than 1 mm. Tissue changes around the active contact and non stimulated areas adjacent to the insulated parts of the lead generally do not differ. In certain examples a thin inner capsule of connective tissue can develop around the lead track. The thickness of this fibrous sheath typically ranges from 5 to 25 m with little to no correlation to duration of stimulation. A narrow rim of fibrillary gliosis of less than 500 m can abut the fibrous capsule. In other examples in the nearby brain tissue loosely scattered glial fibrillary acidic protein positive protein astrocytes can develop in a small area. As such the clinical long lasting benefit of DBS can correlate to the absence of progressive gliotic scar formation. Nevertheless gliosis or the giant cell reaction can alter tissue impedance and thereby distort current distribution.

Further stimulation can transiently decrease electrode impedance. In an example a 430 difference can develop between active and inactive DBS contacts during chronic stimulation. Further a reversible drop in impedance can occur when contacts are activated with monopolar stimulation over a period of several days. However when the contact is deactivated the impedance can return to the pre stimulation values. Generally the most substantial and consistent impedance change comes from protein adsorption and the cellular layers surrounding the electrode. In turn stimulation through a given contact can modify the tissue microstructure of the local encapsulation increasing conductivity and decreasing electrode impedance.

Generally impedance values can be calculated using Ohm s law. Specifically the voltage at the onset of the cathodic stimulation pulse can be divided by the current where current can be calculated by integrating the current density across the electrode contact. In certain examples in which the IPG case and a DBS electrode were connected with a 1 k resistor a Medtronic programmer accurately reported the resistance value with the stimulation parameters 1.5 V 210 sec 30 Hz. However the measured impedance was a function of both the voltage and pulse width generated by the Medtronic IPG. Increases in either parameter generally caused a decrease in the measured impedance most likely due to the way the Medtronic programmer measures impedance from the time dependent voltage waveform.

Generally the clinical impedance measurements from DBS electrodes can depend on many factors some of which cannot be directly measured. However our analysis suggests that much of the 500 1500 range seen clinically can be accounted for by using a realistic variability in the electrical properties of the electrode encapsulation and bulk tissue medium. Impedance changes within this clinically observed range can directly affect the size and shape of the VTA. In turn attempts to quantify the stimulation effects of DBS on a subject by subject basis should explicitly account for the measured electrode impedance.

In an example the FEM circuit can be configured to create a FEM of an implanted electrode and a tissue medium in which the electrode is implanted. Generally the FEM can include an electrical model of the electrode and the tissue medium. The electrode can be configured to deliver an energy to a subject such as to at least a portion of a brain e.g. a thalamus a subthalamic nucleus STN or other portion of the brain . In an example the electrode can include at least one electrode a neurostimulation electrode or one or more other electrodes. The tissue medium can include at least a portion of the brain such as the thalamus the STN or other portion of the brain. In certain examples the FEM can include certain relationships such as electrical relationships e.g. capacitive inductive conductive or other electrical relationships between the components in the FEM such as the electrode or the tissue medium. In an example the FEM can include an electrode tissue interface. The electrode tissue interface can include an encapsulation layer around the electrode. In an example the FEM circuit can include an axisymmetric FEM circuit e.g. see . In this way the FEM can be used to provide an electrical model of the implanted electrode and the tissue medium.

In the example of the Fourier FEM solver circuit can be configured to calculate a potential distribution in the tissue medium using information from the FEM circuit such as the FEM and a capacitive component of at least one of the electrode and the tissue medium. In an example the information from the FEM circuit includes the capacitive component of the at least one of the electrode and the tissue medium. In another example the Fourier FEM solver circuit can be configured to calculate a potential distribution in the tissue medium using information from the FEM circuit and a capacitive component of at least one of the electrode the tissue medium and the electrode tissue interface.

In certain examples the Fourier FEM solver circuit can be configured to calculate the potential distribution in the tissue medium in both time and space. Generally the Fourier FEM solver circuit can be configured to calculate the potential distribution in the tissue medium using the Poisson equation and the FEM.

In an example the Fourier FEM solver circuit can be configured to separate a stimulus waveform into frequency components to obtain a solution of the Poisson equation at least one frequency component by using a stiffness matrix with a complex component such as and to use the solution to reassemble the stimulus waveform. Generally the stimulus waveform can include any energy delivered to the tissue medium using the implanted electrode such as a neurostimulation energy. In certain examples the system is configured to receive user input defining an arbitrary stimulus waveform of interest. Further the stiffness matrix i is typically configured to include a representation of at least one capacitive component of at least one of the implanted electrode and the tissue medium. In an example the stiffness matrix i can include a representation of the capacitive component of the electrode tissue interface. In various examples capacitive components of the implanted electrode or the tissue medium can be calculated individually for a particular subject can be deduced from one or more clinical studies or can be estimated using clinical data or other information.

In this example the VOA circuit can be configured to predict a VOA such as by using the potential distribution and a neuron model. In certain examples the neuron model can include a multi compartment neuron model or a multi compartment neuron cable model of myelinated axons. In an example the VOA circuit can be configured to interpolate the potential distribution onto a plurality of model axons. The VOA circuit can be configured to predict a VOA such as a VOA for a particular FEM using one or more stimulation waveforms e.g. a 3 V stimulation pulse a 2 V stimulation pulse and a 1 V stimulation pulse or other configurations or one or more combinations of different stimulation parameters.

At a FEM of an implanted electrode and a tissue medium in which the electrode is implanted is determined. Generally the FEM can include an electrical model of the electrode and the tissue medium. In an example the FEM can include an electrical model of an electrode tissue interface which can include an encapsulation layer around the electrode. In certain examples the FEM can include certain relationships such as electrical relationships e.g. capacitive inductive or other electrical relationships between the components in the FEM such as the electrode or the tissue medium. In an example the FEM can be determined using multiphysics modeling software such as FEMLAB 3.1.

At a potential distribution in the modeled tissue medium is calculated using a Fourier FEM solver and a capacitive component of at least one of the electrode and the tissue medium. In an example the potential distribution can be calculated using the Fourier FEM solver and a capacitive component of at least one of the electrode the tissue medium and the electrode tissue interface. The Fourier FEM solver can be used to combine the desired DBS stimulation waveform and the capacitance of the electrode tissue interface into the bioelectric field model. In an example the potential distribution in the modeled tissue medium can be calculated by solving a Poisson equation such as by using direct matrix inversion.

At a VOA is predicted using the potential distribution and a neuron model. In an example by applying the potential distribution to the neuron model e.g. by establishing an activation threshold for each axon and applying the potential distribution to the threshold relationship the VOA can be predicted e.g. see .

At an effective electrode impedance is calculated such as by dividing a modeled stimulation voltage by a modeled integrated current density along a modeled active implanted electrode contact. In an example a model can be created e.g. see using the calculated impedance. In certain examples the calculated impedance can include one or more of an effective electrode impedance a wire resistance e.g. R and R an electrode encapsulation layer impedance e.g. R or other impedances.

At a potential distribution is calculated in the modeled tissue medium using a Fourier FEM solver including using a modeled capacitive component of at least one of the electrode the tissue medium and the electrode tissue interface e.g. an encapsulation layer around the implanted electrode and using the calculated impedance. Generally modeling such impedances can increase the correlation between a clinically measured VOA and a model derived VOA making the model more useful for predicting clinical results.

At an arbitrary desired stimulus waveform is separated into frequency components. In an example the desired stimulation waveform or a DBS waveform can be created or specified in the time domain. The stimulation waveform can be separated into frequency components or converted into the frequency domain such as by using a Fourier transform or other similar operator e.g. FFT .

At a solution of a Poisson equation is obtained for at least one frequency component such as by using a stiffness matrix i wherein the stiffness matrix i includes a representation of a capacitive component of at least one of the implanted electrode and the tissue medium. In an example the stiffness matrix i can include a representation of a capacitive component of the electrode tissue interface. Generally the Poisson equation can be understood as a partial differential equation that can be used to calculate an electric potential for a given charge distribution. In this example a desired stimulation waveform is given. In an example the Poisson equation can generally be used to distribute the effects of the FEM model onto the stimulus waveform.

At the solution is used to reassemble the stimulus waveform. In an example the stimulus waveform is reassembled in the time domain to apply the stimulus waveform to the tissue medium. By applying the reassembled stimulation waveform to the tissue medium the potential distribution in the tissue medium can be calculated.

At a VOA is predicted by interpolating the potential distribution onto a plurality of model axons. In an example the potential distribution can be interpolated onto a plurality of model axons e.g. a length of a cable model etc. . Using neural simulation software e.g. NEURON v5.7 VOA or volume of tissue activated VTA can be calculated using the interpolated potential distribution.

In this example the computer can include an imaging data storage configured to receive imaging data from a medical imaging device a DTI or other atlas data storage a neuron or axon model e.g. such as discussed above or in McIntyre et al. 982 a processor and a telemetry circuit . In an example the processor can include a finite element model FEM circuit a Fourier FEM solver circuit a threshold determination circuit a volume of activation VOA circuit and a scoring circuit . In this example the FEM circuit can be configured to create a FEM of an implanted electrode and a tissue medium. The Fourier FEM solver circuit can be configured to calculate a potential distribution in the tissue medium using information from the FEM circuit and a capacitive component of at least one of the implanted electrode and the tissue medium. In certain examples the Fourier FEM solver circuit can be configured to calculate the potential distribution in the tissue medium using an encapsulation area around the implanted electrode or using a calculated impedance as described above. The threshold determination circuit can be used to develop a threshold value of the calculated potential distribution. The VOA circuit can be configured to predict a VOA using the potential distribution e.g. such as discussed above or in McIntyre et al. 982 . The scoring circuit can be configured to compare the predicted VOA against one or more desired or undesired anatomic regions to determine whether the VOA will perform as desired as discussed in McIntyre et al. 982.

In an example the VOA can be displayed using a display device such as together with other data that is typically displayed on an IGS workstation display as discussed in McIntyre et al. 982. A user input device can be configured to permit a user to input data for example particular information about the configuration or morphology of the implanted electrode or other electrode being used in the procedure. In one example a position tracking device can track the location of the implanted electrode so that the location can be displayed on the display device such as with the VOA or scoring information discussed above or in McIntyre et al. 982. In an example the telemetry circuit can be configured to program or otherwise communicate with an IPG such as to adjust electrical stimulation parameters using the VOA or scoring information discussed above or in McIntyre et al. 982. Although illustrates an IGS workstation example it is understood that portions of the system could alternatively be implemented outside the context of an IGS workstation such as for example in an external programmer device for an implantable DBS controller circuit . Such an alternate example need not include any intraoperative imaging or position tracking.

Various examples above can be performed using a machine readable medium or a computer readable medium which includes any medium which is capable of storing or encoding a sequence of instructions for being performed by the machine to perform one or more of the methods described herein.

Various examples described herein may be computer implemented. Some examples may include computer readable media encoded with a computer program e.g. software which includes instructions operable to cause an electronic device to perform methods of various examples. A software implementation or computer implemented method may include microcode assembly language code or a higher level language code which further may include computer readable instructions for performing various methods. The code may form portions of computer program products. Further the code may be tangibly stored on one or more volatile or non volatile computer readable media during execution or at other times.

It is to be understood that the above description is intended to be illustrative and not restrictive. For example the above described examples and or aspects thereof may be used in combination with each other. Many other embodiments will be apparent to those of skill in the art upon reviewing the above description. The scope of the invention should therefore be determined with reference to the appended claims along with the full scope of equivalents to which such claims are entitled. In the appended claims the terms including and in which are used as the plain English equivalents of the respective terms comprising and wherein. Also in the following claims the terms including and comprising are open ended that is a system device article or process that includes elements in addition to those listed after such a term in a claim are still deemed to fall within the scope of that claim. Moreover in the following claims the terms first second and third etc. are used merely as labels and are not intended to impose numerical requirements on their objects.

The Abstract is provided to comply with 37 C.F.R. 1.72 b which requires that it allow the reader to quickly ascertain the nature of the technical disclosure. It is submitted with the understanding that it will not be used to interpret or limit the scope or meaning of the claims. Also in the above Detailed Description various features may be grouped together to streamline the disclosure. This should not be interpreted as intending that an unclaimed disclosed feature is essential to any claim. Rather inventive subject matter may lie in less than all features of a particular disclosed embodiment. Thus the following claims are hereby incorporated into the Detailed Description with each claim standing on its own as a separate embodiment.

