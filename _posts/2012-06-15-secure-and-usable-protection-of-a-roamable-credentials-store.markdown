---

title: Secure and usable protection of a roamable credentials store
abstract: A tool facilitates a balancing of security with usability enabling secure user access to multiple secure sites and locations from several computing devices. Access to the multiple secure sites and locations occur by utilizing a roamable credential store (RCS), which is highly resistant to offline attack. The RCS facilitates a protected Unified Credential Vault (UCV) via a multi-stage encryption process such that user credentials are protected by making offline dictionary attacks prohibitively expensive to an attacker without causing usability to deteriorate commensurately.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09262618&OS=09262618&RS=09262618
owner: Microsoft Technology Licensing, LLC
number: 09262618
owner_city: Redmond
owner_country: US
publication_date: 20120615
---
This application is a continuation of and claims priority to commonly assigned co pending U.S. patent application Ser. No. 12 037 020 entitled Secure and Usable Protection of a Roamable Credentials Store filed on Feb. 25 2008 the entire disclosure which is incorporated by reference herein in its entirety.

Secure digital access to a multitude of sites accessible online such as online banking shopping and virtual private networks are desired in today s online society. User authentication reflects a typical process that people use to access such sites online. Generally the process begins with a user browsing to a web site determining that secure access is desired and setting up a user name and password passphrase for the site. Each time the user wants to access the site the user browses to the site enters their user name and password passphrase and upon the site matching the user name and password passphrase gaining entry to the site.

Currently as an alternative to entering the user name and password passphrase each time the user browses to the site online the user can allow storage of cookies on the browser to remember selected information by the browser on that device. Thus the security of the user s information at the site online is governed by the security of the computing device and browser upon which the cookies are stored.

Variations of the user name and password passphrase entry process utilize answering predetermined questions and identifying predetermined images in addition to entering the user name and password.

In either event the user name and password entry authentication process is only as secure as the strength of the user s chosen password passphrase i.e. high entropy not easily guessed meeting certain strength criteria in view of the user s secure treatment of the password passphrase i.e. not reusing passwords passphrases not writing down the password passphrase not storing passwords passphrases in an easily determined location . Weak i.e. low entropy passwords passphrases are susceptible to dictionary and brute force attacks.

Balanced security with usability facilitating secure user access to websites and other online locations from multiple computing devices utilizing a roamable credential store RCS is described herein. In an aspect of at least one embodiment the RCS facilitates a protected Unified Credential Vault UCV via a multi stage encryption process such that user credentials are protected by making offline dictionary attacks prohibitively expensive to an attacker without causing usability to deteriorate commensurately.

This Summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This Summary is not intended to identify key or essential features of the claimed subject matter nor is it intended to be used to limit the scope of the claimed subject matter.

The same numbers are used throughout the disclosure and figures to reference like components and features.

The following terms are used in this particular specification and unless otherwise specified or clear from the context the terms have the meanings provided below.

Brute force attack An attempt to defeat a cryptographic scheme characterized by attempting to determine passwords passphrases by submitting virtually all possibilities. Unlike dictionary attacks brute force attacks are not based on inputs considered more likely to match passwords passphrases.

Credential An encrypted entry comprising identification of a secure site a user name corresponding to the secure site and a password passphrase for accessing the secure site.

Dictionary attack An attempt to defeat a cryptographic scheme characterized by attempting to determine passwords passphrases by submitting a large number of possibilities based on words found in a dictionary which are most likely to match passwords passphrases.

Expensive A relative cost value. In terms of time an expensive operation takes longer costs more than an inexpensive operation. For example cost may be defined relative to the number of seconds or milliseconds necessary to complete an operation.

Offline attack A cryptographic attack on a password when the would be attacker has access to the protected container for a sufficient time to mount dictionary attack on the credentials store to retrieve secrets.

A roamable credential store RCS enables secure storage of multiple credentials belonging to an individual user in a roamable format via multi stage encryption. In another aspect the RCS facilitates leveraging a Unified Credential Vault UCV via a multi stage encryption process to produce a protected UCV such that user credentials are protected by making offline dictionary attacks prohibitively expensive to a would be attacker without commensurate increases in usability costs. In another aspect the RCS provides users enhanced secure access on multiple computing devices. In another aspect the RCS enables accelerated retrieval of information on selected computing devices.

An environment in which these tools may enable these and other techniques is set forth first below. Additional sections describe various inventive techniques and exemplary embodiments of the tools. These sections describe exemplary ways in which the inventive tools enable secure storage of multiple credentials belonging to an individual in a roamable protected UCV. Further sections describe processes of providing a secure and roamable protected UCV via multi stage encryption such that a user s credentials are protected by dramatically increasing the costs of offline dictionary attacks for would be attackers while maintaining user acceptable time frames for execution. Yet additional sections describe processes of providing accelerated retrieval of information on selected devices which leverage enhanced secure access to users on multiple computing devices are described utilizing an entry comprising identification of a secure site a user name corresponding to the secure site and a password passphrase for accessing the secure site.

Producing a protected UCV includes deriving a key from a password for the protected UCV to protect the protected UCV. The protected UCV may enforce group security policies regarding password security as group security policies are known in the art. Furthermore the protected UCV may allow users to set their own respective levels for password security. Regardless of the entropy of a user s password the protected UCV incorporates iterative hashing in a password based key derivation function utilizing a salt i.e. random bits as one of the inputs to make dictionary attacks harder for would be attackers. For example a password based encryption standard such as PKCS5 applies iterative hashing and may be represented as K pkcs5 n s p where n iteration count s salt and p password such that K a derived key. While PKCS5 is used as an example other password based encryption schemes utilizing an iteration count are contemplated for use in the protected UCV.

The higher an iteration count is the harder performing a successful dictionary attack will be for a would be attacker. This is because when the iteration count is very high performing the offline dictionary attack can be made prohibitively expensive for most attackers where cost is calculated in terms of time. For example when key derivation is made expensive costing for example 10 seconds on modern hardware mounting offline attacks is difficult and expensive taking close to 10 seconds to derive a key for each password guess. Furthermore when for example normal entropy is 40 an attacker would need 10 seconds for each of 2password attempts or more than 348 000 years. Assuming the attacker can retrieve the correct key in the time for all the password possibilities then the attacker would still need 2 40 2 10 to guess the password. Assuming the attacker takes advantage of known attributes in human created passwords for example via Rainbow tables then the attacker would still need more than 1 000 years to guess the password.

However users are also adversely affected by high usability costs caused by key derivation using high iteration counts where cost is calculated in terms of time. For example users are not likely to accept waits of close to 10 seconds each time they must key a user name and password to enter a secure site.

In the protected UCV the key derivation may be implemented by the vault engine. In at least one embodiment other suitable components may implement the key derivation. In an aspect of at least one embodiment key derivation may be implemented as a multi stage process of encryption. For example in the first stage a first key K may be generated by a local security authority which is a part of the trusted computing base. For example the first key K may be derived using PKCS5 as described above K pkcs5 n s p with an iteration count of about 10 million and resulting in an exemplary cost of about 9.6 seconds. In the second stage a second key K may be derived using a variation of PKCS5 such that K pkcs5 n s p K where p K represents a concatenation of the entered password for the protected UCV and the first key. In an aspect of at least one implementation concatenation comprises appending the first key to the password. In an aspect of at least one implementation concatenation comprises hashing the first key and the password. For example in the second stage K may be derived with an iteration count of about 100 000 and a cost of about 100 milliseconds. In an aspect of at least one implementation the iteration count represented by nis much smaller than that represented by n n

Once the second key is derived the entry may be encrypted with the second key using a known encryption scheme such as a symmetric cipher like Advanced Encryption Standard AES 256 or another Federal Information Processing Standard FIPS validated cipher and stored as a credential in the protected UCV. The roamable credentials store RCS provides for storage of the first key in the user s profile on the local computing device facilitating accelerated subsequent accessing of the secure site utilizing the protected UCV as described in detail below . The second key is not stored in long term storage. In an aspect of at least one implementation after the entry comprising identification of a secure site a user name corresponding to the secure site and a password passphrase for accessing the secure site is encrypted and stored as a credential the second key is destroyed. In an aspect of at least one implementation the second key may be destroyed when the user logs out. In an aspect of at least one implementation the second key may be destroyed responsive to user direction.

The roamable credential store RCS embodied on a roamable device having at least one credential stored thereon may be usable to facilitate accelerated access to the secure sites for which associated credentials are stored on the roamable device at other computing devices of the user s choice.

As part of the access process described in detail below a computing device accesses a roamable device and loads the protected UCV application programming interface API . Although according to at least one other aspect of at least one environment the protected UCV API may be stored on a computing device. In an aspect of at least one embodiment the protected UCV API facilitates accessing credentials upon a subsequent access of a secure site so that the later access to the same secure site may be accelerated. In another aspect of at least one embodiment other interactions with the same secure site may also be enhanced.

When a user couples their roamable device comprising an RCS to another computing device for example a computing device at work at school or at a library in an aspect of at least one embodiment the user may be prompted to indicate whether this is a computing device upon which the user wants to store information so that subsequent accesses to secure sites may occur more quickly. In the event that the user elects to speed subsequent secure access the user enters the password for the protected UCV from which the first key may be derived. For example deriving the first key may cost around 9.6 seconds. When the user elects to speed subsequent secure access after the first key is derived it may be stored in the user s profile or other location accessible by only the user as defined by the operating system of the computing device. In other words the first key may be stored in a secure location on the local computing device. Based on the first key and the entered password the second key may be derived. For example deriving the second key after the first key has been derived may cost around 100 milliseconds. The first key can be safely stored on any computing device having a location for secure storage accessible by just the particular user.

Thus subsequent access may be accelerated because the first key will not need to be derived on that device and instead may be accessed for derivation of the second key. According to at least one embodiment the usability cost for such subsequent access may also be approximately 100 milliseconds.

In an aspect of at least one embodiment in the event that the user declines storing information the user may be prompted for whether faster access for this particular session is desired. In the event that the user elects to speed access for the current session the first and second keys may still be derived as described above but neither will be stored in long term storage. In an aspect of at least one embodiment upon the user browsing to a secure site the user will not be prompted for entry of an associated user name and password because the first and second keys will have been derived and the protected UCV unlocked.

In an aspect of at least one embodiment when the first key has been stored on the local computing device and the user browses to a secure site for which a credential is stored on a coupled roamable device for which the second key has been derived the user may be securely signed on to the site without having to enter the associated user name and password by the browser calling protected UCV. In an aspect of at least one embodiment another suitable application may call the protected UCV for example a security application. In an aspect of at least one embodiment when the first key has been stored on the local computing device and the user browses a secure site for which a credential is stored on a coupled roamable device for which the second key has not been derived in that browsing session the second key will be derived. According to at least one embodiment the usability cost for deriving the second key may be approximately 100 milliseconds.

Although the subject matter is described in language specific to structural features and or methodological acts it is to be understood that the subject matter defined in the appended claims is not necessarily limited to the specific features or acts or to the structural proximity or sequences described herein. Rather the specific features and acts described are disclosed as exemplary forms of implementing the claims.

Before describing the tools in detail the following discussion of an exemplary operating environment is provided to assist the reader in understanding at least one way in which various inventive aspects of the tools may be employed. The environment described below constitutes but one example and is not intended to limit application of the tools to any one particular operating environment. Other environments may be used without departing from the spirit and scope of the claimed subject matter.

Computing device may be one of a variety of computing devices such as a cell phone laptop computer desktop computer personal digital assistant or server. Each computing device having at least one processor capable of accessing and or executing instructions embodied on the computer readable media. In at least one embodiment the computer readable media comprises or has access to a browser which is a module program or other entity capable of interacting with a network enabled entity. The computing device may also include input output devices including a keyboard mouse microphone printer monitor and speakers not shown useable to implement one or more embodiments of the tools described herein.

The operating environment further comprises at least one roamable device . Roamable device may be one of any number of suitable removable and or portable devices such as a universal serial bus USB device a PC card a thumb drive a universal flash drive UFD a smartcard a live drive a mobile phone an IEEE 1394 High Speed Serial Bus device or a biometric enabled mass storage device. Each roamable device comprises computer readable media and is capable of interfacing with a computing device similar to . Each roamable device having the capability of being accessed by one or more processors as a computer readable media. The roamable device also operatively couples to other computing devices which may be the same type of computing device as or can be different computing devices. The one or more keys may be utilized on at least part of the information on the roamable device such as the protected UCV via multi stage encryption enabling a lock on at least a part of the roamable device .

Each of the computing device s and roamable device s interact via the inventive protected Unified Credential Vault UCV . In at least one embodiment the interaction occurs via coupling the roamable device to the computing device . In another embodiment such interaction occurs via wireless coupling of the computing device and roamable device for example via wireless protocols such as wireless USB Bluetooth infrared IR and other wireless and radio frequency RF communications protocols. In another embodiment the interaction occurs via network access between the computing device and roamable device .

In some embodiments the operating environment also comprises one or more network s and server s which include web servers . The network enables communication between the computing device s and the server s and can comprise a global or local wired or wireless network such as the Internet a local area network LAN or an intranet. Computer readable media of computing device and or roamable device comprises or has access to a browser which is a module program or other entity capable of interacting with a network enabled entity.

The operating environment may further comprise at least a second computing device having one or more processor s and computer readable media similar to computing device . Each computing device comprises a computing device similar to . The computing device s may be the same computing device as computing device or can be a separate or different computing device.

Recovery of information locked on the roamable device via a multi stage encryption process is provided for via a number of methods. In an aspect of at least one embodiment access is provided at least in part via a stored key . In another aspect of at least one embodiment access is provided at least in part via derivation of a new key . In yet another aspect of at least one embodiment access is provided via a combination of stored key s and newly derived key s . In an aspect of at least one embodiment each method presented provides increased security with less than commensurate deterioration of usability via a multi stage encryption and decryption process for access to secure sites such as secure web sites secure documents and secure enterprise connections including online banking sites online shopping sites and virtual private networks.

The following discussion describes exemplary ways in which the tools balance security with usability by facilitating secure user access to sites and locations from multiple computing devices utilizing a roamable credential store RCS . The RCS facilitates a protected Unified Credential Vault UCV via multi stage encryption such that user credentials are protected by making offline dictionary attacks prohibitively expensive to an attacker without causing usability to deteriorate commensurately.

Memory typically includes data program modules and components for implementing the described processes that are immediately accessible to and or presently operated on by microcontroller and or computing device . A multi stage encryption process protects at least part of the information in roamable memory the protected UCV . Correspondingly a multi stage decryption process provides for secure storage of credentials in the protected UCV facilitating accelerated and or enhanced access to secure sites on multiple computing devices.

As part of the populating process described further below computing device accesses memory on roamable device and loads the protected UCV application programming interface API to memory . In another aspect of at least one environment the protected UCV API need not be stored on roamable device . In an aspect of at least one embodiment the protected UCV API facilitates storing credentials upon accessing a secure site so that future access to the same secure site may be accelerated. In another aspect of at least one embodiment other interactions with the same secure site may be enhanced. Credential s are defined as an encrypted entry comprising identification of a secure site a user name corresponding to the secure site and a password passphrase for accessing the secure site. For example the entry may be encrypted with a particular key described below using a symmetric cipher such as Advanced Encryption Standard AES 256 or other Federal Information Processing Standard FIPS validated cipher. Other encryption schemes are contemplated for use in the protected UCV.

The populating process further includes creating the protected UCV on a roamable device . Creating the protected UCV includes deriving a key from a password for the protected UCV to protect the protected UCV using iterative hashing as discussed above.

The roamable credential store RCS embodied on the roamable device having at least one credential stored thereon is usable to facilitate accelerated access to the secure sites for which associated credentials are stored on the roamable device at other computing devices of the user s choice such as computing device .

As part of the access process described further below computing device accesses memory on roamable device and loads the protected UCV application programming interface API . Although according to at least one other aspect of at least one environment the protected UCV API may be stored on computing device . In an aspect of at least one embodiment the protected UCV API facilitates accessing credentials upon a subsequent access of a secure site so that the later access to the same secure site may be accelerated. In another aspect of at least one embodiment other interactions with the same secure site may also be enhanced.

When a user couples their roamable device comprising an RCS to another computing device in an aspect of at least one embodiment the user will be prompted for whether this is a computing device upon which the user wants to store information so that subsequent accesses to secure sites may occur more quickly. In the event that the user elects to speed subsequent secure access the user may enter the password for the protected UCV and the first key may then be derived and stored in a secure location on the local computing device. Based on the first key and the entered password the second key may then be derived. The first key can be safely stored on any computing device having a location for secure storage accessible by the particular user. Thus subsequent access will be accelerated because the first key will not need to be derived on that device and instead may be accessed for derivation of the second key.

In an aspect of at least one embodiment when the first key has been stored on the local computing device and the user browses to a secure site for which a credential is stored on a coupled roamable device for which the second key has been derived the user may be securely signed on to the site without having to enter the associated user name and password by the browser calling protected UCV for example a security application. In an aspect of at least one embodiment another suitable application may call the protected UCV. In an aspect of at least one embodiment when the first key has been stored on the local computing device and the user browses a secure site for which a credential is stored on a coupled roamable device for which the second key has not been derived the second key will be derived.

Depending on the exact configuration and type of computing device memory may include a variety of computer readable media other than roamable device . Computer readable media can be any available media that can be accessed by a computing device such as computing device and includes both volatile and nonvolatile media removable and non removable media. By way of example and not limitation computer readable media comprises computer storage media. Computer storage media includes both volatile and nonvolatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. Computer storage media includes but is not limited to RAM ROM EEPROM flash memory or other memory technology CD ROM digital versatile disks DVD or other optical disk storage magnetic cassettes magnetic tape magnetic disk storage or other magnetic storage devices or any other medium which can be used to store the desired information and which can be accessed by computing device such as computing device . Memory typically includes an operating system one or more program modules and may include program data and integrated storage . This basic configuration is illustrated in by those components within dashed line .

The operating system may include a component based framework that supports components including properties and events objects inheritance polymorphism reflection and provides an object oriented component based application programming interface API . The .NET Framework manufactured by Microsoft Corporation Redmond Wash. is an example of such a framework though it is by no means a limiting one.

Computing device may have additional features or functionality. For example computing device may also include additional data storage devices removable and or non removable as discussed above. Such additional storage is illustrated in by removable storage and non removable storage . Computer storage media may include computer readable media discussed above. Memory removable storage and non removable storage are all examples of computer readable media. Any such computer storage media may be part of computing device shown and described with regard to .

Computing device may also have input device s such as keyboard mouse pen voice input device e.g. a microphone touch input device video input e.g. a camera a video camera etc. and output device s such as a display speakers printer etc. Computing device may also contain communication connections that allow the device to communicate with other computing devices such as over a wired or wireless network. The environment may also include one or more other storage units not shown . Alternatively one or more storage units may be combined. In at least one embodiment each of these storage units may be located separate from the computing device and accessible via a network. The description of environment may include references to the environment of .

In another aspect of at least one embodiment a sync center sets a synchronization partnership with vault via vault APIs . In another aspect of at least one embodiment vault engine provides a vault store interface to vault store . In another aspect of at least one embodiment vault engine provides an interface to roamable store enabling direct reading of credentials from roamable store . In at least one embodiment the environment may also include one or more storage units comprising memory on roamable device roamable store and vault store . Alternatively one or more of these storage units may be combined. In at least one embodiment each of these storage units may be located separate from the Roamable Credentials Store RCS and accessible via a network. In another aspect of at least one embodiment roamable store interfaces with vault handler for accessing credentials . In another aspect of at least one embodiment the vault engine uses an abstract storage not shown to submit vault data for long term storage in vault store . The data that the vault engine submits to the store is protected by a key derived by the user s password for the protected UCV.

Exemplary acts of operation are described herein with reference to . As with all processes described herein the order in which the acts are described and depicted in the corresponding figures is itself exemplary and should not be construed as limiting the order in which the actions occur.

Block represents the protected UCV application programming interface API being loaded to memory upon the coupling of a roamable device . Upon the protected UCV application programming interface API being loaded the protected UCV is created on roamable device at block via entry of a password for the protected UCV. At block a browser on computing device may be directed to a secure site online. At block a site user name and password are entered. At decision block a determination is made of whether roamable access to the site is desired. When roamable access is not indicated secure access to the site continues at block . When roamable access is indicated encryption of an entry comprising identification of a secure site a user name corresponding to the secure site and a password passphrase for accessing the secure site is begun at block . At block a password encryption scheme using high count iterative hashing is applied to create a first key. At block a password encryption scheme using iterative hashing with a lower count and the first key is applied to create a second key. At block the entry is encrypted using the second key to create a credential . At block the credential is stored in protected UCV . A user having stored a credential such as at block may now roam to other computing devices such as .

Block represents coupling an RCS in accordance with the present application to a computing device such as computing device . Block represents accessing a secure site as discussed in regard to . Decision block represents prompting for accelerated subsequent access of a currently accessed secure site. When accelerated subsequent secure access is not indicated secure access to the site continues at block . When accelerated subsequent secure access is indicated the first key as derived in block of is stored for example in a local user profile at block . Thus subsequent access may be accelerated because the first key will not need to be derived on that device and instead may be accessed for derivation of the second key causing the usability cost for subsequent access to be greatly reduced from that of the initial access.

Block represents a subsequent access of a secure site when the first key has been stored locally as in block of . The first key is accessed from the local profile having a negligible usability cost at block . At block the second key is derived utilizing the stored first key providing accelerated subsequent access. In an aspect of at least one embodiment process occurs immediately after process of . In another aspect of at least one embodiment process occurs at a subsequent user access of a computing device such as computing device or computing device .

The above described systems and methods tools enable balancing security with usability facilitating secure user access to sites and locations from multiple computing devices utilizing a roamable credential store RCS . These and other techniques described herein may provide significant improvements over the current state of the art potentially providing more secure access to multiple secure sites on multiple computing devices and potentially providing a better user experience by lowering the usability costs for such secure access.

Although the system and method has been described in language specific to structural features and or methodological acts it is to be understood that the system and method defined in the appended claims is not necessarily limited to the specific features or acts described. Rather the specific features and acts are disclosed as exemplary forms of implementing the claimed system and method.

