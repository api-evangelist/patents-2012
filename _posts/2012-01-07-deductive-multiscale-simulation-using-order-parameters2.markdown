---

title: Deductive multiscale simulation using order parameters
abstract: Illustrative embodiments of systems and methods for the deductive multiscale simulation of macromolecules are disclosed. In one illustrative embodiment, a deductive multiscale simulation method may include (i) constructing a set of order parameters that model one or more structural characteristics of a macromolecule, (ii) simulating an ensemble of atomistic configurations for the macromolecule using instantaneous values of the set of order parameters, (iii) simulating thermal-average forces and diffusivities for the ensemble of atomistic configurations, and (iv) evolving the set of order parameters via Langevin dynamics using the thermal-average forces and diffusivities.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09652596&OS=09652596&RS=09652596
owner: Indiana University Research and Technology Corporation
number: 09652596
owner_city: Indianapolis
owner_country: US
publication_date: 20120107
---
This application is a U.S. national counterpart application of International Application Ser. No. PCT US2012 020569 filed Jan. 7 2012 which claims the benefit of U.S. Provisional Patent Application No. 61 430 673 filed Jan. 7 2011. The entire disclosures of both of the foregoing applications are hereby incorporated by reference.

This invention was made with government support under Grant No. CHE 1037383 awarded by the National Science Foundation under Grant No. EB008951 awarded by the National Institutes of Health NIBIB and under Grant No. DE FG02 05ER25676 awarded by the U.S. Department of Energy. The U.S. Government has certain rights in the invention.

The present invention relates generally to deductive multiscale simulations of macromolecules and more particularly to deductive multiscale simulations of macromolecules using order parameters that model one or more structural characteristics of the macromolecules.

Microbes such as viruses and bacteria are organized hierarchically. For example a virus is constituted of atoms assembled into macromolecules which in turn constitute several substructures. For a non enveloped virus the latter are genetic material and the capsid. For an enveloped system such as dengue virus there is an outer protein net a lipid zone and an inner RNA protein complex. Accompanying this hierarchical organization is a spectrum of time and length scales.

Modern nano characterization experimental methodologies make the development of microbial simulation approaches timely. For example atomic force microscopy AFM may be employed to investigate a range of biological processes from unfolding of a single molecule to nano indentation of viruses. A standard AFM can scan a sample more than 10 thousand times per second yielding an ensemble measurement that parallels a statistical mechanical approach. Thus to model such experiments computationally a framework is needed that addresses structures in a range of sizes from single macromolecules to viruses and bacteria without losing information at any time or length scale.

Nano technical methods for characterizing macromolecular assemblies include AFM Ion Mobility Mass Spectrometry chemical labeling and nano pore measurements. While these techniques provide information on structure they are coarse grained in that they do not resolve all atom configurations. X ray and electron microscopy provide detailed structure but do not provide information on dynamics. Solid state nuclear magnetic resonance NMR techniques do provide an ensemble of atom resolved structures but cannot be used to give overall structure for a macromolecular assembly. A method which integrates multiple types of nano characterization data with a predictive all atom simulation approach would greatly advance the understanding of microbial systems.

The above and other experimental techniques can be performed under various microenvironmental conditions such as salinity and pH. These variations modulate interactions between solvent accessible parts of the microbe and host medium atoms inducing structural and functional changes of the former. An all atom model is often essential to correctly probe these interactions. Structural fluctuations and internal dynamics are a central feature of many biological processes. For example in the presence of an energy barrier the atomic fluctuations allow self organization of lipids in membranes. Fluctuations are also important in expressing the conformational diversity of macromolecules that allows for large deformations upon drug binding. Similarly excessive fluctuations in viral epitopes appear to diminish immune response and may explain the dependence of immunogenicity on their fluctuations. Thus an all atom description is desirable to account for all sources of fluctuation in simulating the aforementioned processes and hence has been the basis of traditional molecular dynamics MD approaches.

All atom MD simulations of macromolecular assemblies involving more than a million atoms such as a virus in an explicit solvation environment require large computational capabilities and have been accomplished using more than 1000 processors for a single time course. To simulate viruses over microseconds on such a platform would require engaging this many processors for months assuming the usual femto second MD timestep . This restricts traditional MD to less than 50 nm structures and hundred nano second timescales. Hence incorporating information about atomic processes into microbe modeling has been a challenge. Billion atom MD simulations have been accomplished. However these simulations neglect Coulomb interactions bonded forces or the rapidly fluctuating proton. All of these are central to biomolecular structure and dynamics.

Multiscale approaches have been developed to address the above computational challenges. As used herein a multiscale method simultaneously accounts for processes on a range of scales. These methods may yield insights into the dynamics of a system as it simultaneously evolves across multiple scales in space and time. Existing approaches to multiscale modeling include Principal Component Analysis PCA modes to identify collective behaviors in macromolecular systems dihedral angles curvilinear coordinates to characterize macromolecular folding and coiling bead models wherein a peptide or nucleotide is represented by a bead which interacts with others via a phenomenological force and spatial coarse grained models. The foregoing approaches however suffer from one or more of the following difficulties 1 characteristic variables are not slowly varying in time 2 macromolecular twist is not readily accounted for 3 their internal dynamics and hence inelasticity of their collisions is neglected and 4 the forces involved must be calibrated for most new applications.

The present invention may comprise one or more of the features recited in the attached claims and or one or more of the following features and any combinations thereof.

According to one aspect a deductive multiscale simulation method may comprise i constructing a set of order parameters that model one or more structural characteristics of a macromolecule ii simulating an ensemble of atomistic configurations for the macromolecule using instantaneous values of the set of order parameters iii simulating thermal average forces and diffusivities for the ensemble of atomistic configurations and iv evolving the set of order parameters via Langevin dynamics using the thermal average forces and diffusivities. The deductive multiscale simulation method may comprise repeating steps ii iv at each of a plurality of Langevin timesteps. The plurality of Langevin timesteps may each be between 50 and 100 picoseconds.

In some embodiments step i of the deductive multiscale simulation method may comprise constructing the set of order parameters using an all atom reference structure for the macromolecule. The deductive multiscale simulation method may further comprise updating the all atom reference structure to reflect a deformation of the macromolecule. The deductive multiscale simulation method may also comprise adding one or more new order parameters to the set of order parameters in response to the presence of a long time tail in a correlation function.

In other embodiments step ii of the deductive multiscale simulation method may comprise determining a quasi equilibrium probability distribution of the ensemble of atomistic configurations following from entropy maximization constrained to the instantaneous values of the set of order parameters. Step iii of the deductive multiscale simulation method may comprise determining an inter atomic force field using at least one of Monte Carlo integration and molecular dynamics.

In still other embodiments the deductive multiscale simulation method may further comprise synthesizing the macromolecule modeled by the set of order parameters. The synthesized macromolecule may comprise a nano medical system.

According to another aspect one or more computer readable media may comprise a plurality of instructions which when executed by one or more processors cause the one or more processors to i construct a set of order parameters that model one or more structural characteristics of a macromolecule ii simulate an ensemble of atomistic configurations for the macromolecule using instantaneous values of the set of order parameters iii simulate thermal average forces and diffusivities for the ensemble of atomistic configurations and iv evolve the set of order parameters via Langevin dynamics using the thermal average forces and diffusivities. The plurality of instructions may cause the one or more processors to repeat steps ii iv at each of a plurality of Langevin timesteps. The plurality of Langevin timesteps may each be between 50 and 100 picoseconds.

In some embodiments the plurality of instructions may cause the one or more processors to perform step i at least in part by constructing the set of order parameters using an all atom reference structure for the macromolecule. The plurality of instructions may further cause the one or more processors to update the all atom reference structure to reflect a deformation of the macromolecule. The plurality of instructions may also cause the one or more processors to add one or more new order parameters to the set of order parameters in response to the presence of a long time tail in a correlation function.

In other embodiments the plurality of instructions may cause the one or more processors to perform step ii at least in part by determining a quasi equilibrium probability distribution of the ensemble of atomistic configurations following from entropy maximization constrained to the instantaneous values of the set of order parameters. The plurality of instructions may cause the one or more processors to perform step iii at least in part by determining an inter atomic force field using at least one of Monte Carlo integration and molecular dynamics.

While the concepts of the present disclosure are susceptible to various modifications and alternative forms specific exemplary embodiments thereof have been shown by way of example in the drawings and will herein be described in detail. It should be understood however that there is no intent to limit the concepts of the present disclosure to the particular forms disclosed but on the contrary the intention is to cover all modifications equivalents and alternatives consistent with the present disclosure and appended claims.

In the following description numerous specific details such as logic implementations and logic partitioning integration choices may be set forth in order to provide a more thorough understanding of the present disclosure. It will be appreciated however by one skilled in the art that embodiments of the disclosure may be practiced without such specific details. In other instances full software instruction sequences have not been shown in detail in order not to obscure the invention. Those of ordinary skill in the art with the included descriptions will be able to implement appropriate functionality without undue experimentation.

References in the specification to one embodiment an embodiment an example embodiment etcetera indicate that the embodiment described may include a particular feature structure or characteristic but every embodiment may not necessarily include the particular feature structure or characteristic. Moreover such phrases are not necessarily referring to the same embodiment. Further when a particular feature structure or characteristic is described in connection with an embodiment it is submitted that it is within the knowledge of one skilled in the art to effect such feature structure or characteristic in connection with other embodiments whether or not explicitly described.

Embodiments of the invention may be implemented in hardware firmware software or any combination thereof. Embodiments of the invention may be implemented as instructions carried by or stored on one or more machine readable media which may be read and executed by one or more processors. A machine readable medium may be embodied as any device mechanism or physical structure for storing or transmitting information in a form readable by a machine e.g. a computing device . For example a machine readable medium may be embodied as read only memory ROM random access memory RAM magnetic disk storage media optical storage media flash memory devices mini or micro SD cards memory sticks electrical signals and others.

In the drawings specific arrangements or orderings of schematic elements such as those representing instruction blocks and data elements may be shown for ease of description. However it should be understood by those skilled in the art that the specific ordering or arrangement of the schematic elements in the drawings is not meant to imply that a particular order or sequence of processing or separation of processes is required. Further the inclusion of a schematic element in a drawing is not meant to imply that such element is required in all embodiments or that the features represented by such element may not be included in or combined with other elements in some embodiments.

In general schematic elements used to represent instruction blocks may be implemented using any suitable form of machine readable instruction such as software or firmware applications programs functions modules routines processes procedures plug ins applets widgets code fragments and or others and that each such instruction may be implemented using any suitable programming language library application programming interface API and or other software development tools. For example some embodiments may be implemented using Java C and or other programming languages. Similarly schematic elements used to represent data or information may be implemented using any suitable electronic arrangement or structure such as a register data store table record array index hash map tree list graph file of any file type folder directory database and or others.

Further in the drawings where connecting elements e.g. solid or dashed lines or arrows are used to illustrate a connection relationship or association between or among two or more schematic elements the absence of any such connecting elements is not meant to imply that no connection relationship or association can exist. In other words some connections relationships or associations between elements may not be shown in the drawings so as not to obscure the disclosure. In addition for ease of illustration a single connecting element may be used to represent multiple connections relationships or associations between elements. For example where a connecting element represents a communication of signals data or instructions it should be understood by those skilled in the art that such element may represent one or multiple signal paths as may be needed to effect the communication.

The present disclosure describes a multiscale framework for simulating the dynamics of macromolecules also referred to as deductive multiscale modeling. As disclosed herein deductive multiscale modeling is a procedure wherein a coarse grained model is derived from fine scale equations. Specifically factors in the coarse grained equations may be constructed from information obtained from solving the fine scale equations. This yields algorithms that account for the two way transformation between the two scales. In some embodiments these algorithms may be expanded to more than two scales e.g. to include multiple levels of coarse grained variables . These algorithms may be embodied in software as a Deductive Multiscale Simulator DMS that may carry out simulations of systems consisting of 103 to 109 atoms or more. The DMS may use deductive multiscale modeling an underlying all atom molecular dynamics model and an inter atomic force field to perform simulations in a manner that preserves all atom resolution and accuracy but is orders of magnitude more computationally efficient than conventional molecular dynamics techniques. In some embodiments the DMS may be run iteratively as part of a computer aided design workflow to discover a set of system parameters that maximize an objective function. Among many other uses the DMS can be used in the discovery and or design of a number of nano medical systems including but not limited to vaccine nano particles nano capsules for the targeted delivery of molecular therapeutics genes and other nano medical structures nano particles whose surface is functionalized to adhere on the surfaces of targeted tissues for medical imaging and molecular machines useful in for example intracellular surgery. After discovery and or design using the DMS a simulated nano medical system may be synthesized using any suitable method of manufacture.

The dynamics of macromolecules may be divided into high frequency atomic vibrations and slow coherent large spatial scale conformational changes. A set of order parameters OPs may be introduced to describe the coherent overall structural changes of a macromolecule while the small amplitude high frequency atomic fluctuations may be described by an equilibrium distribution following from entropy maximization constrained to instantaneous values of the OPs. In effect the presently disclosed OPs filter out the high frequency atomistic fluctuations. These concepts may be embodied via a multiscale analysis of the Liouville equation. The result of this analysis is a set of Langevin equations all factors within which are related to an inter atomic force field. This yields a force field based multiscale algorithm that allows for all atom simulation of macromolecular structural transitions with high computational efficiency. This computational approach may be employed in fundamental and applied studies of the dynamics of macromolecules as well as the macromolecules interactions with their micro environment.

OPs characterize the state of organization of a system. As used herein OPs are coarse grained variables characterizing the overall structure and or spatial organization of a macromolecule. Introducing these OPs provides a dimensionality reduction that arrives at a practical computational algorithm for large systems and reveals the salient features of the structure dynamics of nano scale assemblies. The presently disclosed OPs are related to the underlying all atom description enabling a unified treatment based on the Newtonian Liouville equation. The present disclosure analyzes an illustrative set of OPs showing that they facilitate a complete analysis of macromolecular dynamics.

Given that the OPs evolve much slower than the 10second timescale of atomistic collisions vibrations the latter have sufficient time to arrive at a quasi equilibrium consistent with the instantaneous state of the OPs. The OPs modify the probability distribution of atomistic configurations which in turn determine the thermal average forces and diffusivities mediating OP dynamics. In this view macromolecular structural dynamics follows from the coupling of processes across multiple scales in space and time. The result of the multiscale analysis of the Newtonian Liouville equation is a set of Langevin equations of stochastic OP dynamics. If the set of OPs is incomplete i.e. its dynamics is coupled to that of other slowly changing variables then the OPs satisfy equations involving time delays i.e. memory effects as results from traditional projection operator analysis. In contrast the multiscale analysis presented here does not involve these memory effects because of the timescale separation enabled by the OPs.

According to the present disclosure the introduction of OPs serves several objectives 1 providing a set of OPs for macromolecules that capture the essence of macromolecular structural dynamics 2 providing an efficient computational algorithm to simulate structural dynamics and 3 demonstrating the applicability of the OPs to a multiscale algorithm via viral RNA simulations. Each of these will be discussed in turn below. It is desirable that the construction of macromolecular OPs be automatable so that 1 the description can readily be enriched if it is found to be incomplete and 2 the tedious process of inventing new OPs for each macromolecule is avoided. The OPs should also capture key features of the free energy landscape in order to be complete dynamically. In this way the OPs may capture key pathways for structural transitions and associated energy barriers.

As disclosed herein a multiscale analysis of a macromolecule involves the identification of OPs that describe the macromolecule s nano scale features. One property of an OP is that it evolves slowly. Slow OP dynamics emerge in several ways including inertia associated with the coherent dynamics of many atoms evolving simultaneously migration over long distances stochastic forces that tend to cancel and species population levels as in chemical kinetics or self assembly which involve many units only a few of which change on the atomic timescale.

The presently disclosed OPs relate macromolecular features to a reference structure e.g. from X ray crystallography . The OPs are introduced via 1 a transformation warping space and 2 maximizing their information content to relate them to the atomistic configurations. OPs may be constructed by embedding the system in a volume V. Basis functions U for a triplet of labeling indices may be introduced. If computations are carried out using periodic boundary conditions to simulate a large system e.g. to minimize boundary effects and to handle Coulomb forces periodic basis functions Fourier modes may be used. In other embodiments the basis functions may be spherical harmonics when the system is embedded in a spherical volume. More generally the basis functions used may be chosen for convenience to reflect the overall geometry of the system and the conditions imposed at the boundary. Furthermore the basis functions may be free of unphysical features e.g. poles . In one illustrative embodiment Legendre polynomials were found to be convenient for simulating systems with closed boundaries of rectangular geometry.

In the present disclosure points within the system are considered to be a displacement of original points . A set of vector OPs may be constructed as follows. The macromolecule deforms in 3 D space such that a point is displaced from an original point . Deformation of space taking any to is continuous and is used to introduce OPs via

The iatom in the macromolecule i 1 . . . N may be moved from its original position via the above deformation by evolving the and correcting for atomic scale details as follows. Given a finite truncation of the sum in Eq. 1 for example choosing Nnumber of OPs there will be some residual displacement denoted for each atom in addition to the coherent deformation generated by the sum 

To start the multiscale analysis the should be expressed in terms of the fundamental variables . To arrive at this relationship the mass weighted square residual m . . . m is minimized with respect to the where mis the mass of atom i. This implies

To reveal the timescale on which the OPs evolve it is convenient to define the smallness parameter m M where m is a typical atomic mass. For any of the letting be the velocity of particle i the definition of and Eq. 5 yields

Thus changes at a rate O under the assumption that the atomic momenta tend to cancel as is consistent with the quasi equilibrium probability distribution circumflex over below. Special initial conditions could make the rate of OP change scale differently. Illustrative examples of such conditions include an initial density discontinuity leading to a shockwave injection of the macromolecule at a high velocity or a sudden jump in temperature. Under these conditions the slowness of motion within our reduced dimensionality framework OPs and all the resulting advantages e.g. calculating thermal average forces may be lost. Therefore for any class of initial conditions the slow rate of OP dynamics may be confirmed before applying the multiscale ideas developed below. The present disclosure demonstrates the applicability of the scaling for typical conditions underlying macromolecular behavior.

A simple case of the relationship suggests how it captures rigid rotation. Take U k 100 010 001 to be x y and zrespectively. Neglecting the residuals Eq. 2 becomes x x y z and similar for yand z where x y zare the three Cartesian components of vector . The relationship can be written in the tensorial form . For a special case i.e. where the tensor is a rotation matrix constitutes a length preserving rotation about the CM if is relative to the CM. More generally for the above three basis functions the relationship corresponds to a mixed rotation extension compression. The OPs defined here constitute a strain tensor thereby accounting for elastic deformations. In addition the presently disclosed multiscale formulation is all atom and hence captures internal friction effects via the force field. This accounts for both elastic and viscous effects. The higher order OPs specifically second and third order capture twisting bending and more complex deformations. Such OPs may capture polyalanine folding from a linear to a globular state. The OPs may also capture nucleation and front propagation in a virus capsid. While it is not trivial to interpret all the deformations associated with the higher order polynomial defined OPs it is the generality of the presently disclosed multiscale approach that accounts for all their dynamics. Ultimately the interpretation of the OPs is embodied in the description of the phenomenon itself e.g. macromolecular structural transition.

The relationship between and is taken here to be linear. This ensures that r has a unique value for a given set of and residuals Eq. 2 . Should this not be the case as Newton s equations evolve the system could spontaneously transition to another state of order without a change of microstate. By similar arguments application of

In the above context Eq. 4 is the origin of the unique value of for a given set of . While implies uniquely the converse is not true i.e. there is an ensemble of for given . This stems from the fact that a theory with N 

The set of OPs have technical advantages that greatly facilitate theoretical analyses. Consider an extended set of OP and OP like variables notably the for in the list of OPs plus similarly defined variables for not in the OP list. Thus 

It should be noted that even though the OPs are defined in terms of atoms in the macromolecule the multiscale analysis described herein accounts for both the macromolecule and the medium allowing simulation of the entire system. Since the OPs evolve on a long timescale their dynamics filter out the high frequency atomistic fluctuations residuals . The slowly evolving OPs can be projected over large intervals in time. These timesteps are appreciably larger than simple MD timesteps and therefore efficiently probe the long time behavior of a macromolecule. As the OPs are generated in an automated fashion the set may be expanded by increasing the range of the sum. As further discussed below this addresses the difficulty that arises when a limited set of OPs couples to other slow variables.

The OPs discussed above and the Liouville equation may be used to derive equations for the stochastic dynamics of a macromolecule. The analysis starts by writing the Liouville equation for the N atom probability density i.e. t L for Liouville operator L. depends on the set of 6N positions momenta and time t.

The multiscale analysis starts with a transformation of the N atom probability density from the t formulation to one that makes the multiple ways on which depends on t more explicit. This involves introduction of a set of OPs i.e. as described above for all on the list of OPs that depends on and that are shown to evolve on a timescale much greater than that of individual atomic collisions vibrations.

First may be written in a form that makes the dependence on and t of various types explicit 8 . This makes an ansatz that reformulated probability density depends on the N atom state both directly i.e. via and via a set of OPs indirectly. Similarly depends on the sequence of times t t t t t t . . . t t t where t t t. The times tfor n 0 are introduced to account for the slower behaviors in while taccounts for processes on the fast timescale i.e. tchanges by one unit when 10seconds elapse . is a small parameter as defined above. The dependence of and scaling of time are justified below.

In adopting this perspective is not a set of additional independent dynamical variables rather its appearance in is a place holder for a special dependence of on that underlies the slow temporal dynamics of . A simple example that elucidates the ansatz is the function x expsin x . x may be restated as x x where x x and x x. This transformation does not add any independent variable to the description rather it makes the discrete dependencies on x explicit. It is shown below that the dual dependence of on can be constructed if is sufficiently small. An equation of stochastic OP dynamics that preserves the feedback between the atomistic and nano scale variables is now obtained via a multiscale perturbation analysis for a classical N atom system.

The above framework may be used to derive an equation for the OP probability distribution. One finds that L naturally reveals a small parameters as described above . Starting with Eq. 8 the Liouville equation for and the chain rule one obtains the multiscale Liouville equation 

Note that Land Loperate in the space of functions that depend explicitly on variables and signifies a set of and subscripts 0 on and in Eq. 10 are henceforth dropped because of the simple dependence of . While the space of functions on which Land Loperates is composed of 6N Nvariables the 6N atomic positions and momenta plus the NOPs this does not assume that the variables are dynamically independent. Rather from Eq. 9 the dependence of on and may be determined and ultimately through Eq. 8 how depends on . Hence Eqs. 9 11 do not imply that and are independent dynamic variables but in accordance with Eq. 8 the equations track the multiple space and time dependencies of . There are still 6N dynamical variables as the OPs do not evolve independently of the 6N atomic positions and momenta. Eq. 4 and Eq. 6 show the explicit dependencies of atomic and coarse grained quantities. In summary to uncloak the explicit space time dependencies of the N particle density 6N Nvariables are used of which Nare not independent of the remainder with dependencies defined via Eq. 4 and Eq. 6 . As no additional independent variables are added to the description of the N atom system still remains a function of the 6N dynamical variables. Furthermore the O scaling of the Liouville equation is a natural consequence of the slowness of OPs. This justifies a perturbative solution and hence the dependence of the N atom probability density. With this the N atom probability density may be constructed as

The expression for diffusivities provided above involves an integration of the correlation function over all time. However if the correlation function decays on a long timescale i.e. on that comparable to OP evolution the above Smoluchowski equation would be replaced by one that is non local in time. This would suggest that the set of OPs couples to other slow variables. Since the OPs are generated automatically as described above new slow variables can be added in a straightforward way to make the existing set complete e.g. eliminating the long time tail . Completing the set of OPs modifies the operator L and hence the velocity correlation of Eq. 13 as the latter involves derivatives with respect to at constant . This modifies the diffusivities affecting dynamics of the OPs on the free energy surface they define. Such an operator is automatically accounted for via standard MD codes when the correlation time of OP velocities is short relative to the timescale of OP evolution. Thus the long time behavior of correlation functions provides a completeness criterion for the set of OPs and thereby a self consistency check for the theory and computations.

Another self consistency check is related to refreshing of the reference structure . In the illustrative embodiment simulations begin with the energy minimized and thermally equilibrated X ray crystallographic or other all atom structure as the reference structure. As the system evolves in time the resulting deformation may increase some of the residuals. This may reflect the need for a new reference structure. The reference structure transition point is chosen when the maximum residual for a structure in the constant OP ensemble becomes comparable with its root mean square deviation RMSD from the initial reference structure

As discussed above new OPs may be added in order to redefine the set of OPs e.g. to eliminate the long time tails of correlation functions and to account for the systematic growth of residuals that is not accounted for via re referencing. In principle a simple addition of higher order OPs to the set of existing ones until the complete elimination of the long time correlation tail would suffice. However this might include some unnecessarily high frequency modes as OPs. As a result the Langevin timestep would be reduced affecting the efficiency of multiscale simulation. Efficiency may be restored by optimal choice of the OPs to be added. For example a nanosecond MD run may be performed and the resulting configuration time courses may be used to rank the omitted OPs according to their average rate of change. Variables that qualify as OPs are slow and coherent whereas residuals that are described by are highly fluctuating with mean close to zero further discussed below . The former may be added one at a time to the list of existing OPs and new ensembles may be generated by sampling the remaining variables. This process may be repeated till the residuals become reasonably small and the long time tail in the auto correlation function is eliminated. This procedure favors the addition of slow variables and hence consideration of high frequency modes as OPs may be avoided. Such a procedure may also be used in selecting OPs to start the simulations.

Multiscale analysis provides a numerical simulation approach implied by the feedback between nano and atomic scale variables. As and are OP dependent they are computed at each Langevin timestep to account for the inter scale feedback. A finite Langevin timestep t advancement takes the OPs from time t to a time t t via Eq. 16 . Thermal forces may be efficiently computed via an ensemble Monte Carlo integration method enabled by the nature of the OPs. Atomic forces obtained from the residual generated OP constrained ensemble are used to calculate the OP force . Monte Carlo integration averaging of over the ensemble is carried out to obtain the thermal circumflex over average force . Hence the free energy driving force is obtained via the all atom probability density circumflex over capturing the cross talk between the OPs and individual atomic degrees of freedom. Since circumflex over reflects the OP constrained ensemble the 6N atomic degrees are consistent with the state of the OPs. It should be noted that the definition of as OP derivative of free energy in Eq. 14 and as time integral of OP velocity auto correlation function in Eq. 13 is independent of the linearity in the relationship. This implies that the multiscale analysis developed can be applied to any complete set of slow variables provided that the O time scaling and Newton s laws of motion hold for their dynamics. The presently disclosed OPs form a set of slow variables that has suitable properties to serve as a basis for a deductive multiscale simulation. It will be appreciated that other sets of slow variables can also be used in other embodiments as long as the criteria for OPs dynamics are satisfied.

The diffusivities may be computed via the correlation functions of Eq. 13 using short MD runs because the correlation times in these functions are much shorter than the characteristic timescale of OP evolution. All factors in the OP dynamics equation Eq. 16 are computed from the inter atomic force field via Monte Carlo integration and MD. Thus the only element of calibration in constructing the thermal average forces and diffusivities is through the existing force fields e.g. CHARMM or AMBER . At each Langevin timestep the updated OPs are used to generate the atomistic configurations of the macromolecule then the host medium is introduced via a re solvation module and the entire system is thermalized. An ensemble of such equilibrated atomistic configurations is used to generate the thermal average forces and diffusivities. The latter factors are used to evolve the OPs via Langevin dynamics completing one cycle of the Langevin timestepping.

This method of interscale feedback from the OPs to the ensemble of atomistic configurations characterized by the quasi equilibrium probabilities and in turn back to the OPs is summarized as a simplified flow diagram in . The method may begin with a reference structure that is cast in terms of variables describing the systems at the shortest space time scale. In the illustrative embodiment this fine scale description is cast in terms of the positions and momenta of all atoms in the system. As described above the method may construct a set of OPs that model the structural characteristics of the system e.g. the position shape size and orientation of major components of a macromolecule. As shown in as the OPs evolve slowly in time the OPs change the conditions determining the ensemble of atomistic configurations . In the illustrative embodiment the ensemble atomistic configurations are described by an equilibrium distribution following from entropy maximization constrained to instantaneous values of the OPs . The method may next involve determining thermal average forces and diffusivities arising from the molecular dynamics of the ensemble atomistic configurations . In the illustrative embodiment the thermal average forces and diffusivities are efficiently computed using an ensemble Monte Carlo integration method. Finally these thermal average forces and diffusivities drive the Langevin dynamics of the OPs completing a feedback loop in the method . In one illustrative embodiment the method may be performed iteratively over a plurality of Langevin timesteps by the DMS.

In the illustrative embodiment describe above the OPs are defined over the macromolecule. As with the atomic configurations of the macromolecule water and ions are accounted for via the quasi equilibrium ensemble i.e. the configuration of the water and ions rapidly explores a quasi equilibrium ensemble at each stage of the OP dynamics . This assumption holds only when water and ions equilibrate on a timescale much smaller than that of OPs. Fluctuations from water and ions modulate the residuals generated within the MD part of the constant OP sampling and affect the thermal average force. As such the water and ions may be excluded from the definition of the OPs as discussed above . If slow hydrodynamic modes are found to be of interest however these atoms may be included in the definition of the OPs. Ions tightly bound to the macromolecule may be considered a part of OPs. After every Langevin timestep an ion accessible surface is constructed and ions close to the surface are tracked during the MD ensemble enrichment calculation. Ions with appreciable residence time within the surface are included in the definition of the OPs henceforth.

As mentioned above for some choice of initial data the O contribution to tilde over W can have short timescale dependence e.g. due to a shock wave . Under this condition the basic assumption of the lowest order quasi equilibrium behavior is violated as the O scaling of the OP motion is disturbed. In such a case one expects Fokker Planck behavior. The present formulation may be generalized to accommodate such inertial effects. For the illustrative macromolecular phenomena considered below however this class of initial data was ignored.

A study was undertaken to assess performance of the OPs described above in a DMS for simulating macromolecules. An evaluation of other variables in this context was also obtained. Comparisons with traditional MD were made to determine accuracy and efficiency. All multiscale simulations were done using the DMS based on the OPs and the multiscale analysis described above. In the illustrative embodiment the CHARMM22 27 force field and NAMD software were incorporated into the DMS as part of the computation of the thermal average forces and diffusivities.

The demonstration system was the RNA of a Satellite Tobacco Mosaic Virus STMV . This molecule contains 949 nucleotides. The initial state of this system is believed to be at equilibrium when the RNA resided with the associated proteins within the STMV capsid. Evolution follows instantaneously after the capsid is removed. The simulated host medium was 0.3M NaCl solution and the temperature was 300K. The system was placed within a cube and NVT conditions were applied. Details of the NAMD settings are given in Table 1 below. Simulations were done in these conditions as more dramatic structural changes occur because the RNA is more stabilized by Mg than by Na. This is because Na is expected to be diffusively bound to RNA whereas Mg remain tightly bound.

As mentioned above the slowness in rate of change of a typical OP 001Z was examined to evaluate its applicability within the multiscale framework. The OP considered in particular exhibited properties of dilation extension about the Z axis. The time evolution of this OP was compared to other variables to validate that some of the latter are not suitable as slow variables for the purpose of a multiscale analysis. If the fluctuations in these variables probe short space time events then they are expected to be accounted for by the quasi equilibrium ensemble otherwise larger space time events are accounted for by one or more of the OPs.

Some other variables commonly used to characterize macromolecules denoted structural parameters SPs herein may be compared with the dynamics of the OPs described above. The SPs analyzed in the present disclosure are different types of dihedrals and their cosines radius of gyration end to end distances and typical components of the unit vectors along the bonds connecting monomers. These SPs are designated herein as SP SP SP and SP respectively. Each of these SPs was calculated over a 1 ns MD trajectory for the RNA under conditions mentioned above. The moving averages were calculated over a window of 50 ps to filter out the coherent part of the variations from the fluctuations . These fluctuations were calculated using 

The time evolution of these SPs was compared to that of the OPs described above. Fluctuations in SPand SPwere several orders of magnitude higher in amplitude than those for the OPs and or their characteristic timescale was much shorter. Hence they do not evolve slowly and cannot serve as a basis of a multiscale analysis. Finally SPand SPare suitable as OPs but do not readily enable the generation of SP ensembles as they are a subset of a more general set of OPs. This presents difficulties in computing thermal average forces and diffusivities needed for a multiscale analysis. In contrast the OPs described above are automatically generated and therefore the set can be augmented for systems of higher complexity. Furthermore the end to end distance and radius of gyration are accounted for via the more general OPs as discussed below .

As system size increases the OPs become better filters of the high frequency fluctuations. To validate this heptaalanine with 8000 water molecules was simulated in a cubic box of side 44 under settings set forth in Table I. Fluctuations in OPs for larger systems are found to be much smaller than those of smaller ones i.e. the same OP shows amplified fluctuations as the system is changed from RNA to heptaalanine . Distinct differences in length scales allow better separation of the lower order OPs from those of the higher order ones in the RNA. This facilitates filtering of the low and high frequency modes. For smaller systems like heptaalanine the length scale separation diminishes. In such situations OPs cannot facilitate filtering of high frequency fluctuations and consequently the implementation of multiscale analysis may become inefficient.

The choice of OPs depends on the characteristics of the system of interest. This can be understood a priori via analyzing OP evolution for short MD trajectories and observing the decay in the OP velocity auto correlation functions. It was found most efficient for the present problem to only use 4 OPs i.e. the center of mass and 3 corresponding to overall extension dilatation . To verify completeness of this set of OPs for the present problem the OP velocity auto correlation functions were plotted for a window of 1 ps. The correlation decayed sharply on a timescale much shorter than that of OP evolution i.e. the OPs were constant over the time of auto correlation decay . The decay zone was followed by a fluctuating phase that reflects insufficient statistics for constructing long time correlation function behavior. illustrates a plot of several auto correlation functions for 1 ps trajectories with identical starting structure and initial conditions but different random seeds for generating initial velocities. In principle an average of such single MD simulation derived correlation functions is required to compute the diffusivities. However using only the early part of a single MD correlation function wherein the most statics are accumulated as shown in was found to suffice. Furthermore the correlation analysis validates the completeness of the set of OPs as there is no long time tail behavior in the correlation functions.

Omission of a slow variable that couples with the existing set can lead to a long time correlation tail. To validate this the correlation calculation was redone without the 100X OP. This led to a long time tail in the velocity auto correlation function for the 001Z and 010Y OPs. In general terms the deformational behavior in a given Cartesian direction is driven by forces that depend on the OPs in all directions. Therefore a missing OP will create an ensemble of atomic configurations that reflect its absence which in turn is expressed in slower behavior of the retained OP velocities and hence the associated auto correlation functions. Simultaneously the ensemble had a major population of structures with very high residuals 10 also signaling omission of a slow mode. Therefore the diffusion calculation indicates the absence of a key slow variable that can be optimally added to the existing set via the procedure described above. Due to orthogonality of the basis functions described above the cross correlation functions between different OPs are several orders of magnitude smaller than the auto correlation functions this implies that the OPs are not coupled through the diffusivities but only through the OP dependence of the thermal average forces. This greatly simplifies the construction of the random forces as they are related to the diffusion matrix.

Constructing higher order OPs from an MD run via Eq. 4 shows that they are highly fluctuating and therefore not appropriate as OPs. Rather they are accounted for via the quasi equilibrium probability density i.e. in the ensemble used to calculate averages . As discussed above the ensemble of atomistic configurations is generated via Eq. 2 . The residuals are generated by a formula similar in structure to that used to obtain the atomic positions but the sum over basis functions do not include those associated with the OPs.

Addition of OPs to a pre existing set is needed in various cases. If the system is changed e.g. if it is composed of multiple macromolecules then more OPs are required to form a complete set. The added OPs probe complex inter macromolecular motions. New OPs could also be added in a dynamic fashion in the course of a simulation to account for types of motions absent initially. As mentioned above the appearance of long time tails in the correlation functions later in a simulation is a key indicator of the need to augment the set of OPs.

To assess the accuracy of the DMS comparisons were carried out with conventional MD simulations for trajectories of 10 ns. On removal of the viral capsid the RNA is no longer constrained and tends to expand. Following initial expansion the RNA shrinks and finally fluctuates among a range of distinct atomistic states of similar energy. shows the radius of gyration obtained with MD and with the presently disclosed DMS while shows the progress of the RMSD from the initial structure as a function of time. Agreement of the radius and the RMSD between MD and the DMS is excellent. plots OP time courses from the final 5 ns of conventional MD and the DMS . These results show that both the structures are essentially a part of similar OP ensembles having similar overall characteristics and confirm that the multiscale simulation is generating configurations consistent with the same value of the OPs that arise in MD. However the multiscale simulation of the presently disclosed DMS actually corresponds to an ensemble of MD simulations see below . Significantly the multiscale simulation captures the overall structural dynamics which is often the main interest. However the atomistic configurations are also accounted for via the quasi equilibrium distribution. This illustrates that radius of gyration and end to end distance as mentioned above is accounted for by the OPs. shows the potential energy for the multiscale simulations which fluctuates about a constant value. Energies show identical trend and are within a percent of those from the MD run. This shows that the RNA gains stability as the potential energy gradually decreases. Energies from the MD and the DMS generated trajectories show excellent agreement in trend as well as in magnitudes. The observed difference is within limits of those from multiple runs starting from the same initial structure with different initial velocities. As another basis of comparison time evolutions of the number of intra macromolecular hydrogen bonds for both methods are shown in . Hydrogen bonds are defined solely on the basis of geometric parameters bond angle 20 bond length 3.8 between donors and acceptors. Initial expansion reduced the number of these bonds primarily the ones involved in the RNA tertiary structure . The number of bonds decreased less rapidly in the later part of the trajectories when expansion ceased. A detailed account of the various types of hydrogen bonds is given below.

One advantage of multiscaling is the potential to use timesteps of tens or hundreds of picoseconds or greater in contrast to the 10sec of conventional MD . For relatively slow processes in large systems this speed up over conventional MD is significant. 128 processors were used to assess the efficiency of the presently disclosed DMS. During the initial transient 40 ps timesteps were used. To accommodate the initial expansion and account for the structural anisotropy the RNA was re solvated in a bigger box Table 1 after the first 3 ns. Post initial transient Langevin evolution was executed using 150 ps timesteps reflecting the longer characteristic time for this phase. In this slower evolution regime probed till 50 ns for the study efficiency becomes 11 fold. However comparison with a single MD run is not appropriate since the DMS corresponds to ensemble MD. In this study a single DMS simulation corresponds to an ensemble of 168 traditional MD runs. While for each MD run the OP time course is essentially the same as that predicted by the DMS the detailed atomistic configuration varies dramatically among members of the ensemble. This factor of 168 comes from the sample size used in the Monte Carlo integration to compute the thermal average forces. Finally a single MD run may not be representative of an ensemble of possible time courses which in contrast is automatically overcome in the presently disclosed DMS. If the finer short timescale structural transition is of interest it can be pursued by either shorter timescale traditional MD runs or by including more OPs although this will decrease the minimum characteristic time of OP dynamics and therefore reduce the efficiency of multiscale simulations . Selecting OPs for running the multiscale simulation involves an initial analysis of their time trends over the 1 ps to 1 ns timescale. However this analysis need not be repeated in the course of simulations until the emergence of new OPs thereby restoring efficiency to the multiscale simulation.

Making use of the above efficiency the long time behavior of the RNA was probed using the presently disclosed DMS. shows a plot of potential energy versus time for the RNA. The energy decreases and fluctuates about a minimum. shows a plot of the radius of gyration for the 50 ns trajectory. Following rapid initial expansion RNA gradually shrinks for 30 ns before reaching a dynamic equilibrium wherein it fluctuates about 50 . These overall changes in shape and size are tracked by the OPs. Their values also gradually decrease before flattening out. However the magnitude of the three OPs is different probing different extents of deformation along the three Cartesian axes. This is consistent with the fact that even though overall shape and size follow simple trends reflected in the anisotropy in the system leads to a symmetry breaking which is tracked by the OPs and the constant OP ensemble. validate that the initial symmetry is completely lost in the course of the simulation. In the final structure shown in after 50 ns the tertiary structure of the RNA is highly disrupted though secondary structure still remains. The latter is in agreement with experiments that suggest free RNA can possess some secondary structure. shows the RMSD over the entire 50 ns trajectory. RMSD shows a rapid increase followed by a gradual one. The increase in RMSD over the final 20 ns trajectory signifies that even though the energy overall shape and size OPs change negligibly there are local non coherent changes that are accounted for by the constant OP ensemble i.e. fluctuations in the higher order OPs . Thus the presently disclosed DMS captures the exploration of multiple iso energetic configurations by the RNA.

The gradual shrinkage of RNA is explained on the basis of ion shielding effects. shows that the radius of the ion cloud decreases with time. Thus the ion cloud concentrates and distributes about the RNA shielding the electrostatic repulsion between similarly charged nucleic acid residues in the RNA causing them to come closer. When the cloud is removed similarly charged groups mutually repel and the RNA expands instead of shrinking. To confirm the above physical picture the structure at the end of 20 ns was de ionized and a further 7.5 ns simulation was carried out in aqueous solvent. The expansion due to electrostatic repulsion was reflected in the radius of gyration and OP changes over this simulation. A 1 1 electrolyte was used since the ions are diffusively bound and exchange positions unlike for tightly bound ions such as Mg justifying their inclusion as a part of the ensemble and not as an OP. Even though the ions are not included in an OP calculation their rapid quasi equilibrium redistribution accompanying structural changes in the OP defined macromolecule at each Langevin timestep correctly accounts for the ion cloud around the RNA. Closely related to the distribution of ions is the distribution of water and hydrogen bonds. The total number of hydrogen bonds remains constant throughout the 50 ns simulation. However the number of nucleic acid water hydrogen bond decreases while those for water water hydrogen bonds increases conserving the total number of bonds as shown in . This phenomenon is consistent with mobile ion screening induced RNA shrinkage. As the RNA shrinks water from the inner RNA cavity is expelled thereby increasing the number of bulk water water interactions. These shifts in sodium ion population coordinated with hydrogen bond rearrangement guide the system to the final structure. There is also a re distribution of inter nucleotide hydrogen bonds as the RNA samples iso energetic configurations in the final 20 ns. This shift in hydrogen bonds is shown between from region to region . However the total number of nucleic acid nucleic acid hydrogen bonds is conserved as shown in the plot of .

While coherent structural dynamics are tracked by changes in the OPs additional high frequency macromolecular motions are captured by the residual modified MD generated ensemble. These high frequency modes capture small timescale local alterations over and above the OP mediated deformations in the RNA and consequent effects on atom scale features like the hydrogen bond distribution. However other complex and or slow modes like bending or twisting can arise in the course of the RNA dynamics and affect the hydrogen bonds. As stressed above emergence of new modes can be captured by the OPs described above and are signaled by the self consistency checks. Within the simulated period of time 50 ns no long time velocity auto correlation tails or significant populations of high residual structures signifying the absence of additional slow modes were detected. A plausible explanation is that in viral RNAs it is possible that the bending modes leading to an unfolding transition appear much later in the time course 50 ns of structural evolution or secondary structure disruption occurs at a temperature much higher than 300K.

A control experiment was also performed to compare the deformation in the free RNA versus that in protein encapsulated RNA. The simulation was rerun using identical physical conditions temperature salinity and software settings for the RNA core of STMV. The RNA core is composed of capsid protein strands residue 2 to 27 complexed with the RNA. This complex is found to be stable with a radius distribution of 50 . The added protein segments complex with the RNA reducing the degrees of freedom. The structure was energy minimized and thermally equilibrated before starting the multiscale simulation. Time evolution of the OPs the RMSD and the structures for this simulation are shown in . also shows the RMSD for free RNA. RMSD of RNA in the bound state is much less than in the free state. Unlike the previous case where the difference in the OPs was large here the difference is small and their change is slower this suggests the preservation of the symmetry originally imposed by the capsid. Thus changes in the protein RNA complex are much less than those of free RNA. This longer characteristic time allows more efficient application of OP dynamics as now timesteps of the order of 250 ps are possible. This implies that the presently disclosed DMS is 16 times faster than a single conventional MD for the present problem.

The simulations described above validate the presently disclosed DMS that probes the dynamics of macromolecules using OPs. The OPs are slowly varying and hence are well suited as a basis of the multiscale algorithm. Completeness of a set of OPs may be determined by the shortness of correlation times relative to the characteristic time of OP evolution. Automated construction of order parameters enables efficient augmentation of the set of OPs to address incompleteness. The DMS results show excellent agreement with those from a conventional MD run. The DMS efficiency increases for larger systems undergoing slow transformations as these allow significant length and timescale separation for the OPs to filter out the high frequency fluctuations from the coherent dynamics. Thus OP mediated coarse graining of the free energy landscape allows for a Langevin timestep of a few hundred ps 10times greater than conventional MD . The DMS predictions correspond to an ensemble of MD trajectories and hence are more statistically significant than results from a single MD run. Multiscale simulation via the OP description was found to capture significant structural details like ion screening hydrogen bond rearrangement and symmetry breaking transitions. In summary the presently disclosed DMS is ideally suited for studying structural dynamics in large macromolecules and macromolecular complexes.

While the disclosure has been illustrated and described in detail in the drawings and foregoing description such an illustration and description is to be considered as exemplary and not restrictive in character it being understood that only illustrative embodiments have been shown and described and that all changes and modifications consistent with the disclosure and recited claims are desired to be protected.

