---

title: Apparatus and method for determining microscale interactions based on compressive sensors such as crystal structures
abstract: Techniques for determining values for a metric of microscale interactions include determining a mesoscale metric for a plurality of mesoscale interaction types, wherein a value of the mesoscale metric for each mesoscale interaction type is based on a corresponding function of values of the microscale metric for the plurality of the microscale interaction types. A plurality of observations that indicate the values of the mesoscale metric are determined for the plurality of mesoscale interaction types. Values of the microscale metric are determined for the plurality of microscale interaction types based on the plurality of observations and the corresponding functions and compressed sensing.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09014988&OS=09014988&RS=09014988
owner: The Board of Trustees of the Leland Stanford Jr. University
number: 09014988
owner_city: Palo Alto
owner_country: US
publication_date: 20120322
---
This application claims benefit of Provisional Appln. 61 466 465 filed Mar. 23 2011 the entire contents of which are hereby incorporated by reference as if fully set forth herein under 35 U.S.C. 119 e .

This invention was made with Government support under Grant No. DE FG02 05ER64136 awarded by the Office of Science of the Department of the Energy. The Government has certain rights in the invention.

The determination of microscale interaction energies also called potentials herein during binding or folding of large molecules such as proteins and nucleic acids has been limited by the experimental difficulty of directly measuring atomic scale interactions within such large molecules. Furthermore the number of interactions involved is very large as each atom type in one molecule can possibly interact with each atom type in itself for folding or the other molecule for binding . The interaction is often distance dependent further increasing the number of interactions for which interaction energies are to be determined. For example if it is assumed that a dozen atom types in one molecule can interact with each of twenty atom types in another molecule at each of 15 different distances then the number of interaction energies to determine is 3 600. In general the combinatorially large number of measurements required to comprehensively characterize the potential that describes all possible microscale interactions in a molecular system is at least daunting and expensive if not prohibitive. As a result of this experimental intractability interaction energies to date have relied on theoretical models.

Therefore there is a need for an approach for determining values for a microscale interaction metric such as interaction energy which does not suffer one or more of the disadvantages of prior approaches such as relying on theoretical models or numerous a priori assumptions. Techniques are provided for determining based on compressive sensing values for a metric of microscale interactions beyond direct observation. In various embodiments the compressive sensors are mesoscale interactions for which a corresponding metric is a function of values for the metric of some or all of the microscale interactions. In several embodiments the compressive sensors are crystal structures.

In a first set of embodiments a method includes determining a microscale metric for multiple microscale interaction types and determining a mesoscale metric for multiple mesoscale interaction types. A value of the mesoscale metric for each mesoscale interaction type is based on a corresponding function of values of the microscale metric for the microscale interaction types. A plurality of observations that indicate the values of the mesoscale metric are obtained for the mesoscale interaction types. Values of the microscale metric for the microscale interaction types are determined based on the observations and the corresponding functions and compressed sensing.

In some embodiments of the first set the microscale interactions include sub molecular interactions involving a plurality of atoms or atom complexes.

In some embodiments of the first set the mesoscale interactions include molecular interactions involving at least one large molecule.

In some embodiments of the first set each of the plurality of observations comprises relative rate of occurrence of the mesoscale interactions in a canonical ensemble.

In some embodiments of the first set the metric of the mesoscale interaction is binding energy or folding energy.

In some embodiments of the first set a majority of values of the metric for the plurality of microscale interactions are negligible.

In other sets of embodiments a computer readable medium or an apparatus is configured to perform one or more steps of the above methods.

Still other aspects features and advantages of the invention are readily apparent from the following detailed description simply by illustrating a number of particular embodiments and implementations including the best mode contemplated for carrying out the invention. The invention is also capable of other and different embodiments and its several details can be modified in various obvious respects all without departing from the spirit and scope of the invention. Accordingly the drawings and description are to be regarded as illustrative in nature and not as restrictive.

A method and apparatus are described for determining values of a metric of microscale interactions based on compressive sensors. In the following description for the purposes of explanation numerous specific details are set forth in order to provide a thorough understanding of the present invention. It will be apparent however to one skilled in the art that the present invention may be practiced without these specific details. In other instances well known structures and devices are shown in block diagram form in order to avoid unnecessarily obscuring the present invention. Various references are cited in the following. The entire contents of the following references are hereby incorporated by reference as if fully set forth herein except for terminology that is inconsistent with the terminology used herein. As used herein the following terms and abbreviations have the meanings given in Table. 1.

Some embodiments of the invention are described below in the context of binding energy of mesoscale protein DNA binding and values of potential of microscale atom atom interactions. However the invention is not limited to this context. In other embodiments microscale interaction energies are determined for protein protein binding and protein folding and other molecular binding or folding interactions. In some embodiments other metrics of microscale interactions are determined such as kinetic metrics including residence binding efficiency and residence times. In some embodiments the microscale interactions are not atomic interactions. For example in some embodiments a microscale interaction is an interaction among multiple atoms on each of the two interacting molecules. In some embodiments a microscale interaction is a complex system of multiple molecules in conjunction with a solvent or crystal.

In some embodiments the same elements interacting at different distances are treated as different interactions rather than a distance dependent interaction of those elements. In some embodiments an interaction depends on the chemical environment of the interacting elements in which case the same elements interacting in different chemical environments e.g. at different locations along a long molecule correspond to different interactions.

In the illustrated context the binding of the protein DNA complex captured in a crystal structure is the mesoscale interaction and the atom atom interactions are the microscale interactions. The binding energy is enough to form the compound that is crystallized. Furthermore crystal studies e.g. x ray crystallography indicate the position and orientation of atoms in the region of binding so that the functional dependence of each mesoscale interaction type on each microscale interaction type is known or approximated. In other embodiments other techniques e.g. nuclear magnetic resonance cryo electron microscopy or atomic force microscopy are used to determine the microscale interaction types in each mesoscale interaction type and thus the corresponding function for each mesoscale interaction type. It is recognized here that of all the possible atom atom interactions only a limited number are non negligible for protein DNA binding. That is the solution matrix is sparse. For example atoms of type on DNA molecule do not interact with atoms of type on protein molecule . This realization allows one to use the methods of compressed sensing.

Thus according to some embodiments by examining the binding energies or relative occurrences of interactions of several different protein DNA complexes e.g. in corresponding different crystals and using the linear regression methods of compressed sensing the atom atom interaction energies can be inferred.

The method involves a novel mathematical formulation that recasts the determination of potentials at the microscale for example as a signal acquisition problem using compressed sensing techniques. By exploiting a key property of compressed sensing discussed below the experimental intractability of determining potentials for example is circumvented. This formulation rests on three key observations. i In certain systems e.g. biomolecular interactions only a few types of inter atomic interactions such as hydrogen bonds are energetically important. ii Mesoscale interactions e.g. protein DNA binding can be viewed as sensors of and thus somewhat known functions of the underlying microscale potential. iii In embodiments that target potentials there is a correspondence between the mathematical formulation of logistic regression and the statistical mechanical concept of the canonical ensemble.

Using these ideas the determination of potentials is formulated as a tractable signal acquisition problem as described in a later section. Central to this approach is the distinction between microscale and mesoscale interactions. An important characteristic is that mesoscale interactions be comprised of microscale interactions such that a value of the metric e.g. binding energy of a mesoscale interaction is a function of the values of the metric e.g. potential of its constituent microscale interactions. The function that identifies or approximates or otherwise indicates the microscale interactions constituting each mesoscale interaction must also be known or approximated. Some embodiments include determining for each mesoscale interaction type the corresponding function of values of the microscale metric for the plurality of the microscale interaction types. In various embodiments for each mesoscale interaction the corresponding function is determined based on measurements from a member of a group comprising x ray crystallography nuclear magnetic resonance cryo electron microscopy and atomic force microscopy or equivalents thereof. In the illustrated embodiments the term mesoscale interactions refers to interactions between molecules or molecular complexes while microscale interactions refers to interactions at the atomic scale. This distinction is ultimately application specific and depends on what interaction metrics are to be determined and what experimental data is available.

When these requirements are met substantively the method can determine the values of the metric e.g. potential of the microscale interactions using observations that indicate the values of the metric e.g. binding energy or probability of the mesoscale interactions as the experimental data. For protein DNA interactions the mesoscale interactions are protein nucleotide binding events represented by protein DNA crystal structures with known binding energies or relative binding probabilities and the microscale interactions are pairwise distance dependent contacts between protein atoms and nucleotide atoms standard atom type categories are used and distances are segmented into discrete bins whose widths are treated as model parameters as described below .

Thus each protein nucleotide crystal structure characterizes a mesoscale interaction whose constituent microscale interactions are readily identified from the structure. In some embodiments intra protein and intra DNA energies are ignored because approximations of the protein DNA interactions are the focus. These data are used together with the known energies or probabilities of protein nucleotide binding events to infer de novo the inter atomic protein DNA potentials. In the following the compressed sensing determination of the values of the microscale metric according to the illustrated embodiments are called de novo to distinguish from purely physical or purely statistical approaches and the resulting potentials are called de novo potentials. In further steps it is shown that these de novo potentials can be used to predict protein DNA binding motifs with unprecedented accuracy.

For example as depicted in it is determined that protein DNA binding in crystals is a type of meso scale interaction for which the mesoscale metric is binding energy that represents a weighted sum of values for potential microscale metric for multiple atom atom microscale interaction types. More details on this relationship are described in subsequent sections. Observations of values for the mesoscale metric e.g. protein DNA binding energy can be direct or can be indirect e.g. deduced from relative rate of occurrence in a crystal comprising many instances of the same protein molecule bound to the same DNA molecule. From these observations and knowledge of the function e.g. weights for the microscale interactions and compressed sensing methods the values of the microscale metric e.g. potential can be derived for the non negligible microscale interaction types e.g. particular atom pairs 

In the protein DNA embodiment illustrated below the signal e is the vector of microscale interaction energies protein DNA atomic potential where each entry ein the signal vector e corresponds to the energy of an interaction between a protein atom type and a DNA atom type within a discrete distance bin. Thus the energy profile V r q for multiple radii r and atom sets q is represented by the efor all i. Each row of C arises from a distinct protein DNA crystal structure and each column corresponds to a distinct type of microscale interaction combination of protein atom type DNA atom type and distance bin . An element Cof C encodes the number of times indicated by gray levels that the ith interaction type occurs in the kth crystal structure. The set of measurements Eare the experimental direct or relative binding energies of the corresponding protein DNA complexes. Because the binding energy of a complex is the sum of the energies of all microscale interactions in the complex it is equal to the weighted sum given by the inner product between the kth row of C that encodes the kth complex and the signal vector e.

In other embodiments other microscale interaction types microscale metrics mesoscale interaction types mesoscale metrics and observations are utilized. In some other embodiments the energy measurements are of the folding energies of one or more proteins or other large molecules. Energy of mesoscale interactions is used herein to refer to either binding or folding energies of mesoscale interactions or some combination. For example in various embodiments mesoscale interactions include protein folding enzyme substrate affinities RNA DNA interactions RNA protein interactions RNA RNA interactions DNA DNA interactions protein protein binding energies DNA and protein small molecule affinities liquid solid surface interactions solid surface solid surface interactions crystal crystal interactions interactions including two three or a multiplicity of atoms interactions involving sets of defined atoms e.g. residue with base interactions involving atoms with mesoscale objects such as a solvent organic molecule or inorganic molecule interactions or a mixture of organic and inorganic molecules. If the energy of the mesoscale interaction can be obtained and an atomic resolution structure involved in the mesoscale interaction can also be obtained then regardless of the type of molecules involved the method is applicable. The accuracy achieved depends on the sparsity of the underlying microscale interactions but with sufficient data even dense microscale interactions can be inferred. In various embodiments mesoscale metrics include a direct energy or relative energy for binding energy or for folding energy.

Returning to in step multiple incoherent observations of values for the metric of different types of mesoscale interactions are obtained. Incoherence is a term used in compressed sensing literature that relates to the randomness of the set of microscale interactions sampled by the mesoscale sensor. For example physical measurements are made of the binding energies or relative occurrence rates for several different DNA sequences and the same protein in a corresponding set of different crystals. is a graph that illustrates example measure of incoherence of measurements according to an embodiment. The horizontal axis indicates the cosine of the angle between any two rows of the matrix C called sensor vectors and is dimensionless. The vertical axis indicates the fraction of the total number of pairs that have that angle and is also dimensionless. For every pair of sensor vectors derived from the dataset and used in the best performing Baseline model described below the cos values are as shown. This distribution characterizes the incoherence of the sensor matrix used. For an effective sensor matrix it is desirable to have as many of the values be close to 0 as possible. The observed distribution suggests that the dataset used can act as an effective sensor matrix with mean and median values of 0.081 and 0.041 in units of j cos j respectively. These values are significantly lower than 1 thus indicating that the set of sensors comprised by the protein DNA crystal structures in the illustrated data set has good incoherence properties.

In some embodiments obtaining the observations includes entering or retrieving data of previously made measurements such as published observations. In some embodiments obtaining the observations includes calculating the energies from partial data and accepted mathematical derivation e.g. computing binding energies of DNA sequences with at least one different base in at least one position of the sequence based on measurements of a single protein binding for a single DNA sequence. More details on obtaining observations are provided in subsequent sections.

Returning to in step values for the metric for the multiple microscale interaction types are inferred based on the observations and the methods of compressed sensing. This process is described in detail in a subsequent section where the microscale metric is interaction energy potential . Accuracy of this step relies on the degree to which the system selected in step satisfies the conditions for compressed sensing e.g. a sparse solution set with a majority of microscale interactions that have metric values that are negligible. Step includes determining reasonable values for one or more compressive sensing parameters e.g. based on training data.

Energy values for atom atom interactions at different distance ranges are indicated by the grayscale in each box with negative energies indicated by a negative sign. Boxes with no grayscale called blank boxes are negligible in terms of contributing to the mesoscale protein DNA binding energy.

Returning to in step the solution results for the metric values of the set of microscale interaction types are validated against accepted values for the mesoscale metric that involve those interaction types. Evaluation and validation procedures are described in detail in a subsequent section and confirm that the procedure works for protein DNA binding. In some embodiments in which the procedure is well accepted step is omitted.

In step the values of the microscale metric for the multiple microscale interaction types are used. For example a value for the mesoscale metric e.g. binding energy or rate of occurrence for a different mesoscale interaction e.g. different protein DNA binding than the mesoscale interaction types used to derive the values of the microscale metric is predicted based on the derived values of the metric for the microscale interaction types. The correct predictions of such mesoscale metric values are demonstrated in subsequent sections.

Although steps are depicted in as integral steps in a particular order for purposes of illustration in other embodiments one or more steps or portions thereof are performed in a different order or overlapping in time in series or in parallel or are omitted or one or more additional steps are added or the method is changed in some combination of ways.

I is used herein to indicate the set of all possible microscale interaction types. A microscale interaction type may be as simple as two atoms existing within a predefined distance of one another and as complex as a system of multiple molecules in conjunction with a solvent. Note that an interaction may depend on the distance of the interacting elements in which case the same elements interacting at different distances would correspond to different interaction types in our formulation. Distance may be defined in terms of discrete distance ranges or bins. For each microscale interaction type i I we denote the value of its metric such as its potential by e.

K is used herein to indicate the set of mesoscale interaction types. As used herein a mesoscale interaction type k K is an observable scale interaction where many microscale interactions combine to create the mesoscale interaction. For example a protein to DNA binding is a mesoscale interaction comprised of all the energetic interactions occurring between protein atoms or groups of atoms and DNA atoms or groups of atom . Formally we associate with every mesoscale interaction k K a vector C where is the set of positive integer vectors of dimension I. The vector Ccontains for each i I a count Cof the number of times that microscale interaction i is involved in mesoscale interaction k. For a microscale interaction type uninvolved in k K its corresponding count is 0. Thus Crepresents the weight of the ith microscale interaction in the kth mesoscale interaction. For each mesoscale interaction k we denote its metric such as its energy or its relative frequency of occurrence by E. By definition of mesoscale and microscale they are related for at least some metrics such as energy as given in Equation 1. for all 1 

Using this notation observations of the values of the metric Efor K mesoscale interaction types are used to determine the values of the metric e any number of which serve as parameters for new models that predict values of the metric for other mesoscale interaction types E j K when Cis known or can be approximated.

Values for eare inferred from measurements of Eusing any method known in the art. In some embodiments linear regression is used to infer the values of the microscale metric. In linear regression an output variable is considered to be the sum of products of an input variable and unknown constant coefficients. In the context of the proposed method the mesoscale interaction metric E serves as the response variable and the count vector Cserves as the input variable and the values of the microscale metric efor i I are the inferred coefficients. Within the compressed sensing framework the values of the mesoscale interaction metric Efor all K provide the set of compressive measurements the count vectors for all K provide the sensor matrix set of sensors that is the known function and the set of values of the micro scale metric efor all i I is the signal to be inferred.

If the values of the metric of mesoscale interactions cannot be observed directly but their relationship to observables are known such as relation of mesoscale binding energy to relative probabilities then a constrained version of multinomial logistic regression can be shown to infer the values of the metric of the microscale interactions. An important feature of this embodiment is the use of a specific type of statistical mechanical ensemble the canonical ensemble see for example McQuarrie D A University Science Books Sausalito Calif. pp xii 641p 2000 .

An ensemble is a collection of physical states for example the different structural conformations of a protein. In canonical ensembles the temperature volume and number of particles are assumed identical across the states but the energy may vary between states. In an illustrated embodiment different mesoscale interactions correspond to different states of a canonical ensemble. For the protein DNA binding problem this corresponds to the protein binding to alternate DNA sequences with different binding energies. The probabilities of finding a system in each of the different states of a canonical ensemble follow the Boltzmann distribution. This property is exploited to reformulate edetermination as an instance of multinomial logistic regression. In this formulation the relative probabilities of mesoscale interactions are used as experimental data. By relative probabilities is meant that the probability of a mesoscale interaction only has to be normalized with respect to two or more mesoscale interactions within the same canonical ensemble. Multiple distinct canonical ensembles can be used and so not all mesoscale interactions need to come from the same canonical ensemble.

The general formulation is first derived and then its formal equivalence is shown to multinomial logistic regression under appropriate constraint.

In this embodiment K is the set of mesoscale interactions for which observations described below are available. K is partitioned into K K. . . K blocks such that mesoscale interactions within a block Kcome from the same canonical ensemble and there are L distinct canonical ensembles. In other words for a fixed l L for all k K the temperature volume and number of particles are assumed fixed. Note that k is here used to refer to a mesoscale interaction within a given canonical ensemble.

For each canonical ensemble K measurements are taken corresponding to the relative probabilities pof every measured mesoscale interaction for all k K in the ensemble. In other words for all l L the measured probabilities obey Equation 2. 1for all 2 

Since by definition all mesoscale interactions k Kcome from the same canonical ensemble then the measured probability pof a given mesoscale interaction k is related to an energy metric of the mesoscale interactions as described by the Boltzmann distribution given by Equation 3a and 3b. exp 3a exp over all 3b Where exp indicates the exponential function of the base of the natural logarithm raised to the power of the argument inside the parentheses Ehere is the energy metric of the mesoscale interaction Zis the partition function of the canonical ensemble K and is the inverse temperature parameter for the ensemble not following the standard convention of using for the inverse temperature .

Given a set of mesoscale interactions K for which the constituent microscale interactions I are known and a partitioning of the mesoscale interactions such that the probabilities pare known for all l L the energies eof the microscale interactions I can be inferred. The derivation is not shown here but involves the steps of substituting into Equation 3a for Zusing Equation 3b substituting for Eusing Equation 1 and re arranging the terms to give a system of equations given by Equation 4. exp 4 This system of equations can be solved for efor i I. In some embodiments the inverse temperature parameters are treated as free parameters and in other embodiments the inverse temperature parameters are experimentally known temperatures of the mesoscale interactions.

In some embodiments Equation 4 is recast as a constrained version of multinomial regression. For this formulation the inverse temperature parameters are advantageously known a priori. For biological applications it is assumed that interactions occur under standard biological conditions e.g. see Berg J M Tymoczko J L Stryer L W.H. Freeman New York 6th Ed. 2007 . Furthermore for simplicity of derivation without loss of generality it is assumed that the set K is partitioned into blocks of equal size of cardinality M and indexed such that the first M mesoscale interactions are in K the second M mesoscale interactions are in K and so forth yielding k 1 M K k M 1 2M K . . . k L 1 M 1 LM K. No loss of generality results from such a partitioning since zero probability mesoscale interactions e.g. all atoms are in the same position can be used to pad canonical ensembles to be of equal size.

Using this partitioning each canonical ensemble Kcan then be treated as a single data point in an M class multinomial regression problem with the regression input vectors X where is the set of real valued vectors of dimensionality 1 M 1 having the form given by Equation 5a. for 11 5a Together the input vectors Xdefine the design matrix X as given by Equation 5b. . 5b where is the set of real valued vectors of dimensionality L 1 M 1 . The output vectors Y have the form given by Equation 5c. 5c Together the output vectors Ydefine the output matrix Y as given by Equation 5d. 5d Using this formulation the multinomial logistic regression problem is expressed by Equation 6.

Two constraints are introduced here which when enforced make the statistical mechanical model of Equation 4 and multinomial logistic regression of Equation 6 equivalent. The two constraints are given by Equations 7a and 7b. 11 1 1 0 7a 111 7b By letting k be the mmesoscale interaction of the lpartition of K and noting the identity of Equation 7c 1 1 7c it can be shown that Equation 6 leads to Equation 4 where Y pand the inferred coefficient efor all i I. This demonstrates equivalence of the statistical mechanical model to multinomial logistic regression when the constraints are applied. This shows that the multinomial logistic regression of Equation 6 is used when the mesoscale metric is a probability. Additional constraints can be placed to exploit prior knowledge about the microscale interactions. For example if the microscale interactions are known to be sparse in a certain basis then they can be transformed to that basis. Furthermore if the matrix of microscale interaction is known to be low rank then that constraint can be placed as well. In general constraints encoding prior knowledge about the problem can be added to the formulation provided above.

This is an important result in the proposed method formulation. Once it is demonstrated that the de novo atom atom complex energy determination problem can be cast as a regression problem the methods of compressed sensing can be considered to be applied to solve the regression problem.

Compressed sensing is a theoretical and applied framework that enables the recovery of a signal with high accuracy from relatively few measurements. In the context of the example regression formulation the signal is the set of values of the microscale interaction metric e whether representing energy or some other aspect of the microscale interactions the sensors are the K mesoscale interaction types E such as protein DNA or protein protein binding events and the measurements are the energies or relative probabilities of the mesoscale interaction types. Compressed sensing enables the use of relatively few measurements to infer the energies of the microscale interaction types underlying the mesoscale interaction types.

The application of compressed sensing to regression is achieved by imposing an lregularization penalty on the regression problem e.g. see Tibshirani R Regression shrinkage and selection via the Lasso v58 no. 1 pp 267 288 1996. . Several compressed sensing approaches have been developed to accomplish this task. In an illustrated embodiment the lasso penalty for linear regression is utilized with its generalization for logistic regression e.g. see Friedman J Hastie T Tibshirani R Regularization Paths for Generalized Linear Models via Coordinate Descent v33 no. 1 pp 1 22 2010 . In other embodiments other approaches are utilized such as the Dantzig selector e.g. see Candes E Tao T The Dantzig selector Statistical estimation when p is much larger than n v35 no. 6 pp 2313 2351 2007 for linear regression and suitable generalizations for logistic regression e.g. see James G M Radchenko P A generalized Dantzig selector with shrinkage tuning v96 no. 2 pp 323 337 2009 . Other generalizations that capture related notions of sparsity for example the nuclear norm penalty e.g. see E. J. Cand s and B. Recht Exact matrix completion via convex optimization . v9 pp 717 772 2008 for low rank matrices is used in some embodiments. Any penalty known in the art may be used.

For example using the lasso penalty embodiment one would solve the optimization problem given by Equation 8.

Accurate inference of potentials is ultimately dependent on two important characteristics of the particular application. These two characteristics are the sparsity of the microscale interaction metric to be inferred and the coherence of the mesoscale interaction measurements used for inference. The compressed sensing literature contains many theoretical guarantees about the expected number of measurements required denoted by m given a signal of length n with s non zero entries and a sensor matrix X with coherence the design matrix in regression . The majority of these results concern sensor matrices with some degree of randomness e.g. see Cand s E Plan Y A Probabilistic and RIPless Theory of Compressed Sensing v57 no. 11 pp 7235 7254 2010 . In the illustrated embodiment the sensor matrix is fixed and defined by the set of K mesoscale interaction types in the data set. Theoretical guarantees for fixed matrices are also discussed e.g. see Candes E J Romberg J Quantitative robust uncertainty principles and optimally sparse decompositions v6 no. 2 pp 227 254 2006 and Tropp J A On the conditioning of random subdictionaries v25 no. 1 pp 1 24 2008 .

In general most results relate m to an increasing function of n s and . In the context of the illustrated embodiment n is the total number of possible microscale interactions s is the number of microscale interaction types I I whose values are non negligible i.e. for all i I e 0 and is the coherence of the sensor matrix X. Thus if only a small number of the microscale interaction types are non negligible i.e. s is small then only a small number of measurements are needed for accurate inference of the metric value. The role that plays is slightly more subtle the formal definition of can be found in Candes E J Wakin M B An introduction to compressive sampling v25 no. 2 pp 21 30 2008. . Intuitively coherence relates to the diversity of microscale interactions that constitute each mesoscale interaction. The greater the variety of microscale interactions participating in each experimentally characterized mesoscale interaction the smaller the coherence. Thus to minimize the number of experimental measurements needed one needs to minimize the coherence of the sensor matrix. This implies that the mesoscale interaction types must incorporate as wide a range of microscale interaction types as possible. However the degree to which the coherence of mesoscale interactions can be controlled is dependent on the application. For biological systems the choice of biomolecules comprising the set of mesoscale interactions directly impacts the coherence of the sensor matrix.

In some embodiments the regression equations of Equation 6 are solved using methods of compressed sensing. All regressions are regularized using the lasso penalty. Additionally all mesoscale interactions are assumed to occur under standard biological conditions so that there is a common temperature across all ensembles. Because the temperature is fixed it can be factored out of the inferred microscale metric values and so it is set equal to 1 to simplify the calculations.

The microscale interactions include two spatial metaparameters binning width and cutoff distance. Binning width corresponds to the resolution at which contact distances are made discrete. Cutoff distance is the distance beyond which interactions are ignored. A third parameter known as the regularization parameter 1 adjusts the expected degree of sparsity of the microscale interaction types with non negligible values. Values for these parameters are determined by fitting procedure using a training dataset where the values of the microscale metric the mesoscale metric and the function e.g. weights of the weighted sums are known.

An l regularized multinomial logistic regression is performed using commercially available software such as the R based glmnet package e.g. see Friedman J Hastie T Tibshirani R Regularization Paths for Generalized Linear Models via Coordinate Descent 33 no. 1 pp 1 22 2010 available online at subfolder i01 of folder v33 at World Wide Web WWW domain jstatsoft in domain category org. Solutions for the constrained regression problem Equation 6 Equation 7a and Equation 7b are feasible for the unconstrained regression problem Equation 6 alone. Consequently the constraints are not enforced in the illustrated embodiments to provide the technical advantage of greater computationally efficiency. It is anticipated that enforcing the constraints is unlikely to greatly improve accuracy of the results.

Example embodiments described here in detail are directed to protein DNA interactions. This embodiment casts microscale potential determination as a compressed sensing problem.

For the protein DNA example embodiment the coherence of the sensor matrix is dependent on the set of protein DNA complexes used as mesoscale interactions. For a given set of protein DNA complexes whose atomic structures have been determined the coherence can be computed from the counts of atomic interactions present in the structures. This provides a principled approach for choosing new protein DNA complexes for crystallization based on their predicted atomic structures and the resulting value for . By carefully selecting protein DNA complexes that yield the smallest predicted coherence of the sensor matrix the accuracy of the inferred protein DNA potential can be increased with a small number of targeted crystallization experiments.

Several different embodiments for microscale potential determination are presented. The details common to all inferred protein DNA embodiments are described first and then the baseline microscale potential embodiment and embodiments for modified microscale potentials that relax physical constraints are described.

In all protein DNA potentials in this section the microscale interactions are defined as pairwise contacts between DNA and protein atoms at specified distance ranges. Intra DNA interactions known as indirect readout are ignored as are intra protein interactions. We use the atom classification scheme of the Quasichemical potential e.g. see Donald J E Chen W W Shakhnovich E I Energetics of protein DNA interactions v35 no. 4 pp 1039 1047 2007 which takes into consideration the chemical identity of the atom as well as its local moiety. In this scheme there are 37 DNA atom types and 27 protein atom types. Contact distances are categorized into bins of fixed width described below . Thus a model with D distance bins contains a total of 37 27 D interaction types. The potential inference problem is to determine the value of the energy metric of each of these microscale interaction types using experimental measurements of mesoscale interactions specifically protein DNA binding events. As described below these binding events are based on protein DNA crystal structures and their associated binding energies.

For this inference problem the multinomial logistic regression approach of Equation 6 is used. The canonical ensembles are created by fixing the protein and varying the DNA sequence in computer simulations called in silico by substitution of the alternative nucleic acids at each site in the interaction region as described in the next paragraph. The conventional assumption is made that the DNA basepair positions in the interaction region are independent and each set of protein DNA basepair complexes derived from separate protein DNA crystal structures is treated as a separate canonical ensemble. Thus each ensemble is comprised of four mesoscale interactions corresponding to one protein binding to each of the four possible nucleotide basepairs. Previous studies have provided justification for treating such ensembles as canonical ensembles.

The observations are obtained from experimental data of crystallized protein DNA structures in conjunction with their experimentally determined DNA binding motifs. A single protein DNA binding event corresponds to a protein DNA basepair complex. For the regression input vectors the function e.g. weights of the weighted sums given by the counts of the interaction types as defined above is assumed known or approximated for each protein DNA binding event. In the illustrated embodiments these counts are determined from the atomic coordinates of protein and DNA atoms in the x ray crystal structures of protein DNA complexes. For each protein DNA crystal complex in silico structural mutants are generated so that every basepair in each DNA position is in silico mutated to every possible alternative nucleotide and the associated mesoscale interaction energy is computed. For example if there is an A at a particular position the three alternative structures with T G and C at that position are constructed. Thus for each protein DNA complex with a DNA sequence of length N a total of 4N structures and associated mesoscale metric values are obtained which are grouped into N canonical ensembles as previously described.

For the regression output vectors values of the mesoscale metric for each mesoscale interaction type the relative probabilities of the mesoscale interaction events within each canonical ensemble are obtained from observations. These relative probabilities correspond to the probabilities with which a protein binds to the four DNA nucleotides at a given position. When inferring a protein DNA potential to predict consensus sequences from the crystal structures the probability of binding to the nucleotide observed in the structure is set to 1 and the probability of binding to any other nucleotide is set to 0. A consensus sequence is a sequence of DNA nucleotides bases where a particular protein is most likely to bind to a DNA helix as found by experiment. When inferring a protein DNA potential for predicting position weight matrices PWMs the probabilities are derived from experimentally determined PWMs that are manually curated for each protein DNA complex in the data set. A PWM is a set of probability distributions one for each basepair position in the DNA binding site over the four possible DNA nucleotides. The probability assigned to each protein DNA binding event is the value of that event given in the experimental PWM.

A set of HTH DNA complex structures from the Protein Data Bank e.g. see Berman H M et al. The Protein Data Bank v28 no. 1 pp 235 242 2000 were obtained by searching for x ray crystal structures that contain an HTH domain and DNA molecules. Complexes were considered to be redundant if they shared the same sequence of amino acids within a 10 residue window of the recognition helix and only one representative for such complexes was retained. This criterion was chosen due to the dominant role that recognition helices play in effecting the sequence specificity of HTH proteins and the fact that HTHs with otherwise highly similar sequences may still exhibit differential DNA binding properties. In addition complexes with pathologies such as a large number of missing heavy atoms in the published structure were removed. The resulting data set is comprised of 63 non redundant HTH DNA complexes. For each of the HTH DNA complexes in this data set a PWM was derived based on experimental data curated from multiple sources.

The baseline protein DNA potential uses differences of counts of microscale interactions as the regression input vectors as given above in Equation 5a. In the illustrated embodiment one state within each canonical ensemble is used as a comparison category where the states correspond to the four nucleotides. Guanine was arbitrarily chosen for this purpose.

In the crystal structure data set it was found that only 9 of microscale interaction energies were non negligible. This satisfies the condition for a sparse signal. Regarding the incoherent measurements the energies of mesoscale interactions are incoherent measurements because i they are the summed energies of the microscale interactions and thus integrate the intensity of multiple vector elements and ii the set of microscale interactions present in each mesoscale interaction is highly variable as shown above in .

Because the sensor vector elements for each measurement must be known or estimated the microscale interactions comprising each mesoscale interaction must be known or estimated. Protein DNA crystal structures provide a data set of mesoscale interactions whose constituent microscale interactions are identified from the positions of the protein and nucleotide atoms in the contact regions of the structure. The set of 63 non redundant structures combined with their measured binding affinities were used as the data set for the de novo microscale potential determination described. The non redundancy of these structures ensures that each mesoscale interaction samples a different set of microscale interactions since the intrinsic variability of the structures due to their varying spatial conformations and different amino acid compositions results in high variability in the microscale interactions that constitute each mesoscale interaction. The degree of incoherence is quantified in . Now because this method recasts potential determination as a compressed sensing problem only a small number of incoherent measurements i.e. experimentally characterized protein nucleotide binding events are needed. This circumvents the experimental combinatorial explosion problem cited earlier.

In the protein DNA embodiment a collection of protein nucleotide complexes in which the protein is fixed and individual nucleotides are varied forms a canonical ensemble and the protein s relative binding probabilities to different nucleotides are the experimental data observations . These probabilities are obtained from experimentally determined position weight matrices PWMs of protein binding sites or from consensus binding sequences by assuming that consensus nucleotides bind with 100 probability.

The probability based formulation of Equation 6 was used to determine the protein DNA potential of helix turn helix HTHs proteins and predict their consensus binding sequences and PWM motifs. The effort focused on HTH proteins because they are the most widely distributed family of DNA binding proteins occurring in all biological kingdoms with a large number of structures in the Protein Data Bank. HTH proteins include virtually all bacterial transcription factors and about 25 percent of human transcription factors. For the prediction of consensus binding sequences the microscale potential is inferred using probabilities derived from the consensus sequences of protein DNA structures in a data set reserved for training the algorithm. A separate set of protein DNA structures is used to test predictions made with the inferred potential.

For each protein DNA structure in the test set every DNA sequence position is mutated in silico to every possible pair of nucleotides and the relative binding affinities of the mutated structures are computed. In silico mutagenesis was carried out using the 3DNA software package available online at domain x3dna of domain category org which maintains the backbone atoms of the DNA molecule but replaces the basepair atoms in a way that is consistent with the backbone orientation in the crystal. Independence of DNA positions was assumed and this process was repeated for every position.

The most probable nucleotides at all positions are predicted with 12.9 error compared to 42.1 error by the leading alternative method. Alternative methods are compared in Table 2 below. For the more complex problem of predicting quantitative PWMs the potential was determined using probabilities derived from published experimentally determined PWMs of the 63 protein DNA structures in the data set. Compared to leading physical and statistical potentials the de novo microscale potential of the illustrated embodiment produces the best PWM score using the symmetric Kullback Leibler divergence SKLD metric. Note that the second and third best performing potentials require consensus binding sequences as input. Providing that input significantly simplifies the problem whereas the illustrated embodiment infers the consensus binding sequences.

Also considered were two generalizations that relax physical constraints yielding pseudo potentials which perform better in practice. This embodiment uses transformed input vectors.

The transformed inputs protein DNA potential uses ratio of counts of microscale interactions as the regression input vectors. Specifically the regression input vectors X are given by Equation 9.

In this protein DNA potential all elements of the regression input vectors are also standardized such that their mean is zero and variance is one. Input vectors with this property typically exhibit better statistical properties.

Distinct microscale potentials were determined for interactions occurring in different regions of the HTH DNA binding interface motivated by the observation that binding affinity is strongest in the core region of the binding interface and gets progressively weaker away from the core region.

In the region specific protein DNA potential the energies of microscale interactions are allowed to vary as a function of position along the protein DNA binding interface. The motivation behind this generalization is addressed first followed by a description of how region specificity is incorporated into the protein DNA energy regression.

A microscale interaction energy metric typically defines an interaction energy metric independently of the position of the interaction along the molecule. This is a desirable property when the position has no bearing on the energetics. However if the position of the interaction is indicative of a consistent physico chemical environment properties of this environment can be exploited when modeling the energies of interactions. This is usually exploited on a small scale for example by treating two carbon atoms as distinct atom types depending on their chemical moiety as in the C1 and C2 atoms of DNA. In that case the carbon atom s local chemical moiety is the consistent physico chemical environment and it is used in modeling the system to influence the interaction energies of the atoms by treating carbon atoms with distinct chemical moieties as distinct atom types.

For protein DNA potentials it was investigated whether this notion could be generalized to a larger spatial context by deriving a Microscale interaction energy metric where the microscale interaction energies are allowed to vary as a function of position along the protein DNA binding interface. A key requirement for such a metric to work is that any given position along the binding interface must exhibit a consistent physico chemical environment across structures for example to have essentially the same steric constraints. For the protein DNA potential it was hypothesized that this is the case when a set of proteins employ the same binding modality for docking into DNA as is often true for members of the same protein family. It is anticipated that a region specific model may be suitable for the Helix turn helix proteins HTH family because i the sequence specificity of HTHs is largely mediated by interactions between the DNA and the recognition helix of HTHs and ii the relative orientation of the two core helices that make up the HTH domain is conserved across HTH families despite the broad structural diversity of HTH domains.

All 63 HTH DNA complexes in the data set were aligned by structure so that the DNA molecules are superimposed and the variation in the orientation and position of the recognition helices is minimized. Formally if RMSDis the root mean square deviation RMSD between the backbone carbon atoms of two aligned DNA molecules and RMSDis the RMSD between the C atoms of two aligned HTH recognition helices then alignment is achieved by minimizing RMSDsubject to RMSD

Any HTH DNA complex in the data set can be used as a baseline for a multiple alignment so the complex that minimizes the average RMSDto all other complexes was selected. The resulting multiple alignment shown in produces a unified coordinate system along the HTH DNA binding interface such that the physico chemical environment at a given spatial position is comparable across all structures. is a block diagram that traces the HTH recognition helix and DNA helix for each of 63 different HTH DNA complexes after alignment according to an embodiment. The left view is from a first direction and the right view is in a perpendicular direction indicated by arrow .

To exploit this alignment in the determination of the protein DNA potential the resolution of the coordinate system is reduced to the level of individual DNA basepairs. In other words the number of distinct positions in the coordinate system is made equal to the number of distinct DNA basepair positions in the HTH DNA binding interface. In this way a DNA base in one HTH DNA complex is comparable with exactly one other DNA base in every other complex. In total there are 13 distinct DNA basepair positions encompassing the largest observed HTH DNA binding interfaces in the data set.

To incorporate region specificity into the inferred protein DNA microscale metric values the elements of every regression input vector are duplicated 13 times. Formally the regression input vectors have the form of Equation 10. 1 10 In this formulation the original set of elements in the input vectors are left unchanged and the nth duplicate set in an ensemble representing the nth DNA basepair is also left unchanged. All other vector elements are set to 0. Xis a canonical ensemble that corresponds to a binding event at the nth DNA basepair position and 1r n is the indicator function testing whether r equals n. This encoding of the regression input vectors allows the inference algorithm to model the shared interaction energies common across all positions as well as including position specific adjustments among the microscale interaction types. 3.4 Predicting Values for Metric of Different Mesoscale Interaction Types

In this section the de novo values of the microscale metric potential for protein DNA microscale interaction types derived in one of the above embodiments are used to predict the values of the mesoscale metric binding energy for a different mesoscale interaction type and as a consequence predict a DNA binding site of a protein. This is accomplished by first using the inferred protein DNA microscale energy values to compute the binding energies of the protein DNA structures and then using those computed energies to predict the DNA binding sites of proteins that produces the strongest binding. The structure based approach to binding site prediction is first described and then the testing methodology and quality indicators used are detailed.

Starting with a protein DNA x ray crystal structure structure based methods transform the structure into a set of microscale interactions in the illustrated embodiment a count weighted sum of certain protein atom to DNA atom contacts . Once the set of microscale interactions are identified the overall binding energy of a protein DNA structure is computed by adding up the individual energetic contributions from all the microscale interactions observed in the structure. How the interaction energies are defined depends on the choice of potential used in the illustrated embodiment the de novo protein DNA microscale potential values described above are used to compute the binding energies. Formally if I is the set of all interactions observed in a structure eis the energetic contribution of interaction i Cis the number of times interaction i is observed in the structure then the binding energy of the structure denoted by G is given by Equation 1 where G is the mesoscale metric Eand k indicates the current different mesoscale interaction type k.

The relative affinity of a protein to two different DNA sequences can be evaluated by computing the binding energy of the protein to those two sequences. This is done by fixing the protein in the protein DNA complex and mutating the DNA sequence in silico. To make this problem computationally tractable it is assumed here as is often assumed that the energetics for one DNA position in the binding interface can be computed separately from other positions. Doing so simplifies the computation by involving for a DNA sequence of length N only 4N energetic calculations where each basepair in the DNA is mutated in silico to every possible nucleotide independently from other basepairs and the binding energy of each of these in silico mutated protein DNA structures is computed. Using the computed binding energies the Boltzmann formula of Equations 3a and 3b can then be used to compute the probability of observing nucleotide m at position n denoted by p. Equation 3a and 3b are used at position n with k m indicating the nucleotide base at position n Kis the set of the four nucleotide bases A C G T at position n and E G is the binding energy of the structure when nucleotide m is at position n. For computation of relative energy when temperature is constant is set equal to 1. Performing this computation for every position n and every nucleotide m yields the predicted position weight matrix PWM for the DNA binding sites of the protein. When the consensus sequence is to be predicted the most probable nucleotide at every position is chosen as the consensus nucleotide.

In some embodiments step is included to validate the results e.g. the values of the microscale metric for the set of microscale interaction types or the most probable nucleotide at a position or the most probable binding sites for a protein on a given DNA molecule .

To test the results from step or 9 fold cross validation CV was used. The 63 complexes were split into 9 groups of 7 complexes each. Each group yielded a testing configuration where 7 complexes comprise the test set and the remaining 56 the training set. The model was trained on the training set and tested on the test set using all 9 testing configurations and the average was taken over all test sets. Since some metaparameters vary the number of degrees of freedom in the model fitting them strictly on the training set was not successful as the algorithm would always maximize the number of degrees of freedom. Consequently the 3 metaparameters were fit by finding the value that minimizes average error over all test sets. Results are shown in and Table 2. In the illustrated embodiment the best fit produced values of the binning width as 1.3 the cutoff distance as 5.9 and as 0.00113821.

In some embodiments of step an objective was to provide a consistent testing environment for all methods considered for comparison with the results of step or step . When original comparison validation code implementations were available they were used otherwise the method considered was implemented from equations as for the Quasichemical potential. Recommended default settings were chosen when applicable and all parameter settings fit using the original methods data sets were left unchanged. For the Rosetta potential the energetic terms were set to the following values fa atr 0.947733 fa rep 0.577238 hb sc 1.596235 gb elec 0.203353 fa sol 0.507356 dna bs 0.1 and dna bp 0.1. These values are based on the fitted parameters from Morozov A V Havranek J J Baker D Siggia E D Protein DNA binding specificity predictions with structural models v33 no. 18 pp 5781 5798 2005. Depending on the original data sets used for training each algorithm some methods may have an advantage over other methods if their training data set included structures that were also in the curated test sets. Nonetheless given the heterogeneous set of methods tested and their reliance on different types of input data the methodology used provided a consistent and objective comparison.

When testing the consensus sequence predictions of the Rosetta algorithm and the DNAPROT algorithm latter from Angarica V E Perez A G Vasconcelos A T Collado Vides J Contreras Moreira B Prediction of TF target sites based on atomistic models of protein DNA complexes v9 no. 1 p436 2008 their indirect readout components had to be disabled as they explicitly rely on the consensus sequence itself as input. For Rosetta this was done by setting the dna bs and dna bp terms to zero weight to eliminate the indirect readout component from the potential. For DNAPROT this was done by running it with the setting p P 1 e c D 0 which disables DNAPROT s indirect readout component and its Cumulative Contacts component from Morozov A V Siggia E D Connecting protein structure with predictions of regulatory sites USA v104 no. 17 pp 7068 7073 2007 both of which rely on the consensus sequence as input.

We tested these generalizations individually and in combination as shown in Table 2 below. Performance is assessed based on predictions of consensus sequences and PWMs averaged over the 63 structures in the data set. For consensus sequence prediction error is measured by the percentage of incorrectly predicted bases. For PWM predictions the average SKLD over all DNA positions is reported lower is better . A random model in which all DNA basepairs are assumed to be equally likely is also shown for reference.

The consensus sequence predictions are slightly improved 10.1 vs. 12.9 error but the improvement in PWM prediction is dramatic SKLD of 1.699 vs. 1.960 larger than the gain obtained in going from the Quasichemical to the DNAPROT algorithm 2.248 vs. 1.991 which accounts for intra DNA interactions and requires consensus sequences. The positive impact of this second generalization on PWM prediction but not on consensus sequence prediction results it is believed because consensus sequences do not capture the relative binding strength of protein DNA interactions for alternative DNA sequences.

In for bar graph the horizontal axis indicates difference of PWMs in SKLD dimensionless units. The vertical axis indicates the 63 protein DNA measurements in the data set for both generalizations. Using SKLD scores for PWM predictions lower scores indicate better agreement with insets SEQ ID NOS 7 8 SEQ ID NOS 9 10 and SEQ ID NOS 11 13 comparing experimentally determined PWM top to prediction bottom for representative best average and worst predictions respectively. Each PWM is represented by the letters indicating the 4 nucleotides bases at each position with a height that represents the probability of that nucleotide base at that position in a binding event between the protein and the DNA molecule.

As discussed earlier a collection of sensors must be substantively incoherent to insure high quality reconstruction of the underlying potential with compressive sensing methods and the potential must be sufficiently sparse relative to the number of available measurements. To determine the degree to which these requirements are satisfied by the potentials derived from the protein DNA complexes in the illustrated embodiment the best performing Baseline model was considered applied without the two generalizations discussed in the previous section. This model produced values of potential for a total of 2 997 unique microscale interactions using 1.3 wide distance bins and 5.9 cutoff distance as metaparameters. The total number of sensors in the data set is 592 as each protein DNA crystal structure yields multiple sensors making the common assumption of independence between DNA basepair positions . As previously noted accurate inference is still possible despite having a smaller number of sensors than the number of unique microscale interactions if the potential is sufficiently sparse. Of the 2 997 unique interactions only 270 have non negligible values of potential suggesting that the illustrated embodiment will yield accurate potentials. In fact it is likely that the best performing choices of binning width and cutoff distance used for the Baseline model represent the optimal tradeoff between spatial resolution and statistical power.

The protein DNA binding site predictions reported exhibit a dramatic improvement over the leading alternative methods with predictions within the experimental error of the PWMs for at least half of the cases studied. Although the accuracy depicted in and is substantially better than achieved with alternative methods the predictions for the proteins in the lower quarter of the figure should be improved. The 63 protein DNA complexes in the illustrated database may provide biased or insufficient coverage of some of the microscale interactions. Or there could be significant variance in the quality of the crystal structures determined for the different complexes in the database that we curated from the Protein Data Base. Additionally prediction errors might reflect the effects of other mechanisms that affect the shape and accessibility of the DNA in vivo so that the structure of the crystallized complex differs from the in vivo structure. Also some transcription factors have been observed to bind DNA with two or more distinct motifs and the alternate motifs would be missing from the data set used.

As in other CS application domains the accuracy of the inferred potentials depends on the characteristics of the sensor matrix in this case the collection of protein DNA structures available. As discussed above quantitative measures such as coherence can be used to assess the suitability of a sensor matrix for compressive sensing. These measures can provide a principled framework for selecting additional crystallization targets that will maximally enhance the sensing performance of a protein DNA structural data set. It was shown above that the example data set has good incoherence properties yet it is expected that the addition of more protein DNA crystal structures specifically chosen to yield a sensor matrix with even lower coherence will yield more accurate potentials and better binding site predictions.

While statistical potentials and the illustrated embodiments both use experimental data sets to derive the final potential de novo potentials of the illustrated embodiment are nonparametric i.e. they do not assume an underlying mathematical form. In contrast statistical potentials rely on experimental data sets to fit a parametric model with a fixed mathematical form. De novo potentials overcome additional limitations specific to statistical potentials. First while statistical potentials only utilize atomic data such as crystal structures to fit their parameters de novo potentials combine structural information and experimental binding data into a single formulation for inference. In the field of protein DNA binding site prediction combining these types of data has been a longstanding objective. Second statistical potentials implicitly assume that all structures come from the same canonical ensemble. This oversimplification ignores the chain connectivity and amino acid composition of proteins and it is thought to be the cause of common anomalies observed in statistical potentials. In de novo potentials this assumption is eliminated in the energy based formulation and it is relaxed significantly in the probability based formulation so that only subsets of the data are assumed to form canonical ensembles. Third by assigning equal weight to microscale interactions observed in different structures statistical potentials implicitly assume that different structures have the same binding or formation energy. This is not the case as different protein DNA complexes are known to have different binding affinities. From a statistical mechanical standpoint high affinity complexes correspond to more frequent mesoscale interactions than low affinity complexes requiring that the underlying microscale interactions be given proportionally greater weight. De novo potentials take this into account as the binding energies of mesoscale interactions are an explicit part of the formulation. Fourth there is no theoretical assurance that as more data is added for the statistical potential fitting process the inferred energies will ultimately converge to the true underlying interaction energies. The same observation holds for physical potentials. In contrast for de novo potentials if the formal requirements of compressed sensing are satisfied then additional sensors in the data set will lead to ever closer estimates of the interaction energies.

The important insight that underlies the de novo methodology illustrated here is that experimental data sets relating to mesoscale interactions in a wide range of fields can be cast as incoherent measurements of microscale interactions in the compressed sensing framework. In these cases powerful compressed sensing methods can be used to determine de novo potentials. In the current protein DNA application microscale interactions were defined to always involve one protein atom and one DNA atom thus neglecting intra DNA interactions. If microscale interactions are defined to include non covalent contacts between two DNA atoms then the indirect readout component of protein DNA interactions can also be modeled capturing intra DNA interactions.

Similarly to infer a potential for protein protein interactions or for protein folding non covalent contacts between protein atoms would be treated as the microscale interactions. However interactions need not be restricted to those involving pairs of atoms. Interactions involving multiple atoms as well as coarse grained potentials in which the atoms of the systems are residues for example could be used. For mesoscale measurements of protein protein interactions biochemical data on protein protein binding kinetics can be used. The Protein protein Interaction Thermodynamic Database PINT is a database of such measurements e.g. see Kumar M. D. and M. M. Gromiha PINT Protein protein Interactions Thermodynamic Database v34 Database issue pp D195 198 2006 . For mesoscale measurements of protein folding the kinetics or mean folding times of proteins are used. While such measurements are difficult to obtain significant progress in experimental techniques has been made recently. The advent of these new experimental techniques promises to make such measurements more readily available in the future.

The ability to predict protein binding sites on DNA and other biomolecular interaction kinetics will have profound practical benefits for accelerating and reducing the cost of determining cellular signaling networks. Defects in cell signaling are important in many diseases. This method will enable accurate computational prediction of effects of mutations in signaling proteins in their active regions or in DNA sequences within binding sites.

The quantitative microscale potentials yielded by this method will enable drug designers to predict drug interaction sites and drug reactivity with greater precision than now possible.

Molecular binding affinities are an important determinant of enzyme reaction rates. Knowledge of the microscale potentials that are the basis for these binding affinities will enable design of custom enzymes for application in commercial bioreactors including those involved in production of biofuels.

Understanding of genetic regulation in all organisms is dependent on identification of the genes regulated by each particular protein transcription factor. That is determining the genes that have binding sites for each transcription factor. Currently the laboratory procedures required for these identifications are complex expensive and labor intensive. The ability to computationally predict these binding sites and hence the regulated genes will enable much more focused and hence less expensive laboratory procedures. These benefits will accrue even for predictions that are not absolutely precise by reducing the number of possibilities that have to be explored in the laboratory. These benefits are particularly important for human genetics due to the complexity of the genetic regulation of higher organisms and to the difficulty of doing laboratory experiments on mammalian subjects.

A major challenge in the field of gene therapy is the design of enzymes that insert new genetic material into specific regions of the human genome. Without the ability to target these insertions with high accuracy misplaced insertions can lead to significant side effects on the patient s health. The design of sequence specific enzymes depends on our ability to predict the DNA binding site of those enzymes which is a major application of this method.

Potentials are used as the basis of any molecular dynamics simulation in the form of the energy function that is used to compute the energy of the simulated system at every step of the simulation. Consequently the accuracy of molecular dynamics simulations is intimately related to the accuracy of the underlying potential. This method provides a purely experiment based approach to infer such potentials with higher accuracy than is now possible with conventional potentials.

A sequence of binary digits constitutes digital data that is used to represent a number or code for a character. A bus includes many parallel conductors of information so that information is transferred quickly among devices coupled to the bus . One or more processors for processing information are coupled with the bus . A processor performs a set of operations on information. The set of operations include bringing information in from the bus and placing information on the bus . The set of operations also typically include comparing two or more units of information shifting positions of units of information and combining two or more units of information such as by addition or multiplication. A sequence of operations to be executed by the processor constitute computer instructions.

Computer system also includes a memory coupled to bus . The memory such as a random access memory RAM or other dynamic storage device stores information including computer instructions. Dynamic memory allows information stored therein to be changed by the computer system . RAM allows a unit of information stored at a location called a memory address to be stored and retrieved independently of information at neighboring addresses. The memory is also used by the processor to store temporary values during execution of computer instructions. The computer system also includes a read only memory ROM or other static storage device coupled to the bus for storing static information including instructions that is not changed by the computer system . Also coupled to bus is a non volatile persistent storage device such as a magnetic disk or optical disk for storing information including instructions that persists even when the computer system is turned off or otherwise loses power.

Information including instructions is provided to the bus for use by the processor from an external input device such as a keyboard containing alphanumeric keys operated by a human user or a sensor. A sensor detects conditions in its vicinity and transforms those detections into signals compatible with the signals used to represent information in computer system . Other external devices coupled to bus used primarily for interacting with humans include a display device such as a cathode ray tube CRT or a liquid crystal display LCD for presenting images and a pointing device such as a mouse or a trackball or cursor direction keys for controlling a position of a small cursor image presented on the display and issuing commands associated with graphical elements presented on the display .

In the illustrated embodiment special purpose hardware such as an application specific integrated circuit IC is coupled to bus . The special purpose hardware is configured to perform operations not performed by processor quickly enough for special purposes. Examples of application specific ICs include graphics accelerator cards for generating images for display cryptographic boards for encrypting and decrypting messages sent over a network speech recognition and interfaces to special external devices such as robotic arms and medical scanning equipment that repeatedly perform some complex sequence of operations that are more efficiently implemented in hardware.

Computer system also includes one or more instances of a communications interface coupled to bus . Communication interface provides a two way communication coupling to a variety of external devices that operate with their own processors such as printers scanners and external disks. In general the coupling is with a network link that is connected to a local network to which a variety of external devices with their own processors are connected. For example communication interface may be a parallel port or a serial port or a universal serial bus USB port on a personal computer. In some embodiments communications interface is an integrated services digital network ISDN card or a digital subscriber line DSL card or a telephone modem that provides an information communication connection to a corresponding type of telephone line. In some embodiments a communication interface is a cable modem that converts signals on bus into signals for a communication connection over a coaxial cable or into optical signals for a communication connection over a fiber optic cable. As another example communications interface may be a local area network LAN card to provide a data communication connection to a compatible LAN such as Ethernet. Wireless links may also be implemented. Carrier waves such as acoustic waves and electromagnetic waves including radio optical and infrared waves travel through space without wires or cables. Signals include man made variations in amplitude frequency phase polarization or other physical properties of carrier waves. For wireless links the communications interface sends and receives electrical acoustic or electromagnetic signals including infrared and optical signals that carry information streams such as digital data.

The term computer readable medium is used herein to refer to any medium that participates in providing information to processor including instructions for execution. Such a medium may take many forms including but not limited to non volatile media volatile media and transmission media. Non volatile media include for example optical or magnetic disks such as storage device . Volatile media include for example dynamic memory . Transmission media include for example coaxial cables copper wire fiber optic cables and waves that travel through space without wires or cables such as acoustic waves and electromagnetic waves including radio optical and infrared waves. The term computer readable storage medium is used herein to refer to any medium that participates in providing information to processor except for transmission media.

Common forms of computer readable media include for example a floppy disk a flexible disk a hard disk a magnetic tape or any other magnetic medium a compact disk ROM CD ROM a digital video disk DVD or any other optical medium punch cards paper tape or any other physical medium with patterns of holes a RAM a programmable ROM PROM an erasable PROM EPROM a FLASH EPROM or any other memory chip or cartridge a carrier wave or any other medium from which a computer can read. The term non transitory computer readable storage medium is used herein to refer to any medium that participates in providing information to processor except for carrier waves and other signals.

Logic encoded in one or more tangible media includes one or both of processor instructions on a computer readable storage media and special purpose hardware such as ASIC .

Network link typically provides information communication through one or more networks to other devices that use or process the information. For example network link may provide a connection through local network to a host computer or to equipment operated by an Internet Service Provider ISP . ISP equipment in turn provides data communication services through the public world wide packet switching communication network of networks now commonly referred to as the Internet . A computer called a server connected to the Internet provides a service in response to information received over the Internet. For example server provides information representing video data for presentation at display .

The invention is related to the use of computer system for implementing the techniques described herein. According to one embodiment of the invention those techniques are performed by computer system in response to processor executing one or more sequences of one or more instructions contained in memory . Such instructions also called software and program code may be read into memory from another computer readable medium such as storage device . Execution of the sequences of instructions contained in memory causes processor to perform the method steps described herein. In alternative embodiments hardware such as application specific integrated circuit may be used in place of or in combination with software to implement the invention. Thus embodiments of the invention are not limited to any specific combination of hardware and software.

The signals transmitted over network link and other networks through communications interface carry information to and from computer system . Computer system can send and receive information including program code through the networks among others through network link and communications interface . In an example using the Internet a server transmits program code for a particular application requested by a message sent from computer through Internet ISP equipment local network and communications interface . The received code may be executed by processor as it is received or may be stored in storage device or other non volatile storage for later execution or both. In this manner computer system may obtain application program code in the form of a signal on a carrier wave.

Various forms of computer readable media may be involved in carrying one or more sequence of instructions or data or both to processor for execution. For example instructions and data may initially be carried on a magnetic disk of a remote computer such as host . The remote computer loads the instructions and data into its dynamic memory and sends the instructions and data over a telephone line using a modem. A modem local to the computer system receives the instructions and data on a telephone line and uses an infra red transmitter to convert the instructions and data to a signal on an infra red a carrier wave serving as the network link . An infrared detector serving as communications interface receives the instructions and data carried in the infrared signal and places information representing the instructions and data onto bus . Bus carries the information to memory from which processor retrieves and executes the instructions using some of the data sent with the instructions. The instructions and data received in memory may optionally be stored on storage device either before or after execution by the processor .

In one embodiment the chip set includes a communication mechanism such as a bus for passing information among the components of the chip set . A processor has connectivity to the bus to execute instructions and process information stored in for example a memory . The processor may include one or more processing cores with each core configured to perform independently. A multi core processor enables multiprocessing within a single physical package. Examples of a multi core processor include two four eight or greater numbers of processing cores. Alternatively or in addition the processor may include one or more microprocessors configured in tandem via the bus to enable independent execution of instructions pipelining and multithreading. The processor may also be accompanied with one or more specialized components to perform certain processing functions and tasks such as one or more digital signal processors DSP or one or more application specific integrated circuits ASIC . A DSP typically is configured to process real world signals e.g. sound in real time independently of the processor . Similarly an ASIC can be configured to performed specialized functions not easily performed by a general purposed processor. Other specialized components to aid in performing the inventive functions described herein include one or more field programmable gate arrays FPGA not shown one or more controllers not shown or one or more other special purpose computer chips.

The processor and accompanying components have connectivity to the memory via the bus . The memory includes both dynamic memory e.g. RAM magnetic disk writable optical disk etc. and static memory e.g. ROM CD ROM etc. for storing executable instructions that when executed perform one or more steps of a method described herein. The memory also stores the data associated with or generated by the execution of one or more steps of the methods described herein.

In the foregoing specification the invention has been described with reference to specific embodiments thereof. It will however be evident that various modifications and changes may be made thereto without departing from the broader spirit and scope of the invention. The specification and drawings are accordingly to be regarded in an illustrative rather than a restrictive sense. Throughout this specification and the claims unless the context requires otherwise the word comprise and its variations such as comprises and comprising will be understood to imply the inclusion of a stated item element or step or group of items elements or steps but not the exclusion of any other item element or step or group of items elements or steps. Furthermore the indefinite article a or an is meant to indicate one or more of the item element or step modified by the article.

