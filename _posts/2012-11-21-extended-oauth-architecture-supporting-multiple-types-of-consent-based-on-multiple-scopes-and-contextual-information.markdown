---

title: Extended OAuth architecture supporting multiple types of consent based on multiple scopes and contextual information
abstract: Method, device, and storage medium to receive a request to authorize a release of protected resource data, wherein the request includes a device identifier that identifies a requesting device of the request and one or more indicators that indicate one or more instances of the protected resource data being requested; identify a sensitivity level for each indicator of the protected resource data; identify, based on the device identifier, contextual information that indicates a preferred type of consent of the requesting device in response to a determination that at least one of the one or more indicators require consent from a resource owner of the protected resource data; select a type of consent based on the contextual information and the one or more sensitivity levels; and transmit a request, to a user device associated with the resource owner, for consent from the resource owner according to the type of consent.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09391998&OS=09391998&RS=09391998
owner: Verizon Patent and Licensing Inc.
number: 09391998
owner_city: Basking Ridge
owner_country: US
publication_date: 20121121
---
The OAuth 2.0 specification defines a framework that enables a third party application to obtain limited access to a Hypertext Transfer Protocol HTTP service either on behalf of a resource owner by coordinating an approval interaction between the resource owner and the HTTP service or by allowing the third party application to obtain access on its own behalf.

The following detailed description refers to the accompanying drawings. The same reference numbers in different drawings may identify the same or similar elements.

The current draft v2 31 of the OAuth 2.0 specification dated Jul. 31 2012 which is a work in progress and incorporated herein by reference supports various authorization grant mechanisms. The OAuth 2.0 specification defines four roles resource owner resource server client and authorization server. The resource owner is an entity capable of granting access to a protected resource. The resource server is the server hosting the protected resources and capable of accepting and responding to protected resource requests using access tokens. The client is an application making protected resource requests on behalf of the resource owner and with the resource owner s authorization. The authorization server is the server issuing access tokens to the client after successfully authenticating the resource owner and obtaining authorization.

A client that wants to obtain access to resources e.g. data having data attributes defined by a specific scope can send a request to an authorization server to obtain an authorization grant. According to the OAuth 2.0 specification one of the supported authorization grants is based on an authorization code. An authorization server issues the authorization grant to a requesting client after authenticating the resource owner and obtaining authorization. Since the resource owner only authenticates with the authorization server the resource owner s credentials are not shared with the client. Resources in the above context may be subscriber profile attributes also called scopes in the OAuth 2.0 specification. Given the expansive nature of the current version of the OAuth 2.0 standard this description does not intend to set forth an exhaustive treatment or review of the current version.

The current version of the OAuth 2.0 specification however does not specify among other things how to handle a scope that includes data attributes of differing levels of sensitivity e.g. access levels . Rather the OAuth 2.0 specification assumes that all scopes are of similar sensitivity. Additionally the OAuth 2.0 specification requires explicit end user consent for all requested scopes. However the current version of the OAuth 2.0 specification fails to consider supporting different consent processes based on differing levels of sensitivity. Additionally the current version of the OAuth 2.0 specification fails to consider contextual information.

According to an exemplary embodiment an extended OAuth architecture supports multiple scopes of different sensitivities in a single request. According to an exemplary implementation data attributes of a scope may be assigned a sensitivity level such as public private or a combination thereof. According to other implementations other types of categories or sensitivity levels may be applied to scopes. As an example of a scope with multiple sensitivities a scope may include the following data attributes mobile device type billing address prepaid or postpaid and country of residence. Mobile device type and country of residence may be assigned a sensitivity level of public. However billing address and prepaid or postpaid may be assigned a sensitivity level of private.

According to an exemplary embodiment release of a resource that is assigned a sensitivity level of public does not require consent from the resource owner. Conversely according to an exemplary embodiment release of a resource that is assigned a sensitivity level of private requires consent from the resource owner.

According to an exemplary embodiment the extended OAuth architecture selects a type of consent based on the sensitivity level of the resource. For example the extended OAuth architecture selects a type of consent for a resource that is assigned a sensitivity level of private. Under a framework in which multiple sensitivity levels of private are implemented the extended OAuth architecture selects a type of consent that corresponds to the sensitivity level. By way of example the multiple sensitivity levels of private e.g. low medium and high may each have a corresponding type of consent. According to an exemplary embodiment the extended OAuth architecture selects the highest sensitivity level as the type of consent when there are multiple sensitivity levels included in a scope. For example if the scope of a request includes data attributes of a low sensitivity level and data attributes of a high sensitivity level the extended OAuth architecture select the type of consent correlated with the high sensitivity level to obtain consent from the resource owner for the entire scope of the request i.e. the data attributes of the low sensitivity level and the data attributes of the high sensitivity level .

According to an exemplary embodiment the type of consent includes a mode of communication used to obtain consent or authorization from the resource owner for the release of a protected resource. According to an exemplary implementation the type of consent may include one or multiple modes of consent. According to an exemplary implementation the type of consent includes a Web based communication a text based communication e.g. a Short Messaging Service SMS communication an e mail communication a Multimedia Messaging Service MMS communication a telephonic based or vocal based communication e.g. an interactive voice response IVR communication etc. or other graphical user interface communication. The type of consent may also indicate other information such as for example whether authentication of the resource owner is to be performed. By way of example a text based communication may not require authentication of the resource owner. However a Web based communication may require authentication of the user.

According to an exemplary embodiment the extended OAuth architecture selects a type of consent based on contextual information. According to an exemplary embodiment the contextual information includes a client preference pertaining to a client that is requesting a resource. A client preference may indicate a preferred type of consent to be used. For example a client that interacts with a resource owner over the telephone may indicate a client preference that the type of consent used to obtain consent from the resource owner is of a particular mode of communication. In this example the client preference may indicate that the type of consent is obtained via the telephone e.g. an interactive voice response IVR mechanism . According to an exemplary embodiment the client provides an authorization device of the extended OAuth architecture a client identifier. The authorization device uses the client identifier to select the client preference pertaining to the client.

According to an exemplary embodiment the contextual information includes information pertaining to the resource owner. For example the contextual information includes information pertaining to user device capabilities associated with the resource owner communication services subscribed to e.g. short messaging service SMS mobile service etc. and or resource owner preferences. The resource owner preferences may indicate consent preferences e.g. type of consent and or security level preferences e.g. high medium low etc. pertaining to the release of resource data. According to an exemplary embodiment the authorization device obtains an identifier pertaining to the resource owner and or user device to select the contextual information pertaining to the resource owner.

According to an exemplary embodiment an authorization device of the extended OAuth architecture performs a selected type of consent. According to another exemplary embodiment the authorization device uses a third party service to perform the selected type of consent. A selected type of consent may include one or multiple types of consents. For example as previously described the type of consent may correspond to receiving resource owner consent through the use of an SMS message. Alternatively the type of consent may correspond to receiving resource owner consent through the use of verbal authorization e.g. via a telephone call or written authorization e.g. via an Internet browser .

According to an exemplary embodiment an authorization device generates an authorization code as an authorization grant to allow a client to obtain an access token and in turn obtain the resource data from a resource device.

According to an exemplary embodiment when a scope includes a mixture of both private and public scopes the authorization device seeks resource owner consent only for the private scopes. According to an exemplary embodiment the authorization device identifies the sensitivity level s of a data attribute s present in a request.

While exemplary embodiments provided in this description may be implemented based on the use of a particular network architecture or platform messaging scheme etc. such implementations are not intended to be restrictive or provide an exhaustive treatment as such. In other words the embodiments described herein may be implemented using other suitable network architectures messaging scheme etc. which may not be specifically described.

The number of devices and the configuration in environment are exemplary and provided for simplicity. According to other embodiments environment may include additional devices fewer devices different devices and or differently arranged devices than those illustrated in . According to other embodiments a single device in may be implemented as multiple devices. Additionally or alternatively according to other embodiments multiple devices may be implemented as a single device. For example resource device and authorization device may be implemented as a single device. Additionally or alternatively environment may include additional networks and or differently arranged networks than those illustrated in .

A device may be implemented according to a centralized computing architecture a distributed computing architecture or a cloud computing architecture. Additionally a device may be implemented according to one or multiple network architectures e.g. a client device a server device a peer device proxy device or a combination thereof . Also according to other embodiments one or more functions and or processes described as being performed by a particular device may be performed by a different device or some combination of devices which may or may not include the particular device.

Environment may be implemented to include wired and or wireless connections among the devices and the network illustrated. A connection may be direct or indirect and involve intermediary device s and or network s not illustrated in .

Network includes one or multiple networks that provide s an extended OAuth service as described herein. Network may be implemented as a terrestrial based network. For example network may be implemented as an Internet Protocol IP network a private network a public network or other suitable network.

Resource device includes a device that stores and or hosts resources. For example resource device may be implemented as a resource server. The resources may include data of varying sensitivity levels. For example resource data may be categorized as public resource data or private resource data. According to other implementations resources may include data having a different nomenclature or categorization for designating a sensitivity level.

Authorization device includes a device that authorizes access to resources according to the extended OAuth service as described herein. For example authorization device may be implemented as an authorization server. In contrast to an authorization server of the current OAuth 2.0 specification according to an exemplary embodiment authorization device provides an extended OAuth service that supports multiple scopes of varied sensitivities as described herein. According to an exemplary implementation scopes may be designated as public private or other designations that indicate whether authorization is to be sought from the resource owner. According to another implementation scopes may be designated in a ternary system or a higher system in which varying levels of consent from the resource owner may be imposed. By way of example for resource data having a low level sensitivity no consent is required for resource data having a medium level of sensitivity any method of consent is acceptable and for resource data having a high sensitivity level only particular methods of consent are accepted. According to still other implementations sensitivity schemes that include finer granularity levels may be used.

According to an exemplary embodiment authorization device may or may not obtain authorization from the resource owner depending on the sensitivity level of the resource data. This is in contrast to the authorization server of the current OAuth 2.0 specification. According to an exemplary implementation authorization device obtains authorization from the resource owner when the sensitivity level of the resource data is designated as private or other designation. Conversely according to an exemplary implementation authorization device may not obtain authorization from the resource owner when the sensitivity level of the resource data is designated as public or has another designation.

According to an exemplary embodiment authorization device selects a type of consent based on contextual information. This is in contrast to the authorization server of the current OAuth 2.0 specification. According to an exemplary embodiment authorization device stores a database or a data structure that stores information indicating types of consent in which assignments of the types of consent are based on the sensitivity level s of data attributes included in scopes and contextual information. According to an exemplary embodiment the contextual information pertains to resource requesting devices as described herein. According to an exemplary embodiment the contextual information pertains to resource owners as described herein.

According to an exemplary embodiment authorization device generates an authorization code as an authorization grant without seeking consent from the resource owner when the sensitivity level of the resource data is below a threshold. For example authorization device generates a default authorization code when the sensitivity level of the resource data is public. Conversely according to an exemplary embodiment authorization device generates an authorization code as an authorization grant after obtaining consent from the resource owner when the sensitivity level of the resource data is above a threshold. For example authorization device generates an authorization code when the sensitivity level is private and resource owner consent is obtained.

Authentication device includes a device that authenticates resource requesting device . For example authentication device validates a client e.g. resource requesting device .

Resource requesting device includes a device that requests access or use of resources stored and or hosted by resource device . For example resource requesting device may be implemented as a client.

User device includes a device capable of communicating with network . For example user device may be implemented as a mobile device e.g. a smartphone a tablet device a personal digital assistant PDA a personal communication system PCS etc. a computer e.g. a desktop computer a laptop computer a palmtop computer a netbook a television a vehicular communication system or other types of user devices capable of communicating with network .

According to an exemplary embodiment clients that use the extended OAuth service undergo an on boarding process. Referring to during the on boarding process a client service provider provides the extended OAuth service provider with a client preference pertaining to the type of consent to be used. For example as previously described the client preference may indicate a particular method form or mode of communication to be used to obtain consent or authorization from the resource owner. According to an exemplary embodiment the extended OAuth service provider may publish different types of consents that are available to clients. Client service provider may select a type of consent. In this way client service provider may select a preferred type of consent that aligns with the application or the service provided by client service provider . By way of example a client service provider that interacts with a resource owner via the Web may select a Web based type of consent versus a telephone based type of consent e.g. a telephone call . By way of a further example a client service provider that interacts with a resource owner via a television service may select a television based consent e.g. graphical user interfaces etc. versus a telephone based type of consent. Similarly a client service provider that interacts with a resource owner via a telephone service may select a telephone based consent and so forth and so on.

According to an exemplary embodiment in response to receiving the client s preference the extended OAuth service provider issues a client identifier. An extended OAuth architecture stores the client preference and maps the preference to the issued client identifier. According to an exemplary embodiment authorization device stores contextual information as previously described. The contextual information includes client preferences and client identifiers.

Referring to during a communication between user device and resource requesting device authorization device will obtain consent from the resource owner to release a resource e.g. data to resource requesting device . According to an exemplary embodiment resource requesting device redirects user device to authorization device . For example during a Web session with user device resource requesting device may initiate a Uniform Resource Locator URL redirect or forward to authorization device .

According to other embodiments resource requesting device may communicate with authorization device to cause authorization device to communicate with user device . For example according to an exemplary scenario assume that user device and resource requesting device are communicating over the telephone. During the communication resource requesting device desires the release of a resource. Resource requesting device sends a message e.g. a scope request to authorization device . The request includes a client identifier. The request may include a telephone number a user identifier and or a user device identifier. In response to receiving the request authorization device places a telephone call or causes a telephone call to be placed to user device . The resource owner of user device has a call waiting service. Alternatively authorization device may place a telephone call or cause a telephone call to be placed to another telephone associated with the resource owner. For example the resource owner may be communicating with resource requesting device via a mobile telephone and authorization device places a telephone call or causes a telephone call to be placed to the resource owner s landline telephone so as to obtain consent.

According to another exemplary scenario user device and resource requesting device may be communicating via a television service. For example user device may include a smart television or a television and a set top box. During the communication e.g. via a graphical user interface a widget an overlay etc. resource requesting device desires the release of a resource and sends a scope request to authorization device . Authorization device may communicate with the user via the television service or some other mode of communication.

As described whether the resource requesting device redirects user device or communicates with authorization device resource requesting device may need to identify the extended OAuth service provider to use for a resource owner. According to an exemplary embodiment during the on boarding process clients may be provided with a means to identify the extended OAuth service provider. In some cases the extended OAuth service provider may provide other services e.g. mobile service television service Internet service telephone service etc. to which a resource owner is subscribed. According to such cases resource requesting device may use for example a carrier proprietary application programming interface API that allows resource requesting device to determine a service provider associated with the resource owner. By way of further example the carrier proprietary API may allow resource requesting device to determine a wireless carrier associated with a telephone number or mobile directory number MDN of the resource owner. Resource requesting device may obtain the resource owner s telephone number or MDN from the resource owner. Resource requesting device identifies the extended OAuth service provider based on a mapping between the wireless carrier and the extended OAuth service provider. According to other implementations resource requesting device may select an extended OAuth service provider based on other methods and or information. By way of example the resource owner may provide an extended OAuth identifier that identifies the extended OAuth service provider. Alternatively a single sign on service may include extended OAuth services which allows resource requesting device to select the extended OAuth service provider associated with the resource owner.

Resource requesting device may include other API s that allow s resource requesting device to obtain resources via the extended OAuth service. For example resource requesting device may include an API to communicate with resource device .

In steps and based on the identification of the user s wireless provider resource requesting device redirects e.g. an HTTP redirect user device to authorization device . According to an exemplary implementation the redirect uses a Uniform Resource Identifier URI that includes one or multiple name value pairs also known as key value pair or attribute value pair or other type of string s e.g. a string that includes a delimiter etc. that indicate s the type of requested resource data e.g. data attribute etc. and a client identifier that identifies resource requesting device .

As a part of step to generate the URI resource requesting device selects the resource data to be obtained. For example according to this exemplary scenario resource requesting device identifies that the resource owner s user s name and address birth date credit card information and billing address is needed to complete the registration process. The URI associated with the redirect includes a string that indicates the requested resource data e.g. the scope . Additionally the URI also includes a client identifier that identifies resource requesting device . According to other implementations resource requesting device may provide the request for the resource data the client identifier or both in a separate message to authorization device .

In step authorization device validates resource requesting device with authentication device . For example authorization device extracts the client identifier from the URI or the separate message and passes the client identifier to authentication device . Authentication device verifies whether the client identifier is valid. According to this scenario assume that the validation of resource requesting device is successful. According to other scenarios if resource requesting device is not successfully validated then the authorization process may be halted error messages may be sent and or security measures may be taken.

In step authorization device identifies the scopes requested. For example authorization device extracts the attribute value pairs or other type of formatted string from the URI. According to an exemplary implementation authorization device maps the scope included in the URI to a sensitivity level. For example authorization device stores or has access to a database or a data structure that allows authorization device to correlate the scope to a sensitivity level such as public or private.

According to this scenario assume that authorization device determines that the data attributes e.g. name and address of the user are public and that the data attributes e.g. credit card information billing address and birth date are private based on using the database or the data structure.

In step authorization device selects contextual information. For example authorization device selects contextual information pertaining to resource requesting device based on the client identifier. According to this exemplary scenario assume that a client preference indicates to perform a Web based type of consent. According to this exemplary scenario assume that authorization device does not use contextual information pertaining to the resource owner.

Referring to in step authorization device selects the type of consent based on the scopes and the contextual information e.g. the client preference . According to this example assume that the birth date credit card information and the billing address are assigned the same private sensitivity level. For example authorization device stores a database or a data structure that correlates the sensitivity level and the contextual information to a type of consent. According to this scenario authorization device selects the type of consent based on a correlation between the private sensitivity level and the client identifier.

According to other scenarios authorization device selects the type of consent based on contextual information pertaining to the resource owner. As previously described the resource owner may provide contextual information to the extended OAuth service provider. The information indicating the type of consent to be used may be based on the contextual information of the resource owner. As an example the resource owner may indicate particular user device capabilities services subscribed to or a combination of both. Additionally or alternatively a resource owner may select preferences e.g. type of consent and or security level preferences pertaining to the release of protected resource data. According to such an embodiment the type of consent stored in the database or the data structure is based on the resource owner s contextual information. In cases when the extended OAuth service provider is a service provider of other services e.g. Internet mobile etc. for the resource owner subscriber profile information may be used to select and store the type of consent to be used.

According to an exemplary implementation the extended OAuth service provider may afford contextual information pertaining to the resource owner priority over the client s contextual information e.g. a client preference .

In step authorization device provides a login page to the user to sign into the extended OAuth service. The user provides login information via the login page and in step authorization device validates the login information with authentication device . According to this scenario assume that the user is successfully logged into the extended OAuth service.

In step after a successful login by the user authorization device provides a consent page that indicates the private scopes that require consent from the user. For example authorization device provides a consent page that prompts the user to authorize the release of the user s credit card information and birth date. According to an exemplary implementation authorization device does not seek authorization from the user for the release of the public scopes e.g. the user s name and address . According to this scenario the user authorizes the release of the private scopes via the consent page.

In step authorization device generates an authorization code based on the determination that the requested scopes include private resource data. In step authorization device redirects user device to resource requesting device with the authorization code. In step user device redirects to resource requesting device and resource requesting device obtains the authorization code. Referring to in steps and resource requesting device requests an access token based on the authorization code from authorization device via user device . According to this scenario assume that the authorization code is valid and in steps and authorization device issues an access token to resource requesting device via user device .

In step resource requesting device requests the scopes e.g. private and public resource data from resource device based on the received access token. In step resource device validates the access token with authorization device . According to this scenario assume that the access token is successfully validated. In step resource requesting device obtains the requested scopes from resource device . In step resource requesting device uses the requested scopes. For example according to this scenario resource requesting device pre populates a Web page with the requested resource data. In this way the registration process is facilitated on behalf of the user.

Processor may include one or multiple processors microprocessors data processors co processors application specific integrated circuits ASICs controllers programmable logic devices chipsets field programmable gate arrays FPGAs application specific instruction set processors ASIPs system on chips SoCs central processing units e.g. one or multiple cores microcontrollers and or some other type of component that interprets and or executes instructions and or data. Processor may be implemented as hardware e.g. a microprocessor etc. or a combination of hardware and software e.g. a SoC an ASIC etc. . Processor may include one or multiple memories e.g. memory storage etc.

Processor may control the overall operation or a portion of operation s performed by device . Processor may perform one or multiple operations based on an operating system and or various applications or programs e.g. software . Processor may access instructions from memory storage from other components of device and or from a source external to device e.g. a network another device etc. .

Memory storage may include one or multiple memories and or one or multiple other types of storage mediums. For example memory storage may include one or multiple types of memories such as random access memory RAM dynamic random access memory DRAM cache read only memory ROM a programmable read only memory PROM a static random access memory SRAM a single in line memory module SIMM a phase change memory PCM a dual in line memory module DIMM a flash memory and or some other type of memory. Memory storage may include a hard disk e.g. a magnetic disk an optical disk a magneto optic disk a solid state disk etc. a Micro Electromechanical System MEMS based storage medium and or a nanotechnology based storage medium.

Memory storage may be external to and or removable from device such as for example a Universal Serial Bus USB memory stick a dongle a hard disk mass storage off line storage or some other type of storing medium e.g. a compact disk CD a digital versatile disk DVD a Blu Ray disk BD etc. . Memory storage may store data software and or instructions related to the operation of device .

Software may include an application or a program that provides a function and or a process. Software may include firmware. For example authorization device may be implemented with one or more program s and or application s . Additionally for example with reference to user device one or more program s and or application s may be used to display user interfaces communicate with authorization device etc. Additionally for example other devices e.g. resource requesting device etc. may be implemented with software to provide a function and or a process described herein.

Communication interface may permit device to communicate with other devices networks systems etc. Communication interface may include one or multiple wireless interfaces and or wired interfaces. Communication interface may include one or multiple transmitters receivers and or transceivers. Communication interface may operate according to one or multiple protocols standards and or the like.

Input may permit an input into device . For example input may include a keyboard a mouse a display a touchscreen a touchless screen a button a switch an input port speech recognition logic and or some other type of visual auditory tactile etc. input component. Output may permit an output from device . For example output may include a speaker a display a touchscreen a touchless screen a light an output port and or some other type of visual auditory tactile etc. output component.

Device may perform processes and or functions as described herein in response to processor executing software stored by memory storage . By way of example instructions may be read into memory storage from another memory storage or read into memory storage from another device via communication interface . The instructions stored by memory storage may cause processor to perform one or more processes described herein. Alternatively for example according to other implementations device may perform one or more processes described herein based on the execution of hardware processor etc. or the execution of software e.g. processor executing software .

Referring to block process begins with receiving a request for a scope. For example authorization device receives a redirect e.g. an HTTP redirect from resource requesting device via user device . According to an exemplary implementation the redirect uses a URI that includes one or multiple name value pairs or other type of string that indicates a scope. Additionally for example the URI includes a client identifier that identifies resource requesting device .

In block it is determined whether the client is valid. For example authorization device extracts the client identifier from the URI. Authorization device provides the client identifier to authentication device . Authentication device authenticates resource requesting device based on the client identifier.

If it is determined that the client is not valid block NO then process ends block . For example authorization device generates and provides an error message indicating that the authentication failed. Authorization device may initiate other security measures.

If it is determined that the client is valid block YES then a sensitivity level of the scope is identified block . For example authorization device extracts the one or multiple name value pairs. Alternatively another type of string that indicates the scope may be used. Authorization device identifies the sensitivity level for each name value pair. By way of example authorization device stores a database or a data structure that maps or correlates a data attribute e.g. name address social security number birth date credit card information etc. to a sensitivity level e.g. public private high low medium etc. .

In block it is determined whether the scope requires resource owner authorization. For example authorization device determines whether consent from the resource owner is required before an authorization grant is provided to the client based on the identified sensitivity level s . By way of example if resource data of the scope is assigned a sensitivity level of public then consent from the resource owner is not needed for that resource data. Conversely if resource data of the scope is assigned a sensitivity level of private then consent from the resource owner is needed for that resource data.

If it is determined that the scope does not require authorization from the resource owner block NO then an authorization code is generated block . For example authorization device generates an authorization code that serves as an authorization grant.

In block the authorization code is provided to the client. For example authorization device uses a redirect to provide the authorization code to resource requesting device via user device . For example the URI of the redirect includes the authorization code.

If it is determined that the scope does require authorization from the resource owner block YES then contextual information is identified block . For example authorization device selects contextual information based on the client identifier. Authorization device may select contextual information pertaining to the resource owner. For example authorization device may obtain a resource owner identifier that allows authorization device to select contextual information pertaining to the resource owner.

Referring to a type of consent based on the sensitivity level and contextual information is selected block . For example authorization device uses the sensitivity level and the contextual information to select a type of consent. For example authorization device stores a database or a data structure that associates a type of consent with the sensitivity level and the contextual information.

In block the selected type of consent is provided to the resource owner. For example authorization device requests from the resource owner consent for the release of resource data of the scope that is assigned a sensitivity level of private or other appropriate nomenclature. As an example authorization device provides a user interface to request consent from the resource owner. The user interface includes the resource data the attributes of the resource data e.g. billing address etc. or both. Alternatively authorization device may use other well known methods to request consent from the resource owner. According to another implementation a third party service may be used to obtain consent from the resource owner.

In block it is determined whether authorization is obtained. For example authorization device determines based on a response from the resource owner whether consent from the resource owner is obtained. If authorization is not obtained block NO then process ends block . For example if the resource owner does not provide consent for the release of the private resource data then authorization device refuses this portion of the request.

If authorization is obtained block YES then an authorization code is generated block . For example if the resource owner provides consent for the release of the private resource data authorization device generates an authorization code that serves as an authorization grant.

In block the authorization code is provided to the client. For example authorization device uses a redirect to provide the authorization code to resource requesting device via user device . For example the URI of the redirect includes the authorization code.

Although illustrate an exemplary process for authorizing a scope request process may include additional operations fewer operations and or different operations than those illustrated in and described herein. For example when a scope request pertains to both private resource data and public resource data there are multiple possible outcomes. For example the resource owner may refuse to consent to the release of all of the private resource data or a portion thereof. According to one implementation if the resource owner fails to consent to the release of all of the private resource data the extended OAuth service fails. For example authorization device provides a message to resource requesting device that consent cannot be obtained. Alternatively according to another implementation the resource owner may consent to the release of only a portion of the private resource data. According to such an implementation authorization device generates an authorization code. As the process continues and resource requesting device obtains the scope e.g. private resource data from resource device resource requesting device may pre populate a page or perform some other usage with the private resource data. Resource requesting device may determine whether to request the private data from the user e.g. directly end the session continue with the session without the private data or perform some other response given the circumstances.

The foregoing description of embodiments provides illustration but is not intended to be exhaustive or to limit the embodiments to the precise form disclosed. Accordingly modifications to the embodiments described herein may be possible. By way of example the client may dynamically select a type of consent and communicate a preferred type of consent to authorization server in a redirect or other suitable manner when the extended OAuth service is invoked. According to an exemplary implementation the URI may include a string that identifies the selected type of consent. Authorization device extracts the string from the URI and selects the type of consent based on the string.

Although examples of resource data as described herein have pertained to personal information associated with a resource owner e.g. name address etc. the embodiments described are not limited to this type of resource data. For example a resource may be various forms of multimedia e.g. pictures videos etc. or any other form of data. Additionally although examples of client preferences as described herein have been described that the type of consent corresponds to the mode of communication used between the resource owner and the resource requesting device according to other embodiments the type of consent may include using a mode of communication that is different from the mode of communication used between the resource owner and the resource requesting device.

The terms a an and the are intended to be interpreted to include one or more items. Further the phrase based on is intended to be interpreted as based at least in part on unless explicitly stated otherwise. The term and or is intended to be interpreted to include any and all combinations of one or more of the associated items.

In addition while series of blocks have been described with regard to the process illustrated in the order of the blocks may be modified according to other embodiments. Further non dependent blocks may be performed in parallel. Additionally other processes described in this description may be modified and or non dependent operations may be performed in parallel.

The embodiments described herein may be implemented in many different forms of software firmware and or hardware. For example a process or a function may be implemented as logic or as a component. This logic or this component may include hardware e.g. processor etc. or a combination of hardware and software e.g. software . The embodiments have been described without reference to the specific software code since software can be designed to implement the embodiments based on the description herein.

Additionally embodiments described herein may be implemented as a non transitory storage medium that stores data and or information such as instructions program code data structures program modules an application etc. For example a non transitory storage medium includes one or more of the storage mediums described in relation to memory storage .

In the preceding specification various embodiments have been described with reference to the accompanying drawings. It will however be evident that various modifications and changes may be made thereto and additional embodiments may be implemented without departing from the broader scope of the invention as set forth in the claims that follow. The specification and drawings are accordingly to be regarded as illustrative rather than restrictive.

In the specification and illustrated by the drawings reference is made to an exemplary embodiment an embodiment embodiments etc. which may include a particular feature structure or characteristic in connection with an embodiment s . However the use of the phrase or term an embodiment embodiments etc. in various places in the specification does not necessarily refer to all embodiments described nor does it necessarily refer to the same embodiment nor are separate or alternative embodiments necessarily mutually exclusive of other embodiment s . The same applies to the term implementation implementations etc.

No element act or instruction described in the present application should be construed as critical or essential to the embodiments described herein unless explicitly described as such.

