---

title: Keeping file systems or partitions private in a memory device
abstract: Disclosed is a method and apparatus for allowing a user to select, from a plurality of partitions on a memory device, which partitions may be visible to hosts connecting to the memory device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08560802&OS=08560802&RS=08560802
owner: Blackberry Limited
number: 08560802
owner_city: Waterloo, Ontario
owner_country: CA
publication_date: 20120111
---
This is a divisional application which claims priority to co pending U.S. patent application Ser. No. 12 489 073 filed Jun. 22 2009 by Maxime Matton et al. entitled Keeping File Systems or Partitions Private in a Memory Device 34859 US PAT 4214 17501 and U.S. Provisional Patent Application No. 61 169 495 filed Apr. 15 2009 by Maxime Matton et al. entitled Keeping File Systems or Partitions Private in a Memory Device 34859 US PRV 4214 17500 which are incorporated by reference herein as if reproduced in their entirety.

This disclosure relates generally to the field of memory devices and in particular to the ability to keep a file system or partition private when connecting a memory device i.e. a memory stick a thumb drive or similar devices to a host device.

An external memory device a memory device may be connected to a computing device using a wired or wireless connection. A typical wired connection is USB and a typical wireless connection is Bluetooth. A computing device includes any type of computer that has a processor microprocessor or other logic that has the ability to read and write memory and execute instructions. This includes but is not limited to large computers small PC style computers and laptops PDAs cameras and other video devices controllers for various uses and smart cell phones. The computing device may be called the host device or simply the host.

The host and the memory device communicate using protocol stacks or their logical and functional equivalent using executable code or software on each end. The lower level layers of the protocol stack include the hardware and controllers. Using USB as an example the lower levels will include USB ports connectors and may include a cable physically between the host and memory device plus USB controllers and drivers at each end on the host and memory device . Other types of connections such as Bluetooth would have the connections applicable to that connection type e.g. for Bluetooth a wireless connection is established using at the lowest layers Bluetooth controllers and device drivers .

Further up the stack there will be application programming interfaces API one of which will include an application dealing with the management and control of memory devices mass storage devices . On the host side there will be an application that requests information about the layout of the memory on the memory device. On the memory device side there will be code running at the same protocol level that answers the host s request for information. Many memory devices use a logical memory layout that is consistent with the Microsoft method of laying out memory. This may include a master boot record MBR found at the lowest readable memory locations. The MBR contains information on how the memory is configured including information on up to four partitions. This information is supplied to the host which uses it to access partitions file systems etc. on the memory device.

An apparatus and method for using either a private local MBR and a public export MBR is described. In the following description for the purposes of explanation numerous specific details are set forth in order to provide a thorough understanding of the disclosed material. It will be apparent however to one skilled in the art and having the benefit of the present disclosure that the ideas and embodiments described may be practiced without adherence to just these specific descriptions.

The disclosure further encompasses computer readable medium configured such that when executed by a processor a.k.a. a micro processor or any other logic that can execute stored instructions the processes described herein are carried out.

Referring to the drawings is an exemplary host computing device or simply host with a memory device. Host is a computing device having a processor microprocessor or other logic device which may execute instructions. Host may have the capability to communicate with other computing devices or computer systems on the Internet. Depending on the exact functionality provided the host may be referred to as a computer a laptop a net device a data messaging device a wired or wireless e mail device a smart cellular telephone an Internet appliance a control device or controller a game console or a data communication device as examples.

Host may have a wireless communication subsystem outlined in a bolded border. This subsystem would exist in a host that has wireless telecommunications capabilities such as a smart cell phone. In that case host would be enabled to communicate with wireless network without wireless telecommunications capabilities wireless network is not applicable . Components would include both a receiver and a transmitter as well as associated components such as one or more antenna elements and local oscillators LOs and a processing module such as a digital signal processor DSP . As will be apparent to those skilled in the field of communications the particular design of the communication subsystem if present may be dependent upon the communication network in which the device is intended to operate and the current state of the art. For example host may include a communication subsystem designed to operate within the Mobitex mobile communication system the DataTAC mobile communication system GPRS network UMTS network EDGE network or any other suitable telecommunications network.

Illustrated for completeness but only required for hosts with certain telecommunications capabilities is SIM RUIM module . In UMTS and GPRS telecommunications networks network access is associated with a subscriber or user of host the subscriber user information being stored on the SIM RUIM module . Telecommunications configuration data and other information is illustrated as being part of SIM RUIM .

If host has telecommunications capabilities signals received by antenna through the communication network are input to receiver which may perform such common receiver functions as signal amplification frequency down conversion filtering channel selection and the like and in the example system shown analogue to digital A D conversion. A D conversion of a received signal allows more complex communication functions such as demodulation and decoding to be performed in the DSP . In a similar manner signals to be transmitted are processed including modulation and encoding for example by DSP and input to transmitter for digital to analogue conversion frequency up conversion filtering amplification and transmission over the communication network via antenna . DSP not only processes communication signals but also provides for receiver and transmitter control. For example the gains applied to communication signals in receiver and transmitter may be adaptively controlled through automatic gain control algorithms implemented in DSP .

Host typically includes a microprocessor processor or other logic that may execute instructions which controls the overall operation of the host by executing code or software stored in an executable sequence in memory retrievable by the microprocessor. Microprocessor interacts with host subsystems such as the display flash memory random access memory RAM and or any other memory type not shown auxiliary input output I O subsystems serial port keyboard speaker microphone a short range communications subsystem such as Bluetooth and a USB subsystem . Specifically included are aspects of the user interface UI which typically includes the aforementioned keyboard but is not limited to a keyboard. The keyboard may be physical or virtual or the UI can be configured as a series of choices where input at the keyboard determines which of the choices will be executed implemented by the host when the host runs an application which makes use of selections determined at the UI. An application is any combination of software or code executable by the microprocessor and stored in memory accessible by the microprocessor that when executed enables the functionality described.

Some of the subsystems shown in perform communication related functions whereas other subsystems may provide resident or on device functions. Notably some subsystems such as keyboard and display for example may be used for both communication related functions such as entering a text message for transmission over a communication network and device resident functions such as a calculator or task list.

Operating system software used by the microprocessor is preferably stored in a persistent store such as flash memory which may instead be a read only memory ROM or similar storage element that can keep state through power cycling not shown . Those skilled in the art will appreciate that the operating system as well as logically defined applications such as games address books or parts thereof are code or software which may be temporarily loaded into a volatile memory such as RAM from NVRAM or ROM or any other involatile memory. Received communication signals may also be stored in RAM .

As shown flash memory can be segregated into different areas for both computer programs and program data storage and . Application MBR Public Private is described in more detail below. These different storage types indicate that each program can allocate a portion of flash memory for their own data storage requirements. Microprocessor in addition to its operating system functions enables execution of software applications on the host. A predetermined set of applications that control basic operations will normally be installed on host during manufacturing. One example of a typical software application may be a personal information manager PIM application having the ability to organize and manage data items relating to the user of the host such as but not limited to calendar events appointments and task items. Naturally one or more memory stores would be available on the host to facilitate storage of PIM data items. Such a PIM application may have the ability to send and receive data items via a network and may further be configured to exchange data or information with other applications such as address book or MBR Public Private if desirable.

Also shown is USB memory device . Any connection may be used not just USB including but not limited to Bluetooth WiFi or Firewire. For non USB connections other communications would have the applicable software and hardware to make the connection. Memory device has a microcontroller data instructions code and memory therein as needed to carry out the mass storage or memory storage functionality described herein. Included is a logical layout of the memory space address space including a master boot record MBR . The MBR is described more fully below.

The memory is a writeable store such as a RAM into which other device components and systems may write data and includes a storage area for MBR Public Private application and an application data storage area . The MBR Public Private application stores MBR information and settings.

The data store is illustrative of stores that may be implemented in the memory on the host . The memory may also be used by other device systems in addition to those shown in and used to store described herein as well as other types of data.

The information in MBR for each partition tells the software where each partition in memory is located. Partition is located at the address where Partition Boot Record PBR starts shown as PBR subscript 1 . PBRs contain information specific to just this partition including the location of file access tables FATs and data. Generally any partition following partition is illustrated as PBR subscript x which contains the location of FATs data etc. for this particular partition. Unallocated or intervening memory locations perhaps containing other partitions between partition and partition x are shown as memory area .

This is one example of memory layout. Variations are fully contemplated herein including the use of various types and kinds of file access tables no use of PBRs file access tables only in partitions or any other layout in a partition that enables use of the memory in the partition for its intended purpose.

MBR is the same as MBR except it is labeled as an Actual Private alternatively may be labeled as Local MBR. This label indicates that this MBR reflects the actual layout of memory in the memory device. MBR is derived from MBR . This is indicated by the arrow pointing from MBR to MBR . MBR may have a subset of the partitions defined in MBR . In this example MBR has partitions and defined. MBR has a subset of the two defined partitions namely partition as being defined. Partition is the same for both MBR and MBR . It has the same information available the same file systems etc. However MBR has its partition fields set as not defined not in use . There are no pointers to the beginning of partition in MBR . Thus MBR contains a subset of the actual partitions on the memory device.

MBR is called a public or export MBR because it is intended for use by certain hosts to which this modified MBR may be made public or may be exported sent . Notice that the public MBR by containing only information on partition has hidden partition and the entirety of its contents from anyone receiving MBR the public MBR. Any host receiving the public MBR will have no knowledge of partition or its contents. Notice that actual MBR contains all the access information for partition so no data is actually lost. The host system however cannot access it. Put differently partition is actually present but is logically non existent to any host that has access to MBR and not MBR .

In order to generate and use a public MBR in association with an actual or local MBR code for convenience called an application may exist to manage the MBRs and their retrieval. This is shown on the host side as application in and is also located on the memory device.

Continuing into box the user indicates through the UI a setting to be made with the partition previously indicated. In some embodiments this is expected to be a flag set to either public or private . In other embodiments other labels may be used such as export and local . Continuing to box the selection made by the user is stored in a manner that associates the selection with the actual MBR partition. This may be referred to as the public private setting for the MBR partition. The setting indicates if this partition information is to be seen by any requestor of the information that is is to be made public. Any restriction on who may see the partition information means the partition is not public. This information is stored locally that is on the memory stick itself using the code resident on the memory stick. It may or may not also be stored on a specially designated master host that is always allowed to see the private MBR. Once the setting is stored box is left for endpoint indicating the application has finished for that one partition and may exit or may restart at to allow the user to make any other changes.

In one embodiment the code the enables the functionality described in will be resident on a master host such as host in . Once the settings are made the code to use the settings would reside on the memory device or in some embodiments on the master host and the memory device. This allows designers to minimize the amount of code residing on the memory device. However the actual configuration may be determined by each implementation as meets the needs of that particular embodiment.

Functionally the memory device minimally may need the code to make use of public and private MBRs. As further examples some embodiments may store the MBRs on the memory device after they are generated on a specially designated host and then use the MBRs when other hosts attach to the memory device. Other embodiments may execute code on the memory device that generates public MBRs as needed during each device initialization for use in that connection session. These choices and any other division of code may be made by designers as desired for their embodiment of the presently disclosed material.

If the answer is yes there is an MBR partition configuration associated with the connection type or host ID and the y exit is taken to box . Note that in some embodiments a host ID may be defined to include no host ID or an unauthenticated ID. The actions associated with box include selecting the MBR configuration associated with the connection type of host ID.

Returning to decision diamond if the answer is no there is no indication of any public or private partition settings for the incoming connection ID or connection type and the n exit is taken to decision diamond . Decision diamond corresponds to determining if there exists any default partition settings for connections without a previously specified connection or ID type. This may be used for example if a user wants to keep a partition private for anyone except her him self. The default setting is then to keep the indicated partitions private. Note that in the case where a user wants to keep access only to themselves a specially indicated host would have been recognized at decision diamond to grant access and this decision diamond would not be reached. If the answer at decision diamond is yes there is a default to be used for unrecognized connections and the y exit is taken to box . If the answer is no there is no general default and the n exit is taken to box . The actions associated with box are to determine that the public and private MBR are the same.

Returning to box which is reached from either box or decision diamond the actions taken are to either make use of or configure and make use of a public MBR. In some embodiments the actions may correspond to selecting one of an already generated set of MBRs consistent with the connection type or host ID. In other embodiments code will execute to generate a public MBR based on the private MBR for this connection session. A connection session is a connection between a particular host and a particular memory device from initial logical connection to the ending or breaking of the logical connection. The physical connection may or may not be terminated at the same time. In any event without the logical connection no information or communication is occurring between the host and the memory device. Thus the connection may be ended through logically disconnecting the memory device such as turning off the host physically removing the memory device or any other way of ending a connection to a host.

Continuing to box the actions are those associated with the memory device using the MBR as determined. This may mean providing the determined MBR to the host. Continuing to box the memory device continues to use the previously determined MBR for the remainder of this session. Finally box is entered when a session termination is detected. Actions associated with box will be those consistent with the particular embodiment. In some embodiments the MBR generated for this session is either actively erased deleted or is simply stored in a memory location which is to be overwritten upon device initialization. In other embodiments the MBR is indicated as no longer for the current session. It may be used in a future connection session. Box is left for end point which indicates the memory device is ready for a next connection session.

Note that the memory device may need to control MBR changes initiated by the host device. In some embodiments the memory device may simply disallow MBR changes from host devices excepting when the public and private MBR are the same. In other embodiments the memory device may only accept MBR changes from a specially designated host device such as a master host device.

The above descriptions are to illustrative examples of the new and unobvious ideas contained herein. To people having the benefit of this disclosure and who have knowledge in this field variations will be apparent while staying within the scope of the concepts described and claimed whether or not expressly described.

