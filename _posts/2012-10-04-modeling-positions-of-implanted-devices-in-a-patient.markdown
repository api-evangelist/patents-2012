---

title: Modeling positions of implanted devices in a patient
abstract: Technology is disclosed for modeling positions of implanted devices in a patient. In various embodiments, the technology can construct a forward model that predicts an electrical impedance between electrical contacts; detects an actual electrical impedance between electrical contacts; computes a fitness value based on a comparison between the detected electrical impedance and the predicted electrical impedance; varies at least one parameter of the forward model until the computed fitness value is a maximum fitness value; and displays at a display device a estimated position of the first lead and/or second leads.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09403020&OS=09403020&RS=09403020
owner: Nevro Corporation
number: 09403020
owner_city: Redwood City
owner_country: US
publication_date: 20121004
---
This application claims the benefit to U.S. Provisional Patent Application No. 61 543 257 filed Oct. 4 2011 entitled MODELING POSITIONS OF IMPLANTED DEVICES IN A PATIENT and U.S. Provisional Patent Application No. 61 543 766 filed Oct. 5 2011 entitled MODELING POSITIONS OF IMPLANTED DEVICES IN A PATIENT each of which is incorporated herein by reference in its entirety.

This application is related to U.S. patent application Ser. No. 12 895 403 entitled SYSTEMS AND METHODS FOR POSITIONING IMPLANTED DEVICES IN A PATIENT and filed on Sep. 30 2010 which Application is incorporated herein by reference in its entirety.

The following patent applications are incorporated herein by reference in their entireties U.S. application Ser. No. 12 468 688 filed May 19 2009 and titled IMPLANTABLE NEURAL STIMULATION ELECTRODE ASSEMBLIES AND METHODS FOR STIMULATING SPINAL NEURAL SITES U.S. application Ser. No. 12 362 244 filed Jan. 29 2009 and titled SYSTEMS AND METHODS FOR PRODUCING ASYNCHRONOUS NEURAL RESPONSES TO TREAT PAIN AND OR OTHER PATIENT CONDITIONS U.S. application Ser. No. 12 499 769 filed Jul. 8 2009 and titled SYSTEMS AND METHODS FOR ADJUSTING ELECTRICAL THERAPY BASED ON IMPEDANCE CHANGES U.S. application Ser. No. 12 765 685 filed Apr. 22 2010 and titled SPINAL CORD MODULATION FOR INDUCING PARESTHETIC AND ANESTHETIC EFFECTS AND ASSOCIATED SYSTEMS AND METHODS U.S. application Ser. No. 12 765 747 filed Apr. 22 2010 and titled SELECTIVE HIGH FREQUENCY SPINAL CORD MODULATION FOR INHIBITING PAIN WITH REDUCED SIDE EFFECTS AND ASSOCIATED SYSTEMS AND METHODS U.S. application Ser. No. 12 765 790 filed Apr. 22 2010 and titled DEVICES FOR CONTROLLING HIGH FREQUENCY SPINAL CORD MODULATION FOR INHIBITING PAIN AND ASSOCIATED SYSTEMS AND METHODS INCLUDING SIMPLIFIED CONTROLLERS U.S. Provisional Application No. 61 418 379 filed Nov. 30 2010 and titled EXTENDED PAIN RELIEF VIA HIGH FREQUENCY SPINAL CORD MODULATION AND ASSOCIATED SYSTEMS AND METHODS U.S. application Ser. No. 12 264 836 filed Nov. 4 2008 and titled MULTI FREQUENCY NEURAL TREATMENTS AND ASSOCIATED SYSTEMS AND METHODS and U.S. application Ser. No. 13 607 617 filed Sep. 7 2012 and titled SELECTIVE HIGH FREQUENCY SPINAL CORD MODULATION FOR INHIBITING PAIN INCLUDING CEPHALIC AND OR TOTAL BODY PAIN WITH REDUCED SIDE EFFECTS AND ASSOCIATED SYSTEMS AND METHODS.

The disclosed technology is directed generally to modeling positions of implanted devices in a patient.

Neurological stimulators have been developed to treat pain movement disorders functional disorders spasticity cancer cardiac disorders and various other medical conditions. Implantable neurological stimulation systems generally have an implantable pulse generator and one or more leads that deliver electrical pulses to neurological tissue or muscle tissue. For example several neurological stimulation systems for spinal cord stimulation SCS have cylindrical leads that include a lead body with a circular cross sectional shape and multiple conductive rings spaced apart from each other at the distal end of the lead body. The conductive rings operate as individual electrodes and the SCS leads are typically implanted by practitioners either surgically or percutaneously through a large needle inserted into the epidural space with or without the assistance of a stylet.

Once implanted the pulse generator applies electrical pulses to the electrodes which in turn modify the function of the patient s nervous system such as by altering the patient s responsiveness to sensory stimuli and or altering the patient s motor circuit output. During pain treatment the pulse generator applies electrical pulses to the electrodes which in turn can generate sensations that mask or otherwise alter the patient s sensation of pain. For example in many cases patients report a tingling or paresthesia that is perceived as more pleasant and or less uncomfortable than the underlying pain sensation. In other cases the patients can report pain relief without paresthesia or other sensations.

In any of the foregoing neurological stimulation systems it is important for the practitioners to accurately position the stimulator to provide effective therapy. One approach to accurately positioning the stimulator is to implant the stimulator in a surgical procedure so that the practitioner has a clear visual access to the implantation site. However many patients and practitioners wish to avoid the invasiveness and associated likelihood for complications typical of a surgical procedure. Accordingly many patients and practitioners prefer a less invasive e.g. percutaneous implantation technique. With a percutaneous approach the practitioner typically is unable to see exactly where the device is positioned because the device is beneath the patient s skin and in most SCS cases is within the patient s spinal column. In addition the process typically requires the patient to provide feedback to the practitioner based on that patient s sensations. Accordingly the industry has developed a variety of techniques for visualizing medical devices and anatomical features below the patient s skin. Such techniques include fluoroscopy which is commonly used to aid the practitioner when implanting SCS leads. However a drawback with fluoroscopy is that it results in added expense to the SCS implantation procedure it may be cumbersome to implement it limits the implantation procedure to sites with fluoroscopy equipment and it exposes the patient to unwanted x ray radiation.

The disclosed technology is directed generally to modeling positions of implanted devices in a patient. In various embodiments the technology is used to assist a practitioner implanting leads proximate to a patient s spinal cord to deliver high frequency signals that modulate neural activity at the patient s spine e.g. to address chronic pain. In other embodiments however the systems and associated methods can have different configurations components procedures and or purposes. Still other embodiments may eliminate particular components or procedures. A person of ordinary skill in the relevant art therefore will understand that the technology may include other embodiments with additional elements and or may include other embodiments without several of the features shown and described below with reference to the Figures. The technology estimates the relative positions of leads positioned in the fatty epidural space dorsal to the spinal cord and within the spine of the patient. By modeling impedances between multiple contacts e.g. electrical contacts on each lead computing a fitness value to represent similarity between an output of the model and measured impedances and attempting to maximize the fitness value the technology can accurately determine the relative positions of leads.

In various embodiments an implanted stimulation system includes two leads and each lead may have eight contacts. By modulating electrical signals at the leads and or contacts the implanted stimulation system can reduce pain that a patient experiences e.g. in the patient s spinal cord area. In other embodiments more or fewer leads and or contacts may be employed. In various embodiments the technology can detect impedances between contacts e.g. between any two specified contacts. In other embodiments the technology can detect impedances of paths between any two poles. A pole is a set of one or more contacts connected electrically and functioning as a unit. In these embodiments the casing or other electrically conductive components of the stimulation system may be used as contacts. The technology can assume that impedance along a given path is a function of a three dimensional Cartesian length of the path e.g. a sum of the impedance of the path through tissue plus one or more impedance values characteristic to the electrode tissue interface at the contacts involved in the path. In other embodiments other models of impedance may be employed. The technology constructs a model e.g. a forward model of the expected impedance measured between contacts of the two leads e.g. between contact of a first lead and each contact of a second lead. The model can take as input various parameters e.g. geometric parameters such as distances between the two leads at various points rotation about axes etc various physical parameters such as resistivity or specific impedance of nearby tissue and parameters representing impedance values at each contact. The impedance value for each contact is the impedance of an electrode tissue interface at that contact. The model can then output a set of predicted impedance measurements. The technology can then compute a fitness value that compares the output of the model with actually detected impedance values. In other embodiments the technology can compute a distance value that expresses the difference between the output of the model and the actually detected impedance values. By employing techniques for varying the inputs producing outputs and maximizing a computed fitness value or minimizing a computed distance value the technology can accurately detect the relative position of leads. Values for some or all parameters e.g. geometric parameters representing the detected relative position can be drawn from a continuous range of values e.g. a range of possible values that are not limited to discrete or predetermined values. Thus the technology employs the forward model to compute the position of leads without requiring predetermined positions for the leads and without requiring precalculated impedance measurement predictions for these predetermined positions.

In various embodiments the forward model can be used to optimize the position of the leads. As an example a practitioner may attempt to locate an optimal position for the leads e.g. to minimize patient discomfort. The technology can employ the forward model to predict the relative position of leads e.g. at some point in the future. As an example by analyzing the vectors of movement of the leads the technology can guide the practitioner e.g. by displaying on a screen the predicted positions of the leads. The technology may determine this predicted position by assuming a constant direction and rate of movement and calculating the expected position if the direction and rate were to remain constant. As another example a prediction of lead position based on previous lead movement data may be used to provide constraints starting values or historical comparisons for estimates of current lead position using the technology described herein. This previous lead movement data may include lead positions estimated from impedance or other measurements lead positions directly measured using fluoroscopy or other techniques or a combination of these data sources.

Several embodiments of the technology are described in more detail in reference to the Figures. The computing devices on which the described technology may be implemented may include one or more central processing units memory input devices e.g. keyboard and pointing devices output devices e.g. display devices storage devices e.g. memory disk drives etc. and network devices e.g. network interfaces . The memory and storage devices are computer readable media that may store instructions that implement aspects of the disclosed technology. These memory and storage devices may be tangible and or non transitory in various embodiments. In addition the data structures and message structures may be stored or transmitted via a data transmission medium such as a signal on a communications link. Various communications links may be used for computing devices to communicate such as the Internet a local area network a wide area network or a point to point dial up connection.

In various embodiments the signal delivery system includes a signal delivery device that includes features for delivering therapy to the patient after implantation. The pulse generator receiver can be connected directly to the signal delivery device or it can be coupled to the signal delivery device via a signal link e.g. an extension . In various embodiments the signal delivery device can include elongated leads or lead bodies and . As used herein the terms lead and lead body include any of a number of suitable substrates and or support members that carry devices for providing therapy signals to the patient . For example the lead can include one or more electrical contacts e.g. electrodes that direct electrical signals into the patient s tissue such as to provide for patient relief. In other embodiments the signal delivery device can include structures other than a lead body e.g. a paddle that also direct electrical signals and or other types of signals to the patient . In various embodiments lead delivers signals and lead detects the delivered signals. In other embodiments both leads and deliver signals.

The pulse generator receiver can transmit signals e.g. electrical signals to the signal delivery device that up regulate e.g. stimulate or excite and or down regulate e.g. block or suppress target nerves. As used herein and unless otherwise noted the terms modulate and modulation refer generally to signals that have either type of the foregoing effects on the target nerves. The pulse generator receiver can include a computing device with instructions for generating and transmitting suitable therapy signals. The pulse generator receiver and or other elements of the system can include one or more processors memories or other storage devices and or input output devices. Accordingly the process of providing modulation signals providing guidance information for locating the signal delivery device and or executing other associated functions can be performed by computer executable instructions stored in computer readable media or storage devices e.g. memory located at the pulse generator receiver and or other system components. The pulse generator receiver can include multiple portions elements and or subsystems e.g. for directing signals in accordance with multiple signal delivery parameters carried in a single housing as shown in or in multiple housings.

In some embodiments the pulse generator receiver can obtain power to generate the therapy signals from an external power source . The external power source can transmit power to the implanted pulse generator receiver using electromagnetic induction e.g. RF signals . For example the external power source can include an external coil that communicates with a corresponding internal coil not shown within the implantable pulse generator receiver . The external power source can be portable for ease of use.

During at least some procedures an external programmer e.g. a trial modulator can be coupled to the signal delivery device during an initial procedure prior to implanting the pulse generator receiver . For example a practitioner e.g. a physician a technician and or a company representative can use the external programmer to vary the modulation parameters provided to the signal delivery device in real time and select optimal or particularly efficacious parameters. These parameters can include the location from which the electrical signals are emitted as well as the characteristics of the electrical signals provided to the signal delivery device . In a typical process the practitioner uses a cable assembly to temporarily connect the external programmer to the signal delivery device . The practitioner can test the efficacy of the signal delivery device in an initial position e.g. a specified position which may be 5 mm from a particular point on or near the patient s spine . The practitioner can then disconnect the cable assembly e.g. at a connector reposition the signal delivery device and reapply the electrical modulation. This process can be performed iteratively until the practitioner obtains the desired position for the signal delivery device . Optionally the practitioner may move the partially implanted signal delivery device without disconnecting the cable assembly .

After a trial period with the external programmer the practitioner can implant the implantable pulse generator receiver within the patient for longer term treatment. The signal delivery parameters provided by the pulse generator receiver can still be updated after the pulse generator receiver is implanted via a wireless physician s programmer e.g. a physician s remote and or a wireless patient programmer e.g. a patient remote . The patient may have control over fewer parameters than does the practitioner.

The spinal cord is situated within a vertebral foramen between a ventrally located ventral body and a dorsally located transverse process and spinous process . Arrows V and D identify the ventral and dorsal directions respectively. The spinal cord itself is located within the dura mater which also surrounds portions of the nerves exiting the spinal cord including the ventral roots dorsal roots and dorsal root ganglia . In one embodiment a single first signal delivery device is positioned within the vertebral foramen at or approximately at the spinal cord midline . In another embodiment two second signal delivery devices are positioned just off the spinal cord midline e.g. about 1 mm. offset in opposing lateral directions so that the two signal delivery devices are spaced apart from each other by about 2 mm. In still further embodiments a single signal delivery device or pairs of signal delivery devices can be positioned at other locations e.g. at the dorsal root entry zone as shown by a third signal delivery device or at the dorsal root ganglia as shown by a fourth signal delivery device

In any of the foregoing embodiments it may be useful that the signal delivery device be placed at a target location that is expected e.g. by a practitioner or indicated e.g. by the patient to produce efficacious results in the patient when activated. The following disclosure describes techniques and systems for improving the level of accuracy with which the devices are positioned.

The lead and or other portions of the overall system can include features that guide the practitioner when positioning the lead at a target location. For example the signal transmission system can be carried by the lead and or the implanting tool and can communicate with the signal detector systems located outside the patient s body. Signal transmission devices and can generate emit and or reflect the locator signals in a manner that is detected by a signal detector device of a signal detector system. Although eight locator signals are illustrated there may be more or fewer locator signals even in embodiments with eight contacts per lead . In some embodiments the signal detector system is lead . In other embodiments not illustrated the signal detector system may be a system external to the patient. The first signal transmission device can be carried by the lead and can be independent of e.g. electrically isolated from the therapy contacts . The second signal transmission device can also be carried by the lead but can double as one of the therapy contacts . In some embodiments the second signal transmission device doubles as the distal most therapy contact located at or near the distal tip of the lead . In other embodiments the second signal transmission device can double as any of the other therapy contacts . The third signal transmission device is carried by the implanting tool rather than the lead . For example the third signal transmission device can be located at the distal most tip of the implanting tool .

A patient may respond to treatment differently depending on the relative positions of leads and . For example a patient may experience some relief from pain when lead is at a first position relative to lead and additional relief from pain when lead is at a second position relative to lead . The position of a first lead may be determined e.g. by using technology disclosed in the related application identified in the first paragraph of this patent specification. The relative position of the second lead e.g. in comparison to the position of the first lead can be specified using three dimensional Cartesian coordinates.

The relative position of the second lead as determined by the disclosed technology may also be used to identify leads in a fluoroscopic or other image. Such other images may be ambiguous or difficult to read due to overlap of leads in the image and projection of complex lead geometry into an image plane. In such a case the disclosed technology may determine that one lead is higher in the epidural canal thereby enabling unambiguous identification if the image similarly indicates that one lead is positioned higher than the other.

In some embodiments impedance measurements usable with the disclosed technology may be collected by the implantable pulse generator receiver or triggered by the wireless physician s programmer or the wireless patient programmer . These measurements may be collected regularly e.g. periodically or on a schedule determined by physician or patient activity. A series of relative lead positions over time may then be estimated using the methods disclosed herein correlated to pain or other clinical data indicative of device efficacy used to predict or constrain future estimates of lead position and or displayed to the practitioner.

At block the routine selects an initial parameter or set of parameters e.g. r 0.2 centimeters z 0 and Requal to measured or detected one to many contacts impedance values e.g. for each contact j. These initial parameters may represent a lead position believed to be most likely they may be based on previous lead position and impedance estimates or measurements or may be selected randomly from a physically plausible range of parameters. Those skilled in the art will appreciate that a population of parameter sets may be selected at block each member of the population representing a point in the solution space and additional steps may be applied to each member of the population to facilitate solution using a population based algorithm such as a genetic algorithm. As an example the routine may employ a model to predict expected impedances to each member of the population.

At block the routine employs a model e.g. a forward model e.g. to predict the expected impedances based on a set of parameters supplied to the forward model. Forward modeling techniques can be used to predict one or more values based on observed parameters by applying or varying one or more modeling functions. The forward model takes as parameters r z and that can be used to specify the position of a second lead relative to a first lead. The forward model also takes as parameters impedance parameters R e.g. for each contact j of leads and . When each lead has eight contacts j can take on values 1 through 16 and so there would be sixteen impedance values. The impedance parameters can indicate the electrode tissue impedance at each contact. The impedance parameters Rmay represent the actual electrode tissue impedance specific to the contact and can be used to predict the expected impedance between for example each contact and a set of other contacts. The impedance parameters Rmay be similar to the predicted expected impedances and the actual measured impedances but they are not necessarily equal to either.

In some embodiments the impedance between any two contacts j and k is assumed to be the sum of R R and a function f dist of the Cartesian distance dist between the two contacts j and k. The technology can model impedance between one set of one or more contacts and another set of one or more contacts using well known rules for addition of resistances. As an example the impedance between a contact j and a set of contacts k . . . n can be modeled by Equation 1 dist . . . dist 1 

In various embodiments the technology may employ more complex or less complex models of electrode tissue interface impedance and tissue impedance between two electrical contacts. These more complex or less complex models may include characteristics of the electrode tissue interface impedance and medium impedance such as linearity nonlinearity isotropy anisotropy or frequency dependence other structures affecting impedance such as vertebrae or spinal tissue or methods such as finite element modeling for calculation of impedances. Equation 1 and or the function f dist can accordingly be adapted to suit the various embodiments. Quantitative characteristics of these models such as tissue resistance per unit distance can also be treated as input parameters to the model and optimized by routine .

The forward model can output a set of simulated e.g. predicted impedance measurements for each set of parameters r z and R e.g. for each contact j . These simulated impedance measurements may be selected to correspond with actual impedance measurements that have been collected as an example if an impedance measurement has been collected between each contact and the set of all other contacts the forward model can be used to output simulated impedance measurements between each contact and the set of all other contacts.

At block routine computes a fitness value for the selected parameters. A fitness value is a computation of a similarity between the output of the forward model e.g. the simulated or predicted impedance measurements and the impedances actually detected or measured. The technology in various embodiments employs a log likelihood computation for the fitness value. The technology computes the fitness value F of an impedance calculated or predicted by the forward model R in respect to a measured impedance Rusing equation 2 

Thus when Rand Rare identical L 0.5 and F 0. Moreover when Rand Rdiverge by exactly one standard deviation L 0.84 and F 1.148. When L is approximately or effectively equal to 1 because of round off error a minimum value can be assigned to F.

Overall fitness for a particular set of outputs from the forward model can be computed by summing F for each calculated versus measured impedance pair. The fitness can be further refined by adding regularization components to favor plausible and parsimonious solutions. As an example a set of parameters describing a pair of leads positioned at right angles at a great distance from each other may yield the best fit to measured impedance values due for example to random noise or other sources of measurement error. However it may be assumed that small angles of inclination are most plausible all else being equal. An additional term may be added to the fitness computation to express the likelihood of the observed deviation from 0. In this way more unlikely values of r z and can be made to result in more negative fitness values and in the example above more plausible solutions may be favored even if the fit to measured values is not perfect.

According to testing completed by the applicants log likelihood fitness yields more stable results than some other criteria e.g. mean squared error fitness Cartesian distance criteria etc. However in other embodiments the technology may nevertheless employ mean squared error or Cartesian distance to evaluate fitness. In some embodiments the technology may also compute fitness against multiple sets of detected or measured impedances detected or measured within a relatively short duration e.g. one clinic visit. In these embodiments summing the fitness values from each computation may yield an overall fitness value more robust to measurement noise.

At decision block routine may determine whether an optimal fitness value has been computed. A fitness value may be deemed optimal if for example it is approximately or substantially equal to zero if it is greater than a predetermined threshold or if improvement with successive iterations of routine is less than a predetermined threshold. If an optimal fitness value has been computed the routine continues at block . Otherwise the routine continues at block .

At block routine varies one or more parameters. As an example the routine may vary r z and R. In some embodiments the technology may employ a variant of a simulated metal annealing technique to vary the parameters. An initial set of results can be computed starting from r 0.2 centimeters z 0 and Rselected using measured or detected one to many contacts impedance values e.g. for each contact j. The temperature in the simulated annealing technique can then be gradually decreased over several iterations and at each iteration a large number of new parameter sets may be generated randomly perturbing each parameter r z and Rby an amount proportional to the temperature e.g. so that the magnitude of the perturbations decreases with each iteration. Prior to proceeding to a subsequent iteration a specified number of the most fit e.g. parameter sets resulting in a highest F can be retained. Parameter sets resulting in less fitness may also be retained with a probability dependent on temperature and diminishing with each iteration. This can result in deriving more fit values progressively so that a most fit set of parameters can be ultimately identified that maximizes the fitness value. In other embodiments other techniques can be used to vary parameters. The routine then continues at block where a new output is generated from the forward model based on the parameters varied at block .

In various embodiments the technology may use techniques other than annealing to vary the parameters. These techniques can employ gradients genetic algorithms population swarms etc. One skilled in the art will recognize that various techniques exist to vary parameters and determine an optimal parameter set.

At block routine can indicate the relative positions of the leads or contacts e.g. on a display. As an example the technology may render e.g. display or draw a graphical depiction of one or both leads on a display so that the practitioner can visually see how the second lead is positioned relative to the first lead e.g. on a display device. The technology can render changes in position in nearly real time so that the changed positions are evident immediately e.g. by repeatedly measuring or detecting new impedance measurements and repeatedly using routine to determine relative lead positions for each new set of impedance measurements.

Those skilled in the art will appreciate that the logic illustrated in and described above may be altered in a variety of ways. For example the order of the logic may be rearranged substeps may be performed in parallel illustrated logic may be omitted other logic may be included etc.

A practitioner may employ the first region to quickly determine relative present positions of leads e.g. after insertion and modify parameters e.g. in response to changes illustrated in the user interface. In various embodiments region may indicate contacts associated with the leads and impedances detected thereat.

A practitioner may employ the second region e.g. to identify positions at which the patient indicated maximum relief from pain determine the period of time a patient has been treated to determine a follow up routine or schedule etc.

The user interface can be provided at a clinical environment e.g. where a patient undergoes treatment at a home e.g. in relation to a home monitor or elsewhere. In various embodiments the technology can correlate currently observed positions with impedance data changes over time or pain score e.g. as reported by the patient changes over time e.g. to indicate treatment programs or vertebral locations that may need to be re tested. As an example the user interface may graphically show regions of the patient s vertebra where treatment has been applied and results therefrom.

The user interface can be provided in conjunction with implanted pulse generators trial stimulators or other devices pertinent to the technology disclosed herein. In various embodiments the user interface may enable users e.g. practitioners to modify parameters provide alerts e.g. identify a need for a follow up visit record movement of leads etc.

From the foregoing it will be appreciated that specific embodiments of the technology have been described herein for purposes of illustration but that various modifications may be made without deviating from the technology. For example in other embodiments the technology can be used to locate devices other than spinal cord implants. In still further embodiments these devices and methodologies can be applied to implantable patient devices other than neural modulators e.g. other elements configured for patient implantation with therapy contacts in at least some cases . The implanting tools described above can have configurations other than a stylet e.g. a catheter in other embodiments. The locator signal emitters and detectors can be omnidirectional in certain embodiments or can be unidirectional in other embodiments. In certain embodiments phase shift and or phased array techniques can be implemented to enhance system efficacy. The signal delivery system can include one transmission device in certain embodiments and more than one transmission device in other embodiments.

In various embodiments the leads may have more or fewer than eight contacts or two leads. In various embodiments the leads may have different shapes e.g. cylindrical conical toroidal etc. Although the position of the contacts are illustrated as being equally spaced other embodiments may space the contacts in different positions and orientations.

In various embodiments the forward model may employ finite elements or other techniques e.g. to more accurately estimate impedances. Although the embodiments described above assume that human tissue is homogeneous e.g. for prediction of impedances other forward models may not make this assumption and may take account of inhomogeneous or anisotropic tissue models.

In some embodiments the technology may take account of the spinal anatomy of the patient. As an example the forward models that the technology may employ may vary depending on the presence or absence of tissue bone etc. so that impedances can be predicted more accurately. In some embodiments parameters describing the position of leads with respect to these anatomical structures may be included in the forward model and optimization process yielding a determination of position with respect to these structures in addition to a determination of relative lead position.

In various embodiments the technology may include for consideration impedances measured at various points e.g. various arbitrary points associated with the system in proximity to the patient.

In various embodiments the leads may be deformed because of contact with tissue or bone repeated use etc. The technology can adapt to these deformations e.g. by varying the forward model to include parameters relating to the extent of deformation. Because of these deformations electrical impedances may vary.

In various embodiments the technology may employ techniques designed to reduce or eliminate spurious measurements e.g. by ignoring measured impedances that are outside of expected norms.

Certain aspects of the technology described in the context of particular embodiments may be combined or eliminated in other embodiments. As an example of parameters r z and the z parameter may be given additional or exclusive consideration as compared to the r or parameters. In various embodiments more or fewer parameters may be employed. As an example tissue impedance may be specifically varied. Further while advantages associated with certain embodiments have been described in the context of those embodiments other embodiments may also exhibit such advantages and not all embodiments need necessarily exhibit such advantages to fall within the scope of the present disclosure. Accordingly the disclosure and associated technology can encompass other embodiments not expressly described or shown herein.

