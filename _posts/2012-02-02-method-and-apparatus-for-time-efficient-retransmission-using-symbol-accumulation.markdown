---

title: Method and apparatus for time efficient retransmission using symbol accumulation
abstract: An encoder receives an input bit stream and generates, based on the input bit stream, a first output bit stream based on at least a first polynomial and a second output bit stream based on at least a second polynomial. The first and second polynomials are each different from each other. The encoder forms a first packet of code symbols, having a first code rate, based on bits from the first output bit stream. A transmitter transmits the first packet. A receiver receives a first negative acknowledgment indicating unsuccessful decoding of the first packet after transmitting of the first packet. The encoder punctures bits from the second output bit stream and forms a second packet of code symbols having a second code rate. The second code rate is different from the first code rate. The transmitter transmits the second packet in response to the receiver receiving the first negative acknowledgment.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08438447&OS=08438447&RS=08438447
owner: QUALCOMM Incorporated
number: 08438447
owner_city: San Diego
owner_country: US
publication_date: 20120202
---
This application is a divisional of application Ser. No. 10 946 960 filed Sep. 21 2004 which is a continuation of application Ser. No. 10 618 465 filed Jul. 11 2003 now U.S. Pat. No. 7 024 611 which is a continuation of application Ser. No. 09 588 434 filed Jun. 6 2000 which is a divisional of application Ser. No. 08 969 319 filed Nov. 13 1997 now U.S. Pat. No. 6 101 168 assigned to the assignee hereof and hereby expressly incorporated by reference herein.

The present invention relates to data communication. More particularly the present invention relates to a novel and improved method and apparatus for the efficient retransmission of data using symbol accumulation.

The use of code division multiple access CDMA modulation techniques is one of several techniques for facilitating communications in which a large number of system users are present. Other multiple access communication system techniques such as time division multiple access TDMA and frequency division multiple access FDMA are known in the art. However the spread spectrum modulation techniques of CDMA has significant advantages over other modulation techniques for multiple access communication systems. The use of CDMA techniques in a multiple access communication system is disclosed in U.S. Pat. No. 4 901 307 entitled SPREAD SPECTRUM MULTIPLE ACCESS COMMUNICATION SYSTEM USING SATELLITE OR TERRESTRIAL REPEATERS assigned to the assignee of the present invention and is incorporated by reference herein. The use of CDMA techniques in a multiple access communication system is further disclosed in U.S. Pat. No. 5 103 459 entitled SYSTEM AND METHOD FOR GENERATING SIGNAL WAVEFORMS IN A CDMA CELLULAR TELEPHONE SYSTEM also assigned to the assignee of the present invention and is incorporated by reference herein. Furthermore the CDMA system can be designed to conform to the TIA EIA IS 95A Mobile Station Base Station Compatibility Standard for Dual Mode Wideband Spread Spectrum Cellular System hereinafter referred to as the IS 95A standard.

CDMA by its inherent nature of being a wideband signal offers a form of frequency diversity by spreading the signal energy over a wide bandwidth. Therefore frequency selective fading affects only a small part of the CDMA signal bandwidth. Space or path diversity is obtained by providing multiple signal paths through simultaneous links to a mobile user or remote station through two or more base stations. Furthermore path diversity may be obtained by exploiting the multipath environment through spread spectrum processing by allowing signals arriving with different propagation delays to be received and processed separately. Examples of improved demodulation using path diversity are illustrated in U.S. Pat. No. 5 101 501 entitled METHOD AND SYSTEM FOR PROVIDING A SOFT HANDOFF IN COMMUNICATIONS IN A CDMA CELLULAR TELEPHONE SYSTEM and U.S. Pat. No. 5 109 390 entitled DIVERSITY RECEIVER IN A CDMA CELLULAR TELEPHONE SYSTEM both assigned to the assignee of the present invention and incorporated by reference herein.

The reverse link refers to a transmission from a remote station to a base station. On the reverse link each transmitting remote station acts as an interference to other remote stations in the network. Therefore the reverse link capacity is limited by the total interference which a remote station experiences from other remote stations. The CDMA system increases the reverse link capacity by transmitting fewer bits thereby using less power and reducing interference when the user is not speaking.

The forward link refers to a transmission from a base station to a remote station. On the forward link the transmission power of the base station is controlled for several reasons. A high transmission power from the base station can cause excessive interference with other base stations. Alternatively if the transmission power of the base station is too low the remote station can receive erroneous data transmissions. Terrestrial channel fading and other known factors can affect the quality of the forward link signal as received by the remote station. As a result the base station attempts to adjust its transmission power of signal to each remote station to maintain the desired level of performance at the remote station.

The forward link and reverse link are capable of data transmission at variable data rates. A method for transmitting data in data packets of fixed size wherein the data source provides data at a variable data rate is described in detail in U.S. Pat. No. 5 504 773 entitled METHOD AND APPARATUS FOR THE FORMATTING OF DATA FOR TRANSMISSION assigned to the assignee of the present invention and incorporated by reference herein. Data is partitioned into data packets or packets and each data packet is then encoded into an encoded packet. Typically the encoded packets are of a predetermined duration. For example in accordance with the IS 95A standard for the forward link each encoded packet is 20 msec wide and at the 19.2 Ksps symbol rate each encoded packet contains 384 symbols. A rate or a rate convolutional encoder is used to encode the data depending on the application. Using a rate encoder the data rate is approximately 9.6 Kbps. At the 9.6 Kbps data rate there are 172 data bits 12 cyclic redundancy check CRC bits and 8 code tail bits per data packet.

At lower data rates such as 4.8 Kbps 2.4 Kbps or 1.2 Kbps the code symbols within the encoded packet is repeated Nnumber of times to maintain a constant 19.2 Ksps symbol rate. Symbol repetition is performed to provide time diversity which improves the decoding performance in an impaired channel. To minimize the transmission power and increase system capacity the transmission power level of each symbol is scaled in accordance with the repetition rate N.

In accordance with the IS 95A standard each data packet is block encoded with a CRC polynomial and then convolutionally encoded. The encoded packet is transmitted from the source device to the destination device. At the destination device the received packet is demodulated and convolutionally decoded with a Viterbi decoder. The decoded data is then checked by a CRC checker to determine if the received packet has been decoded correctly or in error. The CRC check is only able to determine whether an error within the decoded packet is present. The CRC check is not able to correct the error. Therefore another mechanism is required to allow correction of the data packets received in error.

An aspect of the invention may reside in a method for communicating data. In the method an encoder receives an input bit stream and generates based on the input bit stream a first output bit stream based on a first polynomial a second output bit stream based on a second polynomial a third output bit stream based on a third polynomial and a fourth output bit stream based on a fourth polynomial. The first second third and fourth polynomials are each different from each other. The encoder combines bits from the first output bit stream and from the second output bit stream to form a first packet of code symbols having a first code rate. A transmitter transmits the first packet. A receiver receives a first negative acknowledgment indicating unsuccessful decoding of the first packet after said transmitting of the first packet. The encoder combines bits from the third output bit stream and from the fourth output bit stream and punctures the combined bits to form a second packet of code symbols having a second code rate. The second code rate is different from the first code rate. The transmitter transmits the second packet in response to the receiver receiving the first negative acknowledgment.

In more detailed aspects of the invention the first code rate may be and the second code rate may be . Also the transmitter may transmit the second packet concurrently with a new packet formed by the encoder by combining subsequent bits from the first output bit stream and from the second output bit stream.

Another aspect of the invention may reside in a station for communicating data having an encoder a receiver and a transmitter. The encoder is configured to receive an input bit stream and generate based on the input bit stream a first output bit stream based on a first polynomial a second output bit stream based on a second polynomial a third output bit stream based on a third polynomial and a fourth output bit stream based on a fourth polynomial wherein the first second third and fourth polynomials are each different from each other combine bits from the first output bit stream and from the second output bit stream to form a first packet of code symbols having a first code rate and combine bits from the third output bit stream and from the fourth output bit stream and puncture the combined bits to form a second packet of code symbols having a second code rate. The second code rate is different from the first code rate. The receiver is configured to receive a first negative acknowledgment. The transmitter is configured to transmit the first packet and transmit the second packet in response to the receiver receiving the first negative acknowledgment indicating unsuccessful decoding of the first packet after the transmit of the first packet.

Another aspect of the invention may reside in a station comprising means for receiving an input bit stream and generating based on the input bit stream a first output bit stream based on a first polynomial a second output bit stream based on a second polynomial a third output bit stream based on a third polynomial and a fourth output bit stream based on a fourth polynomial wherein the first second third and fourth polynomials are each different from each other means for combining bits from the first output bit stream and from the second output bit stream to form a first packet of code symbols having a first code rate means for transmitting the first packet means for receiving a first negative acknowledgment indicating unsuccessful decoding of the first packet after said transmitting the first packet means for combining bits from the third output bit stream and from the fourth output bit stream and puncturing the combined bits to form a second packet of code symbols having a second code rate wherein the second code rate is different from the first code rate and means for transmitting the second packet in response to receiving the first negative acknowledgment.

An aspect of the invention may reside in another method for communicating data. In the method an encoder receives an input bit stream. The encoder generates based on the input bit stream a first output bit stream based on at least a first polynomial and a second output bit stream based on at least a second polynomial. The first and second polynomials are each different from each other. The encoder forms a first packet of code symbols having a first code rate based on bits from the first output bit stream. A transmitter transmits the first packet. A receiver receives a first negative acknowledgment indicating unsuccessful decoding of the first packet after said transmitting of the first packet. The encoder punctures bits from the second output bit stream and forms a second packet of code symbols having a second code rate. The second code rate is different from the first code rate. The transmitter transmits the second packet in response to the receiver receiving the first negative acknowledgment.

Another aspect of the invention may reside in a station for communicating data having an encoder a receiver and a transmitter. The encoder is configured to receive an input bit stream generate based on the input bit stream a first output bit stream based on at least a first polynomial and a second output bit stream based on at least a second polynomial wherein the first and second polynomials are each different from each other form a first packet of code symbols having a first code rate based on bits from the first output bit stream and puncture bits from the second output bit stream and form a second packet of code symbols having a second code rate. The second code rate is different from the first code rate. The receiver is configured to receive a first negative acknowledgment. The transmitter is configured to transmit the first packet and transmit the second packet in response to the receiver receiving the first negative acknowledgment indicating unsuccessful decoding of the first packet after the transmit of the first packet.

Another aspect of the invention may reside in a station comprising means for receiving an input bit stream means for generating based on the input bit stream a first output bit stream based on at least a first polynomial and a second output bit stream based on at least a second polynomial wherein the first and second polynomials are each different from each other means for the encoder forming a first packet of code symbols having a first code rate based on bits from the first output bit stream means for transmitting the first packet means for receiving a first negative acknowledgment indicating unsuccessful decoding of the first packet after said transmitting the first packet means for puncturing bits from the second output bit stream and forming a second packet of code symbols having a second code rate wherein the second code rate is different from the first code rate and means for transmitting the second packet in response to receiving the first negative acknowledgment.

For simplicity the following discussion details the transmission and retransmission of data packets from a source device to a destination device without regard to whether the source device is a base station or a remote station . The present invention is equally applicable for data transmission by base station on the forward link and data transmission by remote station on the reverse link.

Referring to the figures represents an exemplary communication system of the present invention which is composed of multiple base stations in communication with multiple remote stations only one remote station is shown for simplicity . System controller connects to all base stations in the communication system and the public switched telephone network PSTN . System controller coordinates the communication between users connected to PSTN and users on remote stations . Data transmission from base station to remote station occurs on the forward link through signal paths and transmission from remote station to base station occurs on the reverse link through signal paths . The signal path can be a straight path such as signal path or a reflected path such as signal path . Reflected path is created when the signal transmitted from base station is reflected off reflection source and arrives at remote station through a different path than the straight path. Although illustrated as a block in reflection source is an artifact in the environment in which remote station is operating e.g. a building or other structures.

An exemplary block diagram of base station and remote station of the present invention is shown in . Data transmission on the forward link originates from data source which provides the data in data packets to encoder . An exemplary block diagram of encoder is shown in . Within encoder CRC encoder block encodes the data with a CRC polynomial which in the exemplary embodiment conforms to the IS 95A standard. CRC encoder appends the CRC bits and inserts a set of code tail bits to the data packet. The formatted data packet is provided to convolutional encoder which convolutionally encodes the data and provides the encoded data packet to symbol repeater . Symbol repeater repeats the encoded symbols Ns times to provide a constant symbol rate at the output of symbol repeater regardless of the data rate of the data packet. The repeated data is provided to block interleaver which reorders the symbols and provides the interleaved data to modulator MOD . A block diagram of an exemplary modulator is shown if . Within modulator the interleaved data is spread by multiplier with the long PN code which identifies the remote station to which the data is transmitted. The long PN spread data is provided to multiplier which covers the data with the Walsh code corresponding to the traffic channel assigned to remote station . The Walsh covered data is further spread with the short PNI and PNQ codes by multipliers and . The short PN spread data is provided to transmitter TMTR see which filters modulates and amplifies the signal. The modulated signal is routed through duplexer and transmitted from antenna on the forward link through signal path .

A block diagram of an alternative modulator is shown in . In this embodiment data source provides data packets to two encoders which encode the data as described above. The interleaved data and the pilot and control data are provided modulator . Within modulator the interleaved data from the first encoder is provided to Walsh modulator and the interleaved data from the second encoder is provided to Walsh modulator . Within each Walsh modulator the data is provided to multiplier which covers the data with a Walsh code assigned to that Walsh modulator . The covered data is provided to gain element which scales the data with a scaling factor to obtain the desired amplitude. The scaled data from Walsh modulators and are provided to summer which sums the two signals and provides the resultant signal to complex multiplier . The pilot and control data are provided to multiplexer MUX which time multiplexes the two data and provides the output to gain element . Gain element scales the data to obtain the desired amplitude and provides the scaled data to complex multiplier .

Within complex multiplier the data from gain element is provided to multipliers and and the data from summer is provided to multipliers and . Multipliers and spread the data with the spreading sequence from multiplier and multipliers and spread the data with the spreading sequence from multiplier . The output of multipliers and are provided to summer which subtracts the output of multiplier from the output of multiplier to provide the I channel data. The output of multipliers and are provided to summer which sums the two signals to provide the Q channel data. The spreading sequences from multipliers and are obtained by multiplying the PNI and PNQ codes with the long PN code respectively.

Although modulator as shown in support transmission of two traffic channels which are labeled as the fundamental channel and the supplemental channel modulator can be modified to facilitate transmission of additional traffic channels. In the description above one encoder is utilized for each traffic channel. Alternatively one encoder can be utilized for all traffic channels with the output of encoder demultiplexed into multiple data streams one data stream for each traffic channel. Various modifications of the encoder and modulator as described above can be contemplated and are within the scope of the present invention.

At remote station see the forward link signal is received by antenna routed through duplexer and provided to receiver RCVR . Receiver filters amplifies demodulates and quantizes the signal to obtain the digitized I and Q baseband signals. The baseband signals are provided to demodulator DEMOD . Demodulator despreads the baseband signals with the short PNI and PNQ codes decovers the despread data with the Walsh code identical to the Walsh code used at base station despreads the Walsh decovered data with the long PN code and provides the demodulated data to decoder .

Within decoder which is shown in block de interleaver reorders the symbols within the demodulated data and provides the de interleaved data to Viterbi decoder . Viterbi decoder convolutionally decodes the de interleaved data and provides the decoded data to CRC check element . CRC check element performs the CRC check and conditionally provides the checked data to data sink .

Data transmission from remote station to base station on the reverse link can occur in one of several embodiments. In the first embodiment the reverse link transmission can occur over multiple orthogonal code channels similar to the structure used for the forward link. The exemplary embodiment of a remote transmission system which supports multiple code channels on the reverse link is described in detail in U.S. Pat. No. 5 930 230 entitled HIGH DATA RATE CDMA WIRELESS COMMUNICATION SYSTEM assigned to the assignee of the present invention and incorporated by reference herein. A simplified block diagram of the structure is shown in . Data source provides the data in data packets through DEMUX to channel encoders . Within each channel encoder CRC encoder block encodes the data packet then appends the CRC bits and a set of code tail bits to the data. The formatted data packet is provided to convolutional encoder which convolutionally encodes the data and provides the encoded data packet to symbol repeater . Symbol repeater repeats the symbols with the encoded data packet Ns times to provide a constant symbol rate at the output of symbol repeater regardless of the data rate. The repeated data is provided to block interleaver which reorders the symbols within the repeated data and provides the interleaved data to modulator MOD .

Within modulator the interleaved data from each channel encoder is provided to a Walsh modulator . Within Walsh modulator the interleaved data is covered by multiplier with the Walsh code which identifies the code channel of the set of code channels transmitted by the remote station on which the data is transmitted. The Walsh covered data is provided to gain adjust which amplifies the data with the desired gain setting for the code channel. The outputs from Walsh modulators are provided to complex PN spreader which spreads the Walsh covered data with the long PN code and the short PN codes. The modulated data is provided to transmitter see which filters modulates and amplifies the signal. The modulated signal is routed through duplexer and transmitted from antenna on the reverse link through signal path . A more detailed description of the reverse link architecture can be obtained from the aforementioned U.S. Pat. No. 5 930 230.

In the second embodiment the reverse link is defined in accordance with the IS 95A standard. In essence the reverse link transmission by remote station is defined in accordance with the temporal offset of a common long PN sequence generator. At two differing offsets the resulting modulation sequences are uncorrelated. The offset of each remote station is determined in accordance with a unique numerical identification of the remote station which in the exemplary embodiment of an IS 95A remote station is the electronic serial number ESN . Thus each remote station transmits on one uncorrelated reverse link channel determined in accordance with its unique electronic serial number.

The reverse link structure of the second embodiment is fully described in the aforementioned U.S. Pat. No. 4 901 307. In summary the data packets are provided by data source to encoder which encodes the data packets with a CRC block code and a convolutional code. The encoded data is repeated to maintain a constant symbol rate regardless of the data rate. Six symbols of encoded data are mapped into a 64 bit Walsh symbol. The mapped signal is spread by the long PN code and the short PN codes. The modulated data is provided to transmitter which performs the same function as that described in the first embodiment.

An exemplary block diagram illustrating the circuit for demodulating the received signal is shown in . The digitized I and Q baseband signals from receiver or are provided to a bank of correlators . Each correlator can be assigned to a different signal path from the same source device or a different transmission from a different source device. Within each assigned correlator the baseband signals are despread with the short PNI and PNQ codes by multipliers . The short PNI and PNQ codes within each correlator can have a unique offset corresponding to the propagation delay experienced by the signal being demodulated by that correlator . The short PN despread data is decovered by multipliers with the Walsh code assigned to the traffic channel being received by the correlator . The decovered data is provided to filters which accumulate the energy of the decovered data over a Walsh symbol period.

The short PN despread data from multipliers also contains the pilot signal. In the exemplary embodiment at the source device the pilot signal is covered with the all zero sequence corresponding to Walsh code 0. In the alternative embodiment the pilot signal is covered with an orthogonal pilot sequence as described in U.S. Pat. No. 6 285 655 entitled METHOD AND APPARATUS FOR PROVIDING ORTHOGONAL SPOT BEAMS SECTORS AND PICOCELLS assigned to the assignee of the present invention and incorporated by reference herein. The short PN despread data is provided to pilot correlator which perform pilot decovering symbol accumulation and lowpass filtering of the despread data to remove the signals from other orthogonal channels e.g. the traffic channels paging channels access channels and power control channel transmitted by the source device. If the pilot is covered with Walsh code 0 no Walsh decovering is necessary to obtain the pilot signal.

A block diagram of an exemplary pilot correlator is shown in . The despread data from multiplier is provided to multiplier which decovers the despread data with the pilot Walsh sequence. In the exemplary embodiment the pilot Walsh sequence corresponds to Walsh code 0. However other orthogonal sequences and be utilized and are within the scope of the present invention. The decovered data is provided to symbol accumulator . In the exemplary embodiment symbol accumulator accumulates the decovered symbols over the length of the pilot Walsh sequence which for IS 95 Walsh sequence is 64 chips in duration. The accumulated data is provided to lowpass filter which filters the data to remove noise. The output from lowpass filter comprises the pilot signal.

The two complex signals or vectors corresponding to the filtered pilot signal and the filtered data symbols are provided to dot product circuit which computes the dot product of the two vectors in a manner well known in the art. In the exemplary embodiment dot product circuit is described in detail in U.S. Pat. No. 5 506 865 entitled PILOT CARRIER DOT PRODUCT CIRCUIT assigned to the assignee of the present invention and incorporated by reference herein. Dot product circuit projects the vector corresponding to the filtered data symbol onto the vector corresponding to the filtered pilot signal multiplies the amplitude of the vectors and provides a signed scalar value to combiner .

The pilot signal from each correlator reflects the signal strength of the signal path received by that correlator . Dot product circuit multiplies the amplitude of the vector corresponding to the filtered data symbols the amplitude of the vector corresponding to the filtered pilot signal and the cosine of the angle between the vectors. Thus the output from dot product circuit corresponds to the energy of the received data symbol. The cosine of the angle between the vectors e.g. the angle of the pilot minus the angle of the traffic weighs the output in accordance with the noise in both pilot and traffic vectors.

Combiner receives the scalar values from each correlator which has been assigned to a signal path and combines the scalar values. In the exemplary embodiment combiner coherently combines the scalar values for each received symbol. An exemplary embodiment of combiner is described in detail in U.S. Pat. No. 5 109 390 entitled DIVERSITY RECEIVER IN A CDMA CELLULAR TELEPHONE SYSTEM assigned to the assignee of the present invention and incorporated by reference herein. Coherent combination takes into account the sign of the scalar output from each correlator and results in the maximal ratio combining of the received symbols from different signal paths. The combined scalar value from combiner is represented as an m bit soft decision value for subsequent demodulation and decoding. The soft decision values are provided to multiplier which despreads the soft decision values with the long PN code to produce the demodulated data. The demodulated data is decoded in the manner described above.

In a communication system in which the pilot signal is not transmitted by the source device the dot product is not performed. Combiner simply combines the measured amplitude or energy of the received signal from filters .

With the CRC check the destination device is able to determine whether the data packet was received in a condition capable of correction by the Viterbi decoder. In the present invention one of a number of protocols can be used to control the retransmission of packets received in error. The following embodiments list some of the methods that can be used. Other methods are extensions of the present invention and are within the scope of the present invention.

In the first embodiment the destination device acknowledges every received packet and sends an ACK message back to the source device if the packet is received correctly or a NACK message if the packet is received in error. For each transmitted packet the source device monitors the ACK and NACK messages and retransmits the packets received in error. In this embodiment the source device can retransmit a packet if an ACK or NACK message for that packet is not received within a predetermined time period. Furthermore the source device can terminate the retransmission of a packet if an ACK or NACK message is not received after a predetermined number of retransmissions.

In the second embodiment the destination device acknowledges every received packet with an ACK or NACK message as in the first embodiment. The messages are sent by the destination device in an ordered manner to the source device. Therefore if the source device recognizes that a message has not been received for a packet the source device retransmits that packet. For example if the source device receives a message for packet i 1 but has not received a message for packet i then the source device realizes that either packet i or the message for packet i was not received properly. Therefore the source device retransmits packet i. The second embodiment is an extension of the first embodiment which can be used to speed up the retransmission process.

In the third embodiment the destination device acknowledges only packets which are received in error with the NACK messages. The source device only retransmits a packet if a NACK message is received. The destination device can retransmit the NACK message e.g. if a retransmission has not been received correctly after a predetermined time period .

In the exemplary embodiment if a packet was received in error the destination device transmits a NACK message back to the source device. The packet received in error can be retransmitted concurrently with the new packet in the current frame or at a subsequent frame. Preferably the packet received in error is retransmitted in the current frame to minimize processing delays. In the exemplary embodiment the retransmitted packet comprises the identical code symbols which were transmitted previously. In the alternative embodiment the retransmitted packet comprises new code symbols.

A block diagram of an exemplary convolutional encoder of the present invention is shown in . In the exemplary embodiment convolutional encoder is a constraint length K 9 encoder although other constraint lengths can also be utilized. The input bits are provided to K 1 delay elements . The outputs from selected delay elements are provided to a set of summers which perform modulo two addition of the inputs to provide the generator output. For each summer the delay elements are selected based on a polynomial which is carefully chosen for high performance.

In the exemplary embodiment wherein the retransmitted packet comprises the identical code symbols which were transmitted previously convolutional encoder is designed for the necessary code rate. For example for a rate convolutional encoder only two generators e.g. g and g from summers and respectively are necessary and the remaining generators can be omitted. At the receiver the code symbols for the retransmitted packets can be combined with the corresponding code symbols from prior transmissions or can replace those prior transmitted symbols. The increased energy from symbol accumulation results in improved decoding performance at the receiver.

In the alternative embodiment wherein the retransmitted packet comprises new code symbols which may not have been transmitted previously convolutional encoder is designed to produce code symbols at various code rates. Referring to for an exemplary rate convolutional encoder each input bit results in two output code symbols e.g. from generators g and g . The original transmission can comprise the code symbols for the original code rate e.g. code symbols from generator g and g for rate . If this packet is received in error the retransmitted packet can comprise the code symbols from other generators which have not been transmitted previously e.g. generators g and or g . At the receiver the code symbols for the retransmitted packets are interleaved not combined with the corresponding code symbols from prior transmissions. The Viterbi decoder then decodes the accumulated packet comprising the code symbols from the transmitted and retransmitted packets using a code rate corresponding to the accumulated packet. As an example assume the original transmission utilizes rate and the Viterbi decoder originally decodes using rate . Assume further that the packet was received in error. The retransmitted packet can comprise the code symbols from generator g. In this case the Viterbi decoder would decode the received codes symbols from generators g g and g using rate . Similarly if the accumulated packet is decoded in error an additional retransmitted packet comprising codes symbols from generator g can be transmitted and the Viterbi decoder would decode the accumulated packet comprising codes symbols from generators g g g and g using rate . The lower code rates provide enhanced error correcting capabilities over the original rate .

Other code rates can also be generated by using punctured codes and are within the scope of the present invention. Punctured codes are thoroughly treated by J. Cain G. Clark and J. Geist in Punctured Convolutional Codes of Rate n 1 n and Simplified Maximum Likelihood Decoding IEEE Transaction on Information Theory IT 25 pgs. 97 100 January 1979. As an example the original transmission can comprise the code symbols from generators g and g for rate and the retransmission can comprise code symbols from generators g and g which have been punctured to rate . The accumulated packet from both transmissions would comprise code symbols from generators g g g and g having a punctured rate 3 10. Puncturing reduces the number of code symbols to be retransmitted but also reduces the error correcting capability of the convolutional code.

In communication systems wherein the symbol rate can not be increased to accommodate the additional retransmitted symbols the source device can change the code rate of the convolutional encoder to decrease the number of code symbols needed for the new packet. The saving in code symbols can then be used for the retransmitted packet. For example a data packet comprising 192 bits can be encoded nominally using a rate code to generate 384 code symbols. To retransmit a packet concurrently with the transmission of a new packet the new packet can be encoded with a rate code resulting in the generation of 256 code symbols. The remaining 128 code symbols can comprise the retransmitted packet.

Using this scheme whereby the code rate of the new packet can be adjusted it may be possible to operate symbol repetition in the nominal manner. Since the code rate is decreased a higher operating E Iis probably required to maintain the same level of performance. The transmission power level can be adjusted such that the Eof each symbol is increased to maintain the requisite level of performance. This scheme is especially useful to avoid additional delay when the data rate of the new packet is at full rate.

The source device can retransmit the packet received in error in one of many embodiments. In the first embodiment the retransmission is achieved by substituting the repeated symbols for the new packet with the code symbols for the retransmitted packet. For example if there are 384 symbols in a frame and 288 of the symbols are repeated then these 288 symbols can be used for the code symbols for the retransmitted packet. At least 96 symbols are reserved for the code symbols for the new packet. If the retransmitted packet improves the decoding by the destination device and results in an error free data packet then the retransmission does not degrade the throughput rate even in the presence of errors in the channel.

The probability of a packet received in error is dependent on the quality as measured by the energy per bit to noise plus interference ratio E I of the received signal and the variation of the signal quality over time. The energy per bit Eis determined by the amount of energy received over a symbol period. If the repeated symbols are used for the code symbols for the retransmitted packet the symbol periods for the new symbols and the retransmitted symbols are shortened correspondingly. If the transmission power is maintained at the same level by the source device the Ewill be lower for each new and retransmitted symbol and can result in a higher error rate. To maintain the same Eover a shorter symbol period the transmission power level of the symbols is increased. In fact the transmission power level can be increased such that the Eis higher than nominal to compensate for the loss in time diversity that results from not repeating the symbols.

The transmission power level can be increased by the same amount for the new and retransmitted symbols or by different amounts. This choice is determined by system considerations. If the transmission power level is increased sufficiently for the retransmitted symbols the destination device can decode the retransmitted packet without regard to the original packet which was received in error. However higher transmission power consumes system resources and can decrease the system capacity. In the preferred embodiment the transmission power level is adjusted such that the Efor the retransmitted symbols is lower than that of the new symbols. Furthermore the transmission power level for the retransmitted symbols can be set at or slightly above the minimal level such that the energy of the retransmitted symbols when combined with the energy already accumulated by the destination device for those symbols results in the requisite level of performance.

The minimum transmission power level for the retransmitted symbols can be computed as follows. First the communication system determines the E Irequired for the requisite level of performance. The required E Iis approximately equal to an E Iset point maintained by the power control loop. The power control loop adjusts the transmission power to maintain the quality of the received signal at the E Iset point. Second the destination device can measure the signal to noise plus interference ratio

In the present invention symbol repetition is performed only if the data rate of the packet is less than full rate. If the data rate for the new packet is at full rate there are no repeated symbols which can be used for retransmission of the packet received in error. Therefore the present invention can be implemented in conjunction with another retransmission protocol at a higher layer. One such scheme is the radio link protocol RLP which is defined by the IS 657 standard. The RLP layer can delay the transmission of the new data packet to allow retransmission of the packet received in error.

In the second embodiment the packet received in error is retransmitted on an additional code channel which is available for transmission to the destination device. One major advantage of this embodiment is that the retransmission of the packet received in error is independent of the transmission of the new packet. Therefore the number of repetitions the power level and the code rate do not need to be changed to accommodate the retransmission. Furthermore the second embodiment allows the source device to retransmit even if the new packet is a full rate frame i.e. when no code symbols are repeated in the frame . An additional advantage of the second embodiment is the ease of placing the additional code channel on a quadrature channel from the regular traffic channel to reduce the peak to average amplitude variation which can degrade the system performance. The pilot channel the regular traffic channel the power control channel and the additional code channel can be organized to balance the I and the Q channels in the QPSK or OQPSK modulation.

The various modes of data retransmission described above can be used for retransmission of an entire packet or a partial packet. For some communication systems it may be possible to monitor the quality of transmission link over the duration of a packet. In the exemplary embodiment the link quality can be monitored by measuring E Iin the manner described in the aforementioned U.S. Pat. No. 5 903 554. In this case it may be more economical to retransmit only the portion of the packet corresponding to the time period when the transmission link quality is poor e.g. below a predetermined threshold . An indication of the time duration wherein the link quality is poor can be transmitted to the source which then retransmits only that portion of the packet corresponding to the noted time duration. The retransmission of the packets received in error as described above is applicable for data retransmission on the forward link and reverse link.

From the above discussion symbol accumulation as used in this specification refers to the accumulation of the energy of a transmission of a data packet with the energy of one or more retransmissions of an entire or partial packet. Symbol accumulation also refers to the accumulation of identical code symbols through addition and or replacement of code symbols and using the same code rate and the accumulation of different code symbols through interleaving and using lower code rates .

If error correcting coding is used for data transmission full retransmission of the packet received in error is not required to correctly decode the packet. In the present invention the destination device decodes the received packet and performs the CRC check to determine whether the packet was received in error. If the packet was received in error the symbols which comprised the packet received in error are stored for subsequent decoding. In the exemplary embodiment the storage can be implemented using a storage element or one of any number of memory devices that are known in the art such as RAM memory devices latches or other types of memory devices.

The source device retransmits the packet received in error in one of the methods described above. The destination device receives the retransmitted packet accumulates energy of the retransmitted packet with the energy already accumulated for the packet received in error and decodes the accumulated packet. The additional energy of the retransmitted packet increases the likelihood that the accumulated packet can be decoded correctly. The probability of error of the accumulated packet is typically substantially less than the original received packet since a large amount of energy may have been accumulated from the original transmission and the retransmissions.

In the exemplary embodiment the energy accumulation is performed on a symbol by symbol basis. For each symbol the combined scalar value from combiner of the retransmitted symbol is coherently combined with the scalar value which has been accumulated for this data symbol. The accumulation can be accomplished with an arithmetic logic unit ALU a microprocessor a digital signal processor DSP or other devices programmed or designed to perform the functions disclosed herein. Again coherently combining takes into account the sign of the scalar value. Coherent combination performs the maximal ratio combining of the signals received from the transmission and retransmissions. In this regard the retransmissions can be viewed as the outputs from additional fingers or correlators of a rake receiver. The retransmissions also provide time diversity for the data transmission.

In the exemplary embodiment the accumulated scalar value may be manipulated before subsequent demodulation and decoding. The accumulated scalar value of each symbol is a soft decision value which is typically represented as an m bit signed integer. The soft decision values are eventually provided to Viterbi decoder for decoding. The performance of Viterbi decoder is influenced by the number of bits and the range of the soft decision values. Specifically for each code branch the branch metric calculations compares the soft decision values for that code branch to an expected value to obtain a branch metric. The branch metric are then used to defined the maximal likelihood path which results in the decoded bits.

As energy is accumulated for each symbol from the retransmissions the soft decision values have tendency to increase in value. Therefore it may be necessary to rescale the soft decision values with a gain factor Abefore Viterbi decoding. Because the soft decision values are derived from an accumulation of energy from multiple transmission and retransmissions it is preferable to maintain A 1.0. As the soft decision value increases the confidence in the correctness of that symbol increases. Resealing the soft decision value to a smaller value to fit within a range can introduce quantization error and other errors. However other system factors e.g. E Iof the received signal may dictate that the soft decision values be resealed for an improved performance. In the exemplary embodiment the scaling can be performed with an arithmetic logic unit ALU a microprocessor a digital signal processor DSP or other devices programmed or designed to perform the function disclosed herein.

Since the branch metric calculation circuit within Viterbi decoder is typically designed with a predetermined number of bits it is probably necessary to clip the soft decision values. To maintain accuracy the accumulated scalar values can be stored as unclipped values and the clipping can be done prior to the Viterbi decoding step.

In a system architecture wherein the pilot signal is not transmitted concurrently with the data transmission the combination of the data symbols from the transmission and retransmissions is accomplished by another embodiment. An example of such architecture is the reverse link implementation which conforms to the IS 95A standard. It is preferable to accumulated the scalar values according to the signal to noise ratio S N of the received signals. At the destination device the energy S of the desired signal e.g. the retransmitted packet can be computed after the despreading with the long PN code and the short PN codes. The total energy of the received signal can be computed and represented as square root over S N . Since the received signal is predominantly comprised of the interference e.g. N S N is approximately equal to square root over S N . Thus the destination device accumulates the scalar values from the transmission and retransmissions according to the equation 

In the present invention the total energy square root over S N of the received signal can be computed on a frame by frame basis or on a symbol by symbol basis. Symbol by symbol basis allows the destination device to adjust the gain of each symbol to take into account fast changes in the channel condition.

In the present invention the accumulation of the energy from additional retransmissions allows the destination device to correctly decode the packets received in error. The retransmission allows the communication system to operate at a higher frame error rate FER than nominal because of the ability to correctly decode the packets with a minimal expenditure of system resource thereby improving the reliability of the data transmission and possibly increasing the capacity of the system. Furthermore the retransmission at a subsequent time provides time diversity and improves the reliability of the data transmission. However operating at a higher FER necessitates the retransmissions of more packets and can increase the complexity of the communication system.

The previous description of the preferred embodiments is provided to enable any person skilled in the art to make or use the present invention. The various modifications to these embodiments will be readily apparent to those skilled in the art and the generic principles defined herein may be applied to other embodiments without the use of the inventive faculty. Thus the present invention is not intended to be limited to the embodiments shown herein but is to be accorded the widest scope consistent with the principles and novel features disclosed herein.

