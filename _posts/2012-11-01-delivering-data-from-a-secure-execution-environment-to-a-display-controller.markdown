---

title: Delivering data from a secure execution environment to a display controller
abstract: Methods and systems may include a computing system having a display, a display controller with a decryption module, and a security element with security logic. The security logic can be configured to establish a secure path between the secure element and the display in response to a secure output mode request, wherein the secure path includes the display controller. In addition, the security logic may be configured to prevent the decryption module from being bypassed, and transmit encrypted data from the secure element to the display via the secure path.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09037869&OS=09037869&RS=09037869
owner: Intel Corporation
number: 09037869
owner_city: Santa Clara
owner_country: US
publication_date: 20121101
---
Embodiments generally relate to the deployment of trusted services. More particularly embodiments relate to displaying secure output data associated with trusted services.

Services for mobile applications such as m commerce mobile commerce may be relevant to the future growth of a wide variety of system on chip SoC platforms. While traditional applications can execute on the main applications processor in an un trusted environment provided by the host operating system OS trusted services may execute within a trusted environment i.e. outside the trust boundary of the host OS on the applications processor provided by a secure element. Information that is displayed to the user in accordance with the trusted services however may still traverse the un trusted host OS stack. Accordingly such display information may be vulnerable to snooping as well as modification by malware executing on the host.

Embodiments may involve a computer implemented method in which a secure path is established between a secure element and a display in response to a secure output mode request wherein the secure path includes a display controller. The method can also provide for preventing a decryption module of the display controller from being bypassed and transmitting encrypted data from the secure element to the display via the secure path.

Embodiments may also include a system having a display a display controller with a decryption module and a secure element. The secure element can include security logic to establish a secure path between the secure element and the display in response to a secure output mode request wherein the secure path is to include the display controller. In addition the security logic may prevent the decryption module from being bypassed and transmit encrypted data from the secure element to the display via the secure path.

Other embodiments can include a non transitory computer readable storage medium having a set of instructions which if executed by a processor cause a computer to establish a secure path between a secure element and a display in response to a secure output mode request. In one example the secure path is configured to include a display controller. In addition the instructions may cause a computer to prevent a decryption module of the display controller from being bypassed and transmit encrypted data from the secure element to the display via the secure path.

Turning now to a platform is shown. The platform could be part of a laptop mobile Internet device MID personal digital assistant PDA media player imaging device etc. any smart device such as a smart phone smart television TV smart tablet and so forth or any combination thereof. Accordingly the platform may include a system on chip SoC subsystem having a HW FW hardware firmware domain with a north complex component coupled to a south complex component via an interconnect bridge . In one example the north complex component is coupled to a display such as a touch screen LCD liquid crystal display LED light emitting diode device CRT cathode ray tube monitor etc.

The illustrated south complex component includes a secure element that generates secure output data SeOD in conjunction with the operation of a trusted service executing on the secure element . For example the secure output data might be associated with a banking application that displays transaction information on the display for a user of the platform to verify and certify the authenticity of an m commerce transaction. By contrast a core of the illustrated north complex component executes a host application in an unsecure host operating system OS domain wherein the host application can generate non secure output data for the display .

In the illustrated example a secure output path is established between the secure element and the display for the secure output data whereas the non secure output data is transmitted to the display via a default output path . As will be discussed in greater detail the secure output path may include a display controller that decrypts the secure output data which can be encrypted by the secure element prior to transmission. Moreover the secure element can prevent the decryption functionality of the display controller from being bypassed so that malware cannot render the trusted service untrustworthy.

A secure path may be established between a secure element and a display at block in response to the secure output mode request. In one example the secure path includes a display controller having a decryption module wherein illustrated block prevents the decryption module of the display controller from being bypassed by data destined for the display. Encrypted data may be transmitted from the secure element to the display via the secure path at block .

In response to the request from the trusted service the secure output manager may activate a session key and set a secure output hardware flag at block . As will be discussed in greater detail the session key can be used to encrypt the secure output data and the hardware flag may be used to prevent a decryption module of a display controller from being bypassed by data destined for the display. In one example the secure output manager writes the session key directly to the display controller and directly sets the hardware flag in the display controller. Alternatively the secure output manager could use an intermediate component such as a system controller unit SCU to activate the session key and set the hardware flag. Upon receiving secure output data from a data source such as for example NVM non volatile memory a user application etc. the secure output manager can encrypt it using the session key and copy the encrypted secure output data to system memory e.g. dynamic RAM DRAM static RAM SRAM Scratch Pad Memory at block .

Illustrated block determines whether the encrypted secure output data is ready e.g. the copy to system memory is complete . If not the user application continues to wait at block . If the encrypted secure output data is ready the user application may instruct the display controller to output the encrypted secure output data to the display at block . In response to the instruction from the user application the display controller may decrypt the encrypted secure output data on the fly at block using the session key and output the decrypted data to the display. Thus the encryption process protects the secure output data from unauthorized access in the example shown. Moreover all data sent to the display is decrypted using a secret session key so that untrusted data e.g. data from malware will appear distorted on the display device wherein the distortion can serve as an indicator to the user that the data is not authentic. If it is determined at block that further secure output is not required the host application requests that the trusted service exit the secure output mode at illustrated block .

Turning now to a system is shown in which a secure element applies secure output data to an encryption module which uses a session key Key X to transform the secure output data into encrypted secure output data . The encrypted secure output data may be stored via an interconnect bridge and memory bus to a DRAM wherein upon receiving one or more software application commands a display controller retrieves the encrypted secure output data from the DRAM . The encrypted secure output data can be applied to a decryption module which may use the session key to transform the encrypted secure output data back into the secure output data . The illustrated secure output data is then output to a display .

The illustrated hardware flag is invisible to host applications and may be used to instruct decision logic such as a control multiplexer to ignore a host application input that would otherwise enable host applications to use decryption bypass logic to bypass the decryption module . Instead the control multiplexer is instructed to force data destined for a display to pass through the decryption module . Accordingly secure output data will be decrypted with a session key and placed in a buffer for output to the display regardless of the actual source of the data in the example shown.

The relevant functionality of the illustrated SCU may alternatively be incorporated into another component of the system such as for example the display controller . For example the secure output manager could write the session key directly into the register and set the hardware flag directly. Indeed the SCU and the DRAM have been omitted from the secure path discussed above for simplicity and ease of discussion.

The interrupt may cause a doorbell handler to call an interrupt service routine wherein the illustrated interrupt service routine uses the flag set command in the buffer to conduct a set of an internal secure output mode flag as well as a set of a hardware flag in the display controller . As already noted the hardware flag may be invisible to host applications in order to ensure that malware is unable to bypass the decryption module not shown of the display controller . The interrupt service routine may also use the key program command in the buffer to conduct a write of the session key to a key register in the display controller . Secure output data may then be obtained from an MMIO memory mapped input output buffer for display via the secure path through the display controller .

Accordingly the illustrated solutions may not require software to display a separate logo or image in order for a user to distinguish between trusted and untrusted content because the sensitive content itself may appear distorted garbled if it does not originate from a trusted source. In addition specialized display hardware having a dedicated processing unit for decryption and verification can be avoided by using a secure element to control decision logic in the display controller.

Techniques described herein therefore enable SoC platforms to enforce dynamic access control of decryption logic which can ensure that while in secure output mode no applications in the host OS or the host OS kernel can bypass the decryption logic and send unauthorized data to a platform display. In addition techniques can leverage existing SoC platform components to establish a secure path between a secure element and a display controller. Moreover these techniques may be agnostic to both the host OS stack as well as the user.

Embodiments of the present invention are applicable for use with all types of semiconductor integrated circuit IC chips. Examples of these IC chips include but are not limited to processors controllers chipset components programmable logic arrays PLAs memory chips network chips systems on chip SoCs SSD NAND controller ASICs and the like. In addition in some of the drawings signal conductor lines are represented with lines. Some may be thicker to indicate more constituent signal paths have a number label to indicate a number of constituent signal paths and or have arrows at one or more ends to indicate primary information flow direction. This however should not be construed in a limiting manner. Rather such added detail may be used in connection with one or more exemplary embodiments to facilitate easier understanding of a circuit. Any represented signal lines whether or not having additional information may actually comprise one or more signals that may travel in multiple directions and may be implemented with any suitable type of signal scheme e.g. digital or analog lines implemented with differential pairs optical fiber lines and or single ended lines.

Example sizes models values ranges may have been given although embodiments of the present invention are not limited to the same. As manufacturing techniques e.g. photolithography mature over time it is expected that devices of smaller size could be manufactured. In addition well known power ground connections to IC chips and other components may or may not be shown within the figures for simplicity of illustration and discussion and so as not to obscure certain aspects of the embodiments of the invention. Further arrangements may be shown in block diagram form in order to avoid obscuring embodiments of the invention and also in view of the fact that specifics with respect to implementation of such block diagram arrangements are highly dependent upon the platform within which the embodiment is to be implemented i.e. such specifics should be well within purview of one skilled in the art. Where specific details e.g. circuits are set forth in order to describe example embodiments of the invention it should be apparent to one skilled in the art that embodiments of the invention can be practiced without or with variation of these specific details. The description is thus to be regarded as illustrative instead of limiting.

The term coupled may be used herein to refer to any type of relationship direct or indirect between the components in question and may apply to electrical mechanical fluid optical electromagnetic electromechanical or other connections. In addition the terms first second etc. are used herein only to facilitate discussion and carry no particular temporal or chronological significance unless otherwise indicated.

Those skilled in the art will appreciate from the foregoing description that the broad techniques of the embodiments of the present invention can be implemented in a variety of forms. Therefore while the embodiments of this invention have been described in connection with particular examples thereof the true scope of the embodiments of the invention should not be so limited since other modifications will become apparent to the skilled practitioner upon a study of the drawings specification and following claims.

