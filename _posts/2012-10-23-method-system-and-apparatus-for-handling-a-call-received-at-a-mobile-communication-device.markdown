---

title: Method, system and apparatus for handling a call received at a mobile communication device
abstract: A method, apparatus and system for handling a call received at a mobile communication device, in association with an automated number identification (ANI) number are provided. The ANI number is compared with a list of ANI numbers associated with an applications server, the list stored at the mobile communications device. When the ANI number is not in the list, a tone is provided on the call. When a corresponding tone is detected on the call in response to the tone, the call is handled as a call associated with the applications server and otherwise the call handled as a typical mobile communication call.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08583096&OS=08583096&RS=08583096
owner: Blackberry Limited
number: 08583096
owner_city: Waterloo, ON
owner_country: CA
publication_date: 20121023
---
The specification relates generally to mobile communication devices and specifically to a method system and apparatus for handling a call received at a mobile communication device.

At a mobile communication device Automatic Number Identification ANI can be used to determine whether an incoming call is from an applications server providing certain services to the mobile communication device in conjunction with an application client. However ANI numbers of some incoming calls in certain networks e.g. roaming networks cannot be reliably delivered to the mobile communication device. Hence the mobile communication device and application client will not know if the call is from the application server which precludes the services offered as technology for handling calls with mangled ANI numbers is currently deficient.

A first aspect of the specification provides a method for handling a call received at a mobile communication device in association with an automated number identification ANI number the method implementable at the mobile communication device the method comprising comparing the ANI number with a list of ANI numbers associated with an applications server the list stored at the mobile communications device when the ANI number is not in the list providing a tone on the call and when a corresponding tone is detected on the call in response to the tone handling the call as a call associated with the applications server and otherwise handling the call as a mobile communication call from a communication device.

The providing the tone can be initiated only when the mobile communication device is in a verification mode. The mobile communication device can enter the verification mode when the mobile communication device is roaming outside of a home communication network and the mobile communication device can exits the verification mode when the mobile communication device is next in direct communication with the home communication network. The mobile communication device can enter the verification mode upon receiving a message from the applications server the message for triggering the mobile communication device to enter the verification mode. The mobile communication device can exit the verification mode upon receiving a message from the applications server the message for triggering the mobile communication device to exit the verification mode. The mobile communication device can enter the verification mode upon receiving input data from an input device the input data indicative that the mobile communication device is to be placed in the verification mode. The mobile communication device can exit the verification mode upon receiving input data from an input device the input data indicative that the mobile communication device is to exit the verification mode.

The applications server can be enabled to determine that the tone has been provided and cause the corresponding tone to be provided. The applications server can determine that the tone has been provided by receiving a message from a PBX where the tone is detected and cause the corresponding tone to be provided by transmitting a message to the PBX to trigger the PBX to provide the corresponding tone.

Handling the call as a call associated with the applications server can comprise enabling an applications client at the mobile electronic device to provide services available via the applications server.

Each of the tone and the corresponding tone can comprises a DTMF Dual tone multi frequency tone. The tone and the corresponding tone can be similar. The tone and the corresponding tone can be different.

A second aspect of the specification provides a mobile communication device for handling a call received in association with an automated number identification ANI number the mobile communication device comprising a processing unit interconnected with a memory device and a communication interface. The processing unit is enabled to compare the ANI number with a list of ANI numbers associated with an applications server the list stored at the memory device when the ANI number is not in the list provide a tone on the call via the communications interface and when a corresponding tone is detected on the call in response to the tone handle the call as a call associated with the applications server and otherwise handle the call as a mobile communication call from a communication device.

The processing unit can be further enabled to initiate providing the tone only when the mobile communication device is in a verification mode.

The processing unit can be further enabled to cause the mobile communication device to enter the verification mode when the processing unit determines that the mobile communication device is roaming outside of a home communication network. The processing unit can be further enabled to cause the mobile communication device to exit the verification mode when the processing unit determines that the mobile communication device is next in communication with the home communication network. The processing unit can be further enabled to cause the mobile communication device to enter the verification mode upon receiving a message from the applications server via the communication interface the message for triggering the mobile communication device to enter the verification mode. The processing unit can be further enabled to cause the mobile communication device to exit the verification mode upon receiving a message from the applications server the message for triggering the mobile communication device to exit the verification mode. The processing unit can be further enabled to cause the mobile communication device to enter the verification mode upon receiving input data from an input device the input data indicative that the mobile communication device is to be placed in the verification mode. The processing unit can be further enabled to cause the mobile communication device to exit the verification mode upon receiving input data from an input device the input data indicative that the mobile communication device is to exit the verification mode.

The processing unit can be further enabled to handle the call as a call associated with the applications server by enabling an applications client at the mobile electronic device to provide services available via the applications server.

Each of the tone and the corresponding tone can comprises a DTMF tone. The tone and the corresponding tone can be similar. The tone and the corresponding tone can be different.

A third aspect of the specification provides a method for verifying a call to a mobile communication device the call associated with an ANI number which is in turn associated with an applications server the method implementable at the applications server. The method comprises determining that a tone has been provided by the mobile communications device on the call the tone for indicating that the mobile communications device is seeking verification that the call is associated with the applications server and in response causing a corresponding tone to be provided on the call to trigger the mobile communications device to handle the call as a call associated with the applications server.

Determining that a tone has been provided can comprise receiving a message from a PBX where the tone is detected. Causing the corresponding tone to be provided can comprise transmitting a message to the PBX to trigger the PBX to provide the corresponding tone.

A fourth aspect of the specification provides an application server for verifying a call to a mobile communication device the call associated with an ANI number which is in turn associated with the applications server. The applications server comprises a processing unit interconnected with a communications interface. The processing unit is enabled to determine that a tone has been provided by the mobile communications device on the call the tone for indicating that the mobile communications device is seeking verification that the call is associated with the applications server and in response cause a corresponding tone to be provided on the call to trigger the mobile communications handle the call as a call associated with the applications server.

The processing unit can be further enabled to determine that a tone has been provided by receiving a message from a PBX where the tone is detected. The processing unit can be further enabled to cause the corresponding tone to be provided by transmitting a message to the PBX to trigger the PBX to provide the corresponding tone.

A fifth aspect of the specification provides a system for handling a call associated with an ANI number. The system comprises an applications server and at least one communications device in communication with the applications server. The applications server is enabled to provide services to mobile communications devices the ANI number associated with the applications server determine that a tone has been provided by at least one of the mobile communications device on the call the tone for indicating that the at least one of the mobile communications devices is seeking verification that the call is associated with the applications server and in response cause a corresponding tone to be provided on the call to trigger the at least one of the mobile communications device to handle the call as a call associated with the applications server. The at least one mobile communication device is enabled to compare the ANI number with a list of ANI numbers associated with the applications server the list stored at the at least one mobile communications device when the ANI number is not in the list provide the tone on the call and when the corresponding tone is detected on the call in response to the tone handle the call as a call associated with the applications server and otherwise handle the call as a mobile communication call from a communication device.

A sixth aspect of the specification provides a computer program product comprising a computer usable medium having a computer readable program code adapted to be executed to implement a method for handling a call received at a mobile communication device in association with an ANI number the method implementable at the mobile communication device the method comprising comparing the ANI number with a list of ANI numbers associated with an applications server the list stored at the mobile communications device when the ANI number is not in the list providing a tone on the call and when a corresponding tone is detected on the call in response to the tone handling the call as a call associated with the applications server and otherwise handling the call as a mobile communication call from a communication device.

A seventh aspect of the specification provides a computer program product comprising a computer usable medium having a computer readable program code adapted to be executed to implement a method for verifying a call to a mobile communication device the call associated with an ANI number which is in turn associated with an applications server the method implementable at the applications server the method comprising determining that a tone has been provided by the mobile communications device on the call the tone for indicating that the mobile communications device is seeking verification that the call is associated with the applications server and in response causing a corresponding tone to be provided on the call to trigger the mobile communications device to handle the call as a call associated with the applications server.

Server detects that PBX is receiving call and initiates a data communication session with device via an invitation message which can sent on a data channel in link . Server then initiates a call from PBX to device on a separate communication channel via PBX and links . In some non limiting implementations call can be between server and device via PBX however in other non limiting implementations as depicted server can control PBX to initiate call by transmitting a command to PBX . Hence both device and device are alerted of call e.g. both device and device ring simultaneously allowing either device or device to pick up call . If device picks up call first then server causes PBX to connect call with call via a connection

It is further appreciated that call is associated with an ANI number referred to hereafter as ANI which is transmitted to device on link in signalling for setting up call . In general ANI identifies call as being from server which in turn causes device to handle call as a call associated with server . As depicted in which depicts device in further detail according to non limiting implementations device stores a list of ANIs ANI 1 ANI 2 ANI 3 . . . ANI N associated with applications server . For example system can be configured such that any associated with server will be associated with one of the ANIs in list and list can be stored at device in a provisioning process e.g. when an application client is installed and or provisioned and if further ANIs are assigned to server list can be updated in an updating and or synchronization process.

If ANI is in list then device interprets call as a associated with server for example it is further appreciated that server comprises an application which can make PBX like services available to device when call is picked up at device and call is connected. It yet further appreciated that such services can be requested via a client application client stored and processed at device with further reference to

However in some networks in link e.g. networks outside of a home network of device ANI can be mangled and or changed and hence call is not recognized at device as a call associated with server . Rather call is recognized as a typical mobile communication call similar to a call between devices via link . Hence the services available via application and client application client are not made available. In some cases call could be rejected by device if ANI is not in list if device is expecting to receive a call associated with server .

With reference to which is substantially similar to with like elements having like numbers device can determine whether call is being received from server or a communication device by providing a tone on call . In it appreciated that transmission of tone can occur only when ANI is not in list . In some implementations as described below transmission of tone will occur when device is in a verification mode and transmission of tone will not occur when device is not in the verification mode. In any event server is enabled to determine when tone has occurred on call and in response cause a corresponding tone to be provided on call . Once device detects corresponding tone device handles call as being from server and the PBX like services are made available via application and client application client . Otherwise when corresponding tone is not detected device handles call as if it were a typical mobile communication call. As will be described below in some implementations PBX detects tone and informs server that tone has occurred via link in response server transmits a command to PBX to cause PBX to provide corresponding tone . However in some implementations server can detect tone and provide corresponding tone via a voice channel between device and server on links 

Each link generally comprises any suitable combination of wired or wireless links. Hence links can comprise a wireless network such as a wireless carrier network including but not limited to any suitable cell phone network 1X UMTS Universal Mobile Telecommunications System CDMA code division multiple access GSM Global System for Mobile communications EVDO Evolution Data Optimized HSPA High Speed Packet Access 3GPP 3Generation Partnership Project 3G 3Generation EDGE Enhanced Data rates for GSM Evolution or the like in combination with any suitable combination of wired or wireless networks as desired including but not limited to a packet based network the Internet an analog network the PSTN public switched telephone network a Wi Fi network a Wi Max network and the like. However in some implementations one or more of links can comprise any suitable combination of wired or wireless networks including but not limited to a packet based network the Internet an analog network the PSTN a Wi Fi network a Wi Max network and the like. Furthermore each of links can be similar or different as desired in particular link is enabled to carry a data channel between device and server and links is enabled to carry a voice channel between device and PBX and link is enabled to convey commands and data between PBX and server . In some non limiting implementations link and can convey voice data between device and server

Server generally comprises a processing unit interconnected with a communication interface and a memory device for example via a computing bus not depicted . In some implementations server can further comprise or alternatively be connected to a display device and an input device . Server can include but is not limited to any suitable combination of a computer a mainframe computer a server and the like. Other suitable types of servers and computing devices are within the scope of present implementations.

Processing unit can comprise any suitable processor or combination of processors including but not limited to a microprocessor CPU central processing unit or the like.

Communications interface is enabled to communicate with device on a data channel via link and on a voice channel via PBX links . Accordingly communications interface is enabled to communicate according to any suitable protocol which is compatible with links including but not limited to packet based protocols Internet protocols analog protocols cell phone protocols 1X UMTS CDMA GMS 3G EDGE and the like PSTN protocols Wi Fi protocols Wi Max protocols or a combination of these. Other suitable protocols are within the scope of present implementations.

Memory device can be any suitable one of or combination of volatile memory non volatile memory RAM ROM hard drive optical drive or the like.

Application in combination with application client at device enables server to provide some or all PBX services available at device at device for example when engaged in calls e.g. call forwarding calling an extension at PBX by exchanging commands via link and transmitting commands to PBX on link . Application can be stored in memory device and processed by processing unit for example while server is turned on.

As depicted in according to non limiting implementations each device comprises a processing unit interconnected with a communication interface a memory device a display device and an input device all in communication for example via a computing bus not depicted and powered by a battery . Each of processing unit communication interface and memory device can be respectively similar to processing unit communication interface and memory device described above. In particular memory device is enabled to store list and interface is enabled to communicate with server via link . Further processing unit is enabled to detect corresponding tone on call for example in some units processing unit can comprise a digital signal processor DSP for processing data received on call . In some implementations DSP can be a separate element controlled by processing unit .

Application client in combination with application at server enables device to provide some or all PBX services available at device at device for example when engaged in calls e.g. call forwarding calling an extension at PBX by exchanging data on data channel via link . Application can be stored in memory device and processed by processing unit for example when device is turned on.

Display device comprises circuitry for generating representations of data such as data for example a representation . Display device can include any suitable one of or combination of CRT cathode ray tube and or flat panel displays e.g. LCD liquid crystal display plasma OLED organic light emitting diode capacitive or resistive touchscreens and the like . Circuitry can include any suitable combination of circuitry for controlling the CRT and or flat panel displays etc. including but not limited to display buffers transistors electron beam controllers LCD cells plasmas cells phosphors etc. In particular display device and circuitry can be controlled by processing unit to generate representation .

Input device is generally enabled to receive input data and can comprise any suitable combination of input devices including but not limited to a keyboard a keypad a pointing device a mouse a track wheel a trackball a touchpad a touch screen and the like. Other suitable input devices are within the scope of present implementations.

Further device can comprise any suitable mobile electronic device and or mobile communication device including but not limited to a laptop or notebook computer a PDA smartphones a cellular or mobile phone a portable electronic device or the like. However other suitable types of electronic devices are within the scope of present implementations.

Returning to system while device is generally a wired communication device enabled to received PBX based calls from PBX device can be wired or wireless as desired and can be similar to or different from device or device .

Attention is now directed to which depicts a method for handling a call received at a mobile communication device in association with an ANI number. In order to assist in the explanation of method it will be assumed that method is performed using system . Furthermore the following discussion of method will lead to a further understanding of system and its various components. However it is to be understood that system and or method can be varied and need not work exactly as discussed herein in conjunction with each other and that such variations are within the scope of present implementations.

It is further appreciated that method presumes that call and ANI has been received at device and that method occurs at device .

At step ANI is compared with list of ANIs at processing unit . Specifically as list comprises all ANIs associated with server processing unit can determine whether call is from server by determining if ANI is an element of list as depicted in .

At step when ANI is not in list device provides tone on call at step otherwise when ANI is in list device handles call as a associated with server at step described below. Tone can comprise a DTMF tone multi frequency tone or any other suitable tone in general it is understood that tone is provided over the communication channel in link on call . Hence tone is detectable at PBX which in turn can notify server of tone via a message . However in implementations where call is between server and device via PBX tone can be detected at server rather than PBX . Furthermore it is appreciated that tone can comprise a predetermined tone a series of tones or any other suitable tone. When tone comprises a predetermined tone tone can comprise any suitable tone. In some non limiting implementations tone can be chosen based on human factors to be the least intrusive for example if call is not from server tone might be heard at a calling communications device and hence tone is chosen to be a tone that is on the edge of sounds that are typically audible to humans for example the highest pitch DTMF tone available or the lowest pitch DTMF tone available.

At step device determines if corresponding tone is detected on call for example within a given time period e.g. several seconds . In some embodiments the downlink audio from PBX to device can be muted on speaker at device while device is waiting for corresponding tone so that if corresponding tone is provided on call it won t be heard by a user of device though corresponding tone can still be detected at device . When corresponding tone is detected device handles call as a call associated with server at step otherwise call is handled call as a typical mobile communication call at step . For example at step handling call as a associated with server can comprise enabling applications client at device to provide services available via server as described above for example commands messages etc. can be transmitted on a data channel over link to cause server to trigger PBX to provide a corresponding PBX service.

It is appreciated that server is enabled to cause corresponding tone to be provided on call when tone is detected. For example when server receives message server can transmit a command to PBX causing PBX to provide corresponding tone . In some implementations corresponding tone can be similar to tone or different from tone .

In any event corresponding tone can be provided by at least one on storing an indicator of corresponding tone at server or PBX in a provisioning process hence corresponding tone is predetermined by recording tone and providing the recording of tone as corresponding tone by detecting tone and providing a similar tone as corresponding tone recognizing any detected tone of a given type e.g. DTMF as tone or any other suitable method.

Device can be enabled to detect corresponding tone by at least one of storing an indicator e.g. a recording an audio file and indicator of a DTMF tone etc. of corresponding tone at device in a provisioning process hence corresponding tone is predetermined recognizing any detected tone of a given type e.g. DTMF as corresponding tone or any other suitable method.

It is appreciated that in some implementations method is implemented when certain conditions are met. For example when device is operating in a home communication network the chances of ANI being mangled are unlikely in these situations providing tone whenever ANI is not in list can be inconvenient and a waste of resources at device server or a calling communications device.

Hence in some implementations method is implemented when device is in a verification mode and is not implemented when device is not in the verification mode. In general server can be enabled to cause corresponding tone to be provided whenever tone is detected indeed as server can be providing services for a plurality of devices similar to device detection of tone provides an indication to server that a particular device in this case device in a verification mode. Hence server does not need to explicitly be informed that device is in the verification mode to cause tone to be provided in response to tone . Detection of tone tells server that device is in a verification mode and wants verification of call . There are several contemplated non limiting implementations for entering and exiting the verifications mode at device which are described hereafter.

In some implementations device automatically enters the verification modes when device is roaming outside of a home communication network. For example when device leave a home communication network and registers with a roaming network device can automatically enter a verification mode wherein method is implemented when a call is received. Device can exit the verification mode when device is no longer roaming for example device can register with the home network and thereafter exit verification mode.

In some implementations server can enter the corresponding verification mode by way of a graphic user interface GUI as depicted in according to non limiting implementations for example via a system administrator interacting with GUI . Alternatively and automatic interaction between GUI and a computing device associated with a system administrator can occur e.g. via automatically scheduled events at the system administrator s computing device GUI can be provided at least one of display device as depicted in substantially similar to with like elements having like numbers and a display device of a system administrator. An identifier of device is provided e.g. a device PIN product identification number or any other suitable identifier which will generally be tied to a database of identifiers enabling server to communicate specifically with device and further store attributes etc. of device . When checkbox of GUI is checked server transmits a message to device via the data channel on link with reference to message triggering device to enter the verification mode upon receiving message from server the verification mode referred to in GUI as Get You Home mode .

Similarly when checkbox is unchecked and or when checkbox is checked server transmits a message to device via the data channel on link to trigger device to exit the verification mode. Device exits verification mode upon receiving message from server .

GUI can be provided when requested via input device or any other suitable input device. For example a system administrator can be informed of the dates that device is roaming and the respective verification modes can be turned on and off via GUI as required. In some implementations a range of dates that device is roaming can also be provided and the transmission of messages can occur automatically on those dates at any suitable time. Furthermore any suitable exchange of data can occur between device and server to verify that messages are received and that device has correspondingly entered and exited the verification mode.

In some implementations device can enter the verification mode by way of a graphic user interface GUI as depicted in according to non limiting implementations. GUI can be provided at display device of device . When checkbox of GUI is checked device enters the verification mode referred to in GUI as Get You Home mode e.g. device enters verification mode upon receiving input data from input device the input data indicative that device is to be placed in verification mode processing unit detects that checkbox is checked and causes device to enter the verification mode. In some implementations device can optionally transmits a message to server via the data channel on link as depicted in similar to with like elements having like numbers to notify server that device has entered the verification mode. Message indicates that device is in the verification mode.

Similarly when checkbox is unchecked and or when checkbox is checked device exits the verification mode and transmits a message to server via the data channel on link to notify server that that device has exited the verification mode.

GUI can be provided when requested via input device . For example GUI can be provided upon request for example when requested by a user to cause device to enter the verification mode. Furthermore any suitable exchange of data can occur between device and server to verify that messages are received.

In particular non limiting implementations method can be provided within a mobile voice service MVS with application and application client respectively comprising server application and a client application of the MVS. Within MVS message comprises an invite message also known as a bInvite . Within these implementations an incoming call to device can be referred to as an MT mobile terminated call and an outgoing call from device can be referred to as an MO mobile originated call. Furthermore it is appreciated that device is associated with a cellular number e.g. cellular telephone number that can be used to call device e.g. as when device calls device using link .

For example depicts non limiting implementations of an MVS system similar to system with like elements having like numbers however with an a appended thereto. For example device is similar to device . However further depicts infrastructure at device server and in the various links. For example device comprises a cell radio a Wi Fi Radio a BT Bluethooth radio a display a keyboard other peripherals other apps and an SMA session manager application application programming interface API which includes provisioning control and media modules. Communication links between device and server include a Wi Fi access point the Internet at least one Relay at least one router and a business sever which stores data in a database . Furthermore communication between device and PBX can be carried via a wireless network and the PSTN or alternatively between the Wi Fi access point the Internet a Firewall and an intranet. Server includes various MVS services such as a Service A FMC a Fixed mobile convergence module and a Service B with PBX like services provided using one or both of Service A and Service B. Server further includes SMPs symmetric multi processors or control and provisioning and communicates with PBX via SIP Session Initiation Protocol lines and or a SIP trunk. PBX can include any suitable telephony infrastructure including but not limited to suitable gateways GW and media.

Scenario 1 MT call device has received a bINVITE and then a call associated with MVS server with false ANI.

Device rings and when device answers the call device sends confirmation tone to server server responds with tone and the audio is enabled in both directions.

Device rings and when the device answers the call sends confirmation tone . However as server is not on the call the audio is muted for a timeout period and then enabled the call being changed to be a regular cellular call. Device will initially provide an indication of an incoming call from the wrong party and the wrong line. When the call switches over the correct calling party number name and line is provided.

Scenario 3 MT call device has not received a bINVITE but receives a call associated with MVS server with false ANI.

Device rings and when the device answers the call sends confirmation tone to server server responds with tone and the audio is enabled in both directions. When the call comes in it is shown initially as a cellular call.

Scenario 4 MT call device has not received a bINVITE but receives a call directly to the cellular number.

This is initially the same as Scenario 3 so the same solution can be used. Device rings showing the call as a cellular call. Device rings and when the device answers the call sends confirmation tone . As server is not on the call the audio is muted for a timeout period and then enabled the call being changed to be a regular cellular call.

Scenario 5 Call to the cellular number directly this is the same as Scenario 4 as far as device can tell .

This is initially the same as Scenario 3 so the same solution can be used. Device rings showing the call as a cellular call. Device rings and when the device answers the call sends confirmation tone . As server is not on the call the audio is muted for a timeout period and then enabled the call being changed to be a regular cellular call.

Scenario 6 MO Call device has received a provisional response from MVS server and then a call associated with MVS server with false ANI.

Device answers the call sends confirmation tone to server and receives back from server a response tone . Server continues to set up the call to the destination party.

Scenario 7 MO call device has received a provisional response from MVS server and then a call directly to the cellular number.

Device answers the call sends a confirmation tone to server . The calling device can detect tone but as it doesn t respond device drops the call. The call is reported back as a failure to device by a suitable component of the network.

Scenario 8 MO call device has not received a provisional response from MVS server but receives a call associated with MVS server with false ANI.

Device answers the call sends a confirmation tone to server and receives back from server a response tone . Server continues to set up the call to the destination device.

Scenario 9 MO call device has not received a provisional response from MVS server but receives a call directly to the cellular number.

This is initially the same as Scenario 8. Device answers the call sends a confirmation tone to server . The calling device can detect tone but as it doesn t respond device drops the call. The call is reported back as a failure to device .

Specific non limiting implementations of an MVS system will hereafter be described with reference to . It is appreciated that method can be implemented in the MVS system of .

Reference is now made to which shows in block diagram form an example system generally designated for the control and management of communications within which method can be implemented. It is generally understood that system comprises an MVS system. The system includes an enterprise or business system which in many embodiments includes a local area network LAN . In the description below the enterprise or business system may be referred to as an enterprise network . It will be appreciated that the enterprise network may include more than one network and may be located in multiple geographic areas in some embodiments.

The enterprise network may be connected often through a firewall to a wide area network WAN such as the Internet. The enterprise network may also be connected to a PSTN via direct inward dialing DID trunks or primary rate interface PRI trunks.

The enterprise network may also communicate with a public land mobile network PLMN which may also be referred to as a wireless wide area network WWAN or in some cases a cellular network. The connection with the PLMN may be made via a relay as known in the art.

The enterprise network may also provide a wireless local area network WLAN featuring wireless access points. Other WLANs may exist outside the enterprise network . For example WLAN may be connected to WAN .

The system may include a number of enterprise associated mobile devices only one shown . The mobile devices may include devices equipped for cellular communication through the PLMN mobile devices equipped for Wi Fi communications over one of the WLANs or dual mode devices capable of both cellular and WLAN communications. WLANs may be configured in accordance with one of the IEEE 802.11 specifications.

It will be understood that the mobile device include one or more radio transceivers and associated processing hardware and software to enable wireless communications with the PLMN and or one of the WLANs . In various embodiments the PLMN and mobile devices may be configured to operate in compliance with any one or more of a number of wireless protocols including GSM GPRS CDMA EDGE UMTS EvDO HSPA 3GPP or a variety of others. It will be appreciated that the mobile device may roam within the PLMN and across PLMNs in known manner as the user moves. In some instances the dual mode mobile devices and or the enterprise network are configured to facilitate roaming between the PLMN and a WLAN and are thus capable of seamlessly transferring sessions such as voice calls from a connection with the cellular interface of the dual mode device to the WLAN interface of the dual mode device and vice versa.

The enterprise network typically includes a number of networked servers computers and other devices. For example the enterprise network may connect one or more desktop or laptop computers one shown . The connection may be wired or wireless in some embodiments. The enterprise network may also connect to one or more digital telephone sets one shown .

The enterprise network may include one or more mail servers such as mail server for coordinating the transmission storage and receipt of electronic messages for client devices operating within the enterprise network . Typical mail servers include the Microsoft Exchange Server and the IBM Lotus Domino server. Each user within the enterprise typically has at least one user account within the enterprise network . Associated with each user account is message address information such as an e mail address. Messages addressed to a user message address are stored on the enterprise network in the mail server . The messages may be retrieved by the user using a messaging application such as an e mail client application. The messaging application may be operating on a user s computer connected to the enterprise network within the enterprise. In some embodiments the user may be permitted to access stored messages using a remote computer for example at another location via the WAN using a VPN connection. Using the messaging application the user may also compose and send messages addressed to others within or outside the enterprise network . The messaging application causes the mail server to send a composed message to the addressee often via the WAN .

The relay serves to route messages received over the PLMN from the mobile device to the corresponding enterprise network . The relay also pushes messages from the enterprise network to the mobile device via the PLMN .

The enterprise network also includes an enterprise server . Together with the relay the enterprise server functions to redirect or relay incoming e mail messages addressed to a user s e mail address within the enterprise network to the user s mobile device and to relay incoming e mail messages composed and sent via the mobile device out to the intended recipients within the WAN or elsewhere. The enterprise server and relay together facilitate push e mail service for the mobile device enabling the user to send and receive e mail messages using the mobile device as though the user were connected to an e mail client within the enterprise network using the user s enterprise related e mail address for example on computer .

As is typical in many enterprises the enterprise network includes a PBX although in various embodiments the PBX may be a standard PBX or an IP PBX for simplicity the description below uses the term PBX to refer to both having a connection with the PSTN for routing incoming and outgoing voice calls for the enterprise. The PBX is connected to the PSTN via DID trunks or PRI trunks for example. The PBX may use ISDN signalling protocols for setting up and tearing down circuit switched connections through the PSTN and related signalling and communications. In some embodiments the PBX may be connected to one or more conventional analog telephones . The PBX is also connected to the enterprise network and through it to telephone terminal devices such as digital telephone sets softphones operating on computers etc. Within the enterprise each individual may have an associated extension number sometimes referred to as a PNP private numbering plan or direct dial phone number. Calls outgoing from the PBX to the PSTN or incoming from the PSTN to the PBX are typically circuit switched calls. Within the enterprise e.g. between the PBX and terminal devices voice calls are often packet switched calls for example Voice over IP VoIP calls.

The enterprise network may further include a Service Management Platform SMP for performing some aspects of messaging or session control like call control and advanced call processing features. The SMP may in some cases also perform some media handling. Collectively the SMP and PBX may be referred to as the enterprise communications platform generally designated . It will be appreciated that the enterprise communications platform and in particular the SMP is implemented on one or more servers having suitable communications interfaces for connecting to and communicating with the PBX and or DID PRI trunks. Although the SMP may be implemented on a stand alone server it will be appreciated that it may be implemented into an existing control agent server as a logical software component. As will be described below the SMP may be implemented as a multi layer platform.

The enterprise communications platform implements the switching to connect session legs and may provide the conversion between for example a circuit switched call and a VoIP call or to connect legs of other media sessions. In some embodiments in the context of voice calls the enterprise communications platform provides a number of additional functions including automated attendant interactive voice response call forwarding voice mail etc. It may also implement certain usage restrictions on enterprise users such as blocking international calls or 1 900 calls. In many embodiments Session Initiation Protocol SIP may be used to set up manage and terminate media sessions for voice calls. Other protocols may also be employed by the enterprise communications platform for example Web Services Computer Telephony Integration CTI protocol Session Initiation Protocol for Instant Messaging and Presence Leveraging Extensions SIMPLE and various custom Application Programming Interfaces APIs as will be described in greater detail below.

One of the functions of the enterprise communications platform is to extend the features of enterprise telephony to the mobile devices . For example the enterprise communications platform may allow the mobile device to perform functions akin to those normally available on a standard office telephone such as the digital telephone set or analog telephone set . Example features may include direct extension dialing enterprise voice mail conferencing all transfer call park etc.

Reference is now made to which show example embodiments of the enterprise communications system . Again although references are made below to calls or call centric features it will be appreciated that the architectures and systems depicted and described are applicable to session based communications in general and in some instances to messaging based communications.

In this embodiment the SMP assumes control over both call processing and the media itself. This architecture may be referred to as First Party Call Control . Many of the media handling functions normally implemented by the PBX are handled by the SMP in this architecture. Incoming calls addressed to any extension or direct dial number within the enterprise for example are always first routed to the SMP . Thereafter a call leg is established from the SMP to the called party within the enterprise and the two legs are bridged. Accordingly the SMP includes a digital trunk interface and a digital signal processing DSP conferencing bridge . The DSP conferencing bridge performs the bridging of calls for implementation of various call features such as conferencing call transfer etc. The digital trunk interface may be implemented as a plurality of telephonic cards e.g. Intel Dialogic cards interconnected by a bus and operating under the control of a processor. The digital trunk interface may also be partly implemented using a processor module such as for example a Host Media Processing HMP processor.

The SMP may include various scripts for managing call processing. The scripts are implemented as software modules routines functions etc. stored in non volatile memory and executed by the processor of the SMP . The scripts may implement call flow logic business logic user preferences call service processes and various feature applications.

The call control server is coupled to the PBX for example through the LAN enabling packet based communications and more specifically IP based communications. In one embodiment communications between the PBX and the call control server are carried out in accordance with SIP. In other words the call control server uses SIP based communications to manage the set up tear down and control of media handled by the PBX . In one example embodiment the call control server may employ a communications protocol conforming to the ECMA 269 or ECMA 323 standards for Computer Supported Telecommunications Applications CSTA .

The SIP server interacts with the media server using SIP based media handling commands. For example the SIP server and media server may communicate using Media Server Markup Language MSML as defined in IETF document Saleem A. Media Server Markup Language Internet Draft draft saleem msml 07 Aug. 7 2008. The media server may be configured to perform Host Media Processing HMP .

Other architectures or configurations for the enterprise communications system will be appreciated by those ordinarily skilled in the art.

Reference is now made to which shows another embodiment of the enterprise communications system with a Third Party Call Control architecture. In this embodiment the SMP is a multi layer platform that includes a protocol layer a services layer and an application layer . The protocol layer includes a plurality of interface protocols configured for enabling operation of corresponding applications in the application layer . The services layer includes a plurality of services that can be leveraged by the interface protocols to create richer applications. Finally the application layer includes a plurality of applications that are exposed out to the communication devices and that leverage corresponding ones of the services and interface protocols for enabling the applications.

Specifically the protocol layer preferably includes protocols which allow media to be controlled separate from data. For example the protocol layer can include among other things a Session Initiation Protocol or SIP a Web Services protocol an Application Programming Interface or API a Computer Telephony Integration protocol or CTI and a Session Initiation Protocol for Instant Messaging and Presence Leveraging Extensions or SIMPLE protocol . It is contemplated that the interface protocols are plug ins that can interface directly with corresponding servers in the enterprise network which will be further described below.

For the purposes of this disclosure SIP will be utilized although it is appreciated that the system can operate using the above disclosed or additional protocols. As known by those of ordinary skill in the art SIP is the IETF Internet Engineering Task Force standard for multimedia session management and more specifically is an application layer control protocol for establishing maintaining modifying and terminating multimedia sessions between two or more endpoints. As further known by those of ordinary skill in the art the SIP protocol includes two interfaces for signalling SIP Trunk hereinafter referred to as SIP T and SIP Line hereinafter referred to as SIP L . Specifically the SIP T interface is utilized when the endpoint is a non specific entity or not registered i.e. when communicating between two network entities . In contrast the SIP L interface is utilized when the endpoint is registered i.e. when dialing to a specific extension . The specific operation of the system utilizing SIP will be described in further detail below.

The SMP also includes a plurality of enablers among other things a VoIP enabler a Fixed Mobile Convergence or FMC enabler a conference services enabler a presence enabler and an Instant Messaging or IM enabler . Each of the enablers are used by corresponding services in the services layer that combine one or more of the enablers. Each of the applications in the application layer is then combined with one or more of the services to perform the desired application. For example a phone call service may use the VoIP or PBX enabler and an emergency response application may use the phone call service an Instant Messenger service a video call service and email service and or a conference service.

The application layer may include a conference services application that together with the conference services enabler enables multiple communication devices including desk telephones and personal computers to participate in a conference call through use of a centralized conference server . As seen in the conference server is provided in the enterprise network and is in communication with the conference services enabler preferably through the SIP protocol although it is recognized that additional protocols that control media separate from data may be appropriate such as the Web Services protocol or the CTI protocol . As will be described in further detail below the conference call server is configured for directing media and data streams to and from one or more communication devices i.e. mobile devices telephones and computers .

Turning now to the general operation of the system using SIP as the signalling protocol will be discussed although it is recognized that the present system is not limited to the processes discussed herein. The signalling descriptions that follow are based on Third Party Call Control architecture such as that illustrated in or . It will be appreciated that similar but slightly modified signalling may be used in a First Party Call Control architecture wherein the PBX will pass media through to the SMP for direct media handling by the SMP . Variations in the signalling to adapt to various architectures will be appreciated by those ordinarily skilled in the art.

The SMP then sets up the outgoing call leg to the destination. It does this by sending an invite over SIP L to the PBX with the destination number of the target phone block . SIP L is used so that the call can be correctly attributed to the individual within the organization within any call records that are being maintained by the PBX . When the invite is received the PBX dials the destination number to the target phone block and the target phone answers the call block . When the target phone is answered the PBX sends a 200 OK signal to the SMP indicating that the target phone is ready to receive data block . The SMP then sends an invite over SIP T to the PBX and shuffles the SDP Session Description Protocol as known to those of ordinary skill in the art to connect the call legs block . When the call legs are connected the PBX sends a second 200 OK signal to the SMP block and the users of the device and target phone can communicate with each other.

Note that between the cellular call leg being established and the outgoing call leg being answered the mobile user hears ringing tones. These ringing tones may be provided by the PBX using the presentation of early media from the outgoing call leg or they may be generated locally on the device if early media is not available. In the latter case it will be necessary to localize the ringing tone to match the tone normally heard with a call through the PBX .

The above description is known as a mobile initiated call because the SMP provides the mobile device with the DNIS number into which the mobile device has called. Alternatively the mobile originated call could be PBX initiated as shown in . Specifically in a PBX initiated call upon receipt of the mobile originated call request block the SMP confirms receipt of the call to the mobile device with an ANI number block which the mobile device uses to identify the incoming call from the PBX . The PBX then sends an invite over SIP T to the PBX with the cellular number of the device and the ANI number that is attached to the outgoing call block . Upon receipt of the invite the PBX makes a cellular call to the device block which is answered by the device block . The device checks the ANI number in the incoming call to confirm if the number is actually from the PBX . If the ANI number is stripped for any particular reason then the device may be configured to answer the call as a regular cellular call or it may reject the call as unknown. When the device answers the PBX initiated call the PBX sends a 200 OK signal to the SMP indicating that the call leg to the device is established block .

In response the SMP sends an invite over SIP L with the destination number of the target phone to the PBX block . When the invite is received at the PBX the PBX dials the destination number to the target phone block the target phone picks up the call block and a 200 OK signal is sent from the PBX to the SMP block indicating that the target phone is also ready to receive data. In response to the 200 OK the SMP sends an invite to the PBX shuffling the SDP to connect the call legs block . Finally when the call legs are connected the PBX sends a second 200 OK signal to the SMP and the users of the device and target phone are able to communicate with each other.

In both instances the SMP is performing third party call control of the two call legs the PBX remaining in control of the call. The decision of whether to proceed with a mobile initiated call or a PBX initiated call can be set by policy. Specifically the option to select either mobile initiated or PBX initiated calls is a feature provided in the SMP and an administrator for the enterprise network can determine which setting to use. For example in some cases it may be more cost effective for the corporation to utilize PBX initiated calls rather than mobile initiated calls and vice versa. However it is appreciated that the system is not limited to the above processes.

In response to the invite the SMP sends a call request with the DNIS number and source details to the device block which is confirmed to the SMP block . In addition to confirming the call the mobile device sends a cellular call to the DNIS number at the PBX block . Again as the DNIS number is routed in the dialing plans to the SMP upon receipt of the cellular call the PBX sends an invite over SIP T to the SMP with the DNIS number block . In response to the invite a 200 OK signal is sent over SIP T from the SMP to the PBX acknowledging that the call leg to the mobile device is established block . Finally the initial invite block is acknowledged with the 200 OK signal with the cellular SDP at which point the call legs are joined and the target phone and device can communicate with each other on the call.

The diagram shown in illustrates a mobile initiated call because as discussed above with respect to the SMP presents the mobile device with the DNIS number at the PBX into which to call. However it is also possible to employ a PBX initiated mobile terminated call as shown in where the PBX sends an incoming call to the device with the ANI number of the target phone .

Specifically similar to the mobile initiated call described above and shown in the target phone sends an incoming call to the destination number of the device which is received at the PBX block . Upon receipt of the call the PBX sends an invite over SIP L to the SMP block with the source number of the target phone . In response to the invite the SMP sends a call request with the source number to the device block with the ANI number the device should expect in the incoming call the call request being confirmed by the device block . At this point in the PBX initiated call the SMP sends an invite over SIP T to the PBX with the cellular number and ANI number to use block prompting the PBX to make a cellular call to the device with the ANI number block prompting the device to ring. The device answers the call block and a 200 OK signal is sent from the PBX to the SMP acknowledging that the cellular call leg to the device is established block . In response a 200 OK signal is also sent from the SMP to the PBX acknowledging that the call leg to the target phone is also established block . The SMP shuffles the SDP to connect the call legs the call legs are joined and the target phone and device can communicate with each other on the call.

As discussed above with respect to the SMP remains in control of the signalling between the target phone and the mobile device in both the mobile initiated and PBX initiated calls. Again the decision to proceed with a mobile initiated call or a PBX initiated call is based on policy and may be set by a system administrator. In some cases it may be more efficient or cost effective for the administrator to decide that PBX initiated calls should be used and in other cases it may be more efficient or cost effective for mobile initiated calls to be utilized. As these policy decisions may vary by organization and are not imperative to the scope of the present application they will not be discussed in further detail.

In any event method can be implemented in the system of by adapting device to provide a tone when a mangled ANI is received and device corresponding to device of system is in a verification mode as described above with service management platform corresponding to server of system adapted to enter and exit a verification mode in which a corresponding tone can be provided via PBX corresponding to PBX of system .

Those skilled in the art will appreciate that in some implementations the functionality of device and server can be implemented using pre programmed hardware or firmware elements e.g. application specific integrated circuits ASICs electrically erasable programmable read only memories EEPROMs etc. or other related components. In other implementations the functionality of device and server can be achieved using a computing apparatus that has access to a code memory not shown which stores computer readable program code for operation of the computing apparatus. The computer readable program code could be stored on a computer readable storage medium which is fixed tangible and readable directly by these components e.g. removable diskette CD ROM ROM fixed disk USB drive . Alternatively the computer readable program code could be stored remotely but transmittable to these components via a modem or other interface device connected to a network including without limitation the Internet over a transmission medium. The transmission medium can be either a non wireless medium e.g. optical and or digital and or analog communications lines or a wireless medium e.g. microwave infrared free space optical or other transmission schemes or a combination thereof.

A portion of the disclosure of this patent document contains material which is subject to copyright protection. The copyright owner has no objection to the facsimile reproduction by any one the patent document or patent disclosure as it appears in the Patent and Trademark Office patent file or records but otherwise reserves all copyrights whatsoever.

Persons skilled in the art will appreciate that there are yet more alternative implementations and modifications possible for implementing the implementations and that the above implementations and examples are only illustrations of one or more implementations. The scope therefore is only to be limited by the claims appended hereto.

