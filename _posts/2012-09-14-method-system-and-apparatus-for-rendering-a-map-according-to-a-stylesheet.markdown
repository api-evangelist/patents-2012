---

title: Method, system and apparatus for rendering a map according to a stylesheet
abstract: Methods, systems and apparatus are described to render a map according to a style sheet. Several embodiments of map rendering are described that may be suitable for rendering individual portions of a map, known as map tiles, which may include one or more features. Embodiments may obtain one or more a map tiles with features that may have one or more style identifiers. Embodiments may identify a style from a stylesheet for each feature in the map tile according to style identifiers in the feature and the style in the stylesheet. Some embodiments may render the one or more map tiles according to the identified styles and may display the rendered map tiles. In some embodiments, a map service generates one or more map tiles with features including style identifiers and sends the one or more map tiles to a client rendering device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09041736&OS=09041736&RS=09041736
owner: Apple Inc.
number: 09041736
owner_city: Cupertino
owner_country: US
publication_date: 20120914
---
This application claims benefit of priority to U.S. Provisional Application Ser. No. 61 655 900 entitled Method System And Apparatus For Rendering A Map According To A Stylesheet filed Jun. 5 2012.

Map display capability can be found in a number of electronic devices. These devices may be traditional map display devices such as desktop computers or laptops or newer mobile map display devices such as tablet computers mobile phones and navigation systems. Generally map display devices are capable of communicating with various mapping or navigation services usually implemented through various networks and or satellite systems to display map image data on a map display device. In order to provide interactive map display capabilities map image data may be stored on a map display device or received from the various mapping or navigation services in communication with the map display device. For example a navigation device may communicate with a network of navigation satellites to determine its current location and display the map image data stored on the navigation device reflecting its current location. Some map display devices may also receive map image data along with other map or location information such as directions from one location to another. With the recent growth of mobile computing map display devices are continuing to develop new methods for increasing the efficiency map image data communications for displaying map image data on mobile as well as traditional map display devices.

Various embodiments of methods apparatus and computer readable storage media for rendering a map according to a stylesheet are described. Embodiments may obtain one or more map tiles from a server. Obtained map tiles may include one or more map features which may include one or more style identifiers. Embodiments may render the one or more map tiles by identifying a style from a stylesheet stored on the rendering device for the features which include one or more style identifiers. Identifying a style for a feature in some embodiments may involve ranking one or more styles in a stylesheet according to common style identifiers of the style and the feature and then selecting the highest ranked style to provide the rendering instructions for that feature. Some embodiments then render the one or more map tiles according to the rendering instructions supplied by the stylesheet for the features. In at least some embodiments the rendered map tiles are displayed on a display device.

Some embodiments may have one or more stylesheets which may be selected by input from other modules or applications other systems or a user. A particular stylesheet may be linked to a particular display mode of a rendering device.

In some embodiments a map service generates a map tile. The map tile may include one or more map features. These features may also include style identifiers. A map service may send one or more map tiles to a rendering device who may render the map tiles according to a stylesheet. In some embodiments the map service may obtain a request for a map tile.

While the invention is described herein by way of example for several embodiments and illustrative drawings those skilled in the art will recognize that the invention is not limited to the embodiments or drawings described. It should be understood that the drawings and detailed description thereto are not intended to limit the invention to the particular form disclosed but on the contrary the intention is to cover all modifications equivalents and alternatives falling within the spirit and scope of the present invention. The headings used herein are for organizational purposes only and are not meant to be used to limit the scope of the description. As used throughout this application the word may is used in a permissive sense i.e. meaning having the potential to rather than the mandatory sense i.e. meaning must . Similarly the words include including and includes mean including but not limited to.

In the following detailed description numerous specific details are set forth to provide a thorough understanding of claimed subject matter. However it will be understood by those skilled in the art that claimed subject matter may be practiced without these specific details. In other instances methods apparatus or systems that would be known by one of ordinary skill have not been described in detail so as not to obscure claimed subject matter.

It will also be understood that although the terms first second etc. may be used herein to describe various elements these elements should not be limited by these terms. These terms are only used to distinguish one element from another. For example a first contact could be termed a second contact and similarly a second contact could be termed a first contact without departing from the scope of the present invention. The first contact and the second contact are both contacts but they are not the same contact.

The terminology used in the description of the invention herein is for the purpose of describing particular embodiments only and is not intended to be limiting of the invention. As used in the description of the invention and the appended claims the singular forms a an and the are intended to include the plural forms as well unless the context clearly indicates otherwise. It will also be understood that the term and or as used herein refers to and encompasses any and all possible combinations of one or more of the associated listed items. It will be further understood that the terms includes including comprises and or comprising when used in this specification specify the presence of stated features integers steps operations elements and or components but do not preclude the presence or addition of one or more other features integers steps operations elements components and or groups thereof.

As used herein the term if may be construed to mean when or upon or in response to determining or in response to detecting depending on the context. Similarly the phrase if it is determined or if a stated condition or event is detected may be construed to mean upon determining or in response to determining or upon detecting the stated condition or event or in response to detecting the stated condition or event depending on the context.

Some portions of the detailed description which follow are presented in terms of algorithms or symbolic representation of operations on binary digital signals stored within a memory of a specific apparatus or special purpose computing device or platform. In the context of this particular specification the term specific apparatus or the like includes a general purpose computer once it is programmed to perform particular functions pursuant to instructions from program software and other programmable electronic devices. Algorithmic descriptions or symbolic representations are examples of techniques used by those of ordinary skill in the signal processing or related arts to convey the substance of their work to others skilled in the art. An algorithm is here and is generally considered to be a self consistent sequence of operations or similar signal processing leading to a desired result. In this context operations or processing involve physical manipulation of physical quantities. Typically although not necessarily such quantities may take the form of electrical or magnetic signals capable of being stored transferred combined compared or otherwise manipulated. It has proven convenient at times principally for reasons of common usage to refer to such signals as bits data values elements symbols characters terms numbers numerals or the like. It should be understood however that all of these or similar terms are to be associated with appropriate physical quantities and are merely convenient labels.

Various embodiments of methods apparatus and computer readable storage media for rendering a map according to a stylesheet are described. Several embodiments of map rendering are described that may be suitable for rendering one or more map tiles. Embodiments may obtain one or more map tiles which may include one or more features which in turn may include one or style identifiers. Embodiments may render the obtained one or map tiles according to previously obtained stylesheet. In some embodiments a stylesheet may contain one or more styles which may include one or more style identifiers. To render a map tile according to a stylesheet embodiments may identify a style for a feature that includes one or more style identifiers ranking the styles the stylesheet according to the number of style identifiers in common with the style identifiers of the feature.

Embodiments may obtain map tiles composed of varying forms of graphics data. In some embodiments map tiles are composed of raster graphics data. In some embodiments map tiles are composed of vector graphics data. Embodiments may also obtain map tiles composed of a combination of vector and graphics data.

Some embodiments may obtain one or more stylesheets from users other modules or applications or other systems. These rendering instructions of the styles of stylesheets styles may be modified. In some embodiments stylesheets may be linked to a particular display mode of a mapping application. If input is obtained selecting a particular display mode then the stylesheet linked to the display mode may be used to render obtained map tiles.

In at least some embodiments of rendering a map according to a stylesheet a map service generates a map tile. A map tile may be generated to include features. These features may also include style identifiers. The map service then sends the map tile to a client device. Embodiments may operate within a map service operating environment as described below with regard to . In some embodiments the map service may obtain a request for a map tile as shown in . also shows one of many possible embodiments of a map service operating environment for a map service to send map tiles and receive requests. Various embodiments may also generate the map tile by a compression technique as discussed below such as discussed below with respect to.

In some embodiments a user may interact with the client device either directly or through other modules on the device such as discussed below with regard to . discussed below also describes that users may be able to alter the mode or map display according to stylesheets stored on a device implementing various embodiments. In some embodiments a user may be able to store additional or edit stylesheets on the client device. Embodiments may also allow other computer systems or modules on the client device to store additional stylesheets or edit stylesheets on the client device.

Embodiments of rendering a map according to a stylesheet may be implemented in any mapping application that may render map image data. Example categories of applications in which embodiments may be implemented in are map displays such as in navigation devices electronic games which may include in game map views and graphical design which may allow users to create two dimensional and three dimensional maps. More generally embodiments may be implemented in applications that allow maps of two dimensional and three dimensional views to be displayed. Specific examples of applications or technologies in which embodiments may be implemented include but are not limited to mapping or navigation software applications on an iPod Touch iPhone or iPad devices from Apple Inc. of Cupertino Calif.

Embodiments of rendering a map according to a stylesheet may be implemented and performed by a module or modules implemented by program instructions stored in a non transitory computer readable storage medium and executable by one or more processors such as one or more CPUs or GPUs. An example module that may implement some embodiments and an example application that may implement the module as described herein is illustrated in . An example electronic device on which embodiments may be implemented is illustrated in . An example system on which embodiments may be implemented is illustrated in .

Various embodiments may operate within a map service operating environment. illustrates a map service operating environment according to some embodiments. A map service may provide map services for one or more client devices in communication with the map service through various communication methods and protocols. A map service generally may provide map information and other map related data such as two dimensional map image data e.g. aerial view of roads utilizing satellite imagery three dimensional map image data e.g. traversable map with three dimensional features such as buildings route and direction calculation e.g. ferry route calculations or directions between two points for a pedestrian real time navigation data e.g. turn by turn visual navigation data in two or three dimensions location data e.g. where is the client device currently located and other geographic data e.g. wireless network coverage weather traffic information or nearby points of interest . In various embodiments the map service data may include localized labels for different countries or regions localized labels may be utilized to present map labels e.g. street names city names points of interest in different languages on client devices. Client devices may utilize these map services by obtaining map service data. Client devices may implement various techniques to process map service data. Client devices may then provide map services to various entities including but not limited to users internal software or hardware modules and or other systems or devices external to the client devices 

In some embodiments a map service may be implemented by one or more nodes in a distributed computing system. Each node may be assigned one or more services or components of a map service. Some nodes may be assigned the same map service or component of a map service. A load balancing node may distribute access or requests to other nodes within a map service. In some embodiments a map service may be implemented as a single system such as a single server. Different modules or hardware devices within a server may implement one or more of the various services provided by a map service.

A map service may provide map services by generating map service data in various formats. In some embodiments one format of map service data may be map image data. Map image data may provide image data to a client device so that the client device may process the image data e.g. rendering and or displaying the image data as a two dimensional or three dimensional map . Map image data whether in two or three dimensions may specify one or more map tiles. A map tile may be a portion of a larger map image. Assembling together the map tiles of a map may produce the original map. Tiles may be generated from map image data routing or navigation data or any other map service data. In some embodiments map tiles may be raster based map tiles with tile sizes ranging from any size both larger and smaller than a commonly used 256 pixel by 256 pixel tile. Raster based map tiles may be encoded in any number of standard digital image representations including but not limited to Bitmap .bmp Graphics Interchange Format .gif Joint Photographic Experts Group .jpg .jpeg etc. Portable Networks Graphic .png or Tagged Image File Format .tiff . In some embodiments map tiles may be vector based map tiles encoded using vector graphics including but not limited to Scalable Vector Graphics .svg or a Drawing File .drw . Embodiments may also include tiles with a combination of vector and raster data. Metadata or other information pertaining to the map tile may also be included within or along with a map tile providing further map service data to a client device. In various embodiments a map tile may be encoded for transport utilizing various standards and or protocols some of which are described in examples below.

In various embodiments map tiles may be constructed from image data of different resolutions depending on zoom level. For instance for low zoom level e.g. world or globe view the resolution of map or image data need not be as high relative to the resolution at a high zoom level e.g. city or street level . For example when in a globe view there may be no need to render street level artifacts as such objects would be so small as to be negligible in many cases.

A map service may perform various techniques to analyze a map tile before encoding the tile for transport. This analysis may optimize map service performance for both client devices and a map service. In some embodiments map tiles may be analyzed for complexity according to vector based graphic techniques and constructed utilizing complex and non complex layers. Map tiles may also be analyzed for common image data or patterns that may be rendered as image textures and constructed by relying on image masks. In some embodiments raster based image data in a map tile may contain certain mask values which are associate with one or more textures. Embodiments may also analyze map tiles for specified features that may be associated with certain map styles that contain style identifiers.

Other map services may generate map service data relying upon various data formats separate from a map tile. For example map services that provide location data may utilize data formats conforming to location service protocols such as but not limited to Radio Resource Location services Protocol RRLP TIA for Code Division Multiple Access CDMA Radio Resource Control RRC position protocol or LTE Positioning Protocol LPP . Embodiments may also receive or request data from client devices identifying device capabilities or attributes e.g. hardware specifications or operating system version or communication capabilities e.g. device communication bandwidth as determined by wireless signal strength or wire or wireless network type .

A map service may obtain map service data from internal or external sources. For example satellite imagery used in map image data may be obtained from external services or internal systems storage devices or nodes. Other examples may include but are not limited to GPS assistance servers wireless network coverage databases business or personal directories weather data government information e.g. construction updates or road name changes or traffic reports. Some embodiments of a map service may update map service data e.g. wireless network coverage for analyzing future requests from client devices.

Various embodiments of a map service may respond to client device requests for map services. These requests may be a request for a specific map or portion of a map. Embodiments may format requests for a map as requests for certain map tiles. In some embodiments requests may also supply the map service with starting locations or current locations and destination locations for a route calculation. A client device may also request map service rendering information such as map textures or stylesheets. In at least some embodiments requests may also be one of a series of requests implementing turn by turn navigation. Requests for other geographic data may include but are not limited to current location wireless network coverage weather traffic information or nearby points of interest.

A map service may in some embodiments may analyze client device requests to optimize a device or map service operation. For example a map service may recognize that the location of a client device is in an area of poor communications e.g. weak wireless signal and send more map service data to supply a client device in the event of loss in communication or send instructions to utilize different client hardware e.g. orientation sensors or software e.g. utilize wireless location services or Wi Fi positioning instead of GPS based services . In another example a map service may analyze a client device request for vector based map image data and determine that raster based map data better optimizes the map image data according to the image s complexity. Embodiments of other map services may perform similar analysis on client device requests and as such the above examples are not intended to be limiting.

Various embodiments of client devices e.g. client devices may be implemented on different device types. Examples of a portable multifunction device include the devices illustrated in such as multifunction device and multifunction device . Client devices may utilize map service through various communication methods and protocols described below. In some embodiments client devices may obtain map service data from map service . Client devices may request or receive map service data. Client devices may then process map service data e.g. render and or display the data and may send the data to another software or hardware module on the device or to an external device or system.

A client device may according to some embodiments implement techniques to render and or display maps. These maps may be requested or received in various formats such as map tiles described above. A client device may render a map in two dimensional or three dimensional views. Some embodiments of a client device may display a rendered map and allow a user system or device providing input to manipulate a virtual camera in the map changing the map display according to the virtual camera s position orientation and field of view. Various forms and input devices may be implemented to manipulate a virtual camera. In some embodiments touch input through certain single or combination gestures e.g. touch and hold or a swipe may manipulate the virtual camera. Other embodiments may allow manipulation of the device s physical location to manipulate a virtual camera. For example a client device may be tilted up from its current position to manipulate the virtual camera to rotate up. In another example a client device may be tilted forward from its current position to move the virtual camera forward. Other input devices to the client device may be implemented including but not limited to auditory input e.g. spoken words a physical keyboard mouse and or a joystick.

Embodiments may provide various visual feedback to virtual camera manipulations such as displaying an animation of possible virtual camera manipulations when transitioning from two dimensional map views to three dimensional map views. Embodiments may also allow input to select a map feature or object e.g. a building and highlight the object producing a blur effect that maintains the virtual camera s perception of three dimensional space.

In some embodiments a client device may implement a navigation system e.g. turn by turn navigation . A navigation system provides directions or route information which may be displayed to a user. Embodiments of a client device may request directions or a route calculation from a map service. A client device may receive map image data and route data from a map service. In some embodiments a client device may implement a turn by turn navigation system which provides real time route and direction information based upon location information and route information received from a map service and or other location system such as Global Positioning Satellite GPS . A client device may display map image data that reflects the current location of the client device and update the map image data in real time. A navigation system may provide auditory or visual directions to follow a certain route.

A virtual camera may be implemented to manipulate navigation map data according to some embodiments. Some embodiments of client devices may allow the device to adjust the virtual camera display orientation to bias toward the route destination. Embodiments may also allow virtual camera to navigation turns simulating the inertial motion of the virtual camera.

Client devices may implement various techniques to utilize map service data from map service. Embodiments may implement some techniques to optimize rendering of two dimensional and three dimensional map image data. In some embodiments a client device may locally store rendering information. For example a client may store a stylesheet which provides rendering directions for image data containing style identifiers. In another example common image textures may be stored to decrease the amount of map image data transferred from a map service. Client devices may also implement various modeling techniques to render two dimensional and three dimensional map image data examples of which include but are not limited to generating three dimensional buildings out of two dimensional building footprint data modeling two dimensional and three dimensional map objects to determine the client device communication environment generating models to determine whether map labels are seen from a certain virtual camera position and generating models to smooth transitions between map image data. Some embodiments of client devices may also order or prioritize map service data in certain techniques. For example a client device may detect the motion or velocity of a virtual camera which if exceeding certain threshold values lower detail image data will be loaded and rendered of certain areas. Other examples include rendering vector based curves as a series of points preloading map image data for areas of poor communication with a map service adapting textures based on display zoom level or rendering map image data according to complexity.

In some embodiments client devices may communicate utilizing various data formats separate from a map tile. For example some client devices may implement Assisted Global Positioning Satellites A GPS and communicate with location services that utilize data formats conforming to location service protocols such as but not limited to Radio Resource Location services Protocol RRLP TIA for Code Division Multiple Access CDMA Radio Resource Control RRC position protocol or LTE Positioning Protocol LPP . Client devices may also receive GPS signals directly. Embodiments may also send data with or without solicitation from a map service identifying the client device s capabilities or attributes e.g. hardware specifications or operating system version or communication capabilities e.g. device communication bandwidth as determined by wireless signal strength or wire or wireless network type .

In some embodiments both voice and data communications can be established over wireless network and access device . For example device can place and receive phone calls e.g. using voice over Internet Protocol VoIP protocols send and receive e mail messages e.g. using Simple Mail Transfer Protocol SMTP or Post Office Protocol 3 POP3 and retrieve electronic documents and or streams such as web pages photographs and videos over wireless network gateway and WAN e.g. using Transmission Control Protocol Internet Protocol TCP IP or User Datagram Protocol UDP . Likewise in some implementations devices and can place and receive phone calls send and receive e mail messages and retrieve electronic documents over access device and WAN . In various embodiments any of the illustrated client device may communicate with map service and or other service s using a persistent connection established in accordance with one or more security protocols such as the Secure Sockets Layer SSL protocol or the Transport Layer Security TLS protocol.

Devices and can also establish communications by other means. For example wireless device can communicate with other wireless devices e.g. other devices or cell phones over the wireless network . Likewise devices and can establish peer to peer communications e.g. a personal area network by use of one or more communication subsystems such as Bluetooth communication from Bluetooth Special Interest Group Inc. of Kirkland Wash. can also establish peer to peer communications with devices or . not pictured . Other communication protocols and topologies can also be implemented. Devices and may also receive Global Positioning Satellite GPS signals from GPS .

Devices and can communicate with map service over the one or more wire and or wireless networks or . For example map service can provide a map service data to rendering devices and . Map service may also communicate with other services to obtain data to implement map services. Map service and other services may also receive GPS signals from GPS .

In various embodiments map service and or other service s may be configured to process search requests from any of client devices. Search requests may include but are not limited to queries for business address residential locations points of interest or some combination thereof. Map service and or other service s may be configured to return results related to a variety of parameters including but not limited to a location entered into an address bar or other text entry field including abbreviations and or other shorthand notation a current map view e.g. user may be viewing one location on the multifunction device while residing in another location current location of the user e.g. in cases where the current map view did not include search results and the current route if any . In various embodiments these parameters may affect the composition of the search results and or the ordering of the search results based on different priority weightings. In various embodiments the search results that are returned may be a subset of results selected based on specific criteria include but not limited to a quantity of times the search result e.g. a particular point of interest has been requested a measure of quality associated with the search result e.g. highest user or editorial review rating and or the volume of reviews for the search results e.g. the number of times the search result has been review or rated .

In various embodiments map service and or other service s may be configured to provide auto complete search results that may be displayed on the client device such as within the mapping application. For instance auto complete search results may populate a portion of the screen as the user enters one or more search keywords on the multifunction device. In some cases this feature may save the user time as the desired search result may be displayed before the user enters the full search query. In various embodiments the auto complete search results may be search results found by the client on the client device e.g. bookmarks or contacts search results found elsewhere e.g. from the internet by map service and or other service s and or some combination thereof. As is the case with commands any of the search queries may be entered by the user via voice or through typing. The multifunction device may be configured to display search results graphically within any of the map display described herein. For instance a pin or other graphical indicator may specify locations of search results as points of interest. In various embodiments responsive to a user selection of one of these points of interest e.g. a touch selection such as a tap the multifunction device may be configured to display additional information about the selected point of interest including but not limited to ratings reviews or review snippets hours of operation store status e.g. open for business permanently closed etc. and or images of a storefront for the point of interest. In various embodiments any of this information may be displayed on a graphical information card that is displayed in response to the user s selection of the point of interest.

In various embodiments map service and or other service s may provide one or more feedback mechanisms to receive feedback from client devices . For instance client devices may provide feedback on search results to map service and or other service s e.g. feedback specifying ratings reviews temporary or permanent business closures errors etc. this feedback may be used to update information about points of interest in order to provide more accurate or more up to date search results in the future. In some embodiments map service and or other service s may provide testing information to the client device e.g. an A B test to determine which search results are best. For instance at random intervals the client device may receive and present two search results to a user and allow the user to indicate the best result. The client device may report the test results to map service and or other service s to improve future search results based on the chosen testing technique such as an A B test technique in which a baseline control sample is compared to a variety of single variable test samples in order to improve results.

For client devices operating within a map service operating environment such as described above with regard to obtaining rendering and displaying map image data may be implemented in many different ways. According to various embodiments outlines one such implementation by rendering map image data such as a map tile according to a stylesheet stored locally on a client device. One or more map tiles may be obtained by a client device such as client device in . To obtain a map tile the client device may rely upon communication systems or methods described in the various embodiments considered by . For example a map tile may be sent from a map service commonly a server over a WAN to a client device where a client device may communicate with a WAN through a variety of access devices or wireless networks . A map tile may be sent using one or more sets of data such as single or multiple messages or packets containing map tile information. Map tiles may also be sent through a variety of secure data transfer protocols or algorithms including but not limited to Secure Socket Layer SSL or Transport Layer Security TLS or other forms of data authentication and encryption.

In some embodiments map tiles may be encoded or compressed using different techniques. For example a map tile that contains raster image data may be compressed according to JPEG or BMP formats while a map tile that contains vector image data may be encoded according to the SVG format. Map tiles may contain map image data composed of vector graphics raster graphics or some combination thereof. A client device may implement various hardware and or software configurations to decode decompress map tiles in their received states such as software using Open Graphics Library OpenGL functions for graphics hardware installed on a client device.

In some embodiments map tiles may include one or more features. These features may be but are not limited to many common symbols shapes markers objects e.g. roads buildings etc. . One or more of the features in a map tile may contain one or more style identifiers which may be used by a client device to identify a style for the feature that contains the style identifiers. below contains further discussion below that elaborates upon the structure of a map tile.

To identify a style for each feature in the obtained one or more map tiles a stylesheet such as stylesheet illustrated in the block diagram of may be used. Generally a stylesheet may be a set of one or more styles such as a described by a data structure or schema scripting language or other set of rendering instructions that instruct a rendering device how to render various objects that are identified with the one or more styles in the stylesheet and thus allowing an object to be agnostic of its own rendering instructions. In order to determine which of the one or more styles should be used to render an object stylesheets may implement different indexes keys or other identification mechanisms to make this determination. illustrates a stylesheet with one or more styles . Each of the styles contains one or more style identifiers . Styles in a stylesheet may contain rendering instructions for the style not depicted . The style identifiers act as the identification mechanism to determine which of the styles to should be applied to particular object.

One possible coded implementation of a stylesheet such as stylesheet in is described below in pseudo code 

In the example pseudo code a stylesheet is designed using text based definitions creating a stylesheet schema. In some embodiments individual style identifiers may have multiple possible values as illustrated in the above example. For instance in the style named US Highway the road type style identifier has values of Highway Expressway and Freeway . In other words the style identifier has three possible values all of which are string values. Style identifiers however may also have other types of values besides style values such as numeric values. In some embodiments particular style identifiers may be limited to one Boolean true or false value such as ferry route that is true or false. Embodiments may also implement style identifiers that all require Boolean true or false values. Further still some embodiments may rely upon hierarchies of styles where styles inherit style identifiers from parent styles. For example in one schema interstate and highway may both inherit style identifiers from road. In some embodiments several combinations of style identifiers and accepted style identifier values may be implemented. It will be apparent to one of ordinary skill in the art that there are many possible implementations of a stylesheet that specify style identifiers and their relationships. Neither the given pseudo code above nor the illustration of are to be construed as limiting the many possible embodiments or implementations of a stylesheet containing styles with style identifiers.

Embodiments may obtain and or store one or more stylesheets on a client device such as in the memory of a portable multifunction device described in . Some embodiments may allow users modules applications or other systems to determine which stylesheet a client device may user when rendering map tiles according to a stylesheet. Various embodiments implementing multiple stylesheets are discussed below with regard to .

Embodiments may identify a style for each of the one or more features that contains one or more style identifiers in a map tile . In at least some embodiments each feature in a map tile may include multiple style identifiers. In some embodiments identifying a style for a feature in a map tile may occur as illustrated in . To identify a style for a given feature with one or more style identifiers according to a stylesheet such as stylesheet in a client device may rank the styles defined in the stylesheet according to the number of style identifiers in common with the style identifiers of the feature . For example a client device may rank the styles of a stylesheet by comparing the style identifiers in the given feature to the style identifiers of each style in stylesheet . Thus styles with two matching style identifiers would be ranked lower than styles with five matching style identifiers.

Some embodiments may implement a scoring method to determine the rank of a style. For example a feature matches a style definition only if all style identifiers are present in the style definition and all features style identifier values match the values of the style identifiers in the style. A feature may have more style identifiers than a style definition but in this example it may not have less. The score to determine a style s rank is based on the number of style identifiers in the style definition. Therefore in this example a more specific style definition will have a higher score than a less specific one. Other methods may be used to implement ranking the styles. Embodiments may implement logic that weights certain style identifiers higher than others such that a style with fewer matching style identifiers may rank higher than other styles with more matching features. For example a feature may contain several style identifiers that describe a road two lanes asphalt 25 mph speed limit Mexico . Several style identifiers for styles in a stylesheet may contain one or more of the first three style identifiers. However one style may only contain the style identifier Mexico. The client device may select the style identifier Mexico because it weights country style identifiers higher.

After ranking the styles in a stylesheet such as those described above with regard to embodiments may select the highest rank style as the style identified for the feature . In some embodiments further logic may be implemented to handle selecting between one or more styles that are tied for the highest rank. For example if three styles have equal rank scores then a client device may select the first style of the three styles. Alternatively the client device may select style with the least number of rendering instructions. After a style is selected the selected style may then be identified as the style containing the appropriate rendering instructions for the feature. Some embodiments may examine each feature with one or more style identifiers until every feature in a map tile has an identified style .

Other embodiments may implement identifying a style for each feature as indicated at in using methods alternative to those described with regard to above. For example in some embodiments a style identifier may be uniquely keyed to match the style identifier in only one style negating the necessity of identifying a single style from multiple possible styles. Embodiments may also implement a method that identifies as the style for the feature the style of the first matching style identifier even if another later examined style might have more matching style identifiers.

Once embodiments have identified styles for one or more of the features in the one or more obtained map tiles the map tiles may be rendered according to the identified styles . As stated above styles in a stylesheet such as stylesheet in contain rendering instructions which may be applied to objects identified with a particular style. Accordingly features with identified styles may be rendered according to the rendering instructions contained in the corresponding style. Rendering instructions may include but are not limited to size color texture width motion pattern or any other graphically displayable attribute. In some embodiments the rendering instructions in a style will have varying values which may be determined according to the zoom level of a map tile. For example a line feature in a map tile may have an identified style as Interstate. At a high zoom level e.g. the rendering instructions may instruct the client device to render the line feature 3 pixels wide and solid black. However if the zoom level for the line feature were to be changed or if the line feature were received with a lower zoom level e.g. 2 then identified style s rendering instructions may instruct the client device to render the line feature as 10 pixels wide of a gray color with a one pixel black border on either side.

Many techniques for rendering map tiles and or other map image data are well known to those of ordinary skill in the art. A client device may implement common techniques which are platform independent such as but not limited to utilizing the Open Graphics Library OpenGL or Direct3D application programmer interfaces or variants thereof such as OpenGL ES. Customized rendering applications such as graphics module discussed below with regard to which may optimize the performance of CPUs or GPUs may also be implemented. Rendering map tiles may be implemented by decoding or decompressing vector and or raster graphics data according to its format and if displaying the rendered map tiles submitting the rendered map tiles to a hardware device such as a frame buffer which displays the rendered map tiles. Many other software and hardware implementations may be used to render the obtained raster image and the example implementations above are not intended to be limiting.

In some embodiments the rendered map tiles may be displayed on the client device such as a touch sensitive display described with regard to or other display devices. Embodiments may also store the rendered map tiles or send the rendered map tiles to other modules or applications such as those described with regard to for further processing. For example a contacts module like contacts module in might annotate rendered map tiles with the markers for the locations of contacts determined by the contacts module.

As described in a map service may communicate with a client device to send and or receive map and location data to implement various mapping and navigation applications. For example a map service may determine the location of a client device and the map data necessary for the client device to view at the corresponding map location. As discussed previously map image data whether in two or three dimensions may specify one or more map tiles. A map tile may be a portion of a larger map image. Assembling together the map tiles of a map may produce the original map. Tiles may be generated from map image data routing or navigation data or any other map service data. In some embodiments map tiles may be raster based map tiles with tile sizes ranging from any size both larger and smaller than a commonly used 256 pixel by 256 pixel tile. Raster based map tiles may be encoded in any number of standard digital image representations including but not limited to Bitmap .bmp Graphics Interchange Format .gif Joint Photographic Experts Group .jpg .jpeg etc. Portable Networks Graphic .png or Tagged Image File Format .tiff . In some embodiments map tiles may be vector based map tiles encoded using vector graphics including but not limited to Scalable Vector Graphics .svg or a Drawing File .drw . Embodiments may also include tiles with a combination of vector and raster data. Metadata or other information pertaining to the map tile may also be included within or along with a map tile providing further map service data to a client device.

In various embodiments a map service may generate one or more map tiles that may include one or more features which in turn may include one or more style identifiers. In some embodiments a map service may construct or assign style identifiers to map features according to a map service Application Programming Interface API or other style identifier guideline or schema which defines certain identifiers to devices operating within a map service operating environment such as map service operating environment in . In some embodiments a map service may generate one or more stylesheets and send them to one or more client devices to sync style identifiers generated for map tiles on the map service to style identifiers resident in the stylesheets stored on client devices.

When a map service generates one or map tiles some embodiments may generate a compressed representation of the one or more style identifiers of the one or more features in map tile. This compressed representation may reduce redundant style identifiers from being included in multiple features in a map tile. In one embodiment of a compression technique a map service may structure a map tile to be with the map tile features and their corresponding style identifiers to be represented in a specific order. For example a map tile data structure may be created with a list of strings used to represent the style identifiers of the features in the map tile. A feature data structure may define style identifiers for a particular feature but only for the style identifiers that differ from the style identifiers provided in a previous feature such as providing a certain style identifier value to override or delete style identifiers included in previous features but not present in the current feature.

In some embodiments when generating a compressed representation of style identifiers for the features of a map tile a map service may order the style identifiers according to their frequency of occurrence in the map tile. A map service may then specify the style identifiers for the features in the map tile removing redundant style identifiers for a feature that are specified for a previous feature. For example some embodiments may implement this method by implementing style identifiers within each feature that have a style identifier value and a style identifier type. To optimize compression using the style identifier values and style identifier types the map service may count the number of times a style identifier type appears in the map tile. The map service may then sort the style identifiers with both the type and corresponding value according to the number times a style identifier type appears in the feature. Then a map service may sort the features associated according to the ordering of the style identifiers. Thus providing features with similar style identifier types in an order that facilities reduction of redundant style identifiers. Note the compression methods and examples described above are not intended to be limiting. Many well known compression techniques will be apparent to those of ordinary skill in the art to generate a compressed representation of style identifiers for the features of a map tile.

After generating one or more map tiles a map service may send the generated map tiles over one the various communication channels to a client device as discussed with regard to . For example embodiments may send the map tile through a WAN which in turn may rely upon wired or wireless networks or through access devices to transport the one or map tiles to a client device .

Various embodiments may implement a method of rendering a map tile according to a stylesheet in a module such as described in . shows one such embodiment. A map tile is obtained by the rendering module . In some embodiments a map tile may be decompressed by a decompression algorithm. For example if a list of style identifiers for the features of a map tile were compressed a software component may deflate the compressed list in order to allow the module to access the style identifiers. Other various embodiments may perform methods or processes to prepare the map tile for rendering such as decryption or authentication according to various protocols in order to verify the contents and the origin of the map tile. Some embodiments may perform decoding for various graphic formats for image data contained in a map tile such as JPEG or BMP formats. The module may then select one of the map tile features. Embodiments may implement many different feature selection algorithms to optimize many different operating goals such as efficiency. For example some map features may be common elements in a map tile. If one of the common elements was rendered and other duplicates of the element existed all of the duplicates may be selected next and instead of being rendered from the beginning may utilized parts or all of the previously rendered feature to prevent the rendering of duplicate information.

After selecting the feature the module may obtain a list of identifiers from the feature in the map tile. Some embodiments may store identifiers in other data structure forms than a list such as arrays or trees. Embodiments may provide an index key to master list of all style identifiers for all features in a given map tile. The module may then compare the identifiers of the feature to the styles from the stylesheet s . Some embodiments may have more than one stylesheet . Embodiments may compare the feature identifiers to the styles in one stylesheet or multiple stylesheets using one of the various methods described with regard to . Before during or after rendering commences various embodiments may allow user input to a client device. A client device may determine which stylesheet is to be used using various input devices such as those described with regard to . In at least some embodiments this determination may be presented to the user as an option to select a mode or map display setting.

User input may directly change stylesheets used to compare identifiers in some direct manner such as through a list of stored stylesheets . In various embodiments user input may also store new stylesheets in the client device such as in memory described below with regard to . User input may also edit stylesheets such as changing identifier values adding identifiers or deleting identifiers.

In at least some embodiments other systems working in the operating environment may interact with the stylesheets . For example a map service such as map service in may detect that it is night at the location of a client device. The map service may send a control message to the client device switching the display mode to night which the client device will then render the map tiles according to the stylesheet linked to the night display mode. In various embodiments other systems may also store new stylesheets in the client device. User input may also edit stylesheets such as changing identifier values adding identifiers or deleting identifiers. For example a user may wish for certain types of roads to be displayed a brighter color so the user accesses an interface of the mapping application that receives user edits to a particular stylesheet or display mode and incorporates the new rendering instructions for map tiles rendered using that stylesheet.

In some embodiments other module s on the client device may interact with the stylesheets . Other module s may directly change stylesheets used to compare identifiers . For example a client device may run a software update application that detects that new style information needs to be added to a stylesheet. The update application may obtain the new information and access the stylesheet to add the new style information. In various embodiments other module s may also store new stylesheets in the client device. For example a weather module such as the weather widget in may supply a stylesheet that to render certain features differently under different weather conditions. User input may also edit stylesheets such as changing identifier values adding identifiers or deleting identifiers.

After comparing feature identifiers to styles in a stylesheet the module may rank styles according to the number of matching identifiers with the feature . As discussed previously concerning there are many possible methods or embodiments to perform this ranking. Then the highest rank style may be applied to the selected feature . In some embodiments the dotted line in represents a condition which repeats until all features styles have been identified. The module may then render the map tile using the various rendering hardware and software implementations discussed above regarding .

In various embodiments the rendered map tile may be displayed on the client device such as touch sensitive display or some other display such as a display monitor communicated to over a wireless network. Embodiments may also send the rendered map tile to other modules on the client device for further processing evaluation or manipulation. Some embodiments may store the rendered map tile in a storage medium on the client device such as memory described below in . Other embodiments may store the rendered map tile on remote storage mediums or on other storage systems or devices in the map service operating environment .

Embodiments of electronic devices user interfaces for such devices and associated processes for using such devices are described. In some embodiments the device is a portable communications device such as a mobile telephone that also contains other functions such as PDA and or music player functions. Exemplary embodiments of portable multifunction devices include without limitation the iPhone iPod Touch and iPad devices from Apple Inc. of Cupertino Calif. Other portable electronic devices such as laptops or tablet computers with touch sensitive surfaces e.g. touch screen displays and or touch pads may also be used. It should also be understood that in some embodiments the device is not a portable communications device but is a desktop computer with a touch sensitive surface e.g. a touch screen display and or a touch pad . In some embodiments the device is a gaming computer with orientation sensors e.g. orientation sensors in a gaming controller .

In the discussion that follows an electronic device that includes a display and a touch sensitive surface is described. It should be understood however that the electronic device may include one or more other physical user interface devices such as a physical keyboard a mouse and or a joystick.

The device typically supports a variety of applications such as one or more of the following a drawing application a presentation application a word processing application a website creation application a disk authoring application a spreadsheet application a gaming application a telephone application a video conferencing application an e mail application an instant messaging application a workout support application a photo management application a digital camera application a digital video camera application a web browsing application a digital music player application and or a digital video player application.

The various applications that may be executed on the device may use at least one common physical user interface device such as the touch sensitive surface. One or more functions of the touch sensitive surface as well as corresponding information displayed on the device may be adjusted and or varied from one application to the next and or within a respective application. In this way a common physical architecture such as the touch sensitive surface of the device may support the variety of applications with user interfaces that are intuitive and transparent to the user.

Attention is now directed toward embodiments of portable devices with touch sensitive displays. is a block diagram illustrating portable multifunction device with touch sensitive displays in accordance with some embodiments. Touch sensitive display is sometimes called a touch screen for convenience and may also be known as or called a touch sensitive display system. Device may include memory which may include one or more computer readable storage mediums memory controller one or more processing units CPU s peripherals interface RF circuitry audio circuitry speaker microphone input output I O subsystem other input or control devices and external port . Device may include one or more optical sensors . These components may communicate over one or more communication buses or signal lines .

It should be appreciated that device is only one example of a portable multifunction device and that device may have more or fewer components than shown may combine two or more components or may have a different configuration or arrangement of the components. The various components shown in may be implemented in hardware software or a combination of both hardware and software including one or more signal processing and or application specific integrated circuits.

Memory may include high speed random access memory and may also include non volatile memory such as one or more magnetic disk storage devices flash memory devices or other non volatile solid state memory devices. Access to memory by other components of device such as CPU and the peripherals interface may be controlled by memory controller .

Peripherals interface can be used to couple input and output peripherals of the device to CPU and memory . The one or more processors run or execute various software programs and or sets of instructions stored in memory to perform various functions for device and to process data.

In some embodiments peripherals interface CPU and memory controller may be implemented on a single chip such as chip . In some other embodiments they may be implemented on separate chips.

RF radio frequency circuitry receives and sends RF signals also called electromagnetic signals. RF circuitry converts electrical signals to from electromagnetic signals and communicates with communications networks and other communications devices via the electromagnetic signals. RF circuitry may include well known circuitry for performing these functions including but not limited to an antenna system an RF transceiver one or more amplifiers a tuner one or more oscillators a digital signal processor a CODEC chipset a subscriber identity module SIM card memory and so forth. RF circuitry may communicate with networks such as the Internet also referred to as the World Wide Web WWW an intranet and or a wireless network such as a cellular telephone network a wireless local area network LAN and or a metropolitan area network MAN and other devices by wireless communication. The wireless communication may use any of multiple communications standards protocols and technologies including but not limited to Global System for Mobile Communications GSM Enhanced Data GSM Environment EDGE high speed downlink packet access HSDPA high speed uplink packet access HSUPA wideband code division multiple access W CDMA code division multiple access CDMA time division multiple access TDMA Bluetooth Wireless Fidelity Wi Fi e.g. IEEE 802.11a IEEE 802.11b IEEE 802.11g and or IEEE 802.11n voice over Internet Protocol VoIP Wi MAX a protocol for e mail e.g. Internet message access protocol IMAP and or post office protocol POP instant messaging e.g. extensible messaging and presence protocol XMPP Session Initiation Protocol for Instant Messaging and Presence Leveraging Extensions SIMPLE Instant Messaging and Presence Service IMPS and or Short Message Service SMS or any other suitable communication protocol including communication protocols not yet developed as of the filing date of this document.

Audio circuitry speaker and microphone provide an audio interface between a user and device . Audio circuitry receives audio data from peripherals interface converts the audio data to an electrical signal and transmits the electrical signal to speaker . Speaker converts the electrical signal to human audible sound waves. Audio circuitry also receives electrical signals converted by microphone from sound waves. Audio circuitry converts the electrical signal to audio data and transmits the audio data to peripherals interface for processing. Audio data may be retrieved from and or transmitted to memory and or RF circuitry by peripherals interface . In some embodiments audio circuitry also includes a headset jack e.g. . The headset jack provides an interface between audio circuitry and removable audio input output peripherals such as output only headphones or a headset with both output e.g. a headphone for one or both ears and input e.g. a microphone .

I O subsystem couples input output peripherals on device such as touch screen and other input control devices to peripherals interface . I O subsystem may include display controller and one or more input controllers for other input or control devices. The one or more input controllers receive send electrical signals from to other input or control devices . The other input control devices may include physical buttons e.g. push buttons rocker buttons etc. dials slider switches joysticks click wheels and so forth. In some alternate embodiments input controller s may be coupled to any or none of the following a keyboard infrared port USB port and a pointer device such as a mouse. The one or more buttons e.g. may include an up down button for volume control of speaker and or microphone . The one or more buttons may include a push button e.g. .

Touch sensitive display provides an input interface and an output interface between the device and a user. Display controller receives and or sends electrical signals from to touch screen . Touch screen displays visual output to the user. The visual output may include graphics text icons video and any combination thereof collectively termed graphics . In some embodiments some or all of the visual output may correspond to user interface objects.

Touch screen has a touch sensitive surface sensor or set of sensors that accepts input from the user based on haptic and or tactile contact. Touch screen and display controller along with any associated modules and or sets of instructions in memory detect contact and any movement or breaking of the contact on touch screen and converts the detected contact into interaction with user interface objects e.g. one or more soft keys icons web pages or images that are displayed on touch screen . In an exemplary embodiment a point of contact between touch screen and the user corresponds to a finger of the user.

Touch screen may use LCD liquid crystal display technology LPD light emitting polymer display technology or LED light emitting diode technology although other display technologies may be used in other embodiments. Touch screen and display controller may detect contact and any movement or breaking thereof using any of multiple touch sensing technologies now known or later developed including but not limited to capacitive resistive infrared and surface acoustic wave technologies as well as other proximity sensor arrays or other elements for determining one or more points of contact with touch screen . In an exemplary embodiment projected mutual capacitance sensing technology is used such as that found in the iPhone iPod Touch and iPad from Apple Inc. of Cupertino Calif.

Touch screen may have a video resolution in excess of 100 dpi. In some embodiments the touch screen has a video resolution of approximately 1060 dpi. The user may make contact with touch screen using any suitable object or appendage such as a stylus a finger and so forth. In some embodiments the user interface is designed to work primarily with finger based contacts and gestures which can be less precise than stylus based input due to the larger area of contact of a finger on the touch screen. In some embodiments the device translates the rough finger based input into a precise pointer cursor position or command for performing the actions desired by the user.

In some embodiments in addition to the touch screen device may include a touchpad not shown for activating or deactivating particular functions. In some embodiments the touchpad is a touch sensitive area of the device that unlike the touch screen does not display visual output. The touchpad may be a touch sensitive surface that is separate from touch screen or an extension of the touch sensitive surface formed by the touch screen.

Device also includes power system for powering the various components. Power system may include a power management system one or more power sources e.g. battery alternating current AC a recharging system a power failure detection circuit a power converter or inverter a power status indicator e.g. a light emitting diode LED and any other components associated with the generation management and distribution of power in portable devices.

Device may also include one or more optical sensors . shows an optical sensor coupled to optical sensor controller in I O subsystem . Optical sensor may include charge coupled device CCD or complementary metal oxide semiconductor CMOS phototransistors. Optical sensor receives light from the environment projected through one or more lens and converts the light to data representing an image. In conjunction with imaging module also called a camera module optical sensor may capture still images or video. In some embodiments an optical sensor is located on the back of device opposite touch screen display on the front of the device so that the touch screen display may be used as a viewfinder for still and or video image acquisition. In some embodiments another optical sensor is located on the front of the device so that the user s image may be obtained for videoconferencing while the user views the other video conference participants on the touch screen display.

Device may also include one or more proximity sensors . shows proximity sensor coupled to peripherals interface . Alternately proximity sensor may be coupled to input controller in I O subsystem . In some embodiments the proximity sensor turns off and disables touch screen when the multifunction device is placed near the user s ear e.g. when the user is making a phone call .

Device includes one or more orientation sensors . In some embodiments the one or more orientation sensors include one or more accelerometers e.g. one or more linear accelerometers and or one or more rotational accelerometers . In some embodiments the one or more orientation sensors include one or more gyroscopes. In some embodiments the one or more orientation sensors include one or more magnetometers. In some embodiments the one or more orientation sensors include one or more of global positioning system GPS Global Navigation Satellite System GLONASS and or other global navigation system receivers. The GPS GLONASS and or other global navigation system receivers may be used for obtaining information concerning the location and orientation e.g. portrait or landscape of device . In some embodiments the one or more orientation sensors include any combination of orientation rotation sensors. shows the one or more orientation sensors coupled to peripherals interface . Alternately the one or more orientation sensors may be coupled to an input controller in I O subsystem . In some embodiments information is displayed on the touch screen display in a portrait view or a landscape view based on an analysis of data received from the one or more orientation sensors.

In some embodiments the software components stored in memory include operating system communication module or set of instructions contact motion module or set of instructions graphics module or set of instructions text input module or set of instructions Global Positioning System GPS module or set of instructions and applications or sets of instructions . Furthermore in some embodiments memory stores device global internal state as shown in . Device global internal state includes one or more of active application state indicating which applications if any are currently active display state indicating what applications views or other information occupy various regions of touch screen display sensor state including information obtained from the device s various sensors and input control devices and location information concerning the device s location and or attitude.

Operating system e.g. Darwin RTXC LINUX UNIX OS X WINDOWS or an embedded operating system such as VxWorks includes various software components and or drivers for controlling and managing general system tasks e.g. memory management storage device control power management etc. and facilitates communication between various hardware and software components.

Communication module facilitates communication with other devices over one or more external ports and also includes various software components for handling data received by RF circuitry and or external port . External port e.g. Universal Serial Bus USB FIREWIRE etc. is adapted for coupling directly to other devices or indirectly over a network e.g. the Internet wireless LAN etc. . In some embodiments the external port is a multi pin e.g. 30 pin connector that is the same as or similar to and or compatible with the 30 pin connector used on iPod trademark of Apple Inc. devices.

Contact motion module may detect contact with touch screen in conjunction with display controller and other touch sensitive devices e.g. a touchpad or physical click wheel . Contact motion module includes various software components for performing various operations related to detection of contact such as determining if contact has occurred e.g. detecting a finger down event determining if there is movement of the contact and tracking the movement across the touch sensitive surface e.g. detecting one or more finger dragging events and determining if the contact has ceased e.g. detecting a finger up event or a break in contact . Contact motion module receives contact data from the touch sensitive surface. Determining movement of the point of contact which is represented by a series of contact data may include determining speed magnitude velocity magnitude and direction and or an acceleration a change in magnitude and or direction of the point of contact. These operations may be applied to single contacts e.g. one finger contacts or to multiple simultaneous contacts e.g. multitouch multiple finger contacts . In some embodiments contact motion module and display controller detect contact on a touchpad.

Contact motion module may detect a gesture input by a user. Different gestures on the touch sensitive surface have different contact patterns. Thus a gesture may be detected by detecting a particular contact pattern. For example detecting a finger tap gesture includes detecting a finger down event followed by detecting a finger up lift off event at the same position or substantially the same position as the finger down event e.g. at the position of an icon . As another example detecting a finger swipe gesture on the touch sensitive surface includes detecting a finger down event followed by detecting one or more finger dragging events and subsequently followed by detecting a finger up lift off event.

Graphics module includes various known software components for rendering and displaying graphics on touch screen or other display including components for changing the intensity of graphics that are displayed. As used herein the term graphics includes any object that can be displayed to a user including without limitation text web pages icons such as user interface objects including soft keys digital images videos animations and the like.

In some embodiments graphics module stores data representing graphics to be used. Each graphic may be assigned a corresponding code. Graphics module receives from applications etc. one or more codes specifying graphics to be displayed along with if necessary coordinate data and other graphic property data and then generates screen image data to output to display controller .

Text input module which may be a component of graphics module provides soft keyboards for entering text in various applications e.g. contacts e mail IM browser and any other application that needs text input .

GPS module determines the location of the device and provides this information for use in various applications e.g. to telephone for use in location based dialing to camera as picture video metadata and to applications that provide location based services such as weather widgets local yellow page widgets and map navigation widgets .

Applications may include the following modules or sets of instructions or a subset or superset thereof 

Examples of other applications that may be stored in memory include other word processing applications other image editing applications drawing applications presentation applications JAVA enabled applications encryption digital rights management voice recognition and voice replication.

In conjunction with touch screen display controller contact module graphics module and text input module contacts module may be used to manage an address book or contact list e.g. stored in application internal state of contacts module in memory including adding name s to the address book deleting name s from the address book associating telephone number s e mail address es physical address es or other information with a name associating an image with a name categorizing and sorting names providing telephone numbers or e mail addresses to initiate and or facilitate communications by telephone video conference e mail or IM and so forth.

In conjunction with RF circuitry audio circuitry speaker microphone touch screen display controller contact module graphics module and text input module telephone module may be used to enter a sequence of characters corresponding to a telephone number access one or more telephone numbers in address book modify a telephone number that has been entered dial a respective telephone number conduct a conversation and disconnect or hang up when the conversation is completed. As noted above the wireless communication may use any of multiple communications standards protocols and technologies.

In conjunction with RF circuitry audio circuitry speaker microphone touch screen display controller optical sensor optical sensor controller contact module graphics module text input module contact list and telephone module videoconferencing module includes executable instructions to initiate conduct and terminate a video conference between a user and one or more other participants in accordance with user instructions.

In conjunction with RF circuitry touch screen display controller contact module graphics module and text input module e mail client module includes executable instructions to create send receive and manage e mail in response to user instructions. In conjunction with image management module e mail client module makes it very easy to create and send e mails with still or video images taken with camera module .

In conjunction with RF circuitry touch screen display controller contact module graphics module and text input module the instant messaging module includes executable instructions to enter a sequence of characters corresponding to an instant message to modify previously entered characters to transmit a respective instant message for example using a Short Message Service SMS or Multimedia Message Service MMS protocol for telephony based instant messages or using XMPP SIMPLE or IMPS for Internet based instant messages to receive instant messages and to view received instant messages. In some embodiments transmitted and or received instant messages may include graphics photos audio files video files and or other attachments as are supported in a MMS and or an Enhanced Messaging Service EMS . As used herein instant messaging refers to both telephony based messages e.g. messages sent using SMS or MMS and Internet based messages e.g. messages sent using XMPP SIMPLE or IMPS .

In conjunction with RF circuitry touch screen display controller contact module graphics module text input module GPS module map module and music player module workout support module includes executable instructions to create workouts e.g. with time distance and or calorie burning goals communicate with workout sensors sports devices receive workout sensor data calibrate sensors used to monitor a workout select and play music for a workout and display store and transmit workout data.

In conjunction with touch screen display controller optical sensor s optical sensor controller contact module graphics module and image management module camera module includes executable instructions to capture still images or video including a video stream and store them into memory modify characteristics of a still image or video or delete a still image or video from memory .

In conjunction with touch screen display controller contact module graphics module text input module and camera module image management module includes executable instructions to arrange modify e.g. edit or otherwise manipulate label delete present e.g. in a digital slide show or album and store still and or video images.

In conjunction with RF circuitry touch screen display system controller contact module graphics module and text input module browser module includes executable instructions to browse the Internet in accordance with user instructions including searching linking to receiving and displaying web pages or portions thereof as well as attachments and other files linked to web pages.

In conjunction with RF circuitry touch screen display system controller contact module graphics module text input module e mail client module and browser module calendar module includes executable instructions to create display modify and store calendars and data associated with calendars e.g. calendar entries to do lists etc. in accordance with user instructions.

In conjunction with RF circuitry touch screen display system controller contact module graphics module text input module and browser module widget modules are mini applications that may be downloaded and used by a user e.g. weather widget stocks widget calculator widget alarm clock widget and dictionary widget or created by the user e.g. user created widget . In some embodiments a widget includes an HTML Hypertext Markup Language file a CSS Cascading Style Sheets file and a JavaScript file. In some embodiments a widget includes an XML Extensible Markup Language file and a JavaScript file e.g. Yahoo Widgets .

In conjunction with RF circuitry touch screen display system controller contact module graphics module text input module and browser module the widget creator module may be used by a user to create widgets e.g. turning a user specified portion of a web page into a widget .

In conjunction with touch screen display system controller contact module graphics module and text input module search module includes executable instructions to search for text music sound image video and or other files in memory that match one or more search criteria e.g. one or more user specified search terms in accordance with user instructions.

In conjunction with touch screen display system controller contact module graphics module audio circuitry speaker RF circuitry and browser module video and music player module includes executable instructions that allow the user to download and play back recorded music and other sound files stored in one or more file formats such as MP3 or AAC files and executable instructions to display present or otherwise play back videos e.g. on touch screen or on an external connected display via external port . In some embodiments device may include the functionality of an MP3 player such as an iPod trademark of Apple Inc. .

In conjunction with touch screen display controller contact module graphics module and text input module notes module includes executable instructions to create and manage notes to do lists and the like in accordance with user instructions.

In conjunction with RF circuitry touch screen display system controller contact module graphics module text input module GPS module and browser module map module may be used to receive display modify and store maps and data associated with maps e.g. driving directions data on stores and other points of interest at or near a particular location and other location based data in accordance with user instructions.

In conjunction with touch screen display system controller contact module graphics module audio circuitry speaker RF circuitry text input module e mail client module and browser module online video module includes instructions that allow the user to access browse receive e.g. by streaming and or download play back e.g. on the touch screen or on an external connected display via external port send an e mail with a link to a particular online video and otherwise manage online videos in one or more file formats such as H.264. In some embodiments instant messaging module rather than e mail client module is used to send a link to a particular online video.

Each of the above identified modules and applications correspond to a set of executable instructions for performing one or more functions described above and the methods described in this application e.g. the computer implemented methods and other information processing methods described herein . These modules i.e. sets of instructions need not be implemented as separate software programs procedures or modules and thus various subsets of these modules may be combined or otherwise re arranged in various embodiments. In some embodiments memory may store a subset of the modules and data structures identified above. Furthermore memory may store additional modules and data structures not described above.

In some embodiments device is a device where operation of a predefined set of functions on the device is performed exclusively through a touch screen and or a touchpad. By using a touch screen and or a touchpad as the primary input control device for operation of device the number of physical input control devices such as push buttons dials and the like on device may be reduced.

The predefined set of functions that may be performed exclusively through a touch screen and or a touchpad include navigation between user interfaces. In some embodiments the touchpad when touched by the user navigates device to a main home or root menu from any user interface that may be displayed on device . In such embodiments the touchpad may be referred to as a menu button. In some other embodiments the menu button may be a physical push button or other physical input control device instead of a touchpad.

Event sorter receives event information and determines the application and application view of application to which to deliver the event information. Event sorter includes event monitor and event dispatcher module . In some embodiments application includes application internal state which indicates the current application view s displayed on touch sensitive display when the application is active or executing. In some embodiments device global internal state is used by event sorter to determine which application s is are currently active and application internal state is used by event sorter to determine application views to which to deliver event information.

In some embodiments application internal state includes additional information such as one or more of resume information to be used when application resumes execution user interface state information that indicates information being displayed or that is ready for display by application a state queue for enabling the user to go back to a prior state or view of application and a redo undo queue of previous actions taken by the user.

Event monitor receives event information from peripherals interface . Event information includes information about a sub event e.g. a user touch on touch sensitive display as part of a multi touch gesture . Peripherals interface transmits information it receives from I O subsystem or a sensor such as proximity sensor orientation sensor s and or microphone through audio circuitry . Information that peripherals interface receives from I O subsystem includes information from touch sensitive display or a touch sensitive surface.

In some embodiments event monitor sends requests to the peripherals interface at predetermined intervals. In response peripherals interface transmits event information. In other embodiments peripheral interface transmits event information only when there is a significant event e.g. receiving an input above a predetermined noise threshold and or for more than a predetermined duration .

In some embodiments event sorter also includes a hit view determination module and or an active event recognizer determination module .

Hit view determination module provides software procedures for determining where a sub event has taken place within one or more views when touch sensitive display displays more than one view. Views are made up of controls and other elements that a user can see on the display.

Another aspect of the user interface associated with an application is a set of views sometimes herein called application views or user interface windows in which information is displayed and touch based gestures occur. The application views of a respective application in which a touch is detected may correspond to programmatic levels within a programmatic or view hierarchy of the application. For example the lowest level view in which a touch is detected may be called the hit view and the set of events that are recognized as proper inputs may be determined based at least in part on the hit view of the initial touch that begins a touch based gesture.

Hit view determination module receives information related to sub events of a touch based gesture. When an application has multiple views organized in a hierarchy hit view determination module identifies a hit view as the lowest view in the hierarchy which should handle the sub event. In most circumstances the hit view is the lowest level view in which an initiating sub event occurs i.e. the first sub event in the sequence of sub events that form an event or potential event . Once the hit view is identified by the hit view determination module the hit view typically receives all sub events related to the same touch or input source for which it was identified as the hit view.

Active event recognizer determination module determines which view or views within a view hierarchy should receive a particular sequence of sub events. In some embodiments active event recognizer determination module determines that only the hit view should receive a particular sequence of sub events. In other embodiments active event recognizer determination module determines that all views that include the physical location of a sub event are actively involved views and therefore determines that all actively involved views should receive a particular sequence of sub events. In other embodiments even if touch sub events were entirely confined to the area associated with one particular view views higher in the hierarchy would still remain as actively involved views.

Event dispatcher module dispatches the event information to an event recognizer e.g. event recognizer . In embodiments including active event recognizer determination module event dispatcher module delivers the event information to an event recognizer determined by active event recognizer determination module . In some embodiments event dispatcher module stores in an event queue the event information which is retrieved by a respective event receiver module .

In some embodiments operating system includes event sorter . Alternatively application includes event sorter . In yet other embodiments event sorter is a stand alone module or a part of another module stored in memory such as contact motion module .

In some embodiments application includes multiple event handlers and one or more application views each of which includes instructions for handling touch events that occur within a respective view of the application s user interface. Each application view of the application includes one or more event recognizers . Typically a respective application view includes multiple event recognizers . In other embodiments one or more of event recognizers are part of a separate module such as a user interface kit not shown or a higher level object from which application inherits methods and other properties. In some embodiments a respective event handler includes one or more of data updater object updater GUI updater and or event data received from event sorter . Event handler may utilize or call data updater object updater or GUI updater to update the application internal state . Alternatively one or more of the application views includes one or more respective event handlers . Also in some embodiments one or more of data updater object updater and GUI updater are included in a respective application view .

A respective event recognizer receives event information e.g. event data from event sorter and identifies an event from the event information. Event recognizer includes event receiver and event comparator . In some embodiments event recognizer also includes at least a subset of metadata and event delivery instructions which may include sub event delivery instructions .

Event receiver receives event information from event sorter . The event information includes information about a sub event for example a touch or a touch movement. Depending on the sub event the event information also includes additional information such as location of the sub event. When the sub event concerns motion of a touch the event information may also include speed and direction of the sub event. In some embodiments events include rotation of the device from one orientation to another e.g. from a portrait orientation to a landscape orientation or vice versa and the event information includes corresponding information about the current orientation also called device attitude of the device.

Event comparator compares the event information to predefined event or sub event definitions and based on the comparison determines an event or sub event or determines or updates the state of an event or sub event. In some embodiments event comparator includes event definitions . Event definitions contain definitions of events e.g. predefined sequences of sub events for example event 1 event 2 and others. In some embodiments sub events in an event include for example touch begin touch end touch movement touch cancellation and multiple touching. In one example the definition for event 1 is a double tap on a displayed object. The double tap for example includes a first touch touch begin on the displayed object for a predetermined phase a first lift off touch end for a predetermined phase a second touch touch begin on the displayed object for a predetermined phase and a second lift off touch end for a predetermined phase. In another example the definition for event 2 is a dragging on a displayed object. The dragging for example includes a touch or contact on the displayed object for a predetermined phase a movement of the touch across touch sensitive display and lift off of the touch touch end . In some embodiments the event also includes information for one or more associated event handlers .

In some embodiments event definition includes a definition of an event for a respective user interface object. In some embodiments event comparator performs a hit test to determine which user interface object is associated with a sub event. For example in an application view in which three user interface objects are displayed on touch sensitive display when a touch is detected on touch sensitive display event comparator performs a hit test to determine which of the three user interface objects is associated with the touch sub event . If each displayed object is associated with a respective event handler the event comparator uses the result of the hit test to determine which event handler should be activated. For example event comparator selects an event handler associated with the sub event and the object triggering the hit test.

In some embodiments the definition for a respective event also includes delayed actions that delay delivery of the event information until after it has been determined whether the sequence of sub events does or does not correspond to the event recognizer s event type.

When a respective event recognizer determines that the series of sub events do not match any of the events in event definitions the respective event recognizer enters an event impossible event failed or event ended state after which it disregards subsequent sub events of the touch based gesture. In this situation other event recognizers if any that remain active for the hit view continue to track and process sub events of an ongoing touch based gesture.

In some embodiments a respective event recognizer includes metadata with configurable properties flags and or lists that indicate how the event delivery system should perform sub event delivery to actively involved event recognizers. In some embodiments metadata includes configurable properties flags and or lists that indicate how event recognizers may interact with one another. In some embodiments metadata includes configurable properties flags and or lists that indicate whether sub events are delivered to varying levels in the view or programmatic hierarchy.

In some embodiments a respective event recognizer activates event handler associated with an event when one or more particular sub events of an event are recognized. In some embodiments a respective event recognizer delivers event information associated with the event to event handler . Activating an event handler is distinct from sending and deferred sending sub events to a respective hit view. In some embodiments event recognizer throws a flag associated with the recognized event and event handler associated with the flag catches the flag and performs a predefined process.

In some embodiments event delivery instructions include sub event delivery instructions that deliver event information about a sub event without activating an event handler. Instead the sub event delivery instructions deliver event information to event handlers associated with the series of sub events or to actively involved views. Event handlers associated with the series of sub events or with actively involved views receive the event information and perform a predetermined process.

In some embodiments data updater creates and updates data used in application . For example data updater updates the telephone number used in contacts module or stores a video file used in video player module . In some embodiments object updater creates and updates objects used in application . For example object updater creates a new user interface object or updates the position of a user interface object. GUI updater updates the GUI. For example GUI updater prepares display information and sends it to graphics module for display on a touch sensitive display.

In some embodiments event handler s includes or has access to data updater object updater and GUI updater . In some embodiments data updater object updater and GUI updater are included in a single module of a respective application or application view . In other embodiments they are included in two or more software modules.

It shall be understood that the foregoing discussion regarding event handling of user touches on touch sensitive displays also applies to other forms of user inputs to operate multifunction devices with input devices not all of which are initiated on touch screens e.g. coordinating mouse movement and mouse button presses with or without single or multiple keyboard presses or holds user movements taps drags scrolls etc. on touch pads pen stylus inputs movement of the device oral instructions detected eye movements biometric inputs and or any combination thereof which may be utilized as inputs corresponding to sub events which define an event to be recognized.

Device may also include one or more physical buttons such as home or menu button . As described previously menu button may be used to navigate to any application in a set of applications that may be executed on device . Alternatively in some embodiments the menu button is implemented as a soft key in a GUI displayed on touch screen .

In one embodiment device includes touch screen menu button push button for powering the device on off and locking the device volume adjustment button s Subscriber Identity Module SIM card slot head set jack and docking charging external port . Push button may be used to turn the power on off on the device by depressing the button and holding the button in the depressed state for a predefined time interval to lock the device by depressing the button and releasing the button before the predefined time interval has elapsed and or to unlock the device or initiate an unlock process. In an alternative embodiment device also may accept verbal input for activation or deactivation of some functions through microphone .

It should be noted that although many of the following examples will be given with reference to inputs on touch screen where the touch sensitive surface and the display are combined a touch sensitive surface that is separate from the display may be used instead of touch screen .

As noted above multifunction device includes a mapping application that may be stored in one or more memories of multifunction device and executed on one or more processors of multifunction device . In the illustrated embodiment the graphical representation of the mapping application may include a map of a geographic region. This map may be presented as a two dimensional map or a three dimensional map the selection of which may be specified through e.g. a user configurable parameter of the mapping application. In some embodiments the multifunction device may toggle between two dimensional map or three dimensional map views responsive to input from any input component of the multifunction device. In one non limiting example input from orientation sensor s may initiate the transition from a two dimensional map view to a three dimensional map and vice versa. For instance one or more of orientation sensor s may detect a tilt e.g. a user initiated tilt in the orientation of the multifunction device and in response initiate the aforesaid toggling.

Map may include a graphical position indicator which may represent the location of the multifunction device within the geographic region of the map. Generally position indicator may represent the current or real time position of the multifunction device although it should be understood that in some cases there may exist some small amount of temporal latency between the actual position of the multifunction device and the graphical representation of that location e.g. position indicator . This may occur e.g. when the multifunction device is in motion. In various embodiments the multifunction device may be configured to perform map matching including but not limited to aligning a sequence of observed user positions with a road network on a digital map. In various embodiments the multifunction device may be configured to perform a snap to function in which the graphical position indicator is aligned onto a roadway when the user s position falls within in a specified threshold distance of the roadway.

Furthermore multifunction device may generally be operated by a user. For example multifunction device may in some cases be a smartphone utilized by an individual to make phone calls send text messages browse the internet etc. As use of multifunction device by an individual generally implies the individual is proximate to the multifunction device e.g. the user may be holding the device in his or her hand references herein to the location of the device and the location of the user may be considered to be synonymous. However it should be understood that in some cases the actual position of the multifunction device and the user of that device may differ by some distance. For instance the user may place his or her multifunction device on a table of an outdoor caf while sitting in a nearby chair. In this case the position of the device and the position of the user may differ by some small amount. In another example multifunction device may be mounted on a car dashboard e.g. for use as a navigation device while the user of the device sits nearby e.g. in the driver seat of the car . In this case as well the position of the device and the position of the user may differ by some small amount. Despite these small differences in position generally the position of the multifunction device and the position of the multifunction device user may be considered to coincide.

In various embodiments the map displayed by the multifunction device may include one or more roads e.g. roads buildings not illustrated terrain features e.g. hills mountains not illustrated parks not illustrated water bodies not illustrated and or any other item that may be conveyed by a map. In some cases the map may also include other map or navigation information including but limited to readouts from one or more of a directional compass an altimeter and or a thermometer.

In various embodiments the mapping application may be configured to generate directions from an origination e.g. an address or a user s current position to a destination e.g. an address landmark bookmarked saved location or point of interest . For instance an indication of the origination and or destination may be input into the multi function device by the user. The multifunction device may generate one or more candidate routes between those two points. The multifunction device may select one of those routes for display on the device. In other cases multiple candidate routes may be presented to the user and the user may select a preferred route. In the illustrated embodiment one route is illustrated as route . The route may also include turn by turn directions which may be presented to the user in 2D or 3D such as a graphical indication to perform a turn from road to road . In some embodiments this graphical indication to perform a turn may be supplemented or substituted with an audible indication to turn such as a voice command from speaker that indicates the user is to turn left in 100 yards for example. In some embodiments the route that is selected may be presented to the user as a route overview. For instance before proceeding with navigation the multifunction device may generate a route overview display that graphically indicates key information for the route such as key turns route distance and or an estimated time for traversing the route. In some cases the multifunction device may be configured to generate a display of driving maneuvers e.g. turns lane changes etc. that occur in quick succession either in the route overview or during actual navigation. This information may help the user safely prepare for such maneuvers. In some cases the route information may be presented in a list format such as a list of turns or other maneuvers.

In various embodiments the mapping application of the multifunction device may be configured to track the position of the user over time and correspondingly adjust the graphical position indicator to indicate the new position. For instance the mapping application may determine that the user is traveling along route from position information e.g. information from GPS module and update the map accordingly. For instance in some cases the map may remain stationary while position indicator is moved along the route. In other cases position indicator may remain stationary or fixed while map is moved e.g. panned turned etc. around the position indicator.

In various embodiments the multifunction device may be configured to display alternate or contingency routes. In some cases these routes may be selectable by the user e.g. via the touch screen interface . In other cases the multifunction device may select a best route based on one or more parameters such as shortest distance or time. In some cases these parameters or preferences may be set by the user.

As described in more detail below the multifunction device may in various embodiments receive routing information that specifies a route from a map service. In some case the multifunction device may carry out navigation guidance in accordance with this route. However in some cases the multifunction device may perform a reroute operation in order to generate a new route to the destination. For instance the user may have deviated from the original route or explicitly requested a new route. In some cases the multifunction device may perform rerouting based on cached map data stored on the multifunction device.

In various embodiments the multifunction device may be configured to perform route correction based on real time data such as updates in map information road conditions traffic conditions and or weather conditions. For instance the multifunction device may be configured to alter a route such that the route avoids a construction zone or a dangerous storm cell.

In various embodiments the multifunction device may be configured to perform lane guidance independently or as part of navigation guidance. For instance the multifunction device may in response to detecting that multiple turns follow in quick succession provide the user with a direction or suggestion as to which lane to occupy. For instance a voice or visual indication may specify that the user turn right then move to the left lane in anticipation of a subsequent left turn. In another example the multifunction device may detect one or more lane closures e.g. due to construction or other reasons and instruct the user to avoid such lanes.

In various embodiments the multifunction device may be configured to generate voice prompts for directions. For instance during navigation guidance the multifunction device may be configured to generate audio representations of the next turn or driving maneuver on the route. For instance the multifunction device may be configured to audibly indicate the user should turn left in 100 yards or some other audible indication of a maneuver.

In various embodiments the multifunction device may be responsive to various voice commands for performing actions including a command to obtain a route. For instance the multifunction device may interpret the user s voice through a microphone or other transducer of the multifunction device. The user may specify an origination and a destination for the requested route. In various embodiments the multifunction device may be configured to utilize the user s current location as the origination for the route.

In various embodiments the multifunction device may be configured to perform a search along a specific route such as current navigation route. For instance the user of the multifunction device may request the location of points of interest such as fuel stations or restaurants. However if a user is traveling along a particular route they may not be particularly interested in points of interest that are not proximate to that route. As such the multifunction device may be configured to scope any searches to points of interested within a specified distance away from the route. In various embodiments this distance may be a configurable parameter.

In various embodiments the multifunction device may be configured to display various graphical layers including but not limited to a graphical map information aerial images e.g. satellite acquired images and or traffic information. For instance in the traffic information example the multifunction device may overlay color coded traffic information on roadways to indicate the speed at which traffic is flowing. For example green color coding may be used to indicate traffic is flowing normally and yellow or red may be used to indicate traffic slowdowns.

In various embodiments the multifunction device may be configured to display any quantity of metrics or statistics about a navigation route including but not limited to an estimated time of arrival travel distance remaining average speed overall or moving average top speed and or other route statistics.

In various embodiments the multifunction device may be configured to display routes at different angles in order to accommodate the preferences of different users. Such viewing angles may include a bird s eye view for two dimensional maps to any of a variety of camera angles available for a three dimensional map.

In various embodiments the multifunction device may be configured to provide navigation information other than map and routing information. For instance the multifunction device may expose output from any of the hardware device described above with respect to . In one non limiting example an orientation sensor may include a compass that outputs direction data. The multifunction device described herein may be configured to display this directional data as a virtual compass for example.

Embodiments of the method for rendering a map tile according to a stylesheet as described herein may be executed on one or more computer systems such as the map service which may interact with various other devices. One such computer system is illustrated by . In different embodiments computer system may be any of various types of devices including but not limited to a personal computer system desktop computer laptop notebook or netbook computer mainframe computer system handheld computer workstation network computer a camera a set top box a mobile device a consumer device video game console handheld video game device application server storage device a peripheral device such as a switch modem router or in general any type of computing or electronic device.

In the illustrated embodiment computer system includes one or more processors coupled to a system memory via an input output I O interface . Computer system further includes a network interface coupled to I O interface and one or more input output devices such as cursor control device keyboard and display s . In some embodiments it is contemplated that embodiments may be implemented using a single instance of computer system while in other embodiments multiple such systems or multiple nodes making up computer system may be configured to host different portions or instances of embodiments. For example in one embodiment some elements may be implemented via one or more nodes of computer system that are distinct from those nodes implementing other elements.

In various embodiments computer system may be a uniprocessor system including one processor or a multiprocessor system including several processors e.g. two four eight or another suitable number . Processors may be any suitable processor capable of executing instructions. For example in various embodiments processors may be general purpose or embedded processors implementing any of a variety of instruction set architectures ISAs such as the x86 PowerPC SPARC or MIPS ISAs or any other suitable ISA. In multiprocessor systems each of processors may commonly but not necessarily implement the same ISA.

In some embodiments at least one processor may be a graphics processing unit. A graphics processing unit or GPU may be considered a dedicated graphics client device for a personal computer workstation game console or other computing or electronic device. Modern GPUs may be very efficient at manipulating and displaying computer graphics and their highly parallel structure may make them more effective than typical CPUs for a range of complex graphical algorithms. For example a graphics processor may implement a number of graphics primitive operations in a way that makes executing them much faster than drawing directly to the screen with a host central processing unit CPU . In various embodiments the image processing methods disclosed herein may at least in part be implemented by program instructions configured for execution on one of or parallel execution on two or more of such GPUs. The GPU s may implement one or more application programmer interfaces APIs that permit programmers to invoke the functionality of the GPU s . Suitable GPUs may be commercially available from vendors such as NVIDIA Corporation ATI Technologies AMD and others.

System memory may be configured to store program instructions and or data accessible by processor . In various embodiments system memory may be implemented using any suitable memory technology such as static random access memory SRAM synchronous dynamic RAM SDRAM nonvolatile Flash type memory or any other type of memory. In the illustrated embodiment program instructions and data implementing desired functions such as those described above for embodiments of the method for rendering a map according to a stylesheet as described herein are shown stored within system memory as program instructions and data storage respectively. In other embodiments program instructions and or data may be received sent or stored upon different types of computer accessible media or on similar media separate from system memory or computer system . Generally speaking a computer accessible medium may include storage media or memory media such as magnetic or optical media e.g. disk or CD DVD ROM coupled to computer system via I O interface . Program instructions and data stored via a computer accessible medium may be transmitted by transmission media or signals such as electrical electromagnetic or digital signals which may be conveyed via a communication medium such as a network and or a wireless link such as may be implemented via network interface .

In one embodiment I O interface may be configured to coordinate I O traffic between processor system memory and any peripheral devices in the device including network interface or other peripheral interfaces such as input output devices . In some embodiments I O interface may perform any necessary protocol timing or other data transformations to convert data signals from one component e.g. system memory into a format suitable for use by another component e.g. processor . In some embodiments I O interface may include support for devices attached through various types of peripheral buses such as a variant of the Peripheral Component Interconnect PCI bus standard or the Universal Serial Bus USB standard for example. In some embodiments the function of I O interface may be split into two or more separate components such as a north bridge and a south bridge for example. In addition in some embodiments some or all of the functionality of I O interface such as an interface to system memory may be incorporated directly into processor .

Network interface may be configured to allow data to be exchanged between computer system and other devices attached to a network such as other computer systems or between nodes of computer system . In various embodiments network interface may support communication via wired or wireless general data networks such as any suitable type of Ethernet network for example via telecommunications telephony networks such as analog voice networks or digital fiber communications networks via storage area networks such as Fibre Channel SANs or via any other suitable type of network and or protocol.

Input output devices may in some embodiments include one or more display terminals keyboards keypads touchpads scanning devices voice or optical recognition devices or any other devices suitable for entering or retrieving data by one or more computer system . Multiple input output devices may be present in computer system or may be distributed on various nodes of computer system . In some embodiments similar input output devices may be separate from computer system and may interact with one or more nodes of computer system through a wired or wireless connection such as over network interface .

As shown in memory may include program instructions configured to implement embodiments of the method for rendering a map according to a stylesheet as described herein and data storage comprising various data accessible by program instructions . In one embodiment program instructions may include software elements of embodiments of the method for generating a map tile with features and identifiers and sending the map tile as illustrated in . Data storage may include data that may be used in embodiments. In other embodiments other or different software elements and data may be included.

Those skilled in the art will appreciate that computer system is merely illustrative and is not intended to limit the scope of the method for rendering a map according to a stylesheet as described herein. In particular the computer system and devices may include any combination of hardware or software that can perform the indicated functions including a computer personal computer system desktop computer laptop notebook or netbook computer mainframe computer system handheld computer workstation network computer a camera a set top box a mobile device network device internet appliance PDA wireless phones pagers a consumer device video game console handheld video game device application server storage device a peripheral device such as a switch modem router or in general any type of computing or electronic device. Computer system may also be connected to other devices that are not illustrated or instead may operate as a stand alone system. In addition the functionality provided by the illustrated components may in some embodiments be combined in fewer components or distributed in additional components. Similarly in some embodiments the functionality of some of the illustrated components may not be provided and or other additional functionality may be available.

Those skilled in the art will also appreciate that while various items are illustrated as being stored in memory or on storage while being used these items or portions of them may be transferred between memory and other storage devices for purposes of memory management and data integrity. Alternatively in other embodiments some or all of the software components may execute in memory on another device and communicate with the illustrated computer system via inter computer communication. Some or all of the system components or data structures may also be stored e.g. as instructions or structured data on a computer accessible medium or a portable article to be read by an appropriate drive various examples of which are described above. In some embodiments instructions stored on a computer accessible medium separate from computer system may be transmitted to computer system via transmission media or signals such as electrical electromagnetic or digital signals conveyed via a communication medium such as a network and or a wireless link. Various embodiments may further include receiving sending or storing instructions and or data implemented in accordance with the foregoing description upon a computer accessible medium. Accordingly the present invention may be practiced with other computer system configurations.

