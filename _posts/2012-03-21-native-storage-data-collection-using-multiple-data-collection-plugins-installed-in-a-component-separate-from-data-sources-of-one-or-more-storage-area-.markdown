---

title: Native storage data collection using multiple data collection plug-ins installed in a component separate from data sources of one or more storage area networks
abstract: A native data collection component may be implemented as a tool, appliance, application and/or utility, and including physical and/or logical implementations thereof. The native data collection component may be responsible for data orchestration, data collection, and aggregation and distribution of collected data from among multiple sources of a storage area network (SAN). The native data collection component is not required to be installed as an agent on any data source of the SAN, and the native data collection component may be independent of a particular data source and act as an independent performance characteristic collection mechanism. In an embodiment, the native data collection component may include three devices/sub-components: a data orchestration device, a data collection interface and a data aggregation and distribution device. Each sub-component may be service based and communication with each service may be done using state-less protocols.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09197522&OS=09197522&RS=09197522
owner: EMC Corporation
number: 09197522
owner_city: Hopkinton
owner_country: US
publication_date: 20120321
---
This application relates to storage area networks and more particularly to the field of data collection for storage management.

Host processor systems may store and retrieve data using storage devices also referred to as storage arrays containing a plurality of host interface units host adapters disk drives and disk interface units disk adapters . Such storage devices are provided for example by EMC Corporation of Hopkinton Mass. and disclosed in U.S. Pat. No. 5 206 939 to Yanai et al. U.S. Pat. No. 5 778 394 to Galtzur et al. U.S. Pat. No. 5 845 147 to Vishlitzky et al. and U.S. Pat. No. 5 857 208 to Ofek which are incorporated herein by reference. The host systems access the storage device through a plurality of channels provided therewith. Host systems provide data and access control information through the channels of the storage device and the storage device provides data to the host systems also through the channels. The host systems do not address the disk drives of the storage device directly but rather access what appears to the host systems as a plurality of logical volumes. Different sections of the logical volumes may or may not correspond to the actual disk drives.

SAN characteristics of the storage devices and or other elements of a storage area network SAN may be monitored according to different performance capacity topology and configuration data statistics and measures. SAN characteristics may include for example performance data capacity data discovery data including configuration data and or topology data among other characteristics. As an example performance characteristics of input output I O data paths among storage devices and components may be measured and may include I O operations initiated by a host will result in corresponding activity in SAN fabric links storage array ports and adapters and storage volumes measured in I Os per second and Megabytes per second. Other characteristics may similarly be measured. Such characteristics may be significant factors in managing storage system performance for example in analyzing use of lowering access performance versus more expensive higher performance disk drives in a SAN or by expanding number of SAN channels or channel capacity. Users may balance performance capacity and costs when considering how and whether to replace and or modify one or more storage devices or components.

Known performance characteristic collection techniques may include use of one or more agents installed on each of multiple sources in order to collect data for the multiple sources. For example virtual hosts e.g. hosts running as guest operating systems or virtual machines VM s may be created in a cluster of physical hosts which rely for I O transport on previously created or dynamically changing I O data paths. In various circumstances the use of such agents for data collection may be intrusive and require significant use of computing resources.

Accordingly it would be desirable to provide a system that may be advantageously used for data collection particularly in connection with providing a flexible data collection mechanism that may facilitate a standardized mechanism for data collection among multiple sources.

According to the system described herein a method for performing native data collection includes receiving a request for data collection. Characteristics for collection are identified according to the request. Using at least one processor a software structure is instantiated to collect identified data according to the characteristics identified from the request. Using the software structure the identified data is collected using a sharable communication interface that is usable to access data from multiple data sources that operate using different communication types. The request may be provided according to a policy in response to a triggering event. The identified data may be storage data of a storage area network. The characteristics may include performance data capacity data and or discovery data. The software structure may include least one out of a plurality of data collection plug ins. The plurality of data collection plug ins may include a performance data collection plug in a capacity data collection plug in and a discovery data collection plug in. The multiple data sources may be accessed via the sharable communication interface using at least one data communication plug in. The method may further include distributing the collected data responsive to the request.

According further to the system described herein a non transitory computer readable medium stores software for performing native data collection. The software includes executable code that receives a request for data collection. Executable code is provided that identifies characteristics for collection according to the request. Executable code is provided that instantiates a software structure to collect identified data according to the characteristics identified from the request. Executable code is provided that collects using the software structure the identified data using a sharable communication interface that is usable to access data from multiple data sources that operate using different communication types. The request may be provided according to a policy in response to a triggering event. The identified data may be storage data of a storage area network. The characteristics may include performance data capacity data and or discovery data. The software structure may include least one out of a plurality of data collection plug ins. The plurality of data collection plug ins may include a performance data collection plug in a capacity data collection plug in and a discovery data collection plug in. The multiple data sources may be accessed via the sharable communication interface using at least one data communication plug in. Executable code may further be provided that aggregates and distributes the collected data responsive to the request.

According further to the system described herein a system for performing native data collection includes at least one processor executing software on a computer readable medium. The software is executed to provide a data orchestration component that processes a received request data collection and schedules a data collection job according to characteristics identified from the request. The software further provides a data collection interface that collects data according to the data collection job wherein the data collection interface enables a software structure to collect identified data according to the characteristics identified from the request and wherein the data collection interface includes a sharable communication interface that is usable to access data from multiple data sources that operate using different communication types. The software is further executed to provide a data aggregation and distribution component that aggregates and distributes the collected data responsive to the request. The characteristics may include at least one of performance data capacity data or discovery data. The software structure may include at least one out of a plurality of data collection plug ins the plurality of data collection plug ins including a performance data collection plug in a capacity data collection plug in and a discovery data collection plug in.

In an embodiment the storage device may include one or more remote adapter units RA s . RA s may be used in connection with a Remote Data Facility RDF product produced by EMC Corporation that may be used to copy data from one storage device to another. For example if a host writes data to a first storage device e.g. a local storage device it may be desirable to copy that data to a second storage device provided in a different location e.g. a remote storage device . The RA s are coupled to a communication link and are similar to the HA s but are used to transfer data between the storage device and other storage devices that are also coupled to the communication link . The storage device may be coupled to additional communication links not shown in addition to the communication link . For further discussion of RDF and the use thereof in data recovery and storage techniques see for example U.S. Pat. No. 5 742 792 to Yanai et al. entitled Remote Data Mirroring and U.S. Pat. No. 7 779 291 to Yoder et al. entitled Four Site Triangular Asynchronous Replication which are incorporated herein by reference.

The storage device may also include one or more disks each containing a different portion of data stored on the storage device . Each of the disks may be coupled to a corresponding one of a plurality of disk adapter units DA that provides data to a corresponding one of the disks and receives data from a corresponding one of the disks . The disks may include any appropriate storage medium or mechanism including hard disks solid state storage flash memory etc. Note that in some embodiments it is possible for more than one disk to be serviced by a DA and that it is possible for more than one DA to service a disk. It is noted that the term data as used herein may be appropriately understood in various embodiments to refer to data files extents blocks chunks and or other designations that indicate a unit segment or collection of data.

The logical storage space in the storage device that corresponds to the disks may be subdivided into a plurality of volumes or logical devices. The logical devices may or may not correspond to the physical storage space of the disks . Thus for example the disk may contain a plurality of logical devices or alternatively a single logical device could span both of the disks . The hosts may be configured to access any combination of logical devices independent of the location of the logical devices on the disks . A device such as a logical device described above has a size or capacity that may be expressed in terms of device geometry. The device geometry may include device geometry parameters regarding the number of cylinders in the device the number of heads or tracks per cylinder and the number of blocks per track and these parameters may be used to identify locations on a disk. Other embodiments may use different structures.

One or more internal logical data path s exist between the DA s the HA s the RA s and the memory . In some embodiments one or more internal buses and or communication modules may be used. In some embodiments the memory may be used to facilitate data transferred between the DA s the HA s and the RA s . The memory may contain tasks that are to be performed by one or more of the DA s the HA s and the RA s and a cache for data fetched from one or more of the disks . Use of the memory is further described elsewhere herein in more detail. The storage device may be provided as a stand alone device coupled to the hosts as shown in or alternatively the storage device may be part of and or otherwise coupled to a storage area network SAN that may include a plurality of other storage devices as well as switches routers network connections etc. as further discussed elsewhere herein.

The diagram also shows an optional communication module CM that provides an alternative communication path between the directors . Each of the directors may be coupled to the CM so that any one of the directors may send a message and or data to any other one of the directors without needing to go through the memory . The CM may be implemented using conventional MUX router technology where a sending one of the directors provides an appropriate address to cause a message and or data to be received by an intended receiving one of the directors . Some or all of the functionality of the CM may be implemented using one or more of the directors so that for example the directors may be interconnected directly with the interconnection functionality being provided on each of the directors . In addition a sending one of the directors may be able to broadcast a message to all of the other directors at the same time.

In some embodiments one or more of the directors may have multiple processor systems thereon and thus may be able to perform functions for multiple directors. In some instances at least one of the directors having multiple processor systems thereon may simultaneously perform the functions of at least two different types of directors e.g. an HA and a DA . Furthermore in some embodiments at least one of the directors having multiple processor systems thereon may simultaneously perform the functions of at least one type of director and perform other processing with the other processing system. In addition the memory may be a global memory in which all or at least part of the global memory may be provided on one or more of the directors and shared with other ones of the directors . The memory may be part of a global memory distributed across the processor systems of more than one storage device and accessible by each of the storage devices.

Note that although specific storage device configurations are disclosed in connection with it should be understood that the system described herein may be implemented on any appropriate platform. Thus the system described herein may be implemented using a platform like that described in connection with or may be implemented using a platform that is somewhat or even completely different from any particular platform described herein.

A storage area network SAN may be used to couple one or more host devices with one or more storage devices in a manner that allows reconfiguring connections without having to physically disconnect and reconnect cables from and to ports of the devices. A storage area network may be implemented using one or more switches to which the storage devices and the host devices are coupled. The switches may be programmed to allow connections between specific ports of devices coupled to the switches. A port that can initiate a data path connection may be called an initiator port while the other port may be deemed a target port.

In various embodiments the system described herein may be used in connection with performance data collection associated with data migration and or data mirroring techniques using a SAN. Data transfer among storage devices including transfers for data migration and or mirroring functions may involve various data synchronization processing and techniques to provide reliable protection copies of data among a source site and a destination site. In synchronous transfers data may be transmitted to a remote site and an acknowledgement of a successful write is transmitted synchronously with the completion thereof. In asynchronous transfers a data transfer process may be initiated and a data write may be acknowledged before the data is actually transferred to directors at the remote site. Asynchronous transfers may occur in connection with sites located geographically distant from each other. Asynchronous distances may be distances in which asynchronous transfers are used because synchronous transfers would take more time than is preferable or desired. Examples of data migration and mirroring products include Symmetrix Remote Data Facility SRDF products from EMC Corporation.

For further discussion of techniques involving the configuration and use of storage area networks including virtual storage area networks reference is made for example to U.S. Pat. No. 8 028 062 to Wigmore et al. entitled Non Disruptive Data Mobility Using Virtual Storage Area Networks With Split Path Virtualization which is assigned to EMC Corporation and is incorporated herein by reference that discloses techniques for the creation of a SAN centric storage virtualization layer that allows data mobility and migration without disruption to one or more hosts servers attached to the SAN. Reference is also made to U.S. Pat. No. 7 441 023 to Benjamin et al. entitled Method and Apparatus for Modeling and Analyzing MPLS and Virtual Private Networks U.S. Pat. No. 7 720 003 to Benjamin et al. entitled Model Based Method and Apparatus for Determining MPLS Network Properties and U.S. Pat. No. 7 783 778 to Benjamin entitled Model Based Method and Apparatus for Determining Virtual Private Network Topologies which are assigned to EMC Corporation and are all incorporated herein by reference that disclose various techniques for discovering and identifying network properties and topologies in a network represented by a model.

The selection and or identification of the I O path may be performed according to multiple selection factors and using known path selection techniques. Reference is made for example to U.S. Pat. No. 7 688 753 to Zimran et al. entitled Selection of a Data Path Based on One or More Performance Characteristics of a Computer System which is assigned to EMC Corporation and is incorporated herein by reference and which discloses techniques for data path selection based on performance characteristics of a computer system using a path selection module. Reference is also made to U.S. Pat. No. 6 434 637 to D Errico entitled Method and Apparatus for Balancing Workloads Among Paths in a Multi Path Computer System Based on the State of Previous I O Operations which is assigned to EMC corporation and is incorporated herein by reference and which discloses techniques for selecting one of at least two I O data paths for transmission of the next PO operation based upon a state of previously assigned I O operations queued for transmission over the I O paths.

In various embodiments the component may be an application installed on an application host or other computer providing SAN administration and or management functionality and or may be implemented as a separate native data collection component functioning according to the features described herein. The system described herein may advantageously avoid the need for one or more data collection agents to be installed and deployed in order to collect storage data from multiple sources. In an embodiment the component may be used in connection with the ProSphere product produced by EMC Corporation that provides storage resource management functionality. Other storage management products that may be used in connection with the system described herein may include for example EMC Ionix products including the Ionix Unified Infrastructure Manager UIM . In an embodiment the statistics used by the component according to the system described herein may be gathered by the component according to the native data collection techniques discussed elsewhere herein.

Reference is made to U.S. patent application Ser. No. 13 335 316 to Lim et al. filed Dec. 22 2011 and entitled Path Performance Data Collection which is assigned to EMC Corporation and is incorporated herein by reference that discloses controlled tuning performance data collection provided through a single application controller of a path performance data collection tool and may be used in connection with the system described herein. The performance data collection may be turned on or off from the application host running the tool via a user interface. Lim s tool may automatically e.g. without user intervention update performance data collection characteristics as the application host I O data path changes according to user controlled settings but without requiring further user intervention during the updating. Turning on path performance data collection on the application host via the user interface may automatically set up synchronized performance data collection for all managed objects within an I O data path.

In various embodiments some data used in connection with the system described herein may obtained using other data collection devices and mechanisms including products produced by EMC Corporation such as the EMC Workload Analyzer WLA the Symmetrix Performance Analyzer SPA the Symmetrix CLI statistics collection daemon STP the Storage Configuration Advisor SCA and or the ProSphere Discovery Engine among other possible collection devices applications and or appliances. Reference is made for example to U.S. Pat. No. 6 622 221 to Zahavi entitled Workload Analyzer and Optimizer Integration which is assigned to EMC Corporation and is incorporated herein by reference and which discloses techniques used in connection with evaluating the performance of proposed device swap plans in accordance with past performance data collected.

As shown in the data orchestration device may be responsible for scheduling policy management and queue management for the data collection processing and include A policy management unit a scheduling unit and a queue management unit . The policy management unit may be an interface that enables customization for example by a user and or administrator of what data is to be collected and the manner in which the data is to be collected. For example policy management unit may enable the user administrator to define metrics objects and or groups of objects for the data collection. A policy may be defined as a textual representation of a collection from which the data collection framework may act upon. The policy may include a collection type a collection objective a collection start time a collection priority a collection interval and a collection end time. The scheduling unit may provide an interface for scheduling of data collection jobs including scheduling on a one time and or a recurring basis. The queue management unit may provide for control and management of the status of data collection jobs and performance of data collection jobs according to the appropriate policy. For example the queue manager may determine if a particular job can be run or not based upon defined priorities and the current queue stack.

The data collection interface may be responsible for controlling and managing collection of multiple data collection types. For example the data collection types may include performance data discovery data and capacity data. The data collection interface may control and manage the data collection types using software components such as plug ins that may be used to obtain data based on the job in which the collection type is invoked see e.g. .

The data aggregation and distribution device may be responsible for processing the information retrieved from the data collection interface and appropriately distributing the information. For example the information may be distributed to a persistent data store according to a policy. A data aggregation mechanism may obtain data from a data collection plug in and prepare the data for distribution A distribution mechanism may then provide the collected data to a requestor for example to an expectant consumer.

In various embodiments the communication interface enables data exchange according to various data collection types using multiple communication mechanisms protocols. Data communication plug ins may be used to communicate collected data to the data collection component using the communication interface . For example the data communication plug ins may include a Storage Management Initiative SMI communication plug in for data communication with SAN arrays switches and or other SAN components in connection with data collection. In an embodiment the performance data collection plug in may leverage the SMI communication type to mine and collect performance related SMI data. Capacity and discovery data may be similarly collected and leveraged using the corresponding plug ins. For example discovery data may be collected that includes discovered SAN components I O paths of discovered hosts whether the hosts are virtual e.g. running as guest operating system or a virtual machine VM or not the hosts IP addresses operating systems and versions thereof and or whether the host is in a group or cluster among other discovery data. Other data communication plug ins that may be used in connection with the communication interface include for example a Symmetrix Management Control Symmetrix Performance Analyzer SMC SPA plug in a Simple Network Management Protocol SNMP plug in an EMC Control Center ECC agent plug in and or other plug in .

It is further noted that the system described herein may be used in connection with simulation of data storage systems for evaluation purposes. For example simulated storage system configurations may be evaluated to determine preferred configurations and or identify potential problems of a possible I O data path and or elements thereof. Suitable data storage system simulation tools that may be used in connection with the system described herein may include systems and methods like that disclosed in U.S. Pat. No. 7 392 360 to Aharoni et al. entitled Method and System for Capacity Planning and Configuring One or More Data Storage Systems U.S. Pat. No. 7 292 969 to Aharoni et al. entitled Method and System for Simulating Performance on One or More Storage Systems and U.S. patent application Ser. No. 13 065 806 to Smirnov et al. filed Mar. 30 2011 entitled Write Pacing Simulation Tool which are all assigned to EMC Corporation and which are all incorporated herein by reference.

The SRM integration appliance may provide a collection request policy service that may control policy creation and or scheduling in connection with data collection triggering events. In various embodiments triggering events may include aspects of a SAN exceeding or falling below specified performance thresholds a data transmission disruption event and or a manual activation of a data collection request among other appropriate triggering events. A monitoring service may receive data collection results from the data collection appliance and a reporting managing service may control reporting and or managing functions of storage resources being managed by the SRM product. The data collection appliance may include services corresponding to the devices of the native data collection component discussed elsewhere herein including a data orchestration service a data collection interface service and an aggregation and distribution service . Collected data from the data collection appliance may be distributed to the monitoring service of the SRM integration appliance and or may be stored in persistent storage as controlled by a data storage service of the database appliance . Stored collection data may be used for example in connection with historical and or trend data collection reporting by the reporting managing service .

In the above performance data collection is instantiated with a performance data collection plug in and the policy myCollectionPolicy is realized as a policy object.

Both collection data types and communication types may be defined by the incoming policy. As shown in the figure data communication plug ins communicators may be similarly created using a shared communication framework . The data communication plug ins may be created using a shared communication factory and accessed using a shared communication interface . The data communication plug ins may include an SMI plug in an SPA plug in an SNMP plug in an EMC Control Center ECC agent plug in and or other appropriate plug in . In an embodiment an implementation pattern for the communication plug ins may follow a similar patterns as discussed in connection with the data collection plug ins specifically 

For example in the above noted the SMI collection plug in may communicate using Common Information Model CIM Extensible Markup Language XML with an SMI provider to obtain the collection data therefrom according to the policy. In another example the SPA plug in would communicate with an SPA instance using an appropriate protocol such as WS Launch which is a proprietary protocol. Accordingly the data collection service enables collection and communication processing to collect desired data according to the appropriate data collection and communication type.

The collected data may then be exposed for example using a data service RESTlet and may be either pushed to or pulled by an existing consumer service. It is noted that in an embodiment the system described herein may perform functions of Network Attached Storage NAS components in an advantageous and efficient way. For example NAS detection and discovery may be formed by the Data Collection Service using the SMI data collection communication interface plug in while need for a NAS Management Service may be avoided through use of the data collection interface discussed elsewhere herein.

The system described herein provides embodiments that perform native storage data collection processing in a flexible and efficient manner and provide multiple advantages. For example embodiments of the system described herein may provide end users with the ability to choose and manage different metric sets for data collection and at scheduled intervals. End users may be provided with the ability to collect data based on logical groupings. Collections may synchronized at particular times and end users may be provided with the ability to see collected metric data at periodic intervals. End users may be provided with the ability to obtain metrics using industry standard mechanisms and non industry standard mechanisms and may obtain metrics using both agent and agentless mechanisms End users may be provided with the ability to attach priorities using policies to particular data collection jobs. Performance data collection for I O data paths in a SAN is supported by the system described herein. Users may be able to identify host data paths of interest and collect data for hosts switches arrays and or other SAN components on the data paths at a desired scheduled frequency. The system enables collection and distribution of data for a particular request independent of the time sequence order of other collection requests.

Various embodiments discussed herein may be combined with each other in appropriate combinations in connection with the system described herein. Additionally in some instances the order of steps in the flowcharts flow diagrams and or described flow processing may be modified where appropriate. Further various aspects of the system described herein may be implemented using software hardware a combination of software and hardware and or other computer implemented modules or devices having the described features and performing the described functions. Software implementations of the system described herein may include executable code that is stored in a computer readable medium and executed by one or more processors. The computer readable medium may include a computer hard drive ROM RAM flash memory portable computer storage media such as a CD ROM a DVD ROM a flash drive and or other drive with for example a universal serial bus USB interface and or any other appropriate tangible or non transitory computer readable medium or computer memory on which executable code may be stored and executed by a processor. The system described herein may be used in connection with any appropriate operating system.

Other embodiments of the invention will be apparent to those skilled in the art from a consideration of the specification or practice of the invention disclosed herein. It is intended that the specification and examples be considered as exemplary only with the true scope and spirit of the invention being indicated by the following claims.

