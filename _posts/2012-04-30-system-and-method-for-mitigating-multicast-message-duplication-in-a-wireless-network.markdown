---

title: System and method for mitigating multicast message duplication in a wireless network
abstract: According to one embodiment of the invention, a method for mitigating duplication of multicast data streams to wireless client devices. The method comprises the operations of detecting, by one or more network devices, a multicast message, and controlling, by the one or more network devices, a forwarding of information within the multicast message to a network device handling multicast data transmissions. The forwarding is controlled based on information within the multicast message and the presence of such information in prior established data structure.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09356817&OS=09356817&RS=09356817
owner: ARUBA NETWORKS, INC.
number: 09356817
owner_city: Sunnyvale
owner_country: US
publication_date: 20120430
---
Embodiments of the present disclosure relate to the field of network communications and in particular a system and method for mitigating multicast message duplication caused by virtual local area network VLAN pooling in a wireless network such as a wireless local area network WLAN operating in accordance to the IEEE 802.11 Standard.

Currently it is common for enterprise networks to utilize virtual local area networks hereinafter referred to as VLANs . A VLAN is a group of client devices that are adapted to communicate as if these devices were connected to the same broadcast domain irrespective of their actual physically location. Configured through software rather than hardware VLANs provide flexibility as to allow a client device without any hardware reconfiguration to retain its membership on the same VLAN even though it is physically moved from one location to another.

VLAN pooling is an abstraction of the assignment of client devices to different VLANs. Currently one issue with VLAN pooling is that it may cause the transmission of duplicate multicast streams over a wireless shared media. In infrastructure mode when VLAN pooling is used wireless client devices for a particular Basic Service Set BSS which is identified by a specific BSS Identifier BSSID may be randomly allocated to one or more different VLANs. Hence wireless client devices on the same BSSID but assigned to different VLANs will likely receive duplicate multicast streams.

More specifically an upstream multicast router sends a copy of a multicast stream for each VLAN for which a wireless client device has registered to receive multicast packets. These duplicated multicast streams are routed to an access point AP of a targeted BSS for wireless transmission. As a result wireless client devices on the same BSSID and different VLANs will receive duplicate multicast streams for the same multicast group.

Based on current VLAN pooling operations it is quite possible for multiple client devices in the same multicast group to end up on different VLANs. In a worst case scenario for a VLAN pool with n VLANs the multicast router will provide n copies of multicast streams for transmission via the AP. Such duplication leads to a substantial increase in over the air channel utilization resulting in a waste of wireless spectrum.

In the following description several specific details are presented to provide a thorough understanding of the invention. While the context of the disclosure is directed to VLAN pooling stream control logic that is configured to mitigate multicast message duplication one skilled in the relevant art may recognize however that the concepts and techniques disclosed herein can be practiced without certain details such as the exclusion of one or more operations logic elements or the like.

Herein certain terminology is used to describe features for embodiments of the disclosure. For example the term network device generally refers to any device that includes logic configured to communicate with a network and or process information related to such communications. Different categories of network devices may include but are not limited or restricted to 1 a client device being any consumer electronics with wireless network connectivity e.g. tablet laptop desktop netbook television set top box video gaming control mobile handset with cellular and or wireless connectivity such as a smartphone personal digital assistant PDA etc. 2 an access point 3 a data control device e.g. network switch controller etc. 4 a multicast router or the like. Hence a wireless client device has wireless connectivity to the network.

It is contemplated that a network device includes hardware logic such as one or more of the following i processing circuitry ii one or more communication interfaces such as a radio e.g. component that handles the wireless data transmission reception and or a physical connector to support wired connectivity and or iii a non transitory computer readable storage media e.g. a programmable circuit a semiconductor memory such as a volatile memory such as random access memory RAM or non volatile memory such as read only memory power backed RAM flash memory phase change memory or the like a hard disk drive an optical disc drive etc. or any connector for receiving a portable memory device such as a Universal Serial Bus USB flash drive portable hard disk drive or the like.

Herein the term logic is generally defined as hardware and or software. For example as hardware logic may include processing circuitry e.g. a microcontroller any type of processor a programmable gate array an application specific integrated circuit etc. semiconductor memory combinatorial logic or the like. As software logic may be one or more software modules such as executable code in the form of an executable application an application programming interface API a subroutine a function a procedure an object method implementation an applet a servlet a routine a source code an object code a shared library dynamic load library or one or more instructions. These software modules may be stored in any type of a suitable non transitory storage medium described above or transitory computer readable transmission media e.g. electrical optical acoustical or other form of propagated signals such as carrier waves infrared signals digital signals .

The term interconnect is broadly defined as a logical or physical communication path such as for instance electrical wire optical fiber cable bus trace or a wireless channel using infrared radio frequency RF or any other wireless signaling mechanism. The term message constitutes a grouping of data which may be placed in the form of a packet a stream e.g. a sequence of packets a frame an Asynchronous Transfer Mode ATM cell or any other series of bits having a prescribed format.

Lastly the terms or and and or as used herein are to be interpreted as an inclusive or meaning any one or any combination. Therefore A B or C or A B and or C mean any of the following A B C A and B A and C B and C A B and C. An exception to this definition will occur only when a combination of elements functions steps or acts are in some way inherently mutually exclusive.

Certain details are set forth below in order to provide a thorough understanding of various embodiments of the disclosure albeit the invention may be practiced through many embodiments other that those illustrated. Well known logic and operations may not be set forth in detail in order to avoid unnecessarily obscuring this description. Moreover the illustrated embodiments of the disclosure and the description associated therewith should be considered as examples of the principles of the invention and not intended to limit the disclosure to those specific embodiments. It should be understood that this disclosure covers all modifications equivalents and alternatives falling within the spirit and scope of the present disclosure.

Referring to a general block diagram of a network supporting multiple Basic Service Set Identifiers BSSIDs along with virtual local area network VLAN pooling is shown. As described VLAN pooling is an abstraction of the assignment of client devices to different VLANs which may be managed by a network device implemented within network infrastructure such as a controller an access point or another type of network device.

Herein network infrastructure is a collection of network devices that are adapted to support communications with one or more network devices e.g. client device . The components formulating network infrastructure may vary depending on the selected network architecture. For example according to one embodiment of the disclosure network infrastructure is implemented with VLAN pooling stream control logic that mitigates multicast message duplication over a wireless medium. This reduction in multicast message duplication is accomplished by using a single unique identifier for each VLAN pool and controlling the exchange of messages between network devices within network infrastructure as described below.

More specifically as an illustrative embodiment a first network device within network infrastructure is implemented with VLAN pooling stream control logic which is configured to select a unique identifier for each VLAN pool. Each unique identifier referred to herein as the Primary VLAN is a VLAN identifier VLAN ID for one of a plurality of VLANs forming that VLAN pool. As all VLANs forming the VLAN pool are now mapped to their corresponding Primary VLAN first network device receives a single multicast message for transmission to wireless client devices within a particular BSSID even though these client devices are on different VLANs.

Furthermore after configuration of infrastructure network in which a Primary VLAN is assigned to each VLAN pool and such mapping is stored first network device also controls a process for routing control messages used by a second network device to formulate and maintain multicast group memberships. These control messages may include a request to join a particular multicast group e.g. JOIN message or a request to leave a particular multicast group e.g. LEAVE message . First network device suppresses the routing of JOIN and or LEAVE messages in accordance with forwarding decision processes described below.

Until now VLAN pooling management has failed to avoid duplication of multicast messages to those wireless client devices that belong to the same BSSID but are members of different VLANs. However by configuring first network device to associate a single unique VLAN ID e.g. the Primary VLAN to a corresponding VLAN pool and controlling upstream routing of the incoming JOIN and or LEAVE messages multicast message duplication can be mitigated.

For instance according to one embodiment of the disclosure illustrated in where network is a wireless local area network WLAN network infrastructure comprises one or more access points APs N 1 that are coupled to a controller and a multicast router over an interconnect . Herein AP is configured to establish communications with wireless network devices within its coverage area such as wireless client device M 1 for example.

Controller comprises VLAN pooling stream control logic that is configured to monitor for certain types of messages received by AP from wireless client devices and in various situations extract information from these messages for controlling wireless delivery of multicast messages. These types of monitored messages may include but are not limited or restricted to signaling that includes an Internet Group Management Protocol IGMP JOIN message an IGMP LEAVE message a Multicast Listener Discovery MLD JOIN message a MLD LEAVE message or the like.

For instance as shown in according to one embodiment of the disclosure message comprises one or more wireless frames where each wireless frame is configured in accordance with a wireless communication standard such as the Institute of Electrical and Electronics Engineers IEEE 802.11 Standard for example. More specifically frame comprises a header a payload and a frame check sequence FCS .

More specifically header includes address fields that are adapted to include a BSSID . BSSID identifies the BSS in which the wireless client device of resides. BSSID may be extracted from message by a network device within network infrastructure .

Furthermore besides BSSID a multicast group address may be extracted from an IGMP message encapsulated within payload of frame . IGMP message includes a type field that identifies if the IGMP message is a JOIN or LEAVE message and a group address field for containing multicast group address .

Referring to both using BSSID network infrastructure is able to ascertain the Primary VLAN that established during a configuration stage for network infrastructure represents the VLAN pool supported by BSSID . By collecting BSSID the Primary VLAN and multicast group address network infrastructure is able to determine whether incoming information should be used to populate one or more data structures that are accessed by controller in controlling upstream and or downstream messaging with multicast router . For instance based on the stored contents within the data structure s controller determines whether incoming message should be routed upstream to multicast router .

Multicast router is a network device that is responsible for transmitting multicast data streams to targeted Primary VLANs. To accomplish such transmissions multicast router would be adapted with a client membership table not shown that features a plurality of fields for each entry. These fields may include but are not limited or restricted to Primary VLAN multicast group address message type version and port number.

Referring now to another exemplary block diagram of network supporting VLAN pooling is shown. Herein in lieu of relying on a separate controller to monitor for JOIN and or LEAVE messages from client devices as shown in the functionality of controller is integrated into at least AP . Therefore adapted with VLAN pooling stream control logic AP monitors for JOIN and or LEAVE messages from client devices and upon detecting such messages AP extracts data to populate data structures that are relied upon to control upstream downstream routing of multicast related messages. These data structures include but are not limited or restricted to a Primary VLAN table and a Multicast VLAN table as described below.

Referring to another detailed exemplary block diagram of network supporting VLAN pooling is shown. Herein in lieu of relying on a separate multicast router to transmit multicast streams to client devices the functionality of multicast router is integrated into controller . Therefore adapted with VLAN pooling stream control logic controller monitors for certain types of messages e.g. JOIN and LEAVE messages from client devices . Upon detecting such messages controller extracts data to populate data structures that are relied upon to control the routing of outgoing multicast messages.

Referring to an exemplary diagram of a network device with functionality for mitigation and perhaps elimination of multicast message duplication for VLAN pooling is shown. Herein network device e.g. controller AP etc. comprises VLAN pooling stream control logic . According to one embodiment of the invention VLAN pooling stream control logic includes processing circuitry and memory which are coupled to one or more interfaces that enable network device to communicate with other network devices. For instance interface may be implemented as a physical interface including one or more ports for wired connectors. Additionally or in the alternative interface may be implemented as an antenna unit for transmitting and or receiving wireless signals from other network devices.

As shown in according to one embodiment of the disclosure processing circuitry is coupled to memory for execution of VLAN control logic which is stored in memory . VLAN control logic comprises a first module configured to control the selection of a Primary VLAN associated with each VLAN pool hereinafter referred to as Primary VLAN Selection module and one or more modules configured to control forwarding decisions for certain types of messages e.g. JOIN and or LEAVE messages received by network device as described below. As shown a JOIN Forwarding Decision module and a LEAVE Forwarding Decision module may be deployed as part of VLAN control logic . Also VLAN control logic comprises an Acquisition Primary VLAN APV module that acquires the Primary VLAN as described below.

Referring to during network configuration one or more data structures are formulated to create a logical mapping between a BSSID and a Primary VLAN selected as a representative VLAN ID for a VLAN pool. According to one embodiment of the disclosure this logical mapping is provided through a plurality of data structures namely a first data structure and a second data structure . These data structures and are illustrated as tables but it is contemplated that other data structure formats may be used.

Stored in memory and illustrated in first data structure hereinafter referred to as VLAN Pool name table is populated during initial configuration of network device in order to maintain a mapping between multiple BSSIDs supported by the network and a set of configuration parameters associated with each BSSID. For instance a first entry of data structure includes a first BSSID BSSID 1 along with a set of configuration parameters Parameters corresponding to BSSID 1. One of the configuration parameters includes a VLAN pool name  which is the alphanumeric name or data representative of the name assigned to a VLAN pool supported by BSSID 1. Hence VLAN Pool name table enables network device after extracting BSSID 1 from a JOIN or LEAVE message received from a client device to determine the VLAN pool name.

Also stored in memory and illustrated in second data structure is populated during device configuration in order to maintain a mapping between a VLAN pool name e.g. VLAN pool name and a Primary VLAN e.g. VLAN ID  associated with VLAN pool name . The pseudo code outlining the selection of the Primary VLAN from VLANs within a corresponding VLAN pool identified by the VLAN pool name and describing operations performed by Primary VLAN Selection module of during execution is set forth below in Table 1.

Herein three types of data structures are used for Primary VLAN selection. These data structures include a VLAN pool represented as a sorted array of VLAN IDs P a flag for the VLAN pool being represented as a Boolean F and an intermediate VLAN pool being represented as a sorted array of VLAN IDs T .

Furthermore each flag is assigned a state from among a plurality of states. For illustrative purposes the states for each flag include the following i E Exclusive ii I Intersection iii S Subset and iv O Overlap. An order of priority for the flag states is defined in the increasing order E 

The priority state assigned to the flag identifies what action is to be taken after a comparison is performed on the contents within two different VLAN pools. For this illustrative embodiment these actions include 1 E keep the original set of VLAN IDs 2 I remove intersecting VLAN IDs 3 S keep the subset of VLAN IDs and 4 O keep the overlap set of VLAN IDs.

Referring to an exemplary flow diagram of a process conducted for selecting the Primary VLAN for a VLAN pool is illustrated. Initially as set forth in operation various parameters are initialized. For instance for computation purposes temporary VLAN pools T are created and set to be equivalent to their corresponding VLAN pools. Also a first flag Fi is set to an Exclusive state E while a counter j is set to 1 .

As set forth in operation count values are adjusted to selectively control the comparisons between different temporary VLAN pools T T to ensure that comparisons are conducted for all combinations of temporary pools T . . . and T For instance where the total number of VLAN pools is equal to three N 3 temporary VLAN pool comparison is performed as follows T2 is compared to T1 T3 is compared to T1 and T2 is compared to T3.

More specifically the Primary VLAN selection process involves a determination as to whether a first count value j exceeds the total number N of VLAN pools operation . If so the Primary VLAN selection process ends. However if the first count value j is less than or equal to N a second count value i is set to 1 and compared to a decremented first count value j 1 as illustrated in operations and . These count value adjustments are used to control which temporary VLAN pools T T are compared and the updating of their flags Fi Fj as set forth in operations and .

If i j 1 an iteration is performed in which j is incremented operation and operations are repeated. However where j N and i j 1 a comparison is conducted between the two temporary pools T T and flags corresponding to these temporary pools are set to a state based on the comparison operations and .

If a flag Fi associated with temporary pool T is set to I which denotes that VLAN pool Tpossesses common VLAN IDs when compared with VLAN pool T the intersecting VLAN IDs are removed from the VLAN pool T operations and . If flag Fi is not set to I state any VLAN IDs for VLAN pool Tthat are a subset of Tare removed from VLAN pool T operation . The same operations are repeated for comparison from a perspective of VLAN pool T operations and .

Thereafter the second count value i is incremented operation and the process repeats starting at operation . This process continues until all combination of temporary VLAN pools e.g. T T T have been compared. Based on such a comparison any unique VLAN ID remaining for each temporary VLAN pool may be selected as the Primary VLAN operation .

In the event that there are multiple VLAN IDs remaining as part of a temporary VLAN pool according to one embodiment of the disclosure a first VLAN ID from the temporary VLAN pool is selected. According to another embodiment the last VLAN ID from the temporary VLAN pool is selected. According to other embodiments the VLAN ID having the highest or lowest VLAN ID is selected as the Primary VLAN. According to yet another embodiment of the disclosure the Primary VLAN may be randomly selected provided that each VLAN ID is unique for that VLAN pool.

In order to better understand the operations set forth in an illustrative example will be analyzed to determine Primary VLANs for three VLAN pools P Pand P . Herein as there are three VLAN pools N is equal to 3 so that j will range in value from 1 to 3 while i will range in value from 1 to j 1 .

Herein each of the exemplary VLAN pools P P and P include VLANs which are identified by VLAN IDs represented by a simple numerical value 1 7 for illustrative purposes. As set forth in the Venn diagram of there are seven VLANs in which some of these the VLANs are in multiple VLAN pools 

After temporary VLAN pools T T Tare created to be identical to VLAN pools P P P for an initial iteration j 1 i 1 of the Primary VLAN selection process being performed by processing circuitry the first count value j is incremented. Now j is set to 2 and the computational iterations are performed. Between computational iterations it is contemplated that operations may be performed for adjusting the count values i j .

For the first computational iteration j 2 i 1 the computations resulting from a comparison of T Tare set forth below.

In comparing Tto T it is determined that VLAN Pool Tpossesses some VLAN IDs 6 7 that are included in VLAN Pool Tand other VLAN IDs 1 2 3 that are not included in VLAN Pool T. Hence the priority state of flag F1 is set to I as there is an intersection. In response to F1 being set into an I state the intersecting VLAN IDs are removed and thus VLAN pool Twill be set as 1 2 3 for any subsequent iterations.

Similarly in comparing Tto T it is determined that all VLAN IDs 6 7 within VLAN Pool Tare included in VLAN Pool T1 2 3 6 7. Hence the priority state of flag F2 is set to S as VLAN Pool Tis a subset of VLAN pool T. The resultant action performed by the Primary VLAN selection process is to keep the subset of VLAN IDs so VLAN pool Tremains as 6 7.

For the second computational iteration j 3 i 1 the computations resulting from a comparison of T Tare the following 

In comparing Tto T it is determined that VLAN Pool Tpossesses some VLAN IDs 3 that are included in VLAN Pool T1 2 3 while other VLAN IDs 4 5 6 7 are not included in VLAN Pool T. Hence the priority state of flag F3 is set to I as there is an intersection. The action is for removal of intersecting VLAN IDs so VLAN pool Twill be set as 4 5 6 7.

Similarly in comparing Tto T it is determined that VLAN Pool Tpossesses a VLAN ID 3 that is included in VLAN Pool Tand other VLAN IDs 1 2 are not included in VLAN Pool T. Hence the priority state of flag F1 remains at I as there is an intersection. The action is for removal of intersecting VLAN IDs so VLAN pool Twill be set as 1 2 for any subsequent iterations.

For the third computational iteration j 3 i 2 the computations resulting from a comparison of T Tare the following 

In comparing Tto T it is determined that current VLAN Pool Tpossesses some VLAN IDs 6 7 that that are included in VLAN Pool Tand other VLAN IDs 4 5 are not included in VLAN Pool T. Hence the priority state of flag F3 remains at I as there is an intersection. The action is for removal of intersecting VLAN IDs so VLAN pool Twill be set as 4 5 for the next iteration if necessary.

Similarly in comparing Tto T it is determined that all VLAN IDs 6 7 within VLAN Pool Tare included in VLAN Pool T4 5 6 7. Hence the priority state of flag F2 is set to S as VLAN Pool Tis a subset of VLAN pool T. The action is to keep the subset of VLAN IDs so VLAN pool Tremains as 6 7.

Therefore for a next iteration j N i.e. all comparisons of the temporary VLAN pools have been conducted one Primary VLAN is selected from each temporary VLAN pool according to whichever selection process is chosen. For instance if the lowest VLAN ID remaining for a particular temporary VLAN pools T T T is used the Primary VLAN for VLAN pool Pis selected as VLAN ID 1 . Similarly the Primary VLANs for VLAN pools Pand Pare selected as VLAN ID 6 and VLAN ID 4 respectively.

Referring now to network device generates and populates a third data structure during operation when network device monitors messages received by one or more APs for JOIN or LEAVE messages. This data structure is represented in a table format and thus is referred to herein as the Multicast VLAN table. Of course other formats besides a table may be used.

From these JOIN and LEAVE messages Multicast VLAN table is populated to provide a mapping between the multicast group address and its corresponding BSSID and Primary VLAN as shown in a first entry . With Primary VLAN representing a VLAN pool the Group BSSID duplet is created for determining whether to further populate the Multicast VLAN table . An additional field Num Members maintains a count value to record the number of multicast group members for a particular Group BSSID duplet.

Referring to an exemplary flow diagram of the operations for formulating and maintaining VLAN pooling with reduced multicast message duplication is shown. For clarity the operations will be described in accordance with the network infrastructure set forth in although deviations from such operations may be conducted depending on the network infrastructure selected.

Initially a network device with VLAN pooling stream control logic monitors the receipt of certain ingress messages with a selected multicast management protocol such as IGMP MLD or the like operation . For instance upon detecting receipt of a JOIN message e.g. IGMP JOIN message MLD JOIN message etc. the network device performs an Acquisition Primary VLAN APV process as shown in operations and .

More specifically as illustrated in the JOIN message includes a BSSID that is used to obtain a VLAN pool name using VLAN Pool name table of operation . VLAN Pool name table provides a mapping between the BSSID and a corresponding VLAN pool name supported by the BSSID. From the VLAN pool name a Primary VLAN is determined using Primary VLAN table as shown in operation . Herein Primary VLAN table provides a mapping between VLAN pool name and a corresponding Primary VLAN selected for that particular VLAN pool.

Returning back to the network device performs a lookup of the Multicast VLAN table of using the Primary VLAN fetched as well as the BSSID and multicast group address extracted from the incoming wireless message including the IGMP JOIN message operations and . As further set forth in this collection of information namely a multicast group address G and its corresponding Primary VLAN PV and BSSID B referred to herein as a G PV B triplet is part of the operations performed by the Join Forwarding decision module of .

Referring now to the network device first determines if Multicast VLAN table includes an entry with information matching the G PV B triplet associated with the incoming JOIN message operation . If an entry is uncovered the count value in NUM Members field for that entry is incremented and the JOIN message is discarded operations and . For example the JOIN message is not forwarded to the multicast router.

If the network device determines that Multicast VLAN table does not feature an entry with information that matches the G PV B triplet a second determination is made whether Multicast VLAN table includes an entry with information that matches the multicast group address G and the Primary VLAN PV as illustrated in operation . The collection of the multicast group address and the Primary VLAN is referred to as a G PV duplet .

If a match is detected the JOIN message is discarded so that this message is not forwarded to the multicast router operation however if a match is not detected the JOIN message is forwarded to the multicast router operation . A new entry is created in Multicast VLAN table that includes the Primary VLAN PV the BSSID B the multicast group address G along with the count value in Num Members field being set to 1 operation .

Returning back to if the network device determines that the ingress message is a LEAVE message operations and the network device performs the Acquisition Primary VLAN APV process as shown in in order to retrieve the Primary VLAN as previously described operation .

Thereafter the network device performs a lookup of Multicast VLAN table of using the Primary VLAN PV fetched as well as the BSSID B and multicast group address G included in the wireless message having the IGMP LEAVE message operations and . This lookup using this G PV B triplet is part of the operations performed by the Leave Forwarding Decision LFD module of and illustrated in .

Referring now to the network device determines if the Multicast VLAN table includes an entry with information matching the G PV B triplet operation . If an entry match is detected the count value in Num Members field for that entry is decremented and a determination is made whether the count value is equal to 0 operations and .

If the count value in Num Members field is not equal to 0 the LEAVE message is discarded operations . As a result the LEAVE message would not be forwarded to the network device controlling multicast transmissions.

If the count value in Num Members field is equal to 0 the entry within the Multicast VLAN table is removed operation . Furthermore the network device determines whether Multicast VLAN table includes an entry with information matching the multicast group address G and the Primary VLAN PV operation . If a match of the G PV duplet is detected the LEAVE message is discarded and therefore would not be forwarded to the multicast router operation . Otherwise the LEAVE message is forwarded to the multicast router operation .

Referring to an exemplary embodiment of a network deploying VLAN pooling stream control logic within controller that controls the routing of JOIN and or LEAVE messages is shown. Herein network comprises controller a multicast router and a plurality of APs . These network devices are equivalent to controller multicast router and APs of for illustrative purposes. Other architectures as shown in may be deployed with similar operations.

Herein a first AP is in communications with a first client device which belongs to a first VLAN V1 and a first BSS B1 . Hence for ease of reference first client device may be represented a client 1 V1 B1 . First AP also is in communications with a second client device belonging to a third VLAN V3 and second BSS B2 thereby represented as client 2 V3 B2 and a third client device belonging to first VLAN V1 and first BSS B1 represented as client 3 V1 B1 .

Similarly second AP is in communications with a client 4 V2 B4 a client 5 V2 B4 and client 6 V2 B4 . Third AP is in communication with a client 7 V3 B7 client 8 V1 B7 and client 9 V2 B7 .

According to one embodiment of the disclosure when a wireless client device on a particular BSSID and VLAN wishes to join a multicast group Gx it sends a JOIN message to an AP associated with the wireless circuit device. For this illustrative network infrastructure the AP routes the JOIN message or information from the JOIN message upstream to controller . Controller obtains a VLAN pool name using the BSSID Bz and subsequently learns the Primary VLAN PVy for the VLAN pool and executes the JOIN Forwarding Decision module.

Herein controller checks if an entry with information identical to the multicast group address Gx Primary VLAN PVy and BSSID Bz exists namely the Gx PVy Bz triplet . If no entry exists with the Gx PVy Bz triplet controller adds an entry with Gx PVy and Bz into the Multicast VLAN table and sets count value within Num Members field to 1 and thereafter determines if an entry within the Multicast VLAN table exists for Gx and PVy namely the Gx PVy duplet. If no entry exists with the Gx PVy duplet the JOIN message or information contained in the JOIN message is forwarded to the network device controlling multicast transmissions e.g. multicast router . Otherwise if an entry exists with the Gx PVy duplet the JOIN message is discarded and not forwarded to multicast router .

In contrast if an entry exists with the Gx PVy Bz triplet controller increments a count value within the Num Members field for that entry of the Multicast VLAN table. The JOIN message or information within the JOIN message is discarded and not forwarded to multicast router .

As shown in when wireless client device on VLAN V1 wishes to join a first multicast group G1 wireless client device sends a JOIN message to AP1 . AP1 routes information associated with the JOIN message upstream to controller . Based on pre configuration of controller in populating VLAN Pool name table and Primary VLAN table of the Primary VLAN PV1 for that BSSID B1 is retrieved. Thereafter the JOIN Forwarding Decision module is executed whereby controller forwards the JOIN message or information within the JOIN message such as multicast group address G1 and BSSID B1 to multicast router and populates a new entry within Multicast VLAN table .

As shown in when wireless client device C2 on VLAN V3 wishes to join a second multicast group G2 it sends a JOIN message to AP1 . AP1 routes information G2 B2 associated with the JOIN message upstream to controller . Using BSSID B2 the Primary VLAN PV1 may be retrieved and thereafter controller executes the JOIN Forwarding Decision module to create a new entry in Multicast VLAN table as there is no entry that matches the G2 PV1 B2 triplet. Thereafter upon determining that there is no other entry within Multicast VLAN table that matches the G2 PV1 duplet controller forwards the JOIN message or information within the JOIN message such as multicast group address G2 and BSSID B2 to multicast router .

As shown in when wireless client device C3 on VLAN V1 wishes to join the first multicast group G1 it sends a JOIN message to AP1 . AP1 routes information associated with the JOIN message G1 B1 upstream to controller . BSSID B1 is used to retrieve the Primary VLAN PV1 for that BSSID. Controller analyzes contents of Multicast VLAN table and executes the JOIN Forwarding Decision module. Since entry exists by virtue of Client C1 previously requesting membership to multicast group address G1 the count value in Num Members field associated with entry is incremented and the JOIN message is not forwarded to multicast router .

As shown in wireless client device C4 on a second VLAN V2 wishes to join the first multicast group G1 and transmits a JOIN message to AP2 . AP2 routes information associated with the JOIN message upstream to controller . Using BSSID B4 the Primary VLAN PV2 for the VLAN pool supported by BSSID B4 is retrieved. Controller analyzes the Multicast VLAN table and executes the JOIN Forwarding Decision module. Hence as no entry exists in the Multicast VLAN table that features the G1 PV2 B4 triplet a new entry is added to the Multicast VLAN table with its Num Members field being set to 1 . As no other entry features the G1 PV2 duplet the Join message is forwarded to multicast router and a new entry within Multicast VLAN table is populated.

As shown in when wireless client device C5 on second VLAN V2 wishes to join the first multicast group G1 it sends JOIN message to AP2. AP2 routes the information associated with the JOIN message upstream to controller . After using BSSID B4 in order to fetch the Primary VLAN V2 for the VLAN pool. Controller executed the Join Forward Decision module that performs an analysis of the contents within the Multicast VLAN table. Hence upon determining that entry exists that matches the G1 PV2 B4 triplet the count value in the Num Members field for entry is incremented and the JOIN message is not forwarded to multicast router .

As shown in when wireless client device Client C6 on second VLAN V2 wishes to join the first multicast group G1 it sends JOIN message to AP2. AP2 routes the information associated with the JOIN message upstream to controller . After using BSSID B4 in order to fetch the Primary VLAN V2 for the VLAN pool. Controller executed the Join Forward Decision module that performs an analysis of the contents within the Multicast VLAN table. Hence upon determining that entry exists that matches the G1 PV2 B4 triplet the count value in the Num Members field for entry is incremented and the JOIN message is not forwarded to multicast router .

As shown in when the wireless client device C7 on third VLAN V3 wishes to join the second multicast group G2 it sends JOIN message to AP3. AP3 routes information associated with the JOIN message upstream to controller . After using BSSID B7 in order to fetch the Primary VLAN V1 for the VLAN pool controller executed the Join Forward Decision module that performs an analysis of the contents within the Multicast VLAN table. Hence upon determining that no entry currently exists as there is no match for this particular G2 PV1 B7 triplet a new entry within Multicast VLAN table is created and the count value of the Num Members field for entry is set to 1 . However since an entry already exists for the G2 PV1 duplet the JOIN message is not forwarded to multicast router .

As shown in when wireless client device C8 on first VLAN V1 wishes to join the second multicast group G2 it sends JOIN message to AP3. AP3 routes the information associated with the JOIN message upstream to controller . After using BSSID B7 in order to fetch the Primary VLAN V1 for the VLAN pool controller executed the Join Forward Decision module that performs an analysis of the contents within the Multicast VLAN table. Hence upon determining that entry already exists the count value in the Num Members field for entry is incremented and thereafter the JOIN message is not forwarded to multicast router .

As shown in when wireless client device C9 on the second VLAN V2 wishes to join the first multicast group G1 it sends a Join message to AP3. AP3 routes the information associated with the JOIN message upstream to controller . After using BSSID B7 in order to fetch the Primary VLAN V1 for the VLAN pool controller executed the Join Forward Decision module that performs an analysis of the contents within the Multicast VLAN table. Upon determining that a corresponding entry G1 PV1 B7 triplet in the Multicast VLAN table does not exist a new entry is added with its Num Members field being set to 1 . However since entry already exists for the G1 PV1 duplet the JOIN message is not forwarded to multicast router .

According to one embodiment of the disclosure when a wireless client device on a particular BSSID and VLAN wishes to leave a multicast group Gx it sends a LEAVE message to its AP. For this network infrastructure the AP sends information associated with the LEAVE message upstream to controller . Controller obtains a VLAN pool name using the BSSID Bz from the LEAVE message and subsequently learns the Primary VLAN PVy for the VLAN pool and executes the LEAVE Forwarding Decision module.

Herein controller confirms an entry in the Multicast VLAN table with information identical to the multicast group address Gx Primary VLAN PVy and BSSID Bz exists. Thereafter controller decrements the count value within the Num Members field. If the count value is equal to zero the entry is removed from the Multicast VLAN table. Thereafter the controller determines if a second entry within the Multicast VLAN table exists for the Gx PVy duplet Gx PVy . If no entry exists with the Gx PVy duplet the LEAVE message or information contained in the LEAVE message is forwarded to the network device controlling multicast transmissions e.g. multicast router . Otherwise if an entry exists with the Gx PVy duplet the LEAVE message is discarded and not forwarded to multicast router .

As shown in when wireless client device C2 on the third VLAN V3 wishes to leave the second multicast group G2 it sends a LEAVE message to AP1. AP1 routes the information associated with the LEAVE message upstream to controller . After using BSSID B2 in order to fetch the Primary VLAN PV1 for the VLAN pool controller executed the Leave Forward Decision module that performs an analysis of the contents within the Multicast VLAN table. Upon determining that entry in Multicast VLAN table exists and the Num Members field 0 after decrementing the entry is removed from the Multicast VLAN table. However since entry already exists for the G2 PV1 duplet the LEAVE message is not forwarded to multicast router .

As shown in when wireless client device C4 on the second VLAN V2 wishes to leave the first multicast group G1 it sends a LEAVE message to AP2. AP2 routes the information associated with the LEAVE message upstream to controller . After using BSSID B4 in order to fetch the Primary VLAN PV2 for the VLAN pool controller executes the Leave Forward Decision module that performs an analysis of the contents within the Multicast VLAN table.

Upon determining that entry in Multicast VLAN table exists and the count value for the Num Members field is equal to 2 after decrementing entry remains within the Multicast VLAN table and the LEAVE message is not forwarded to multicast router .

As shown in when wireless client device C5 on the second VLAN V2 wishes to leave the first multicast group G1 it sends a LEAVE message to AP2. AP2 routes the information associated with the LEAVE message upstream to controller . After using BSSID B4 in order to fetch the Primary VLAN PV2 for the VLAN pool controller executes the Leave Forward Decision module that performs an analysis of the contents within Multicast VLAN table .

Upon determining that entry in Multicast VLAN table exists and after decrementing the count value for the Num Members field is equal to 1 entry remains within Multicast VLAN table and the LEAVE message is not forwarded to multicast router .

As shown in when wireless client device C6 on the second VLAN V2 wishes to leave the first multicast group G1 it sends a LEAVE message to AP2. AP2 routes the information associated with the LEAVE message upstream to controller . After using BSSID B4 in order to fetch the Primary VLAN PV2 for the VLAN pool controller executes the Leave Forward Decision module that performs an analysis of the contents within Multicast VLAN table .

Upon determining that entry in Multicast VLAN table exists and the count value of Num Members field is now equal to 0 after decrementing entry is removed from Multicast VLAN table . Thereafter a determination is performed as to whether Multicast VLAN table includes an entry with a G1 PV2 duplet. Since no other entry features this duplet the LEAVE message is forwarded to multicast router .

Referring to upon a network device such as controller of for example receiving a multicast data stream from an upstream network device e.g. multicast router of network device determines which BSSID is applicable to multicast data stream . This determination may be accomplished using Multicast VLAN table of .

More specifically network device receives multicast data stream that is directed to a targeted Primary VLAN e.g. Primary VLAN PV1 and thereafter determines which entries within Multicast VLAN table feature targeted Primary VLAN . Since Multicast VLAN table is optimized so that each entry if having the same multicast group Gx and Primary VLAN PVy requires a different BSSID Bz the lookup effectively operates as a mapping of the multicast stream to all associated BSSIDs. As a result if Multicast VLAN table contains multiple entries for a given multicast group and Primary VLAN network device replicates multicast data streams for each of these BSSIDs for subsequent transmission to wireless client devices within these specific BSS.

For instance continuing the illustrative example as shown in by considering Multicast VLAN table having the contents as shown in upon receiving a multicast data stream for multicast group G1 that is directed to a first Primary VLAN PV1 network device having access to this Multicast VLAN table would determine that there are two entries and directed to PV1. As shown entry is associated with a first BSSID B1 while entry is associated with a seventh BSSID B7 . Hence the multicast data stream would be replicated for transmission of two multicast data streams with one multicast data stream directed to a first BSSID B1 and the other multicast data stream directed to a seventh BSSID B7 . This multicast forwarding technique ensures that wireless client devices do not receive duplicate multicast streams when in the same BSSID but are associated with different VLANs.

It is to be understood that the above description is intended to be illustrative and not restrictive. Many other embodiments will be apparent to those of skill in the art upon reading and understanding the above description. The scope of the invention should therefore be determined with reference to the appended claims along with the full scope of equivalents to which such claims are entitled.

