---

title: Trusted internal interface
abstract: An interface and device architecture for a payment device. An interface between a payment application installed in a payment device and one or more value-add applications (such as loyalty programs, transit applications, etc.) that are also installed in the payment device. The API or interface design permits communications and data transfer between the payment application and one or more value-add applications. This reduces (and in some cases may prevent) the need for back-end server processing of data that may be relevant to both a payment transaction and to a function of the value-add application. Similarly, the same or another API or interface may enable communications and data transfer between a value-add application and the payment application.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09092769&OS=09092769&RS=09092769
owner: Visa International Service Association
number: 09092769
owner_city: San Francisco
owner_country: US
publication_date: 20121024
---
This application is a continuation application of and claims priority to U.S. Non Provisional application Ser. No. 13 149 553 filed May 31 2011 which claims priority to U.S. Provisional Application No. 61 350 719 filed Jun. 2 2010 the entire disclosures of which are incorporated herein by reference for all purposes.

Embodiments of the present invention are directed to systems apparatuses and methods for conducting payment transactions and more specifically to an internal interface for chip cards and other payment devices such as mobile phones that may include a payment application to enable communication and data transfer between the payment application and other applications installed on the card or device. Embodiments of the invention permit loyalty transit and other value add applications installed on a payment card or payment device to exchange data with the payment application directly instead of relying upon remote back end data processing support.

Consumer payment devices such credit cards debit cards or contactless chips embedded in other devices are used by millions of people worldwide to facilitate various types of commercial transactions. In a typical transaction involving the purchase of a product or service at a merchant location the payment device is presented at a point of sale terminal POS terminal located at a merchant s place of business. A consumer may also initiate a payment transaction by providing payment data from a remote location to a merchant over a network such as the Internet. Transactions of this type are typically initiated using a computing device such as a personal computer or laptop computer. Transactions may also be initiated by using a mobile device such as a cell phone or personal data assistant PDA that communicates with a merchant or service provider directly or indirectly over a wireless network. Transactions in which the consumer is not in the same physical location as a merchant and hence where a payment device is not physically presented to the merchant are termed card not present transactions.

A consumer payment device such as a smart card contactless chip embedded in another device or mobile phone typically utilizes a payment application to enable a consumer to conduct payment transactions. In addition to the payment application the payment device may also include one or more other applications such as loyalty program applications transit applications etc. These applications may provide a consumer with other desired functionality such as the ability to utilize a transit system or manage their loyalty account with a hotel car rental agency etc. In some situations interaction or data exchange between the payment application and one of the other applications may be needed to update a counter process a purchase or exchange of loyalty points as part of a transaction provide payment for use of a transit system etc. In current payment devices the resident applications are independent and such interactions or data exchanges typically require remote processing by a back end server operated by an appropriate entity such as the operator of the transit system or manager of a loyalty program . This is inefficient and can cause delays in the processing of transactions if multiple remote data processing operations are required to complete a transaction.

What is desired are a system apparatus and method for enabling communication and data transfer between the applications installed in a payment device specifically between a payment application and another installed application or functional element. Embodiments of the invention address these problems and other problems individually and collectively.

Embodiments of the present invention are directed to a system apparatus and method for enabling the communication and secure transfer of data between applications installed in a payment device such as a smart card mobile phone or device with an embedded chip. The present invention permits the local i.e. within the payment device transfer of data between applications installed in the payment device by providing one or more interfaces between an installed payment application and each additional application. This permits data to be transferred between the payment application and additional applications and also the transfer of data between the payment application additional applications and devices and networks that can access those applications. Embodiments of the present invention provide a secure mechanism for the exchange of data between a payment application and multiple value add applications that are also installed in a payment device. Embodiments of the present invention also provide a mechanism for the sharing of transaction data and value add application data between the payment network and one or more value add application networks this may enable new products and services for consumers and provide additional opportunities for data mining by other entities of those networks.

In some embodiments the invention relates to an interface between a payment application installed in a payment device and one or more value add applications such as loyalty programs transit applications etc. that are also installed in the payment device. The invention consists of an API or interface design that permits communications and data transfer between the payment application and one or more value add applications. This reduces and in some cases may prevent the need for back end server processing of data that may be relevant to both a payment transaction and to a function of the value add application. Similarly the same or another API or interface may enable communications and data transfer between a value add application and the payment application. Use of the application may enable a payment processor or other entity responsible for managing the payment application to extend the data processing services it provides to the value add applications and the operators of certain value add programs. This may enable new service or products for consumers as well as more efficient transactions in which payment transaction data and value add application data are utilized.

Other objects and advantages of the present invention will be apparent to one of ordinary skill in the art upon review of the detailed description of the present invention and the included figures.

The included Appendix to this application is to be considered part of the present application and is incorporated by reference in its entirety for all purposes.

Embodiments of the present invention are typically implemented in the context of a payment transaction system and specifically in the context of a payment device used to conduct a payment transaction. In embodiments of the present invention an exemplary payment device may include but is not limited to a smart card that includes an embedded chip a mobile device such as a phone or key fob that includes an embedded chip a contactless chip embedded in a suitable portable device etc. In a typical payment transaction a consumer provides a payment account or payment device identifier to a merchant or service provider. According to an embodiment the payment account or payment device identifier may be provided in the form of a card e.g. a smart card with an embedded chip that communicates with a point of sale terminal or device reader using a contact or contactless mode or payment account information may be provided using a mobile phone or similar device in which is embedded a chip that functions or enables the device to function as a payment device.

Embodiments of the present invention permit the local i.e. within the payment device transfer of data between applications installed in the payment device by providing one or more interfaces between an installed payment application and each additional value add application installed in the device. This permits data to be transferred between the payment application and additional value add applications and also the transfer of data between the payment application additional value add applications and devices and networks that can access those applications. Embodiments of the present invention facilitate use of the payment device to conduct payment and value add transactions in a manner that is convenient for the consumer while enabling an issuer payment processor or other entity that manages the payment application to exchange data with value add operators that manage value add applications.

For example during a payment transaction a value add application that is installed on the mobile device and that is managed by a value add operator may provide value add data to a payment application that is also installed on the mobile device and that is conducting the payment transaction. The value add data may be passed from the value add application to the payment application via a trusted interface that couples the applications. Upon receiving the value add data the payment application may transmit the value add data together with payment data via a payment processing network to a payment processor issuer or other entity that manages the payment application. Thus the payment processor issuer or other entity that manages the payment application receives value add data from the value add application by way of the trusted interface that couples the payment application to the value add application on the payment device instead of having to integrate its backend system with the backend system of the value add operator. Also for example during a value add transaction the payment application may provide payment data to a value add application via a trusted interface that couples the payment application to the value add application. The value add application may then transmit via a proprietary value add network the payment data together with value add data to a value add operator such as a transit or loyalty program operator which may then send the payment data together with value add data to an issuer. According to an embodiment upon receiving payment data from the payment application the payment application may authorize the payment transaction offline. In this case the value add application would not need to send the payment data to value add operator and or the issuer and could instead send only clearing information. For example clearing records as defined in BASE II may be forwarded to the issuer to settle the payment.

An example will now be provided in which a value add application installed on a payment device requests payment data from a payment application that is also installed on the payment device and that is communicatively coupled to the value add application via a trusted interface. Upon request from the value add application the payment application transmits payment data to the value add application via the trusted interface. Then the value add application sends the payment data to the value add operator via the value add operator s proprietary network. Thus the value add application obtains payment data directly from the payment application within the payment device without the need of backend integration.

According to this example the value add application is a transit application managed by a transit operator. The transit application may be for example a CALYPSO or MIFARE application that is implemented as a Java applet and loaded onto the payment device. When boarding a bus or train a transit rider presents the payment device to a transit ticket validator on the bus or at a transit gate thereby activating the transit application on the payment device and causing the transit application to engage the transit ticket validator in a ticket transaction e.g. near field communication technology may be used to facilitate communication between the payment device and the transit ticket validator . During the ticket transaction the transit application on the payment device requests payment data e.g. authorization request cryptogram ARQC primary account number PAN etc. from the payment application on the payment device. The payment application sends the payment data to the transit application via the trusted interface. The transit application then sends the payment data together with transit data to the transit ticket validator which sends the payment data and the transit data to the transit operator via a proprietary transit network. Thus the proprietary transit network is used to send payment data in addition to transit data to the transit operator. The transit operator may then use the payment data to request a payment transaction. For example the transit operator can request a payment transaction by sending the payment data to an acquirer bank which sends the payment data to the appropriate issuer bank through a payment processing network.

Further according to this example the payment transaction may be performed offline authorized by the payment application within the payment device. In the case of an offline payment the transit application would not need to send the payment data to transit system via the transit validator but could instead send only the clearing information e.g. clearing records as defined in BASE II . The transit system may then forward the clearing information to the issuer to settle the payment. Transit applications such as MIFARE have enough proprietary fields and can pass data minimally required to perform authorization and clearing. Such fields include the payment amount PAN ED and ARQC. An offline payment indicates that the offline counters should be reported to the issuer for pre authorized solutions.

Another example will now be provided. In this example a payment application installed on a payment device requests value add data from a value add application that is also installed on the payment device and that is communicatively coupled to the payment application via a trusted interface. Upon request from the payment application the value add application transmits value add data to the payment application via the trusted interface. Then the payment application sends the value add data together with payment data to a payment processing network which may send the data to an issuer bank an acquirer bank the value add operator etc. Thus the payment application obtains value add data directly from the value add application within the payment device and the payment processing network is used to transmit value add data in addition to payment data. This eliminates the need for backend integration.

According to this example the value add application installed on the payment device is a transit application that is managed by a transit operator. In operation when a transit rider wants to purchase a transit ticket the transit rider presents the payment device to an acceptance device such as a point of sale terminal of the transit operator and thereby causes the payment application of the payment device to activate and initiate a payment transaction with the acceptance device of the transit operator e.g. near field communication technology may be used to facilitate communication between the payment device and the acceptance device . During such payment transaction the payment application which is installed on the payment device requests ticketing data from the transit application which is also installed on the payment device. Upon receiving ticketing data from the transit application the payment application sends the ticketing data together with payment data to the acceptance device of the transit operator which sends the payment data together with the ticketing data to the payment processing network. Thus the payment processing network is used to transmit ticketing data as well as payment data. The ticketing data may be sent through the payment processing network in the form of IDD Issuer Discretionary Data . Further for example the data may be sent via the payment processing network to the transit operator either directly or via an issuing bank.

Yet another example will now be provided. In this example a payment application installed on a payment device sends payment transaction data to a value add application that is also installed on the payment device and that is communicatively coupled to the payment application via a trusted interface. The value add application then makes a value add calculation based on the payment transaction data and sends value add data which includes the results of the calculation to the payment application via the trusted interface. Then the payment application sends the value add data together with payment data to a payment processing network which may send the data to an issuer bank an acquirer bank the value add operator etc.

According to this example the value add application is a loyalty application that is managed by a loyalty operator such as an airline retail store etc. In operation when a consumer uses the payment device to purchase an item or service e.g. airline ticket item from retail store etc. that is subject to the loyalty program associated with the loyalty application the consumer presents the payment device to an acceptance device such as a point of sale terminal and thereby causes the payment application of the payment device to initiate a payment transaction with the acceptance device e.g. near field communication technology may be used to facilitate communication between the payment device and the acceptance device . During the payment transaction the payment application which is installed on the payment device sends payment transaction data e.g purchase amount item SKU numbers etc. to the loyalty application which makes a loyalty calculation e.g applies loyalty points to transaction etc. . The loyalty application then sends via the trusted interface loyalty data which includes the results of the loyalty calculation to the payment application. The payment application then sends the loyalty data together with payment data to the acceptance device which sends the payment data together with the loyalty data to the payment processing network. Thus the payment processing network is used to transmit loyalty data as well as payment data. The payment processing network may send the data to an issuer bank which sends the data to the loyalty operator. This reduces the amount of effort needed for integration of backend systems.

Prior to discussing the specific embodiments of the invention a further description of some terms can be provided for a better understanding of embodiments of the invention.

A Payment Processing Network may include data processing subsystems networks and other means of implementing operations used to support and deliver authorization services exception file services and clearing and settlement services for payment transactions. An exemplary Payment Processing Network may include VisaNet. Payment Processing Networks such as VisaNet are able to process credit card transactions debit card transactions and other types of commercial transactions. VisaNet in particular includes a VIP system Visa Integrated Payments system which processes transaction authorization requests and a Base II system which performs transaction clearing and settlement services.

An Acquirer is typically a business entity e.g. a commercial bank that has a business relationship with a particular merchant.

An Issuer is typically a business entity e.g. a bank which issues a payment device such as a credit or debit card to a consumer. Some entities may perform both Issuer and Acquirer functions.

A Payment Account may include any suitable account that holds funds that may be withdrawn transferred or otherwise used to make payments. Examples of Payment Accounts include checking accounts deposit accounts etc.

 Payment Data may include data that provides information about a payment account. Examples of payment data include a payment account numbers routing transit numbers balance information transaction data PIN data communication protocol data for use in point of sale environments etc.

A Payment Device may include is a device that a user may use to conduct a payment transaction. Examples of payment devices include debit cards credit cards smart cards mobile devices such as mobile phones and other suitable devices.

A Payment Application may be an application that is installed on a payment device and that enables a user to make a payment for a transaction where the transaction is wholly or partially conducted using the payment device. According to some embodiment a payment application installed on a payment device enables the payment device to function as an electronic wallet for commerce transactions.

A Value Add Application may be any application installed on a payment device and designed to help a user to perform singular or multiple related specific tasks. Examples of value add applications may include a transit application that provides a user with the ability to use a transit system a loyalty program application that provides a user with the ability to manage a loyalty account with an issuer a hotel an airline a car rental agency any suitable entity that has or is affiliated with a loyalty program etc.

An Interface may be hardware and or software that enables interaction between two or more components. An example interface includes an application programming interface API that facilitates interaction between different software programs.

An External Communications Network may be any network know in the art and may use any networking technology known in the art to transmit data. Examples of external communication networks include wide area networks local area networks personal area networks wireless networks cellular networks payment processing networks etc. Examples of network technology include Near Field Communication NFC technologies Transmission Control Protocol Internet Protocol TCP IP Ethernet Fiber Distributed Data Interface FDDI token bus or token ring networks.

A Transit Application may be any suitable application that provides a user with the ability to use or otherwise interact with a transit system. For example a transit application may be installed on a payment device and enable a user to purchase and redeem transit rides. Accordingly in some embodiments the transit application installed on a payment device along with a payment application enable the payment device to function as both an electronic wallet for commerce transactions and as a transit system token for access to transit services.

A Transit Acceptance Network may be any suitable network configured to among other things collect and redeem transit fare. A transit acceptance network for example may collect and redeem transit fare via card not present transactions contactless payment transactions card swipe transactions etc. For example the transit acceptance network may include transit acceptance devices or terminals that collect fare from riders payment devices via contactless payment transactions and card swipe transactions.

A transit operator may be an entity such as a municipality municipal corporation or any other company authority or organization that operates a transit system.

 Transit information may include data relevant to transit systems and services. Examples of transit data may include access control data keys passwords identification data or data required for fare calculations rates historical data on system use fare amounts trip counters etc.

A Loyalty Program may include any program that rewards loyal purchasing behavior. For example such programs may include marketing programs that enable a user to acquire credits points through purchasing products and services and redeem those credits points to reduce the costs purchases to receive discounts rebates or refunds to receive awards gifts statuses benefits etc.

A Loyalty Application may be any suitable application that provides a user with the ability to use one or more loyalty programs. For example a loyalty application may be installed on a payment device and enable a user to acquire and redeem loyalty points credits using the payment device.

 Loyalty Information may include any suitable data that may be relevant to a loyalty program. Examples of such information include loyalty points loyalty credit loyalty value loyalty program rules terms and conditions discounts rebates or refunds to receive awards gifts statuses benefits etc.

A Loyalty Operator may be an entity that operates manages or administers or is otherwise involved in the operation management or administration of a loyalty program. Examples of loyalty operators include supermarkets airlines restaurants issuers retailers hotels etc.

The portable payment device is presented to a device reader or point of sale POS terminal which is able to access data stored on or within the payment device. In embodiments the portable payment device communicates account payment data to the merchant via a card not present transaction over a communications network such as a cellular network the Internet etc. The account data as well as any required consumer data is communicated to the merchant and ultimately to the merchant s transaction data processing system . As part of the authentication or authorization process performed by the merchant merchant transaction processing system may access merchant database which typically stores data regarding the customer consumer user as the result of a registration process with the merchant for example the consumer s payment device and the consumer s transaction history with the merchant. Merchant transaction processing system typically communicates with acquirer which manages the merchant s accounts as part of the overall authentication or authorization process. Merchant transaction processing system and or acquirer provide data to payment processing network which among other functions participates in the clearance and settlement processes that are part of the overall transaction processing.

Communication and data transfer between merchant transaction processing system and payment processing network is typically by means of an intermediary such as acquirer . As part of the consumer authentication or transaction authorization process payment processing network may access account database which typically contains information regarding the consumer s account payment history chargeback or transaction dispute history credit worthiness etc. Payment processing network communicates with issuer as part of the authentication or authorization process where issuer is the entity that issued the payment device to the consumer and manages the consumer s account. Customer or consumer account data is typically stored in customer consumer database which may be accessed by Issuer as part of the authentication authorization or account management processes. Note that instead of or in addition to being stored in account database consumer account data may be included in or otherwise part of customer consumer database .

In standard operation an authorization request message is created during a consumer purchase of a good or service at a point of sale POS using a portable payment device. In some embodiments the portable payment device may be a wireless phone or personal digital assistant that incorporates a contactless card or chip. The contactless card or chip may communicate with the point of sale terminal using a near field communications NFC capability. The authorization request message is typically sent from the device reader POS terminal through the merchant s data processing system to the merchant s acquirer to a payment processing network and then to an issuer . An authorization request message can include a request for authorization to conduct an electronic payment transaction and data relevant to determining if the request should be granted. For example it may include one or more of an account holder s payment account number currency code sale amount merchant transaction stamp acceptor city acceptor state country etc. An authorization request message may be protected using a secure encryption method e.g. 128 bit SSL or equivalent in order to prevent unauthorized access to account or transaction data.

After the Issuer receives the authorization request message the Issuer determines if the transaction should be authorized and sends an authorization response message back to the payment processing network to indicate whether or not the current transaction is authorized. The payment processing system then forwards the authorization response message to the acquirer. The acquirer then sends the response message to the merchant. The merchant is thus made aware of whether the Issuer has authorized the transaction and hence whether the transaction can be completed.

At a later time a clearance and settlement process may be conducted by elements of the payment transaction processing system depicted in . A clearance process involves exchanging financial details between an Acquirer and an Issuer to facilitate posting a transaction to a consumer s account and reconciling the consumer s settlement position. Clearance and settlement can occur simultaneously or as separate processes.

Payment processing network may include a server computer. A server computer is typically a powerful computer or cluster of computers. For example the server computer can be a large mainframe a minicomputer cluster or a group of servers functioning as a unit. In one example the server computer may be a database server coupled to a web server. Payment processing network may use any suitable combination of wired or wireless networks including the Internet to permit communication and data transfer between network elements. Among other functions payment processing network may be responsible for ensuring that a consumer is authorized to conduct a transaction via an authentication process confirm the identity of a party to a transaction e.g. via receipt of a personal identification number confirm a sufficient balance or credit line to permit a purchase or reconcile the amount of a purchase with the consumer s account via entering a record of the transaction amount date etc. .

The payment device may take one of many suitable forms. As mentioned above the portable payment device can be a mobile device that incorporates a contactless element such as a chip for storing payment data e.g. a BIN number account number etc. and a near field communications NFC data transfer element such as an antenna a light emitting diode a laser etc. The portable payment device may also include a keychain device such as the Speedpass commercially available from Exxon Mobil Corp. etc. The device containing the contactless card or chip or other data storage element may be a cellular mobile phone personal digital assistant PDA pager transponder or the like. The portable payment device may also incorporate the ability to perform debit functions e.g. a debit card credit functions e.g. a credit card or stored value functions e.g. a stored value or prepaid card .

In embodiments of the invention that include a contactless element e.g. a contactless chip and near field communications data transfer element embedded within a wireless mobile phone or similar device the contactless element can communicate with a merchant s device reader or point of sale terminal using a short range communication method such as a NFC technologies. Examples of such NFC technologies or similar short range communications technologies include ISO standard 14443 RFID Bluetooth and Infra red communications methods.

Mobile payment device further includes a contactless element typically implemented in the form of a semiconductor chip. Contactless element may include a secure data storage element although secure data storage element may also be implemented as a separate element from contactless element . Contactless element includes a near field communications NFC data transfer e.g. data transmission element such as an antenna or transducer. As will be described the near field communications capability permits a device reader or point of sale terminal to exchange data with or perform operations on contactless element as part of or in preparation for a payment transaction. In some embodiments contactless element may be embedded within and integrated with the elements of mobile payment device . In such a case data or control instructions may optionally be transmitted via cellular network and be exchanged with or applied to contactless element by means of interface . In that situation the interface functions to permit the exchange of data and or control instructions between mobile device circuitry and hence the cellular network and contactless element . Thus contactless element may include data storage capability in the form of a memory or secure data storage that may be accessed via a near field communications capability or interface to permit the implementation of data read write and erase functions for example.

Secure data storage may be used by mobile payment device to store operating parameters or other data utilized in the operation of the device. Secure data storage may also be used to store other data for which enhanced security is desired for example transaction data personal account data identification data authentication data access control data for an application or device function etc. As mentioned secure data storage may be implemented in the form of a chip that is separate and apart from contactless element or alternatively may be a section of memory in a chip that forms part of contactless element . Note also that the secure data storage and or contactless element contained within the mobile payment device may be a removable element or may be integrated within the mobile device. Examples of removable elements include SIM cards flash memory cards and other suitable devices.

Mobile payment device may include a payment application and one or more value add applications where the payment application is coupled to the value add application s by trusted interface s . Although one payment application one value add application and one trusted interface are illustrated it should be appreciated that any number of these components may be provided. The payment and value add applications and and the trusted interface may be implemented in the form of one or more of software firmware or hardware. According to an embodiment the payment application may enable a consumer to make a payment for a transaction where the transaction is wholly or partially conducted using the mobile device . The value add applications may represent processes or operations that are dedicated to functions that provide added value for the consumer and which are not part of the standard operation of the mobile device i.e. not part of enabling the standard telephony functions for example .

The payment application which may be VMPA Visa Mobile Payment Application can validate a DDA like signature from the value add applications in each transaction where a payment transaction is required. Thus the payment application validates that the value add application is trusted and then provides the necessary payment data such as PAN ED amount and ARQC to the value add application. According to an embodiment the value add application is a transit application such as MIFARE and is configured to send payment data using its proprietary fields and proprietary transit network which has an interface with an acquirer that sends the payment data to an issuer. If the issuer declines the payment then the transit operator adds the payment device to a black list.

The value add application may be for example a transit application that enables consumers to use a transit system. For example the transit application may enable consumers to use the mobile payment device to purchase manage and redeem transit rides. Also for example the value add application may be a loyalty program application that enables consumers to manage a loyalty program. For example the loyalty program application may enable consumers to acquire manage and or redeem loyalty points credits.

As shown in the payment application may exchange data with the value add application s via the trusted interface s . Further the payment and value add applications and may exchange information with the secure data storage via interface and may also be capable of exchanging data with mobile device circuitry . In such an example the secure data storage may contain authentication data consumer identification data transaction record data account balance data etc. The payment and value add applications and are typically stored as a set of executable instructions in memory which may also include data storage . A processor accesses memory to load and unload the instructions and data as needed to execute the instructions to perform the functions of the applications.

Contactless element is capable of transferring and receiving data using data transfer element which implements a near field communications capability typically in accordance with a standardized protocol or data transfer mechanism e.g. ISO 14443 NFC . Near field communications capability is a short range communications capability such as RFID Bluetooth infra red or other data transfer capability that can be used to exchange data between the mobile device and a device reader which is typically located at a merchant or a value add operator . For example the device reader may be a point of sale terminal at a merchant an acceptance device at value add operator such as a transit system a loyalty program operator etc. Thus in some embodiments mobile device is capable of communicating and transferring data and or control instructions via both cellular and near field communications capability . It should also be appreciated that the mobile device is capable of communicating and transferring data and or control instructions over any suitable wired or wireless network. For example the mobile device may be connected to the Internet via a WiFi network for the purpose of communicating and transferring data and or control instructions over the Internet.

The system further includes acquirer which is in communication with merchant value add operator . The acquirer is in communication with payment processing network and as was described may exchange data with payment processing network as part of the transaction authorization process. The payment processing network is also in communication with issuer . As was described the issuer may exchange data with the payment processing network as part of an authentication transaction authorization or transaction reconciliation process.

The system may also include a mobile gateway which is capable of coupling the cellular wireless network or system to a second network typically a wireline network such as the Internet and enabling the transfer of data between the networks. The mobile gateway may perform data processing operations as needed to permit the efficient transfer of data between the two types of networks including but not limited to data reformatting or other processing to take into account differences in network protocols. The mobile gateway may also perform data processing operations to enable more efficient data transfer between the networks and devices coupled to each type of network such as for purposes of improving the ability of a consumer to utilize the received data on a mobile device. As shown in the figure in some embodiments the mobile gateway is coupled to the payment processing network which is coupled to the acquirer . Note that other embodiments are possible such as where the mobile gateway is coupled to the issuer as well as where the acquirer is coupled to issuer and or the merchant value add operator . Similarly issuer may include the capability of functioning as the mobile gateway .

The system provides among other things a way for a consumer to conduct a payment transaction during which the payment application exchanges data with the value add application s via the trusted interface s . This reduces and in some cases may prevent the need for back end server processing of data that may be relevant to both a payment transaction and to a function of the value add application. As will be described use of the system may enable a payment processor such as the payment processing network or other entity such as the issuer responsible for managing the payment application to extend the data processing services it provides to the value add application s and the operators such as transit systems and loyalty program operators of certain value add programs. This may enable new services or products for consumers as well as more efficient transactions in which payment transaction data and value add application data are utilized.

In embodiments of the present invention the mobile payment device may include a contactless element capable of communication and data transfer using a near field communication system. As noted one example is a mobile wireless phone equipped with a NFC capability or other short range communications technology. is a functional block diagram illustrating the primary components of a mobile device e.g. element of such as a mobile phone that may be used as part of the inventive system and method. As illustrated in the mobile device may include circuitry that is used to enable certain telephony and other device functions. The functional elements responsible for enabling those functions may include a processor for executing instructions that implement the functions and operations of the device. The processor may access data storage or another suitable memory region or element to retrieve instructions or data used in executing the instructions. Data input output elements may be used to enable a user to input data via a microphone or keyboard for example or receive output data via a speaker for example . Display may also be used to output data to a user. Communications element may be used to enable data transfer between the device and a wireless network via antenna for example to assist in enabling telephony and data transfer functions. As described with reference to the device may also include contactless element interface to enable data transfer between contactless element and other elements of the device where the contactless element may include a secure memory and a near field communications or other short range communications data transfer element. The contactless element may implement a near field communications or other short range communications capability that enables communication and data transfer between the device and a device reader or POS terminal that is part of a payment transaction processing system.

The data storage may be a memory that stores data and may be in any suitable form including a memory chip etc. The memory may be used to store payment data such as user identification or authentication information user account information transaction data etc. Stored payment data may also include information such as bank payment account information bank identification number BIN credit or debit card account number information account balance information expiration date consumer information such as name date of birth etc. The memory may also be used to store value add data such as transit data and loyalty program data. Such transit data may include for example transit account information trip counters fare conversion information account balance information etc. Such loyalty program data may include loyalty account information loyalty points credits account balance loyalty program rules terms and conditions user preferences etc. Note that such data may instead or also be stored in a secure data storage element such as secure data storage of or a similar secure memory that is part of contactless element . As described data storage may also contain instructions which when executed by the processor implement operations or processes that are part of the operation of the device or of applications installed on the device.

A payment application and one or more value add applications are installed on the payment device . One or more value add interfaces are installed on the payment device for coupling the payment application to the value add applications . According to an embodiment one value add interface is provided for each value add application installed on the payment device . According to the illustrated embodiment the value add applications are stored in data store . When a payment transaction is required the payment transaction may be performed offline by the payment application within the payment device or the payment application may send payment data e.g ARQC and PAN through a merchant acceptance device e.g. a transit ticket validator to the merchant e.g. a transit operator which can then get online authorization. The data store may be for example the secure data storage element or of the mobile payment device or the data storage of the mobile payment device of respectively. The merchant includes a payment application configured to receive payment data and value add data from the payment application of the payment device via a payment interface .

According to an embodiment the payment application of the merchant is installed on an acceptance device or terminal that is associated with the merchant and that collects payment data and value add data from the payment device via contactless payment transactions and card swipe transactions. According to this embodiment the payment interface may be a contactless element interface such as contactless element of which functions to permit the exchange of data and or control instructions between the payment application of the payment device and the payment application of the merchant .

According another embodiment the payment application of the merchant is installed on an application server that is provided in communication with a network such as the network e.g. a wireless network or the Internet and or the payment processing network of . According to this embodiment the payment interface may be configured to permit the exchange of data and or control instructions between the payment application of the payment device and the payment application of the merchant over a network such as the Internet where the payment device is located in a remote location relative to the merchant. In transactions of this type the payment device may be a cell phone personal data assistant PDA or a personal computer that communicates with a merchant directly or indirectly over the network. These types of transactions where the consumer is not in the same physical location as a merchant and hence where a payment device is not physically presented to the merchant are sometimes referred to as mobile and or card not present transactions.

As illustrated in the payment application of the merchant is configured to send both payment data and value add data to a payment network such as the payment processing network of .

As shown in at the payment device is presented to the merchant . According to an embodiment at a consumer presents the payment device to a device reader or point of sale POS terminal of the merchant . The payment device may be a mobile device that includes a contactless element such as a contactless chip. Typically the consumer presents the mobile device to the device reader or POS terminal as part of providing data to initiate or participate in a payment transaction. According to another embodiment at a consumer may present the payment device to the merchant by engaging the merchant in a mobile payment transaction over a cellular network or the Internet or some other type of card not present transaction.

At presentation of the payment device activates or launches the payment application installed on the payment device and the payment application of the payment device begins to transact with the payment application of the merchant . According to an embodiment activation of the payment application may be accomplished by causing communication between a device reader or POS terminal of the merchant and the payment device . For example such activation may occur as the result of the device reader or POS terminal transferring data or a command to the payment device such as by performing the equivalent of a key or softkey activation either automatically or in response to a consumer selecting a payment application icon on a device reader or POS terminal screen for example. According to another embodiment activation of the payment application may be accomplished by causing communication between the payment application of the merchant and the payment application of the payment device in the course of a mobile payment transaction over a cellular network or the Internet or some other type of card not present transaction.

Note that the activation of the payment application at this stage is optional and may be implemented at a different stage in the process . Further depending upon the operation of the process depicted in activation of the payment application may or may not be required in order to implement one or more of the other stages of the overall process. For example in some embodiments the payment application may need to be activated in order for certain of the later stages to be implemented or for consumer authentication data to be transferred to a device reader or POS terminal of the merchant . Similarly in some embodiments the consumer authentication data may be able to be transferred without activation of the payment application or the need for interaction with the payment device or consumer may be able to be detected in the absence of an activated payment application.

According to an embodiment upon activating the payment application it could be determined if interaction such as a consumer input or action is required prior to conducting or completing the payment transaction. For example based on identifying the consumer the consumer s payment account etc. it may be determined whether interaction with the consumer s payment device or the consumer is required prior to proceeding with a payment transaction. If interaction with the payment device is not required to proceed with a payment transaction then the payment transaction may be performed note that in some embodiments the user may be asked to present the payment device in order to permit performance of the payment transaction as the first presentment of the payment device at served to activate the payment application as shown at . However if interaction with the payment device or consumer is required before proceeding with a payment transaction then this interaction is implemented. The required interaction may involve the consumer providing certain data such as a passcode or other authentication data or responding to a challenge question or the performance of an operation on the payment device . Thus if required the interaction is performed and the payment device is re presented to the device reader or point of sale terminal to perform the payment transaction for example. As mentioned the interaction may involve a consumer providing data such as a password etc. or the payment device or payment application being configured to permit execution of a payment transaction.

At the payment application of the payment device sends a request via the trusted value add interface to the value add application to provide value add data that is relevant to the transaction. For example during the transaction the payment application refers to the value add application e.g. a transit or loyalty application sitting in the same payment device and communicates with the value add application through the internal value add interface . The communication for example may interrogate the value add application regarding the availability of loyalty points or rides or other value add data . For example upon receiving the request from the payment application the value add application makes a value add calculation based on the payment transaction data and sends the results of the calculation to the payment application via the trusted value add interface . For example the value add calculation may determine the number of transit rides remaining on the payment device or the amount of loyalty points credits remaining on the payment device and a determination of how if at all the transit rides or loyalty points credits affect the payment transaction. For example if the consumer has loyalty points or transit rides then those points or rides may be applied to reduce the cost of the transaction. Then the payment application sends the value add data together with payment data to a payment processing network which may send the data to an issuer bank an acquirer bank the value add operator etc.

At the value add application sends value add data to the payment application via the value add interface . At the payment application of the payment device sends the value add data together with payment data to the payment application of the merchant via the payment interface . According to an embodiment the payment application of the merchant completes the transaction. However according to other embodiments the payment application of the payment device may complete the transaction offline. At the payment application of the merchant sends the value add data together with the payment data to the payment network . At the payment network routes the payment and value add data to the appropriate recipients such issuing banks transit operators loyalty operators and so on.

A payment application and one or more value add applications are installed on the payment device . One or more payment interfaces are installed on the payment device for coupling the payment application to the value add applications . According to an embodiment one payment interface is provided for each value add application installed on the payment device . According to the illustrated embodiment the value add applications are stored in data store . It should be appreciated that the payment device the data storage and the payment and value add applications and may be the same as the corresponding elements of . According to the value add operator includes one or more value add applications configured to receive value add data and payment data from the one or more value add applications of the payment device via a value add interface .

According to an embodiment the one or more value add applications of the value add operator are installed on an acceptance device or terminal such as a transit validator or a loyalty terminal that collects value add data and optionally payment data from the payment device via contactless transactions and card swipe transactions. According to this embodiment the value add interface may be a contactless element interface such as the contactless element of which functions to permit the exchange of data and or control instructions between the one or more value add applications of the payment device and the one or more value add applications of the value add operator .

According another embodiment the one or more value add applications of the value add operator are installed on an application server that is provided in communication with a network such as the network e.g. a wireless network or the Internet and or the payment processing network of . According to this embodiment the value add interface may be configured to permit the exchange of data and or control instructions between the one or more value add applications of the payment device and the one or more value add applications of the value add operator over a network such as the Internet or cellular network where the payment device is located in a remote location relative to the value add operator . In these remote transactions the payment device may be a cell phone personal data assistant PDA or a personal computer that communicates with a value add operator directly or indirectly over a network. These types of transactions where the consumer is not in the same physical location as a value add operator and hence where a payment device is not physically presented to the value add operator are sometimes referred to as mobile and or card not present transactions.

As illustrated in the one or more value add applications of the value add operator are configured to send both payment data and value add data to one or more corresponding value add proprietary networks such as a transit network or a loyalty program network.

As shown in at the payment device is presented to the value add operator . According to an embodiment at a consumer presents the payment device to a value add operator . The payment device may be a mobile device that includes a contactless element such as a contactless chip. Typically the consumer presents the mobile device to the device reader or POS terminal as part of providing data to initiate or participate in a payment transaction. According to another embodiment at a consumer may present the payment device to the value add operator by engaging the value add operator in a mobile value add transaction over a cellular network or the Internet.

At presentation of the payment device activates or launches the appropriate value add application installed on the payment device and the value add application of the payment device begins to transact with the value add application of the value add operator . According to an embodiment activation of the value add application may be accomplished by causing communication between the value add application of a device reader or terminal of the value add operator and the payment device . For example a transit value add application on the payment device may be activated when the payment device is presented to a transit ticket validator of a transit operator . According to another embodiment activation of the value add application may be accomplished by causing communication between the value add application of the value add operator and the value add application of the payment device in the course of a value add transaction over a cellular network or the Internet.

Note that as mentioned above with respect to process the activation of the value add application at this stage is optional and may be implemented at a different stage in the process and depending upon the operation of the process depicted in activation of the value add application on the payment device may or may not be required in order to implement one or more of the other stages of the overall process.

At the activated value add application installed on the payment device exchanges data via the appropriate payment interface with the payment application that is also installed on the payment device . For example the activated value add application of the payment device sends a request via the appropriate trusted payment interface to the payment application . The request may instruct the payment application to send payment data that is relevant to the value add transaction to the value add application via the payment interface . For example the payment data may include data needed to complete an online authorization such as the ARQC cryptogram payment account number expiry date etc. Such payment data may be sufficient for the payment application in the payment device to perform a payment transaction within the payment device offline or with further online authorization. Both the value add application and the payment application decide whether the transaction can be performed offline within the payment device or online with online authorization. Further for example the payment data may be a confirmation of payment offline authorization needed to reset counter of a transit value add application or replenish loyalty points of a loyalty value add application . The value add transaction may be for example a loyalty point redemption transit ticket validation and so on. For example during a value add transaction to purchase or otherwise acquire transit rides a transit application refers to the payment application sitting in the same payment device and communicates with the payment application through the internal payment interface . The communication for example may instruct the payment application to provide payment data that may be used to request payment for transit rides that are being acquired via the value add transaction.

At the value add application of the payment device sends the value add data together with payment data to the value add application of the value add operator via the value add interface . It should be appreciated that the transaction may be complete locally on the value add application of the payment device or on the value add application of the value add operator . At the value add application of the value add operator sends the value add data together with the payment data to the value add network . At the value add network sends the value add data and the payment data to for example acquiring banks to get online authorization from issuers transit operators loyalty operators and so on.

The subsystems shown in are interconnected via a system bus . Additional subsystems such as a printer keyboard fixed disk or other memory comprising computer readable media monitor which is coupled to display adapter and others are shown. Peripherals and input output I O devices which couple to I O controller can be connected to the computer system by any number of means known in the art such as through serial port . For example serial port or external interface can be used to connect the computer apparatus to a wide area network such as the Internet a mouse input device or a scanner. The interconnection via system bus allows the central processor to communicate with each subsystem and to control the execution of instructions from system memory or the fixed disk as well as the exchange of information between subsystems. The system memory and or the fixed disk may embody a computer readable medium.

The previous description of the embodiments is provided to enable any person skilled in the art to practice the invention. The various modifications to these embodiments will be readily apparent to those skilled in the art and the generic principles defined herein may be applied to other embodiments without the use of inventive faculty. Thus the present invention is not intended to be limited to the embodiments shown herein but is to be accorded the widest scope consistent with the principles and novel features disclosed herein. For example although some specific embodiments describe the use of a message conversion process with typical brick and mortar type merchants embodiments of the invention can also be used in on line e commerce type transactions.

Embodiments of the invention are not limited to the above described embodiments. For example although separate functional blocks are shown for an issuer payment processing system and acquirer some entities perform all of these functions and may be included in embodiments of invention.

Further additional embodiments of the invention may be directed to methods and systems involving merchants and their access devices as well as issues. For example other embodiments may include the following additional embodiments.

It should be understood that the present invention as described above can be implemented in the form of control logic using computer software in a modular or integrated manner. Based on the disclosure and teachings provided herein a person of ordinary skill in the art can know and appreciate other ways and or methods to implement the present invention using hardware and a combination of hardware and software.

Any of the software components or functions described in this application may be implemented as software code to be executed by a processor using any suitable computer language such as for example Java C or Perl using for example conventional or object oriented techniques. The software code may be stored as a series of instructions or commands on a computer readable medium such as a random access memory RAM a read only memory ROM a magnetic medium such as a hard drive or a floppy disk or an optical medium such as a CDROM. Any such computer readable medium may reside on or within a single computational apparatus and may be present on or within different computational apparatuses within a system or network.

One or more features from any embodiment may be combined with one or more features of any other embodiment without departing from the scope of the invention.

A recitation of a an or the is intended to mean one or more unless specifically indicated to the contrary. A recitation of she is meant to be gender neutral and may be read as he or she unless specifically indicated to the contrary.

All patents patent applications publications and descriptions mentioned above are herein incorporated by reference in their entirety for all purposes. None is admitted to be prior art.

