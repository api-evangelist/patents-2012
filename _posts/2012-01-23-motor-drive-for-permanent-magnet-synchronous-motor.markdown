---

title: Motor drive for permanent magnet synchronous motor
abstract: A pulse-width modulation (PWM) inverter controller compensates for harmonics in the output current provided by a PWM inverter to permanent magnet (PM) motor. The PWM inverter controller includes a field-oriented controller (FOC) that monitors output currents provided by the PWM inverter to the PM motor and employs the monitored output currents in a current loop feedback that generates control signals. A harmonic compensator transforms monitored phase currents into rectangular waveforms having magnitudes modified based on detected harmonics within the monitored phase currents to generate compensation signals. The compensation signals generated by the harmonic compensator are summed with the control signals generated by the FOC to generate compensated control signals. A PWM signal generator generates PWM signals for controlling the PWM inverter based on the compensated control signals.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09048767&OS=09048767&RS=09048767
owner: Hamilton Sundstrand Corporation
number: 09048767
owner_city: Windsor Locks
owner_country: US
publication_date: 20120123
---
This invention was made with government support under N65540 08 D 0017 DO 0001 awarded by the United States Navy. The government has certain rights in the invention.

The present invention is related to motor drives and in particular to motor drives employed with respect to permanent magnet synchronous motors.

Motor drives control the operation of a motor by controlling the supply of power to the motor. In particular motor drives oftentimes include a pulse width modulation PWM inverter comprised of a plurality of solid state switching devices that are selectively turned On and Off to generate the desired alternating current AC waveform for supply to the motor.

A drawback of motor drives employing a PWM inverter is the creation of current harmonics on the output of the motor drive that can result in negative torque components being provided to the motor thereby decreasing performance of the motor. The creation of current harmonics on the output of the motor drive is attributable to the dead time of gate drives within the PWM inverter such dead time being added to prevent the short circuit of inverter legs to turn On Off times of the solid state switching devices employed by the PWM inverter and or to On voltages associated with the solid state switching devices and diodes.

To minimize the presence of these harmonics prior art controllers have relied on increasing the bandwidth of the current loop used to regulate the output current of the inverter. However this solution makes the system vulnerable to noise and instability which may amplify system resonances.

A pulse width modulation PWM inverter controller compensates for harmonics in the output current provided by a PWM inverter to a permanent magnet PM motor. The PWM inverter controller includes a field oriented controller FOC that monitors output currents provided by the PWM inverter to the PM motor and employs the monitored output currents in a current loop feedback that generates control signals. A harmonic compensator transforms monitored phase currents into rectangular waveforms having magnitudes modified based on detected harmonics within the monitored phase currents to generate compensation signals. The compensation signals generated by the harmonic compensator are summed with the control signals generated by the FOC to generate compensated control signals. A PWM signal generator generates PWM signals for controlling the PWM inverter based on the compensated control signals.

The speed of PM motor is estimated based on position feedback received from position sensor . Position feedback signal is provided to electrical frequency estimator which calculates in response to the position feedback signal an estimate of the electrical frequency el freq. The electrical frequency estimate el freq is converted by block to a speed feedback estimate spd fdbk that represents the estimated speed of PM motor . The speed feedback estimate spd fdbk is compared to a desired or reference speed value spd ref at block to generate an error signal that represents whether the speed of PM motor should be increased or decreased i.e. whether torque supplied to PM motor should be increased or decreased . Likewise the speed feedback estimate spd fdbk is used to calculate the field weakening required at a given speed of PM motor as discussed in more detail with respect to the particular control functions performed by PWM inverter controller .

In the embodiment shown in field oriented controller FOC monitors the output currents ia ib and ic converts the monitored output currents from the three phase stationary reference frame i.e. abc reference frame to a dq rotating reference frame and provides the transformed current feedback components iq fdbk and id fdbk to a current loop that generates control signals to minimize the difference or error between the monitored current feedback components iq fdbk and id fdbk and the desired current components iq ref and id ref.

In the embodiment shown in FOC includes abc dq transformer which transforms monitored currents ia ib and ic from the three phase stationary reference frame to a dq rotating reference frame comprised of a quadrature current feedback signal iq fdbk and a direct current feedback signal id fdbk.

The current feedback signals iq fdbk and id fdbk are provided in feedback to respective control loops that compare the current feedback signals iq fdbk and id fdbk to reference signals id ref and iq ref respectively. In particular the quadrature current feedback signal iq fdbk is compared to quadrature reference current iq ref. In the embodiment shown in the quadrature current reference value iq ref i.e. the desired torque to be supplied to PM motor is based on a comparison at block of the monitored current speed spd fdbk of PM motor with the desired or reference speed spd ref of PM motor . The resulting difference or error between the reference speed spd ref and current speed spd fdbk is provided to proportional integral PI controller to generate quadrature current reference signal iq ref. The quadrature current reference signal iq ref is compared to the quadrature current feedback signal iq fdbk at block to generate an error or difference between the reference signal and the feedback signal. The error or difference is provided to PI controller to generate quadrature voltage signal vq that represents the quadrature voltage required to minimize the difference between the quadrature current feedback iq fdbk and the quadrature current reference iq ref.

When operating at speed below at which a voltage limit has been reached base speed of the PM motor id ref is set to zero. To operate above base speed the direct component of stator current needs to be negative to weaken the magnetic field of the permanent magnets. This operation is referring as field weakening. In the embodiment shown in the speed feedback signal spd fdbk is provided to look up table which provides in response a desired or reference direct current component id ref to enable field weakening. At block the direct current reference id ref is compared to the direct current feedback component id fdbk to generate an error or difference signal. The error signal is supplied to PI controller to generate direct voltage signal vd that represents the direct voltage required to minimize the difference between the direct current feedback id fdbk and the direct current reference id ref.

Voltage decoupling block decouples the quadrature voltage component from the direct voltage component. In one embodiment voltage decoupling block combines the quadrature current feedback signal iq fdbk with the electrical frequency of PM motor and subtracts this value at block from the calculated direct voltage reference component vd to generate reference direct voltage component vd ref. Similarly voltage decoupling block combines the direct current feedback signal id fdbk with the electrical frequency of PM motor and adds this value at block from the calculated quadrature voltage reference component vq to generate reference quadrature voltage component vq ref.

The resulting reference quadrature voltage component vq ref and reference direct voltage component vd ref are provided to dq abc transform block for conversion from the dq rotating reference frame to the three phase stationary reference frame. The resulting reference control signals va vb vc represent the outputs required to correct errors between the desired quadrature current and direct current references values id ref and id ref and the quadrature current feedback and direct current feedback signals iq fdbk and id fdbk. However control signals va vb and vc do not account for characteristics of PWM inverter e.g. dead time of solid state switching devices turn On Off timing of the devices On voltage etc. that contribute to phase output current harmonics.

In the embodiment shown in harmonic compensation block generates harmonic compensation signals va comp vb comp and vc comp based on the monitored phase currents ia ib and ic. The harmonic compensation signals va comp vb comp and vc comp are added to control signals va vb and vc by blocks and respectively to generate compensated control signals va ref vb ref and vc ref provided in turn to PWM signal generator . In this way harmonic compensation is provided based on the actual harmonics detected and is not based on inverter characteristics that may change over time or between individual inverters.

In the embodiment shown in at least one phase of the monitored output current e.g. monitored current phase ia fdbk is supplied to synchronous notch filter which includes sine block cosine block multiplier blocks and low pass filters and multiplier blocks and adder block and difference block . The purpose of synchronous notch filter is to remove the fundamental frequency from the monitored output current leaving only the harmonics associated with the monitored phase current. Position information supplied by position sensor is provided to sine block and cosine block to generate sinusoidal outputs corresponding with the fundamental frequency of the output current without the presence of any harmonics. The monitored feedback output current in this case output current ia fdbk is multiplied with both the sine wave generated by sine block and the cosine wave generated by cosine block at multiplier blocks and respectively to generate sine and cosine components of the monitored output current ia fdbk. Low pass filters and filter high frequency harmonics from the respective sine and cosine components of the monitored output current ia fdbk. The filtered outputs of low pass filters and are multiplied with the sine wave generated by sine block and cosine block at multiplier blocks and respectively. The outputs of multiplier blocks and are combined at summer block the output of which represents the fundamental frequency of the monitored current feedback without the presence of harmonics.

At block the monitored phase current ia fdbk is subtracted from the filtered fundamental frequency provided by block . The result of the subtraction is a notch filter output that filters the fundamental frequency associated with the monitored phase current ia fdbk such that only the harmonics associated with the monitored phase current remain i.e. notched output . In this way synchronous notch filter rejects the fundamental frequency associated with the monitored phase current ia fdbk.

The output of synchronous notch filter is applied to synchronous detector which includes multiplier blocks and and harmonic integer value isolates harmonics of a particular type within the output provided by synchronous notch filter . The harmonic isolated can be selected based on the value stored in memory by harmonic integer value . For example in the embodiment shown in the 5harmonic is selected for compensation. The harmonic integer value is multiplied with position sensor at multiplier block . The result is multiplied with the output of synchronous notch filter by multiplier block .

The output of synchronous detector is filtered by low pass filter to produce an error signal that is sensitive to the selected harmonic e.g. 5harmonic . The error signal is provided to PI controller which selects the magnitude of the compensation signal required to minimize the error signal provided to PI controller . That is PI block generates a compensation signal value that drives the error signal provided by low pass filter to zero.

The compensation signal generated by PI controller is generated for summing with each voltage phase va vb and vc. With respect to each phase the monitored phase currents ia fdbk ib fdbk and ic fdbk are provided to low pass filters and respectively to isolate the fundamental frequency associated with each phase. The filtered outputs of low pass filters and are provided to zero cross detectors and respectively to convert the signals to respective square wave signals that correspond with the fundamental frequency of the monitored phase currents. The resulting square wave signals are multiplied with the output of PI block at multiplier blocks and to generate compensation signals va comp vb comp and vc comp.

In the embodiment shown in abc dq transform block converts the monitored phase currents ia fdbk ib fdbk and ic fdbk to a direct current feedback component id fdbk. The direct current feedback component id fdbk is provided to synchronous detector which includes multiplier blocks and and harmonic integer value . In the embodiment shown in harmonic integer value is set to six. Multiplier block multiplies the integer value provided by integer block with position information provided by position sensor shown in . Multiplier block multiplies the output of multiplier block representing the 6harmonic with the direct current feedback component id fdbk to detect the 6harmonic component within the direct current feedback component id fdbk. Low pass filter filters other components of direct current feedback component id fdbk to provide the harmonic component of the direct current component id fdbk to PI controller which selects the magnitude of the compensation signal to drive the harmonic component to zero.

Once again a compensation signal is generated for summing with each voltage phase va vb and vc. With respect to each phase the monitored phase currents ia fdbk ib fdbk and ic fdbk are provided to low pass filters and respectively to isolate the fundamental frequency associated with each phase. The filtered outputs of low pass filters and are provided to zero cross detectors and to convert the signals to square wave signals that correspond with the fundamental frequency of the monitored phase currents. The resulting square wave signals are multiplied with the output of PI block at multiplier blocks and to generate compensation signals va comp vb comp and vc comp.

A benefit of the present invention described with respect to is that the magnitude of the compensation signal is derived in closed loop fashion within several cycles of the fundamental frequency which reduces sensitivity to time variable inverter parameters and dc bus voltage ripple. That is the compensation is based on the monitored phase current outputs and is therefore auto tuning i.e. does not require information regarding characteristics of the PWM inverter itself .

While the invention has been described with reference to an exemplary embodiment s it will be understood by those skilled in the art that various changes may be made and equivalents may be substituted for elements thereof without departing from the scope of the invention. In addition many modifications may be made to adapt a particular situation or material to the teachings of the invention without departing from the essential scope thereof. Therefore it is intended that the invention not be limited to the particular embodiment s disclosed but that the invention will include all embodiments falling within the scope of the appended claims.

