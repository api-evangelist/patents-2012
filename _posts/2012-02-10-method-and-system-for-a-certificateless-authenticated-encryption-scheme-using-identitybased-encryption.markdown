---

title: Method and system for a certificate-less authenticated encryption scheme using identity-based encryption
abstract: A method of verifying public parameters from a trusted center in an identity-based encryption system prior to encrypting a plaintext message by a sender having a sender identity string may include: identifying the trusted center by a TC identity string, the trusted center having an identity-based public encryption key of the trusted center based on the TC identity string; determining if the sender has a sender private key and the public parameters for the trusted center including the public encryption key of the trusted center and a bilinear map; and verifying the public parameters using the TC identity string prior to encrypting the plaintext message into a ciphertext by comparing values of the bilinear map calculated with variables from the trusted center. The ciphertext may include a component to authenticate the sender once the ciphertext is received and decrypted by the recipient using the private key of the recipient.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08694771&OS=08694771&RS=08694771
owner: Connect In Private Panama Corp.
number: 08694771
owner_city: Panama
owner_country: PA
publication_date: 20120210
---
This invention relates to a certificate less authenticated encryption scheme and in particular an encryption scheme using identity strings to provide identity based encryption.

Cryptographic encryption algorithms add confidentiality to sensitive data that is transmitted over an insecure channel. The data is protected as the encryption algorithm transforms the data from plaintext into ciphertext prior to transmission. The recipient of the encrypted data is only able to decrypt the ciphertext and retrieve the plaintext from the received transmission if the recipient is able to reverse the encryption algorithm. If the encryption and decryption algorithms share the same key the cryptosystem is known as symmetric and the algorithms are called symmetric key algorithms. If the key in the encryption algorithm is different than the key in the decryption algorithm the cryptosystem is known as asymmetric and the algorithms are called asymmetric key algorithms.

In asymmetric key algorithms the key used for encryption i.e. the public key is publicly known as everyone should be able to use it to encrypt sensitive data. However the key used in the decryption i.e. the private key is only known to the intended receiver of the encrypted data and is protected such that the intended receiver is the only entity able to decrypt the encrypted message. An asymmetric cryptosystem is commonly referred to as a Public Key Cryptosystem PKC .

In a PKC the public key and the private key are independent of each other such that knowledge of the public key does not reveal or lead to the private key. In other words the public key can be made public such that anyone can encrypt data for a specific recipient but only the specific recipient has knowledge of the private key and is able to utilize the private key to decrypt and retrieve the data. Since the public keys in the PKC are publicly known they are considered insensitive and can be transmitted over any insecure public channel. However the main challenge with the PKC is to trust whether an available public key is actually associated with the intended recipient. In other words if a different public key i.e. a wrong or modified public key is used by mistake or by fraud the overall security achieved by utilizing encryption is compromised. The security of the encryption in a Public Key Cryptosystem therefore relies on correctly distributing the public keys that belong to or are associated with the intended recipients of the encrypted message. Accordingly it is necessary to verify the public keys before encrypting sensitive data with a public key in a PKC.

Since large systems are dynamic and new members join or leave the system at all times public keys are constantly issued and or revoked. At the time of registration setup a new member is assigned a new set of public private keys and all the other existing members are notified of the new public key before they can securely communicate with the new member using the new public key generated.

In the PKC there are two mechanisms for generating and distributing the public keys throughout the system. In the first mechanism the public keys are generated by a trusted center which would then distribute them remotely over a secure channel to the users in the system. The second mechanism is for a sender to generate the public key locally for every recipient. In this way the trusted center is not required to first generate a private key for every recipient and then distribute these generated public keys remotely over a secure channel to every sender.

Generating public keys locally is superior to relying on a trusted center to provide the public keys. When the public encryption keys are generated locally the latency of encryption is reduced in that it is no longer necessary to retrieve a certificate from a remote server.

Traditionally in the PKC public keys are generated by a trusted center certificate authority guaranteeing that a public key belongs to a certain recipient. The certificate authority is a trustworthy entity that distributes the certificates throughout the PKC. In a typical PKC the trusted center is operable to produce an X.509 certificate that includes the public key for a recipient as well as other ancillary data. The trusted center then digitally signs the provided certificate in order for the sender to verify the authenticity of the provided certificate and the corresponding public key. Nevertheless distributing and managing the public key certificates in a large system is a challenging task as the certificates have to be protected from tampering over insecure channels during transmission or when received at the sender s local machine.

An alternate approach to public key encryption is to self generate the public parameters that would be used to encrypt sensitive data using the recipient s known identity such as a phone number email address or username. Boneh and Franklin have introduced an Identity Based Encryption IBE scheme in which the identity of the recipient is used in the encryption such as described in Dan Boneh and Matthew Franklin Identity Based Encryption from the Weil Pairing 32 3 586 615 2003 and U.S. Pat. No. 7 113 594 the contents of which are hereby incorporated by reference in their entirety. In their setup every user is given a private key but the encryption key is constructed using the identity of the recipient and the trusted center s public key. Their system removes the need to contact the trusted center certificate authority to retrieve the public key of a recipient. However in their system the public key of the trusted center P has to be strictly protected. If a different public key is used in the encryption by mistake or fraud the security of the encryption is entirely compromised.

It should be noted that the entire security of their scheme relies on the security of the public key of the trusted center which is publicly known and therefore widely available. If an adversary can change the public parameter s of the trusted center either by accessing the local storage of trusted center s public key or by sending a different public key via a man in the middle attack the security of the encryption system is compromised.

The present invention is directed to provide an improved certificate less authenticated encryption CLAE method and an authentication system using identity based encryption.

It is an object of the present invention to configure a PKC system which has eliminated the need for distributing and managing public keys throughout the system. Instead the public keys are generated and verified locally. Once the system is initialized any entity in the system can self generate the public key of any other entities and encrypt sensitive data by using the recipient s identity such as a phone number email address or username. Only the true recipient is then able to decrypt and retrieve the sensitive data using a private key known only to the recipient and obtained from a trusted center.

One of the many security challenges in the PKC systems is protecting the public key certificates from tampering and securely distributing them throughout the system. Boneh and Franklin as discussed above proposed an IBE scheme in which the public identity of users is used to generate the encryption keys. However the same problems occur with the public key of the trusted center i.e. the key generator according to Boneh and Franklin . If Pand P are replaced fraudulently the fraudster can easily access the encrypted messages. This attack is possible since Pand P in the Boneh and Franklin setup are publicly known and widely available. Therefore the public keys are not protected at all or they are less protected throughout the system than the private keys or the secret master key. Furthermore the public parameters are broadcast throughout the system via a public insecure channel. Therefore an adversary may try to change the values of Pand P in the encryption algorithm.

As described in the prior art if a fraudster substitutes Pwith any other point such as xP where x is known to the fraudster the adversary can easily find g i.e. the session key according to Boneh and Franklin and reverse the encryption of M. This is further shown as follows as described by Boneh and Franklin discussed above we have g e Q P which under the fraudster s modification would become g e Q xP . The corresponding message key would be g g where it can be easily found from V rP in the Voltage Security IBE . This is performed in IBE by computing 

In contrast the CLAE scheme according to the present invention allows the sender to locally verify the public keys i.e. P of the server before encrypting the message. In other words the sender is operable to verify the trusted center TC before encrypting a message thereby ensuring that the public parameters have not been modified. The point of trust in the CLAE scheme of the present invention is established from the public identity of the server e.g. abc.com and unlike the prior art it is not a fixed parameter that can be altered.

In one aspect of the present invention a new CLAE framework has been designed that uses the identity of the recipient to remove the need for public key certificates. Instead of using a predetermined parameter to generate the public private encryption key the user incorporates the identity of the trusted center as well as the identity of the recipient. In this manner greater flexibility is provided in generating the encryption keys as the user can arbitrarily choose any trusted center using its own identity and can be assured that its selection will be enforced on the recipient. For instance the user might want to send an encrypted email from an abc.com account to someone with an xyz.com account. In this case the user can choose either abc.com or xyz.com as the trusted center simply by using the trusted center s identity in the encryption process. The recipient is then forced to verify itself to the trusted center chosen by the sender. Such a system may also allow the sender of an encrypted message to verify one or more of the public parameters to ensure that they have not been tampered with.

In one aspect the present invention resides in a method of sending an encrypted message by a sender having a sender identity string Id to a recipient over a network using identity based encryption the method may include identifying a trusted center TC by a TC identity string Id the trusted center having an identity based public encryption key of the trusted center g based on the TC identity string Id . Furthermore the method may include determining if the sender has a sender private key Prv and a plurality of public parameters PK for the chosen trusted center TC the public parameters PK including the identity based public encryption key of the trusted center g and a bilinear map e . Furthermore the method may include verifying the public parameters PK of the trusted center TC using the TC identity string Id prior to encrypting a plaintext message M . Furthermore the method may include identifying the recipient by a recipient identity string Id the recipient having an identity based public encryption key of the recipient g for the trusted center TC based on the recipient identity string Id Furthermore the method may include generating the identity based public encryption key of the recipient g using the public parameters PK and the recipient identity string Id Furthermore the method may include encrypting the plaintext message M as ciphertext C using the public parameters PK a random symmetric key and the identity based public encryption key of the recipient g the ciphertext C including the encrypted message. Finally the method may include transmitting the ciphertext C to the recipient over the network.

In another aspect the present invention resides in a method for using certificate less authenticated encryption CLAE using identity based encryption in a network system between a sender having a sender identity string Id and a recipient having a recipient identity string Id the method may include at the sender identifying a trusted center TC by a TC identity string Id the trusted center having an identity based public encryption key of the trusted center g based on the TC identity string Id determining if the sender has a sender private key Prv and a plurality of public parameters PK for the trusted center TC the public parameters PK including the identity based public encryption key of the trusted center g and a bilinear map e verifying the public parameters PK of the trusted center TC using the TC identity string Id prior to encrypting a plaintext message M identifying the recipient by a recipient identity string Id the recipient having an identity based public encryption key of the recipient g for the trusted center TC based on the recipient identity string Id generating the identity based public encryption key of the recipient g using the public parameters PK and the recipient identity string Id encrypting the plaintext message M as ciphertext C using the public parameters PK a random symmetric key and the identity based public encryption key of the recipient g the ciphertext C including the encrypted message and transmitting the ciphertext C to the recipient over the network. Furthermore the method may include at the recipient receiving the ciphertext C from the sender over the network system determining if the recipient has a recipient private key Prv and the public parameters PK for the trusted center TC decrypting the ciphertext C to obtain the plaintext message M using the public parameters PK and the recipient private key Prv .

In another aspect the present invention resides in a method of verifying a plurality of public parameters PK from a trusted center TC in an identity based encryption system prior to encrypting a plaintext message M by a sender having a sender identity string Id The method may include identifying the trusted center TC by a TC identity string Id the trusted center having an identity based public encryption key of the trusted center g based on the TC identity string Id . Furthermore the method may include determining if the sender has a sender private key Prv and the plurality of public parameters PK for the trusted center TC the public parameters PK including the identity based public encryption key of the trusted center g and a bilinear map e . Finally the method may include verifying the public parameters PK of the trusted center TC using the TC identity string Id prior to encrypting the plaintext message M by comparing values of the bilinear map e calculated with variables comprising the sender private key Prv and the identity based public encryption key of the trusted center g .

In another aspect the present invention resides in a system for sending an encrypted message over a network using identity based encryption. The system may include a trusted center TC having a TC identity string Id a sender having a sender identity string Id and a recipient having a recipient identity string Id . The trusted center TC may include a first memory and one or more processors configured for generating a plurality of public parameters PK and a secret master key s from a security parameter the public parameters PK including a bilinear map e and an identity based public encryption key of the trusted center g based on the TC identity string Id receiving a request from a requestor if the request from the requestor contains an identifier Id identifying the requestor generating a private key Prv based on the identifier Id and the secret master key s and transmitting the private key Prv to the requestor over the network system and if the request from the requestor includes a request for the public parameters PK and transmitting the public parameters PK to the requestor over the network system. The sender may include a second memory and one or more processors configured for identifying the trusted center TC by the TC identity string Id determining if the sender has a sender private key Prv and the public parameters PK for the trusted center TC verifying the public parameters PK of the trusted center TC using the TC identity string Id prior to encrypting a plaintext message M identifying the recipient by the recipient identity string Id the recipient having an identity based public encryption key of the recipient g for the trusted center TC based on the recipient identity string Id generating the identity based public encryption key of the recipient g using the public parameters PK and the recipient identity string Id encrypting the plaintext message M as ciphertext C using the public parameters PK a random symmetric key and the identity based public encryption key of the recipient g the ciphertext C including the encrypted message and transmitting the ciphertext C to the recipient over the network. The recipient may include a third memory and one or more processors configured for receiving the ciphertext C from the sender over the network system determining if the recipient has a recipient private key Prv and the public parameters PK for the trusted center TC decrypting the ciphertext C to obtain the plaintext message M using the public parameters PK and the recipient private key Prv .

In another aspect the present invention resides in a computer program product comprising a computer readable memory storing computer executable instructions thereon that when executed by a computer perform the method of identifying a trusted center TC by a TC identity string Id the trusted center having an identity based public encryption key of the trusted center g based on the TC identity string Id determining if a sender has a sender private key Prv and a plurality of public parameters PK for the trusted center TC the public parameters PK including the identity based public encryption key of the trusted center g and a bilinear map e verifying the public parameters PK of the trusted center TC using the TC identity string Id prior to encrypting a plaintext message M identifying a recipient by a recipient identity string Id the recipient having an identity based public encryption key of the recipient g for the trusted center TC based on the recipient identity string Id generating the identity based public encryption key of the recipient g using the public parameters PK and the recipient identity string Id encrypting the plaintext message M as ciphertext C using the public parameters PK a random symmetric key and the identity based public encryption key of the recipient g the ciphertext C including an encrypted message based on the plaintext message M and transmitting the ciphertext C to the recipient over a network.

Further and other features of the invention will be apparent to those skilled in the art from the following detailed description of the embodiments thereof.

A network system in accordance with an embodiment of the present invention is shown in . The network system includes a trusted center a user labeled as Sender and a user labeled as Recipient connected over a network such as an intranet the interne and the like. While the two users may be labeled differently it should be understood that the labels are arbitrary and may change based on the direction an encrypted message is being sent. A Sender is a user operable to package a plaintext message as an encrypted message for transmission and a Recipient is a user operable to receive the encrypted message from the Sender . Upon a response to an encrypted message the Recipient may become the Sender and vice versa.

Each of the users labeled Sender and Recipient are configured with a memory and one or more processors . It should be understood that any additional hardware as known to those skilled in the art may be included such as dedicated circuits a field programmable gate array FPGA and the like. Each of the users may exist on separate computers and or mobile devices incorporating the necessary operating system software and or browsers as known to those skilled in the art.

Similarly the trusted center may exist as a dedicated server or as part of a distributed network having memory and one or more processors . The trusted center may also include additional hardware and software components as known the art such as firewalls and associated security mechanisms. The trusted center is connected to the Sender and Recipient over network .

In operation the network system in accordance with the present invention is operable to transmit information from the Sender to the Recipient using a certificate less authenticated encryption CLAE scheme. Each of the users is operable to communicate with the trusted center to obtain a respective private key Prv and a plurality of public parameters PK . The public parameters PK are specific to the trusted center which includes an identity based public encryption key of the trusted center g . Once these parameters i.e. Prv and PK have been obtained by the respective Sender and Recipient the sender and recipient are operable to communicate independent of the trusted center over a secure channel by encrypting the message using the recipient s public key which is generated locally by the sender using the public parameters PK obtained from the trusted center TC and a recipient identity string Id associated with the recipient. Furthermore prior to encrypting a message the sender is operable to verify the public parameters PK of the trusted center TC using the trusted center identity string Id which is known to the sender to ensure that the public parameters PK have not been modified.

The CLAE scheme is based on identity based encryption IBE and as shown in the flowchart of a preferred embodiment as seen in generally operates as follows 

In this manner the Sender is able to send a plaintext message M as an encrypted message to the Recipient without accessing the trusted center TC as long as the Sender has the required public parameters PK and its own sender private key Prv . Furthermore with the public parameters PK and its own sender private key Prv the Sender is able to verify that the public parameters PK have not been compromised. In this manner the Sender is operable to ensure that only the Recipient having the recipient private key Prv will be able to decrypt the ciphertext C .

To implement the CLAE scheme and the method of the preferred embodiment discussed above four major algorithms are utilized. It should be understood that additional algorithms application programming interfaces APIs methods and or functions will be known and or implemented by those skilled in the art to provide common functions and operations necessary to implement the network system according to the present invention. The four major algorithms in accordance with a preferred embodiment include 

The internal structure of each of the four mentioned algorithms in accordance with a preferred embodiment will be further discussed below including the mathematical basis which may provide the functionality of the mentioned algorithms.

Let G and Gbe groups of order p and let g be a generator of G. A bilinear map is an efficiently computable function from G G onto G such that it has the following properties 

Weil pairing and Tate pairing are two implementations of an efficient bilinear map over elliptic curve groups useful for cryptography such as described in Ian F. Blake Gadiel Seroussi and Nigel P. Smart editors Advances in Elliptic Curve Cryptography Cambridge University Press 2005 the contents of which are herein incorporated by reference in its entirety. Cryptographic bilinear maps must have certain complexity properties that are explained in the following section.

In general cryptographic bilinear maps need to be one way functions i.e. computing the bilinear pairing should be efficient but the inverse has to be difficult. The Bilinear Diffie Hellman BDH complexity assumption is related to the difficulty of solving Discrete Logarithm Problem DLP over large algebraic groups.

Informally the decision variant of the BDH assumption states that the probability of correctly distinguishing e g g Gfrom a random choice R Gis negligible . A function g R R is negligible if for any d 0 we have g 

Suppose that a challenger chooses a b c z Z at random. g is generator for the group G over which the bilinear mapping e is defined. Decision BDH assumption states that no polynomial time adversary can distinguish the tuple A g B g C g Z e g g from the tuple A g B g C g Z e g g with a non negligible probability.

This is a standard assumption in cryptography and provides a foundation for the proof of security for the main scheme.

The details of the main algorithms in the CLAE scheme in a preferred embodiment of the present invention using the bilinear mapping and assumptions provided above are given as follows 

It should be noted that for a sender the identity string being used Id in the above formulas is the identity string of the recipient Id .

As discussed above the trusted center is configured to initiate the setup of the certificate less authenticated encryption CLAE system by running the Setup algorithm and manage the distribution of private keys Prv and public parameters PK by responding to KeyGen Id s function calls from different users in the network system . The trusted center may itself initiate the Setup algorithm upon startup or when the trusted center determines for itself that it is necessary to renew or reset the security of the network system by generating a new secret master key s and new public parameters PK . For example the Setup may be run according to a renewal schedule and the like.

Using the mathematical foundation described above in a preferred embodiment users in the network system are able to encrypt and decrypt messages using the CLAE scheme.

Turning now to the different users in the network system are operable to register with the trusted center and obtain the public parameters PK and their respective private keys Prv . For example the users may call the KeyGen function made available by the trusted center .

The trusted center may also provide a Setup function for a user to call. When called the Setup function may initiate the Setup algorithm to renew and or reset the security of the network system by generating a new secret master key s and new public parameters PK .

Referring now to a user is operable to register itself with the trusted center by first authenticating itself with the trusted center . Different means for authentication may be used to authenticate a user with the trusted center as known in the art. For example password based authentication a challenge response protocol such as the Kerberos protocol from the Massachusetts Institute of Technology biometric authentication i.e. fingerprint retinal and the like may be used. Once the user has authenticated itself the user is operable to call the KeyGen function provided by the trusted center and submitting its identity string Id to the trusted center TC . In the user is labeled as Identity String i.e. ID String . The trusted center TC then calls the KeyGen Id s algorithm using the identity string Id provided by the user and its own secret master key s . In return the trusted center receives the private key for the user Prv which the trusted center then passes on to the user . The trusted center may also pass on to the user as part of the KeyGen function the public parameters PK that are needed to locally generate the identity based public encryption key of other users based on their identity strings Id .

Once the user has its respective private key Prv and the public parameters PK which includes the identity based public encryption key of the trusted center g a sender is able to send an encrypted message to a recipient without contacting the trusted center . No certificate authority is necessary. Instead the user is able to locally generate the recipient public key g using the recipient identity string Id known to the user and the public parameters PK .

Referring now to a transmission from a user A labeled User A to a user B labeled User B is shown in a preferred embodiment. The transmission of an encrypted message may be completed without contacting the trusted center . Instead the identity based public encryption key of the recipient i.e. g will be generated locally by the sender i.e. User A .

In some embodiments the CLAE scheme of the present invention may not be efficient for encrypting large files such as video audio and other media. In such a situation it may be desirable to use a conventional symmetric encryption scheme such as the advanced encryption standard AES the triple data encryption algorithm TDEA or 3DES and the like to transmit the large file. The CLAE scheme of the present invention can then be used to transmit the conventional encryption key of the conventional symmetric encryption scheme as the plaintext message M which is to be protected. In this manner the file transferred may be symmetrically encrypted using the conventional symmetric encryption scheme with the conventional encryption key transmitted alongside the encrypted data using the CLAE scheme of the present invention.

Referring now to a flowchart is shown illustrating the method used by a user A labeled User A for encrypting a message for a user labeled User B . In step the sender i.e. user A or User A identifies or chooses a trusted center TC to associate the encrypted message with. The sender identifies the trusted center TC by its TC identity string Id i.e. label TC .

Next in step the sender determines whether it has the plurality of public parameters PK for the trusted center TC including the identity based public encryption key of the trusted center g or whether the sender must get the TC s public key prior to proceeding. Referring briefly to the sender determines whether or not it needs to get the TC s public key by comparing whether any of the gthe sender may have stored in memory is associated with the identity string of the trusted center Id . If not user A authenticates itself with the trusted center and calls the KeyGen function to receive its own private key Prv and the trusted center s public parameters PK as previously described when registering a new user in .

Returning back to once the sender believes it has the proper public key g the sender in step verifies the TC s public key gusing the sender s private key Prv or more specifically Prv as described above with respect to the Verifi Enerypt Id PK M algorithm. In particular the sender calculates e Prv g and compares it with e g g using the different parameters in the public parameters PK associated with the trusted center . As noted above the TC s public key gand the sender private key Prv i.e. Prv are fixed values received and stored by the sender from the trusted center TC . However the public keys gand gare always generated locally using the public parameter PK and the sender identity string Id i.e. User A and the trusted center identity string Id i.e. admin . The sender can be assured that the public parameters PK have not been tampered with if e Prv g e g g is satisfied as discussed above.

Once the sender has verified the public parameters PK the sender can begin by picking a conventional encryption key that is used to encrypt the actual confidential data such as large documents or video audio files using the conventional symmetric encryption scheme i.e. AES 3DES and the like . The plaintext message M is then set to include the conventional encryption key of the conventional symmetric encryption scheme to be protected by the CLAE Verifi Encrypt algorithm as shown in step . Next as shown in step the confidential data is symmetrically encrypted using the conventional symmetric encryption scheme and the conventional encryption key is stored as or as a part of the plaintext message M .

Next in step the sender computes each component of the ciphertext C as described above with respect to the Verifi Encrypt Id PK M algorithm to symmetrically encrypt the plaintext message M using the symmetric key encryption function found within the public parameters PK and using a random symmetric key generated locally by the sender. In particular each of V U and W are computed for the particular trusted center TC using the recipient identity string Id i.e. User B associated with the recipient the random symmetric key which is randomly generated every time Verifi Encrypt Id PK M is run and the identity based public encryption key of the trusted center g as well as the other public parameters in the public parameters PK .

In step the encrypted message is signed by returning the ciphertext component Y for the recipient using the sender private key Prv or more specifically Prv . The recipient may be operable to use this ciphertext component Y to authenticate the received message.

Finally the ciphertext C is packaged together in step and is ready to be attached to the transmission to be sent to the recipient. The components of the ciphertext C may be packaged as a file i.e. cip.key or within other methods and or structures known in the art. The symmetrically encrypted data using the conventional symmetric encryption scheme along with the file cip.key containing the conventional encryption key stored in the plaintext message M is then ready for transmission to the recipient and may be sent over an unsecured channel as a properly encrypted message.

Upon receipt of the ciphertext C i.e. as stored in the file cip.key the recipient is operable to decrypt the ciphertext C to retrieve the plaintext message M that contains the conventional encryption key used to encrypt the actual data. Referring now to a flowchart is shown illustrating a user B labeled User B decrypting a message from a user labeled User A . In step the recipient i.e. user B or User B retrieves the ciphertext C from the received transmission. For example the ciphertext C may be packaged as the file cip.key .

Next the recipient determines at step whether it needs to get the recipient private key Prv or more specifically Prv from the trusted center TC . Referring briefly to the recipient determines whether or not it needs to get the recipient private key Prv for the particular trusted center TC by comparing whether any of the Prvthe recipient may have stored in memory is associated with the identity string of the trusted center ID i.e. admin . If not user B authenticates itself with the trusted center and calls the KeyGen function to receive its own private key Prv and the trusted center s public key g as previously described when registering a new user in . At this time the recipient may also receive an updated set of public parameters PK from the trusted center TC .

Returning to the recipient is now able to decrypt the different components V U and W of the ciphertext C using the recipient private key Prv and the public parameters PK in step . From these components the recipient is able to retrieve the conventional encryption key stored in the plaintext message M and r as described in the Auth Decrypt Prv PK C algorithm. Furthermore in step the recipient is operable to verify the sender of the message by inspecting the ciphertext C component Y. As described in the Auth Decrypt Prv PK C algorithm the sender may be authenticated by calculating Y H e Prv g . Therefore because e g Prv e Prv g the recipient is operable to verify the sender if Y H e g Prv is satisfied where gis generated locally from the sender identity string Id .

Finally once the sender has been verified the recipient is operable to restore the plaintext message M that contains the conventional encryption key used by the conventional symmetric encryption scheme to encrypt the confidential data. The plaintext message M is restored using the random symmetric key and the symmetric key encryption function to easily determine D as described above in the Auth Decrypt Prv PK C algorithm. Using the conventional encryption key stored in the plaintext message M the recipient is operable to decrypt the transmitted message using the conventional symmetric encryption scheme. The decryption process is now complete.

The CLAE scheme as described above in a preferred embodiment of the present invention allows for the intended recipient to verify the sender s identity without storing or referring to any public key certificates. If the recipient successfully decrypts the ciphertext C the recipient can authenticate the sender based on the properties of the bilinear map e using the public parameters PK and the sender identity string Id The authentication is an integral part of the CLAE scheme and it is more efficient to verify the sender in this manner than separately adding additional authentication components to the encryption process. The CLAE scheme according to the preferred embodiment of the present invention will ensure that not only is the sensitive data kept confidential but also the sender of the confidential data is authentic. It should be noted that the authentication can be made optional by removing Y from the ciphertext C in an application where other authentication digital signature schemes exist.

The encryption key in CLAE scheme according to the preferred embodiment of the present invention is derived from dynamic parameters that are calculated from the trusted center s identifier e.g. domain name phone number etc.

This new design yields greater flexibility in working with multiple authorities. The sender of encrypted data can enforce elaborate access conditions on the recipient before the recipient can decrypt and retrieve sensitive data. The sender can select not only who the recipient is but also how the recipient receives its private key Prv . For example a descriptive string may be combined or appended with the TC identity string Id to increase the level of authentication required by the trusted center TC necessary for the recipient to obtain its private key Prv from the trusted center TC . The recipient may be forced by the trusted center TC to further authenticate itself by satisfying this additional condition provided by the descriptive string. The additional descriptive string may include the recipient s role the recipient s age the recipient s location an expiry date and the like.

As an example the sender can choose bob abc.com as the recipient s identity of the encrypted message and can set abc.com December 2013 as the trusted center s public identity string TC with an expiry date of December 2013. The sender s description of the TC identity string TC is then enforced in the ciphertext C by locally computing a new g where g H abc.com December 2013 . If the sender possesses the public key of the trusted center TC g gcorresponding to the new g it can proceed with Verifi Encrypt as described above. Otherwise the sender is forced to obtain a new g as shown with respect to .

Beyond this date the encryption algorithm would receive a new public key from the trusted center and would use it to generate new encryption keys. The recipient would then be forced to renew its private key from trusted center. This is very useful in conditions where the identity of users in the system will remain the same for an extended period but it is beneficial for security reasons to have the private keys update periodically and or frequently. On the receiver s side if the same secret master key s is used to compute the new identity based public encryption key of the trusted center g no change has to be made to the private key of the recipient Prv or the decryption algorithm. If however a different secret master key s is used the recipient will be forced to receive a new private key corresponding to the secret master key of the trusted center TC with the new TC identity string Id as shown in .

t should be noted that the same encryption algorithm can be used if the sender decides to use a different server trusted authority such as xyz.com instead of abc.com . The only difference in the encryption algorithm would be in using the identity based public encryption key of the new trusted center g of the new trusted center and everything else remains the same.

As discussed above the new CLAE scheme allows the sender to communicate privately with any recipient under various trusted authorities. For example the sender can send an encrypted message from the abc.com domain with secret master key s to someone in the xyz.com domain with secret master key s . Two different cases can happen depending if s s .

In this manner the sender has control of which trusted center TC to associate with and can force the recipient to authenticate to a trusted center TC of its choosing. Accordingly the sender can rely on the additional security of choosing its preferred trusted center to generate and supply the private key Prv to the recipient. The onus can then be placed on the recipient to associate with reliable trusted centers and authenticate itself to the trusted center TC selected by the sender to receive the private key for the recipient Prv .

Although this disclosure has described and illustrated certain preferred embodiments of the invention it is also to be understood that the invention is not restricted to these particular embodiments rather the invention includes all embodiments which are functional or mechanical equivalents of the specific embodiments and features that have been described and illustrated herein. The scope of the claims should not be limited to the preferred embodiments set forth in the examples but should be given the broadest interpretation consistent with the description as a whole.

It will be understood that although various features of the invention have been described with respect to one or another of the embodiments of the invention the various features and embodiments of the invention may be combined or used in conjunction with other features and embodiments of the invention as described and illustrated herein. Furthermore while the various methods described herein may refer to a specific order and number of steps it should be understood that the order and or number of method steps described herein should not be construed as limiting as other orders and or number of steps would be understood by persons skilled in the art.

