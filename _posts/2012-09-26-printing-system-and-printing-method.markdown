---

title: Printing system and printing method
abstract: In a printing system in which a document received from a client terminal is registered in a print service, a fixed code corresponding to the registered document is sent back to the client terminal by e-mail, and when a printer notifies the fixed code, print processing is performed for the document corresponding to the fixed code, the URL of the print service which has registered the document is generated, and the network environment of the client terminal is determined. When it is determined that the network environment is an intranet, the fixed code and generated URL are sent back.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08804176&OS=08804176&RS=08804176
owner: Canon Kabushiki Kaisha
number: 08804176
owner_city: Tokyo
owner_country: JP
publication_date: 20120926
---
The present invention relates to a printing system and printing method for issuing a print instruction from a client apparatus for a document registered in a print service.

Recently businesses offering services provided on the Internet as a cloud service that use cloud computing have expanded. Even a print service is desired to be provided on the Internet.

As one print service using a cloud computer there is a system in which a document to be printed is transmitted as a document attached to an e mail from a mobile terminal to a print service and registered. In this system an identification number to be referred to as a PIN code issued upon registering the document is input to a printer to acquire the document corresponding to the PIN code from the server and pull print.

For example Japanese Patent Laid Open No. 2007 250001 proposes a method of storing document data received from a mobile terminal in a print server. In this method a URL indicating the storage location of the document data is transmitted to the mobile terminal by e mail. The mobile terminal displays the URL without conversion or after converting it into a barcode. A printer receives the URL acquires the document data present at the location indicated by the URL from the server and prints.

A PIN code usually has a predetermined period of validity for the sake of security. After the lapse of the period of validity the PIN code is invalidated. Since a PIN code is transmitted to a document registration source terminal it is presumed considered that only the user who registered the document knows the PIN code. However the period of validity is short for security against leakage and the like. In an office or the like where many users share a printer a user may not be able to input a PIN code that is a print instruction within the period of validity and the PIN code may become invalid. In the method of issuing a PIN code a user needs to manually input a PIN code via from the operation panel of a printer impairing the operability.

In the method of issuing the URL of the save location of a document a user needs to input characters other than numerals impairing the operability much more than by the PIN code. In the method of converting a URL into a barcode a program for converting a URL into a barcode needs to be installed in a mobile terminal and a printer also requires a device or processing for reading a barcode. In the invention disclosed in Japanese Patent Laid Open No. 2007 250001 an issued URL does not have the period of validity and a user who has issued a print instruction is not authenticated. This may be a security hole in the print server.

In the above methods the user needs to go to the printer and operate it which is inconvenient. For example these methods have not solved the problem that a PIN code may become invalid in an environment where a printer is shared and is not always available.

The present invention has been made in consideration of the conventional techniques and embodiments of the invention provide a system and method for sending back the URL of a print service to the user in accordance with the user environment so that he can issue a print instruction to the printer using authentication of the print service.

The present invention in a first aspect provides a printing system in which document data is registered in a print service in accordance with a registration request from a client terminal and the registered document data is pull printed from a printing apparatus the print service including a determination unit configured to determine in accordance with the registration request for the document data whether a pull print instruction to the printing apparatus can be issued by communication from the client terminal and a transmission unit configured to transmit information representing a result of the determination to the client terminal that is a source of the registration request wherein when the information representing the result of the determination represents that the pull print instruction can be issued by communication the client terminal transmits the pull print instruction to the printing apparatus by communication.

The present invention in a second aspect provides a print service which registers document data in accordance with a registration request from a client terminal and transmits the registered document data in accordance with a request from a printing apparatus comprising a determination unit configured to determine in accordance with the registration request for the document data whether a pull print instruction to the printing apparatus can be issued by communication from the client terminal and a transmission unit configured to transmit information representing a result of the determination to the client terminal that is a source of the registration request wherein when the information representing the result of the determination represents that the pull print instruction can be issued by communication the client terminal transmits the pull print instruction to the printing apparatus by communication.

According to embodiments of the present invention the URL of a print service is sent back to the user in accordance with the user environment. By using authentication of the print service the user can issue a print instruction to the printer while maintaining security without setting the period of validity. For example even after a PIN code is invalidated the user can issue a print instruction to the printer and need not go to the printer. In addition the user need not manually enter a PIN code and URL and can utilize pull print even by a printer having no program for handling a barcode or a printer having no operation panel for entering a PIN code.

Further features of the present invention will become apparent from the following description of exemplary embodiments with reference to the attached drawings .

Preferred embodiments of the present invention will now be described in detail with reference to the accompanying drawings.

The overall arrangement of a printing system in the embodiment will be explained with reference to a block diagram shown in . As shown in the embodiment assumes that a plurality of client terminals and a plurality of print devices are connected. Communication between apparatuses contained in the printing system may be wired communication using an Ethernet cable or wireless communication using a radio wave light or the like.

Referring to the client terminals a print server the print devices an authentication server and a mail server are connected via networks and . The networks and are communication networks formed from a LAN WAN telephone line dedicated digital line ATM frame relay line cable television line data broadcasting wireless channel or the like or are communication networks implemented by a combination of them. The networks and suffice to transmit data in two ways. Typically the network is the Internet and the network is a LAN.

A communication medium from the client terminal to the print server and print device and a communication medium from the print device to the print server may differ from each other. For example HTTP FTP e mail and the like may be switched and used. The client terminal is formed from a desktop personal computer notebook personal computer mobile personal computer PDA Personal Data Assistant or the like. However the client terminal may be a cell phone which incorporates a program execution environment. The client terminal incorporates an environment where a program such as a Web browser Internet browser WWW browser or a browser for using the World Wide Web is executed.

The print server accepts from the Web browser of the client terminal together with a print request information which identifies a document to be printed and information which specifies an output destination printer. Upon receiving a print request the print server sends back to the Web browser of the client terminal a response screen containing a print command to issue a print instruction. Then the Web browser of the client terminal can issue the received print command to a designated printer.

When the print device receives a print command from the Web browser of the client terminal it acquires document data to be printed from the print server and prints it. Similarly when the user enters an identification code to be referred to as a PIN code hereinafter from the operation panel of the print device and issues a print instruction the print device acquires document data to be printed from the print server and prints it. The authentication server manages user information of a user who accesses the print server . When the user accesses the print server from the client terminal via the Web browser the authentication server performs authentication. The print server receives for example e mail from the mail server and transmits to the mail address of the client terminal e mail with contents such as a PIN code and the URL of a corresponding print server. The e mail will be simply referred to as mail .

An example of the hardware arrangements of the print server and client terminal of the printing system in the embodiment will be explained with reference to a block diagram shown in . Note that the authentication server and mail server also have the same arrangement unless otherwise specified. The present invention is applicable to a system formed from a single device or a plurality of devices as long as the system can execute the functions of the present invention unless otherwise specified. Further the present invention is applicable to a system which is connected via a network such as a LAN or WAN and performs processing as long as the system can execute the functions of the present invention unless otherwise specified.

A CPU functioning as the controller of an information processing apparatus executes a plurality of application programs a print driver program an operating system and a printing system program stored in a hard disk HD . The CPU also performs control to temporarily store in a RAM information files and the like necessary to execute a program. The CPU opens various registered windows and executes various data processes based on commands designated with a mouse cursor not shown on a display . Printer creation processing in the embodiment is performed from a window displayed on the display of the client terminal .

A ROM serving as a nonvolatile memory internally stores programs such as a basic I O program and various data such as font data and template data used in document processing. The RAM serving as a temporary memory functions as a main memory work memory and the like for the CPU . A NIC Network Interface Controller serving as an input output interface is used when the information processing apparatus exchanges data with an external apparatus.

A keyboard functioning as an instruction input unit is used when the user inputs a command and the like to the print server and the like. The display functioning as a display unit displays a command and the like input from the keyboard . The HD serving as an external storage and functioning as a large capacity memory stores application programs a print driver program an OS Operating System and the like.

An example of the memory map of the RAM shown in will be explained with reference to . shows a memory map in a state in which a print control program is loaded into the RAM and becomes executable. The program is recorded on a storage medium such as an FD Flexible Disk or the like and read via an FD drive .

In this example the print control program and related data are directly loaded from the FD into the RAM and executed. Alternatively the print control program may be loaded into the RAM from the HD in which the print control program has already been installed. The medium which stores the print control program may be a CD ROM CD R PC card DVD or IC memory card other than the FD . The print control program can also be stored in the ROM to form part of the memory map and can be directly executed by the CPU . Software which implements the same functions as those of the above units can replace a hardware device.

In the RAM programs corresponding to the respective areas of a basic I O program OS print control program and related data are loaded and a work area is ensured. The basic I O program is a program having for example an IPL Initial Program Loading function of loading an OS from the HD into the RAM and starting the OS operation upon turning on the information processing apparatus.

An example of the memory map of the FD shown in will be explained with reference to . As shown in the FD stores volume information and directory information representing data information and further stores a print control program and related data . The print control program is a program based on a flowchart to be described later and the print server adopts the same arrangement in the embodiment.

An example of the software arrangement of the printing system in the embodiment will be explained with reference to . The print server includes a print job management service which manages a print job. The print job management service stores as print data in a storage document data or the like input from another service or another program. In the embodiment document data attached to mail is stored in the storage . The data format of print data is a predetermined format such as PDL or PDF. The print job management service may convert document data into a predetermined format and save it. The storage is a storage device such as an HDD incorporated in the print server an externally connected HDD or a network storage. In response to a print data request from the print device which has accepted a print instruction such as a print command the print job management service transmits corresponding print data to the request source.

A Web application creates a Web page displayable by a Web browser running on the client terminal and sends back the created Web page in response to a request from the Web browser . The Web application sends back print data in response to a print job acquisition request and receives the status of a job in print processing to be executed in the print device . For descriptive convenience does not illustrate an HTTP server which accepts an HTTP request from an HTTP client Web browser . The Web application and a Web service are applications which provide services on the HTTP. The Web application and Web service accept requests via an HTTP server not shown and function as back ends. However in the description of the embodiment the Web application and Web service directly accept a request from the Web browser or a pull print application . This also applies to the following description.

The pull print application activated in the print device accepts a print command from the Web browser and a print request input from the operation panel of the print device . In accordance with the accepted print instruction the pull print application requests print data from of the print server .

A mail management service of the print server periodically acquires information from the mail server . When document data is attached to mail received from the mail server the authentication server tries to authenticate the mail address. If the authentication is successful the mail management service stores the attached document data in the storage via the print job management service .

The authentication server holds authentication information as shown in . In this example the authentication information includes a user name password authentication token and user mail address used to access the print server by the user of the client terminal . Upon receiving a user authentication request together with authentication information the authentication server refers to the registered authentication information and if the received information matches the registered authentication information sends back an authentication success response to the request source.

When the Web application or Web service of the print server receives a request from the client terminal or print device it sends an authentication request to the authentication server . The user of the Web application is authenticated by collating a user name and password which are input from a login Web page displayed on the Web browser and contained in a login request with the user name and password held in the authentication server . If the authentication using the user name and password is successful the authentication server issues the authentication token to the authenticated user. The authentication token is transmitted to the Web browser serving as the authentication request source. The authentication token is further transferred from the Web browser to the pull print application together with a print command. When requesting print data of the print server in accordance with the print command the pull print application first presents the transferred authentication token to the Web service and then can receive authentication from the authentication server . This can ensure the security of pull print in the embodiment. The authentication token is also usable when the user accesses the print server via the Web browser. A period of validity can also be set for the authentication token. Although the period of validity of the authentication token depends on the authentication server a much longer period of validity for example several hours or several days than that of a PIN code can be generally set. The period of validity may be set separately for the authentication token used in pull print.

Note that the print job management service a printer management service the Web application the Web service and the mail management service are independent programs and can be installed in separate information processing apparatuses. These programs are installed in network connected information processing apparatuses and communicate with each other. These programs can also be installed in a single information processing apparatus.

An example of the software arrangement of the print server in the embodiment will be explained with reference to . Each software module of the print server is stored in the HD shown in loaded into the RAM and executed by the CPU as described above.

In the print server a print data management unit of the print job management service manages print data. Upon receiving a print data acquisition request from the Web service the print data management unit acquires designated print data from the storage and transfers it to the Web service .

A print job information management unit manages print job information of print data managed in the storage . The job information includes information such as a document ID client job ID device job ID document name job type print status acceptance date time final printing date time user name page count page size and print data link destination. The document ID is an ID for uniquely identifying print data in the print server . The client job ID is an ID which is issued by the client terminal to uniquely identify a print job for each client terminal. The device job ID is a job ID in the print device that is issued by the pull print application . The job type represents a data format such as PDL or PDF. The print status includes statuses such as waiting transferring printing normal end and error end.

A printer information management unit of the printer management service manages printer information of the print device managed by the print server . The printer information includes for example a printer name MAC address and URI. The MAC address is information for uniquely identifying each print device. The URI is an end point which receives a print request print command by the pull print application from the client terminal .

A session management unit of the Web application manages as a session a request from the Web browser successfully authenticated by the authentication server . A page generation unit creates a page screen to be displayed on the Web browser in response to a request from the Web browser for example a login screen or a screen for a print instruction and sends it back to the Web browser . A request acceptance unit accepts an event registration request print request and the like from the Web browser .

A request acceptance unit of the Web service accepts a print data acquisition request and print job status from the pull print application . When the request acceptance unit accepts the print data acquisition request a print job acquisition unit issues a print data acquisition request to the print job management service . Also the print job acquisition unit transmits print data acquired from the print job management service to the pull print application . A print status reception unit notifies the job management service of a print job status accepted by the request acceptance unit . The job management service specifies the notified print job and updates the status.

A mail information management unit of the mail management service stores document data attached to received mail in the storage . The mail information management unit generates a PIN code and a URL corresponding to user environment determination processing to be described later and sends back mail describing the generated information to the mail transmission source.

Note that the embodiment describes processing for document data received by mail but document data may be received via the Web service . A PIN code and a URL corresponding to a condition can similarly be transmitted for data received via the Web service . In this case the destination mail address is attached to document data or registered in advance in association with a user ID. The mail information management unit generates user information for each user upon receiving mail and manages it till the end of a print job having a document ID .

An example of the hardware arrangement of the print device will be described with reference to . An image reader reads a document fed from a document feed unit . The image reader and an image forming unit convert a read document or data received via a network into a print image and print it out. A discharge unit discharges printout paper and performs post processes such as sorting and stapling. A NIC is connected to a LAN or the Internet via a network and exchanges information with the outside.

A CPU loads a program stored in a ROM or HDD into a RAM and executes processing based on the program to control the respective units of the apparatus print device . The ROM serving as a nonvolatile memory stores programs and data regarding respective processes of the apparatus. The rewritable RAM electrically stores temporary data regarding respective processes of the apparatus. The HDD stores programs data temporary data and the like regarding respective processes of the apparatus. An operation unit operation panel displays a screen and accepts an operation instruction from the user via the screen.

In the embodiment the print device suffices to have a network connection function and printing function as hardware and the document feed unit and image reader may be omitted. The HDD and operation unit are not indispensable so may also be omitted .

The functions of the print device will be explained with reference to hierarchically showing the arrangement of the print device . An image forming unit executes a series of image forming processes such as paper handling image transfer and fixing and forms an image on a printing medium such as printing paper. The image forming unit includes for example an inkjet printer or electrophotographic image forming unit. An image reading unit includes a scanner and the like. The image reading unit optically reads a document image and converts it into digital image information. The image reading unit outputs the digital image information to the image forming unit to form an image or transmits it to an external apparatus via a facsimile unit network interface unit or the like.

A device controller controls the operations of the image forming unit and image reading unit . For example the device controller controls the image forming unit to copy document information read by the image reading unit . The device controller includes the network interface unit a print processing unit the facsimile unit and an operation unit control unit and controls exchange of information between these units. The facsimile unit transmits receives a facsimile image that is executes processing of transmitting digital image information read by the image reading unit or decoding a received facsimile signal and printing by the image forming unit .

The operation unit control unit controls to generate a signal corresponding to a user operation using the operation panel of the operation unit or display various data messages and the like on the operation unit or display unit . The print processing unit controls for example to process print data input via the network interface unit output it to the image forming unit and print. The network interface unit controls data transmission reception to from another communication terminal via a communication link.

A virtual machine is positioned above the device controller and can control the device controller . Both the device controller and virtual machine can directly use the network interface unit to independently access external networks. Applications described in a programming language corresponding to an API Application Programming Interface provided by the virtual machine exist above the virtual machine . The applications control the operation of the virtual machine via the API. These applications can work on the device controller indirectly via the virtual machine and can operate the image forming unit and image reading unit .

Note that the embodiment adopts the pull print application as an application. Details of the pull print application will be described with reference to . These applications can be uninstalled from the virtual machine or newly installed as applications to . The application is described as an application installed in the print device but may be arranged as hardware. Alternatively the application may be an application in a computer communicably connected to the print device as an external apparatus.

An external storage control unit converts an image read by the image reading unit into a data format savable in an external storage by the image forming unit and saves the converted image in the external storage. The external storage control unit reads out data saved in the external storage performs print processing via the image forming unit and network transmits the data to the outside via the network interface unit .

An example of the software arrangement of the pull print application in the embodiment will be described with reference to . Each software module of the pull print application is stored in the HDD loaded into the RAM and executed by the CPU as described above.

A Web service acceptance unit of the pull print application accepts an event registration request print command print request and the like from the Web browser . Upon receiving an event registration request the Web service acceptance unit notifies a print control unit job status monitor of event registration information. The event registration information includes the URI of an event transmission destination and a client ID for identifying a client. Upon receiving a print request the Web service acceptance unit notifies a print job acquisition unit of print request information. The print request information includes a URI authentication token client ID and client job ID which are contained in the received print request.

Upon receiving a print data acquisition request from the print job acquisition unit a Web service transmission unit acquires print data from the Web service and transfers it to the print job acquisition unit . Upon receiving a status notification request from the print control unit the Web service transmission unit notifies the Web service of a print job status.

The print job acquisition unit manages acquisition of print data based on print queue information in . shows print queue information corresponding to one print job. When a plurality of print jobs are registered in the queue information sets are registered by the number of print jobs. The print queue information is print job queue information including the URI the authentication token the client ID the client job ID and a device job ID . The URI indicates a print data save destination. In the embodiment the URI of the Web service is registered. In printing based on PIN code input an input PIN code is registered. The authentication token is an authentication token issued by the authentication server . The authentication token received from the Web browser together with a print command is added to a print request and transmitted to the Web service . The authentication token is transferred to the authentication server and collated with a registered authentication token to perform authentication. The client ID is an ID for identifying a client. In the embodiment the URI of the Web service is registered as the client ID. The client job ID is an ID which is issued by the client terminal to identify a job. In the embodiment a UUID Universally Unique IDentifier issued by the print server is registered in the client job ID. The device job ID is an ID for identifying a job to be executed by the print device . In the embodiment a value obtained by incrementing an integer starting from 1 by the print server in the acceptance order of print requests is registered.

The print job acquisition unit registers at the end of the print queue information the print request information notified from the Web service acceptance unit in response to a transmitted print request. The print request information transferred in response to the print request includes information to be registered in the print queue information such as the URI authentication token client ID and client job ID . The print job acquisition unit acquires print data via the Web service transmission unit based on print job information at the start of the print queue information . In the embodiment print data registered at a location indicated by the URI is acquired from the Web service .

A pull print controller manages the overall operation of the pull print application . An operation instruction to each unit and the like are issued via the pull print controller .

Processing when the print server receives mail from the client terminal via the mail server will be described with reference to a flowchart shown in . This processing will be explained as processing for document data received by mail. However for data received directly via the Web service a PIN code and URL can similarly be transmitted by mail. In such a case a source IP address of a packet carrying the received data is analyzed in step S rather than the mail header in order to determine whether the data was received from the intranet or not.

In step S the mail information management unit of the mail management service receives mail from the mail server . Note that the reception method is assumed to be a method of periodically inquiring from the mail information management unit to the mail server for mail but is not particularly limited to this method.

In step S the mail information management unit confirms whether the received mail has attached data e.g. an attached file or attached document. If the received mail has attached data the process advances to step S if the received mail does not have attached data the process ends. In step S the mail information management unit inquires whether the mail address of the received mail is managed by the authentication information in the authentication server . If the mail address is managed by the authentication information the process advances to step S if it is not managed by the authentication information the process ends.

In step S the mail information management unit saves in the storage the attached data of the received mail via the print job information management unit . The print job information management unit issues a document ID. The mail information management unit stores the mail address and document ID in a mail address area and the document ID area in the user information of . If necessary the data may be converted into a predetermined format such as PDF or PDL and then saved.

In step S the mail information management unit generates a PIN code and stores it in a PIN code area of the user information . In step S the mail information management unit analyzes header information of the received mail and acquires the IP address of the transmission source. For the PIN code a predetermined period of validity is also registered. When a fixed period of validity is determined in advance registration of the period of validity can be omitted by hard coding the fixed period of validity.

In step S the mail information management unit determines from the IP address acquired in step S whether the network environment user environment of the mail transmission source is an intranet or another network for example Internet . This determination method will be further described later with reference to a flowchart shown in .

If the mail information management unit determines in step S that a mail has come from an intranet serving as the user environment of the mail transmission source the process advances to step S. In step S the mail information management unit generates the URL of a print service to be provided to the print designated document and stores the generated URL in a URL area of the user information . The URL of the print service is that of the print server . In step S the mail information management unit describes in the mail body the PIN code generated in step S and the URL generated in step S and sends back the mail to the user of the transmission source via the mail server .

If the mail information management unit determines in step S that a mail has not come from an intranet serving as the user environment of the mail transmission source the process advances to step S. In step S the mail information management unit describes only the PIN code generated in step S in the mail body and sends back the mail to the user of the transmission source via the mail server .

The embodiment solves the problem of PIN code input by issuing a print instruction to the print device using communication without using a PIN code. However several problems occur when issuing a print instruction from the client terminal to the print device using communication. One problem is a firewall. When the client terminal and print device belong to different networks the firewall generally blocks a request from outside the network. When a pull print instruction is given to the print device by communication a printed material may be taken away from the print device by a person other than the user who issued the print instruction.

To prevent this the embodiment executes steps S and S in . If a client requesting registration of a document belongs to an intranet a print device in the same network is highly likely to be used. In this case even if a printed material is left in the printer a security problem is considered to hardly occur.

More specifically in step S it is determined whether a pull print instruction can be issued from the client terminal to the printing apparatus by communication. Step S is a step of if it is determined in step S that a pull print instruction can be issued by communication transmitting information that is the URL of a print service representing the determination result to the client terminal serving as the registration request source.

When the information representing the result of step S indicates that the pull print instruction can be issued by communication that is the information is a URL the client terminal transmits a pull print instruction to the printing apparatus by communication. However the pull print instruction is transmitted after login authentication so is not transmitted immediately.

The above mentioned user environment determination processing will be explained with reference to a flowchart shown in . In step S the mail information management unit acquires IP address setting information from an IP address setting information area of the user information . The IP address setting information is set in advance by the Web application and stores an IP address or IP address range used in an intranet. When no IP address setting information is set an IP address private IP address freely usable by a terminal present in an office network such as a LAN is used as IP address setting information.

In step S the mail information management unit compares the IP address acquired in step S with the IP address setting information. If the IP address acquired in step S falls within the range of the IP address setting information as a result of the comparison the process advances to step S to determine that the mail has come from the intranet. If the IP address does not fall within the range of the IP address setting information the process advances to step S to determine that the mail has come from the Internet.

Transition of a screen when the client terminal receives mail in the embodiment will be described with reference to a schematic view shown in . shows a case in which a URL generated in step S of is attached to the mail transmitted in S. A screen as displayed on the display of the client terminal represents the body of received mail and describes a document name PIN code and URL Job URL saved in the print server . When the user selects Job URL in the screen the Web browser of the client terminal is activated and a login screen for the authentication server appears to access the Web application . When the user logs in with a correct user ID and password the client terminal receives an authentication token corresponding to the login user from the authentication server and displays a selection screen for the output destination printer of the print server . When the period of validity is set for the authentication token the authentication server sets the period of validity to expire after the period of validity of a PIN code issued in step S. Alternatively no period of validity may be set. Output destinations displayed on the selection screen are for example a list of printers corresponding to printer addresses registered in advance for respective users. More preferably for example printers belonging to the same network as the client terminal serving as the transmission source of mail having a document to be registered are displayed as output destination choices. When the user selects an output destination and presses a print button on the selection screen a print instruction that is a print request or print command can be issued to the printer print device in this example . The print request is transmitted to the print device together with print data identification information document ID and authentication token via the network to which they both belong if the selected print device exists in the same network as that of the client or via the Internet. When the print request is transmitted via the Internet it is highly likely to be blocked by the firewall of a network to which the print device belongs. However when the client terminal and selectable print device exist in the same network blocking of the request by the firewall can be prevented by issuing a URL. When the print device which has received the print request operates normally and accepts the print request the pull print application operates according to the above described procedures to acquire designated print data and print. If printing has succeeded a print result screen appears. If printing has failed a screen representing a message to this effect appears. A screen is a modified screen which will be explained later.

Although not shown when only a PIN code is described in mail so when the result of the determination in S is NO the user manually enters the PIN code displayed in the mail from the operation panel of the print device and issues a print instruction similar to the conventional technique.

An update procedure is set separately when the period of validity of the authentication token has elapsed or the period of validity has expired . The procedure may be configured so that the user logs in again to the print server and transmits an authentication token whose period of validity has elapsed and the print server issues a new authentication token. This is merely an example and if the period of validity has elapsed registered print data may be deleted so the procedure has to be executed again from registration.

In the embodiment whether to send back a URL is determined in accordance with whether the transmission source in registering a document exists in the Internet or an intranet. However a URL may be sent back unconditionally without performing steps S and S. In this case a print request may not reach the destination owing to the firewall or a printed material may be read or taken away by a person other than the user who issued the print instruction. However the problem accompanying PIN code input can be solved.

By transmitting the URL of the print server to the client terminal the authentication server can be used via the print server upon receiving a print instruction. A print request from the print device is authenticated based on an acquired authentication token. Even after a PIN code is invalidated a print instruction can be issued safely. Since a print instruction can be issued to the print device via communication neither a PIN code nor URL need be input from the print device for the print instruction improving user friendliness.

The modification adds processing by the mail management service when printer information of a user who has transmitted mail exists in the printer management service . Processing by the mail management service in the modification will be explained with reference to a flowchart shown in . Note that the system arrangement client terminal arrangement respective server arrangements and print device arrangement are the same as those in the embodiment and a description thereof will not be repeated.

In the modification as shown in processing after it is determined in step S shown in that mail has come from an intranet will be explained. In step S the mail information management unit determines whether printer information of a user corresponding to the mail address can be acquired from the printer information management unit of the printer management service . Note that printer information of a user corresponding to the mail address is desirably information for specifying a printer belonging to the same network as a network to which the client terminal serving as the transmission source of mail belongs. If the printer information can be acquired the process advances to step S and the mail information management unit acquires from the printer information management unit the printer information of the user corresponding to the mail address. In step S pieces of URL information are created from by the number of pieces of printer information acquired in step S. The URL information includes a print server a document to be printed and an output destination printer name. If the mail information management unit determines in step S that the printer information cannot be acquired the process directly advances to step S.

In this modification the received mail describes URLs each containing an output destination see . When the user selects a URL and authentication on the login screen is performed successfully the output destination selection screen is skipped and the print result screen appears.

In the modification upon selection of a URL by the user the authentication server can perform authentication and the user can issue a print instruction without performing a further operation to select an output destination.

Aspects of the present invention can also be realized by a computer of a system or apparatus or devices such as a CPU or MPU that reads out and executes a program recorded on a memory device to perform the functions of the above described embodiment s and by a method the steps of which are performed by a computer of a system or apparatus by for example reading out and executing a program recorded on a memory device to perform the functions of the above described embodiment s . For this purpose the program is provided to the computer for example via a network or from a recording medium of various types serving as the memory device for example computer readable medium .

While the present invention has been described with reference to exemplary embodiments it is to be understood that the invention is not limited to the disclosed exemplary embodiments. The scope of the following claims is to be accorded the broadest interpretation so as to encompass all such modifications and equivalent structures and functions.

This application claims the benefit of Japanese Patent Application No. 2011 227440 filed Oct. 14 2011 which is hereby incorporated by reference herein in its entirety.

