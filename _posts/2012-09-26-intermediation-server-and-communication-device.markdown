---

title: Intermediation server and communication device
abstract: An intermediation server may receive one notification from a communication device. The one notification may include a plurality of identification information for identifying a plurality of target data to be communicated between the communication device and a specific server. The intermediation server may prepare a plurality of demand-creation data corresponding to the plurality of target data, and supply the plurality of demand-creation data to the communication device. Each of the plurality of demand-creation data may be necessary for the communication device to create one communication demand, and include timing information related to a timing at which the demand-creation data has been prepared. The intermediation server may prepare first demand-creation data, and then prepare second demand-creation data under a condition that the communication device has created a first communication demand by using the first demand-creation data and has sent the first communication demand to the specific server.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08860969&OS=08860969&RS=08860969
owner: Brother Kogyo Kabushiki Kaisha
number: 08860969
owner_city: Nagoya-Shi, Aichi-Ken
owner_country: unknown
publication_date: 20120926
---
This application claims priority to Japanese Patent Application No. 2011 256556 filed on Nov. 24 2011 the contents of which are hereby incorporated by reference into the present application.

The present specification discloses an intermediation server configured to intermediate a communication between a communication device and a specific server. The present specification further discloses a communication device configured to communicate with a specific server via an intermediation server.

For example an image processing device for scanning a document and creating image data is known. The image processing device can upload the image data to a server.

The present specification presents a technique that a communication device and a specific server may appropriately communicate a plurality of target data.

One aspect disclosed in the present application may be an intermediation server configured to intermediate a communication between a communication device and a specific server. The intermediation server may comprise a processor and a memory storing computer readable instructions therein. The computer readable instructions when executed by the processor may cause the intermediation server to perform receiving one notification from the communication device the one notification including a plurality of identification information for identifying a plurality of target data to be communicated between the communication device and the specific server preparing a plurality of demand creation data corresponding to the plurality of target data by using the plurality of identification information included in the one notification in a case where the one notification is received from the communication device each of the plurality of demand creation data being data which is necessary for the communication device to create one communication demand for communicating one target data corresponding to the demand creation data and each of the plurality of demand creation data including timing information related to a timing at which the demand creation data has been prepared and supplying the plurality of demand creation data to the communication device. The preparing the plurality of demand creation data may include preparing first demand creation data corresponding to first target data among the plurality of target data and preparing second demand creation data corresponding to second target data among the plurality of target data after preparing the first demand creation data under a condition that the communication device has created a first communication demand by using the first demand creation data and has sent the first communication demand to the specific server.

Another aspect disclosed in the present application may be a communication device configured to communicate with a specific server via an intermediation server. The communication device may comprise a processor and a memory storing computer readable instructions therein. The computer readable instructions when executed by the processor may cause the communication device to perform sending one notification to the intermediation server the one notification including a plurality of identification information for identifying a plurality of target data to be communicated between the communication device and the specific server the intermediation server being a server configured to prepare a plurality of demand creation data corresponding to the plurality of target data by using the plurality of identification information included in the one notification in a case where the one notification is received from the communication device each of the plurality of demand creation data being data which is necessary for the communication device to create one communication demand for communicating one target data corresponding to the demand creation data and each of the plurality of demand creation data including timing information related to a timing at which the demand creation data has been prepared obtaining the plurality of demand creation data from the intermediation server creating a plurality of communication demands by using the plurality of demand creation data and sending the plurality of communication demands to the specific server so as to communicate the plurality of target data with the specific server. The obtaining the plurality of demand creation data may include obtaining first demand creation data corresponding to first target data among the plurality of target data and obtaining second demand creation data corresponding to second target data among the plurality of target data after obtaining the first demand creation data under a condition that the communication device has created a first communication demand by using the first demand creation data and has sent the first communication demand to the specific server.

Moreover a control method a computer program that is computer readable instructions and a non transitory computer readable recording medium that stores the computer program all for realizing the intermediation server are also novel and useful. In addition a control method a computer program that is computer readable instructions and a non transitory computer readable recording medium that stores the computer program all for realizing the communication device are also novel and useful.

As shown in a communication system comprises a multi function device intermediation server and a plurality of service providing servers . The multi function device is connected with a LAN . The intermediation server and the plurality of service providing servers are connected with an internet .

The multi function device is capable of executing multiple functions such as a print function scan function copy function FAX function etc. The multi function device is further capable of downloading image data that is stored in the service providing servers and executing a download print function called DL print function below for printing the image represented by the image data. Further the multi function device is further capable of executing a scan upload function called scan UL function below for uploading to the service providing servers the image data created by the multi function device performing a scan.

The multi function device comprises an operation unit a display unit a network interface a print performing unit a scan performing unit and a control unit . The operation unit comprises a plurality of keys. A user can input various commands to the multi function device by operating the operation unit . The display unit is a display for displaying a variety of information. The network interface is connected with the LAN . The print performing unit is an inkjet type or laser type etc. printing mechanism. The scan performing unit is a CCD or CIS etc. scanning mechanism.

The control unit comprises a CPU and a memory . The CPU executes various processes according to programs stored in the memory . The functions of a notification sending unit an obtaining unit a creation unit and a target data communication unit are realized by the CPU executing processes according to the aforementioned programs.

The intermediation server is a server for intermediating provision of service to the multi function device from the service providing servers . The intermediation server is a server provided by a vendor of the multi function device . The intermediation server comprises a network interface and a control unit . The control unit comprises a CPU and a memory . The CPU executes various processes according to programs stored in the memory . The functions of a notification receiving unit a preparation unit and a supplying unit are realized by the CPU executing processes according to the programs.

Each of the service providing servers is a known cloud server for e.g. Evernote Registered Trademark Google Registered Trademark Does PICASA Registered Trademark FACEBOOK Registered Trademark etc. Each of the service providing servers is capable of providing service to various communication devices including the multi function device . For example the service providing servers are capable of executing an image supply service by which image data is supplied to the multi function device for the multi function device to execute the DL print function. Further for example the service providing servers are capable of executing an image storage service in which image data obtained from the multi function device is stored for the multi function device to execute the scan UL function.

Moreover the service providing server is a server provided by a first service provider i.e. a first company and the service providing server is a server provided by a second service provider i.e. a second company that is different from the first service provider. The first service provider exposes a first API Application Program Interface for receiving a service from the service providing server and the second service provider exposes a second API for receiving a service from the service providing server . Since the first service provider and the second service provider are different the first API and the second API are usually different. In order to receive services from for example both the service providing servers communication apparatuses must be compatible with both the first and the second API i.e. require a program for utilizing the first API and a program for utilizing the second API .

For example in order for the multi function device to receive services from each of the plurality of service providing servers the multi function device must be compatible with the plurality of APIs and must store many programs. However the memory capacity of the multi function device is smaller than that of a PC etc. Consequently in the present embodiment the intermediation server is provided so that the multi function device can receive services from each of the plurality of service providing servers without storing many programs in the multi function device . That is the intermediation server is compatible with a plurality of APIs for the plurality of service providing servers . In a situation where the multi function device is to receive a service from a specific service providing server e.g. the service providing server from among the plurality of service providing servers the intermediation server executes various communications to be described e.g. requests etc. of with the specific service providing server by using an API for the specific service providing server. Thereby the multi function device can communicate image data with the specific service providing server despite not being compatible with the API for the specific service providing server. That is the multi function device can receive a service from each of the plurality of service providing servers despite not storing many programs for using a plurality of APIs.

In order for the multi function device to receive services from the service providing servers a user of the multi function device called specific user below must execute the following advance preparation. Using for example a PC a PDA terminal e.g. a smartphone etc. the specific user creates an account with each of the service providing servers . Thereby each of the service providing servers gives an access token generally called authentication information to the specific user. The specific user registers the access tokens given by the service providing servers in the multi function device . Moreover using the PC PDA terminal etc. the specific user can upload various files e.g. image data to the service providing servers . Further using the PC PDA terminal etc. the specific user can also download various files that the specific user had uploaded.

Next contents of processes executed by the devices when the multi function device is to execute the DL print function will be described with reference to . Although not shown the specific user operates the operation unit of the multi function device so as to select the service providing server from which an image supply service is to be received. In the present embodiment the description will proceed using a case as an example where the specific user has selected the service providing server .

By further operating the operation unit the specific user selects the DL print function from among the plurality of functions that the multi function device is capable of executing. In this case the control unit of the multi function device sends an image ID request to the intermediation server . Moreover the multi function device sends the access token called specific access token below which the specific user received from the service providing server to the intermediation server at the stage of sending the image ID request to the intermediation server or at an earlier stage.

Upon receiving the image ID request from the multi function device the control unit of the intermediation server sends an image ID request to the service providing server . Moreover using the specific access token the control unit of the intermediation server causes the service providing server to execute authentication at the stage of sending the image ID request to the service providing server or at an earlier stage. Thereby the service providing server can send an appropriate response to the intermediation server in response to the image ID request received from the intermediation server . Moreover below a description of the authentication using the specific access token is omitted. However as required e.g. each time a request is sent to the service providing server the intermediation server causes the service providing server to execute authentication using the specific access token.

In the present embodiment a situation is assumed in which the service providing server is storing L pieces of image data L being an integer equal to 2 or more in association with the account of the specific user. Moreover in this situation for each of the L pieces of image data the service providing server is also storing thumbnail image data which has a smaller data size than the image data. Upon receiving the image ID request from the intermediation server the service providing server sends L pieces of image IDs e.g. file names of the L pieces of image data for identifying the L pieces of image data to the intermediation server .

Upon receiving the L pieces of image IDs from the service providing server the control unit of the intermediation server sends the L pieces of image IDs to the multi function device .

Moreover although not shown upon receiving the L pieces of image IDs from the intermediation server the control unit of the multi function device obtains L pieces of thumbnail image data corresponding to the L pieces of image data from the service providing server and causes L pieces of thumbnail images represented by the L pieces of thumbnail image data to be displayed in the display unit . Thereby the specific user can operate the operation unit to select a thumbnail image which from among the L pieces of thumbnail images corresponds to the image of the download target.

In the present embodiment a situation is assumed in which M1 pieces of thumbnail images i.e. a plurality of thumbnail images M1 being an integer equal to or less than L and equal to 2 or more are selected from among the L pieces of thumbnail images. For example the specific user operates an OK button after specifying the M1 pieces of thumbnail images. Thereby the control unit of the multi function device selects the M1 pieces of thumbnail images according to an instruction of the specific user. The present embodiment does not assume a situation in which a plurality of thumbnail images is selected non simultaneously such as in a case where after one thumbnail image has been selected and printed another thumbnail image is selected and printed. Instead a situation is assumed in which a plurality i.e. M1 pieces of thumbnail images is selected simultaneously. Moreover selecting the M1 pieces of thumbnail images simultaneously is identical to selecting M1 pieces of image IDs simultaneously.

Moreover in the present embodiment the L pieces of thumbnail images are displayed in the multi function device . However in a variant the L pieces of image IDs e.g. the file names of the L pieces of image data may be displayed without the multi function device displaying the L pieces of thumbnail images. From among the L pieces of image IDs the specific use may select M1 pieces of image IDs corresponding to M1 pieces of images of the download target.

When the M1 pieces of image IDs are simultaneously selected the notification sending unit see of the multi function device creates a notification that includes the M1 pieces of image IDs. Moreover one communication data that is commonly known usually includes one header section and one body section. The notification is not described with the M1 pieces of image IDs distributed in a plurality of body sections included in a plurality of communication data but is described with all the M1 pieces of image IDs in one body section included in one communication data. That is the notification can be called one notification one communication data . The notification sending unit sends the notification to the intermediation server .

The notification receiving unit see of the intermediation server receives the notification from the multi function device . In this case the preparation unit see of the intermediation server creates a list in which the M1 pieces of image IDs included in the notification are described and sends the list to the multi function device .

The obtaining unit see of the multi function device receives the list from the intermediation server . In this case the obtaining unit selects one image ID called first image ID below from among the M1 pieces of image IDs included in the list . Next the obtaining unit creates a URL request that includes the first image ID and sends the URL request to the intermediation server . That is the URL request includes only one image ID the first image ID from among the M1 pieces of image IDs.

The preparation unit of the intermediation server receives the URL request from the multi function device . In this case following the first API for the service providing server the preparation unit creates a URL request in which the first image ID included in the URL request is described and sends the URL request to the service providing server .

Moreover as described above in the example of the communication of the URL request is executed via the communications of the notification the list and the URL request . These communications are executed according to RESTful Representational State Transfer ful . However in a variant the communications of the list and the URL request need not be executed after the notification has been sent from the multi function device to the intermediation server . In this case the preparation unit of the intermediation server may select the first image ID from among the M1 pieces of image IDs included in the notification then may create the URL request in which the first image ED is described and send the URL request to the service providing server .

Upon receiving the URL request the service providing server identifies one URL i.e. a URL of a download source called first URL below that indicates a location within the server of one image data corresponding to the first image ID included in the URL request . Next the service providing server sends the first URL to the intermediation server .

The preparation unit of the intermediation server obtains the first URL by receiving the first URL from the service providing server . In this case in accordance with the first API the preparation unit prepares i.e. creates a template that includes the first URL. The template includes data necessary for the multi function device to create an HTTP Hyper Text Transfer Protocol POST command. In the present embodiment the service providing server is using the POST command as a command for triggering provision of a service image supply service and image storage service . Consequently the preparation unit prepares the template which has a POST command format. Moreover a time stamp is described in the POST command of the present embodiment. Consequently the preparation unit prepares the template that includes not only the first URL but also a time stamp indicating the current date and time i.e. the date and time at which the template was prepared . The preparation unit sends the template to the multi function device thereby supplying the template to the multi function device .

As described above the service providing server is using the POST command. However the command that is used depends on the service providing server. For example the service providing server is using a GET command as a command for triggering the provision of a service. If the specific user were to desire receiving a service from the service providing server the preparation unit would prepare a GET command template according to the second API for the service providing server . A time stamp is not described in the GET command of the present embodiment. Consequently when preparing the GET command template the preparation unit prepares a template that does not include a time stamp. Thus the preparation unit can create an appropriate template in accordance with the service providing server that is to execute communication with the multi function device .

The obtaining unit of the multi function device obtains the template from the intermediation server by receiving the template from the intermediation server . In this case the creation unit see of the multi function device creates a POST command by using the template . Specifically the creation unit creates the POST command by describing the IP address of the multi function device as the source address together with using the information the first URL time stamp etc. described in the template without making any change thereto. Next the target data communication unit see of the multi function device sends the POST command to the service providing server without going through the intermediation server .

Upon receiving the POST command the service providing server first determines whether the difference between the current date and time and the date and time indicated in the time stamp included in the POST command is greater than a predetermined period. In a case where the difference is greater than the predetermined period the service providing server sends information indicating an error to the multi function device . In this case the multi function device cannot obtain the image data. On the other hand in a case where the difference is smaller than the predetermined period the service providing server sends the image data that is stored in the first URL included in the POST command i.e. the URL of the download source to the multi function device without intermediating through the intermediation server . In the present embodiment the image data is communicated without intermediating through the intermediation server and therefore private images of the specific user can be prevented from being transmitted through the intermediation server .

The target data communication unit of the multi function device receives the image data from the service providing server . When all the image data has been received from the service providing server i.e. when the communication of the image data ends the control unit of the multi function device causes the image represented by the image data to be printed by the print performing unit . Thereby the multi function device can receive the image supply service from the service providing server and can execute the DL print function.

After printing of the image represented by the image data has started moreover this may be before or after the printing has ended the obtaining unit of the multi function device selects one image ID called second image ID below this being different from the first image ID from among the M1 pieces of image IDs included in the list . Next the obtaining unit creates a URL request that includes the second image ID and sends the URL request to the intermediation server . That is the URL request includes only one image ID i.e. the second image ID from among the M1 pieces of image IDs.

The processes of the devices after the URL request has been sent are the same as described above. That is the preparation unit of the intermediation server creates a URL request in which the second image ID is described and sends the URL request to the service providing server thereby receiving a URL of image data corresponding to the second image ID called second URL below from the service providing server .

Next the preparation unit of the intermediation server prepares i.e. creates according to the first API a template that includes the second URL. Moreover as is clear from the above description the preparation unit prepares the template after the multi function device has sent the POST command to the service providing server . More specifically the preparation unit prepares the template after the communication of the image data between the multi function device and the service providing server has been completed. Consequently the date and time indicated by the time stamp included in the template is later than the date and tune indicated by the time stamp included in the template . Next the preparation unit supplies the template to the multi function device .

Next the obtaining unit of the multi function device obtains the template from the intermediation server and the creation unit creates a POST command by using the template . Next the target data communication unit sends the POST command to the service providing server thereby receiving the image data from the service providing server . Consequently the control unit causes the image represented by the image data to be printed by the print performing unit .

The processes executed by the devices from the communication of a URL request e.g. the URL requests from the multi function device to the intermediation server until the printing of an image represented by image data the image data in the above example are called one set of processes . As described above in the present embodiment the M1 pieces of image IDs are selected simultaneously by the specific user. The multi function device repeatedly sends a URL request that includes only one image ID e.g. the URL requests to the intermediation server downloading the image data one by one. Consequently in the example of M1 sets of processes are executed in total.

Next contents of processes executed by the devices when the multi function device is to execute the scan UL function will be described with reference to . Although not shown the specific user operates the operation unit of the multi function device selecting the service providing server from which the image storage service is to be received. In the present embodiment the description will proceed using the case as an example where the specific user has selected the service providing server .

By further operating the operation unit the specific user selects the scan UL function from among the plurality of functions the multi function device is capable of executing. In this case the control unit of the multi function device causes the scan performing unit to scan a document. In the present embodiment a situation is assumed in which M2 sheets M2 being an integer equal to 2 or more of a document are scanned and M2 pieces of image data are created. That is the present embodiment does not assume a situation in which a plurality of image data is created non simultaneously by scanning one sheet of a document to create one image data and then after the one image data has been uploaded to the service providing server another one sheet of the document is scanned creating another one image data. Instead a situation is assumed in which the M2 pieces of image data are created simultaneously.

When the M2 pieces of image data have been created the notification sending unit of the multi function device creates one notification that includes M2 pieces of image IDs e.g. file names of the M2 pieces of image data corresponding to the M2 pieces of image data and sends the notification to the intermediation server .

The notification receiving unit of the intermediation server receives the notification from the multi function device . The subsequent processes are substantially the same as the processes of . That is the preparation unit of the intermediation server creates a list in which the M2 pieces of image IDs included in the notification are described and sends the list to the multi function device .

Next the obtaining unit of the multi function device selects one image ID called third image ID below from among the M2 pieces of image IDs included in the list . Next the obtaining unit creates a URL request that includes the third image ID and sends the URL request to the intermediation server .

Next the preparation unit of the intermediation server creates according to the first API a URL request in which the third image ID is described and sends the URL request to the service providing server . In this case the service providing server sends to the intermediation server a URL that indicates a location within the server where one image data corresponding to the third image ID included in the URL request is to be stored i.e. a URL of an upload destination called third URL below .

Next following the first API the preparation unit of the intermediation server prepares i.e. creates a POST command template that includes the third URL and a time stamp. The supplying unit supplies the template to the multi function device .

The obtaining unit of the multi function device obtains the template from the intermediation server and the creation unit creates a POST command by using the template . Moreover the creation unit creates the POST command by describing in the POST command one image data i.e. image data created by scanning corresponding to the third image ID. Next the target data communication unit sends the POST command to the service providing server without intermediating through the intermediation server thereby sending the image data to the service providing server . In the present embodiment the POST command is communicated without intermediating through the intermediation server and therefore private images of the specific user can be prevented from being transmitted through the intermediation server .

In this case the service providing server stores the image data at the location indicated by the third URL i.e. the URL of the upload destination . Thereby the multi function device can receive the image storage service from the service providing server and can execute the scan UL function. Moreover in case the image data could be stored appropriately the service providing server sends information indicating OK to the multi function device .

After the information indicating OK has been received from the service providing server i.e. after the communication of the image data has been completed the obtaining unit of the multi function device selects one image ID called fourth image ID below this being different from the third image ID from among the M2 pieces of image IDs included in the list . Next the obtaining unit creates a URL request that includes the fourth image ID and sends the URL request to the intermediation server .

The processes of the devices after the URL request has been sent are the same as described above. That is the preparation unit of the intermediation server creates a URL request in which the fourth image ID is described and sends the URL request to the service providing server thereby receiving a URL of image data corresponding to the fourth image ID called fourth URL below from the service providing server .

Next the preparation unit of the intermediation server prepares i.e. creates following the first API a template that includes the fourth URL and a time stamp. Moreover as is clear from the above description the preparation unit prepares the template after the multi function device has sent the POST command to the service providing server . More specifically the preparation unit prepares the template after the communication of one image data corresponding to the third image ID communication of the POST command between the multi function device and the service providing server has been completed. The supplying unit supplies the template to the multi function device .

Next the obtaining unit of the multi function device obtains the template from the intermediation server and the creation unit creates a POST command that includes one image data corresponding to the fourth image ID by using the template . Next the target data communication unit sends the POST command to the service providing server thereby sending the image data to the service providing server . Consequently the service providing server stores the image data at the location indicated by the fourth URL and sends information indicating OK to the multi function device .

The processes executed by the devices from the communication of a URL request e.g. the URL requests from the multi function device to the intermediation server until the communication of the information indicating OK from the service providing server to the multi function device are called one set of processes . As described above in the present embodiment the M2 pieces of image data are created simultaneously. The multi function device repeatedly sends a URL request that includes only one image ID e.g. the URL requests to the intermediation server uploading the image data one by one. Consequently in the example of M 2 sets of processes are executed in total.

In a comparative example of upon receiving one notification that includes M3 pieces of image IDs M3 being an integer equal to 2 or more from the multi function device the intermediation server sends a URL request that includes the M3 pieces of image IDs to the service providing server thereby receiving M3 pieces of URLs each of which may be a URL of a download source or a URL of an upload destination from the service providing server.

Next the intermediation server prepares M3 pieces of templates by using the M3 pieces of URLs and supplies the M3 pieces of templates to the multi function device. In this case the multi function device sequentially uses the M3 pieces of templates to sequentially create M3 pieces of POST commands and sequentially sends the M3 pieces of POST commands to the service providing server. However in the comparative example the M3 pieces of templates are prepared substantially simultaneously and consequently a time stamp included in each template shows substantially the same date and time. Within these M3 pieces of templates templates which are used comparatively later in the multi function device can have a large time difference between the timing at which the template was prepared and the timing at which a POST command created using that template is sent. Consequently when receiving the POST command which among the M3 pieces of POST commands is sent comparatively late the service providing server may determine that the difference between the current date and time and the date and time shown in the time stamp included in the POST command may be greater than the predetermined period. In this case the service providing server determines that the time stamp is invalid and sends information indicating an error to the multi function device . That is the multi function device cannot download or upload the image data. In particular the greater the value of M3 the more readily this event occurs.

By contrast in the present embodiment as shown in and the intermediation server prepares the template or after the multi function device has created the POST command or by using the template or and has sent the POST command or to the service providing server . Consequently it is possible to prevent a large time difference being present between the timing at which the template or is prepared and the timing of sending the POST command or which was created by using the template or . Consequently it is possible to prevent the service providing server from determining that the time stamp is invalid. That is the intermediation server can prepare the template or at the appropriate timing and consequently the template or includes the appropriate time stamp which the service providing server will not readily determine to be invalid. Consequently the multi function device and the service providing server can appropriately execute the communication downloading or uploading of a plurality of image data.

The multi function device and the service providing server are respectively examples of the communication device and the specific server . The M1 pieces of image IDs or the M2 pieces of image IDs are examples of the plurality of identification information . The M1 pieces of image data or the M2 pieces of image data are examples of the plurality of target data . The templates or the templates are examples of the plurality of demand creation data . Further the POST commands or the POST commands are examples of the communication demand .

For example the first image ID the URL request the first URL the image data the template and the POST command are respectively examples of the first identification information first request first location information first target data first demand creation data and first communication demand . Further the second image ID the URL request the second URL the image data and the template are respectively examples of the second identification information second request second location information second target data second demand creation data and second communication demand .

Processes for the multi function device of a second embodiment to execute the DL print function will be described with reference to . The communication of a notification and a list is the same as the communication of the notification and the list of . The obtaining unit of the multi function device selects N pieces of image IDs N being an integer equal to or more than 2 and less than M1 these being a part of the M1 pieces of image IDs included in the list and sends a URL request that includes the N pieces of image IDs to the intermediation server .

Next the preparation unit of the intermediation server creates a URL request in which the N pieces of image IDs are described and sends the URL request to the service providing server thereby receiving from the service providing server URLs of N pieces of image data corresponding to the N pieces of image IDs. Next following the first API the preparation unit prepares i.e. creates N pieces of templates using the N pieces of URLs. Moreover the date and time shown by the time stamps included in the N pieces of templates are substantially identical. The preparation unit supplies the N pieces of templates to the multi function device .

The obtaining unit of the multi function device obtains the N pieces of templates from the intermediation server and the creation unit creates a POST command by using one template from among the N pieces of templates . The target data communication unit sends the POST command to the service providing server thereby receiving image data from the service providing server . Consequently the control unit causes an image represented by the image data to be printed by the print performing unit .

Next the creation unit creates a POST command by using another template from among the N pieces of templates . The target data communication unit sends the POST command to the service providing server thereby receiving image data from the service providing server . Consequently the control unit causes an image represented by the image data to be printed by the print performing unit . This process is repeated N times. That is the multi function device downloads N pieces of image data from the service providing server and prints N pieces of images.

The processes executed by the devices from the communication of a URL request e.g. the URL request from the multi function device to the intermediation server until the printing of N pieces of images is called one set of processes . Upon ending a first set of processes the obtaining unit of the multi function device selects another N pieces of image IDs that are a part of the M1 pieces of image IDs included in the list i.e. N pieces of image IDs that are different from the N pieces of image IDs selected in the first set and sends to the intermediation server a URL request that includes the N pieces of image IDs. Thereby a second set of processes is executed. As described above in the present embodiment M2 pieces of image IDs are selected simultaneously by the specific user. The URL request from the multi function device to the intermediation server e.g. the URL request includes N pieces of image IDs. Consequently in the example of M1 N sets of processes are executed in total.

Moreover processes for the multi function device to execute the scan UL function are executed in the same manner as in the example of . For example in case M2 pieces of image data are created simultaneously by the multi function device executing a scan the multi function device selects N pieces of image IDs which are a part of the M2 pieces of image IDs and sends a URL request that includes the N pieces of image IDs to the intermediation server . Consequently in a first set of processes the multi function device can upload N pieces of image data to the service providing server . Then the multi function device selects subsequent N pieces of image IDs which are a part of the M2 pieces of image IDs and sends a URL request that includes the N pieces of image IDs to the intermediation server . Consequently in a second set of processes the multi function device can upload N pieces of image data to the service providing server .

In the present embodiment as shown in in the first set of processes the multi function device creates the N pieces of POST commands by using the N pieces of templates and sends the N pieces of POST commands to the service providing server . Then subsequently in the second set of processes the intermediation server prepares the next N pieces of templates. Consequently it is possible to prevent there being a large time difference between the timing at which the template is prepared in the second set of processes and the timing of sending the POST command which was created by using that template. Consequently it is possible to prevent the service providing server from determining that the time stamp is invalid. As a result the multi function device and the service providing server can appropriately execute the communication downloading or uploading of a plurality of image data.

The N pieces of image IDs included in the URL request sent in the first set of processes called URL request of the first set below are an example of the N1 pieces of identification information . The N pieces of image IDs included in the URL request sent in the second set of processes called URL request of the second set below are an example of the N2 pieces of identification information . Moreover in the above embodiment the number N pieces of image IDs included in the URL request of the first set and the number N pieces of image IDs included in the URL request of the second set are identical. However in a variant the number of former image IDs and the number of latter image IDs may differ.

Further the URL request of the first set and the URL request of the second set are respectively examples of the first request and the second request . Further one image ID from among the N pieces of image IDs included in the URL request of the first set and one image ID from among the N pieces of image IDs included in the URL request of the second set are respectively examples of the first identification information and the second identification information .

The communication device is not limited to the multi function device but may be another type of communication device e.g. PC server PDA mobile terminal printer scanner telephone FAX device copier etc. . Further the specific server is not limited to the service providing server that provides cloud service but may be another type of server that performs communication of data with the communication device e.g. a server that executes image processing on image data . Further the target data is not limited to the image data but may be another type of data e.g. may be data created by word processing software or data created by spreadsheet software .

In the above embodiments as shown for example in the preparation unit of the intermediation server prepares the template under the condition that the communication of the image data between the multi function device and the service providing server has been completed by the multi function device sending the POST command to the service providing server . Instead the preparation unit may prepare the template after the multi function device has sent the POST command to the service providing server and before the communication of the image data ends. In order to realize the present variant for example the obtaining unit of the multi function device may send the URL request to the multi function device while the image data is being downloaded from the service providing server . Generally speaking the preparation unit of the intermediation server may prepare the second demand creation data under the condition that the communication device has sent the first communication demand to the specific server. Further the obtaining unit of the multi function device may obtain the second demand creation data from the intermediation server under the condition that the first communication demand has been sent to the specific server.

In the above embodiments the preparation unit of the intermediation server prepares the template e.g. the template of necessary for the multi function device to create the POST command. However the preparation unit may prepare a template necessary for the multi function device to create another type of command e.g. a GET command . Generally speaking the preparation unit of the intermediation server may prepare demand creation data that includes timing information. Further the creation unit of the multi function device may create the communication demand by using the demand creation data.

In the above embodiments the template includes the time stamp that shows the date and time the template was prepared. Instead the template may include a time stamp that shows only the date the template was prepared or may include a time stamp that shows only the time the template was prepared. Further the template may include a time stamp that shows a date and time to which a predetermined time has been added to the date and time of preparing the template i.e. a date and time indicating the period of validity of the template . Moreover the timing information is not limited to information having the appellation time stamp but may be information having another appellation. Generally speaking the timing information may be any information related to the timing at which the demand creation data was prepared.

In the second embodiment the preparation unit of the intermediation server prepares the N pieces of templates . Instead the preparation unit of the intermediation server may create one template and N pieces of information which are to be described in the template the N pieces of information here include for example N pieces of URLs and one time stamp . In this case the creation unit of the multi function device may describe one information from among the N pieces of information in the one template thereby creating the POST command and may describe another information from among the N pieces of information into the one template thereby creating the POST command . In the present variant the N pieces of information are an example of the demand creation data .

In the above embodiments the functions of the units to to are realized by the CPUs of the multi function device and the intermediation server executing processes according to software. Instead at least a part of the functions of the units to to may be realized by hardware such as a logic circuit etc.

