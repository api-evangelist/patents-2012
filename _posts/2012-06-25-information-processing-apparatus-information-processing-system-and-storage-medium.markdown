---

title: Information processing apparatus, information processing system, and storage medium
abstract: An information processing apparatus, which is connected via a network to plural execution apparatuses, includes a receiving unit configured to receive function validity information from the execution apparatuses; a reception unit configured to receive an execution request for requesting the execution apparatuses to execute a requested function, which execution request does not include information identifying one of the execution apparatuses where the requested function is to be executed; a determining unit configured to determine execution apparatuses where the requested function is valid based on the function validity information; a display control unit configured to cause a display unit to display information indicating the determined execution apparatuses where the requested function is valid based on the determination result; and a transmitting unit configured to send the execution request to a selected execution apparatus when a reception instruction to receive the execution request is entered on the selected execution apparatus.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08990373&OS=08990373&RS=08990373
owner: Ricoh Company, Ltd.
number: 08990373
owner_city: Tokyo
owner_country: JP
publication_date: 20120625
---
The present application is based upon and claims the benefit of priority of Japanese Patent Application No. 2011 148383 filed on Jul. 4 2011 the entire contents of which are incorporated herein by reference.

An aspect of this disclosure relates to an information processing apparatus an information processing system and a storage medium.

Japanese Laid Open Patent Publication No. 2010 157027 discloses programs called net applications that are installed in personal computers PCs connected via a network with image forming apparatuses. The net applications cause the PCs to perform process flows in collaboration with the image forming apparatuses.

In the technology disclosed in JP2010 157027 information associated with the net applications running on the PCs is sent to the image forming apparatuses via broadcasts called advertisements. More specifically when the net applications are started users who have started the net applications are advertised on the network. Each image forming apparatus receives the advertisements from the PCs and manages a list of users who have started the net applications on the respective PCs. In response to a command from an operator a user the image forming apparatus displays the list of users on an operations panel. When the operator selects the corresponding user from the list of users a list of net applications that have been started on the PC of the selected user is downloaded into the image forming apparatus. Then the operator can select and use one of the net applications in the list of net applications.

The above configuration enables a user to select a desired image forming apparatus from image forming apparatuses installed in for example an office and to use net applications on the selected image forming apparatus.

However image forming apparatuses installed in an office do not necessarily have the same functions. For example color image forming apparatuses and monochrome image forming apparatuses may be installed in an office. As another example multifunction peripherals that have printing and scanning functions and printers that have only the printing function may coexist in an office.

For this reason there may be a case where a selected image forming apparatus does not have a function to be used by a net application selected by the user on that image forming apparatus. In such a case the user cannot obtain an expected result and needs to operate another image forming apparatus to select and execute the net application.

The above problem reduces the working efficiency of the user and may result in waste of resources such as paper.

In an aspect of this disclosure there is provided an information processing apparatus connected via a network to plural execution apparatuses. The information processing apparatus includes a receiving unit configured to receive function validity information from each of the execution apparatuses which function validity information indicates functions that are valid in the respective execution apparatuses a reception unit configured to receive an execution request for requesting the execution apparatuses to execute a requested function which execution request does not include information identifying one of the execution apparatuses where the requested function is to be executed a determining unit configured to determine one or more of the execution apparatuses where the requested function is valid based on the function validity information a display control unit configured to cause a display unit to display information indicating the one or more of the execution apparatuses where the requested function is valid based on a result of the determination by the determining unit and a transmitting unit configured to send the execution request to a selected execution apparatus of the execution apparatuses when a reception instruction to receive the execution request is entered on the selected execution apparatus.

Preferred embodiments of the present invention are described below with reference to the accompanying drawings. is a drawing illustrating an exemplary configuration of an information processing system according to an embodiment. As illustrated in the information processing system includes one or more image forming apparatuses and one or more user terminals that are connected via a wired or wireless network such as a local area network LAN or the Internet. For descriptive purposes the image forming apparatuses and the user terminals may be expressed in the singular form.

The image forming apparatus may be for example a multifunction peripheral including two or more functions such as printing scanning copying and facsimile transmission and reception. Alternatively the image forming apparatus may be an apparatus such as a printer a scanner a copier or a facsimile machine having one function. The image forming apparatus is an example of an execution apparatus.

The user terminal may be implemented by any type of device that can store and execute a software program and has a communication function. For example the user terminal may be implemented by a desktop personal computer PC a notebook PC a personal digital assistant PDA a cell phone or a smartphone. The user terminal is an example of an information processing apparatus.

An exemplary software configuration of the user terminal is described below. As illustrated in the user terminal may include a print widget a scan widget a widget manager document application a printer driver and an operating system OS .

The print widget and the scan widget are examples of application programs that are collectively called widgets or the widget in the singular form in the present application. In these years simple application programs are often called widgets or gadgets. In the present application application programs that can be easily installed and used are called the widgets and the term widget does not limit the technical scope of the application programs. The widgets perform predetermined process flows such as workflows by using functions of or in collaboration with the image forming apparatus .

The print widget requests the image forming apparatus to execute a print job for print data generated for a logical printer.

The scan widget requests the image forming apparatus to scan a document to obtain image data and stores the obtained image data in the user terminal .

The widget manager interfaces communications between the widgets and the image forming apparatus . Each of the widgets may include an interface and a protocol defined by the widget manager . In other words the widgets are application programs that operate in cooperation with the widget manager .

The document application is software such as a word processor or a spreadsheet for creating electronic document data that can be printed. Although the document application is represented by one block in the document application may represent two or more application programs that can create document data of various data formats.

The printer driver generates print data from document data generated by the document application . When a logical printer corresponding to the print widget is specified as a print destination the printer driver generates an intermediate file with a file name specified as the output destination of the logical printer and outputs the print data to the intermediate file.

The OS is an operating system. Software programs in the user terminal run as processes or threads on the OS .

An exemplary software configuration of the image forming apparatus is described below. As illustrated in the image forming apparatus may include standard applications SDK applications an SDK platform a control service and an OS .

The standard applications are default applications installed in the image forming apparatus before the factory shipment. In the example of the standard applications include a scan application a print application a copy application and a fax application . The scan application performs a scan job. The print application performs a print job. The copy application performs a copy job. The fax application performs a facsimile transmission job and a facsimile reception job.

The control service is implemented by software modules that for example provide upper layer applications with functions for controlling various hardware resources. The functions for example include a network communication function a scanner control function a printer control function and a memory management function.

The SDK applications are plug in applications that are additionally installed to expand the functions of the image forming apparatus after its factory shipment. In a provider application is provided as an example of the SDK application . The provider application performs a process to enable operations of the widgets from the image forming apparatus .

The SDK platform provides an execution environment for the SDK applications . The SDK applications are developed using application programming interfaces API provided by the SDK platform . For example the SDK platform provides the SDK applications with a scan function interface a print function interface and a copy function interface. APIs provided by the SDK platform may be made public to allow a third party to develop the SDK applications .

The OS is an operating system. Software programs in the image forming apparatus run as processes or threads on the OS .

Hardware configurations of the image forming apparatus and the user terminal are described below. is a block diagram illustrating an exemplary hardware configuration of the image forming apparatus . As illustrated in the image forming apparatus may include as hardware components a controller a scanner a printer a modem an operations panel a network interface and a secure digital SD card slot .

The controller includes a CPU a RAM a ROM and an HDD . The ROM stores for example programs and data used by the programs. The RAM is used for example as a storage area into which programs are loaded and as a work area for the loaded programs. The CPU executes the programs loaded into the RAM to implement various functions. The HDD stores for example programs and data used by the programs.

The scanner is a hardware component for scanning a document to obtain image data. The printer is a hardware component for printing print data on a recording medium such as paper. The modem is a hardware component for connecting the image forming apparatus to a telephone line and is used to send and receive image data for facsimile communications. The operations panel is a hardware component including an input unit such as buttons for receiving user inputs and a display unit such as a liquid crystal display panel. The network interface is a hardware component for connecting the image forming apparatus to a wired or wireless network such as a local area network LAN . The SD card slot reads for example programs stored in a secure digital SD card . With the image forming apparatus configured as described above in addition to the programs stored in the ROM and the HDD programs stored in the SD card can be loaded into the RAM and executed. Instead of the SD card any other storage medium e.g. a CD ROM or a universal serial bus USB memory may be used for this purpose. That is a storage medium that can be mounted on the image forming apparatus is not limited to the SD card . When a storage medium other than the SD card is used the SD card slot may be replaced with a hardware component corresponding to the storage medium used.

Programs for implementing various processes at the user terminal may be provided via a storage medium such as a CD ROM or a memory card. When the storage medium storing programs is mounted on the drive unit the programs are read by the drive unit from the storage medium and are installed in the secondary storage unit . The programs may not necessarily be installed from the storage medium . Alternatively the programs may be downloaded via a network from another computer. The secondary storage unit stores the installed programs and other necessary files and data.

The memory temporarily stores programs read from the secondary storage unit when the programs are executed. The CPU implements functions of the user terminal according to the programs temporarily stored in the memory . The interface unit provides communication interfaces such as a network interface a universal serial bus USB interface and a wireless interface e.g. Bluetooth interface . The display unit displays for example graphical user interfaces GUI output by the programs. The input unit includes for example a keyboard a pointing device such as a mouse and or buttons for receiving user inputs.

The widget the widget manager and the provider application are described below in more detail. is a block diagram illustrating exemplary functional configurations of the widget the widget manager and the provider application according to the present embodiment.

As illustrated in the widget may include a widget UI unit a widget information transmitting unit a linkage unit a logic unit a valid apparatus query unit and an attribute information management file .

The widget UI unit controls various display and input operations or processes related to the widget . The widget information transmitting unit sends a widget information registration request requesting registration of widget information attribute information of the widget to the widget manager when the widget is started. The widget information may include identification information hereafter referred to as linked function identifiers of functions hereafter called linked functions of the image forming apparatus which are used by the widget . The linked functions are functions that need to be included in the image forming apparatus that collaborates with the widget . In other words the linked functions are functions that the widget requests the image forming apparatus to execute.

The linkage unit controls communications e.g. transmission and reception of information for collaboration with the provider application . The attribute information management file contains attribute information of the widget . The attribute information includes configuration information of the widget . The configuration information includes parameters that define a behavior of the widget or a job performed by the widget . The logic unit implements functions unique to the widget . For example the logic unit of the print widget performs a process for requesting the image forming apparatus to execute a print job based on print data generated for the corresponding logical printer. Meanwhile the logic unit of the scan widget performs a process for storing scanned image data. The valid apparatus query unit queries the widget manager about image forming apparatuses hereafter referred to as valid apparatuses where a function to be used by the widget is valid or available i.e. image forming apparatuses including that function and causes the display unit to display the query result.

In the descriptions below a may be attached to the end of the reference numbers of the components of the print widget and b may be attached to the end of the reference numbers of the components of the scan widget to distinguish between them. For example the logic unit of the print widget may be expressed as logic unit

The widget manager may include an advertising unit a widget information registration unit a widget information providing unit a relay unit a function validity information collecting unit a valid apparatus determining unit and a function validity information cache .

The advertising unit advertises broadcasts or multicasts for example a user ID of a logged in user who has logged into the user terminal via the network when the widget manager is started. The advertisement is issued for each user for each user ID . Accordingly the advertisement issued by the advertising unit is used to report to the image forming apparatus new entry of a user allowed to use a widget .

The widget information registration unit receives a widget information registration request including widget information from the widget and stores the widget information in for example the secondary storage unit .

The widget information providing unit in response to a request from the image forming apparatus provides sends the widget information stored in the secondary storage unit to the image forming apparatus . The relay unit relays communications between the widget and the provider application .

The function validity information collecting unit obtains or collects from each image forming apparatus information hereafter referred to as function validity information indicating functions that are valid or available in the image forming apparatus . The function validity information collecting unit stores the obtained function validity information in the function validity information cache . Here valid functions of an image forming apparatus indicate for example functions that the image forming apparatus include. In other words when a function is valid in an image forming apparatus the image forming apparatus includes software and or hardware components for implementing the function. Valid functions of an image forming apparatus may change dynamically according to the status of the image forming apparatus . That is a valid function may be defined as a function that is included and also available or executable in the image forming apparatus . For example a function is deemed available or executable when software and hardware components of the image forming apparatus for implementing the function are in normal conditions i.e. when no error that prevents execution of the function is present in the image forming apparatus .

When receiving a query from a widget the valid apparatus determining unit determines a valid apparatus es for the widget by referring to the function validity information cache . The function validity information cache may be implemented for example by a storage area of the secondary storage unit or the memory .

The provider application may include a user detection unit a UI control unit a widget information obtaining unit a valid widget determining unit a widget linkage unit a function control unit a function validity information providing unit a user management table and a function validity information storing unit .

The user detection unit detects a user or the user terminal allowed to use the widget based on the advertisement issued by the widget manager and registers for example a user ID included in the advertisement in the user management table . The user management table is used to manage a list of users who are allowed to use the widgets on the network and may be stored for example in the HDD .

The UI control unit receives user inputs for operating the widgets . Thus although the widgets are stored in the user terminal they can also be operated via the operations panel of the image forming apparatus .

The widget information obtaining unit obtains from the widget manager the widget information of the widgets that belong to a user user ID selected from the users user IDs registered in the user management table .

The valid widget determining unit determines using the function validity information storing unit whether each of the widgets whose widget information has been obtained by the widget information obtaining unit is valid in the image forming apparatus . When the image forming apparatus includes all linked functions requested by a widget i.e. functions that the widget uses the widget is deemed valid.

The function validity information storing unit stores function validity information indicating functions that are valid or available in the image forming apparatus . The function validity information storing unit may be implemented by for example a storage area of the HDD .

The widget linkage unit controls communications with the widget manager . The function control unit controls execution of functions requested by the widgets . Actual processes for providing the functions are performed by the standard applications and the SDK applications other than the provider application . The function validity information providing unit sends function validity information stored in the function validity information storing unit to the widget manager in response to a request from the widget manager .

Exemplary processes in the information processing system are described below. Before using a widget the user starts the widget manager on the user terminal and starts the widget . An exemplary process performed when the widget manager and the widget are started is described below.

When the widget manager is started by the user or automatically the advertising unit of the widget manager sends or issues an advertisement including a user ID of a logged in user and a widget manager URI uniform resource identifier via the network S . The widget manager URI is an URI that is unique to the widget manager . In the present embodiment it is assumed that one widget manager is started on one user terminal . Therefore the widget manager URI also serves as identification information of the user terminal .

When receiving the advertisement the user detection unit of each image forming apparatus registers the user ID and the widget manager URI user information contained in the advertisement in the user management table S .

When multiple users start the widget managers on their respective user terminals multiple records for those users are registered in the user management table of the image forming apparatus .

Next the user detection unit sends a response to the advertisement to the user terminal or the widget manager that has sent the advertisement S . The response may include identification information such as an IP address for identifying the image forming apparatus in network communications. Since the advertisement may be received by plural image forming apparatuses responses may be sent to the user terminal from the plural image forming apparatuses .

When the user terminal receives a response to the advertisement the function validity information collecting unit of the widget manager sends a function validity information transmission request requesting function validity information to the image forming apparatus that has sent the response. Here the image forming apparatus that has sent the response may be identified based on the identification information contained in the response.

When the image forming apparatus receives the function validity information transmission request the function validity information providing unit of the provider application sends the function validity information stored in the function validity information storing unit to the requesting user terminal the function validity information collecting unit of the widget manager S .

The function identifiers are identification information of functions of the image forming apparatus . In this example the function validity information includes a function identifier scan indicating the scanning function and a function identifier print indicating the printing function. A validity indicator specified for a function identifier indicates whether the corresponding function the scanning function or the printing function is valid available . In other words a validity indicator specified for a function identifier indicates whether the image forming apparatus includes the corresponding function. In O indicates that the function is valid and X indicates that the function is invalid.

The setting names are the names of settings or parameters related to a function indicated by the corresponding function identifier. The setting values are values of the settings indicated by the corresponding setting names. A validity indicator specified for a combination of a setting name and a setting value indicates whether the setting value is valid for the setting indicated by the setting name. In other words a validity indicator specified for a combination of a setting name and a setting value indicates whether the setting value can be specified for the setting indicated by the setting name. In O indicates that the combination is valid and X indicates that the combination is invalid.

In a row or record including a function identifier and a validity indicator is followed by rows records that include combinations of setting names and setting values related to the function indicated by the function identifier and validity indicators for the combinations. Accordingly records in a range indicated by A in indicate the validity or availability of the combinations of setting names and setting values related to the scanning function and records in a range indicated by B in indicate the validity or availability of the combinations of setting names and setting values related to the printing function.

In the present embodiment respective combinations of setting names and setting values provided for the corresponding functions e.g. the printing function and the scanning function in the function validity information storing unit are treated as separate functions in the narrow sense. For example a combination of the setting name color and the setting value full color for the scanning function may be treated as a full color scanning function. Similarly a combination of the setting name color and the setting value grayscale may be treated as a grayscale scanning function.

In the example of the function validity information stored in the function validity information storing unit includes even invalid combinations of setting names and setting values. Alternatively the function validity information may include only valid combinations of setting names and setting values.

Also the function validity information stored in the function validity information storing unit may be updated according to changes in the status of the image forming apparatus . That is the function validity information may be updated based on whether the respective functions are available or executable at the image forming apparatus . In this case the function validity information collecting unit can obtain function validity information of functions that are actually available at the image forming apparatus . Alternatively the function validity information providing unit may be configured to determine the status of the image forming apparatus to update function validity information obtained from the function validity information storing unit based on the determined status and to send the updated function validity information to the widget manager .

When receiving the function validity information the function validity information collecting unit of the widget manager stores the received function validity information in the function validity information cache in association with the identification information of the image forming apparatus that has sent the function validity information S .

The apparatus ID is an identifier of the image forming apparatus . For example the apparatus ID may be sent from the image forming apparatus together with the function validity information in step S described above. The IP address is an Internet Protocol address assigned to the image forming apparatus . Since the image forming apparatus can be identified by the IP address the apparatus ID may be omitted. The function validity information is sent from the image forming apparatus in step S described above. In the configuration of the function validity information is simplified for brevity. However the function validity information stored in the function validity information cache may have substantially the same configuration as that illustrated in .

After the widget manager is started the user starts the print widget or the scan widget on the user terminal . In the descriptions below it is assumed that the user starts the print widget

When the print widget is started the widget information transmitting unit of the print widget sends a widget information registration request requesting registration of the widget information of the print widget to the widget manager S .

The widget ID is identification information for uniquely identifying the print widget . The linked function identifier is identification information of a function that is used by the print widget . The print widget causes or requests the image forming apparatus to perform printing i.e. uses the printing function of the image forming apparatus . Therefore in this example print indicating the printing function is specified as the linked function identifier of the print widget . The display name is a character string to be displayed as the name of the print widget . The widget information is obtained for example from the attribute information management file

The widget information sent from the widget information transmitting unit of the print widget is received by the widget information registration unit of the widget manager . The widget information registration unit generates a URI including the widget ID in the received widget information and stores or registers the widget information in the secondary storage unit in association with the generated URI S . The URI is called a widget URI and is generated for each widget when its widget information is registered. The widget URI may be generated for example by attaching the widget ID to the end of the widget manager URI. As described above the widget manager URI is unique to the widget manager i.e. to the user terminal . Therefore when the print widgets are started on multiple user terminals different widget URIs are generated for the print widgets on the respective user terminals . This means that it is possible to identify a print widget of a user terminal on the network based on the widget URI.

Next the widget information registration unit sends the widget URI generated in step S to the widget information transmitting unit of the print widget S . When receiving the widget URI the widget information transmitting unit stores or records the widget URI in the memory for the print widget . Also the widget UI unit displays an icon of the started print widget on the display unit of the user terminal .

Although the print widget is used in the exemplary process described above a similar process particularly steps S through S in may be performed when the scan widget or any other widget is started. Since one widget manager is started on one user terminal it is not necessary to repeat steps S through S in every time a widget is started.

For example when the scan widget is started the widget information transmitting unit of the scan widget sends the widget information of the scan widget to the widget manager S .

In the widget ID is identification information of the scan widget . Since the scan widget uses the scanning function of the image forming apparatus scan indicating the scanning function is specified as the linked function identifier of the scan widget . The display name is a character string to be displayed as the name of the scan widget

When receiving the widget information as illustrated in the widget manager generates a widget URI for the scan widget and sends the widget URI to the scan widget . When receiving the widget URI the widget information transmitting unit stores or records the widget URI in the memory for the scan widget . Also the widget UI unit displays an icon of the started scan widget on the display unit of the user terminal .

The widget information of the widget is an example of a function execution request for requesting execution of a function of the image forming apparatus . Here the widget information does not include information identifying one of the image forming apparatuses where the function specified by the linked function identifier is to be executed. That is the widget information registration unit of the widget manager receives the function execution request from the widget or from the user starting the widget with no identifier of the image forming apparatus where the function is to be executed.

Next an exemplary process of entering a print job by the print widget is described. is a sequence chart illustrating an exemplary process of entering a print job by the print widget

For example when an icon of a document file to be printed is dragged and dropped on the icon of the print widget the logic unit of the print widget inputs a command which is a print request to the document application to the OS S . In this case the file name of the dragged and dropped document file is specified as an argument of the command. As a result the document application is started in the background. When started the document application inputs a print request for the document file to the printer driver S . In response to the print request the printer driver generates print data e.g. page description language PDL data of the document file. When a logical printer corresponding to the print widget is specified as the print destination the printer driver generates an intermediate file with a predetermined file name that is specified as the output destination of the logical printer and outputs the print data to the intermediate file S .

Meanwhile after the print widget is started the logic unit waits for generation of the intermediate file with the predetermined file name. More specifically the print widget polls i.e. checks the presence of a file with the predetermined file name in a predetermined folder to determine whether the intermediate file is generated. When the generation of the intermediate file is detected the print widget reads the print data from the intermediate file S .

Next the linkage unit sends a print job registration request for requesting registration of a print job to the widget manager S . The print job registration request may include print configuration information recorded for example in the attribute information management file and the print data obtained from the intermediate file. Also the widget URI for the print widget is specified in the print job registration request.

The print job registration request sent in step S from the linkage unit of the print widget is received by the widget information registration unit of the widget manager . The widget information registration unit generates a URI print job URI for identifying the print job whose registration is requested by the print job registration request based on the widget URI specified in the print job registration request and registers or records the print job i.e. the print data and the print configuration information in the secondary storage unit in association with the generated print job URI S . The print job URI may be generated for example by attaching an identifier unique to the print job to the end of the widget URI. Next the widget information registration unit sends the print job URI to the linkage unit of the print widget S .

The print job of the print widget is also an example of a function execution request for requesting execution of a function of the image forming apparatus . Similarly to the widget information the print job i.e. the print data and the print configuration information does not include identification information of the image forming apparatus where the print job is to be executed.

Next the valid apparatus query unit of the print widget specifies the print job URI in a valid apparatus query request for querying valid apparatuses and sends the valid apparatus query request to the widget manager S . In response to the valid apparatus query request the valid apparatus determining unit of the widget manager determines valid apparatuses for the print job S . More specifically the valid apparatus determining unit extracts from the function validity information cache one or more sets of function validity information that include the function identifier corresponding to the linked function identifier i.e. print in the widget information associated with the widget URI of the print widget . Next the valid apparatus determining unit selects one or more of the extracted sets of function validity information where all combinations of settings or setting names and setting values constituting the print configuration information in the print job are valid. Here the print job is stored in the secondary storage unit in association with the print job URI specified in the valid apparatus query request. Then the valid apparatus determining unit determines image forming apparatuses corresponding to the apparatus IDs or the IP addresses in the selected sets of function validity information as valid apparatuses. The valid apparatus determining unit records the determination result i.e. a list of valid apparatuses in for example the memory in association with the print job URI. The list of valid apparatuses includes for example a list of apparatus IDs or IP addresses of the valid apparatuses.

Next the valid apparatus determining unit sends the list of valid apparatuses to the valid apparatus query unit S . When receiving the list of valid apparatuses the valid apparatus query unit causes the display unit to display a screen valid apparatus list screen including the list of valid apparatuses S .

If it is difficult for the user to identify the image forming apparatuses based on the IP addresses information that enables the user to identify the image forming apparatuses may be displayed instead of or in addition to the IP addresses. For example location information e.g. pillar numbers or positions on a floor indicating the locations of the image forming apparatuses may be displayed on the valid apparatus list screen g. For this purpose correspondence information indicating the correspondence between the location information and the IP addresses or apparatus IDs of the image forming apparatuses may be provided. In this case the valid apparatus query unit may be configured to convert the IP addresses or apparatus IDs into the location information based on the correspondence information and to display the location information on the valid apparatus list screen g.

After step S the print widget resumes polling the intermediate file. If an icon of another document file is dragged and dropped on the icon of the print widget a print job for the document file is also registered in the widget manager . Accordingly two or more print jobs for one print widget may be registered in one widget manager . In this case the widget manager generates multiple print job URIs based on one widget URI and records the print jobs in association with the print job URIs.

Next an exemplary process of registering scan configuration information for a scan job by the scan widget is described. This registration process corresponds to the process print job entering process performed by the print widget to enter a print job. However unlike the print job entering process a scan job is entered at the image forming apparatus because it is necessary to set a document on the image forming apparatus before entering the scan job. In other words the scan widget does not enter the scan job itself but registers configuration information scan configuration information for the scan job in the widget manager .

When for example the icon of the scan widget displayed on the display unit by the widget UI unit is selected clicked double clicked etc. the widget UI unit displays a screen hereafter called a scan setting screen for setting the scan configuration information on the display unit S . Here default values for the scan configuration information may be displayed on the scan setting screen. The default values may be stored in the attribute information management file

When the scan configuration information is set on the scan setting screen and a command indicating the completion of the setting process is entered the logic unit of the scan widget sends a scan configuration information registration request to the widget manager S . The scan configuration information registration request includes the set scan configuration information and the widget URI of the scan widget

The scan configuration information registration request sent in step S from the logic unit of the scan widget is received by the widget information registration unit of the widget manager . The widget information registration unit stores the scan configuration information in for example the secondary storage unit in association with the widget URI specified in the received scan configuration information registration request S . As a result the scan configuration information for the scan job of the scan widget is registered in the widget manager . Next the widget information registration unit sends a response to the linkage unit of the scan widget S .

The valid apparatus query unit of the scan widget specifies the widget URI of the scan widget in a valid apparatus query request for querying valid apparatuses and sends the valid apparatus query request to the widget manager S . In response to the valid apparatus query request the valid apparatus determining unit of the widget manager determines valid apparatuses for the scan job S . More specifically the valid apparatus determining unit extracts from the function validity information cache one or more sets of function validity information that include the function identifier corresponding to the linked function identifier i.e. scan in the widget information associated with the widget URI of the scan widget . Next the valid apparatus determining unit selects one or more of the extracted sets of function validity information where all combinations of settings or setting names and setting values constituting the scan configuration information are valid. Here the scan configuration information is stored in the secondary storage unit in association with the widget URI specified in the valid apparatus query request. Then the valid apparatus determining unit determines image forming apparatuses corresponding to the apparatus IDs or the IP addresses in the selected sets of function validity information as valid apparatuses. The valid apparatus determining unit records the determination result i.e. a list of valid apparatuses in for example the memory in association with the widget URI.

Next the valid apparatus determining unit sends the list of valid apparatuses i.e. the apparatus IDs or the IP addresses of the valid apparatuses to the valid apparatus query unit S . When receiving the list of valid apparatuses the valid apparatus query unit causes the display unit to display a screen valid apparatus list screen including the list of valid apparatuses S . The user refers to the valid apparatus list screen to determine the image forming apparatuses that can execute the scan widget

After entering a print job in the widget manager via the print widget or registering scan configuration information for a scan job in the widget manager via the scan widget the user moves to a location where the image forming apparatus is installed to execute the print job or the scan job. Here when plural image forming apparatuses are connected to the network the same advertisement is received by the plural image forming apparatuses and information in the advertisement is registered in the user management tables of the respective image forming apparatuses . In this case the user can execute the print job or the scan job on any one of the image forming apparatuses that include a printing function or a scanning function and are determined to be the valid apparatuses based on the print configuration information or the scan configuration information. Accordingly the user moves to one of the image forming apparatuses whose identification information IP addresses or apparatus IDs is displayed on the valid apparatus list screen.

Next a process performed according to user operations at the image forming apparatus is described. is a sequence chart illustrating a process of displaying a list of executable widgets.

When the user inputs a request or command to use the provider application or widgets via the operations panel of a selected image forming apparatus which is selected and being operated by the user S the UI control unit of the provider application displays a user selection screen on the operations panel based on information registered in the user management table S .

On the user selection screen the user selects and presses one of the buttons corresponding to its own user ID S . When a button is pressed the widget information obtaining unit retrieves from the user management table a widget manager URI corresponding to the user ID associated with the pressed button.

Next the widget information obtaining unit sends a widget information acquisition request to the retrieved widget manager URI S . Hereafter the image forming apparatus sending the widget information acquisition request may be referred to as the requesting image forming apparatus . The widget information acquisition request is received by the widget information providing unit of the widget manager of the user terminal corresponding to the user ID. In response the widget information providing unit obtains sets of widget information recorded in the secondary storage unit and sends or returns the sets of widget information to the provider application S . For example assuming that one print widget and one scan widget have been started on the user terminal the widget information providing unit sends the widget information of the print widget and the widget information of the scan widget to the provider application . Here the widget URIs of the corresponding widgets are attached to the sets of widget information sent by the widget information providing unit to the provider application . The UI control unit of the provider application stores the sets of widget information received from the widget manager in the RAM .

As described above the widget information is an example of a function execution request for requesting the image forming apparatus to execute a function. Also the operation performed in step S is an example of a reception instruction to receive widget information i.e. a function execution request from the widget manager or the user terminal . Further step S is an example of sending a function execution request when a reception instruction to receive the function execution request is entered.

After step S the UI control unit of the provider application receives the sets of widget information and displays based on the sets of widget information a screen widget selection screen including options e.g. buttons icons or any other types of objects representing the widgets on the operations panel S .

Here in response to the widget information acquisition request sent in step S the widget information providing unit of the widget manager may return only sets of widget information associated with widget URIs that are associated with the requesting image forming apparatus as a valid apparatus. In this case the widget information acquisition request may include the apparatus ID or the IP address of the requesting image forming apparatus . The widget information providing unit identifies sets of widget information associated with widget URIs that are associated with lists of valid apparatuses that include the apparatus ID or the IP address specified in the widget information acquisition request and returns the identified sets of widget information to the provider application . Here in the case of the print widget the list of valid apparatuses is associated with a print job URI instead of the widget URI. Therefore the widget information of the print widget may be returned unconditionally in response to the widget information acquisition request. Alternatively the widget information of the print widget may be returned when the requesting image forming apparatus is valid for at least one of print jobs registered for the print widget . In this case the widget information of the print widget is not returned when the requesting image forming apparatus is invalid for all print jobs registered for the print widget

With the above configuration where only the widget information of widgets for which the requesting image forming apparatus is valid is returned it is possible to display buttons on the widget selection screen only for the widgets that are valid on the image forming apparatus .

One problem with the above configuration is that it is difficult for the user to determine whether a widget whose button is not displayed has not been normally registered in the widget manager or the widget is invalid on the image forming apparatus . That is the user cannot determine the reason why the button is not displayed.

To solve this problem the widget information providing unit of the widget manager may be configured to return the lists of valid apparatuses associated with the widget URIs or print job URIs together with the widget information in response to the widget information acquisition request sent in step S. In this case the UI control unit of the provider application determines whether the image forming apparatus is a valid apparatus based on the list of valid apparatuses received for each set of widget information or each widget . More specifically the UI control unit determines whether the list of valid apparatuses includes the apparatus ID or the IP address of the image forming apparatus . Based on the determination result the UI control unit displays the button of a valid widget for which the image forming apparatus is a valid apparatus and the button of an invalid widget for which the image forming apparatus is not a valid apparatus in different manners. For example the button of an invalid widget may be dimmed or grayed and made unavailable or not selectable . With this configuration the user can determine that a widget corresponding to a dimmed button has been normally registered in the widget manager but is invalid on the selected image forming apparatus .

Instead of the list of valid apparatuses information indicating whether the image forming apparatus is valid for the function related to widget information may be returned together with the widget information. In this case the widget information providing unit determines whether the apparatus ID or the IP address of the requesting image forming apparatus is included in the list of valid apparatuses associated with the widget URI of the widget information. Based on the determination result the widget information providing unit sends together with the widget information information indicating whether the image forming apparatus is valid for the function related to the widget information. Also in this case the UI control unit may be configured to display the button of a valid widget for which the image forming apparatus is a valid apparatus and the button of an invalid widget for which the image forming apparatus is not a valid apparatus in different manners.

When a widget or the corresponding button is selected on the widget selection screen displayed in step S of a process corresponding to the selected widget the print widget or the scan widget is performed. Below processes performed when the print widget and the scan widget are selected are described separately. In the descriptions below it is assumed that a button for an invalid widget that is invalid on the selected image forming apparatus is also displayed on the widget selection screen . The button for the invalid widget may be dimmed or displayed in a normal manner.

When the button corresponding to the print widget is selected on the widget selection screen of the widget linkage unit determines based on the linked function identifier print in the widget information corresponding to the button that a print job is to be executed. Then the widget linkage unit sends a print job list acquisition request including a widget URI associated with the widget information to the widget manager corresponding to the widget URI S .

The print job list acquisition request is received by the relay unit of the widget manager . In response the relay unit generates a print job list including a print job URI a job name and print configuration information for each of print jobs recorded in the secondary storage unit in association with the widget URI specified in the print job list acquisition request and sends the print job list to the widget linkage unit S . The job name may be for example the name of a document file to be printed in the print job. The relay unit may be configured to include in the print job list only the information on print jobs corresponding to the widget URI that is associated with a list of valid apparatuses including the identification information of the requesting image forming apparatus . Alternatively the relay unit may be configured to include lists of valid apparatuses for the respective print job URIs in the print job list.

When the widget linkage unit of the provider application receives the print job list the UI control unit displays a list of job names in the print job list on the operations panel S . When a job name of a print job to be executed is selected by the user from the displayed list the valid widget determining unit sends a valid apparatus query request to the print job URI associated with the selected job name S . The valid apparatus query request is received by the relay unit of the widget manager . In response the relay unit sends a list of valid apparatuses associated with the print job URI S . When the list of valid apparatuses associated with the print job URI is included in the print job list received in step S steps S and S may be omitted.

Next the valid widget determining unit determines whether the print job corresponding to the selected job name is valid on the image forming apparatus S . More specifically the valid widget determining unit determines whether the list of valid apparatuses for the print job includes the apparatus ID or the IP address of the image forming apparatus .

When the print job corresponding to the selected job name is valid the print job is executed in steps S through S.

In step S the widget linkage unit sends a print job acquisition request including the print job URI associated with the selected job name to the widget manager corresponding to the print job URI.

The print job acquisition request is received by the relay unit of the widget manager . In response the relay unit obtains the print job print data stored in the secondary storage unit in association with the print job URI specified in the print job acquisition request and sends the obtained print job to the widget linkage unit of the provider application S .

When receiving the print job the widget linkage unit inputs the print job in the function control unit . The function control unit requests the print application to execute the input print job S . As a result an image is printed by the printer on a recording medium e.g. paper based on the print data of the print job and the recording medium is output from the printer .

Meanwhile when the print job corresponding to the selected job name is invalid the valid widget determining unit displays a screen valid apparatus report screen for reporting the list of valid apparatuses for the print job on the operations panel S .

Instead of the IP addresses any other type of information that enables the user to identify image forming apparatuses may be displayed on the valid apparatus report screen g.

Next an exemplary process performed when the scan widget is selected on the widget selection screen is described.

When a document is set on the image forming apparatus and a button corresponding to the scan widget is selected on the widget selection screen the widget linkage unit of the provider application determines that a scan job is to be executed based on the linked function identifier scan in the widget information hereafter called current widget information corresponding to the selected button. Then the widget linkage unit sends a configuration information acquisition request for requesting scan configuration information including a widget URI associated with the current widget information to the widget manager corresponding to the widget URI S .

The configuration information acquisition request is received by the relay unit of the widget manager . In response the relay unit sends to the widget linkage unit the scan configuration information stored in the secondary storage unit in association with the widget URI specified in the configuration information acquisition request S .

Next the valid widget determining unit of the provider application sends a valid apparatus query request to the widget URI of the scan widget S . The valid apparatus query request is received by the relay unit of the widget manager . In response the relay unit sends a list of valid apparatuses associated with the widget URI S . When lists of valid apparatuses are received together with the widget information in step S of steps S and S may be omitted.

Next the valid widget determining unit determines whether the scan widget is valid on the image forming apparatus S . More specifically the valid widget determining unit determines whether the list of valid apparatuses for the scan widget includes the apparatus ID or the IP address of the image forming apparatus .

The widget linkage unit inputs the scan configuration information received in step S to the function control unit . The function control unit requests the scan application to execute the scan job based on the scan configuration information S . The scan application causes the scanner to scan the document set on the image forming apparatus to obtain image data scanned image data and outputs the scanned image data to the widget linkage unit .

Next the widget linkage unit sends the scanned image data to the widget URI associated with the current widget information S . The scanned image data sent to the widget URI is received by the relay unit of the widget manager corresponding to the widget URI.

Meanwhile after sending the widget information the scan widget performs polling to determine whether scanned image data has been obtained by the image forming apparatus and waits for reception of the scanned image data. More specifically the linkage unit of the scan widget sends a scanned image acquisition request including the corresponding widget URI to the relay unit of the widget manager S . The relay unit transmits a response to the scanned image acquisition request S .

When receiving the scanned image acquisition request S after receiving the scanned image data the relay unit sends the scanned image data associated with the widget URI specified in the scanned image acquisition request to the linkage unit of the scan widget S .

When receiving the scanned image data the linkage unit inputs the scanned image data to the logic unit . The logic unit performs a predefined process logic implemented therein on the scanned image data S . More specifically the logic unit generates a file in a folder specified in the attribute information management file and outputs the scanned image data to the generated file. Then the linkage unit resumes transmission of the scanned image acquisition request i.e. resumes polling in preparation for the next execution of the scan widget S and waits for reception of scanned image data.

Meanwhile when the scan widget is invalid the valid widget determining unit displays a screen valid apparatus report screen for reporting the list of valid apparatuses for the scan job on the operations panel S . The valid apparatus report screen displayed in step S may be substantially the same as the valid apparatus report screen g of . With the valid apparatus report screen the user can determine that the scan widget is not executable on the selected image forming apparatus and obtain information on image forming apparatuses that can execute the scan widget

In step S the valid widget determining unit determines whether any valid apparatus exists for the current job based on the list of valid apparatuses received for the current job. More specifically the valid widget determining unit determines whether the list of valid apparatuses includes the apparatus ID or IP address of at least one image forming apparatus .

When at least one valid apparatus exists for the current job YES in S the valid widget determining unit displays the valid apparatus report screen see for example on the operations panel S .

Meanwhile when no valid apparatus exists for the current job NO in S the valid widget determining unit downgrades the configuration information of the current job such that the image forming apparatus can execute the current job S . That is the valid widget determining unit changes one or more setting values in the configuration information that are not supported by the image forming apparatus to values supported by the image forming apparatus .

Next the valid widget determining unit displays a screen downgrading confirmation screen on the operations panel to ask the user whether to accept the downgrading of the configuration information S .

When the OK button is selected on the downgrading confirmation screen g to accept the downgrading YES in S the current job is executed based on the downgraded configuration information S . For example when the current job is a print job step S of is performed based on the downgraded print configuration information. Similarly when the current job is a scan job step S of is performed based on the downgraded scan configuration information.

Meanwhile when the CANCEL button is selected on the downgrading confirmation screen g to refuse to accept the downgrading NO in S the current job is not executed.

As described above the widget of the present embodiment is configured to display a list of valid apparatuses for the widget . This configuration enables the user to determine an image forming apparatus that can execute the widget before moving to the location where the image forming apparatus is installed. This in turn makes it possible to prevent a case where the user notices that the widget is not executable on a selected image forming apparatus after operating the image forming apparatus and thereby makes it possible to reduce the workload of the user.

In the above embodiment the function validity information collecting unit is an example of a receiving unit the widget information registration unit is an example of a reception unit the valid apparatus determining unit is an example of a determining unit the widget information providing unit is an example of a transmitting unit and the valid apparatus query unit is an example of a display control unit.

An information processing apparatus an information processing system and a storage medium of preferred embodiments are described above. However the present invention is not limited to the specifically disclosed embodiments and variations and modifications may be made without departing from the scope of the present invention.

An aspect of this disclosure provides an information processing apparatus an information processing system and a storage medium storing program code that make it possible to reduce the workload of a user in operating programs that collaborate with image forming apparatuses via a network.

