---

title: Control apparatus, method of controlling control apparatus, and digital broadcast receiving apparatus
abstract: A control apparatus which is inexpensive and highly effective in shortening a start-up time, a method of controlling the control apparatus, and a digital broadcast receiving apparatus are provided. The control apparatus includes: a control microcomputer; at least one device; and a ROM which stores a simple control program, a main body program, and a boot loader. The simple control program includes an interrupt program having an interrupt for starting the at least one device so that the at least one device is activated, accepts an interrupt signal requesting for the interrupt from the at least one device during loading of the main body program, and performs the interrupt.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08935521&OS=08935521&RS=08935521
owner: Panasonic Corporation
number: 08935521
owner_city: Osaka
owner_country: JP
publication_date: 20120807
---
This is a continuation application of PCT Patent Application No. PCT JP2011 000393 filed on Jan. 26 2011 designating the United States of America which is based on and claims priority of Japanese Patent Application No. 2010 027516 filed on Feb. 10 2010. The entire disclosures of the above identified applications including the specifications drawings and claims are incorporated herein by reference in their entirety.

The present invention relates to control apparatuses for receiving digital broadcast a method of controlling the control apparatuses and digital broadcast receiving apparatuses.

In resent years an operating system OS and software for an application which are for digital broadcast receiving apparatuses such as a digital TV have increased in size for high functionality and multi functionality. Because of this it takes a longer time for software loading and initialization and a user has to wait after turning on an apparatus to actually start viewing.

Therefore in order to provide greater convenience to users a technique is required for shortening the waiting time after the user turns on the apparatus to start viewing see Patent Literatures PTL 1 and 2 for example .

PTL 1 discloses a technique for shortening the waiting time after the user turns on the apparatus to start viewing. In the technique processing which is related to the digital broadcast and other processing are started in parallel by i executing processing which is independent from operation of the OS which is related to the digital broadcast namely control of a tuner unit a demultiplexer and a decoding unit by a first system controller and ii executing start up of the OS and a full service by a second system controller.

PTL 2 also discloses a technique for shortening the waiting time after the user turns on the apparatus to start viewing by i executing processing related to the digital broadcast in advance by processing which requires software in a small size that is called partial service providing task and ii succeeding the processing from the partial service providing task started in advance after the start up of a full service providing task.

However the technique in PTL 1 has a problem that the costs for hardware are increased because two independent system controllers are required. The technique in PTL 2 also has a problem that the effect in shortening the start up time is small which is because it is required to start the OS prior to the operation of the partial service providing task and therefore the OS and the partial service providing task cannot be operated in parallel while the OS is being started.

The present invention is conceived to solve the above problems and has an object to provide a control apparatus which is inexpensive and highly effective in shortening the start up time a method of controlling the control apparatus and a digital broadcast receiving apparatus.

In order to solve the above problems a control apparatus in an aspect of the present invention includes a control microcomputer at least one device connected to the control microcomputer and a ROM which stores a first control program a second control program which is used for controlling the control microcomputer and a boot loader program for loading the second control program into the control microcomputer upon start up. The first control program includes an interrupt program having an interrupt for starting the at least one device so that the at least one device is activated and the control microcomputer executes the boot loader program so that the second control program is loaded from the ROM accepts an interrupt signal requesting for the interrupt from the at least one device during the loading of the second control program and performs the interrupt.

With the present invention a control apparatus which is inexpensive and highly effective in shortening the start up time a method of controlling the control device and a digital broadcast receiving device can be provided.

The following describes an embodiment of the present invention with reference to drawings. Although the present invention is described using the embodiment below and the attached drawings it is for illustrative purposes and therefore it should not be construed that the present invention is determined by the embodiment and the drawings.

A digital broadcast receiving apparatus which is an aspect of the control apparatus according to the embodiment of the present invention is described. The digital broadcast receiving apparatus described in the present embodiment includes a control microcomputer at least one device connected to the control microcomputer and a ROM which stores a first control program a second control program which is used for controlling the control microcomputer and a boot loader program for loading the second control program into the control microcomputer upon start up. The first control program includes an interrupt program having an interrupt for starting the at least one device so that the at least one device is activated and the control microcomputer executes the boot loader program so that the second control program is loaded from the ROM accepts an interrupt signal requesting for the interrupt from the at least one device during the loading of the second control program and performs the interrupt. With the above configuration a control apparatus can be provided which does not require two control microcomputers to be prepared as system controllers executes device control by the interrupt using the first control program prior to loading of the second control program OS for example and continuously executes the device control by the interrupt through the first control program even during the loading of the second control program. With such a control apparatus load of OS and control of device can be executed in parallel. Furthermore since there is no need to prepare two control microcomputers as system controllers the costs for hardware are not increased.

Furthermore each of a RAM a ROM an EEPROM a tuner unit a demultiplexer a decoding unit a decoder unit and an AV output control unit are connected to the general purpose bus . Here the tuner unit the demultiplexer the decoding unit the decoder unit and the AV output control unit in the present embodiment correspond to the devices.

The interrupt controller in the present embodiment corresponds to an interrupt driving unit. Upon receiving an interrupt signal from at least one of the tuner unit the demultiplexer the decoding unit the decoder unit and the AV output control unit the interrupt controller i executes processing assigned with a high interrupt level with higher priority based on the interrupt table set for each of the above devices and ii transits the processing of the CPU to a jump address associated with each interrupt level. The interrupt signal is a signal for executing the processing with higher priority than other processing. Since the CPU processes the interrupt by the interrupt controller the interrupt can be simplified. It is to be noted that the interrupt table is an interrupt address table which holds a jump address indicating the beginning of the interrupt program. The interrupt table is described in detail later.

The RAM is a storage area for the CPU the tuner unit the demultiplexer the decoding unit the decoder unit and the AV output control unit .

Furthermore the ROM stores a boot loader a simple control program which is started based on the interrupt table included in the boot loader and controls each device to process the interrupt and a main body program which is for controlling the OS and each device of the digital broadcast receiving apparatus . Here the boot loader in the present embodiment corresponds to the boot loader program the simple control program in the present embodiment corresponds to the first control program and the main body program in the present embodiment corresponds to the second control program. Furthermore the simple control program includes an interrupt program having the interrupt for starting and activating the devices. The devices include the tuner unit the demultiplexer the decoding unit the decoder unit and the AV output control unit .

The CPU executes the boot loader so that the simple control program is loaded from the ROM sets the interrupt table accepts the interrupt signal requesting for the interrupt from the devices during the loading of the simple control program and processes the interrupt. The devices include the tuner unit the demultiplexer the decoding unit the decoder unit and the AV output control unit . Since the CPU specifies the jump address table indicating the beginning of the interrupt program so that the interrupt signal can be accepted in the above manner the waiting time after the user turns on the apparatus to start viewing can be shortened. Furthermore the start up of the device can be continued through the main body program that is an OS.

Furthermore the EEPROM stores the frequency setting of the last channel that is the channel the user viewed in the end of the previous start up of the apparatus.

When the reception frequency for the digital broadcast is set by the CPU the tuner unit starts orthogonal frequency division multiplexing OFDM synchronization and when the OFDM synchronization is completed transmits assets an interrupt signal to the interrupt controller and starts outputting transport stream TS . Here the transport stream is a form of multiplexing and transmitting or accumulating packetized elementary stream PES obtained by packetizing elementary stream ES which is coded video or coded audio. Each transport stream includes information called packet identifier PID value .

The demultiplexer receives the transport stream outputted from the tuner unit and stores the packet in the RAM set in advance by the CPU based on the packet identifier PID value included in the transport stream. After storing the packet identifier PID value to the RAM the demultiplexer transmits asserts an interrupt signal to the interrupt controller . Furthermore when receiving the packet identifier PID value of VideoES coded video information the demultiplexer outputs the encrypted VideoES and when receiving AudioES coded audio information the demultiplexer outputs the encrypted AudioES to the decoding unit .

The decoding unit decodes the encrypted VideoES and the encrypted AudioES and outputs data compressed video signal and data compressed audio signal to the decoder unit . The decoder unit decompresses the data compressed VideoES and the data compressed AudioES and transforms the decompressed VideoES into a video signal and the decompressed AudioES into an audio signal. Furthermore the AV output control unit transforms the video signal and the audio signal outputted from the decoder unit into a form of a panel or an external output terminal not shown in the drawings and outputs the transformed video signal and the transformed audio signal.

Next an operation of the digital broadcast receiving apparatus which is performed after the user turns on the apparatus to start viewing is described with reference to and . is a flowchart describing processing of the boot loader and is an interrupt table set upon the start up of the boot loader .

The boot loader executes an initial control sequence for starting each device upon the start up of the digital broadcast receiving apparatus upon booting after the apparatus is turned on .

First when the digital broadcast receiving apparatus is turned on each device is turned on the CPU is reset and the boot loader stored in the ROM is started step S .

Next an initialization such as setting of a bus connected to the CPU is performed through a start up routine step S . Furthermore the interrupt table is set step S .

Here as shown in the interrupt table includes two tables. One is an interrupt level list which holds a type of an input device and an interrupt level associated with the type. The other is a jump address list which holds the interrupt level and a jump address indicating a beginning of an interrupt program associated with the interrupt level. It is to be noted that the jump address list in the present embodiment corresponds to the jump address table.

In the interrupt level list the tuner unit and the demultiplexer are assigned with high interrupt level and the CPU is set to accept the interrupt signal from each of these devices. Other devices are set to be disabled to interrupt. Furthermore in the jump address list an address of the simple control program stored in the ROM is set as the jump address of a program for processing the interrupt for the high level interrupt. Thus the simple control program is called from the ROM in response to the interrupt signal from each of the tuner unit and the demultiplexer the tuner unit and the demultiplexer are made to be able to accept the interrupt signal so that the CPU process the interrupt through the simple control program .

Although the group for interrupt controller in the interrupt level list includes the tuner unit the demultiplexer the decoding unit the decoder unit and the AV output control unit this is for convenience in describing the present invention. If other devices are connected to the CPU the interrupt level is also set for those devices. Also although the type of the interrupt level includes two types namely high and low the interrupt level is not necessarily be limited to two levels and more levels may be set.

Next a purpose of start of the digital broadcast receiving apparatus is obtained step S . The purpose of start can be obtained by a sub microcomputer not shown in the drawings . As the purpose of start it is determined whether the digital broadcast receiving apparatus is turned on by receiving a signal from a button provided in the main body or a remote control or by an embedded timer at a predetermined time point. The sub microcomputer notifies in response to a query from the CPU whether the digital broadcast receiving apparatus is turned on by receiving a signal from the remote control or by the timer.

Furthermore based on the obtained purpose of start the CPU determines whether or not the purpose of start is viewing step S . When the purpose of start is reception of a signal from the button provided in the main body or a remote control of the digital broadcast receiving apparatus the CPU determines that the purpose of start is viewing and determines to execute the initial control sequence. Furthermore the CPU executes the boot loader so that a frequency of the last channel is read from the EEPROM step S . Meanwhile when the purpose of start is that the digital broadcast receiving apparatus is turned on by the timer the CPU determines that the purpose of start is not viewing and determines not to execute the initial control sequence. Then the subsequent processing is transited to loading of the main body program step S described later.

After the frequency of the last channel is read the CPU determines whether the frequency setting of the last channel is valid or invalid step S . For example when the last channel is of an external input the CPU determines that the frequency setting is invalid. The last channel is a channel which was viewed by the user in the end of the previous start up of the apparatus. When the frequency setting is valid the frequency setting is performed on the tuner unit step S . With the above processing the interrupt controller obtains the last channel information which was set to the tuner unit immediately before the broadcast receiving apparatus is started when the purpose of start of the digital broadcast receiving apparatus is viewing so that setting of the tuner unit can be performed efficiently. The last channel is a channel which was viewed by the user in the end of the previous start up of the apparatus. Furthermore when the frequency setting is invalid loading of the main body program is stared step S . Then when the loading of the main body program is completed the processing of the boot loader is completed and the main body program is started step S . Accordingly the frequency setting of the tuner unit can be performed efficiently and easily prior to the loading of the main body program .

The following describes the processing of the main body program . is a flowchart showing processing of the main body program and is an interrupt table for the processing of the main body program . Here the interrupt table includes two tables. One is an interrupt level list which holds a type of an input device and an interrupt level associated with the type. The other is a jump address list which holds the interrupt level and a jump address indicating a beginning of an interrupt program associated with the interrupt level. It is to be noted that the jump address list in the present embodiment corresponds to the jump address table.

As shown in starting of the OS which is the main body program is started first step S . At this time regarding the interrupt table the CPU rewrites the interrupt level list and the jump address list shown in as per the interrupt level list and the jump address list shown in interrupt handler rewrite .

As shown in in the interrupt level list the tuner unit and the demultiplexer are assigned with the high interrupt level while other devices are assigned with the low interrupt level. Furthermore in the jump address list an address of the simple control program stored in the ROM is kept as the jump address of the program for processing the interrupt for the high level interrupt and that for the low interrupt level is set to OS. That is the interrupt level of the devices which are disabled to interrupt namely the decoding unit the decoder unit and the AV output control unit are rewritten from interrupt disabled to low level by the interrupt controller after the start up of the OS. Furthermore the jump address associated with the low level is rewritten from N A to OS after the start up of the OS.

With the setting of the interrupt table the tuner unit and the demultiplexer which are assigned with high interrupt level are continuously controlled through the simple control program before and after the start up of the OS. Furthermore other devices are controlled by the OS after the start up of the OS.

When the start up of the OS is completed the start up of the application program on the OS is started step S . After that a state of the simple control program is obtained step S . Here the following processing is executed until the steps S to S are executed.

When the tuner unit completes the OFDM synchronization to the frequency of the last channel set in the step S the tuner unit asserts an interrupt signal to the interrupt controller . At this time the CPU performs the processing of the interrupt table and determines that the interrupt of the high interrupt level has occurred by referring to the interrupt level list when the processing is proceeding from the step S to the step S or referring to the interrupt level list when the processing is proceeding from the step S to the step S.

In the table of the jump address list or the jump address list the jump address for the high interrupt level is set to the simple control program . Therefore the simple control program is executed. The simple control program performs the operation shown in when the processing is proceeding from the step S to the step S and performs the operation shown in when the processing is proceeding from the step S to the step S.

When the simple control program is executed as shown in the CPU first determines whether or not the interrupt signal is from the tuner unit step S . When the interrupt signal is from the tuner unit a tuner lock interrupt described from the steps S to S below is executed while when the interrupt signal is not from the tuner unit a processing described from the steps S to S shown in is executed.

When the interrupt signal is from the tuner unit the CPU i executes the boot loader so that the tuner unit obtains the cause of interrupt step S and ii determines whether or not the cause of interrupt from the tuner unit is tuner lock interrupt caused by the tuner lock completion of synchronization of the tuner unit step S . Here the boot loader includes steps of performing the frequency setting processing on the tuner unit . When the cause of interrupt from the tuner unit is tuner lock interrupt the CPU sets the demultiplexer to receive program association table PAT information PID value 0 step S sets the state of the simple control program to tuner locked state step S and completes the interrupt.

Meanwhile when the cause of interrupt from the tuner unit is not the tuner lock interrupt the CPU executes the boot loader so that the interrupt controller determines whether or not the cause of interrupt from the tuner unit is error interrupt step S . Here the error interrupt represents for example an interrupt due to causes such as broadcast cannot be received because an antenna line has fallen intensity of the broadcast wave is weak or the broadcast pauses. In the case where an error has occurred if the PAT information or program map table PMT information has been obtained the interrupt controller cancels the setting of PID value to the demultiplexer discards the PAT or PMT information as being invalid step S sets the state of the simple control program to tuner unlocked state step S and completes the interrupt.

Furthermore when no error has occurred the interrupt controller determines that the interrupt should not be processed by the simple control program and completes the interrupt.

With the above processing in the case where an error has occurred in the tuner unit the interrupt controller determines that the PAT information or the PMT information which has already been obtained as being invalid if any so that the device can be started efficiently.

Furthermore when the interrupt signal is not from the tuner unit the CPU executes the simple control program and as shown in the interrupt controller determines whether or not the interrupt is from the demultiplexer step S . Here the interrupt program included in the simple control program includes the following steps and is executed by the CPU . When the interrupt signal is from the demultiplexer the interrupt controller obtains the cause of interrupt from the demultiplexer step S . Subsequently the interrupt controller determines whether or not the cause of interrupt from the demultiplexer is reception of PAT information step S .

Here when the cause of interrupt of the interrupt from the demultiplexer is reception of PAT information the CPU analyzes the received PAT information step S . Furthermore the demultiplexer stores the PAT information to the RAM and obtains the PID value of the PMT information from the received PAT information. Then the CPU sets the PID of the PMT information to the demultiplexer step S sets the state of the simple control program to PAT received state step S and completes the interrupt.

Meanwhile when the cause of interrupt from the demultiplexer is not reception of PAT information the interrupt controller determines whether or not the cause of interrupt from the demultiplexer is reception of the PMT information step S . When the cause of interrupt is reception of the PMT information the interrupt controller stores the PMT information received by the CPU to the RAM step S sets the state of the simple control program to PMT received state step S and completes the interrupt. Furthermore when the cause of interrupt from the demultiplexer is not reception of PMT the interrupt controller determines that the interrupt should not be processed by the simple control program and completes the interrupt.

By performing the above processing in the step S shown in i loading of the main body program and ii locking of the tuner and receiving of the PAT information and the PMT information while the OS and the application on the OS are started can be executed in parallel. Thus waiting for the completion of synchronization of the tuner unit and receiving of the PAT and PMT information from the demultiplexer can be executed by the interrupt in parallel with the start up of the OS and the program on the OS. Furthermore since control of the tuner unit and the demultiplexer which is being executed by the interrupt can be executed continuously from the program on the OS the waiting time after the user has turned on the apparatus to actually start viewing can be shortened. Furthermore the control of the tuner unit and the demultiplexer and the control of other devices can be integrated by succeeding the control with the program on the OS so that the control can be performed in a flexibly coordinated manner after the start up of the program on the OS.

After the loading of the main body program and the start up of the OS and the application on the OS an application programming interface. API for obtaining a state from the started application on the OS is called and a processing state of the simple control program is obtained by the application on the OS step S .

After the processing state of the simple control program is obtained by the application on the OS the interrupt controller rewrites the interrupt level list and the jump address list shown in as per the interrupt level list and the jump address list shown in interrupt handler rewrite .

As shown in in the interrupt level list the tuner unit and the demultiplexer are assigned with the low interrupt level and other devices are assigned with the low interrupt level. Furthermore in the jump address list a jump address of a program for processing the interrupt for the high interrupt level is not specifically stated and that for the low interrupt level is kept as OS. Specifically the interrupt levels of the tuner unit and the demultiplexer which have been represented as high level are rewritten from high level to low level by the interrupt controller after the start up of the application on the OS. Furthermore the jump address assigned to high level is rewritten from simple control program to don t care after start up of the application on the OS step S .

With the above setting of the interrupt table the interrupt levels of all of the devices are low level and therefore all of the interrupts from the devices are controlled by the OS. The devices include the tuner unit the demultiplexer the decoding unit the decoder unit and the AV output control unit .

Next a control application on the OS performs on the tuner unit and the demultiplexer the subsequent processing to be performed as a result of determination of the processing state of the simple control program step S . For example setting of the PID value of the Video Audio to the demultiplexer setting of ECM to the decoding unit control of the decoder unit and control of the AV output control unit are executed and then Video Audio is started to be output step S .

As described above in the present embodiment control of the devices is started through the boot loader prior to the loading of the OS and the devices are controlled by the interrupt driving unit so that the start up of the OS and the program on the OS can be executed in parallel with the control of the devices. The devices include the tuner unit and the demultiplexer for example. Moreover the interrupt controller i receives through the program on the OS the interrupt level and the jump address and ii rewrites the interrupt table to succeed the processing so that it is possible to i shorten the waiting time after the user turns on the apparatus to start viewing and ii continuously execute the device control from the OS. The interrupt level is a parameter for the device control and the jump address is the program of the control source.

In other words the digital broadcast receiving apparatus can with at least one control microcomputer CPU i perform the frequency setting of the tuner through the boot loader ii execute waiting for the completion of synchronization of the tuner unit and receiving of the PAT and PMT information from the demultiplexer by the interrupt in parallel with the start up of the OS and the program on the OS and iii execute the control of the tuner unit and the demultiplexer which is being executed by the interrupt driving unit continuously from the program on the OS. Thus the waiting time after the user has turned on the apparatus to actually start viewing can be shortened.

Furthermore since the control of the tuner unit and the demultiplexer and the control of other devices the decoding unit the decoder unit and the AV output control unit for example can be integrated by succeeding the control with the program on the OS the control can be performed in a flexibly coordinated manner after the start up of the program on the OS.

Since the application on the OS obtains the processing state of the simple control program even in an unusual situation such as the tuner synchronization cannot be completed and the PAT information or the PMT information cannot be received because the intensity of wave is weak or the antenna line has fallen during the start up the processing such as displaying an error on the screen can be executed promptly.

Moreover in the control of the demultiplexer through the simple control program it is easy to add processing of a transport TS packet other than the PAT information and the PMT information. The digital broadcast receiving apparatus is applicable to receiving of for example network information table NIT information conditional access table CAT information and entitlement management message EMM information.

Moreover it is easy to limit the target to be controlled by the simple control program to the tuner unit only or extend the target to the decoding unit the decoder unit and the AV output control unit by extending the configuration of the present invention.

Furthermore when it was an external input that the user viewed in the end of the time that the apparatus was previously turned on the boot loader is caused not to set the frequency to the tuner unit and therefore the power consumption by the tuner unit can be reduced.

Moreover when the start up does not require start up of the tuner unit such as the start for a firmware update or when the start up does not require to be performed fast because the apparatus is turned on by the timer the boot loader does not set the frequency to the tuner unit so that the power consumption by the tuner unit can be reduced.

It is to be noted that the present invention is not determined by the above described embodiment and may be varied or modified without departing from the spirit of the present invention.

For example although the control apparatus has been described using the digital broadcast receiving apparatus as an example in the above embodiment the present invention may be used for a control apparatus other than the digital broadcast receiving apparatus.

Furthermore the control apparatus according to the present invention includes other embodiments achieved by combining arbitrary constituents in the above embodiment modification examples obtained by applying various modifications conceived by those skilled in the art to the above embodiment within a scope that does not deviate from the spirit of the present invention and various devices including the digital broadcast receiving apparatus or the control apparatus according to the present invention. For example a digital broadcast receiving system including the digital broadcast receiving apparatus according to the present invention is also included in the present invention.

Although only an exemplary embodiment of the present invention has been described in detail above those skilled in the art will readily appreciate that many modifications are possible in the exemplary embodiment without materially departing from the novel teachings and advantages of the present invention. Accordingly all such modifications are intended to be included within the scope of the present invention.

The present invention is applicable to a device which serves as a digital broadcast receiving apparatus especially a TV a video recorder a mobile phone and a personal computer and is a technique effective in shortening the waiting time after the device is turned on to output video audio.

