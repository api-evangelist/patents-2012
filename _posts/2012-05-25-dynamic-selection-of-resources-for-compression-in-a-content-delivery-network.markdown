---

title: Dynamic selection of resources for compression in a content delivery network
abstract: Embodiments provide a compression proxy service that dynamically selects resources or other content for compression and delivery to user devices. The resources are selected based on evaluation of compression characteristics relating to the resources. A manifest is defined to identify the selected resources, or to identify the resources not selected for processing by the compression proxy service. The user devices employ the manifest to determine whether to send requests for the resources to the compression proxy service or to another source (e.g., an origin web site). Some embodiments provide a reduction in network traffic while making efficient use of the compression proxy service.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08892684&OS=08892684&RS=08892684
owner: Microsoft Corporation
number: 08892684
owner_city: Redmond
owner_country: US
publication_date: 20120525
---
Some existing proxy services act as intermediaries between user devices and content provider web sites. For example rather than sending a request for content associated with a web page to the content provider web site the user device may send the request to a third party proxy service. The third party proxy service obtains the content on behalf of the user device and may perform compression on the content before sending the content to the user device. The amount of compression varies based on the content being compressed among other factors. For example compressed images generally do not compress further without sacrificing image quality. As such the costs associated with use of the existing proxy services may outweigh the savings in size reduction from the compression. Additionally the existing proxy services take an all or nothing approach to compression by compressing either all the resources or none of the resources.

Embodiments of the disclosure enable selective use of a compression proxy service to reduce network traffic when providing resources. The compression proxy service receives a request for the resources and evaluates at least one compression characteristic of the resources. One or more of the resources are selected based on the evaluated compression characteristic. A manifest is defined to indicate selection of the one or more of the resources.

In some embodiments a computing device detects a request for at least one of the resources and receives the manifest in response to the detected request. Based on the received manifest the computing device identifies the selected one or more of the resources to obtain from the compression proxy service.

This Summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This Summary is not intended to identify key features or essential features of the claimed subject matter nor is it intended to be used as an aid in determining the scope of the claimed subject matter.

Referring to the figures embodiments of the disclosure enable a dynamic intelligent data compression proxy service that adapts its behavior based on calculated compression characteristics. In some embodiments the compression proxy service calculates the compression characteristics for the resources associated with web pages to select resources for processing by the compression proxy service e.g. rather than by an origin site or other content provider web site . For example the compression proxy service selects the resources that have a high compression ratio or excludes the resources that have a low compression ratio. Another compression characteristic calculated by the compression proxy service is the amount of noise or artifacts resulting from the compression. In such embodiments the compression proxy service calculates and evaluates e.g. compares to a threshold the peak signal to noise ratios for the compressed resources. In this manner the compression proxy service is able to intelligently compress the resources as much as possible without introducing noise or artifacts that affect the quality of the compressed resources.

In some embodiments the selected or excluded resources on a web page are identified in a manifest or other record for the web page that is provided to one or more user devices in response to a request for the web page from the user devices . The user devices use the manifest to efficiently load compressed versions of the selected resources from the compression proxy service while obtaining the other resources on the web page from other sources e.g. the origin site . Some embodiments adapt to changing web pages by continually monitoring the requests for resources associated with the web pages periodically calculating the compression characteristics for the resources and updating the manifests accordingly.

Aspects of the disclosure reduce a quantity of network traffic consumed by the user device while rendering web pages. Aspects of the disclosure further make efficient use of the compression proxy service and its content delivery network by invoking the compression proxy service or its content delivery network for only the resources that yield the greatest savings in network traffic. For devices having a small display aspects of the disclosure may select images originally compressed for display on a large monitor for further compression because the further compression still yields an acceptable image quality on the small display.

Further static long lived compressed content with high popularity may be stored on the content delivery network for faster and cheaper downloading by the user devices . In contrast requests for resources such as video images or other content that does not compress much are routed to the origin site .

Referring to an exemplary block diagram illustrates the user device interacting with the compression proxy service . The example of represents a system for selective use of the compression proxy service to reduce network traffic when rendering content such as resources associated with web pages. The user device interacts with the compression proxy service to determine whether to request the resources from the compression proxy service the content delivery network or an origin site s associated with one or more of the resources.

The compression proxy service may be implemented as one or more computing devices or other processing units e.g. as a cloud service . The computing device represents any device executing instructions e.g. as application programs operating system functionality or both to implement the operations and functionality associated with the compression proxy service .

The compression proxy service has at least one processor and a memory area . The processor includes any quantity of processing units and is programmed to execute computer executable instructions for implementing aspects of the disclosure. The instructions may be performed by the processor or by multiple processors executing within the compression proxy service or performed by a processor external to the compression proxy service . In some embodiments the processor is programmed to execute instructions such as those illustrated in the figures e.g. .

The memory area includes any quantity of media associated with or accessible by the compression proxy service . The memory area may be internal to the compression proxy service as shown in external to the compression proxy service not shown or both not shown . The memory area stores among other data data identifying the resources e.g. content and locations e.g. network locations from which the resources may be obtained. For example the network locations may include the content delivery network the origin site s for one or more of the resources or a cache of the compression proxy service .

Aspects of the disclosure are operable with any size quantity format or configuration of the manifests . For example each of the manifests may be associated with a single web page. In another example each manifest may be associated with a plurality of web pages. In still another example the memory area stores a single aggregated manifest for the web pages. Creation of the manifests is described below with reference to . An exemplary structure and format of the manifest is provided in Appendix A.

The compression proxy service sends the manifests to the user device upon request. In some embodiments the compression proxy service receives a request for a web page from the user device and provides the manifest corresponding to the web page in response thereto. In other embodiments the compression proxy service determines the resources associated with the web page and dynamically generates the manifest to identify the locations associated with the determined resources.

In some embodiments the compression proxy service selectively analyzes web pages and creates manifests for only those web pages with sufficient popularity. For example the compression proxy service may maintain a popularity counter for each web page reflecting a quantity of requests for the web page. In this example the compression proxy service performs the operations illustrated in for only those web pages having a value in the popularity counter that exceeds a threshold value. This enables more efficient use of the compression proxy service because manifests are then created only for popular web pages. In other embodiments the compression proxy service creates a reject all manifest for the unpopular web pages e.g. those web pages having a value for the popularity counter that does not exceed the threshold value which directs the user device to obtain all resources for a particular web page from the origin site rather than from the compression proxy service or the content delivery network .

The memory area further includes the cache for storing compressed versions of one or more of the resources requested by the user device .

The user device represents any device requesting resources or other content. For example the user device may include a mobile computing device or any other portable device. In some embodiments the mobile computing device includes a mobile telephone laptop tablet computing pad netbook gaming device and or portable media player. The user device may also include less portable devices such as desktop personal computers kiosks and tabletop devices. Additionally the user device may represent a group of processing units or other computing devices.

The user device includes or has access to one or more computer readable storage media . The computer readable storage media store among other data one or more applications . The applications when executed by the user device operate to perform functionality on the user device . Exemplary applications include mail application programs web browsers calendar application programs address book application programs messaging programs media applications location based services search programs and the like. The applications may communicate with counterpart applications or services such as web services accessible via a network. For example the applications may represent downloaded client side applications that correspond to server side services executing in a cloud.

The computer readable storage media further embody or otherwise store one or more computer executable components. Exemplary components include a network stack component an interface component and a redirection component . Operation of these components when executed by the user device is described below with reference to .

Referring next to an exemplary flow chart illustrates operation of the compression proxy service to define manifests based on compression characteristics of resources. In the example of in response to receiving a request e.g. a first request for a resource associated with a web page from the user device the compression proxy service creates the manifest for the web page and provides the created manifest in response to subsequent requests for the web page. In other examples not shown in the compression proxy service already stores e.g. in the memory area a previously created manifest for the web page and provides this manifest in response the received request.

In the compression proxy service listens for requests from the user device for one or more of the resources at . For example a request for a web page associated with the resources may be received. In response to receiving the request and after determining that the manifest has not been created for the web page the compression proxy service obtains and compresses each of the resources at . For example the compression proxy service communicates with the origin sites storing each of the requested resources.

Aspects of the disclosure are operable with execution of any kind or quantity of compression algorithms. One or more compression characteristics are generated at for each of the resources based on execution of the compression algorithm. The compression characteristics chosen to be generated by the compression proxy service may be dependent on the particular compression algorithm used. Exemplary compression characteristics include but are not limited to a compression rate and or a compression quality. The compression rate may be expressed as a percentage or other metric or value. The compression quality may be expressed by any metric or value indicating a difference between a compressed version of the resource and an uncompressed version of the resource.

The compression proxy service evaluates the generated compression characteristics at . For example the compression characteristics may be compared against corresponding threshold values. In some embodiments the compression rate for each resource may be compared to a threshold compression rate. Alternatively or in addition the compression quality for each resource may be compared to a threshold compression quality.

At the compression proxy service selects one or more of the resources to include in the manifest for the web page based on the evaluation of the compression characteristics. For example if the compression rate of one of the resources meets or exceeds the threshold compression rate or otherwise compresses well or favorably the compression proxy service selects the resource for inclusion in the manifest . Alternatively or in addition if the compression quality of one of the resources meets or exceeds the threshold compression quality or otherwise compares well or favorably to the uncompressed version of the resource the compression proxy service selects the resource for inclusion in the manifest .

In some embodiments the inclusion or identification of one of the resources in the manifest indicates that the compression proxy service has decided based on evaluation of the compression characteristics that the compression proxy service intends to provide compressed versions of the selected resources in response to subsequent requests for the selected resources. In this manner the compression proxy service is able to choose which resources to obtain and compress resulting in efficient use of the compression proxy service e.g. reduced network traffic .

In some embodiments the compression proxy service further caches or otherwise stores the compressed versions of only the selected resources for delivery in response to subsequent requests for the resource. For example compressed versions of frequently requested resources may be cached.

At the compression proxy service defines the manifest for the web page to include an identification of the selected resources. Aspects of the disclosure are operable with any form or format of the manifest as well as any indication that compressed versions of the selected resources are available from the compression proxy service . The defined manifest is stored in the memory area accessible to the compression proxy service .

In response to a subsequent request e.g. a second request for the web page the compression proxy service sends transmits or otherwise provides the manifest to the requesting user device at . The user device uses the manifest to identify which of the plurality of resources associated with the web page to obtain from the compression proxy service instead of from the origin site or other source. The user device sends requests for the resources associated with the web page to either the compression proxy service or the origin site see . If the compression proxy service has cached a compressed version of any of the resources the compression proxy service provides the cached compressed versions in response to the request from the user device .

In the example of the inclusion of a resource in the manifest indicates that the resource should be obtained or is otherwise capable of being obtained by the user device from the compression proxy service . In other examples not shown the manifest identifies each of the resources associated with the web page and identifies the locations e.g. the compression proxy service or the origin sites from which the resources should be obtained.

In still another example not shown the inclusion of a resource in the manifest indicates that the resource should be obtained by the user device from the origin site . In such embodiments the manifest identifies the resources to be downloaded from the origin site rather than the compression proxy service . The identified resources may be listed in a ResourceExclusions field as a collection of short hashes corresponding to URLs for each of the identified resources that should be downloaded from the origin site . The ResourceExclusions field may include a set of hashes such as the following 

In still another example not shown one or more of the generated compression characteristics are stored in the manifest . In such an example for each of the resources the user device rather than the compression proxy service performs the evaluation of the corresponding compression characteristic to determine whether to obtain the resource from the compression proxy service or the origin site . In this manner each of the user devices may apply different thresholds for determining whether the resource should be obtained from the compression proxy service or the origin site .

Also while described in some embodiments as a choice between obtaining the resources from the compression proxy service or the origin site other content sources are contemplated. For example the compression proxy service may identify which of the resources are popular based on a frequency of requests for the resources. The compression proxy service notifies the content delivery network of the identified resources to prompt the content delivery network to obtain compress store and provide compressed versions of the identified resources responsive to requests therefor. Alternatively the compression proxy service may provide compressed versions of the identified resources for storage by the content delivery network .

In such embodiments the manifest is updated to indicate that the identified resources are available from the content delivery network . For example the manifest may include a CdnInclusion field identifying the resources available from the content delivery network . Exemplary configuration rules for determining whether one of the resources should be made available from the content delivery network include one or more of the following 

Further while the operations illustrated in correspond to creation and definition of the manifests aspects of the disclosure iteratively perform one or more of the operations to implement machine learning to dynamically update and maintain the manifests based on the most recent compression characteristics. For example the evaluation of the compression characteristics selection of resources for inclusion in the manifest and updating of the manifest represent or correspond to machine learning operations.

Referring next to an exemplary sequence diagram illustrates creation of the manifest for a web page. The user device e.g. via a network stack or other component sends an application programming interface API call such as GetManifest Web Page to the compression proxy service . The compression proxy service searches the cache for the manifest corresponding to the requested Web Page. If the manifest is found not shown the compression proxy service provides the manifest to the user device . If the manifest is not found as in the compression proxy service creates a new or default manifest by executing for example the operations illustrated in . The new original or default manifest instructs the user device to obtain each of the resources from the compression proxy service except for globally excluded resources such as video . In this manner the compression proxy service has the opportunity to compress and analyze each of the resources to decide which resources in response to subsequent or future requests should be handled by the compression proxy service . The manifest is saved to the cache and provided to the user device .

Referring next to an exemplary flow chart illustrates operation of the user device to request resources associated with a web page from locations identified in the manifest for the web page. The operations illustrated in are executed in some embodiments by a network stack executing on the user device that is browsing for content e.g. on the Internet or other network . Each web page may have a plurality of the resources associated therewith. As described further below the user device chooses based on the manifest whether to send requests for resources to the compression proxy service to the content delivery network or to the origin site s associated with each resource.

If a request for a web page is detected at the user device subsequently receives the manifest for the web page at . For example the user device may request the manifest e.g. from the compression proxy service or the user device requests the web page but instead first receives the manifest corresponding thereto. The request may include for example the URL of the web page. In some embodiments the user device caches the received manifest for some duration e.g. time to live .

At the user device parses the manifest to identify the locations at which each of the resources associated with the web page are available. The user device sends each of the requests for one of the resources to the identified locations. For example the user device may send for one of the resources a request to the compression proxy service at the content delivery network at or the origin site at .

Upon receipt of a request for one of the resources as instructed by the manifest the compression proxy service delivers a compressed version of the requested resource from the cache if stored there or obtains the resource from the origin site on demand and compresses the resource before delivering the compressed version of the requested resource to the user device .

In some embodiments the operations illustrated in are implemented by the computer executable components illustrated in . For example the network stack component when executed by a processor of the user device causes the user device to detect the request for the web page. The interface component when executed by a processor of the user device causes the user device to receive the manifest associated with the web page in the request detected by the network stack component . In some embodiments the interface component includes a network interface card and or computer executable instructions e.g. a driver for operating the network interface card. Communication between the user device and other devices may occur using any protocol or mechanism over any wired or wireless connection.

The redirection component when executed causes a processor of the user device to parse the manifest received by the interface component to identify a first one of the resources to obtain as compressed data from a first network location e.g. the compression proxy service and a second one of the resources to obtain as uncompressed data from a second network location e.g. the origin site or other web site .

The network stack component further requests the first one of the resources from the first network location and the second one of the resources from the second network location. For example the network stack component sends hypertext transfer protocol HTTP requests to the network locations.

In some embodiments the compression proxy service updates created manifests based on a subsequent evaluation of the compressed resources or after re compression of the resources. For example during peak usage times e.g. high processor usage of the compression proxy service the compression proxy service may compress resources quickly with less compression. During a subsequent off peak usage time e.g. low processor usage the compression proxy service may attempt to re compress the resources more thoroughly which may result in greater compression of the resources. The compression proxy service is then able to generate updated compression characteristics and evaluate the updated compression characteristics to determine whether the previously created manifest should be updated.

At least a portion of the functionality of the various elements in the figures may be performed by other elements in the figures or an entity e.g. processor web service server application program computing device etc. not shown in the figures.

In some embodiments the operations illustrated in and may be implemented as software instructions encoded on a computer readable medium in hardware programmed or designed to perform the operations or both. For example aspects of the disclosure may be implemented as a system on a chip or other circuitry including a plurality of interconnected electrically conductive elements.

While no personally identifiable information is tracked by aspects of the disclosure embodiments have been described with reference to data monitored and or collected from users. In such embodiments notice is provided to the users of the collection of the data e.g. via a dialog box or preference setting and users are given the opportunity to give or deny consent for the monitoring and or collection. The consent may take the form of opt in consent or opt out consent.

Exemplary computer readable media include flash memory drives digital versatile discs DVDs compact discs CDs floppy disks and tape cassettes. By way of example and not limitation computer readable media comprise computer storage media and communication media. Computer storage media include volatile and nonvolatile removable and non removable media implemented in any method or technology for storage of information such as computer readable instructions data structures program modules or other data. Computer storage media are tangible exclude propagated data signals and are mutually exclusive to communication media. In some embodiments computer storage media are implemented in hardware. Exemplary computer storage media include hard disks flash drives and other solid state memory. In contrast communication media typically embody computer readable instructions data structures program modules or other data in a modulated data signal such as a carrier wave or other transport mechanism and include any information delivery media.

Although described in connection with an exemplary computing system environment embodiments of the invention are operational with numerous other general purpose or special purpose computing system environments or configurations. Examples of well known computing systems environments and or configurations that may be suitable for use with aspects of the invention include but are not limited to mobile computing devices personal computers server computers hand held or laptop devices multiprocessor systems gaming consoles microprocessor based systems set top boxes programmable consumer electronics mobile telephones network PCs minicomputers mainframe computers distributed computing environments that include any of the above systems or devices and the like.

Embodiments of the invention may be described in the general context of computer executable instructions such as program modules executed by one or more computers or other devices. The computer executable instructions may be organized into one or more computer executable components or modules. Generally program modules include but are not limited to routines programs objects components and data structures that perform particular tasks or implement particular abstract data types. Aspects of the invention may be implemented with any number and organization of such components or modules. For example aspects of the invention are not limited to the specific computer executable instructions or the specific components or modules illustrated in the figures and described herein. Other embodiments of the invention may include different computer executable instructions or components having more or less functionality than illustrated and described herein.

Aspects of the invention transform a general purpose computer into a special purpose computing device when configured to execute the instructions described herein.

The embodiments illustrated and described herein as well as embodiments not specifically described herein but within the scope of aspects of the invention constitute exemplary means for selective compression of resources associated with the web page to reduce network traffic associated with the compression proxy service and exemplary means for performing machine learning operations to dynamically update the manifest based on the generated at least one compression characteristic. For example the processor programmed to perform the algorithms illustrated in constitutes such exemplary means.

The order of execution or performance of the operations in embodiments of the invention illustrated and described herein is not essential unless otherwise specified. That is the operations may be performed in any order unless otherwise specified and embodiments of the invention may include additional or fewer operations than those disclosed herein. For example it is contemplated that executing or performing a particular operation before contemporaneously with or after another operation is within the scope of aspects of the invention.

When introducing elements of aspects of the invention or the embodiments thereof the articles a an the and said are intended to mean that there are one or more of the elements. The terms comprising including and having are intended to be inclusive and mean that there may be additional elements other than the listed elements.

Having described aspects of the invention in detail it will be apparent that modifications and variations are possible without departing from the scope of aspects of the invention as defined in the appended claims. As various changes could be made in the above constructions products and methods without departing from the scope of aspects of the invention it is intended that all matter contained in the above description and shown in the accompanying drawings shall be interpreted as illustrative and not in a limiting sense.

In the above example the CdnResources field contains the set of short hashes of the URLs pushed by the compression proxy service to the content delivery network . The ExcludedResources field contains the set of short hashes of the URLs the user device should request from the origin site . The ExcludedDomains field contains the set of domains the user device should request from the origin site . The ExclusionRules field includes rules used to identify a group of resources that should be requested from the origin site . The ExcludedExtensions field includes extensions of resources the user device should request from the origin site . A Last Modified field indicates the time when the manifest was last modified.

Any resource not excluded in the ExcludedResources field the ExcludedDomains field the ExcludedExtensions field or the ExclusionRules field is to be requested from the compression proxy service .

Aspects of the disclosure are operable with any configuration settings for interpreting requests for web pages to create manifests for the web pages. Listed below are exemplary threshold settings relating to collecting popularity counts for the web pages.

As an example if PagePopularityThreshold 10 and PagePopularityIndexLifespanInMinutes 15 for a web page aspects of the disclosure process the web page only after receiving 10 requests from users for the web page and only if the time between two successive requests is approximately less than 15 minutes e.g. otherwise the counter expires and resets to zero .

