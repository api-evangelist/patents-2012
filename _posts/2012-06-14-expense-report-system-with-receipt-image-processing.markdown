---

title: Expense report system with receipt image processing
abstract: A system and method for capturing image data is disclosed. A receipt image processing service selects from a repository a template that guides data capture of receipt data from a receipt image and presents the template to a user on an image capture device. A user previews the receipt image and the selected template. If the user decides that the template does not correctly indicate locations of data areas for data items in the receipt image, then the user either updates an existing template or creates a new template that correctly indicates the location of selected data areas in the receipt image. The selected template, the updated template, or the new template is then used to extract receipt data from the receipt image. The receipt data and receipt image data are then provided to the expense report system.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08990112&OS=08990112&RS=08990112
owner: Ricoh Company, Ltd.
number: 08990112
owner_city: Tokyo
owner_country: JP
publication_date: 20120614
---
This application is a continuation in part and claims the benefit of prior U.S. application Ser. No. 13 410 170 filed on Mar. 1 2012 and titled Expense Reporting System With Receipt Image Processing which application is incorporated by reference in its entirely into the present application.

The approaches described in this section are approaches that could be pursued but not necessarily approaches that have been previously conceived or pursued. Therefore unless otherwise indicated it should not be assumed that any of the approaches described in this section qualify as prior art merely by virtue of their inclusion in this section.

Currently accounting for business expenditures is a painstaking and time consuming activity. The receipts relating to an expenditure are manually collected itemized and entered into a form. The receipt is then manually reconciled with any credit card information available from a credit card service that processed a credit card used in the making the expenditure. If a person made the expenditure with a personal credit card then a credit card statement for the expenditure has to be collected from the person using the credit card. If the person made the expenditure with cash then there is no credit card data with which to reconcile the receipt. Not only do the above activities take time but they also delay reimbursement to the person making the expenditure.

Additionally receipts from purchase transactions come in various sizes and formats. Because of these different sizes and formats submitting these receipts to an OCR engine for data capture may not always yield accurate data. When the captured data is presented to a user for verification the user has to take additional time to correct and incorrect or missing data.

One embodiment is a method for generating expense data for an expense report. The method includes receiving receipt data that includes one or more data items pertaining to a transaction where the one or more data items are obtained from characters optically recognized in receipt image data for the transaction and the receipt data includes data indicating that the transaction is a credit card transaction and creating expense data for the expense report where the expense data includes the receipt data and the receipt image data associated with the receipt data for the transaction and the receipt data includes credit card data.

Another embodiment is a method for capture of image data. The method includes i receiving receipt image data from an image capture device where the receipt image data has a particular layout of data items ii selecting a template from a plurality of templates where the selected template has a layout of data areas corresponding to the particular layout of data items in the receipt image data iii transferring the selected template to the image capture device iv obtaining a data extraction template from the image capture device in response to transferring the selected template and v extracting receipt data from the receipt image data in accordance with the extraction template.

Embodiments may be implemented by instructions processed by one or more processors by one or more computer implemented methods or by devices or apparatuses configured accordingly.

In the following description for the purposes of explanation numerous specific details are set forth in order to provide a thorough understanding. It will be apparent however that embodiments may be practiced without these specific details. In other instances well known structures and devices are depicted in block diagram form in order to avoid unnecessarily obscuring the embodiments.

An embodiment obtains data from a receipt and matches the data with credit card information if the transaction recorded on the receipt is a credit card transaction. An expense report is generated based the receipt data and the credit card transaction data. In the description that follows it is understood that while the term credit card is used for purposes of explanation the term includes without limitation any form of payment that involves the use of crediting or debiting of an account and is not limited to credit debit or ATM cards. For example the approach is applicable to transactions involving the use of credit cards debit cards and ATM cards as well as transactions that are performed using wireless communications for example via mobile devices PDAs cell phones tablet computers laptop computers etc.

The expense report system receives the receipt image data via link from the receipt image capture devices credit card data from the credit card services via link and receipt data from the receipt image processing services via link . The receipt image processing services receives the receipt image data from the expense report system optically recognizes the characters in the receipt image data and extracts relevant receipt data from the receipt image data . Once the expense report system obtains the receipt data the expense report system associates the receipt data and receipt image data with respective credit card data and creates expense data for an expense report .

The expense report system receives the receipt image data from the receipt image processing services via link credit card data from the credit card services via link and receipt data from the receipt image processing services via link . The receipt image processing services receives the receipt image data from the receipt image capture devices via link optically recognizes the characters in the receipt image data and extracts relevant receipt data from the receipt image data . Once the expense report system obtains the receipt data the expense report system associates the receipt data and receipt image data with respective credit card data and creates expense data for an expense report .

The receipt image data is stored in either persistent or non persistent storage in a system hosting receipt image processing services . The OCR engine is aided by a data verifier which includes a user interface to help increase the accuracy of the extracted receipt data. The database stores the receipt data extracted from the receipt image data . The Application Programming Interface provides a programming interface for communicating with external systems such as the expense report system in or the image capture devices in .

Data items are recognized by an OCR engine in . According to one embodiment one or more uncertainty parameters such as parameter are associated with one or more of these data items. An uncertainty parameter provides an indication of the expected accuracy of the OCR process with respect to one or more corresponding data items. Uncertainty parameters may be expressed in a wide variety of forms depending upon a particular implementation. For example an uncertainty parameter may be expressed as a numerical value between 0 and 1 where 0 represents the lowest level of uncertainty and a 1 represents the highest level of certainty. Uncertainty parameters may be generated and stored by receipt image processing services .

According to one embodiment the uncertainty parameters are displayed on a graphical user interface to provide a visual indication to a user of the expected accuracy of the OCR process with respect to certain data items. For example when the uncertainty parameter for a data item is below a threshold the system depicts blank values in the user interfaces depicted in thereby flagging a user as to the uncertainty of the data. In the data verification user interfaces depicted a user has an option to correct the data value and area on the receipt image data and associate the area with respective data item of interest. When a user makes such a correction the changes are fed back to the OCR engine in to improve accuracy when OCR engine comes across similar receipt image data.

The example user interface depicted in includes data areas in the receipt image and data items in the receipt data for a particular item item in the receipt image when the data is correctly captured by the OCR engine . The data areas in the receipt image include a vendor merchant name the transaction date the item description the transaction amount a credit debit card type and the credit debit card number . The receipt data for item includes the vendor merchant name the transaction date the item description the transaction amount the credit debit card number and the credit debit card type . Additionally the receipt data depicted includes a cash radio button and a credit radio button which for the example depicted is marked because the item transaction is a credit transaction. The figure depicts that the OCR engine identified the receipt data for item correctly and accurately because each data area in the receipt image pertaining to item has a corresponding data item in the receipt data for item that is correctly captured. Additionally an accuracy scale indicates to the user that the receipt data is correct and accurate.

The user interfaces depicted in and depict how a user can improve the ability of the OCR engine to capture data from receipt image data.

Sometimes the OCR engine captures a data area on the receipt image but does so inaccurately. The data item in the receipt data is not blank but the data in the data item is not accurate according to the receipt image. depict this example.

In some of the data items in the receipt data do not match the corresponding data areas in the receipt image . In the figure data areas of the receipt image include vendor merchant name the transaction date the item description the transaction amount the credit debit card type and the credit debit card number . The data items of the receipt data include the vendor merchant name the transaction date the item description the transaction amount the credit debit card number and the credit debit card type . The credit radio button is marked. However while the other captured data items in the receipt data for item match the data areas in the receipt image for item the transaction amount on the receipt image does not match the captured transaction amount in the receipt data and the credit debit card number on the receipt image does not match the captured credit debit card number in the receipt data . Additionally an accuracy scale indicates that the receipt data accuracy is less than 100 .

In a user corrects the inaccurate data items in the receipt depicted in . In the figure the data areas in receipt image include the vendor merchant name the transaction date the item description the transaction amount the credit debit card type and the credit debit card number . The data items in the receipt data include the vendor merchant name the transaction data the item description the transaction amount the credit debit card number and the credit debit card type . The credit radio button is marked. In the figure a user has corrected the transaction amount and the credit debit card number to match the data for those items in the receipt image thereby raising the accuracy indicator to 100 . The corrected transaction amount and credit debit card number are supplied to the OCR engine to improve its accuracy. Additionally data areas for those items are delineated to further aid the OCR engine .

 depicts a flow in one embodiment of how the receipt data is associated with credit card transaction data and expense data is created in the expense management system. In step receipt image processing services provides the receipt image data and the receipt data . In step the system checks the receipt image data and receipt data to determine whether the transaction is a cash transaction. If so the system creates cash expense data and associates the cash expense data with the receipt image data and receipt data in step . If the transaction is a credit transaction as determined in step the system determines in step whether the credit debit card number on the receipt data matches a corporate card number. If there is no match as determined in step then the system creates new expense data for personal credit card transaction and associates the new expense data with receipt image data and receipt data in step . If the credit debit card number in the transaction is a corporate credit debit card number as determined in step then in step the system compares the credit debit card number with the credit card data available from corporate credit card services . If there is a match as determined in step the system creates expense data for a corporate credit card transaction and associates the expense data with the receipt image data and receipt data in step . If there is no match found between the corporate credit card data and the receipt data as determined in step the system creates expense data with receipt image data and receipt data and a user manually associates in step this expense data with credit card data and the receipt image data and receipt data .

As used herein template refers to a data structure that contains information about the location size shape and orientation of various data areas in an image such as a particular receipt image. In one embodiment the data structure is an object that contains offsets sizes shapes and orientations for each data area in a particular receipt such that when the data structure is represented visually over the receipt image each data area exposes to view only the corresponding data item in the receipt image.

Creating a template to aid the OCR engine capture with better accuracy decreases the time needed to verify and extract data from receipt. In one embodiment a user previews a captured receipt image and views a matching template returned by image processing service. The user can accept the template identified by the OCR engine modify the template or create a new template. To modify the template the user indicates the data area or areas for adjustment on an existing data extraction template and then repositions those data areas on the receipt image to update the template. To create a new template user indicates data areas for capture and their locations on the receipt image and then builds a data extraction template based on those data areas.

In step the image capture device uploads the receipt image data which has a particular layout of data items to receipt image processing services . Upon receiving the receipt image from the image capture device receipt image processing services selects from the templates in the receipt image template data storage a template having a layout that corresponds to the particular layout of data items in the receipt image data. In one embodiment metadata associated with a stored template aids in the selecting process. Metadata includes locations of the data areas including the relative positions of the data areas with respect to each other as well as the absolute positions of the data areas with respect to the template s outer boundaries. Metadata further includes keywords which are labels for the data areas which are likely to match words found in the receipt image data. Matching locations of data areas and keywords found in the receipt thus helps receipt image processing services to locate a template in the in the receipt image template data storage that is suited for data capture of the data items in the receipt image.

In step the receipt image processing service then transfers the selected template for review by a user to an image capture device such as a digital scanner digital camera smart phone or tablet computer which has a touch panel display screen. In step a user at the image capture device reviews the selected template and determines whether the selected template is suitable for extracting data from the receipt image. If the user decides that the selected template is suitable then the image capture device transfers the template to the receipt image processing service for use as the data extraction template for the receipt image data.

Alternatively if the user decides that the selected template is not suitable the user can either modify an existing template or create a new template. If the user modifies an existing template the modified template described in more detail below is sent in step to receipt image processing services for use as the data extraction template. If the user creates a new template then the new template described in more detail below is sent in step to receipt image processing services as the data extraction template. Thus the data extraction template is either the selected template a user modified template or a new template.

In step the OCR engine in receipt image processing services then captures the receipt data from the receipt image data in accordance with the data extraction template obtained in step . In step the captured receipt data is stored in receipt image processing services and the receipt image data is associated with the captured receipt data. In step receipt image processing services transmits the receipt image data and receipt data to the expense report system . In step if the data extraction template is either a new or updated template then the data extraction template is stored in receipt image template data storage . In step if the transaction is a credit debit transaction the expense report system associates credit debit card data pertaining to the transaction with the receipt data and creates expense data for an expense report. The expense data includes the receipt image data and the receipt data which includes the associated credit debit card information. If the transaction is a cash transaction the expense report system creates expense data for a cash transaction.

If the user believes that the template is in good order then the user touches the save template button to save the template to the receipt image template data storage . If the user believes that one or more of the data items needs adjustment then the user selects a check box for the item removes the item by touching the remove button provides a new location for the area on the receipt image and then adds the corresponding area to the template by touching the add button . If the user decides to end the template creation process the user touches the cancel button .

In another embodiment of the user interface depicted in the user touches the update button and the touches one of the check boxes causing one of the corresponding data areas to become visible on the receipt image . In the example illustrated the user touches the item description check box to cause the area to become visible on the receipt image . The user repositions the data area for the item description and then touches the add button to fix the corresponding data area in the template . The user repeats this process until all needed updates are made after which the user saves the template using the save template button .

According to one embodiment the techniques described herein are implemented by one or more special purpose computing devices. The special purpose computing devices may be hard wired to perform the techniques or may include digital electronic devices such as one or more application specific integrated circuits ASICs or field programmable gate arrays FPGAs that are persistently programmed to perform the techniques or may include one or more general purpose hardware processors programmed to perform the techniques pursuant to program instructions in firmware memory other storage or a combination. Such special purpose computing devices may also combine custom hard wired logic ASICs or FPGAs with custom programming to accomplish the techniques. The special purpose computing devices may be desktop computer systems portable computer systems handheld devices networking devices or any other device that incorporates hard wired and or program logic to implement the techniques.

For example is a block diagram that depicts a computer system upon which an embodiment may be implemented. Computer system includes a bus or other communication mechanism for communicating information and a hardware processor coupled with bus for processing information. Hardware processor may be for example a general purpose microprocessor.

Computer system also includes a main memory such as a random access memory RAM or other dynamic storage device coupled to bus for storing information and instructions to be executed by processor . Main memory also may be used for storing temporary variables or other intermediate information during execution of instructions to be executed by processor . Such instructions when stored in non transitory storage media accessible to processor convert computer system into a special purpose machine that is customized to perform the operations specified in the instructions.

Computer system further includes a read only memory ROM or other static storage device coupled to bus for storing static information and instructions for processor . A storage device such as a magnetic disk or optical disk is provided and coupled to bus for storing information and instructions.

Computer system may be coupled via bus to a display such as a cathode ray tube CRT for displaying information to a computer user. An input device including alphanumeric and other keys is coupled to bus for communicating information and command selections to processor . Another type of user input device is cursor control such as a mouse a trackball or cursor direction keys for communicating direction information and command selections to processor and for controlling cursor movement on display . This input device typically has two degrees of freedom in two axes a first axis e.g. x and a second axis e.g. y that allows the device to specify positions in a plane.

Computer system may implement the techniques described herein using customized hard wired logic one or more ASICs or FPGAs firmware and or program logic which in combination with the computer system causes or programs computer system to be a special purpose machine. According to one embodiment the techniques herein are performed by computer system in response to processor executing one or more sequences of one or more instructions contained in main memory . Such instructions may be read into main memory from another storage medium such as storage device . Execution of the sequences of instructions contained in main memory causes processor to perform the process steps described herein. In alternative embodiments hard wired circuitry may be used in place of or in combination with software instructions.

The term storage media as used herein refers to any non transitory media that store data and or instructions that cause a machine to operation in a specific fashion. Such storage media may comprise non volatile media and or volatile media. Non volatile media includes for example optical or magnetic disks such as storage device . Volatile media includes dynamic memory such as main memory . Common forms of storage media include for example a floppy disk a flexible disk hard disk solid state drive magnetic tape or any other magnetic data storage medium a CD ROM any other optical data storage medium any physical medium with patterns of holes a RAM a PROM and EPROM a FLASH EPROM NVRAM any other memory chip or cartridge.

Storage media is distinct from but may be used in conjunction with transmission media. Transmission media participates in transferring information between storage media. For example transmission media includes coaxial cables copper wire and fiber optics including the wires that comprise bus . Transmission media can also take the form of acoustic or light waves such as those generated during radio wave and infra red data communications.

Various forms of media may be involved in carrying one or more sequences of one or more instructions to processor for execution. For example the instructions may initially be carried on a magnetic disk or solid state drive of a remote computer. The remote computer can load the instructions into its dynamic memory and send the instructions over a telephone line using a modem. A modem local to computer system can receive the data on the telephone line and use an infra red transmitter to convert the data to an infra red signal. An infra red detector can receive the data carried in the infra red signal and appropriate circuitry can place the data on bus . Bus carries the data to main memory from which processor retrieves and executes the instructions. The instructions received by main memory may optionally be stored on storage device either before or after execution by processor .

Computer system also includes a communication interface coupled to bus . Communication interface provides a two way data communication coupling to a network link that is connected to a local network . For example communication interface may be an integrated services digital network ISDN card cable modem satellite modem or a modem to provide a data communication connection to a corresponding type of telephone line. As another example communication interface may be a local area network LAN card to provide a data communication connection to a compatible LAN. Wireless links may also be implemented. In any such implementation communication interface sends and receives electrical electromagnetic or optical signals that carry digital data streams representing various types of information.

Network link typically provides data communication through one or more networks to other data devices. For example network link may provide a connection through local network to a host computer or to data equipment operated by an Internet Service Provider ISP . ISP in turn provides data communication services through the world wide packet data communication network now commonly referred to as the Internet . Local network and Internet both use electrical electromagnetic or optical signals that carry digital data streams. The signals through the various networks and the signals on network link and through communication interface which carry the digital data to and from computer system are example forms of transmission media.

Computer system can send messages and receive data including program code through the network s network link and communication interface . In the Internet example a server might transmit a requested code for an application program through Internet ISP local network and communication interface .

The received code may be executed by processor as it is received and or stored in storage device or other non volatile storage for later execution.

In the foregoing specification embodiments have been described with reference to numerous specific details that may vary from implementation to implementation. The specification and drawings are accordingly to be regarded in an illustrative rather than a restrictive sense. The sole and exclusive indicator of the embodiments and what is intended by the applicants to be the scope of embodiments is the literal and equivalent scope of the set of claims that issue from this application in the specific form in which such claims issue including any subsequent correction.

