---

title: Printing system, control method of the same, print server, control method of the print server, and storage medium
abstract: A print server includes a registration unit configured to register a virtual printer according to a printer registration request received from a information processing apparatus, a storage unit configured to store printer information about the virtual printer registered by the registration unit, and a notification unit configured to notify the printing apparatus of a printer registration notification indicating that the virtual printer is registered by the registration unit, wherein the printer information is acquired by the printing apparatus which receives the printer registration notification.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08665478&OS=08665478&RS=08665478
owner: Canon Kabushiki Kaisha
number: 08665478
owner_city: Tokyo
owner_country: JP
publication_date: 20120120
---
The present invention relates to a printing system configured to generate a virtual printer on a client personal computer PC a printing apparatus a control method for the printing system a control method for the printing apparatus and a program.

Recently networking of printers and multifunctional peripherals has been progressed so that generally printing is performed by a target printer or a target multifunctional peripheral via a network according to an instruction from a host computer. In this case a printer object which acts as a target printer is generated on the host computer and when printing based on an application a user selects that printer object to execute the printing.

On the other hand in the case of printing via a print server a printer object corresponding to a virtual printer on the print server is generated on a client personal computer PC . The user executes the printing to load a print job onto the print server. Loading the print job via the print server makes possible a synthetic print document control within a system and further utilization of a pull print function and an equivalent function using an integrated circuit IC card.

The printer object may be generated by manually inputting an Internet protocol IP address or the like and automatically generated by searching the network. When the printer object is generated by searching the network the search needs to be implemented by limiting the range of the network. Consequently there exists such an issue for example that any printer existing in any different range from the host computer may not be searched for.

To solve this issue Japanese Patent Application Laid Open No. 2003 296073 has discussed a method for specifying a network which a user wants to search and in which instead of the host computer the search is performed by a Web server and its result is brought back to the host computer.

However according to Japanese Patent Application Laid Open No. 2003 296073 when using the print server the user needs to understand the network in which the print server exists. Further according to this method the user may not confirm that the print server has a system for responding to a search and consequently the user needs to register manually the network which he or she wished to search whereby taking much time and labor.

The present invention is directed to a printing system which enables a user to easily generate a virtual printer existing on a print server on a client personal computer PC without being conscious of the network to be searched.

According to an aspect of the present invention a printing system includes a printing apparatus a print server and an information processing apparatus. The information processing apparatus includes a printer registration request unit configured to transmit a printer registration request to the print server and a search request unit configured to transmit a search request to the printing apparatus. The print server includes a registration unit configured to register a virtual printer according to a printer registration request received from the information processing apparatus a storage unit configured to store printer information about the virtual printer registered by the registration unit and a notification unit configured to notify the printing apparatus of a printer registration notification indicating that the virtual printer is registered by the registration unit. The printing apparatus includes an acquisition unit configured to acquire the printer information about the virtual printer corresponding to the printing apparatus in response to the printer registration notification notified from the print server and a transmission unit configured to transmit the printer information acquired by the acquisition unit to the information processing apparatus in response to the search request received from the information processing apparatus.

Further features and aspects of the present invention will become apparent from the following detailed description of exemplary embodiments with reference to the attached drawings.

Various exemplary embodiments features and aspects of the invention will be described in detail below with reference to the drawings.

Referring to a print server the client PCs and the printing apparatuses are connected via a network i.e. local area network LAN . The print server is a server computer which executes monitoring and management of the printing apparatus monitoring and control of print jobs receiving a print instruction from the client PC storing document data into a large capacity storage device and transfer processing of print data to the printing apparatus .

The large capacity storage device stores print data document data print job information printer information and the like. The client PC is a client computer which executes information processing and may communicate with the print server and other client PC via the LAN .

The printing apparatus is an image formation apparatus connected to the LAN . The printing apparatus communicates with the print server via the LAN . As the printing apparatus a various types of printing apparatuses such as a laser printer employing electrophotographic process an ink jet printer employing ink jet process a thermal transfer type printer are available. Further the printing apparatus is provided with a search response application which will be described in detail below with reference to .

A central processing unit CPU is a control unit of the information processing apparatus and executes an application program a print driver program an operating system and a printing system program of the present invention which are stored in a hard disk drive . Further the CPU performs control to temporarily store information and files necessary for executing those programs in a random access memory RAM . The CPU opens various types of windows registered based on a command instructed by a mouse cursor not illustrated on a display and executes various types of data processing. According to the present exemplary embodiment the printer generation processing is executed via a window displayed on the display of the client PC .

A read only memory ROM is a storage unit which stores various types of data pieces including programs such as basic input output I O program font data used for document processing and template data. The RAM is a temporary storage unit which functions as a main memory or a work area of the CPU . A network interface card NIC is an interface serving as an I O unit via which the information processing apparatus exchanges data with an external apparatus.

A keyboard is an instruction inputting unit via which a user inputs an instruction into an external apparatus. The display displays a command or the like input via the keyboard . A hard disk HD is one of external storage units which functions as a large capacity memory storing an application program a print driver program an operating system OS and the like.

A floppy disk FD drive reads a floppy disk and loads a print control program and related data directly onto the RAM and executes that program. A medium for storing the print control program may be a compact disk CD ROM CD readable CD R a PC card a digital versatile disk DVD or an integrated circuit IC memory card as well as the FD and the information processing apparatus is preferred to include a drive suitable for each storage medium. A system bus connects respective units constituting the information processing apparatus.

In the meantime the print control program may be stored in the ROM and configured as a part of the memory map and may be executed directly by the CPU . The print control program may be configured of software for achieving the functions similar to the respective above described units instead of the hardware.

In a basic I O program is an area which contains such a program having initial program loading IPL function which allows an operating system OS to be read into the RAM from the HD when the information processing apparatus is powered on to start the operation of the OS .

A print control program controls the printing system in the present exemplary embodiment and may be stored in an area reserved on the RAM . Related data is stored in an area reserved on the RAM . A work area has an area for the CPU to execute the print control program.

A memory map is an example of the memory map read by the FD drive illustrated in indicating the content of the FD data to be read by the FD drive . The memory map includes volume information which indicates data information directory information printing system program of the present exemplary embodiment and related data . The printing system program is produced according to a flow chart described in the present exemplary embodiment. In the present exemplary embodiment the printing system program is accommodated in the print server with the same configuration.

The detail of the printer information will be described below with reference to . The user specifies a printer name and an Internet protocol IP address when registering a printer. The user generates a printer object corresponding to the printer information on the client PC and specifies the printer object to execute printing via the print server . A related print processing will not be described in detail because it is not related to the present exemplary embodiment.

When the request management unit receives a print request a job management unit acquires print job information and print data from the large capacity storage device via a data base access unit . When receiving a print job the job management unit inquires a situation of the printing apparatus from a printer management unit . If the printing apparatus is in a normal condition the job management unit issues a job transmission instruction to a job control unit .

When receiving the job transmission instruction the job control unit transmits job data to the printing apparatus . In the present exemplary embodiment a communication protocol to be used in transmission is not specifically restricted and for example a line printer daemon protocol LPR a RAW protocol and an Internet printing protocol IPP are available.

If the request management unit receives a printer registration request the printer management unit acquires configuration information of the printing apparatus via a device control unit . Then the printer management unit stores the information to be specified when the printer registration is requested and the acquired configuration information into the large capacity storage device via the data base access unit .

After processing the printer registration request the printer management unit notifies the printing apparatus that the printer registration is completed via the device control unit . The communication protocol to be used in communication is not limited to any particular one. The detail of the printer registration processing will be described below with reference to .

A CPU reads a program stored in a ROM or an HDD into a RAM and executes the processing based on the read program to control each processing of the printing apparatus. The ROM which is a nonvolatile storage device stores a program and data concerning each processing of the printing apparatus.

The rewritable RAM electrically stores temporary data relating to each processing of the printing apparatus. The HDD stores a program and data relating to each processing of the printing apparatus and temporary data. An operation unit displays a screen and receives an operation instruction from a user via the screen.

An image reading unit includes a scanner or the like and optically reads a document image and converts the document image to digital image information. The image reading unit outputs the digital image information to the image forming unit to form an image or transfers the digital image information to a facsimile unit or a network interface unit to transmit the digital image information via network.

A device controller controls each operation of the image forming unit and the image reading unit and for example controls the image forming unit to copy the document information read by the image reading unit . The device controller includes a network interface unit a print processing unit the facsimile unit and an operation unit controlling unit and controls exchange of information between these units.

The facsimile unit receives and transmits a facsimile image. More specifically the facsimile unit transmits the digital image information read by the image reading unit and conversely decodes a received facsimile signal and causes the image forming unit to record the decoded image.

The operation unit controlling unit generates a signal corresponding to a user s operation via an operation panel of the operation unit and displays various types of data pieces and messages on the operation unit or the display unit .

The print processing unit performs control to process print data input via the network interface unit and to output the processed data to the image forming unit to print it. The network interface unit controls data communication with other communication terminals via the communication line.

A virtual machine is located higher than the device controller so that the virtual machine is capable of controlling the device controller . The network interface unit may be used directly by both the device controller and the virtual machine so that the device controller and the virtual machine may access an external network independently of each other.

Further an application described with a programming language corresponding to an application programming interface API provided by the virtual machine exists on a higher level than the virtual machine . The applications manage the device controller indirectly via the virtual machine and activates the image forming unit and the image reading unit . The present exemplary embodiment includes the search response application . The search response application will be described in detail below with reference to .

The applications may be uninstalled from the virtual machine or newly installed on the virtual machine as applications to . Although in the present exemplary embodiment the application is described as the application installed in the printing apparatus the application of the present exemplary embodiment may be provided in the form of hardware. Further the application may be provided as an application on a computer communicably connected to the printing apparatus .

An external storage device controlling unit converts an image read by the image reading unit to a data format which may be stored in the external storage device using the image forming unit and stores its result in the external storage device. The external storage device controlling unit reads data stored in the external storage device and prints out the read data via the image forming unit or transmits out the data via the network interface unit .

The search request control unit receives a search request from the client PC and a printer registration notification from the print server via the LAN . In the present exemplary embodiment it is assumed that the search request is a general printer retrieval function provided on the client PC .

When receiving the search request from the client PC the search request control unit acquires printer information registered in the printer information storage unit via the printer information management unit and notifies the client PC of the acquired printer information. When receiving the printer registration notification from the print server the search request control unit acquires the printer information from the print server and registers the printer information in the printer information storage unit via the printer information management unit .

The search setting storage unit stores search setting information which is a setting for an operation of the search response application when receiving a search request. According to the setting stored in the search setting storage unit the search response application changes the content of the response. Storage of the operation setting into the search setting storage unit is performed by a user s operation via the operation unit of the printing apparatus . The search setting information will be described below with reference to .

A printer name is a unique name in the print server which is information for a user to identify a printing apparatus in the print server . An IP address is set in the printing apparatus . The print server communicates with the printing apparatus based on the IP address .

A uniform resource locator URL is information set in port information of a printer object on the client PC . Using the URL the client PC specifies a printer on the print server . Print setting is information relating to print setting for a print job including two sided print setting page layout setting color setting and printing quantity setting.

The search response function setting includes a setting indicating whether the search response function of the present exemplary embodiment is used. If use of the search response function is set in the search response function setting the search response application responds to the search using the printer information of a virtual printer registered in the print server . When use of the search response function is not set in the search response function setting the search response application responds to the search using the printer information of the printing apparatus .

The print server address is address information for the search response application to specify the print server and communicate therewith and stores an IP address and a host name. The print server confirmation setting stores a setting indicating whether the search response application will respond to the search by updating the printer information each time after confirming the printer information in the print server .

The search response content setting stores a setting indicating whether the response to the search will be executed with only the printer information in the print server or together with the printer information in the printing apparatus .

A setting screen is an example of the screen for setting the search response application. Although it is assumed that the setting screen is set up via the operation unit the setting screen may be set up for example by an external apparatus such as the client PC via a web page provided by the printing apparatus . Information set by the user is stored in the search setting storage unit . Items to in the screen correspond to the search setting information pieces to .

In step S the request management unit of the print server receives a request from the client PC . In step S the request management unit determines whether the request received in step S is a printer registration request. If it is determined that the request is the printer registration request YES in step S the processing proceeds to step S. Whereas if the request is determined to be other than the printer registration request NO in step S the processing ends.

In step S the request management unit instructs the printer management unit to register a printer. After receiving the printer registration instruction according to information included in the received request the printer management unit registers the virtual printer and at the same time stores the printer information in the large capacity storage unit via the data base access unit .

In step S the printer management unit specifies the printing apparatus corresponding to the virtual printer registered based on the IP address of the printer information . Then the printer management unit notifies the search response application in the printing apparatus that the virtual printer has been registered printer registration notification via the device control unit .

Although the processing flow of the present exemplary embodiment describes only a case where a printer registration is requested it is naturally assumed that a printer setting change request and a printer deletion request are similarly notified to the search response application.

In step S the search request control unit of the search response application receives the request from the print server .

In step S the search request control unit determines whether the request received in step S is the printer registration notification. If it is determined that the received request is the printer registration notification YES in step S the processing proceeds to step S. If it is determined as other than the printer registration notification NO in step S the processing ends.

In step S the printer information management unit acquires the printer information of the printing apparatus stored in the large capacity storage device via the print server . In the meantime the printer information is specified according to the IP address. The acquisition of the printer information may be performed from the printer registration notification because the printer registration notification contains the printer information . In step S the printer information management unit stores the printer information acquired in step S into the printer information storage unit .

When the above described processing of the flowchart is executed the printer information serving as the virtual printer registration information is also stored in the printing apparatus which is a real object corresponding to the virtual printer registered in the print server .

In the meantime it is assumed that a plurality of virtual printers is generated in the print server . Consequently a plurality of the printer information pieces exists. The individual information pieces are distinguished according to each printer name .

In step S the search request control unit determines whether the request received in step S is a search request. If it is determined that the received request is the search request YES in step S the processing proceeds to step S. If it is determined as other than the search request NO in step S the processing ends.

In step S the search request control unit acquires the search setting information from the search setting storage unit .

In step S the search request control unit confirms the search response function setting of the search setting information acquired in step S and determines whether a setting for responding to the printer information of the virtual printer registered in the print server is established. If the setting for responding to the printer information of the virtual printer is established YES in step S the processing proceeds to step S. If the setting is not established NO in step S the processing proceeds to step S.

In step S the search request control unit confirms the print server confirmation setting of the acquired search setting information and determines whether a setting for responding to a search after updating the printer information is established. If the setting for responding to the search after updating the printer information is established YES in step S the processing proceeds to step S. If the setting is not established NO in step S the processing proceeds to step S.

In step S the search request control unit determines whether the printer information exists in the printer information storage unit via the printer information management unit . If the printer information exists in the printer information storage unit YES in step S the processing proceeds to step S and if not NO in step S the processing proceeds to step S.

In step S the search request control unit determines whether the printer information exists in the print server .

In step S if as a result of the determination by the search request control unit in step S the printer information exists YES in step S the processing proceeds to step S and otherwise NO in step S the processing proceeds to step S. In step S the search request control unit acquires the printer information from the print server .

In step S the search request control unit confirms the search response content setting of the acquired search setting information and determines whether a setting for responding to the search based on only the printer information in the print server is established. If the setting for responding to the search based on only the printer information in the print server is established YES in step S the processing proceeds to step S. On the other hand if the setting for responding to the search based on only the printer information in the print server is not established and a setting for responding based on the printer information in the printing apparatus as well is established NO in step S the processing proceeds to step S.

In step S the search request control unit responds to the search by transmitting only the printer information of the virtual printer registered in the print server to the client PC .

In step S the search request control unit responds to the search by transmitting both the printer information of the virtual printer registered in the print server and the printer information of the printing apparatus to the client PC .

In step S the search request control unit responds to the search by transmitting only the printer information of the printing apparatus to the client PC .

As described above the search response application has the printer information of the virtual printer in the print server and responds to the search. Consequently the user may generate the printer in the print server by the same operation as when generating the printer by an ordinary search.

In the meantime when the printer information pieces both of the print server and the printing apparatus are transmitted both of them may be displayed on the client PC such that they are distinguishable from each other. Although as a method for making the both printer information pieces distinguishable from each other changing displayed colors displaying words virtual printer to indicate the printer information of the print server and the like are available the method is not restricted to the aforementioned examples.

Aspects of the present invention can also be realized by a computer of a system or apparatus or devices such as a CPU or MPU that reads out and executes a program recorded on a memory device to perform the functions of the above described embodiment s and by a method the steps of which are performed by a computer of a system or apparatus by for example reading out and executing a program recorded on a memory device to perform the functions of the above described embodiment s . For this purpose the program is provided to the computer for example via a network or from a recording medium of various types serving as the memory device e.g. computer readable storage medium .

While the present invention has been described with reference to exemplary embodiments it is to be understood that the invention is not limited to the disclosed exemplary embodiments. The scope of the following claims is to be accorded the broadest interpretation so as to encompass all modifications equivalent structures and functions.

This application claims priority from Japanese Patent Application No. 2011 012044 filed Jan. 24 2011 which is hereby incorporated by reference herein in its entirety.

