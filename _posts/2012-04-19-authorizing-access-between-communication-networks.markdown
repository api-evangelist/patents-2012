---

title: Authorizing access between communication networks
abstract: Methods and systems of authorizing a user of a first packet-based communication network to access a second packet-based communication network are disclosed. A call setup request is received from a user terminal of the user at a first network element of the first packet-based communication network, the authorization request comprising a first user identity. Responsive to the call setup request, a request is transmitted to create a second user identity from the first network element to a second network element of the second packet-based communication network. The second network element creates the second user identity for use in the second packet-based communication network. The second user identity is derivable from the first user identity according to a predetermined rule. The second user identity is stored in the second packet-based communication network for use with establishing a call associated with the call setup request over the second packet-based communication network.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08477916&OS=08477916&RS=08477916
owner: Microsoft Corporation
number: 08477916
owner_city: Redmond
owner_country: US
publication_date: 20120419
---
This application is a continuation in part of the U.S. application Ser. No. 12 005 155 filed Dec. 21 2007 which claims priority under 35 USC 119 or 365 to Great Britain Application No. 0722370.4 filed Nov. 14 2007. The entire teachings of the above applications are incorporated herein by reference.

The Internet is used to provide a variety of different forms of communication between users. Two popular forms of communication are instant messaging IM and voice communication using voice over internet protocol VoIP .

Instant messaging is a computer based communication tool in which text based messages are exchanged between users in real time. To use an instant messaging system user terminals of the users must be connected to a communications network such as the internet and an instant messaging client application must be executed on the user terminal. The client application allows a user to initiate an instant messaging conversation with a remote user by establishing a connection over the communications network. The user can then type a message and send it to the remote user by pressing enter or actuating a send button and the message is displayed in the user interface of the client of the remote user in near real time depending on network delays . The remote user may then subsequently type a reply and send it to the other user. The exchange of messages can continue in this way in a similar form to face to face verbal conversation.

Voice over internet protocol VoIP communication systems allow the user of a device such as a personal computer to make calls across a computer network such as the Internet. These systems are beneficial to the user as they are often of significantly lower cost than fixed line or mobile networks. This may particularly be the case for long distance calls. To use VoIP the user must install and execute client software on their device. The client software provides the VoIP connections as well as other functions such as registration and authentication. VoIP systems can also be enhanced through the provision of video calling.

One type of VoIP communication system uses a peer to peer P2P topology built on proprietary protocols. To enable access to a peer to peer system the user must execute P2P client software provided by a P2P software provider on their computer and register with the P2P system. When the user registers with the P2P system the client software is provided with a digital certificate from a server. Once the client software has been provided with the certificate communication can subsequently be set up and routed between users of the P2P system without the further use of a server. In particular the users can establish their own communication routes through the P2P system based on the exchange of one or more digital certificates or user identity certificates UIC which enable access to the P2P system. The exchange of the digital certificates between users provides proof of the user s identities and that they are suitably authorised and authenticated in the P2P system. Therefore the presentation of digital certificates provides trust in the identity of the user. It is therefore a characteristic of peer to peer communication that the communication is not routed using a server but directly from end user to end user.

This Summary is provided to introduce a selection of concepts in a simplified form that are further described below in the Detailed Description. This Summary is not intended to identify key features or essential features of the claimed subject matter nor is it intended to be used to limit the scope of the claimed subject matter.

Various embodiments enable authorization of a user of a first packet based communication network to access a second packet based communication network. In one or more embodiments a call setup request is received from a user terminal of the user at a first network element of the first packet based communication network. The authorisation request comprises a first user identity. Responsive to the call setup request a request is transmitted to create a second user identity from the first network element to a second network element of the second packet based communication network. The second network element creates the second user identity for use in the second packet based communication network. In one or more embodiments the second user identity is derivable from the first user identity according to a predetermined rule. The second user identity is stored in the second packet based communication network for use with establishing a call associated with the call setup request over the second packet based communication network.

In at least some embodiments a user of a first packet based communication network can be authorised to access a second packet based communication network. An authorisation request can be received from a user terminal of the user at a first network element of the first packet based communication network. The authorisation request comprises a first user identity. Responsive to the authorisation request a request to create a second user identity is transmitted from the first network element to a second network element of the second packet based communication network. The second network element creates the second user identity for use in the second packet based communication network. The second user identity is derivable from the first user identity according to a predetermined rule. The second user identity is stored in the second packet based communication network for use with subsequent communication events over the second packet based communication network.

In one embodiment the predetermined rule comprises combining the first network identity and a predefined token. In another embodiment the predetermined rule comprises concatenating the first network identity with at least one predefined control character. In another embodiment the predetermined rule is a hash function.

In at least some embodiments the first packet based communication network is an instant messaging network and the second packet based communication network is a voice over internet protocol network as will become apparent below. The voice over internet protocol network can be a peer to peer network.

In at least some embodiments a calling user terminal can initiate a communication event with the user over the second packet based communication network. The communication event can be initiated by the calling user terminal deriving the second user identity from the first user identity using the predetermined rule and using the second network identity to establish a connection with the user over the second network.

In yet other embodiments the user terminal can initiate a communication event with a further user over the second packet based communication network. The user terminal can store a list of contacts of the user in which the list of contacts comprises network identities of the contacts in the first network. Initiating can include receiving selection of the further user from the list of contacts deriving a network identity of the further user in the second network from the network identity in the first network stored in the list of contacts using the predetermined rule and using the network identity of the further user in the second network to establish a connection with the further user over the second network.

In other embodiments an authorisation request can be received at the first network element and comprises a password. A user terminal can derive the second user identity from the first network identity using the predetermined rule and transmit the authorisation request to the second communication network comprising the second user identity.

In at least some embodiments the user terminal can transmit a request for a digital certificate to the first network element. The first network element can request the digital certificate from the second network element. The second network element can provide the digital certificate to the first network element and the first network element can provide the digital certificate to the user terminal. In some embodiments a private key can be derived from the digital certificate and the authorisation request transmitted to the second communication network can comprise the private key. The digital certificate can be provided to the second packet based communication network prior to initiating a communication event.

In at least some embodiments a first network element is connected to a first packet based communication network and a second network element is connected to a second packet based communication network. The first network element is arranged to receive an authorisation request comprising a first user identity from a user terminal and transmit a request to create a second user identity to the second network element responsive to the authorisation request. The second network element is arranged to create the second user identity for use in the second packet based communication network. The second user identity is derivable from the first user identity according to a predetermined rule. The second network element is arranged to store the second user identity for use with subsequent communication events over the second packet based communication network.

In at least some embodiments a user of a first packet based communication network can be authorised to access a second packet based communication network. A network entity connected to the second packet based communication network receives a request to create a user identity. The request is transmitted from a first network entity connected to the first packet based communication network and comprises a first user identity used in the first packet based communication network. The network entity creates the user identity for use in the second packet based communication network. The user identity is derivable from the first user identity according to a predetermined rule. The network entity stores the user identity in the second packet based communication network for use with subsequent communication events over the second packet based communication network.

Having provided an overview reference is first made to which illustrates a system comprising two separate communication networks with a combined interoperable authentication scheme in accordance with one or more embodiments.

A first user of the system denoted User A operates a user terminal which is shown connected to a network such as the Internet. The user terminal may be for example a personal computer PC personal digital assistant PDA a mobile phone a gaming device or other embedded device able to connect to the network . The user terminal has a display such as a screen and a keyboard and mouse. The user terminal is connected to the network via a network interface such as a modem and the connection between the user terminal and the network interface may be via a cable wired connection or a wireless connection.

The user terminal is running a client . The client is a software program executed on a local processor in the user terminal . The user terminal is also connected to a handset which comprises a speaker and microphone to enable the user to listen and speak in a voice call. The microphone and speaker does not necessarily have to be in the form of a traditional telephone handset but can be in the form of a headphone or earphone with an integrated microphone or as a separate loudspeaker and microphone independently connected to the user terminal .

Also connected to network is at least one other user of the system. For example illustrates User B operating a user terminal and connected to the network via a network interface . User terminal executes client software comprising similar functionality to client executed on the user terminal of User A and is connected to handset . Note that in practice there may be a very large number of users connected to the system but these are not illustrated in for clarity.

Within the Internet are illustrated an instant messaging network e.g. a first packet based network and a VoIP network e.g. a second packet based network. Both of these networks use the Internet as their communication infrastructure but they are conceptually separate. In this example embodiment the IM network is referred to as the main network and the VoIP network is referred to as the shadow network. Note that in this example the VoIP network is a P2P VoIP network. However in other embodiments non P2P VoIP networks could also be used. The use of an IM network and a VoIP network is merely an example and other types of communication network can be made interoperable by this scheme.

Connected to the IM main network is an IM server which provides the connections between users in IM conversations. In alternative embodiments the IM network can use a non centralised IM system such as a peer to peer system in which case the IM server is not required. Also connected to the IM network is a main network backend server .

Connected to the VoIP shadow network is a shadow network backend server . The main network backend server is connected to the shadow network backend server and these servers can communicate with each other using a server to server application programming interface API .

In the example shown in the IM network uses a centralised IM server to establish the connections between the users. The client of User A communicates with the IM server to determine the network address of the client of User B arrow . Once the network address of User B s client is known then a connection is set up between User A and User B as shown with arrow via the IM server . User A can type a message using terminal and this is transmitted to the terminal of User B where it can be read. Similarly User B can reply to the message and this reply is transmitted to User A s terminal .

Note that in some embodiments the functionality of the IM server and the main network backend server may be integrated into a single network element.

In the example shown in the main network offers a single communication type instant messaging although other types of communication can be offered. There may be a desire on the part of the providers of the IM network to extend the functionality of their system to offer further communication types such as VoIP that are not currently offered. This would then allow the users to initiate voice conversations with each other using the same single contact list that is used for the IM conversations. However the implementation of a reliable high quality VoIP client is very complex and may utilize substantial development of the existing client. These problems can be overcome by cooperation with an existing VoIP software provider as described below.

An existing separate VoIP network can be used to provide the voice communications to extend the functionality of the main network. Because the use of the separate network for voice calls is predominantly hidden from the users the VoIP network is known as a shadow network. In one or more embodiments the client software used to access the IM network is modified in order to allow it to access the shadow network and make voice calls and this can be achieved relatively easily as the software provider for the shadow network already has the software that is utilized to do this for use in their own standalone client.

It may be noted that the terminal and or the terminal may be using Internet browsers to connect with the shadow network and the main network . Therefore in one embodiment at least one of the client and the client may be a commercial Internet browser. In another embodiment at least one of the client and the client is a separately deployed dedicated client application for the respective network e.g. the main network and the shadow network .

In one embodiment if a client e.g. at least one of the client and the client is an Internet browser during the creation of a shadow user in the shadow network as described in the following paragraphs a determination is made to ascertain if the Internet browser based client is capable of communicating with the other network e.g. whether the client is capable of communicating with a user of the shadow network . If the Internet based client cannot on its own communicate with the other network a browser plugin can be automatically downloaded to the Internet based client. The plugin may be downloaded from at least one of a Web server coupled to the network of the Internet based client e.g. the main network the main network backend server and the shadow network backend server . It may be noted that the plugin may be selected based on the type of the Internet browser being used as the Internet based client. In one embodiment the plugin may not be a browser native plugin rather the plugin may be an executable native to the underlying operating system.

The IM engine layer comprises the functionality utilized to send and receive IM messages over the main network for example as described with reference to . The VoIP engine layer comprises the functionality utilized to make and receive VoIP voice calls over the shadow network. Typically the VoIP engine layer is provided to the operator of the IM network by the software provider of the shadow network.

Above the IM engine layer and the VoIP engine layer is a client user interface layer . In one or more embodiments the client user interface layer presents information to the user via a single user interface regardless of whether the main network via the IM engine or shadow network via the VoIP engine is being utilised. In particular in at least one embodiment a single list of contacts is provided to the user and communication with these contacts may be established using either the main or shadow networks.

Therefore the client structure shown in provides the user with the capability to connect to either the IM main network for instant messaging communication or to the VoIP shadow network for voice calls. However as the shadow network is an entirely separate network to the main network and not under the control of the provider of the client software the users of the main network are not registered with the shadow network. Therefore the shadow network has no knowledge of the users of the main network. The users of the main network are therefore unable to log into the shadow network.

Generally any of the functions described herein can be implemented using software firmware hardware e.g. fixed logic circuitry or a combination of these implementations. The terms module functionality layer and logic as used herein generally represent software firmware hardware or a combination thereof. In the case of a software implementation the module functionality layer or logic represents program code that performs specified tasks when executed on a processor e.g. CPU or CPUs . The program code can be stored in one or more computer readable memory devices. The features of the techniques described below are platform independent meaning that the techniques may be implemented on a variety of commercial computing platforms having a variety of processors.

The user terminal can include one or more computer readable media that may be configured to maintain instructions that cause the associated computing device and more particularly hardware of the computing device to perform operations. Thus the instructions function to configure the hardware to perform the operations and in this way result in transformation of the hardware to perform functions. The instructions may be provided by the computer readable medium to the computing device through a variety of different configurations.

One such configuration of a computer readable medium is signal bearing medium and thus is configured to transmit the instructions e.g. as a carrier wave to the hardware of the computing device such as via a network. The computer readable medium may also be configured as a computer readable storage medium and thus is not a signal bearing medium. Examples of a computer readable storage medium include a random access memory RAM read only memory ROM an optical disc flash memory hard disk memory and other memory devices that may use magnetic optical and other techniques to store instructions and other data.

Processors are not limited by the materials from which they are formed or the processing mechanisms employed therein. For example processors may be comprised of semiconductor s and or transistors e.g. electronic integrated circuits ICs . In such a context processor executable instructions may be electronically executable instructions. Alternatively the mechanisms of or for processors and thus of or for a computing device may include but are not limited to quantum computing optical computing mechanical computing e.g. using nanotechnology and so forth.

Continuing it is undesirable for the user to have to separately register with the shadow network and thereby provide another username and password in addition to the one used for the IM network. Furthermore it is also undesirable to prompt the user to log in i.e. enter a username and password twice once for the main network and once for the shadow network.

The process shown in and illustrates a combined authentication scheme which enables a user of the main network to be automatically registered on the shadow network such that the user is able to log into the main and shadow networks with a single username and password in accordance with one or more embodiments.

The process shown in is performed the first time the user logs into the main network using the modified client comprising the VoIP engine as shown in . Referring first to in step S User A enters his username and password for the main network into the client user interface displayed on his user terminal . In step S the username and password are transmitted to the main network backend server within an authentication request message. This is illustrated as arrow in .

The main network backend server processes the authentication request in order to validate the username and password. If the username and password are valid the main network backend server determines whether this user has been registered on the shadow network . As this is the first time User A has used the modified client User A has not been registered with the shadow network. Responsive to determining that User A has not been registered with the shadow network the main network backend server transmits a create user request message to the shadow network backend server in step S in shown as arrow in . The create user request message comprises the username of User A in the main network .

In another embodiment in order to prevent creation of shadow accounts in the shadow network for the users of the main network who may never use the shadow network for communication with other users the process of creating a shadow user in the shadow network is deferred until the user of the main network attempts to establish a communication with a user of the shadow network or the main network through the shadow network . Accordingly in this embodiment the create user request message is transmitted to the shadow network backend server only when User A sets up a call with another user.

Responsive to the create user request message to the shadow network backend server creates an account for User A on the shadow network. To do this a username for User A is created in the shadow network. In one or more embodiments the username to use would be the same as that used in the main network as this is already entered into the client by the user when logging into the main network. However as the shadow network is a pre existing network with a pre existing user base it cannot be guaranteed that this username is unique and has not already been taken by another user. Therefore a new username can be created by the shadow network backend server which is known to be unique but can be readily derived from the main network username. Creation of the new user name can occur through application of a predetermined rule examples of which are provided below.

In order to create the shadow username or identity in one or more embodiments the predetermined rule utilizes a sequence of characters e.g. a predefined token to pre pend to or otherwise concatenate with the main network username or identity. The sequence of characters contains at least one particular character or combination of characters which other users of the shadow network cannot use in usernames. For example if the username in the main network is usera123 then the shadow network username can be created as xyz usera123 . The sequence xyz contains a colon character which cannot be used by normal users of the shadow network. The letters xyz identify the operator of the main network. Therefore the shadow network can be sure that no pre existing users of the shadow network have a username starting xyz and because the username usera123 is known to be unique in the main network the combination xyz usera123 is also known to be unique in the shadow network.

In alternative embodiments different methods e.g. predetermined rules could be used for deriving the shadow username from the main network username. For example the sequence of characters could be appended to the username or inserted in a particular position within the username. The sequence of characters could also be as short as a single control character or longer. As a further alternative the predetermined rule can utilize a hash function to derive the shadow username or identity.

Once the shadow username has been created by the shadow network backend server it is stored for subsequent use on the shadow network and an acknowledgement is returned to the main network backend in step S of . An acknowledgement confirming successful log in is sent from the main network backend server to the client in step S arrow in . Note that the process of registering the shadow username on the shadow network is hidden from the user the user only needs to enter the username and password for the main network and the registration on the shadow network is performed automatically.

Note that if User A has previously logged into the main network with the modified client then a shadow username has already been created for User A and steps S and S are skipped.

Following the acknowledgement of a successful log in the client automatically attempts to log into the VoIP shadow network. The log in process to the VoIP network is handled by the VoIP engine within the client as illustrated in . In step S of the client sends a request to the VoIP engine to log in to the VoIP network.

If this is the first time that the client has logged into the VoIP network then steps S to S are performed in order to obtain a digital certificate to gain access to the VoIP network. Note that the use of digital certificates is typically required particularly for P2P VoIP networks. Other types of non P2P VoIP network can also be used that do not require digital certificates in which case these steps are replaced with a request for other user credentials such as a password.

In step S the VoIP engine sends a message to the client indicating that a digital certificate is required and the client forwards this message to the main network backend server in step S. The main network backend server requests the digital certificate from the shadow network backend server over the server to server API in step S. The digital certificate is provided to the main network backend server in step S passed onto the client in step S and provided to the VoIP engine in step S. The digital certificate is requested and provided via the main network because the shadow network trusts the main network to have authenticated the user to a sufficient extent. In other words the shadow network trusts the main network to have ensured that the user is entitled to be issued with the digital certificate.

Once the VoIP engine has been provided with the digital certificate it is able to log into the VoIP network. In particular the VoIP engine derives the user s shadow username as it is aware of the method or predetermined rule used to create the shadow username from the main username. The shadow username and a private key corresponding to the digital certificate are used to log into the shadow network. Note that for the example of a P2P VoIP network communication with a central server is not required. When the VoIP engine has successfully logged into the VoIP network then a confirmation message is sent to the client in step S and User A is notified in step S.

Once the process outlined in is complete then User A is connected to and is online on both the main and shadow networks. Therefore User A can make and receive IM messages i.e. communication events over the main network and make and receive VoIP calls i.e. communication events over the shadow network.

For example if User B is also connected to the shadow network then User A can call User B using VoIP. To call User B User A selects the contact for User B displayed in the contact list of the client . In order for the call to be established over the VoIP network the client must know the username of User B . The username of User B in the main network is known to User A as User B is listed in User A s contact list. The client also knows the method or predetermined rule by which the username in the shadow network is derived. For example if the client has the main network username of userb987 stored for User B then the client pre pends or otherwise concatenates the sequence xyz to this username to form the shadow username for User B of xyz userb987 . The client can then use the shadow username to establish a call with the client of User B as illustrated by arrow in .

Therefore the client is able to construct the shadow username for any of the contacts for which the main network username is also known. Similarly another user of the system such as User B can construct the shadow username of User A and place a call to User A using this shadow username.

The above described system and method therefore enables a shadow network to be combined with a main network to supplement the services offered by the main network. In one or more embodiments the user of the main network does not need to be aware of the shadow network being present and is not required to take any action in order to utilise the services of the shadow network. In one or more embodiments the registration and authentication process is performed automatically. The user also does not need to change any aspect of his contact list in order to use the shadow network to communicate with his contacts as the usernames of the contacts registered with the shadow network are derivable from the username of the main network.

An issue that can arise from the use of separate main and shadow networks is a disparity in the levels of security between the two networks. For example if the main network is an IM network then it does not offer any paid services for which the users have to pay money. The levels of security in this network can therefore be quite low as there is no financial information. On the other hand a VoIP network which can be the shadow network might offer paid services. For example the users may need to pay for calls made to the public switched telephone network PSTN or to receive calls from the PSTN.

As the levels of security in the main network may be quite low it could be possible for a malicious third party to obtain the username and password of the user in the main network. This would therefore enable them to log into both the main and shadow networks as described above. This can be a problem as it would allow the malicious third party to gain access to the user s account in the shadow network which as mentioned above can involve paid services.

To address the security issue in one or more embodiments the user is prompted to set up a separate username and password to access their account information in the shadow network. The process for achieving this is described below with reference to . The account information for the user is viewed in an internet browser executed on the user terminal of the user and the account information itself is held on a server called a webstore connected to the VoIP network .

The process described in is performed the first time that the user accesses his account using the modified client. In step S User A requests to view his account information from the webstore by selecting on option displayed in the client . In step S the client generates a unique data sequence. The unique data sequence is used to verify the user for this initial session accessing the webstore . In one or more embodiments the data sequence comprises at least some of the following information the digital certificate the shadow username the current time the name of the main network and a random number. The client also generates a digital signature from this information for inclusion in the data sequence.

In step S the client passes the data sequence and the uniform resource locator URL of the webstore to the web browser . In step S the web browser navigates to the URL of the webstore and passes the webstore the data sequence. In step S the webstore forwards the data sequence to the shadow network backend for verification in step S.

The verification of the data sequence comprises the shadow network backend verifying the digital signature validating the digital certificate and shadow username of the user and checking that an identical data sequence has never been used before. The shadow network backend also stores the data sequence so that it may be compared with future data sequences received to prevent it being re used. A further verification performed includes checking that the time stored in the data sequence is within a predetermined range of the current time i.e. that the data sequence is not too old.

If all of the above verifications are successful then an ok message is sent to the webstore in step S. In response to this the webstore returns a webpage to the web browser in step S. The webpage is displayed to User A in step S and comprises fields for the user to set up a username and password that can be used to access the webstore . Once the user has selected a username and password the information in the webstore can be displayed to the user. The webstore stores the username and password selected and all subsequent access to the webstore require this username and password to be entered.

Although the subject matter has been described in language specific to structural features and or methodological acts it is to be understood that the subject matter defined in the appended claims is not necessarily limited to the specific features or acts described above. Rather the specific features and acts described above are disclosed as example forms of implementing the claims.

For example instead of the main network being an IM network and the shadow network being a VoIP network the opposite scenario could apply. Similarly a network providing video calls could be used as either the main or shadow network. Furthermore two similar but separate networks can be made interoperable using the above described technique. For example two separate IM networks each with different sets of users can interoperate using this technique to allow the sets of users to communicate with each other. In fact the above described scheme can be used to supplement any packet based communication network through the addition of a suitable complimentary shadow network linked by the use of automatically created shadow accounts.

