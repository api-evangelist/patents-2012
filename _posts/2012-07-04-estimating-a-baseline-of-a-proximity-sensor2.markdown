---

title: Estimating a baseline of a proximity sensor
abstract: Described are methods and systems for estimating a baseline of a proximity sensor on an electronic device comprising: collecting proximity sensor data at the electronic device using the proximity sensor; collecting second data using a second source at the electronic device; obtaining a sample of the proximity sensor data at the electronic device when it is determined that no object is proximal to a first face of the electronic device based on the proximity sensor data and based on the second data; and approximating the baseline of the proximity sensor using the obtained sample.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09632179&OS=09632179&RS=09632179
owner: BlackBerry Limited
number: 09632179
owner_city: Waterloo, Ontario
owner_country: CA
publication_date: 20120704
---
The present matter relates to electronic devices and in particular to systems and methods for estimating the signal baseline of a proximity sensor associated with an electronic device.

Electronic devices are commonly used to receive data through various input interfaces or input devices such as microphones touchscreen displays keyboards trackballs etc. Proximity sensors on electronic devices can gather proximity data to use as a parameter in a determination of the type of input interface or input device to employ to receive data. Proximity sensors commonly have an at rest no object present level a baseline which is used to analyze the gathered proximity data.

In accordance with an aspect the present disclosure describes a method of estimating a baseline of a proximity sensor on an electronic device the method comprising collecting proximity sensor data at the electronic device using the proximity sensor determining that no object is proximal to a first face of the electronic device based on the proximity sensor data collecting second data using a second source at the electronic device determining that no object is proximal to the first face of the electronic device based on the second data obtaining a sample of the proximity sensor data at the electronic device when it is determined that no object is proximal to the first face of the electronic device based on the proximity sensor data and based on the second data and approximating the baseline of the proximity sensor using the obtained sample.

In accordance with another aspect the present disclosure describes an electronic communication device comprising a memory a proximity sensor coupled to the memory for collecting proximity sensor data a second source coupled to the memory for collecting second data a processor coupled to the memory to execute instructions to configure the processor to collect proximity sensor data at the electronic device using the proximity sensor determine that no object is proximal to a first face of the electronic device based on the proximity sensor data collect second data using a second source at the electronic device determine that no object is proximal to the first face of the electronic device based on the second data obtain a sample of the proximity sensor data at the electronic device when it is determined that no object is proximal to the first face of the electronic device based on the proximity sensor data and based on the second data and approximate the baseline of the proximity sensor using the obtained sample.

In accordance with another aspect the present disclosure describes a computer readable storage medium comprising computer executable instructions which when executed cause a processor to collect proximity sensor data at the electronic device using a proximity sensor determine that no object is proximal to a first face of the electronic device based on the proximity sensor data collect second data using a second source at the electronic device determine that no object is proximal to the first face of the electronic device based on the second data obtain a sample of the proximity sensor data at the electronic device when it is determined that no object is proximal to the first face of the electronic device based on the proximity sensor data and based on the second data and approximate the baseline of the proximity sensor using the obtained sample.

For convenience like numerals in the description refer to like structures in the drawings. Referring to a typical telecommunication infrastructure is illustrated generally by numeral . The telecommunication infrastructure includes one or more electronic devices one or more base stations a communication network a plurality of network servers and a plurality of databases .

The electronic devices include wireless computing devices such as smart phones personal digital assistants PDAs tablet computers and the like. The electronic devices are in communication with one of the base stations . The base stations relay data between the electronic devices and the network servers via the communication network . Accordingly the communication network can include several components such as a wireless network a relay a corporate server and or a mobile data server for relaying data between the base stations and the network servers . The network servers can be in communication with one or more databases on which data can be stored. The network servers can also include servers such as a Web server an application server and an application server with web services.

It will be appreciated by a person of ordinary skill in the art that the telecommunication infrastructure described herein is exemplary and that changes may be made to one or more components to accommodate different network configurations without affecting the scope of the aspects described herein.

Referring to an example electronic device is illustrated in greater detail. The electronic device can be a two way electronic device having both voice and data communication capabilities including the capability to communicate with other computer systems. Depending on the functionality provided by the electronic device it may be referred to as a data messaging device a two way pager a cellular telephone with data messaging capabilities a wireless Internet appliance a smartphone a tablet computer or a communication device for example.

The electronic device includes a processor which controls general operation of the electronic device . The processor can interact with additional device subsystems such as a display a flash memory a random access memory RAM a read only memory ROM auxiliary input output I O subsystems such as a keyboard or trackball for example a data port a speaker a microphone a short range communication module such as Bluetooth for example a proximity sensor an orientation sensor an ambient light sensor and any other device subsystems or peripheral devices generally designated at . The processor interacts with other device subsystems such as a wireless communication subsystem for exchanging radio frequency signals with a base station and or a communication network not shown in to perform communication functions. Some of the subsystems shown in perform communication related functions whereas other subsystems may provide resident on device functions.

The electronic device includes a communication subsystem which includes a receiver a transmitter and associated components such as one or more embedded or internal antenna elements and local oscillators LOs and a processing module such as a digital signal processor DSP . As will be apparent to those skilled in field of communications the particular design of the communication subsystem depends on the communication network in which the electronic device is intended to operate.

Operating system software used by the processor may be stored in a persistent store such as the flash memory which may be a ROM a ROM or similar storage element not shown . The operating system specific device applications or parts thereof may be temporarily loaded into a volatile store such as RAM .

The processor in addition to its operating system functions enables execution of software applications on the electronic device . A predetermined set of applications which control basic device operations is installed on the electronic device during its manufacture. These basic operations typically include data and voice communication applications for example. Additionally applications may also be loaded onto the electronic device through the network an auxiliary I O subsystem data port short range communication module or any other suitable subsystem and installed by a user in RAM ROM or flash memory for execution by the processor . Such flexibility in application installation increases the functionality of the electronic device and may provide enhanced on device features communication related features or both.

The short range communication module provides for communication between the electronic device and different systems or devices which need not be similar devices. For example the short range communication module may include an infrared device and associated circuits and components or a wireless bus protocol compliant communication mechanism such as a Bluetooth communication module to provide for communication with similarly enabled systems and devices.

The proximity sensor can include an infrared light source a sensor that receives infrared light and associated circuits and components. The proximity sensor is associated with the processor so that the processor can evaluate the received or measured infrared light. Infrared light can be emitted from the infrared light source and can then reflected off of objects proximal to the proximity sensor and the intensity of the reflected infrared light can then be received by the sensor. It is understood that there may be objects external to the device that reflect the emitted infrared light. In one or more embodiments emitted infrared light causes some amount of reflection off of internal components of the electronic device regardless of whether there are external objects proximal to the proximity sensor . Thus in one or more embodiments the proximity sensor will always measure some amount of light intensity or extraneous signal. The amount of light intensity or other measurement that the proximity sensor measures when no object external to the electronic device is proximal to the proximity sensor can be called the baseline measurement. The baseline may also include a level of noise measurement electrical biases and or the measurement of light that scattered through optical systems associated with the electronic device and reflected back. In an exemplary embodiment the proximity sensor takes into account the baseline measurement when evaluating infrared light sensor readings in order to determine or estimate that an external object is proximal to the proximity sensor and thus proximal to the first face of the electronic device .

The proximity sensor may also be associated with a timer for measuring the time between emitting the infrared light and receiving a reflection of the infrared light. For example the time between emitting the infrared light and receiving the reflection can be used to estimate the proximity of an object to the electronic device .

The orientation sensor can include a gyroscope and or accelerometer associated with the electronic device . The orientation sensor can measure the orientation of the electronic device relative to the ground. In one or more embodiments the orientation sensor measures the acceleration and the angle of the electronic device relative to the ground. The measurements taken by the orientation sensor can be stored in memory . The orientation sensor can operate in response to instructions from the processor and or from instructions through an input interface. It is understood that there can be more than one orientation sensor associated with the electronic device .

The display is used to visually present an application s graphical user interface GUI to the user. The user can manipulate application data by modifying information on the GUI using an auxiliary input output device such as a keyboard for example. Depending on the type of electronic device the user may have access to other types of input devices such as for example a scroll wheel trackball light pen or touch sensitive screen.

The electronic device may include a touchscreen display in some example embodiments. The touchscreen display may be constructed using a touch sensitive input surface connected to an electronic controller. The touch sensitive input surface overlays the display and may be referred to as a touch sensitive overlay. The touch sensitive overlay and the electronic controller provide a touch sensitive input interface and the processor interacts with the touch sensitive overlay via the electronic controller. That is the touchscreen display acts as both an input interface and an output interface.

In some example embodiments the auxiliary input output I O subsystems may include an external communication link or interface for example an Ethernet connection. The electronic device may include other wireless communication interfaces for communicating with other types of wireless networks for example a wireless network such as an orthogonal frequency division multiplexed OFDM network.

In some example embodiments the electronic device also includes a removable memory module typically including flash memory and a memory module interface . Network access may be associated with a subscriber or user of the electronic device via the memory module which may be a Subscriber Identity Module SIM card for use in a GSM network or other type of memory module for use in the relevant wireless network type. The memory module may be inserted in or connected to the memory module interface of the electronic device .

The electronic device may store data in an erasable persistent memory which in one example embodiment is the flash memory . In various example embodiments the data may include service data having information used by the electronic device to establish and maintain communication with the communication network . The data may also include user application data such as email messages address book and contact information calendar and schedule information notepad documents images and other commonly stored user information stored on the electronic device by its user and other data.

In some example embodiments the electronic device is provided with a service routing application programming interface API which provides an application with the ability to route traffic through a serial data e.g. USB or Bluetooth Bluetooth is a registered trademark of Bluetooth SIG Inc. connection to the host computer system using standard connectivity protocols. When a user connects their electronic device to the host computer system via a USB cable or Bluetooth connection traffic that was destined for the communication network is automatically routed to the electronic device using the USB cable or Bluetooth connection. Similarly any traffic destined for the communication network is automatically sent over the USB cable Bluetooth connection to the host computer for processing.

The electronic device also includes or is connected to a power source such as a battery which may be one or more rechargeable batteries that may be charged for example through charging circuitry coupled to a battery interface such as the serial data port . The battery provides electrical power to at least some of the electrical circuitry in the electronic device and the battery interface provides a mechanical and electrical connection for the battery . The battery interface is coupled to a regulator not shown which provides power V to the circuitry of the electronic device .

A predetermined set of applications that control basic device operations including data and possibly voice communication applications may be installed on the electronic device during or after manufacture. Additional applications and or upgrades to an operating system or software applications may also be loaded onto the electronic device through the communication network the auxiliary I O subsystem the data port the short range communication module or other suitable device subsystems . The downloaded programs or code modules may be permanently installed for example written into the program memory e.g. the flash memory or written into and executed from the RAM for execution by the processor at runtime.

In some example embodiments the electronic device may provide two principal modes of communication a data communication mode and a voice communication mode. In the data communication mode a received data signal such as a text message an email message or webpage download will be processed by the communication subsystem and input to the processor for further processing. For example a downloaded webpage may be further processed by a web browser or an email message may be processed by the email messaging application and output to the display . A user of the electronic device may also compose data items such as email messages for example using an input interface in conjunction with the display . These composed items may be transmitted through the communication subsystem over the communication network .

In the voice communication mode the electronic device provides telephony functions and may operate as a typical cellular phone. The overall operation is similar to the data communication mode except that the received signals would be output to the speaker and signals for transmission would be generated by a transducer such as the microphone . The telephony functions are provided by a combination of software firmware i.e. a voice communication module and hardware i.e. the microphone the speaker and input devices . Alternative voice or audio I O subsystems such as a voice message recording subsystem may also be implemented on the electronic device . Although voice or audio signal output may be accomplished primarily through the speaker the display may also be used to provide an indication of the identity of a calling party duration of a voice call or other voice call related information.

The processor operates under stored program control and executes software modules such as applications stored in memory such as persistent memory for example in the flash memory . As illustrated in the software modules may include operating system software and one or more additional applications or modules. The processor may also operate to process data stored in memory associated with the electronic device .

An exemplary electronic device with a proximity sensor is shown in . The electronic device has a first face with a touchscreen display an activation button a microphone a speaker and a proximity sensor . It is recognized that other components that are not shown can be associated with or attached to the electronic device . The touchscreen display can be the display illustrated in coupled with a touch sensitive overlay.

The microphone is configured to receive audio input and the speaker is configured to output audio signals. Each of the microphone and speaker are associated with the processor such that the audio input to the microphone can be transmitted across a communication network to a second electronic device and such that audio signals received from the second electronic device can be output from or at the speaker .

When the electronic device is connected to the second electronic device to transmit and receive audio signals e.g. during a phone conversion the electronic device can be adjacent to a person s head so that the speaker is proximal to the ear and so that the microphone is proximal to the mouth. When the electronic device is adjacent to a person s head the risk of accidental input on the touchscreen display or other input interface can be increased. For example during a phone conversation the person s face may touch the touchscreen display causing unwanted or accidental input.

In accordance with an exemplary embodiment the electronic device can be stored in a bag or pocket or other enclosed area. When being stored the touchscreen display risks receiving accidental or unwanted input. For example the inside of the bag or other objects contained in the bag can touch the touchscreen display causing the accidental or unwanted input.

To help avoid the accidental input on the touchscreen display or other tactile input interface such as a keyboard of the electronic device the touchscreen display can be temporarily shut off or temporarily deactivated. When temporarily shut off the touchscreen display or other tactile input interface does not process or read touch input. For example when the touchscreen display is temporarily shut off a touch on the touchscreen display is not processed and thus does not cause any action or processing at the electronic device . In accordance with an embodiment the touchscreen display is shut off in circumstances when accidental input is likely and when the touchscreen display is not otherwise in use. For example the touchscreen display can be shut off or deactivated for the duration of time that accidental input is likely to occur such as when an object is proximal the first face of the electronic device .

In accordance with one or more embodiments the proximity sensor can be used to detect whether an object is proximal to the first face of the electronic device on which the touchscreen display resides. In accordance with the illustrated embodiment the proximity sensor is facing the same direction as the first face so that the proximity sensor detects or measures the proximity of objects to the first face . For example the proximity sensor can gather data regarding the proximity of nearby objects and this data can be used to estimate the distance that an object is from the first face .

At data is collected using the proximity sensor at the electronic device . The collected data can include the intensity of the infrared light received at the proximity sensor . The received infrared light can result from infrared light emanating from the proximity sensor or infrared light emitter and reflecting off of one or more objects proximal the proximity sensor . In a further example the collected data can include the elapsed time before detection of reflection or a measurement of the intensity of reflected light for example. For example the elapsed time can be a measurement of the amount of time that has lapsed between the emission of the infrared light from the proximity sensor or the associated infrared light emitter and the reception of the reflected infrared light at the proximity sensor . The processor can store the data collected by the proximity sensor in memory .

At the distance of the object is estimated using the data collected by the proximity sensor . For example the processor can use the measured intensity of infrared light received at the proximity sensor to estimate or calculate the distance that the objects is from the first face . By way of further example the collected data may indicate the amount of time elapsed between the emission of the infrared signal or light and the reception of the reflected infrared light. An estimation of the distance that the object is from the first face of the electronic device can be calculated using this amount of elapsed time. It is understood that the proximity sensor can operate using other processes for measuring the proximity of the object based on the emission or reception of infrared light.

At the calculated distance of the object is compared to a threshold level. For example the threshold can be a numerical value stored in memory of the electronic device and the processor can compare the threshold to the calculated distance. If the calculated distance is smaller than the threshold level the object is considered to be closer to the first face of the electronic device than the threshold level.

If the calculated distance of the object is closer to the first face than the threshold level then the touchscreen display is temporarily shut off at . In accordance with one or more embodiments only the touchscreen or input feature of the touchscreen display is deactivated while the output of the touchscreen display remains operational. The method may then proceed to collect proximity data again at . For example the electronic device may wait a predetermined amount of time before proceeding to collect proximity data.

If the calculated distance of the object is not closer than the threshold distance i.e. the calculated distance value is greater than the threshold level then the method proceeds to collect proximity data again at without shutting off or deactivating the touchscreen. For example the electronic device may wait a predetermined amount of time before proceeding to collect proximity data.

In accordance with an embodiment the threshold level is a value that is dependent on a baseline value associated with a state in which it is estimated that no object is proximate to the first face . For example each of the threshold level and baseline value can be stored in memory on the electronic device and can represent distances e.g. distances from the first face . The threshold level can be an offset above or below the baseline value.

An initial baseline can be set in the electronic device during its manufacture. For example the initial baseline value can be stored into memory during the manufacturing process.

The baseline can be calculated or updated using data retrieved by the proximity sensor . For example the proximity sensor can measure the signal of any reflected infrared light when no object is proximal the first face of the electronic device which can in turn be used to calculate the baseline value.

The baseline can be calculated reset or re established periodically. For example after a predetermined amount of time has elapsed since the previous baseline calculation proximity data is collected and a new baseline value is calculated.

One or more environmental factors can alter the measured proximity data and thus the baseline value. For example proximity data and hence the calculated baseline value can vary depending on the temperature of the electronic device the ambient light conditions in and around the electronic device and or the battery voltage.

At the proximity sensor data is collected at the electronic device using the proximity sensor . For example infrared light is emitted from the electronic device and the reflections of the infrared light off of an object for example are measured at the proximity sensor . In accordance with an exemplary embodiment the time that elapses between the infrared emission and the receipt of the reflection is measured and stored in memory . In accordance with an exemplary embodiment the proximity sensor can measure the intensity of the infrared light reflection received at the electronic device and using this measured intensity can estimate the proximity of an object to the first face . In other words the proximity sensor data may be the intensity of infrared light received at the proximity sensor .

At a determination is made as to whether the proximity sensor data indicates that no object is proximal to the proximity sensor . For example the proximity sensor can detect the proximity of objects to the first face of the electronic device . In an exemplary embodiment the processor uses the threshold level stored in memory on the electronic device in order to evaluate whether an object is proximal to the first face by determining whether the data gathered by the proximity sensor indicates that an object is closer to the first face than the threshold level. In a further example the processor may use a threshold level in order to evaluate whether an object is proximal to the first face by determining that the measured intensity of the infrared light received at the proximity sensor e.g. the reflection amplitude is higher than the threshold level.

By way of further example the data collected at the proximity sensor can be used to calculate a distance measurement of the distance away from the proximity sensor that an object is located. The calculation can be based on proximity sensor data including reflected infrared light received at the electronic device . In one or more embodiments the processor can take the raw infrared light reflection data e.g. the intensity or the time since the infrared light or signal was sent from the electronic device as input and use it to calculate an estimated distance of the object away from the proximity sensor e.g. on the first face . Such calculations can be performed using an existing baseline value which can normalize the proximity sensor data readings. By way of further example the threshold level s can be an offset from the baseline value or baseline measurement. The existing baseline value can be stored in memory . In one or more further embodiments the proximity sensor data is not used to calculate a distance of an object from the proximity sensor but is instead used to measure the intensity of infrared light reflected off of the object. For example if the measured intensity is less than a threshold level then it is determined that there is no object proximal to the first face .

The proximity sensor may be directed out of the first face as shown in . In other words the infrared light may be emanating from the first face in order to reflect off of objects within a distance of X from the first face of the electronic device . In one or more other embodiments there may be one or more proximity sensors at one or more other locations on the electronic device . In accordance with an exemplary embodiment the first face is the face of the electronic device on which the display is located. Similarly the first face is where the microphone and or speaker can be located. Therefore when the electronic device is being used as a phone the first face is proximal to the person who is talking on the phone. Similarly when the electronic device is being used as a phone the proximity sensor is configured to detect that a person is proximal to the first face of the electronic device .

If it is determined that an object is possibly or likely proximal to the first face or the proximity sensor based on the proximity sensor data then the proximity sensor data is again collected using the proximity sensor at . There may be a time lag before proximity sensor data is again collected.

If it is determined that no object is likely proximal to the first face based on the proximity sensor data second data is collected using a second source at the electronic device at . The second source can be attached to the electronic device or can be in communication with the electronic device . The second data can be received by the second source and stored in the memory of the electronic device for example.

In accordance with an exemplary embodiment collecting second data using a second source at the electronic device can include determining the orientation of the electronic device using the orientation sensor . In other words the second source can be the orientation sensor and the second data can be the orientation of the electronic device . For example the orientation of the electronic device can include the angle of the electronic device relative to the ground as measured by the orientation sensor . By way of further example the orientation of the electronic device can include the acceleration of the electronic device relative to the ground as measured by the orientation sensor .

In accordance with an exemplary embodiment collecting second data using a second source at the electronic device includes evaluating whether one of the proximity sensor data or the proximity sensor are being accessed by a component associated with the electronic device . A component can include an application or process running or executing on the electronic device or an application that is accessing the proximity sensor data or proximity sensor from a remote location e.g. through a network . By way of example the operating system may be accessing proximity sensor data to determine whether a finger is covering optical apertures associated with the light sensor and proximity sensor when the electronic device is being held. The evaluation can be performed by the processor . For example the processor can determine whether data obtained by the proximity sensor is being processed on behalf of or used by an application operating on the electronic device . By way of further example the processor can determine that the proximity sensor is in use by one or more applications or processes.

In accordance with an exemplary embodiment collecting second data using a second source at the electronic device includes collecting ambient light readings using a light sensor at the electronic device . The light sensor may be located at the first face of the electronic device for example. The light sensor can measure the amount or intensity of the light that it receives e.g. at the first face where it may be located . The measurements taken by the light sensor can be stored in memory on the electronic device . In one or more embodiments the proximity sensor may also operate as the ambient light sensor or as a light sensor .

It is understood that collecting second data using a second source at the electronic device can include collecting second data from multiple second sources. It is understood that there are other second sources that the electronic device can use to collect data such as other input output components and other sensors.

At a determination is made as to whether the second data indicates that no object is proximal to the first face . For example the second data collected by the second source can be compared to reference data stored in memory . The reference data can be previously collected data that is consistent with a state of the electronic device in which no object is proximal to the first face . By way of further example one or more runtime heuristics can be used in association with the second data to determine or estimate that no object is proximal the first face . The runtime heuristics can be a combination of second data from one or more second sources.

In accordance with an exemplary embodiment determining whether no object is proximal to the first face of the electronic device based on the second data includes determining whether the orientation of the electronic device is within a predetermined range of orientations. For example the memory associated with the electronic device can store predefined orientation data including a range of orientations of the electronic device that are consistent with a state of the electronic device in which there is no object proximal to the first face . By way of further example the electronic device can access orientation data including a range of orientations from a remote source e.g. across a communications network . After the orientation sensor has measured the orientation of the electronic device the measurement is compared e.g. by operation of the processor to the range of stored orientations. If the measurement of the orientation is within the predetermined range of orientations then the electronic device is considered to be in use whereby an object is potentially proximal the first face of the electronic device .

In accordance with an exemplary embodiment determining whether no object is proximal to the first face of the electronic device based on the second data includes determining whether any components associated with the electronic device are accessing one of the proximity sensor data or the proximity sensor . For example after the processor has evaluated that no applications are accessing the proximity sensor or the proximity sensor data either from the electronic device or remotely it determines that no object is likely proximal to the first face .

In accordance with an exemplary embodiment determining whether no object is proximal to the first face of the electronic device based on the second data includes determining whether the ambient light readings are consistent with predetermined conditions indicating that an object is or is not proximal to the first face . Predetermined conditions can be stored in memory . For example the predetermined conditions may have been set or stored in memory when the electronic device was manufactured. By way of further example the predetermined conditions can be entered or stored into memory through one or more input interfaces or input devices. The predetermined conditions can include one or more of light intensity or temperature values for example. The predetermined conditions can be a range of settings or a range of conditions. For example the predetermined conditions can be a range of ambient light readings e.g. a range of light intensity or a range of temperatures consistent with the electronic device not being in use. The ambient light readings can be measurements gathered at the ambient light sensor . For example the ambient light readings can be light intensity measurements. It is understood that the ambient light sensor is an example of a light sensor that can be used to measure ambient light or other light .

The processor can compare the ambient light readings with the predetermined conditions stored in memory . If the ambient light readings are consistent with one or more predetermined conditions the processor determines that an object is not proximal to the first face of the electronic device . The predetermined conditions are consistent with the conditions that exist when the electronic device is not in use.

The ambient light readings can be measured or taken periodically at predetermined time intervals or can be triggered by an event. For example the ambient light readings can be measured when the electronic device is moved from an at rest state.

It is understood that the described methods could operate such that the predetermined conditions are consistent with the conditions that exist when the electronic device is in use. In such embodiments when the second data is consistent with the predetermined conditions the processor determines that no object is proximal to the first face .

If it is determined that an object is possibly or likely proximal to the first face the proximity sensor data is collected again using the proximity sensor at . It is understood that there may be a time lag before collecting proximity sensor data again.

If it is determined that no object is likely proximal to the first face a sample of the proximity sensor data is obtained at the electronic device at . Obtaining a sample of the proximity sensor data at the electronic device is performed when it is determined that no object is likely to be proximal to the first face of the electronic device . For example the determination that no object is proximal to the first face of the electronic device can be based on the proximity sensor data and based on the second data. In accordance with an exemplary embodiment the sample of proximity sensor data is obtained by gathering at least one burst of a predetermined number of proximity sensor readings and a predetermined number of ambient light readings and validating the proximity sensor readings based on the ambient light readings. For example during each burst of the predetermined number of proximity sensor readings the ambient light sensor also measures the ambient light.

In accordance with another embodiment obtaining a sample of the proximity sensor data at at the electronic device further includes obtaining a predetermined number of valid bursts of proximity sensor readings and obtaining a predetermined number of ambient light readings and wherein approximating the baseline using the obtained samples includes calculating an estimate of the baseline based on the proximity sensor readings and the ambient light readings.

In one or more embodiments the obtaining a sample of the proximity sensor data at at the electronic device is only performed if it the display is turned on or illuminated e.g. by a backlight .

At the baseline of the proximity sensor is approximated using the obtained sample. In accordance with one or more exemplary embodiments approximating the baseline of the proximity sensor using the obtained sample includes averaging weighted samples of the bursts of proximity sensor readings. It is understood that the proximity sensor readings could first be validated such as by using concurrent ambient light readings. By way of further example the samples of the valid bursts of proximity sensor readings are weighted based on the ambient light readings. For example the valid bursts of proximity sensor readings can be weighted using the concurrent ambient light reading for each burst.

It is understood that collecting second data at determining whether no object is proximal based on the second data at and obtaining a sample of the proximity sensor data can be performed simultaneously. For example the proximity sensor can include the ambient light sensor and when the second data is the ambient light readings then the second data may be collected at the same time that the samples of the proximity sensor data are obtained and that the determination at based on the second data is made. By way of further example the determination of whether the proximity sensor data indicates that no object is proximal to the proximity sensor at and the determination of whether the second data indicates that no object is proximal to the first face at can be performed simultaneously in or the opposite order as described above. For example the second data can be collected before the proximity sensor data is collected such that the proximity sensor data will be collected after it is determined that no object is proximal to the first face based on the second data and such that the sample of the proximity sensor data will be obtained after it is determined that the proximity sensor data indicates that no object is proximal to the proximity sensor .

With reference to an exemplary method for obtaining a sample of the proximity sensor data at and of approximating the baseline at in accordance with one or more embodiment is depicted at .

A timeline is illustrated with two proximity sensor baseline estimation sampling periods and an at rest time period in between. During each sampling period a set of proximity sensor data bursts are gathered. The proximity sensor data bursts in a sampling period can be separated by a predetermined length of time or inter burst delay . The at rest time period can be the time period during which it is determined that an object is proximal to the electronic device . For example during the at rest time period either the proximity sensor data or the second data may indicate that an object is likely proximal to the electronic device .

A timeline shows two sequential data bursts in more detail separated by an inter burst delay . Each data burst is made up of four proximity samples . Each proximity sample can be an infrared light emission and reflection reading for example. The vertical height of the proximity samples may represent the intensity of each proximity sample received at the proximity sensor . For example the height of the proximity samples can be the intensity of the light measured at the proximity sensor during and or after an infrared light is emitted from the proximity sensor . The measured intensity level can be from emitted infrared light that is reflected off of nearby objects for example. It is understood that there can be fewer or more than four proximity samples in each data burst . The inter burst delay can be a predetermined length of time. For example the length of the inter burst delay can be preprogrammed into memory during manufacture of the electronic device or it can be input through an input interface during use of the electronic device . In certain embodiments the inter burst delay can vary based on the second data. For example certain second data such as certain ambient light readings may be associated in memory with a certain e.g. predefined inter burst delay .

The number of data bursts in a set of data bursts can be predefined and or can depend on the number of valid proximity sensor readings that are obtained within the sampling period . Alternatively the sampling period can depend on the number of obtained data bursts . For example there can be three data bursts in each sampling period with each data burst containing four valid proximity sensor readings . Each valid proximity sensor reading can be a value such as a light intensity value or a time value associated with the time elapsed between the light emission and the receipt of the reflected light. In the illustrated embodiment the intensity level of the proximity sensor readings e.g. the intensity level measured at the proximity sensor after or during the emission of infrared light and of the data bursts is shown on the y axis. The intensity of the data bursts can be the average intensity of the proximity sensor readings obtained during the sampling period or can be the average of the valid samples obtained during the time period for example. In one or more embodiments certain conditions are used to validate the proximity sensor readings or readings such as absolute value of the light intensity measurements of the samples and the difference between the maximum and minimum of the proximity sensor readings within a single data burst . For example there may be a predetermined threshold value that the conditions are compared to so as to exclude proximity sensor readings taken under certain conditions that fall within the threshold value for example or there may be dynamic heuristics used to exclude proximity sensor readings taken under certain conditions. In one or more embodiments ambient light readings can be measured simultaneously with each proximity sensor reading or with each proximity sensor data burst . The difference between the maximum and minimum of the ambient light samples within a single proximity sensor data burst can be used to validate the proximity sensor readings .

In accordance with one or more embodiments the set of data bursts including the proximity sensor readings obtained during a sampling period are the samples obtained of the proximity sensor data identified at in . Approximating the baseline at using the obtained samples can be a calculation or a separate method that can be carried out e.g. by the processor using the samples obtained during the most recent sampling period . In one or more embodiments approximating the baseline at using the obtained samples can be a calculation or separate method that is carried out using the samples obtained during all of the data bursts that occurred since the time that the previous approximation of the baseline was calculated. Approximating the baseline can be a calculation that is carried out during the at rest time period or shortly after the sampling period . The timing of the calculation of the approximation of the baseline can be any suitable value. The approximation can be calculated using the whole set of proximity sensor readings during the sampling period . In a further example the approximation calculation may be performed on proximity sensor readings in one or more sampling periods . In a further example one or more computing metrics can be performed on a data burst to reduce or represent the proximity sensor readings in the data burst as one or more values that can then be used in the approximation calculation . In such an example the approximation can be performed on the one or more value provided in one or more data bursts . Thus the data that can be used to perform the approximation calculation can include one or more data bursts or one or more proximity sensor readings

In accordance with one or more exemplary embodiments after a number M of data bursts have completed an approximation method is run or executed by the processor to estimate the baseline of the proximity sensor based on the M data bursts .

In accordance with one or more embodiments a predefined number of data bursts are taken with a predefined at rest time period between each data burst when obtaining a sample of the proximity sensor data at . Alternatively there is one data burst taken with a predefined number of proximity sensor readings when obtaining a sample of the proximity sensor data at . In the latter embodiment s the at rest time period can be a period when either the proximity sensor or the second source provides data indicating that there is an object proximal to the first face . The at rest time period can also be a period when the proximity sensor is in use by another application or component for example.

Each proximity sensor data burst has a proximity metric p derived from the maximum value in a burst B. It is understood that other forms of minimum maximum average or other filters on the proximity sensor data from a burst B could yield a suitable metric p. It is also understood that other types of filters that reduce the risk of underestimating the value of the baseline can be used. In the illustrated embodiment the proximity metric is a measurement of the intensity of infrared light or infrared signal measured at the proximity sensor .

A weighting function W p L derives a weight for the proximity metric p based on an ambient light metric L. The ambient light metric L can be based on average light intensity measured by the ambient light sensor during the sampling of the data burst by the proximity sensor . It is understood that some ambient light conditions are more likely to be present in states when the electronic device is idle or when it is determined that no object is proximal the first face . The weighting function can be tuned to compensate for effects of ambient light on proximity sensor readings. For example an effect is that ambient light conditions can bias the value of the proximity sensor readings . It is understood that the proximity sensor can gather ambient light readings i.e. light readings not from reflected infrared light simultaneously or concurrently with the proximity sensor readings or data bursts . In one or more embodiments an ambient light sensor can be used to gather the ambient light readings.

Each of the proximity metric p the weighting function W p L and any other parameters or values used in the approximation method can be stored in memory .

In accordance with one or more embodiments the baseline estimate for a set of M bursts can be determined by the following equation 

In an exemplary embodiment there are 3 valid data samples in each data burst there are 15 data bursts used when obtaining a sample of the proximity sensor data and the inter burst period lasts for 3 seconds. In a further embodiment the inter burst period lasts for 60 seconds. In a further embodiment the weighting function is as follows 

L is an ambient light metric representing the ambient light intensity that shone on the electronic device or on the first face when a data burst was taken. In one or more embodiments L is the average illuminance measured in Lux taken during a data burst .

It is understood that the method may pause during times when the second data source indicates that there is an object proximal the first face or that conditions are not compatible with an electronic device at rest thus increasing the inter burst time period .

While the present application is primarily described in terms of methods a person of ordinary skill in the art will understand that the present application is also directed to various apparatus such as electronic devices including a mobile communications device. The electronic device includes components for performing at least some of the aspects and features of the described methods which may be by way of hardware components such as the memory and or the processor software or any combination of the two or in any other manner. Moreover an article of manufacture for use with the apparatus such as a pre recorded storage device or other similar computer readable storage medium including program instructions recorded thereon or a computer data signal carrying computer readable program instructions may direct an apparatus to facilitate the practice of the described methods. For example a compute readable storage medium may include computer executable instructions for performing one or more of the methods described herein. It is understood that such apparatus and articles of manufacture also come within the scope of the present application.

The term computer readable medium or computer readable storage medium as used herein means any medium which can store instructions for use by or execution by a computer or other computing device including but not limited to a portable computer diskette a hard disk drive HDD a random access memory RAM a read only memory ROM an erasable programmable read only memory EPROM or flash memory an optical disc such as a Compact Disc CD Digital Versatile Disc DVD or Blu Ray Disc and a solid state storage device e.g. NAND flash or synchronous dynamic RAM SDRAM .

One or more embodiments have been described by way of example. It will be apparent to persons skilled in the art that a number of variations and modifications can be made without departing from the scope of what is defined in the claims.

