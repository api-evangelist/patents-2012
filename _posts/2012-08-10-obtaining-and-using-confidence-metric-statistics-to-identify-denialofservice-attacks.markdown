---

title: Obtaining and using confidence metric statistics to identify denial-of-service attacks
abstract: A system may receive data collected by a network for a plurality of calls that are to be routed by the network to a call center, detect an event based on the received data, determine a confidence level, for the event, that the event is a denial-of-service attack, determine a call service to be provided to the call center in response to detecting the event, and provide the call service based on the confidence level.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08913493&OS=08913493&RS=08913493
owner: Verizon Patent and Licensing Inc.
number: 08913493
owner_city: Basking Ridge
owner_country: US
publication_date: 20120810
---
When many calls arrive at a call center within a short period of time the calls may prevent the call center from processing other calls. Some of the calls that flood a call center may be the result of a denial of service attack against the call center.

The following detailed description refers to the accompanying drawings. The same reference numbers in different drawings may identify the same or similar elements. As used herein the term denial of service may include preventing or denying a user from accessing or using resources. The resources may include for example processing power memory storage database channels assigned to for a customer network utilization etc. As used herein the term denial of service attack may include an attempt to prevent a system from providing such a resource.

As described below a system may collect call statistics for a network. When new calls arrive at the network the system determines a level of confidence for the calls that the calls are denial of service attack calls based on the call statistics. The system may provide information about the calls to a client to which the calls are to be forwarded routed route the calls to the client test the callers to obtain additional information about the callers or drop one or more of the calls.

Testing a caller may include a passive test collecting information about the caller and or sending a query. For example the system may request the caller to answer a question. If the answer to the question is correct the system may determine that the caller is likely to be a person or a desired calling agent rather than a machine and switch route the call to the client. If the answer is incorrect the system may drop the call.

The system may provide the client with an opportunity to provide a feedback about the calls. If the client does provide a feedback the system may use the feedback to augment the call statistics.

Network may include one or more packet switched networks such as an Internet protocol IP based network a local area network LAN a wide area network WAN a personal area network PAN an intranet the Internet a cellular network a fiber optic network or another type of network that is capable of conveying data. Network may also include a circuit switched network such as a public switched telephone network PSTN for providing telephone services for traditional telephones. Network may allow devices at customer premises e.g. STB to connect to other devices also attached to network . For example network may provide a communication path from a home phone to call center .

In network includes a service provider network which in turn includes Signaling System No. 7 SS7 network a Session Initiation Protocol SIP network and a confidence metric server CMS device .

SS7 network provides switching services for plain old telephone system POTS calls. For example SS7 network routes a POTS call from a POTS telephone to another POTS telephone.

SIP network includes an IP network and devices that support the SIP protocol and communication e.g. registration device session border controllers SBC devices a proxy server device etc. .

CMS device may collect call statistics provide the call statistics to users and or provide the statistics and other information to network devices for controlling call routing. The network devices may drop calls or allow calls to reach their destinations based on the information.

In collecting the call statistics CMS device may receive feedback information from call center that indicates whether particular calls routed via networks and or are denial of service attack calls. Based on the feedback and data collected from other devices in networks and CMS device may generate a statistics database table from which CMS device can determine the confidence level that a group of incoming calls is a denial of service attack. CMS device may provide information in the database and or a confidence level associated with calls to other devices in networks and and or call center .

Mobile device may include a radiotelephone a smart phone a laptop a tablet computer or another portable communication device. Mobile device may communicate with other devices via one or more communication towers not shown using a wireless communication protocol e.g. GSM Global System for Mobile Communications CDMA Code Division Multiple Access WCDMA Wideband CDMA IEEE 802.11x etc. Mobile device may be associated with a phone number. Mobile device may be considered a user device or client device. Mobile device may be located outside or inside customer premises .

Customer premises e.g. the customer s home may include an optical network terminal ONT a home computer a home phone a set top box STB a TV and a remote control . Devices in customer premises such as home computer home phone STB TV and remote control also may each be a user device or a client device. 

ONT may receive data e.g. on a fiber optic cable and may transfer the data to the appropriate device in customer premises such as computer or STB . Likewise ONT may receive data from any device in customer premises and may transmit the data to other devices in environment e.g. through a fiber optic cable. ONT may provide customer premises with Internet access television access and or telephone service for example.

Computer may include a laptop a desktop a tablet computer a mobile telephone a personal digital assistant PDA a gaming console or another portable communication device. Computer may include a microphone for capturing audio and or a camera for capturing images or video. Computer may also include a display for showing images or video or a speaker for playing audio. Home phone may include a POTS device a wireless telephone a soft phone e.g. Voice over Internet Protocol IP VoIP phone etc.

STB may receive content and output the content to TV for display. STB may include a component e.g. a cable card or a software application that plugs into a host device e.g. a personal computer TV a stereo system etc. that allows the host device to display content. STB may also be implemented as a home theater personal computer HTPC an optical disk player e.g. digital video disk DVD or Blu Ray disc player a cable card etc. STB may receive commands from other devices in environment such as remote control . In one embodiment STB may include a microphone and or a camera.

TV may include speakers as well as display. TV may play content for example received from STB . While some embodiments of devices described below may interact with TV other embodiments may interact with any device e.g. computer or mobile phone .

Remote control may issue wired or wireless commands for controlling other electronic devices such as TV or STB . Remote control in conjunction with STB may allow a user to interact with an application running on STB . Other types of devices e.g. a keyboard a mouse a mobile phone etc. may be used instead of remote control or may be included in remote control .

Call center may receive calls for servicing customers. Call center may receive either both IP calls e.g. SIP calls or time division multiplexed TDM calls e.g. SS7 Integrated Service Digital Network ISDN . In handling incoming calls call center may receive CMS services from network for example to block denial of attack calls. Depending on call center s arrangement with network call center may receive CMS services from network when the number of calls is high or when a specific event occurs. In some cases call center may receive CMS services from network independently of the number of calls.

Call center may include one or more servers e.g. network devices that manage and or store information associated with providing service to customers. As shown in call center may include a gateway device a proxy call routing system and call agent devices through N collectively agent devices individually agent device .

Gateway device may include one or more devices that allow different data networks to communicate and cooperatively carry traffic. For example gateway device may adapt between SS7 signaling and session initiation protocol SIP signaling H.323 protocol signaling or other protocol signaling used by other devices in environment . In one implementation gateway device may convert TDM encoded voice signals to packetized data suitable for transport to and processing by a proxy device such as proxy . In another implementation gateway device may receive TDM encoded voice signals and allow such calls to be terminated at TDM devices e.g. phones .

Gateway device may also include one or more session border controller SBC devices that provide control of the boundary between different service provider networks provide signaling protocol compatibility between an IP based network and other service provider networks or control the transport boundary between service provider networks. In one embodiment gateway device may correspond to an ingress point to proxy .

Proxy may provide signaling services to establish sessions between devices such as home phone and an agent device . Proxy may include a server or computer that is able to receive data from gateway device and forward the received data to an appropriate device or system such as call routing system using a session signaling protocol such as SIP or H.323. Proxy may also receive data from call routing system and forward the received data to other devices such as gateway device for example.

Call routing system may distribute calls to one of agent devices . Call routing system is illustrated as being external from proxy . In some implementations call routing system may include proxy . Call routing system may forward calls to one of agent devices according to an algorithm based on e.g. which of agent devices has an available customer service agent the type of issue or problem the customer is experiencing the skill set of the customer service agent e.g. technical skill language skill product knowledge etc. the experience of the customer service agent the type of call the type of customer etc.

Agent device may include a workstation computer or another type of device for a customer service agent to use for handling calls from customers. Agent device may include a telephone a camera a microphone a speaker and or a headset including a microphone and speaker. Agent device may also include a software implemented telephone e.g. a soft phone or a hardware implemented telephone e.g. a hard phone . Agent device may also include software or hardware for performing packet based data transmission to transmit data such as voice video or text.

In some implementations agent device may receive information from CMS device about calls in addition to other information pertaining to the caller. The information from CMS device may include confidence level score that the call is a denial of service attack call. The confidence level score may cause the call center agent to ask additional questions to the caller to provide service to caller and or to forward the call elsewhere for additional processing.

In call center once a call s is received one or more of the devices in call center may perform post processing for the call. The post processing may include receipt of confidence level score from CMS device e.g. via an application programming interface API and or forwarding a response to CMS device .

In devices in network and or customer premises may collect call statistics. When a new call for call center arrives at network for switching routing one of the devices e.g. a device in network or network may request CMS device to determine a level of confidence for the call whether the call is a denial of service attack call based on the call statistics. Depending on the confidence level provided by CMS device the device may route the call when the device has the capability to route the call drop the call or test the caller to obtain additional information about the caller. If the device tests the caller depending on the answer the device may drop or route the call.

In the exemplary configuration of devices and networks in environment are illustrated for simplicity. Environment may include more devices fewer devices or a different configuration of devices than those illustrated in . For example environment may include thousands or millions of customer premises thousands of call centers hundreds of CMS devices hundreds of service provider networks etc. In another example network may include H.323 network s or PSTN network s .

In some embodiments the functions performed by two or more devices in environment may be performed by any one device. Likewise in some embodiments the functions performed by any one device may be performed by multiple devices. Furthermore the connections shown in are exemplary. In other embodiments additional connections that are not shown in may exist between devices e.g. each device may be connected to every other device . The connections in may also be wireless or wired.

SSP may include switches devices that source or terminate calls. An SSP device may signal other SSPs to establish a call. In establishing a call SSP may send a query to SCP to obtain information for routing the call.

STP may route each of incoming messages to one of its outgoing links based on routing information in a message from SCP . SCP may include one or more devices for providing routing information to SSP and or SIP .

Call screening device situated in call paths may screen a particular call or set of calls based on call statistics or information provided by CMS device . Call screening device may also monitor calls and provide information about the calls to CMS device .

Depending on the implementation SS7 network may include additional fewer different or a different arrangement of devices than the ones illustrated in . Although SS7 network may include many other types of network elements and devices than those illustrated for simplicity they are not illustrated in . In some implementations the functions performed by two or more devices in SS7 network may be performed by any one device. Likewise in some embodiments the functions performed by any one device may be performed by multiple devices.

For example in some implementation SSP STP and or SCP may include some or all of the functionalities provided by call screening device . In such implementations SIP STP or SCP may provide information about incoming calls to CMS device . For each call for which SSP and or SIP receives statistical information from CMS device SSP and or STP may screen the call. Depending on the information SCP may also use information from CMS device to screen calls.

In no connections are shown. However connections that are not shown in may exist between devices e.g. each device may be connected to every other device . Any such connections may be wireless or wired.

For simplicity does not show other network components such as switches bridges SIP redirection servers etc. or all interconnections e.g. connections between registration device and other devices . In addition depending on the implementation SIP network may include fewer additional or different devices than those illustrated in FIG. . For example in one implementation SIP network may include additional SBC devices proxy server devices registration devices location servers a redirect server not shown etc. In another example in some implementations the functionalities of both registration device and location server device may be combined in a single device.

Call screening device may operate similarly to router firewall device described below. In addition situated in call paths call screening device may screen incoming calls based on call statistics or information provided by CMS device . Call screening device may also monitor calls and provide information about the calls to CMS device . Although call screening device is described as having similar functionalities as call screening device call screening device operates in an IP network with respect to SIP sessions. Call screening device on the other hand operates in a SS7 system.

Router firewall device may include mechanisms for routing packets modifying network addresses of packets e.g. network address translation NAT and for protecting devices in network against unauthorized egress ingress. In some implementations router firewall device may receive SIP user credentials e.g. user ID and password from a user device e.g. home phone mobile device etc. before router firewall device allows the user device to communicate with another device outside SIP network .

SBC device may provide for signaling as well as a set up maintenance and or tear down of media channels such as VoIP sessions video streams instant messaging sessions etc. Proxy server device may include an entity e.g. a device an application etc. that operates on behalf of another entity such as a user client device. In acting on behalf of another entity proxy server device may route VoIP IP signaling messages toward their destinations.

Registration device may include a device for registering a user and storing the registration information at location server device . The registration process may include receiving SIP user credentials e.g. a user ID and password that a client user device receives from a SIP credentials device binding information e.g. an association between an address of record AOR e.g. a uniform resource identifier URI and a network address e.g. an IP address . Upon successfully authenticating a user registration device may store the binding information at location server device . To initiate the registration a user client device may issue a SIP REGISTER command along with the SIP authentication binding information to registration device .

Location server device may include a device at which registration device stores the bindings and the client device information. Other devices in network such as proxy server device etc. may obtain the binding information and or client device information from location server device . For instance proxy server device may obtain an IP address of a client user from location server device in order to initiate a communication session between SIP applications on the client device and another device e.g. a device in call center .

In some implementations the functions performed by two or more devices in SIP network may be performed by any one device. Likewise in some embodiments the functions performed by any one device may be performed by multiple devices.

For example in some implementation SBC devices proxy device and or firewall device may include some or all of the functionalities provided by call screening device . In such implementations devices and may provide information about incoming calls to CMS device . In addition for each call device or may receive statistical information from CMS device and may screen calls.

Processor may include a processor a microprocessor an Application Specific Integrated Circuit ASIC a Field Programmable Gate Array FPGA and or other processing logic e.g. embedded devices capable of controlling network device . Memory may include static memory such as read only memory ROM and or dynamic memory such as random access memory RAM or onboard cache for storing data and machine readable instructions e.g. programs scripts etc. . Storage unit may include a floppy disk CD ROM CD read write R W disc and or flash memory as well as other types of storage devices e.g. a hard disk drive for storing data and or machine readable instructions e.g. a program script etc. .

Input component and output component may provide input and output from to a user to from network device . Input and output components and may include a display screen a keyboard a mouse a speaker a microphone a camera a DVD reader Universal Serial Bus USB lines and or other types of components for converting physical events or phenomena to and or from signals that may be input to or output from network device .

Network interface may include a transceiver e.g. a transmitter and a receiver for device to communicate with other devices and or systems. For example via network interface network device may communicate over a network such as the Internet an intranet a terrestrial wireless network e.g. a WLAN WiFi WiMax etc. a satellite based network art optical network etc. Network interface may include a modern an Ethernet interface to a LAN and or an interface connection for connecting network device to other devices e.g. a Bluetooth interface .

Communication path may provide an interface through which components of network device can communicate with one another.

Network device may perform the operations described herein in response to processor executing software instructions stored in a non transient computer readable medium such as memory . A computer readable medium may include a physical or logical memory device. The software instructions may be read into memory from another computer readable medium or from another device via network interface . The software instructions stored in memory may cause processor to perform processes that are described herein.

Monitor may receive a notification about an incoming call and may collect information about the call. For example given a call monitor may record the time of the call e.g. the time of day the day of week the month and or the year a source telephone number for the call an IP address associated with the call if the call is VoIP a universal resource identifier URI a duration of the call a value of a field in a SIP signaling message e.g. a P asserted identity From To etc. charge etc. Monitor may send the recorded data to CMS device when monitor detects the call or the end of the call. Alternatively monitor may aggregate data from multiple calls and send the aggregated data to CMS device periodically or upon demand from CMS device .

Call screening logic may include hardware and or software components for receiving instructions from CMS device that indicate whether an incoming call is to be dropped forwarded routed or tested. In a different implementation call screening logic may send a query to CMS device for instructions on dropping the call. In the query call screening logic may include any information that monitor obtained about the call. Upon receipt of a response from CMS device call screening logic may drop block the call forward route the call toward its destination and or test the calling party.

Depending on whether the incoming call is for a text session video conferencing or an audio communication e.g. a phone call call screening logic may provide different types of tests. For example if the incoming call is a request for text based session call screening logic may send a text query to the caller requesting that the caller answer a simple question e.g. type a specific sequence of characters select a number provide a result of adding two numbers provide a result of subtracting one number from another number spell out a phonetic word identify an image picture identify a sound provide an answer to a simple true false question etc. .

In another example if the incoming call is a request for a phone call call screening logic may send a voice message to the caller requesting the caller to provide a keypad voice input in response to a question e.g. Please repeat the following numbers by pressing on your phone key pad 13 19 and 24 To proceed please answer the following question. What is the sum of 12 and 24 etc. .

In each of the preceding examples when the caller provides a response call screening logic may determine whether the response is correct. If the response is correct call screening logic may conclude that the calling party is a person or a desired calling agent and route the call toward its destination. Otherwise call screening logic may drop block the call. In some implementations call screening logic may conclude that based on the answer other similar calls are also made by a person desired calling agent or a computer machine and accordingly drop or route the calls.

In some implementations call screening logic may provide a passive test un addition to or without a request to provide an answer to question s in which a caller is screened or tested in a way transparent to the user based on analysis of data. Examples of such tests include analyzing background noise e.g. determining whether the background noise level is within a typical variance e.g. for detecting callers that send screeching noise for the purpose of annoying agents at call center measuring randomness of key press delays e.g. automated dialers do not share the same dial entropy as a human does between digit entries so entering for example 1 2 3 by an automated dialer has a different time delay profile than that of a person desired calling agent etc. In such analyses historical data and trending data may also be used to determine validity of the call in addition to rate speed of data entry entropy etc. The data from testing may be provided to monitor which in turn may send the data to CMS device . CMS device may use such data immediately or for building trending data and or training its analysis system to avoid false positives in detecting denial of service attacks.

In testing the calling party call screening logic may temporarily park the call establish a temporary session with the calling party request a response during the temporary session over the communication link receive a response from the caller determine whether the response indicates that the caller is a person desired calling agent and not a computer machine and forward the call e.g. redirect the call if call screening logic determines that the caller is a person desired calling agent. To determine whether the response from the caller is correct call screening logic may perform voice recognition image recognition e.g. in the case of video conferencing text analysis e.g. recognize words etc. to extract information from the caller response.

Application server may provide application to service client requests. As described in greater detail with respect to application server may collect data about calls from one or more monitoring devices send monitoring devices information about a confidence level of calls i.e. whether calls are likely to be a denial of service attack determine compute statistical data based on the data about calls e.g. for analysis .

In addition application server may provide statistical information to call center or to any other customer partner with whom service provider network has an arrangement to provide such data. In some implementations application server may provide business logic for other functions such as authentication authorization etc.

Web server may provide an interface via which application server renders its services. For example web server may send a page to a device in call center for the user to obtain data about a specific call. In another example web server may provide a user interlace for a login. When a user enters the password user ID application server may attempt to authenticate the user based on the password user id relayed by web server .

Call database may include data collected via application server from monitoring devices . For each call that monitoring device receives and for which monitoring device collects data monitoring device may send the data to application server . Application server may store the data in call database .

In some implementations when application server computes a confidence level for calls application server may store the confidence level in call database . In some implementations when data arrives from monitoring device application server may update and store call statistics in call database . Exemplary information stored in call database is described below with reference to .

Data collection logic may include a hardware software component for collecting call data from monitoring devices . Data collection logic may collect the data incrementally e.g. as each call arrives at monitoring device or aggregate data. Data collection logic may format and or store the data e.g. formatted data in call database . In collecting data data collection logic may contact monitoring devices that are listed in device list .

For some calls whose information that data collection logic obtains data collection logic may contact one or more devices in call center to determine whether the calls are part of a denial of service attack. Based on the feedback from call center data collection logic may store information indicating whether a call has been determined as part of an attack in call database .

Data distribution logic may distribute data in call database to monitoring devices e.g. periodically or upon demand to devices in call center and or to user s authorized to access the data. For example data distribution logic may send a confidence level information in response to receipt of a query from monitoring device about a call via application server to monitoring device . In another example data distribution logic may send such information to agent device in call center .

In addition data distribution logic may instruct call screening devices and or and call screening logic in monitoring devices to screen calls e.g. either upon receipt of requests from devices or logic or without receiving such requests . In instructing such devices to drop calls forward route calls and or to test the callers data distribution logic may employ different strategies. For example in one implementation data distribution logic may instruct the devices to allow only a fraction of the calls in a detected event to be dropped or tested.

Statistics logic may compute determine statistics for the call data in call database store the determined call statistics e.g. call distributions over different variables such as a number of calls call duration call time etc. and or provide the statistics to another component e.g. data distribution logic or to a user. For example given a call statistics logic may determine its confidence level that the call is a denial of service attack call based on call data i.e. by determining a proportion of calls with the same characteristics as the call being a denial of service attack .

In some implementations statistics logic may analyze call data infer information from the call data and store the inferred information in call database . The inferred information may be used for determining the confidence level of a call that the call is part of a denial of service attack. For example statistics logic may determine whether a call is from a set of origination points identified by a corresponding set of information. For example statistics logic may determine whether a call is from a set of phone numbers from which calls originate in a pattern and indicate the result of its determination in call database . More specifically for example statistics logic may determine whether a caller number is part of an increasing or decreasing sequence of caller phone numbers for calls made about the same time to a specific call center. Similarly statistics logic may determine whether a caller IP address when the call is a VoIP is part of an increasing or decreasing sequence of IP addresses of calls made about the same time.

In some cases statistics logic may apply its analysis to a specific customer link. For example statistics logic may provide an analysis of F link fully associated link in SS7 network or its equivalent in SIP network another network e.g. H.323 PSTN etc. . That is statistics logic may provide analysis on the monitored customer link and provide a result of the analysis to the customer e.g. call center .

Device list may include one or more lists of devices from which data collection logic may obtain data e.g. devices in call center monitoring devices etc. and or lists of devices to which data distribution logic may send information.

Call ID field may include an alphanumeric string that identifies a caller e.g. a phone number . Source Type field may include an alphanumeric string that identifies the source e.g. an IP address a phone number etc. and the type of communication being originated e.g. Time Division Multiplexed TDM IP call etc. . Destination Type field may include an alphanumeric string that identifies the destination e.g. an IP address a phone number etc. and the type of communication established at the destination e.g. TDM or IP .

Source location may include an alphanumeric string that identifies the location of the call e.g. address city name county longitude and latitude etc. . Time field and duration field may identify the time of the call and the duration of the call. Call center field may identify the call center to which the call is directed e.g. the call center of the destination . Year month day field may indicate the year month and day of the call.

Denial of service attack field may indicate whether the call is a denial of service attack call. Whether the call is a denial of service attack may be determined by information from call center or based in inferential information. For example assume that a call has been received that a large number of calls are made from phone numbers that begin with digits 703 434 between 12 00 and 1 00 p.m. that the calls have been determined as denial of service attack and that the call is from 703 434 1234 and is made at 12 59. In such an instance statistics logic may infer that the call is also part of the denial of service attack and indicate this in field for the call in call database .

Depending on the implementation row may include additional fewer different or a different arrangement of fields than those illustrated in . In some implementations for example row may include additional fields whose values are provided by data collection logic and statistics logic . More specifically for example row may include a field that indicates whether the call is part of a call event. A call event as used herein may refer to a collection of calls with a set of same characteristics e.g. calls that are made with a particular area code calls with the same source P address calls that are made between 12 00 p.m. and 12 05 calls whose numbers are interrelated to one another by a pattern etc. . When statistics logic detects a call event and determines that a call is part of the event statistics logic may indicate this in a field.

In another example row may include a field that indicates whether the caller IP address when the call is a VoIP that is part of an increasing or decreasing sequence of IP addresses of calls in a call event. Other implementations may include fields that indicate whether the calling number is part of other patterns e.g. calls originating from a set of limited set of numbers in a specific pattern . Other examples include fields for a P asserted identity in a SIP message From To values in a SIP message Request Universal Resource Identifier R URI etc.

In some implementations row may also include fields that may be used in determining a likelihood of false positives for detected denial of service attacks. For example a field may include a special promotion time e.g. a time period after a commercial requesting potential purchaser to call . Such an event may increase the likelihood that a group of calls in a short time interval are not a denial of service attack.

In one implementation statistics logic may obtain distribution or another distribution for the likelihood of calls being a denial of service attack conditioned on different set of characteristics based on information from call database . For example statistics logic may detect events based on call database where an event is a collection of calls sharing a set of same values for a selected set of fields e.g. one of more of fields or other fields .

More specifically for example an event may include calls having originating IP addresses 171.12.14.xxx where xxx stands for a wildcard see field for row lasting for 20 40 seconds field and destined for call center see field . Statistics logic may detect many such events in call database with each event occurring at different times. Assuming that each of such events includes different number of calls and that it is known whether each of the events is a denial of service attack statistics logic may plot probability distribution as a function of the number of calls over the events.

In when the number of calls N in an event is equal to M the probability of that event being a denial of service attack is CL1 or confidence level CL1 . When N in an event is equal to R the probability of the event being a denial of service attack is CL2 or confidence level CL2 . That is for each observed N there is a corresponding confidence level based on a ratio of a number of events that are denial of service attacks and a number of events that are not denial of service attacks. When a new event conditioned on the same set of field values e.g. fields in as the events in plot occurs statistics logic may determine the confidence level that the new event is a denial of service attack based on plot .

For example assume that T number of calls are made to call center . Statistics logic may look up N T on plot and determine that the corresponding confidence level is CL3 . If a particular value of N has not been observed e.g. plot has a hole at the particular value of N for a given N the number of observed events being denial of service attacks is zero and the number of observed events not being denial of service attacks is zero etc. statistics logic may interpolate the confidence level based on similar events e.g. different N s . The interpolation may be linear or based on functions of higher powers.

Depending on the implementation statistics logic may not have pre computed plots . In such implementations when a new event occurs statistics logic may determine its confidence level based on information in call database that may be used to generate plot .

Process may include CMS device collecting call data block e.g. via data collection logic . In one implementation monitoring devices may push call data to CMS device . In a different implementation CMS device may periodically poll monitoring devices for the call data. CMS device may run an instance of statistics logic to monitor the call data collected by CMS device .

CMS device may detect a call event block . As explained above detecting a call event may include obtaining a list of calls that share a number of characteristics. In detecting the event CMS device may also determine the number of calls in the event.

For example assume that one type of event is defined in statistics logic as calls originating from IP addresses with the common A B and C classes within 10 minute span of time and directed to one call center. In this case statistics logic may determine that a potential denial of service attack event has occurred with the event including 2 000 calls between 10 00 and 10 05 a.m.

CMS device may determine a particular service to which call center is subscribed for events that are detected by statistics logic block . In some implementations CMS device may contact another device or a database that stores account information for call center . In other implementations CMS device may keep a local image store of such information. In one implementation the services may include reporting the event or screening additional calls to be received that are a continuation of the same event.

If the service to which call center is subscribed includes reporting block yes CMS device may report the event to call center block and process may proceed to block . Otherwise block no CMS device may proceed to block .

If the service to which call center is subscribed does not include screening block no process may proceed to block . Otherwise block yes CMS device may determine whether the confidence level determined at block is greater than a first threshold block .

If the confidence level is greater than the first threshold block yes process may proceed to block where some or all of the additional calls belonging to the same event are dropped via monitoring devices . For example in one implementation CMS device may contact monitoring device to drop the calls.

Depending on the implementation or user preferences e.g. preferences of call center different strategies algorithms may be used for selecting calls to drop. For example CMS device may instruct monitoring devices to drop a fraction e.g. . . . or 1 N of the calls that belong to the same event and whose destination termination is call center . In another example CMS device may cause monitoring device to drop route calls intermittently. In yet another example CMS device may cause monitoring device to drop just enough calls to prevent call center s call handling capacity from being overloaded.

Returning to block if the confidence level is less than or equal to the first threshold block no CMS device may proceed to block . At block if the confidence level is equal to or less than the first threshold and the confidence level is greater than a second threshold CMS device may instruct monitoring device to test for some or all of the calls in the event whether the caller is a person desired calling agent e.g. a person agent initiating a call using a phone or a program computer machine e.g. an automated caller block .

As described above the type of test s performed by monitoring device may depend on the type of communication session to be established between the caller and call center e.g. text messaging audio call video conferencing etc. . In some instances one or more of the test s may passive and be transparent to the caller without caller interaction. A passive test may include collecting information about the call e.g. background noise key press time delays entropy etc. without interacting with the user to determine whether the caller is a person desired agent or a computer machine. As also described above the test s may include querying by monitoring device the caller with a question that can easily be answered correctly by a person calling agent but is difficult to be answered correctly by a program a computer or a machine.

Depending on the implementation the testing may be performed on every call or on certain fraction of the calls in the manner similar to that described above for dropping the calls at block . In these implementations the tested calls are used as samples for making statistical inferences about the remaining calls e.g. a number of callers in the event failed the test and therefore other callers in the event are highly likely to fail the test . Thereafter process may proceed to block .

At block for each tested call if the answer from the caller is correct block yes or the result of the test meets a validation requirement e.g. noise level is less than a threshold monitoring device may allow the call to pass or route the call block . Depending on the screening strategy monitoring devices may pass route all or some of the other calls in the event.

At block for each of the calls if the answer from the caller is incorrect block no or the result of the test does not validate the call e.g. in cases where the test is passive monitoring device may drop the call block . Depending on the screening strategy monitoring devices may drop only those calls for which incorrect answers are provided by the callers or a fraction of the calls with the incorrect answers etc. in a manner similar to that described above for block . Thereafter process may proceed to block .

Returning to block if the confidence level is not between the first threshold and the second threshold i.e. not T2

If there is no feedback block no process may return to block . If there is feedback block yes process may add the feedback information about the call event to call database block . For example for calls that are part of the event and listed in call database CMS device may fill in denial of service attack field as YES or NO depending on whether the feedback indicates that the calls are indeed a denial of service attack.

As described above a system may collect call statistics. When new calls arrive at the network the system determines a level of confidence for the calls that the calls are denial of service attack calls based on the call statistics. The system may provide information about the calls to a client to which the calls are to be forwarded routed route the call to the client test the callers to obtain additional information about the callers or drop one or more of the calls.

When the system tests a caller the system may request the caller to answer a question. If the answer to the question is correct the system may determine that the caller is likely to be a person desired calling agent rather than a machine and switch route the call to the client. If the answer is incorrect the system may drop the call.

The system may provide the client with an opportunity to provide a feedback about the calls. If the client does provide a feedback the system may use the feedback to augment the call statistics.

In this specification various preferred embodiments have been described with reference to the accompanying drawings. It will however be evident that various modifications and changes may be made thereto and additional embodiments may be implemented without departing from the broader scope of the invention as set forth in the claims that follow. The specification and drawings are accordingly to be regarded in an illustrative rather than restrictive sense.

For example call screening monitoring have been described for SS7 and SIP networks. However call screening monitoring may be performed in devices in other types of network e.g. PSTN H.323 network etc. . These networks may feed call data to CMS device for analysis and or providing CMS services e.g. screening calls to call center .

In another example while series of blocks have been described with regard to an exemplary process illustrated in the order of the blocks may be modified in other implementations. In addition non dependent blocks may represent acts that can be performed in parallel to other blocks. Furthermore one or more of the blocks may be omitted in other implementations.

It will be apparent that aspects described herein may be implemented in many different forms of software firmware and hardware in the implementations illustrated in the figures. The actual software code or specialized control hardware used to implement aspects does not limit the invention. Thus the operation and behavior of the aspects were described without reference to the specific software code it being understood that software and control hardware can be designed to implement the aspects based on the description herein.

Further certain portions of the implementations have been described as logic that performs one or more functions. This logic may include hardware such as a processor a microprocessor an application specific integrated circuit or a field programmable gate array software or a combination of hardware and software.

No element act or instruction used in the present application should be construed as critical or essential to the implementations described herein unless explicitly described as such. Also as used herein the article a is intended to include one or more items. Further the phrase based on is intended to mean based at least in part on unless explicitly stated otherwise.

