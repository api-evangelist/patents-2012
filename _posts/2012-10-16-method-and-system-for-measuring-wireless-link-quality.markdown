---

title: Method and system for measuring wireless link quality
abstract: The present disclosure discloses a method and network device for measuring wireless link quality. The disclosed network device retrieves a plurality of packet transmission data corresponding to a plurality of transmission rates at which packets are transmitted over a wireless link between two wireless nodes in a wireless network. The network device also determines a wireless link quality metric value corresponding to the wireless link at least based on at least an average throughput associated with the plurality of transmission rates. The wireless link quality metric value can be further based on a maximum throughput corresponding to a hardware component in at least one of the two wireless nodes. The wireless link quality metric value can be used in monitoring or managing the wireless network.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09215609&OS=09215609&RS=09215609
owner: ARUBA NETWORKS, INC.
number: 09215609
owner_city: Sunnyvale
owner_country: US
publication_date: 20121016
---
The present disclosure relates to wireless link quality measurement in wireless networks. In particular the present disclosure relates to improved estimation of link quality for a wireless link between two wireless nodes when the wireless link environment changes in a wireless network.

Wireless networks aim to provide reliable connectivity for user and high end to end throughput performance. Routing is one of the most important factors affecting connectivity and throughput in wireless networks especially in multi hop wireless mesh networks. Routing establishment depends on metric values associated with each routing path. The metric typically considers many comprehensive factors such as hop count delay time and link quality. For a wireless network the hop count and the delay time are relatively easy to measure. On the other hand the link quality is complicated and difficult to measure because wireless link environment often is influenced heavily by reliability and interference.

One conventional way of estimating wireless link quality uses the measured packet delivery ratio to represent the link quality of a particular wireless link. To support link quality measuring unicast probing packets are usually used to probe link s packet delivery ratio.

However link quality estimation based on the packet delivery ratio cannot reflect how busy the link environment is. Since the physical layer has built in mechanisms to avoid transmission conflicts the packet deliver ratio may be quite high even though the link environment is very poor.

Moreover the conventional way of estimating wireless link quality does not consider the influence of transmission rate on the link quality. For example assuming that at the beginning of data transmission payload packets are transmitted at a high transmission rate. Subsequently the link environment deteriorates. Accordingly the transmission rate is adjusted to a lower transmission rate. On the other hand the packet delivery ratio at a low transmission rate may be higher than at the packet delivery ratio at a high transmission rate. As a result when the link environment becomes worse the estimation of link quality using conventional way can actually get better instead of reflecting the worsened link environment. Under these circumstances the conventional assessment of wireless link quality cannot accurately measure the actual wireless link quality.

In the following description several specific details are presented to provide a thorough understanding. While the context of the disclosure is directed to channel scanning in discovery stage of fast roaming in wireless network one skilled in the relevant art will recognize however that the concepts and techniques disclosed herein can be practiced without one or more of the specific details or in combination with other components etc. In other instances well known implementations or operations are not shown or described in details to avoid obscuring aspects of various examples disclosed herein. It should be understood that this disclosure covers all modifications equivalents and alternatives falling within the spirit and scope of the present disclosure.

Embodiments of the present disclosure relate to wireless link quality measurement in wireless networks. In particular the present disclosure relates to improving estimation of link quality for a wireless link between two wireless nodes when the wireless link environment changes in a wireless network.

According to embodiments of the present disclosure wireless link quality is calculated based on throughput estimation which takes into account changes in transmission rates. The transmission rate is capable of being self regulated. Specifically when the link environment changes such as RSSI altering signal interference etc. the transmission rate will make corresponding adjustment automatically. Thus the selection of transmission rate in part reflects quality of the current link environment.

In some embodiments the disclosed method estimates packet delivery ratio with unicast probing packets and normal traffic packets. Whether a network device shall send unicast probing packets may depend on existence of normal payload packets. In some embodiments the uncast probing packets are sent only when no normal payload packets are to be transmitted.

To estimate wireless link quality the network device first samples packets transmission information at each of a plurality of transmission rates. Next the network device calculates packet delivery ratio with respect to each transmission rate and estimates average throughput at least based on transmission rates and related packet delivery ratio in current environment. Then the network device calculates wireless link quality percentage as an ratio where indicates the estimated average throughput in current environment and indicates maximum valid throughput in the ideal environment.

With the solution provided herein a disclosed network device retrieves or samples a plurality of packet transmission data corresponding to a plurality of transmission rates at which packets are transmitted over a wireless link between two wireless nodes in a wireless network. The network device then determines a wireless link quality metric value corresponding to the wireless link at least based on a an average throughput associated with the plurality of transmission rates and b a maximum throughput corresponding to a hardware component in at least one of the two wireless nodes wherein the average throughput is determined based in part on a plurality of packet delivery ratios. The wireless link quality metric value calculated according to the present disclosure can accurately reflect real time link quality despite of changes in link environment and varied packet transmission rates as a result of network physical layer s conflict avoiding mechanism. Such wireless link quality metric may be used in either monitoring or managing the wireless network.

Moreover the plurality of wireless nodes may be interconnected to each other via wireless links or wired connections. For example in through various wireless links wireless node is connected to wireless nodes and wireless node is connected to wireless nodes and wireless node is connected to wireless nodes and wireless node is connected to wireless nodes and wireless node is connected to wireless nodes and etc.

Each wireless link between two wireless nodes can be measured by a wireless link quality metric. For illustration purposes only in the wireless link between wireless nodes and is associated with link metric the wireless link between wireless nodes and is associated with link metric the wireless link between wireless nodes and is associated with link metric etc.

When a packet to destination digital device is received from source digital device by wireless node wireless node dynamically selects a network device at the next hop to forward the packet. For example wireless node may compare link metric with link metric . If link metric indicates a better quality wireless node will select wireless node as the next hop and forward the packet to wireless node . Therefore accurate and reliable wireless link quality estimation results in better routes being selected for transmission of packets.

The network depicted in may operate on a private network including one or more local area networks. The local area networks may be adapted to allow wireless access thereby operating as a wireless local area network WLAN . Moreover the network may include a wired or wireless distribution system. In some embodiments the network may be a wireless mesh network 

In addition network depicted in may include multiple network control plane devices such as network controllers switches routers etc. Network control plane devices can provide functions such as creating and enforcing network policies providing adaptive radio management intrusion prevention quality of service and or mobility etc.

In this example the initial link environment is good. Thus initially sender device sends data packet at a high transmission rate to receiver device at time point t receiver device will receive data packet successfully at time point tand sends back an acknowledgement message e.g. ACK at time point t. ACK is received by sender device at time point t.

For illustration purposes only assuming that the link environment deterioration occurs between time point tand time point t. As a result data packet is transmitted at a low transmission rate to receiver device at time point t. After receiver device receives data packet at time point t receiver device sends an acknowledgement message e.g. ACK at time point t. The acknowledgement message is received successfully by sender device . Thus the packet delivery ratio remains high as a result of successful delivery of data packets at an adjusted lower rate. However the high packet delivery ratio is not indicative of a good link environment in this case.

In the link quality measuring mechanism estimates the node to node link quality in wireless networks. In some embodiments the process of link quality estimation can be completed in a wireless node that sends the packets.

After a packet is transmitted data related to the packet transmission will be entered into LQS which computes statistical information of the packet transmission data. Such packet transmission data may include but is not limited to transmission rate the number of retransmissions backoff time from previous transmissions when applicable succeed or fail outcomes etc. In some embodiments the packet can be a data packet including payload information. In other embodiments the packet may be a unicast control packet including a probing message. In some embodiments LQS samples packet transmission data at various transmission rates such as rate rate . . . rate K .

LQE integrates information of transmission data at various transmission rates as provided by LQS and estimates the wireless link s quality using formulas described later in this disclosure. In some embodiments LQE may be used on demand. The on demand request can be received from for example user display or route selection mechanism . In some embodiments a network administrator may want to monitor the link quality on a user interface or check on the link quality of a particular wireless link. The network administrator will be able to receive wireless link quality estimation provided by LQE through user display . In other embodiments a wireless node may need to update its routes for example when network topology changes. In order to do so the wireless node can request link quality estimations from LQE via route selection mechanism .

For each transmission rate there can be a storage used to store statistics information within a packet statistics period PSP . In some embodiments LQS only stores the statistics information corresponding to the latest transmission period of time which can be PSP. In particular a continuous transmission timeline within PSP can be divided into a plurality of small transmission time slices. LQS may use one memory unit to store the packet transmission result within each small transmission time slice. LQE will choose all of the memory units within the PSP to calculate the packet delivery ratio.

After each packet is transmitted LQS will perform statistical calculation of the transmission result. For example LQS can calculate statistical information such as transmission rate the number of retransmissions backoff time from previous transmissions when applicable succeed or fail outcomes etc.

In addition LQS will index the memory unit by transmission rate and or transmission time. After calculating the transmission result LQS adds the transmission result to a corresponding counter in the indexed memory unit based on the transmission rate and or transmission time associated with the current packet transmission.

Note that the transmitted packets can be either normal traffic packets or unicast probe packets . In some embodiments when there is no normal traffic packet to be transmitted over the wireless link the wireless node may send a unicast probing packet to test the link quality during that particular period. By sampling a combination of normal packets and unicast probing packets the wireless link quality measuring mechanism based on LQS and LQE usually work well even in the absence of active traffic over the link and thus providing dynamic real time estimation of the wireless link quality.

More specifically each wireless node may maintain a timer which triggers the unicast packet probing mechanism. The timer may be pre configured by a network administrator based on the network environment topology conditions etc. When the pre configured time set by the timer expires the sending wireless node checks whether any traffic packets have been transmitted during the last time slice or PSP. If no traffic has been transmitted the sending wireless node will send a plurality of unicast probe packets to the receiving wireless node of the wireless link.

The number of unicast probe packets and the transmission rates at which they will be sent can be determined at least in part based on previous transmission results stored in the memory units. In some embodiment the wireless link quality measuring mechanism will determine a total number of unicast probing packets to be transmitted to the receiving wireless node how many groups the unicast probing packets will be transmitted how many unicast probing packets will be transmitted within each group the transmission rate at which each group of the unicast probing packets will be sent etc.

The link quality estimation by LQE as disclosed herein is based on throughput estimation. The hardware transmission rate indicates the hardware s maximum ideal throughput. However the real throughput is usually lower than the hardware transmission rate. For example when the hardware transmission rate is 300 Mbps the real valid throughput may be merely 220 Mbps even in an ideal link environment. Therefore LQE uses the valid throughput instead of the hardware transmission rate to estimate wireless link quality metrics.

The link quality estimation disclosed in the present disclosure maintains a corresponding valid throughput for each hardware transmission rate. The valid throughput indicates the maximum throughput with a specific hardware transmission rate in an ideal environment.

Moreover in some embodiments the valid throughput estimation is performed based on the assumption that there is no contention on wireless transmission channel and thus the wireless node sends maximum transmission units MTU .

For a specific hardware transmission rate the valid throughput estimation is calculated according to the following 

By applying the above equations to various hardware transmission rates and wireless modes the link quality measuring mechanism can acquire valid throughputs which correspond to each related transmission rate per wireless mode.

For illustration purposes only assuming that there are K different transmission rates. At each transmission rate the storage or database records the packets transmission information within the PSP. Because retransmitted packets consume bandwidth of wireless channels should the retransmitted packets failed to be delivered successfully the failure will be accounted as a transmission failure. For instance when transmitting a packet a wireless node retries 4 times and finally succeeds at the transmission on the 4th retransmission. In this example for the purpose of calculating link quality metrics unlike conventional methods the link quality measuring mechanism will treat the original packet transmission and the 4 subsequent retransmissions of the same packet as if 5 distinct packets have been transmitted over the wireless channel with 1 packet successfully delivered and 4 packet delivery failures.

Usually the numbers of the transmission packets at each transmission rate is not the same within the PSP. Thus a greater number of packets transmitted at a specific transmission rate usually is associated with a higher weight. Accordingly numbers of transmission packets are used as a weighing factor when calculating the average throughput. The weights are represented by below 

In the present disclosure packet delivery ratio is calculated with respective to each of the different transmission rates at which packets are transmitted. Furthermore the packet delivery ratio in the i transmit rate is given by

When transmitting each packet the sender wireless node chooses a transmission rate as it deems most appropriate. As a result the valid throughput corresponding to the transmission rate can approximately represent real maximum throughput in the current link environment even though the traffic is very low.

The average throughput depends on valid throughputs at various transmission rates while packet delivery ratio is considered. The average throughput can be estimated by the following 

Finally the disclosed link quality measuring mechanism calculates the wireless link quality by computing a ratio between the average throughput and the maximum ideal throughput.

In some embodiments the throughput based link quality measuring mechanism as disclosed in the present disclosure estimates the average throughput in the current link environment. In some embodiments the throughput based link quality measuring mechanism can also expect real throughput in the current link environment to facilitate route selection as needed in for example wireless mesh networks.

In the depicted example the sending wireless node and the receiving wireless node were initially configured to work on IEEE 802.11a mode and to form a wireless distribution system WDS link. Then the current link environment of the WDS link is artificially changed such that the transmission rate is adjusted gradually from a low transmission rate to a high transmission rate. For each adjusted transmission rate the system records a link quality percentage of the sending wireless node tests the maximum throughput from the sending wireless node to the receiving wireless node and records the real throughput in specific transmission rates. The obtained results are illustrated in the table in .

The item Expect IPUT is calculated by Expect IPUT link quality 100 where Ris ideal maximum throughput. In the example illustrated in the ideal maximum throughput is 28.00 Mbps. From the table illustrated in the system can extract wireless link quality metric values including but not limited to link quality percentage expect throughput real throughput etc.

First the disclosed network device determines whether normal traffic packets are received during a packet statistical period PSP operation . If not the network device transmits a plurality of unicast probing packets at multiple transmission rates on the wireless link operation . In some embodiments the unicast probing packets are transmitted in groups. Further the network device determines one or more of i a total number of unicast probing packets to be transmitted to a wireless node ii a total number of groups that the unicast probing packets are transmitted in iii numbers of unicast probing packets to be transmitted within each group and iv transmission rates at which each group of the unicast probing packets is to be sent. Also note that the transmission rate at which a packet is transmitted may be adjusted in response to a link environment change for example as influenced by interference level channel load etc. on the wireless link.

If normal traffic packets are received or after unicast probing packets are transmitted the network device next samples packet transmission data at multiple transmission rates operation . In some embodiments the sampled packet transmission data includes one or more of a packet delivery ratio a packet transmission rate a total number of retransmissions a backoff time from previous transmissions and a transmission outcome.

Moreover the network device may optionally store the packet transmission data operation . Specifically the network device may divide the PSP into multiple transmission time slices and store the packet transmission data corresponding to each transmission time slice in a unique storage unit. Furthermore the network device can index the storage units based on packet transmission rate or packet transmission time or both operation .

Also the network device can retrieve packet transmission data at multiple transmission rates within PSP operation . In some embodiments the network device retrieves the packet transmission data in response to an inquiry received via a user interface. In other embodiments the network device retrieves the packet transmission data when it needs to select or update a route.

Next the network device calculates a weighted average of sampled packet transmission data where the weight is determined based on at least the number of packets transmitted at a corresponding transmission rate operation . Thus the more packets transmitted at a specific transmission rate the more weight is given to the sampled packet transmission data associated with the specific transmission rate. Note that while determining one or more of the packet delivery ratio and the transmission outcome each retransmission of a previously transmitted packet is treated as a new transmission and thereby mitigating network physical layer s built in mechanism for avoiding conflicts.

In addition the network device determines a wireless link quality value based on a ratio between an average throughput and a maximum throughput operation . The average throughput is further determined based on valid throughputs corresponding to the plurality of transmission rates. Here a valid throughput indicates an approximate maximum throughput at a respective transmission rate in current link environment of the wireless link. The valid throughputs are estimated at least based on time of an inter frame space between transmissions of a first packet and a subsequent packet transmission time of a physical header of a packet and transmission time of payload data of the packet. Moreover the transmission time of payload data of the packet is determined based on at least a total length associated with the packet and a hardware transmission rate.

Network device includes at least one or more radio antennas capable of either transmitting or receiving radio signals or both a network interface capable of communicating to a wired or wireless network a processor capable of processing computing instructions and a memory capable of storing instructions and data. Moreover network device further includes a receiving mechanism a transmitting mechanism a link quality statistics mechanism and a link quality estimation mechanism all of which are coupled to processor and memory in network device . Network device may be used as a client system or a server system or may serve as node in a distributed or a cloud computing environment.

Radio antenna may be any combination of known or conventional electrical components for receipt of signaling including but not limited to transistors capacitors resistors multiplexers wiring registers diodes or any other electrical components known or later become known.

Network interface can be any communication interface which includes but is not limited to a modem token ring interface Ethernet interface wireless IEEE 802.11 interface e.g. IEEE 802.11n IEEE 802.11ac etc cellular wireless interface satellite transmission interface or any other interface for coupling network devices. In some embodiments network interface may be software defined and programmable for example via an Application Programming Interface API and thus allowing for remote control of the network device .

Processor can include one or more microprocessors and or network processors. Memory can include storage components such as Dynamic Random Access Memory DRAM Static Random Access Memory SRAM etc.

Receiving mechanism generally receives one or more network messages via network interface from a distribution system or radio antenna from a wireless client over a wireless communication channel. The received network messages may include but are not limited to requests and or responses beacon frames management frames control path frames and so on. Each message may comprise one or more data packets for example in the form of IP packets.

Transmitting mechanism generally transmits messages which include but are not limited to requests and or responses beacon frames management frames control path frames and so on. In some embodiments transmission mechanism can transmit a plurality of unicast probing packets at the plurality of transmission rates and thereby allowing real time estimation of link quality of the wireless link in absence of traffic packets. Note that in some circumstances transmitting mechanism may adjust a transmission rate at which a packet is to be transmitted in response to a link environment change on the wireless link.

Link quality statistics mechanism generally generates statistical information of packet transmission data. Specifically link quality statistics mechanism retrieves a plurality of packet transmission data corresponding to a plurality of transmission rates at which packets are transmitted over a wireless link between two wireless nodes in a wireless network.

Optionally link quality statistics mechanism may also determine whether a traffic packet is received within the PSP. If not transmission mechanism will transmit a plurality of unicast probing packets at the plurality of transmission rates. In such cases link quality statistics mechanism further determines one or more of i a total number of unicast probing packets to be transmitted to a wireless node ii a total number of groups that the unicast probing packets are transmitted in iii numbers of unicast probing packets to be transmitted within each group and iv transmission rates at which each group of the unicast probing packets is to be sent.

Link quality estimation mechanism generally estimates wireless link quality. Specifically link quality estimation mechanism determines a wireless link quality metric value corresponding to the wireless link at least based on a an average throughput associated with the plurality of transmission rates and b a maximum throughput corresponding to a hardware component in at least one of the two wireless nodes. The average throughput is determined based in part on a plurality of packet delivery ratios and valid throughputs corresponding to the plurality of transmission rates. Further the valid throughput indicates an approximate maximum throughput at a respective transmission rate in current link environment of the wireless link. The valid throughputs can be estimated at least based on time of an inter frame space between transmissions of a first packet and a subsequent packet transmission time of a physical header of a packet and transmission time of payload data of the packet. Moreover the transmission time of payload data of the packet is determined based on at least a total length associated with the packet and a hardware transmission rate.

Therefore receiving mechanism transmitting mechanism link quality statistics mechanism and link quality estimation mechanism often collectively operate with each other to improve performance of client devices during discovery stage of their fast roaming in wireless networks.

According to embodiments of the present disclosure network services provided by wireless network device solely or in combination with other wireless network devices include but are not limited to an Institute of Electrical and Electronics Engineers IEEE 802.1x authentication to an internal and or external Remote Authentication Dial In User Service RADIUS server an MAC authentication to an internal and or external RADIUS server a built in Dynamic Host Configuration Protocol DHCP service to assign wireless client devices IP addresses an internal secured management interface Layer 3 forwarding Network Address Translation NAT service between the wireless network and a wired network coupled to the network device an internal and or external captive portal an external management system for managing the network devices in the wireless network etc.

The present disclosure may be realized in hardware software or a combination of hardware and software. The present disclosure may be realized in a centralized fashion in one computer system or in a distributed fashion where different elements are spread across several interconnected computer systems coupled to a network. A typical combination of hardware and software may be an access point with a computer program that when being loaded and executed controls the device such that it carries out the methods described herein.

The present disclosure also may be embedded in non transitory fashion in a computer readable storage medium e.g. a programmable circuit a semiconductor memory such as a volatile memory such as random access memory RAM or non volatile memory such as read only memory power backed RAM flash memory phase change memory or the like a hard disk drive an optical disc drive or any connector for receiving a portable memory device such as a Universal Serial Bus USB flash drive which comprises all the features enabling the implementation of the methods described herein and which when loaded in a computer system is able to carry out these methods. Computer program in the present context means any expression in any language code or notation of a set of instructions intended to cause a system having an information processing capability to perform a particular function either directly or after either or both of the following a conversion to another language code or notation b reproduction in a different material form.

As used herein digital device generally includes a device that is adapted to transmit and or receive signaling and to process information within such signaling such as a station e.g. any data processing equipment such as a computer cellular phone personal digital assistant tablet devices etc. an access point data transfer devices such as network switches routers controllers etc. or the like.

As used herein access point AP generally refers to receiving points for any known or convenient wireless access technology which may later become known. Specifically the term AP is not intended to be limited to IEEE 802.11 based APs. APs generally function as an electronic device that is adapted to allow wireless devices to connect to a wired network via various communications standards.

As used herein the term interconnect or used descriptively as interconnected is generally defined as a communication pathway established over an information carrying medium. The interconnect may be a wired interconnect wherein the medium is a physical medium e.g. electrical wire optical fiber cable bus traces etc. a wireless interconnect e.g. air in combination with wireless signaling technology or a combination of these technologies.

As used herein information is generally defined as data address control management e.g. statistics or any combination thereof. For transmission information may be transmitted as a message namely a collection of bits in a predetermined format. One type of message namely a wireless message includes a header and payload data having a predetermined number of bits of information. The wireless message may be placed in a format as one or more packets frames or cells.

As used herein wireless local area network WLAN generally refers to a communications network links two or more devices using some wireless distribution method for example spread spectrum or orthogonal frequency division multiplexing radio and usually providing a connection through an access point to the Internet and thus providing users with the mobility to move around within a local coverage area and still stay connected to the network.

As used herein the term mechanism generally refers to a component of a system or device to serve one or more functions including but not limited to software components electronic components electrical components mechanical components electro mechanical components etc.

As used herein the term embodiment generally refers an embodiment that serves to illustrate by way of example but not limitation.

It will be appreciated to those skilled in the art that the preceding examples and embodiments are exemplary and not limiting to the scope of the present disclosure. It is intended that all permutations enhancements equivalents and improvements thereto that are apparent to those skilled in the art upon a reading of the specification and a study of the drawings are included within the true spirit and scope of the present disclosure. It is therefore intended that the following appended claims include all such modifications permutations and equivalents as fall within the true spirit and scope of the present disclosure.

While the present disclosure has been described in terms of various embodiments the present disclosure should not be limited to only those embodiments described but can be practiced with modification and alteration within the spirit and scope of the appended claims. Likewise where a reference to a standard is made in the present disclosure the reference is generally made to the current version of the standard as applicable to the disclosed technology area. However the described embodiments may be practiced under subsequent development of the standard within the spirit and scope of the description and appended claims. The description is thus to be regarded as illustrative rather than limiting.

