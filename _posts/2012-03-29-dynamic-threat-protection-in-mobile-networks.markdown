---

title: Dynamic threat protection in mobile networks
abstract: In general, techniques are described for dynamic threat protection in mobile networks. A network system comprising a network security device and a management system may implement the techniques. The management system includes a network server having a shared database. A mobile device manager (MDM) of the management system receives a report message from a mobile device, specifying a threat to a mobile network. The MDM publishes the threat to the shared database. A network management system (NMS) of the management system receives data from the shared database identifying the threat and generates a security policy that specifies actions to address the threat. The NMS then installs the security policy in the network security device so that the network security device performs the actions of the security policy to address the threat.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=08726338&OS=08726338&RS=08726338
owner: Juniper Networks, Inc.
number: 08726338
owner_city: Sunnyvale
owner_country: US
publication_date: 20120329
---
This application claims the benefit of U.S. Provisional Application No. 61 594 164 filed Feb. 2 2012 the entire contents of which are incorporated herein by reference.

Use of cellular mobile devices for accessing computer data networks has recently increased dramatically. These mobile devices often referred to as smart phones provide a platform for both cellular phone calls and cellular based access to computer data services. For example a typical cellular radio access network RAN which may also be referred to as a mobile core network or mobile core is a collection of cells that each includes base stations capable of transmitting and relaying radio signals to subscribers mobile devices. A cell generally denotes a distinct area of a cellular network that utilizes a particular frequency or range of frequencies for transmission of data. A typical base station is a tower to which are affixed a number of antennas that transmit and receive the data over the particular frequency. Mobile devices may transmit radio signals at the designated frequency to the base stations to initiate cellular telephone calls or packet based data services. With respect to data services cellular service providers convert the cellular signals e.g. Time Division Multiple Access TDMA signals Orthogonal Frequency Division Multiplexing OFDM signals or Code Division Multiple Access CDMA signals received from mobile devices at the base stations into Internet protocol IP packets for transmission within packet based networks such as the Internet.

With the increasing use of cellular mobile devices to access packet based networks malicious attackers which may be commonly referred to as hackers have begun to shift the targets of their attacks from more traditional computing devices such as desktop computers workstations laptop computers and the like to cellular mobile devices such as the above noted smart phones cellular tablet or slate computers and cellular e book readers to name a few examples. The increase in malicious attacks with respect to cellular mobile devices has occurred at least in part as a result of users employing cellular mobile devices to access and or conduct critical financial transactions such as online banking transactions and or e commerce where the malicious attacks seek to gain access to sensitive user information involved in these transactions such as usernames and passwords credit card numbers and other sensitive information commonly employed when conducting these types of transactions .

These attacks are commonly deployed using a call home structure where a malicious program may be surreptitiously loaded onto the cellular mobile devices and then when loaded contact a controlling agent that instructs the malicious program on future malicious actions to be taken. These malicious actions not only impact infected cellular mobile devices compromising their security but also may impact other cellular mobile devices in that the malicious communications between the malicious program and the controlling agent may consume bandwidth that could be utilized by the other cellular mobile devices for legitimate purposes. Loss of bandwidth may impact user experience and eventually lead to subscribers leaving the service provider that operates the mobile RANs to provide the cellular packet based data services.

In general techniques are described for dynamic threat protection in mobile networks. The techniques may provide for dynamic threat protection through what may be referred to as a feedback loop. A management system that manages mobile devices and at least one network security device such as a firewall may implement the techniques. The management system may receive reports of threats to the mobile network from one or more of the mobile devices. The management system may include a mobile device manager MDM and a network management system NMS where the MDM manages the mobile devices and the NMS manages the network security device. The MDM may pass these reports or some data derived from these report to the NMS using an information exchange server that manages a shared database such as an interface for metadata access points IF MAP server. The IF MAP server features both a push and pull data model in which subscribers of the server such as the NMS may receive notifications of recently published information or request recently published information respectively.

Through this information exchange server the NMS may receive data describing the network threats and then dynamically based on these reports generate a security policy that specifies one or more actions to address the reported threats. The NMS installs these security policies in the network security device which may then perform the actions specified in these security policies to address the threats. In this manner the management system dynamically adapts operation of the network security devices to address threats reported by mobile devices. The network security device may reside between the mobile network and a public network such as the Internet so as to prevent threats from the public network that needlessly consume the bandwidth of the mobile network. As a result the techniques may reduce malicious activity within the mobile network that may needlessly consume bandwidth which is often scarce and as a result expensive to provide in comparison to wired access networks such as wired broadband networks.

In one embodiment a network system comprises a mobile network that couples to a public network at least one network security device positioned at the edge of the mobile network between the mobile network and the public network a plurality of mobile devices that access the mobile network and a management system. The management system includes a network server comprising a shared database a mobile device manager MDM device that manages the plurality of mobile devices and a network management system NMS that manages the at least one network security device. The MDM device includes at least one interface that receives a report message from one of the plurality of mobile devices wherein the report message specifies a threat to the mobile network originating from the public network and a control unit that publishes the threat to the shared database. The NMS includes at least one interface that receives data from the shared database of the network server identifying the threat to the mobile network originating from the public network and a control unit that generates a security policy that specifies one or more actions to address the threat specified by the received data and installs the security policy in the at least one network security device so that the network security device performs the actions of the security policy to address the threat specified in the received message.

In another embodiment a method comprises receiving with a mobile device manager MDM of a management system that manages a plurality of mobile devices that access a mobile network a report message from one of the plurality of mobile devices wherein the report message specifies a threat to the mobile network originating from a public network to which the mobile network connects and publishing with the MDM the threat to a shared database in accordance with an interface for metadata access points IF MAP standard such that a network management system NMS of the management system that manages at least one network security device of the mobile network is able to generate a security policy that specifies one or more actions to address the threat specified in the report message and install the security policy in the at least one network security device so that the network security device performs the actions of the security policy to address the threat specified in the report message.

In another embodiment a mobile device manager MDM device of a management system that manages a plurality of mobile devices that access a mobile network comprises at least one interface that receives a report message from one of the plurality of mobile devices wherein the report message specifies a threat to the mobile network originating from a public network to which the mobile network connects and at least one control unit that publishes the threat to a shared database in accordance with an interface for metadata access points IF MAP standard such that a network management system NMS of the management system that manages at least one network security device of the mobile network is able to generate a security policy that specifies one or more actions to address the threat specified in the report message and install the security policy in the at least one network security device so that the network security device performs the actions of the security policy to address the threat specified in the report message.

In another embodiment a non transitory computer readable medium comprising instructions that when executed cause one or more processors of a mobile device manager MDM device included within a management system to receive a report message from one of a plurality of mobile devices managed by the MDM device wherein the report message specifies a threat to a mobile network originating from a public network to which the mobile network connects and publish the threat to a shared database in accordance with an interface for metadata access points IF MAP standard such that a network management system NMS of the management system that manages at least one network security device of the mobile network is able to generate a security policy that specifies one or more actions to address the threat specified in the report message and install the security policy in the at least one network security device so that the network security device performs the actions of the security policy to address the threat specified in the report message.

In another embodiment a method comprises receiving with a network management system NMS of a management system that manages at least one network security device positioned between a mobile network and a public network data from a shared database in accordance with an interface for metadata access points IF MAP standard wherein the data identifies a threat to the mobile network originating from the public network to which the mobile network connects and wherein the shared database is shared by a mobile device manager MDM of the management system and the NMS. The method also comprises generating with the NMS a security policy that specifies one or more actions to address the threat specified by the received data and installing with the NMS the security policy in the at least one network security device so that the network security device performs the actions of the security policy to address the threat specified in the received message.

In another embodiment a network management system NMS of a management system that manages at least one network security device positioned between a mobile network and a public network comprises at least one interface that receives data from a shared database in accordance with an interface for metadata access points IF MAP standard wherein the data identifies a threat to the mobile network originating from the public network to which the mobile network connects and wherein the shared database is shared by a mobile device manager MDM of the management system and the NMS. The NMS also comprises a control unit that generates a security policy that specifies one or more actions to address the threat specified by the received data and installs the security policy in the at least one network security device so that the network security device performs the actions of the security policy to address the threat specified in the received message.

In another embodiment a non transitory computer readable medium comprising instructions that when executed cause one or more processors of a network management system NMS to receive data from a shared database in accordance with an interface for metadata access points IF MAP standard wherein the data identifies a threat to a mobile network originating from a public network to which the mobile network connects and wherein the shared database is shared by a mobile device manager MDM and the NMS generate a security policy that specifies one or more actions to address the threat specified by the received data and install the security policy in at least one network security device positioned between the mobile network and the public network so that the network security device performs the actions of the security policy to address the threat specified in the received message.

The details of one or more embodiments of the techniques are set forth in the accompanying drawings and the description below. Other features objects and advantages of the techniques will be apparent from the description and drawings and from the claims.

More specifically radio access network may represent a collection of cells that each includes base stations such as base station capable of transmitting and relaying radio signals to mobile devices such as mobile device A. The term cell generally refers to a distinct area of a cellular network that utilizes a particular frequency or range of frequencies for transmission of data. A typical base station is a tower to which are affixed a number of antennas that transmit and receive the data over the particular frequency in accordance with the cellular standard implemented by radio access network . Base station represents an example of a typical base station. Mobile device A may transmit radio signals at the designated frequency to the base stations to initiate cellular telephone calls or packet based data services. With respect to the packet based data services cellular service providers convert the cellular signals e.g. Time Division Multiple Access TDMA signals Orthogonal Frequency Division Multiplexing OFDM signals or Code Division Multiple Access CDMA signals received from mobile device A at the base stations into Internet protocol IP packets for transmission within packet based networks such as public network .

Public network represents any network that is available to be generally accessed by the public. An exemplary public network is the Internet where public network may represent the Internet as a whole or only a portion of the Internet. In any event public network may comprise an interconnected collection of network devices such as routers switches hubs servers laptop computers desktop computers tablet or slate computers mobile devices including so called smart phones electronic reading devices gaming devices portable entertainment devices and any other device that is capable of connecting to a network.

Increasingly cellular service providers are adapting radio access networks such as radio access network to provide these packet based data services to mobile devices such as mobile device A so that these mobile devices may access public network . As a result new devices referred to as smart phones have been developed to make use of this relatively new form of packet based data services. With the emergence of so called smart phones that are capable of high speed network access both via more traditional wired access networks often by way of wireless access points and wireless access networks such as radio access network these mobile devices are capable of consuming greater amounts of content of various types including text video and audio based content in comparison to traditional cellular phones. Cellular service providers in response to this growth in smart phone usage have further adapted radio access network to manage increasing growth in smart phone usage and the associated high demand for packet based data services.

To illustrate in the example of network system includes a management system which the cellular service provider typically deploys to facilitate centralized management of mobile devices such as mobile device A. Management system represents one or more network devices that manage mobile devices such as mobile device A. Management system may secure monitor manage and support mobile devices deployed across mobile operators service providers and enterprises. Typically management system may distribute over the air or in other words via radio access network applications data and configuration setting for all types of mobile devices such as mobile phones including smart phones tablet computers laptop computers electronic reading devices or any other device capable of interfacing with radio access network . Mobile device A may generally represent any one of these types of mobile devices. In this manner the cellular service provider may deploy management device to centralize management of mobile devices coupled to radio access network .

In adapting radio access network to support the growth in packet based data services cellular service providers have spent considerable amounts of capital often in the form of new base stations and other equipment necessary to add additional cells to radio access network . In comparison to wired access networks such as wired broadband networks the capital outlays to adapt radio access network typically far exceed those required to extend or improve a wired broadband network making the cost per unit of bandwidth much greater in radio access network compared to wired access networks. In this respect bandwidth in radio access network may be more valuable than bandwidth in wired access networks which most cellular service providers also commonly operate as service providers. For this reason cellular service providers may deploy network security devices to protect radio access network from malicious attacks that may needlessly consume bandwidth in radio access network . Further details of an example radio access network of a service provider are described in U.S. patent application Ser. No. 13 247 357 NETWORK ADDRESS PRESERVATION IN MOBILE NETWORKS filed Sep. 28 2011 the entire contents of which are incorporated herein by reference. In such an example radio access network may include a cellular network and a core network that interfaces to public network . Management system may be deployed anywhere within the service provider network such as with the core network which may include other management components such as an Authentication Authorization and Accounting AAA server.

In the example of radio access network includes a network security device in the form of firewall . The cellular service provider may deploy firewall such that firewall resides at the edge of radio access network between radio access network and public network . While described with respect to firewall the techniques described in this disclosure may be implemented with respect to any network security device such as an intrusion detection and prevention IDP device to name one alternative. Firewall therefore represents one example of a network security device. Firewall may provide many security services including port and or address blocking network address translation NAT and the like. Firewall may implement network security policies to perform the network security operations. Typically these network security policies are statically defined by network administrators to prevent perceived network vulnerabilities of radio access network .

Although shown in the example of as connecting directly to public network radio access network may not directly connect to public network but may connect to public network via a backhaul network such as a mobile backhaul network positioned intermediately between radio access network and public network . The network security device e.g. firewall in the example of may reside between this mobile backhaul network and public network rather than reside at the edge of radio access network . Radio access network may in some instances include or otherwise represent both a radio access network and the mobile backhaul network. The techniques should therefore not be limited to the example of which for ease of illustration purposes does not show a mobile backhaul network. Thus the security device may be positioned at the public network facing edge of radio access network a mobile core to public network edge where the mobile core includes both the radio access network and the mobile backhaul network and or the mobile core to partner network edge.

In some instances management system may manage or otherwise provide an interface by which to manage these network security policies implemented by firewall . In this respect management system may in addition to providing a centralized management system for managing mobile device A provide a centralized management system for managing network security devices such as firewall . While shown as interfacing with firewall management system may manage other network security devices which are not shown in the example of for ease of illustration purposes.

Conventionally static configuration of security policies within firewall is sufficient to reduce malicious attacks mostly because malicious attackers which may be commonly referred to as hackers have not begun to seriously target mobile devices. Consequently given the low volume of malicious attacks targeting mobile devices administrators or other network security personnel may create and install security policies to combat the relatively few in comparison to malicious attacks targeting more traditional networked computing devices such as desktop computers laptop computers etc. malicious attacks directed to mobile devices.

However with the above described increasing use of cellular mobile devices to access packet based networks hackers have begun to shift the targets of their attacks from more traditional computing devices such as desktop computers workstations laptop computers and the like to mobile devices such as mobile device A. The increase in malicious attacks with respect to cellular mobile devices has occurred at least in part as a result of users employing cellular mobile devices to access and or conduct critical financial transactions such as online banking transactions and or e commerce where the malicious attacks seek to gain access to sensitive user information involved in these transactions such as usernames and passwords credit card numbers and other sensitive information commonly employed when conducting these types of transactions . Additionally with the increasing use of personal mobile cellular devices in the context of the enterprise meaning users are increasingly employing their personal mobile cellular devices to access corporate or enterprise network increases the risk that corporate data is accessible to the malicious agent.

These attacks are commonly deployed using a call home structure where a malicious program or agent such as malicious agent may be surreptitiously loaded onto mobile device and then when loaded contact a controlling agent residing in a public network such as a malicious agent controller included within public network that instructs the malicious agent on future malicious actions to be taken. Malicious agent generally represents a software program that is controlled by malicious agent controller where malicious agent may interface or communicate with malicious agent control to receive instructions directing a malicious attack. Malicious agent may carry out these instructions to perform the malicious attack. Malicious agent may perform any manner of malicious attack from surreptitiously determining usernames passwords financial information such as credit card numbers expiration dates and security codes and other personal data providing this data to malicious agent controller to participating in large scale denial of service attacks spam campaigns or any other form of malicious attack. Malicious agent controller represents software commonly executed on hardware such as a server or computer that controls one or more malicious agents in performing these malicious actions or attacks.

These malicious actions not only impact infected cellular mobile devices compromising their security but also may impact other cellular mobile devices in that the malicious communications between the malicious program and the controlling agent may consume bandwidth that could be utilized by the other cellular mobile devices for legitimate purposes. Loss of bandwidth may impact user experience and eventually lead to subscribers leaving the service provider that operates the mobile RANs to provide the cellular packet based data services. With the increase in malicious attacks network administrators or other security personnel may be unable to specify security policies in sufficient time to prevent widespread malicious attacks from invading radio access network .

In accordance with the techniques described in this disclosure management system may provide dynamic threat protection in mobile networks. The techniques may provide for dynamic threat protection through what may be referred to as a feedback loop. Management system may implement the techniques where management system may receive reports of threats to radio access network from one or more of the mobile devices such as report from mobile device A. Management system may then based on these reports generate a security policy e.g. security policy that specifies one or more actions to address the reported threats. Management system installs these security policies in firewall which may then perform the actions specified in these security policies to address the threats. In this manner management system dynamically rather than statically adapts operation of firewall to address threats reported by mobile device A. As a result the techniques may reduce malicious activity within radio access network that may needlessly consume bandwidth.

To illustrate assume mobile device A accesses a website hosting malicious agent . A user operating mobile device A may instruct mobile device A to for example retrieve information associated with an uniform resource locator URL where this information may include hypertext transfer protocol HTTP information specifying a webpage and malicious agent . Mobile device A may present the webpage while also surreptitiously attempting to install malicious agent .

However as shown in the example of mobile device A may include a security module that identifies information as a potential threat. That is security module may represent anti virus software anti malware software anti spyware software firewall software or any combination thereof that is capable of identifying viruses malware spyware and other malicious attacks including malicious agent . Typically security module scans information applying threat signatures to determine whether information includes a malicious agent such as malicious agent prior to allowing malicious agent to be installed within mobile device A. Yet in some instances security module may not immediately identify malicious agent when inspecting information identifying malicious agent as malicious only after malicious agent attempts to communicate with malicious agent controller meaning malicious agent may be installed .

Regardless of when malicious agent is detected upon detecting malicious agent security module may generate report specifying the threat e.g. malicious agent to radio access network originating from public network . Often security module specifies the threat in terms of ports and Internet protocol IP addresses to which malicious agent is configured to use when communicating with malicious agent controller . Security module may then communicate report to management system . Management system receives report and generates security policy that specifies one or more actions to address the threat specified in report . For example management system may parse the IP addresses and ports associated with malicious agent controller from report and form security policy to specify that these IP address and ports should be blocked meaning that communication originating from malicious agent controller are dropped at firewall before reaching radio access network and all communication directed to malicious agent controller are block so as to prevent the so called call home effectively disabling malicious agent . Management system may then install security policy in firewall so that firewall performs the actions of the security policy to address the threat specified in report .

While described above with respect to a report message which may also be referred to as report that specifies IP addresses and ports associated with malicious agent controller report may specify any other information useful in forming security policies such as security policy in addition or as an alternative to IP address and ports. For example security module may identify the URL accessed when mobile device A retrieved information including malicious agent as well as a domain name system DNS name. Management system may then generate security policy such that all attempts to access this URL and or DNS name are dropped. Likewise while described with respect to IP addresses and ports management system may generate or form security policies based on the other information specified in report such as the example URL and DNS name referred to above. Additionally in some instances more advanced security policies may be generated one example of which is described in more detail with respect to .

In any event malicious agent executing within mobile device B may periodically attempt to call home or otherwise communicate with malicious agent controller . This communication is illustrated in as communication . Firewall may implement its security policies including security policy to drop or perform some other action with respect to this communication . Typically firewall drops communication . In some instances malicious agent controller may attempt to communicate with malicious agent to provide malicious agent with additional instructions where this communication is shown as communication in the example of . Once again firewall may implement security policy to drop communication or otherwise prevent communication from reaching radio access network .

As noted above management system may generate and install more advanced security policies within firewall . One example of a more advanced security policy may specify actions per a particular class of mobile devices. For example management system may form security policy such that when implemented by firewall firewall performs different actions for those mobile devices having installed a security module such as security module than those of mobile devices that have not yet installed security module .

To illustrate assume mobile device B has not yet installed a security module or downloaded malicious agent . Assuming mobile device A attempted to access information as shown in the example of and management system has already installed security policy specifying different actions for those mobile devices having installed security module and those that have yet to install security module when mobile device B attempts to access information firewall may apply security policy to the attempt to access information . Security policy may specify actions that firewall performs upon successfully identifying malicious agent as being associated with the access attempt. Firewall may perform these actions to parse the IP address associated with mobile device B sent as a source IP address in the access attempt which is often sent in the form of a packet . Using this IP address firewall may interface with management system which may in turn interface with a billing accounting or operation management system not shown in the example of for ease of illustration purposes to determine whether the user operating mobile device B current pays for a security service supporting security module . This billing accounting or operation management system may return an indication of whether the associated user subscribes to the security service which management system may forward to firewall . Based on this indication firewall may take one of two actions.

If the indication states that the associated user subscribes to the security service firewall may drop the packet. Thus if mobile device A attempted to access information firewall may determine that the user of mobile device A currently subscribes to the security service in the manner described above and executes security module . As a result firewall may drop the packet requesting information . However in the example noted above where it is assumed that mobile device B attempts to access information firewall may determine that mobile device B does not currently subscribe to the security service based on the indication from the billing accounting or operations management system. If the indication states that the associated user does not subscribe to the security service firewall may redirect the communication to a captive portal which may be hosted for example by a captive portal server . While shown as a separate device captive portal server may be incorporated into firewall or any other device capable of hosting a captive portal. Captive portal server may return captive portal in response to the redirected access request. Captive portal may when presented by mobile device B indicate that mobile device B attempted to access a malicious website or other resource and offer the user of mobile device B the opportunity to subscribe to the security software. In this manner cellular service provider may increase sales of subscriptions to the security service while also strengthening the feedback loop in terms of report generation and dynamic creation of security policies .

Control unit may represent one or more processors not shown in that execute software instructions such as those used to define a software or computer program stored to a non transitory computer readable storage medium again not shown in such as a storage device e.g. a disk drive or an optical drive or memory such as Flash memory random access memory or RAM or any other type of volatile or non volatile memory that stores instructions to cause a programmable processor to perform the techniques described herein. Alternatively control unit may represent dedicated hardware such as one or more integrated circuits one or more Application Specific Integrated Circuits ASICs one or more Application Specific Special Processors ASSPs one or more Field Programmable Gate Arrays FPGAs or any combination of one or more of the foregoing examples of dedicated hardware for performing the techniques described herein. Further details of an example mobile device providing integrated security services are described within U.S. patent application Ser. No. 12 967 977 entitled MULTI SERVICE VPN NETWORK CLIENT FOR MOBILE DEVICE filed Dec. 14 2011 incorporated herein by reference.

Control unit includes a user interface UI module UI module security modules and a security client module . UI module may represent a module with which a user may interface to interact with mobile device . Commonly UI module presents one or more command line interfaces CLIs graphical user interfaces GUIs or any other type of UI with which a user interface to input data and receive data from mobile device . As shown in the example of security modules comprise an anti virus AV module A AV module A an anti malware AM module B AM module B an anti spam AS module C AS module C and a firewall FW module D FW module D . AV module A represents a module that analyzes data stored to mobile device using anti virus signatures to detect the presence of viruses within mobile device . AM module B represents a module that analyzes data stored to mobile device using a number of techniques including anti malware signatures to detect the presence of so called malware within mobile device where the term malware is commonly used to denote malicious software. AS module C represents a module that analyzes SMS and email messages sent from and to mobile device using anti spam policies to detect spam where spam refers to undesirable and potentially malicious SMS or email messages. The transmission of spam messages may be blocked by AS module C. FW module D represents a module that performs operations similar to those described above with respect to firewall shown in the example of . FW module D may for example block connections from public network to mobile device if those connections do not originate from mobile device . Security client module represents a module that manages the security state of mobile device . Further details of example techniques for applying virus and malware security software within a mobile device are described within U.S. patent application Ser. No. 11 697 647 entitled MALWARE DETECTION SYSTEM AND METHOD FOR MOBILE PLATFORMS filed Apr. 6 2007 incorporated herein by reference.

Security client module of mobile device A may register with management system which then provides configuration information to configure current modules of mobile device A. For example management device may upon registering mobile device A provide configuration information configuring one or more of AV module A AM module B AS module C and FW module D. This configuration information may enable one or more of these modules or otherwise provide signatures and other information necessary to facilitate the operation of these modules .

To register mobile device A security client module collects registration data reg data . Registration data may include a phone number associated with mobile device and the IMEI IMSI or any other data commonly provided to register a mobile device with a network device or cellular devices such as base station shown in the example of . Registration data may also include authentication credentials of the user operating device A such as those provided to perform authentication in accordance with the 802.1X standard. Security client module then transmits registration data to management system via cellular interface .

In response to registering with management system mobile device A may receive a registration message from management system indicating that mobile device A has successfully or unsuccessfully registered with management system . Assuming mobile device A successfully registers with management system subsequent messages from management system may specify which ones of security modules are enabled or activated while also providing information to update de activate and or configure various ones of security modules . More information regarding registration and other interactions with a management system such as a mobile security gateway MSG may be found in U.S. application Ser. No. 13 166 376 filed Jun. 22 2011 the entire contents of which are hereby incorporated by reference as if set forth in its entirety herein.

In accordance with the techniques of this disclosure a user may interface with UI module to interface with control unit so as to communicate with public network via cellular interface . These communications may involve use of cellular packet based data services to which the user has subscribed and may comprise IP packets. The user may attempt to access information which includes malicious agent . Assuming firewall has not been updated at this point to detect the threat in the form of malicious agent firewall may permit information to traverse radio access network resulting in mobile device A receiving this information via cellular interface . Prior to presenting this information and surreptitiously installing mobile agent control unit may first invoke one or more of security modules to scan or otherwise analyze information for security threats.

One or more of security modules may each perform their separate analysis of information where AM module B may for example detect malicious agent within information as malicious software. AM module B may then inform security client module of the security threat in the form of malicious agent . Security client module may then generate a report message based on the identified threat. In this instance AM module B may provide a IP address and or protocol port associated with the server hosting information a URL associated with information a copy of malicious agent or any other information associated with or describing the threat which in this instance is malicious agent . Security client module may generate report message to include this threat description either in its entirety as provided by AM module B or partially where some of this threat description is filtered or removed . Security client module may then transmit report message via cellular interface to management system .

To illustrate security client module may after processing information generate DNS names IP addresses URLs and signatures associated with one or more so called command and control centers that direct and or otherwise controlled the malicious agents when these malicious agents call home to these command and control centers. Security client module may generate report message to include these DNS names IP addresses URLs and signatures so that a security policy can be generated that not only drops the connection packets to the URL and server serving the malicious data but also sever any other connections these types of malicious agents may attempt to establish to public network .

In this manner a mobile device may be adapted in accordance with the techniques to provide report messages describing threats to a management system. By providing report messages having detailed threat descriptions the techniques may enable feedback with respect to threats to radio access networks from a public network. As described in more detail below the management system may employ this feedback to dynamically create security policies which can then be installed in one or more network security devices to prevent this threat from entering the mobile network i.e. radio access networks as one example .

MDM represents a network device that manages mobile devices communicating with radio access networks of a cellular service provider such as radio access network shown in the examples of B. In the example of MDM includes interfaces and control unit . Interfaces typically include wired interfaces but may include interfaces that are substantially similar to cellular interface and wireless network interface . Control unit may be substantially similar to control unit described above with respect to the example of . Control unit includes a security server module that validates the security state of mobile devices such as mobile device A and otherwise manages security module . Again more information concerning security server module may be found in the above incorporated U.S. application Ser. No. 13 166 376 filed Jun. 22 2011.

As noted above security client module of mobile device A shown in the example of may register with MDM which then provides configuration information to configure current modules of mobile device A. For example MDM may upon registering mobile device A provide configuration information configuring one or more of AV module A AM module B AS module C and FW module D. This configuration information may enable one or more of these modules or otherwise provide signatures and other information necessary to facilitate the operation of these modules . MDM stores data defining registration lists . Registration lists as noted above may define a list of registered mobile devices. One or more of registration lists may be associated with radio access network and define mobile devices that are available to access radio access network .

As noted above mobile device A may detect security threats i.e. in the form of malicious agent in the examples described in this disclosure and generate report message detailing or specifying this threat. Mobile device A may invoke security client module which may generate report message based on threat information which may be referred to as a threat description transmitted by the detecting one of security modules . Security client module may forward report message via cellular interface to MDM which in turn may invoke security server module to handle or otherwise process report message . Security server module may process report message parsing report data from report message . Report data may comprise the threat description provided by the detecting one or more of security modules either in its entirety or after having been filtered to remove redundant or other information.

As further shown in the example of security server module includes IF MAP client module which represents a module that implements the IF MAP protocol to generate IF MAP messages. These IF MAP messages may request data stored to an IF MAP database DB or publish data to the IF MAP DB. More information concerning the IF MAP protocol may be found in an IF MAP specification entitled TNC IF MAP Binding for SOAP Specification Version 2.0 Revision 36 dated Jul. 30 2010 the entire contents of which are hereby incorporated by reference as if set forth in its entirety herein. Security server module may invoke IF MAP client module to generate an IF MAP message for publishing report data to IF MAP server . IF MAP client module may then forward IF MAP message to IF MAP server via one of interfaces .

IF MAP server includes interfaces that may be substantially similar to interfaces of MDM and a control unit that may be substantially similar to control unit of MDM . IF MAP server also includes an IF MAP database DB IF MAP DB . IF MAP database represents a database that stores data in accordance with an IF MAP protocol. Control unit includes an IF MAP host module which represents a module that implements the IF MAP protocol to process IF MAP publish messages such as IF MAP message and generate IF MAP messages in response to IF MAP query messages. In this example IF MAP host module receives IF MAP publish message via one of interfaces processes IF MAP publish message to extract report data and stores report data to an entry of IF MAP database . In some instances IF MAP database may have to create a new entry prior to publishing report data to IF MAP database .

By publishing report data to IF MAP DB MDM provides a way by which one or more NMSes such as MNS may access data defining threat descriptions without having to implement a proprietary protocol. Moreover the IF MAP protocol provides both for a pull and a push model of data access. That is in the pull model IF MAP server may provide data only in response to an IF MAP request message requesting that data. In the push model IF MAP server pushes or in other words forwards data often selectively in terms that the push data must meet some certain criteria such as being published by a trusted peer to subscribers of this type of data. Using this push model IF MAP server may push any data from MDMs such as MDM to NMSes such as NMS without any of the NMSes having to actively request this data. This push model may be periodic meaning IF MAP server may push any data published prior to the last push on a periodic basis or continuous meaning IF MAP server may push data as soon as the data is published . Regardless IF MAP server may store report data for later consumption by NMS .

As yet further shown in the example of NMS includes interfaces that may be substantially similar to interfaces of MDM and interfaces of IF MAP server . NMS also includes control unit which may be substantially similar to control units and of MDM and IF MAP server respectively. Control unit includes a policy server module which represents a module for generating and then distributing or installing security policies to or within network security devices such as firewall shown in the example of B.

Policy server module includes an IF MAP client module which may be substantially similar to IF MAP client module of MDM and a policy generation module . Policy generation module represents a module that dynamically generates security policies such as security policy based on report data such as report data . Policy server module may in some instances periodically invoke IF MAP client module to generation an IF MAP request message requesting report data newly published since the last request. Alternatively policy server module may subscribe to IF MAP server using the push model where IF MAP host module may push report data to IF MAP client module upon report data being published by MDM . Regardless IF MAP client module may retrieve report data forwarding report data to policy generation module .

While described in this disclosure with respect to IF MAP other similar types of protocols or application programming interfaces APIs for publishing and or retrieving data may be employed to facilitate implementation of the techniques described in this disclosure. One other API that may be used for example includes a representation state transfer REST ful RESTful APIs. REST generally defines a set of architectural principles by which Web services may be defined that focus on a system s resources including how resource states are addressed and transferred over hypertext transfer protocol HTTP by a wide range of client written in different languages. These RESTful APIs may therefore operate in accordance with these architectural principles to facilitate the exchange of state data such as the report data identifying security risks to radio access network . The techniques therefore should not be limited to IF MAP but may generally employ any form of protocol or API that facilitates the exchange of data between two or more devices.

Policy generation module may then generate policy based on report data . An example of policy is provided in the following Table 1.

As noted above there are a number of variations of policies. In some examples either MDM when publishing report data or policy generation module when analyzing report data may assign a reputation rank or score to various aspects of report data such as an URL. This reputation rank or score may comprise a number on a scale of one to 100. Policy generation module may then generate policies that utilize this reputation rank or score. Another example of policy that incorporates reputation rank or score is provided in the following Table 2.

As noted above management system may generate policy in some examples that redirect access by a mobile device that does not subscribe to a security service such as mobile device B shown in the example of to a URL such as URL to a captive portal . An example of this form of policy is provided in the following Table 3.

To determine whether a source IP address is secured or unsecured and thereby properly apply policy firewall when implementing this example of policy may issue a request to NMS . This request specifies a source IP address associated with the access attempt and requests security subscription information that specifies whether the provided source IP address subscribes to a security service offered by the cellular service provider. NMS receives this request and forwards this request to MDM where control unit of MDM invokes a billing client module . That is control unit includes a billing client module that provides an interface between MDM and backend billing accounting and or operation management system that maintains user device billing accounting profile and or other operations information.

Billing client module may process or handle the request from firewall issuing a request to this backend billing accounting and or operation management system requesting service subscription information associated with the source IP address provided in the request. This system which is not shown for ease of illustration purposes may perform a lookup using the IP address provided in the request to retrieve service subscription information and provide this service subscription information to billing client module . Billing client module may then forward this service subscription information via NMS to firewall which may then determine whether to redirect the session to captive portal or block the communication based on the service subscription information. To illustrate when firewall determines that the service subscription information indicates that mobile device A subscribes to the above noted security service firewall blocks the communication. However when firewall determines that service subscription information indicates that mobile device B does not subscribe to the above noted security service firewall redirects the session to captive portal .

Initially mobile device A may issue a request for information stored in public network . This request may comprise an HTTP request message requesting content associated with a website or any other request for information stored to public network . Assuming firewall has not been previously configured to block this information public network returns information in response to the request. Mobile device A therefore receives information from public network . Mobile device A may prior to presenting information via UI module for consumption by the user of mobile device A invoke one or more of security models to analyze information in order to detect a potential threat .

If one or more of security modules detects a threat for example in the form of malicious agent embedded within information YES the threat is forwarded to security client module which determines report data specifying the detected threat and generates report message to include report data in the manner described above . Security client module then transmits report message to management system . However if none of security modules detects a threat NO security client module may forward information to the responsible application such as a web browser application which presents information via user interface module to the user of mobile device A .

Initially management device receives report message via one of interfaces from a mobile device such as mobile device A . Control unit of MDM included within management system may invoke security server module in response to report message . Security server module parses report data from report message . Security server module then invokes IF MAP client module passing report data to IF MAP client module . IF MAP client module generates an IF MAP publish message to include report data and transmits this IF MAP publish message to IF MAP server . In this manner IF MAP client module publishes report data to IF MAP server .

Via either the pull model or the push model described above as implemented by IF MAP client module NMS receives report data . In response to receiving report data control unit of NMS invokes policy server module to process report data . Policy server module in turn invokes policy generation module which generates policy based on report data in the manner described above . Policy server module then installs policy in firewall .

While described above with respect to a wireless access network the techniques of this disclosure may also be implemented with respect to wired access networks. For example cellular service providers have begun to deploy wireless access points in public places where these public wireless access points are commonly referred to as hotspots so as to offload traffic from the mobile network such as radio access network onto wired access networks. These wired access networks to which the mobile devices connect wirelessly via wireless access points may likewise be protected from public network by a network security device which may be similar to firewall . The techniques may be deployed such that management system receives reports via the wired access network and provisions network security devices protecting not only a mobile network or wireless access network but also wired access networks. The techniques may be implemented such that threats detected when connected to public network via a wired access network are communicated to management system so that policies are deployed to combat these threats in network security devices protecting wireless access networks and vice versa meaning threats detected when connected via wireless access network are used to dynamically generate policies that are then installed in network security devices protecting wired access networks .

Various embodiments of the invention have been described. These and other embodiments are within the scope of the following claims.

