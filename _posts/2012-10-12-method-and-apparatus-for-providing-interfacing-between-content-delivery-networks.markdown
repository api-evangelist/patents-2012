---

title: Method and apparatus for providing interfacing between content delivery networks
abstract: A method and apparatus are described for forwarding content delivery network interconnection (CDNI) signaling. A CDNI router content delivery network (CDN) may establish CDNIs with upstream and downstream CDNs. The CDNI router CDN may receive a CDNI route advertisement message from at least one of the upstream and downstream CDNs. The CDNI router CDN may update at least one end-user-based CDNI routing table based on Internet protocol (IP) address blocks in the CDNI route advertisement message. The CDNI router CDN may transmit an updated CDNI route advertisement message to at least one of the upstream and downstream CDNs. At least one of the upstream and downstream CDNs may update at least one end-user-based CDNI routing table based on the end user IP address blocks in the updated CDNI route advertisement message.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09049100&OS=09049100&RS=09049100
owner: INTERDIGITAL PATENT HOLDINGS, INC.
number: 09049100
owner_city: Wilmington
owner_country: US
publication_date: 20121012
---
This application claims the benefit of U.S. Provisional Application No. 61 546 819 filed Oct. 13 2011 which is incorporated by reference as if fully set forth.

Access providers in an access provider network such as mobile network operators MNOs and Internet service providers ISPs are currently not aware of individual content deliveries. This limits the possibility for an access provider to optimize deliveries in order to solve issues related to quality of experience QoE . For example content may be delivered locally to increase QoE mobility may be implemented to assist session delivery transfer and content popularity may be implemented to group a set of deliveries using multicast or point to point P2P . This may be achieved by deploying a content delivery network CDN in the access provider network which may be tightly integrated with the access provider infrastructure.

A brokering content network BCN may not operate its own surrogates and instead may provide interoperability service to other CDNs. In particular BCNs may implement request routing and accounting interworking. Unless there is pre agreement between CDNs there is currently no way for an upstream CDN to decide which downstream CDN to communicate with.

A method and apparatus are described for forwarding content delivery network interconnection CDNI signaling. A CDNI router content delivery network CDN may establish CDNIs with upstream and downstream CDNs. The CDNI router CDN may receive a CDNI route advertisement message from at least one of the upstream and downstream CDNs. The CDNI router CDN may update at least one end user based CDNI routing table based on Internet protocol IP address blocks in the CDNI route advertisement message. The CDNI router CDN may transmit an updated CDNI route advertisement message to at least one of the upstream and downstream CDNs. At least one of the upstream and downstream CDNs may update at least one end user based CDNI routing table based on the end user IP address blocks in the updated CDNI route advertisement message.

As shown in the communications system may include wireless transmit receive units WTRUs a radio access network RAN a core network a public switched telephone network PSTN the Internet and other networks though it will be appreciated that the disclosed embodiments contemplate any number of WTRUs base stations networks and or network elements. Each of the WTRUs may be any type of device configured to operate and or communicate in a wireless environment. By way of example the WTRUs may be configured to transmit and or receive wireless signals and may include user equipment UE a mobile station a fixed or mobile subscriber unit a pager a cellular telephone a personal digital assistant PDA a smartphone a laptop a netbook a personal computer a wireless sensor consumer electronics and the like.

The communications systems may also include a base station and a base station . Each of the base stations may be any type of device configured to wirelessly interface with at least one of the WTRUs to facilitate access to one or more communication networks such as the core network the Internet and or the other networks . By way of example the base stations may be a base transceiver station BTS a Node B an evolved Node B eNB a home Node B HNB a home eNB HeNB a site controller an access point AP a wireless router and the like. While the base stations are each depicted as a single element it will be appreciated that the base stations may include any number of interconnected base stations and or network elements.

The base station may be part of the RAN which may also include other base stations and or network elements not shown such as a base station controller BSC a radio network controller RNC relay nodes and the like. The base station and or the base station may be configured to transmit and or receive wireless signals within a particular geographic region which may be referred to as a cell not shown . The cell may further be divided into cell sectors. For example the cell associated with the base station may be divided into three sectors. Thus in one embodiment the base station may include three transceivers i.e. one for each sector of the cell. In another embodiment the base station may employ multiple input multiple output MIMO technology and therefore may utilize multiple transceivers for each sector of the cell.

The base stations may communicate with one or more of the WTRUs over an air interface which may be any suitable wireless communication link e.g. radio frequency RF microwave infrared IR ultraviolet UV visible light and the like . The air interface may be established using any suitable radio access technology RAT .

More specifically as noted above the communications system may be a multiple access system and may employ one or more channel access schemes such as CDMA TDMA FDMA OFDMA SC FDMA and the like. For example the base station in the RAN and the WTRUs may implement a radio technology such as universal mobile telecommunications system UMTS terrestrial radio access UTRA which may establish the air interface using wideband CDMA WCDMA . WCDMA may include communication protocols such as high speed packet access HSPA and or evolved HSPA HSPA . HSPA may include high speed downlink packet access HSDPA and or high speed uplink packet access HSUPA .

In another embodiment the base station and the WTRUs may implement a radio technology such as evolved UTRA E UTRA which may establish the air interface using long term evolution LTE and or LTE advanced LTE A .

In other embodiments the base station and the WTRUs may implement radio technologies such as IEEE 802.16 i.e. worldwide interoperability for microwave access WiMAX CDMA2000 CDMA2000 1X CDMA2000 evolution data optimized EV DO Interim Standard 2000 IS 2000 Interim Standard 95 IS 95 Interim Standard 856 IS 856 global system for mobile communications GSM enhanced data rates for GSM evolution EDGE GSM EDGE RAN GERAN and the like.

The base station in may be a wireless router HNB HeNB or AP for example and may utilize any suitable RAT for facilitating wireless connectivity in a localized area such as a place of business a home a vehicle a campus and the like. In one embodiment the base station and the WTRUs may implement a radio technology such as IEEE 802.11 to establish a wireless local area network WLAN . In another embodiment the base station and the WTRUs may implement a radio technology such as IEEE 802.15 to establish a wireless personal area network WPAN . In yet another embodiment the base station and the WTRUs may utilize a cellular based RAT e.g. WCDMA CDMA2000 GSM LTE LTE A and the like to establish a picocell or femtocell. As shown in the base station may have a direct connection to the Internet . Thus the base station may not be required to access the Internet via the core network .

The RAN may be in communication with the core network which may be any type of network configured to provide voice data applications and or voice over Internet protocol VoIP services to one or more of the WTRUs . For example the core network may provide call control billing services mobile location based services pre paid calling Internet connectivity video distribution and the like and or perform high level security functions such as user authentication. Although not shown in it will be appreciated that the RAN and or the core network may be in direct or indirect communication with other RANs that employ the same RAT as the RAN or a different RAT. For example in addition to being connected to the RAN which may be utilizing an E UTRA radio technology the core network may also be in communication with another RAN not shown employing a GSM radio technology.

The core network may also serve as a gateway for the WTRUs to access the PSTN the Internet and or other networks . The PSTN may include circuit switched telephone networks that provide plain old telephone service POTS . The Internet may include a global system of interconnected computer networks and devices that use common communication protocols such as the transmission control protocol TCP user datagram protocol UDP and the Internet protocol IP in the TCP IP suite. The networks may include wired or wireless communications networks owned and or operated by other service providers. For example the networks may include another core network connected to one or more RANs which may employ the same RAT as the RAN or a different RAT.

Some or all of the WTRUs in the communications system may include multi mode capabilities i.e. the WTRUs may include multiple transceivers for communicating with different wireless networks over different wireless links. For example the WTRU shown in may be configured to communicate with the base station which may employ a cellular based radio technology and with the base station which may employ an IEEE 802 radio technology.

The processor may be a general purpose processor a special purpose processor a conventional processor a digital signal processor DSP a microprocessor one or more microprocessors in association with a DSP core a controller a microcontroller an application specific integrated circuit ASIC a field programmable gate array FPGA circuit an integrated circuit IC a state machine and the like. The processor may perform signal coding data processing power control input output processing and or any other functionality that enables the WTRU to operate in a wireless environment. The processor may be coupled to the transceiver which may be coupled to the transmit receive element . While depicts the processor and the transceiver as separate components the processor and the transceiver may be integrated together in an electronic package or chip.

The transmit receive element may be configured to transmit signals to or receive signals from a base station e.g. the base station over the air interface . For example in one embodiment the transmit receive element may be an antenna configured to transmit and or receive RF signals. In another embodiment the transmit receive element may be an emitter detector configured to transmit and or receive IR UV or visible light signals for example. In yet another embodiment the transmit receive element may be configured to transmit and receive both RF and light signals. The transmit receive element may be configured to transmit and or receive any combination of wireless signals.

In addition although the transmit receive element is depicted in as a single element the WTRU may include any number of transmit receive elements . More specifically the WTRU may employ MIMO technology. Thus in one embodiment the WTRU may include two or more transmit receive elements e.g. multiple antennas for transmitting and receiving wireless signals over the air interface .

The transceiver may be configured to modulate the signals that are to be transmitted by the transmit receive element and to demodulate the signals that are received by the transmit receive element . As noted above the WTRU may have multi mode capabilities. Thus the transceiver may include multiple transceivers for enabling the WTRU to communicate via multiple RATs such as UTRA and IEEE 802.11 for example.

The processor of the WTRU may be coupled to and may receive user input data from the speaker microphone the keypad and or the display touchpad e.g. a liquid crystal display LCD display unit or organic light emitting diode OLED display unit . The processor may also output user data to the speaker microphone the keypad and or the display touchpad . In addition the processor may access information from and store data in any type of suitable memory such as the non removable memory and or the removable memory . The non removable memory may include random access memory RAM read only memory ROM a hard disk or any other type of memory storage device. The removable memory may include a subscriber identity module SIM card a memory stick a secure digital SD memory card and the like. In other embodiments the processor may access information from and store data in memory that is not physically located on the WTRU such as on a server or a home computer not shown .

The processor may receive power from the power source and may be configured to distribute and or control the power to the other components in the WTRU . The power source may be any suitable device for powering the WTRU . For example the power source may include one or more dry cell batteries e.g. nickel cadmium NiCd nickel zinc NiZn nickel metal hydride NiMH lithium ion Li ion and the like solar cells fuel cells and the like.

The processor may also be coupled to the GPS chipset which may be configured to provide location information e.g. longitude and latitude regarding the current location of the WTRU . In addition to or in lieu of the information from the GPS chipset the WTRU may receive location information over the air interface from a base station e.g. base stations and or determine its location based on the timing of the signals being received from two or more nearby base stations. The WTRU may acquire location information by way of any suitable location determination method while remaining consistent with an embodiment.

The processor may further be coupled to other peripherals which may include one or more software and or hardware modules that provide additional features functionality and or wired or wireless connectivity. For example the peripherals may include an accelerometer an e compass a satellite transceiver a digital camera for photographs or video a universal serial bus USB port a vibration device a television transceiver a hands free headset a Bluetooth module a frequency modulated FM radio unit a digital music player a media player a video game player module an Internet browser and the like.

The RAN may include eNBs though it will be appreciated that the RAN may include any number of eNBs while remaining consistent with an embodiment. The eNBs may each include one or more transceivers for communicating with the WTRUs over the air interface . In one embodiment the eNBs may implement MIMO technology. Thus the eNB for example may use multiple antennas to transmit wireless signals to and receive wireless signals from the WTRU

Each of the eNBs may be associated with a particular cell not shown and may be configured to handle radio resource management decisions handover decisions scheduling of users in the uplink and or downlink and the like. As shown in the eNBs may communicate with one another over an X2 interface.

The core network shown in may include a mobility management entity MME a serving gateway and a packet data network PDN gateway . While each of the foregoing elements are depicted as part of the core network it will be appreciated that any one of these elements may be owned and or operated by an entity other than the core network operator.

The MME may be connected to each of the eNBs in the RAN via an S1 interface and may serve as a control node. For example the MME may be responsible for authenticating users of the WTRUs bearer activation deactivation selecting a particular serving gateway during an initial attach of the WTRUs and the like. The MME may also provide a control plane function for switching between the RAN and other RANs not shown that employ other radio technologies such as GSM or WCDMA.

The serving gateway may be connected to each of the eNBs in the RAN via the S1 interface. The serving gateway may generally route and forward user data packets to from the WTRUs . The serving gateway may also perform other functions such as anchoring user planes during inter eNB handovers triggering paging when downlink data is available for the WTRUs managing and storing contexts of the WTRUs and the like.

The serving gateway may also be connected to the PDN gateway which may provide the WTRUs with access to packet switched networks such as the Internet to facilitate communications between the WTRUs and IP enabled devices.

The core network may facilitate communications with other networks. For example the core network may provide the WTRUs with access to circuit switched networks such as the PSTN to facilitate communications between the WTRUs and traditional land line communications devices. For example the core network may include or may communicate with an IP gateway e.g. an IP multimedia subsystem IMS server that serves as an interface between the core network and the PSTN . In addition the core network may provide the WTRUs with access to the networks which may include other wired or wireless networks that are owned and or operated by other service providers.

Content may be any form of digital data. One important form of content with additional constraints on distribution and delivery may be continuous media i.e. streaming media .

A content delivery network CDN may be a network infrastructure in which the network elements may cooperate at layers through layer for more effective delivery of content to user agents. A CDN may consist of a request routing system a distribution system that includes a set of surrogates a logging system and a CDN control system.

A publisher or content service provider CSP may be an entity that provides a content service to an end user. A publisher may own the content made available as part of the content service or may license content rights from another party.

An end user may be the real user of the system typically a human but maybe some combination of hardware and or software emulating a human.

An authoritative CDN may be an upstream CDN contracted by the publisher for delivery by this CDN or by its downstream CDNs.

An ingestion interface may be established between the publisher and a CDN and may be used to upload content and metadata to the CDN.

A CDNI control interface may allow initial secure connection setup and bootstrapping of other interfaces. Other functions may include capability exchange and content purge and pre positioning.

A CDNI request routing interface may allow the request routing system in interconnected CDNs to communicate to ensure that an end user request may be re directed from an upstream CDN to a surrogate in the downstream CDN in particular where selection responsibilities may be split across CDNs e.g. the upstream CDN may be responsible for selecting the downstream CDN while the downstream CDN may be responsible for selecting the actual surrogate within that CDN .

A CDNI logging interface may be used to exchange activity logs such as those used for charging purposes.

A CDNI metadata interface may communicate content metadata that is relevant to the distribution of the content and have an inter CDN scope. For example geo blocking information availability time windows and access control mechanisms may be part of this CDNI metadata.

Request routing may be different from CDNI routing. Request routing may be used to fulfill a request from an end user request routing is a function of CDNs . CDNI routing may be used to route CDNI signaling through one or more CDNs CDNI Routers .

CDNs may provide content to end users such as static images or files streaming content or interactive services. CDNI may provide interfacing between CDNs including control request routing logging and metadata. CDNs may be interconnected to each other using a peer to peer CDNI. These CDNs may implement CDNI routing which enables communication between two CDNs not directly peered with each other using CDNI. CDNI routing may involve more than request routing RR messages between CDNs. In particular logging enables settlements between CDNs linked through CDNI as part of a business relationship.

Currently CDNI is envisioned between two 2 CDNs. A first CDN may decide to delegate a content delivery to a second CDN which may delegate again to another interconnected CDN . A CDN may decide to delegate to another CDN which it is not necessarily directly interconnected with. Thus the scope of CDN interconnection may shift from local to global interconnecting many CDNs within a single content internetwork.

As shown in the descriptions of those routing methods may include a routing protocol remote peer CDN discovery which is applicable for CDNI unicast and actual CDNI message routing. What is common between the various routing methods is that CDNs interconnect with each other using CDNI as part of a business relationship. CDNs having more than one interconnection may provide CDNI routing services to other CDNs. Moreover some of the interconnected CDNs may be access CDNs i.e. CDNs deployed by Internet service providers ISPs or mobile network operators MNOs and integrated in the operator s network to more efficiently serve this operator s end users.

The CDNI routing function shown in may support various routing methods cdni local link end user based cdni unicast cdni multicast cdni broadcast peer CDN discovery in particular for request routing protocol for CDNI routing i.e. routing information exchange between CDNs protocol for CDNI request routing and access CDN Role. The access CDNs may be able to use a pull CDN reselection mechanism.

A CDNI router is an entity interconnected to two 2 or more CDNs using CDNI and which is able to forward CDNI signaling from one interconnected CDN to another. For example CDN A may interconnect with CDN B and CDN C. CDN B and CDN C are not interconnected with each other. CDN A provides a CDNI Routing service to CDN B and CDN C in such way that CDN B and CDN C may delegate content delivery to each other as well as other related CDNI operations such as exchanging logs.

An access CDN is a CDN deployed by an access provider such as a cellular network operator or an ISP in order to better serve the end users of this access provider. In a context where many CDNs are interconnected with each other directly or indirectly through CDNI routers an access CDN may advertise to others here are all my end users such as by using IP address ranges. This information may be used to discover the best CDN for a given end user.

 End user based routing is a CDNI routing scheme whereby a routing protocol is used to disseminate access CDN end user information to all interconnected CDNs. Furthermore upstream CDNs and all intermediate CDNI routers may use this information to direct CDNI messages towards the appropriate access CDN for a given end user. In particular the CDNI messages sent using this routing scheme may be clearly related to a given end user such as a request routing message associated with an end user originating the content request.

For end user based routing the upstream CDN shown in may seek out the best peer CDN to deliver a given content to a given end user or set of end users. The actual peer CDN may not be known a priori but may be discovered through the CDNI routing mechanism. To enable this access CDNs may advertise over CDNI the set of IP address blocks of their managed end users i.e. the end users of the access provider deploying this access CDN . CNDI router CDNs may exchange routes to build routing tables which are matching IP address blocks to next hop CDNs.

Examples of use cases where end user based CDNI routing is beneficial may include assisting non global CDNs reach end users world wide thus enabling federations of CDNs to compete with global CDNs and MNOs optimizing network usage by delivering very popular content using multicast solutions such as multimedia broadcast multicast service MBMS . Further the authoritative CDN may reach the access CDN most able to guaranty a certain quality of service since it is integrated in the network of the access provider of a particular end user.

In CDNI routing information may be exchanged over CDNI. Based on this CDN may know it may reach access CDNs managing A.B.. and C.D.. through the CDNI router.

In a web browser on WTRU may obtain a web page from the origin server which contains a pointer to an object stored on CDN e.g. uniform resource location URL http media.example.cdn.com movie1.mpd pointing to metadata associated with a 3GP DASH compliant movie .

In WTRU may resolve media.example.cdn.com. A domain name system DNS request may pass through a local DNS server in the access network not shown . At some point the DNS request may reach an enhanced DNS server in CDN actually the local DNS server may successively query several DNS servers as part of the normal DNS resolution procedure . shows a single arrow towards CDN s enhanced DNS server. This enhanced DNS server may initiate the request routing procedure and .

In as part of the request routing procedure a message is sent to the 3GPP access CDN through the CDNI router CDN to delegate the delivery. This message may be sent because the CDNI router advertised earlier that it had routes to IP address blocks A.B.. and C.D.. . Since the end user local DNS server IP address is within one of these blocks CDN may send a request routing CDNI message to the CDNI Router. Based on its own routing table the CDNI router may forward the message over CDNI to the 3GPP access CDN.

In the 3GPP access CDN may accept and returns the IP address of the selected surrogate. Alternatively if instead of a DNS based content request a redirection based content request was used such as by using hypertext transfer protocol HTTP GET as the request and a redirection HTTP 3xx as in the response in then the 3GPP access CDN may return a hostname instead of an IP address.

In the DNS resolution procedure completes with WTRU receiving the selected surrogate IP address from CDN .

In WTRU may then initiate the content delivery such as by using HTTP GET to obtain the metadata file. Alternatively if the IP address returned to the end user in was the IP address of a 3GPP access CDN redirector function instead of a surrogate then here another redirection to the actual surrogate may occur.

If one or more CDNs use systematically or at least for popular content end user based routing to delegate deliveries to access CDNs then access CDNs may be able to take appropriate actions on new deliveries for popular content. For example if a given content becomes very popular due to receiving more than n deliveries per second for a given time period then assuming that the access CDN turned down the delivery request before that point the access CDN may decide to perform the delivery itself from this point on and until the delivery request rate drops. Moreover the access CDN may also decide based on the detection of this increased popularity to distribute the content using a multicast or P2P delivery method in order to gain in scalability. illustrates this type of access CDN behavior. In another example the access CDN may decide to accept to deliver the content originated from a given publisher or from a given authoritative CDN as part of a business relationship with these entities.

CDNI router CDNs may interconnect with each other and form a content internetwork between access CDNs and other CDNs. When a CDN has the choice to route a message through one of several interconnections i.e. between several routes towards the same CDN it may follow a policy such as shortest route round robin or minimize cost. CDNs may exchange route information including IP blocks and route length using CDNI route advertisement messages.

Several sibling access CDNs may cover the same range of end users. For example they may share the same IP blocks and only differ in the type of media served or even share load them. These sibling access CDNs may interconnect with the same CDNI router s and have an agreement with the CDNI router s to split the traffic according to pre determined rules. In CDNI Router may split CDNI traffic to access CDNs and depending on the media type mentioned in the request routing message fields. Another valid example would be to have CDNI router split the load according to the hash of the content ID such a hash based load balancing algorithm is for example used in the cache array routing protocol CARP .

While this mechanism bears resemblance with IP based routing e.g. border gateway protocol BGP CDNI routing may either build over protocols such as BGP or alternatively be completely distinct from it and operate at a higher layer. The CDNI router CDN may communicate with other CDNs through gateways which are IP end points and when a CDNI message is forwarded it may be sent towards a destination CDN node using the IP address of one of the CDN gateways as the destination. A CDNI message header may be present in CDNI messages inside the IP payload e.g. inside the HTTP payload encoded as javascript object notation JSON or extensible markup language XML . The CDNI routing function may use the routing method field of this header to determine which routing method to use end user based CDNI unicast and the like and then depending on this method other fields maybe used to lookup in the appropriate CDNI routing table.

Because of the possible settlements between CDNs the chain of intermediate CDNI routers may be maintained unmodified for related messages e.g. for all messages related to a certain content . Source routing may be used. An initial message e.g. the first message related to a given content ID may be sent and the route may be recorded in the message by CDNI routers on the way similar to via header usage in session initiation protocol SIP . Any further messages e.g. logs related to the same content may be sent with the pre recorded route included in the message. CDNI routers may use this information to route the message. This method is known as strict source routing and is used in IP and SIP.

Since CDNI routers are generally distributed entities they may typically be full blown CDNs an internal routing protocol mechanism may be used inside the CDNI router in order to merge input from various interconnections in a manner similar to the internal border gateway protocol IBGP . presents how several interconnections are terminated in different CDNI gateways in a CDNI router. Gateways may be connected to each other and exchange CDNI routing information in such a way that the CDNI router as a whole may act as a single entity with one routing table. An example of implementation for this internal protocol is to use CDNI route advertisements in order to synchronize routing tables between all the CDNI gateways of the CDNI router.

In one example of deployment a global CDN e.g. Akamai Limelight may act as a CDNI router for CDNs it interconnects with. In another example of deployment several local ISPs deploying their own CDNs may be federated under a larger ISP s CDN acting as a CDNI router as shown in . For example a cable operating following CableLabs specifications may act as a CDNI router for other cable networks.

In an alternate deployment scenario existing public Internet routers such as the BGP routers between autonomous systems AS may be overlaid with CDNI gateways. For example BGP routers may support a new CDNI gateway function or alternatively a CDNI gateway may be deployed at Internet interconnection points beside a BGP router. In this scenario a CDN may interconnect with CDNI gateways located at the border of the AS where its core network is located even if some of its surrogates are located outside of this AS. A CDN distributed over several AS may decide to interconnect with CDNI gateways located in all or some of the AS it covers.

MNOs using IMS may decide to deploy an access CDN in their IMS network. A deployment option available to interconnect this access CDN with other CDNs may be a session border controller SBC which is a network based entity that may be deployed at the borders of different service provider networks used in a peering environment to control signaling and media setup. Moreover the SBC may be deployed to delineate operator access and backbone networks. In 3GPP IMS architecture the functionality of the SBC at the entry exit point may be carried out by interconnection border control function IBCF . CDNI routing messaging and the media relaying functionality carried out by CDNI Gateway may be mapped into the IBCF. Namely at the demarcation point the IBCF itself or an interworking function IWF interoperating with the IBCF may handle CDNI routing. Similar deployments may also be valid for telecommunications and Internet converged services and protocols for advanced networks TISPAN architecture. This functionality distribution may let the 3GPP operator clearly identify the relationships between its access CDN network and other 3GPP or non 3GPP operator say IPTV network CDNs.

Examples of CDNI interconnection may include IBCF to IBCF using SIP to encode CDNI between 2 IMS based CDNs or IWF to any CDNI gateway using HTTP based CDNI between an IMS based CDN and a non IMS CDN . shows an Internet protocol multimedia subsystem IMS to external IP multimedia network interworking reference architecture. shows the relationship between an IBCF an IWF an IMS network and an external IP multimedia network. CDNI routing signaling may be terminated by the IWF or the IBCF

A new CDNI routing advertisement message may be part of a new CDNI routing application programming interface API . Using this message an access CDN may advertise its end users a set of IPv4 or IPv6 address blocks and a CDNI router may advertise routes towards end users of an interconnected access CDN. This information may be exchanged at initial CDNI connection time between CDN peers and may be later updated when needed. Other CDNs that do not have the roles of access CDN or CDNI routers may not advertise route information but may receive it from others. Upon reception of a route advertisement a CDN may fill or update an end user based CDNI routing table. A CDN may maintain several routes towards the same or intersecting IP blocks. A routing decision between these routes may be based on a shortest path lowest cost failover or other policy. A CDN may reject advertisements it is not willing or able to use. CDNs may use capabilities exchanged using a CDNI control API to indicate to each other if they support the CDNI routing API.

A peer to peer CDNI link may be based on a pre existing trust relationship between peers. This trust relationship is important to ensure that access CDNs properly declare their end users and that the CDNI router properly advertises routes with correct path length.

A CDN request routing procedure may takes place when an end user sends a content request. If the authoritative CDN uses a DNS based redirection method the content request may take the form of a DNS request for a fully qualified domain name FQDN for which a CDN is authoritative. Alternatively if the CDN is using an HTTP redirection method the content request may be the initial HTTP GET directed to the origin server or to the authoritative CDN redirector function. Content requests may also take other forms e.g. SIP INVITE . The content request may reach the authoritative CDN request routing function which is in charge of identifying a proper surrogate and redirecting the end user towards this surrogate. The request routing procedure may include inter CDN communication to delegate the delivery to another CDN. This procedure may cascade to one or more CDNs.

An upstream CDN starting a request routing procedure may check the end user based CDNI routing table and determine that there is an access CDN serving the end user of the content delivery. The upstream CDN may involve this access CDN in the procedure e.g. because the CDNI routing table entry contained a flag requesting this behavior for this entry . The upstream CDN may then build a CDNI request routing message and send it to the next hop indicated by the CDNI routing table selected entry. Every intermediate CDNI router may route the message according to its end user based CDNI routing table. Every intermediate CDNI router may update the request by adding its CDN ID in the message to enable source routing to be used for the CDNI response and is similar to the via SIP header . Finally the message may reach the access CDN which may determine whether or not to deliver the content. When building the response the access CDN may copy over the recorded route information from the request which may be used by the intermediate CDNI routers to forward this response along the same route taken by the request.

A CDNI message header may indicate a routing method by using a code indicating how this message is to be routed. For example in a link local method no CDNI routing is to be performed on this message in end user based CDNI routing CDNI routing may be performed by finding the best match of the end user IP address present in another field in this message within the end user based CDNI routing table and source routing where the sender and subsequent CDNI routers find themselves in the recorded route present in the message and then forward the message to the next CDN in the recorded route.

A CDNI request header may indicate a destination CDN using an identifier of the final destination of the message e.g. a domain name which is omitted when the destination is unknown e.g. when end user based CDNI routing is used .

A CDNI request header may indicate a source CDN in the request it should be the same as the authoritative CDN . A CDNI request header may indicate a message ID this is a unique ID within the scope of a given Source CDN . For example the sender may increment an internal counter by one for every message sent.

A CDNI request header may indicate a recorded route using a list of CDN IDs recording intermediate CDNs in the path which are adding their ID when forwarding a message this is to enable routing of the response and to detect routing loops .

A CDNI request routing request REQ message may include a CDNI message header and delivery identification authoritative CDN ID content ID and end user ID such as an IP address or its local DNS server IP address if not available .

A CDNI request routing response RSP message may include a CDNI message header destination and source CDNs may be properly reversed and the recorded route may be copied over from the request possibly in reversed order delivery identification same fields as in REQ and a decision to deliver Yes No .

CDNI unicast routing and service based CDN discovery procedure may be implemented as follows. A source CDN may desire to reach a specific destination CDN which it may be directly interconnected with. The destination CDN itself is known and the routing does not depend on the end user location. This destination may be known a priori by the source CDN or alternatively a discovery mechanism may be used to determine the best destination CDN typically to determine the best CDN to use for a given delivery . Thus this procedure has a routing side covering routing fabric setup and the routing itself and a destination CDN discovery side.

CDNs connecting to a CDNI router CDN may provide set s of IP address blocks of its own nodes typically public IP addresses directly used by the CDN operator . CDNs may exchange routing information whereby IP blocks are not end user IP blocks but CDN core network IP blocks non router CDNs may advertise their own local IP block s two 2 non router CDNs may interconnect this way CDNI routers may advertise both their own local IP block s and IP blocks they can route to and the access CDN role is not relevant here.

A CDNI unicast routing table may be maintained by interconnected CDNs based on CDNI route advertisements. This routing table may be distinct from the end user based CDNI routing table but since the IP address space of the end users and CDN core networks is typically the same public IP address space there may not be a practical reason to keep them separated. The CDNI unicast routing table may alternatively use CDN IDs instead of IP addresses in which case the routing tables may remain distinct from each other.

For a CDNI routing advertisement the IP address blocks may belong to CDN Core networks instead of access CDN end users. A CDNI unicast routing table may have the same fields as an end user based CDNI routing table. The IP address blocks may belong to CDN Core networks instead of access CDN end users. Alternatively the CDNI unicast routing table may be populated with CDN IDs such as domain names instead of IP addresses.

CDNI messages may use a new routing method field value CDNI unicast. A response message and other related messages may use either source routing or CDNI unicast routing. The advantage of source routing is that may guaranty that the same route may be used for all related messages. The CDNI message header may be updated to support CDNI unicast.

The routing method for the CDNI message header may be updated with a new method whereby for CDNI Unicast CDNI routers may forward this message to the next hop from the best matching routing entry in the local CDNI unicast routing table using a destination IP address for lookup . If no match is found in the routing table the message may be dropped. New fields may be added including a CDNI destination IP address e.g. IP address of a CDNI gateway or other CDNI core network node of the destination CDN and a CDNI source IP address used by receiver to reply if needed . Alternatively these last two new fields may be replaced with CDNI destination source CDN IDs such as domain names .

Destination CDN discovery may be performed in various ways including offline provisioning external discovery service and discovery messages using CDNI multicast or broadcast. The source CDN may be provisioned with destination CDN IP address blocks or IDs based on pre agreements or simply an offline mapping decision. Alternatively an external discovery service may be used to register and query CDNs. For example application layer traffic optimization ALTO may be used for this purpose. ALTO may be used for surrogate selection inside CDNs and ALTO server interconnection is proposed for CDNI. A higher level mapping may be used whereby a list of potential CDNs may be returned in response to a query for deliver content of a given type to given end users and other parameters. Based on this information a CDN may then initiate a request routing procedure with the returned CDN s .

A CDN discovery message may be used by the source CDN to obtain one or more candidates. This discovery message may use end user based multicast or broadcast CDNI routing methods. The discovery message response may contain information about the CDN footprint supported media types and the like.

A CDNI peer discovery REQ message may include a CDNI Message Header and distribution parameters i.e. what are the characteristics of the content distribution such as end user IP address range media type and the like. If this is present receiver CDNs may limit the scope of their response to these parameters e.g. they may reject the request if they don t support the given media type .

A CDNI peer discovery RSP message may include a CDNI message header a return code accept reject whereby instead of using reject the response may be omitted when CNDI multicast or CDNI broadcast is used for the request and distribution parameters i.e. what are the characteristics of the content distribution acceptable for this CDN such as end user IP address range media type and the like.

In CDNI multicast routing the upstream CDN may desire to reach a given group of CDNs that provide group membership information to the CDNI router CDN they interconnect with. When exchanging routing information the CDNI router CDNs may include group membership as well. CDNI messages with the CDNI routing method CDNI multicast may be sent towards a group new CDNI message field and may be duplicated as necessary by CDNI routers to reach all members of the group. CDNI responses and further related messages may be sent using the CDNI unicast routing method.

A new CDNI message for CDNI group membership management this message may be part of the new CDNI routing API may include a CDNI message header routing method link local may typically be used a join or leave command and a group ID e.g. a string or an IP address . To avoid clashes a global registry of existing multicast groups may be used. Alternatively IP addresses may be used as group ID.

For example a CDN may join a Canadian multicast group. All interconnected CDNI Routers may end up obtaining a route towards members of this group. An authoritative CDN may send a discovery message to this group to get a list of connected CDNs able and willing to distribute content in Canada. Typically any CDN may decide to join a multicast group by sending a join message over CDNI to a CDNI router peer. Group membership may be spread between CDNI routers using CDNI messaging. For example a CDNI protocol based on protocol independent multicast sparse mode PIM SM or distance vector multicast routing protocol DVMRP may be used.

A new CDNI message to transport CDNI multicast routing messages this message may be part of the new CDNI Routing API may include a CDNI message header routing method link local may typically be used. A multicast routing message may be encapsulated e.g. based on PIM SM or DVMRP .

The CDNI message header may be updated to support CDNI multicast. The routing method may be updated with a new CDNI multicast method whereby CDNI routers may forward this message towards all CDNs which joined this group and include a destination CDNI multicast group field.

For CDNI broadcast routing the upstream CDN may desire to reach any CDN willing to deliver the content within other constraints as specified in the CDNI request routing message . For example the message may reach all CDNs within a limit of n hops. This type of message may be useful to implement discovery schemes or for urgent network wide alarm messages. The CDNI message header may be updated to support CDNI Broadcast. The routing method may be updated with a new CDNI broadcast method whereby CDNI routers may forward this message towards all other interconnected CDNs while avoiding loops using mechanisms such as reverse path forwarding RPF message time to live TTL field or duplicate detection using the message ID.

The routing decision may be based on the content ID i.e. a piece of information uniquely describing a piece of content within the scope of the content internetwork . For example such a content ID may be composed of the concatenation of a global CDN ID of the authoritative CDN for this content e.g. a domain name a publisher ID provided by the authoritative CDN e.g. an account number or by the publisher e.g. a domain name and a string provided by the publisher for this particular piece of content.

CDNI routers may compare the content ID present in the CDNI header with an internal content routing table storing content IDs or set of content IDs advertised by CDNs and forward the message towards all matching recipients. Alternatively a CDN may forward the message towards one matching recipient e.g. the closest instead of all recipients. For example some CDNs may advertise their interest in delivering content from a particular publisher e.g. Youtube . These CDNs may receive routing requests using the content ID based routing method and may reply using the source routing method .

A new CDNI message part of the new CDNI routing API may include a CDNI content ID based routing message. The routing method link local may typically be used. The message may include a set of content IDs the sender CDN is interested in delivering. If the content ID is structured wildcards may be used to designate all content from a given publisher and or a given authoritative CDN.

The CDNI Message Header is updated to support content ID based routing. The routing method may be updated with a new method using CDNI Content ID Based Routing whereby CDNI routers may forward this message towards all CDNs advertising this content.

The various embodiments described herein may be used concurrently on the same routing fabric. The CDNI message header field routing method may be set by the sender depending on the need and every CDN on the path may perform CDNI routing based on the method specified in this field.

Although features and elements are described above in particular combinations one of ordinary skill in the art will appreciate that each feature or element may be used alone or in combination with any of the other features and elements. In addition the embodiments described herein may be implemented in a computer program software or firmware incorporated in a computer readable medium for execution by a computer or processor. Examples of computer readable media include electronic signals transmitted over wired or wireless connections and computer readable storage media. Examples of computer readable storage media include but are not limited to a read only memory ROM a random access memory RAM a register a cache memory a semiconductor memory device a magnetic media e.g. an internal hard disc or a removable disc a magneto optical media and an optical media such as a compact disc CD or a digital versatile disc DVD . A processor in association with software may be used to implement a radio frequency transceiver for use in a WTRU UE terminal base station Node B eNB HNB HeNB AP RNC wireless router or any host computer.

