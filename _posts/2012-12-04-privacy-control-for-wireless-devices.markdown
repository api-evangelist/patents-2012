---

title: Privacy control for wireless devices
abstract: According to various embodiments, a computer-implemented method is disclosed that includes receiving, at a wireless adaptor of a device, a wireless data packet from an access point (AP), wherein the wireless data packet includes a Basic Service Set Identifier (BSSID) of the AP; changing the BSSID of the received data packet by a processor or hardware to produce a modified wireless data packet; and transmitting the modified wireless data packet to an application on the device.
url: http://patft.uspto.gov/netacgi/nph-Parser?Sect1=PTO2&Sect2=HITOFF&p=1&u=%2Fnetahtml%2FPTO%2Fsearch-adv.htm&r=1&f=G&l=50&d=PALL&S1=09143931&OS=09143931&RS=09143931
owner: Intel Corporation
number: 09143931
owner_city: Santa Clara
owner_country: US
publication_date: 20121204
---
This application is a continuation of U.S. patent application Ser. No. 12 895 352 filed Sep. 30 2010 the contents of which are hereby incorporated by reference in their entirety.

This disclosure relates generally to the field of wireless communication and in particular to privacy control for wireless devices.

Sensors such as location detecting sensors including GPS are becoming more common in computer devices especially mobile devices. For example most new laptops and smart phones include some form of location sensing hardware and or software that can be used to find a location or approximate location of the device or a location of an access point with which the devices are in communication. Conventionally local area networks LANs and wireless local area networks WLAN adaptors such as WiFi receive their IP address from the infrastructure around it.

A WiFi WLAN device acquires the identification number basic service set identifier or BSSID of access points it sees around it or associates with as part of its normal mode of operation. The WiFi access point s BSSID is a unique identifier that can be used to find out the access point s location and thereof also the device s location especially in mobile platforms. There are already existing services from Skyhook and from Google that provide pretty accurate platform location based on the received access point information. Every WiFi adapter provides upon a host software request the BSSID of the associated access point and of other access points around it as well as other data like signal strength etc. Based on such data and sometimes using sophisticated triangulation calculation these Internet servers will provide the client machine or others with a high accuracy estimation of the machine s location.

It is easy to understand that given the open nature of today s operating systems and the wide availability and heavy use of WiFi in mobile platforms WiFi access point information is easily obtained by every software on the platform and thus the user s privacy can be violated if software collects and sends such platform sensors information to unauthorized or uncontrolled destinations. Also in case such information is openly communicated over the network it can be seen by others and used to determine and track the user s location. In every mobile platform that incorporates a WLAN adapter software can access the WLAN driver using standard APIs and get information about the access points that the WLAN card sees.

Given the problems described above what is needed is an improved mechanism whereby a device and hence a user s location can be obscured from software on the platform.

Access Point AP Any entity that has a station STA functionality and provides access to the distribution services via the wireless medium WM for associated STAs.

Basic service set BSS The basic building block of an IEEE 802.11 wireless LAN according to the IEEE 802.11 1999 standard . In Infrastructure mode a single access point AP together with all associated stations STAs is called a BSS. In Independent mode a set of synchronized. STAs one of which acts as master forms a BSS. Each BSS is identified by a BSSID. The most basic BSS consists of one AP and one STA.

Basic Service Set Identifier BSSID A BSSID uniquely identifies each BSS the SSID however can be used in multiple possibly overlapping BSSs . In an infrastructure BSS the BSSID is the MAC address of the wireless access point WAP . In an IBSS the BSSID is a locally administered MAC address generated from a 48 bit random number.

Media Access Control MAC A Media Access Control MAC is a data communication protocol sub layer also known as the Medium Access Control is a sublayer of the Data Link Layer specified in the seven layer OSI model layer 2 .

Mobile Station MS A type of STA that uses network communications while in motion. Station STA Any device that contains an IEEE 802.11 conformant medium access control MAC and physical layer PHY interface to the wireless medium WM .

Station STA Any device that contains an IEEE 802.11 conformant medium access control MAC and physical layer PHY interface to the wireless medium WM .

Wireless medium WM The medium used to implement the transfer of protocol data units PDUs between peer physical layer PHY entities of a wireless local area network LAN .

In accordance with some aspects of the present disclosure a computer implemented method is disclosed that includes receiving at a wireless adaptor of a device a wireless data packet from an access point AP wherein the wireless data packet includes a Basic Service Set Identifier BSSID of the AP changing the BSSID of the received data packet by a processor to produce a modified wireless data packet and transmitting the modified wireless data packet to an application on the device.

In some aspects changing the BSSID can include encrypting the BSSID scrambling the BSSID or both. The method can further include receiving a seed value or an encryption key from a controller to change the BSSID wherein the controller is electrically coupled to the wireless adaptor. The encryption key can include a public encryption key or a private encryption key and the controller can include a manageability engine. In the method the change of the BSSID can hide an actual BSSID from a software program an operating system or both of the device. In the method the change of the BSSID can allow a location derived from an actual BSSID to be hidden from a software program an operating system or both of the device.

In some aspects the method can include transferring the received BSSID to an authenticated entity in a secured manner wherein the received BSSID can be used to determine a location of the AP and provide a service related to location but preventing the application or an operating system of the device from assessing the received BSSID data and location data.

In accordance with some aspects of the present disclosure a computer implemented method is disclosed that includes receiving at a wireless adaptor of a device a wireless data packet including a modified a Basic Service Set Identifier BSSID of an access point AP changing the modified BSSID of the received wireless data packet by a processor to produce a unmodified wireless data packet and transmitting the wireless data packet to the AP.

In some aspects the method can include changing the BSSID includes decrypting the BSSID descrambling the BSSID or both. Moreover the method can include receiving a decryption key from a controller to change the BSSID wherein the controller is electrically coupled to the wireless adaptor. The decryption key can include a public decryption key or a private decryption key and the controller can include a manageability engine. The method can further include receiving a seed value or a decryption key from a controller to initiate the unscrambling of the BSSID.

In accordance with some aspects of the present disclosure a device is disclosed that includes a wireless adaptor including a processor in communication with a memory having instructions stored therein which when executed receive a wireless data packet from an access point AP wherein the wireless data packet includes a Basic Service Set Identifier BSSID of the AP change the BSSID of the received data packet to produce a modified wireless data packet and transmit the modified wireless data packet to an application on the device.

In some aspects the wireless adaptor can be configured to change the BSSID by encrypting the BSSID scrambling the BSSID or both. The device can include a controller configured to provide an encryption key to the wireless adaptor for used in encrypting the BSSID wherein the controller can include a manageability engine. The wireless adaptor can be configured to separate information derived from an actual BSSID from a software program an operating system or both of the device.

Unauthorized software SW or malware can be loaded onto a computer to access device application programming interfaces APIs without a user s knowledge. This SW or malware can reveal information to a malicious user that can later be used to track the computer as well as the location of the user. This access to the location without first getting consent from the user or being part of an application white list that are secure enough to be allowed to access this sensitive info can cause harm to the user.

Given these problems and in accordance with various aspects of the present disclosure a WiFi AP BSSID can be hidden from an operating system OS and general SW applications and be only transferred securely to authentic and approved applications and or servers. In this respect location revealing information can be hidden from OS SW and passed securely to either some secure network server which can give location based services or to a secure OS service or application that can then track device location and provide this information only to authenticated apps or usages.

Moreover other information such as sensor data provided by various sensor devices either connected to or coupled with the user s computer can also be hidden or secured. For example a standardized API and device driver interface DDI that works with the various sensors and their sensor data can be hidden or secured from OS SW on the user s computer. Sensors can come in many configurations including both hardware devices and software. For example logical sensors can provide information through emulation of sensor functionality in software or firmware. Also a single hardware device can contain multiple sensors. The various sensors can include location sensors such as GPS devices. Other types of sensors can be software based such as an IP resolver that provides location information based on an Internet address a mobile phone tower triangulator such as in a cellular network that determines location based on nearby towers or a Wi Fi network location provider that reads location information from the connected wireless network hub.

In accordance with various aspects of the present disclosure actual unscrambled access points BSSID data can be altered so that software whether intentionally or unintentionally loaded onto a user s device can not determine the BSSID data. For example a wireless adaptor such as a WLAN hardware or WLAN host driver can alter such as by scrambling or encrypting the BSSIDs that is provided to software operating on the device. Once this scrambling algorithm is enabled the software will receive a false scrambled BSSIDs picture so that in an attempt to send this data to web servers to resolve the device s location an erroneous location or no location would result. With user control over that capability location can be exposed to all applications or to no application or to limited selected applications.

In some aspects control over the wireless adapter such as a WLAN card hardware can also be done securely by an out of band signal from a trusted platform entity or a hardware software controller i.e. but not limited to a Manageability Engine ME or a WLAN OS driver. In such cases user control can be performed at a BIOS level pre OS or through secured input output of the ME or through a trusted web site that can send user s instructions signed and encrypted to ME.

When the user wants to provide his platform location in a secured way to a specific service provider a trusted entity like the ME can access the WLAN BSSID information out of band OOB through a control bus such as ME C link control bus. ME can provide to the WLAN controls for this capability enable disable as well as per platform unique random scrambling unscrambling key generation and or storage for the BSSIDs translation from the real actual numbers to the scrambled numbers exposed to the device. The WLAN card can implement a scrambling unscrambling algorithm or use a real BSSID to scrambled BSSID translation or look up table that pairs an actual BSSID with an equivalent scrambled BSSID.

When privacy mode is enabled the device through for example a wireless adapter can detect actual access points and replace the actual BSSID of the actual access points with a scrambled BSSID based on the scrambling algorithm. The scrambled BSSID and not the actual BSSID can then be exposed to the device s software. This process can be performed on a packet by packet basis. Similarly when the device transmits a wireless data packet the wireless adaptor can replace the scrambled BSSID that comes from the device driver with the actual physical BSSID. When the controller or ME is used and the user wants to send his location information to a trusted destination the controller or ME can access the actual access point BSSID data through an out of band OOB control bus such as ME C link connection to the wireless adaptor and can transfer it encrypted and signed over secured communication channel to a trusted receiving entity.

Turning now to the figures shows an example system in accordance with various aspects of the present disclosure. Device is shown communicating with device through access point over wireless medium . Devices and have their own MAC address. For illustration only the MAC address of device will be labeled MAC address C the MAC address of device will be labeled MAC address A and access point will have a BSSID ID labeled BSSID B . 

Devices and can be STAs or MS and can include computers such as a desktop laptop or smart phone. Device can include wireless adaptor such as WiFi adapter having a MAC address. Device can also include BSSID scrambling algorithm communicating with OS WLAN stack and applications over bus such as a PCI bus. Transceiver can be electrically coupled to and controlled by wireless adapter and can communication with access point and device over wireless medium .

Access point can communicate with device through network such as a LAN. Transceiver can be electrically coupled to and controlled by access point and can communication with device and or device over wireless medium and with device over network .

BSSID scrambling algorithm can be arranged to mask translate scramble or encrypt BSSID of access point using a variety of techniques such as those techniques that would be appreciate by those of ordinary skill in the art. As used herein the word scramble or unscramble will be general term for the various methods in which the BSSID can be altered as described herein.

For example the BSSID can be replaced with a similar but unused or unrelated. BSSID such that the BSSID of access point is not identical with the replacement BSSID. The replacement BSSID can effectively mask or hide the actual BSSID from applications running on device . The BSSID can also be scrambled using algorithms other than cryptographic algorithms.

Moreover if the BSSID is encrypted decrypted a symmetric or asymmetric cryptographic algorithm may be used. By way of example but not limited to symmetric cryptographic algorithms that can be used include Advanced Encryption Standard AES and Data Encryption Standard DES . Other types of symmetric algorithms may also be used. Moreover the types of asymmetric cryptographic algorithms that may be used include but not limited to public key encryption including RSA cryptography.

In some aspects device can also include a controller shown in dotted line such as a Manageability Engine ME that is configured to communicate with BSSID scrambling algorithm stored within a memory of wireless adaptor . Controller can provide a seed or encryption key and or a look up table for the WLAN BSSID translator. Controller can also communicate with applications shown in dotted line over interface shown in dotted line such as a host to embedded controller interface HECI . Applications are configured to access the secured scrambled BSSID from controller to be used by within device or by another device in secured communication with device . The scrambled BSSID can be made available by a user s consent.

In some aspects when controller is used controller can provide for example a unique SEED or encryption key and or a look up table for WLAN BSSID translator. Applications can then access from controller a secured encrypted BSSID based upon a user s consent over interface .

Communicating from device to device will now be described. OS WLAN stack and applications communicates payload data for example payload as shown in the figure to wireless adaptor . Wireless adaptor receives payload data and unscrambles the scrambled. BSSID using scrambling algorithm. Unscrambled data packet including unscrambled BSSID is assembled at wireless adaptor and transmitted by transceiver . Transceiver of access point receives data packet . Access point transmits payload data to device over network .

In addition various embodiments of this disclosure may be made in hardware firmware software or any suitable combination thereof. Aspects of this disclosure may also be implemented as instructions stored on a machine readable medium which may be read and executed by one or more processors. A machine readable medium may include any mechanism for storing or transmitting information in a form readable by a machine e.g. a computing device . For example a machine readable storage medium may include read only memory random access memory magnetic disk storage media optical storage media flash memory devices and others. Further firmware software routines or instructions may be described herein in terms of specific exemplary embodiments that may perform certain actions. However it will be apparent that such descriptions are merely for convenience and that such actions in fact result from computing devices processors controllers or other devices executing the firmware software routines or instructions.

Although the above examples mostly pertain to WiFi APIs this disclosure is so limited. As discussed above other sensor APIs are intended to be encompassed with this disclosure.

Various embodiments herein are described as including a particular feature structure or characteristic but every aspect or embodiment may not necessarily include the particular feature structure or characteristic. Further when a particular feature structure or characteristic is described in connection with an embodiment it will be understood that such feature structure or characteristic may be included in connection with other embodiments whether or not explicitly described. Thus various changes and modifications may be made to this disclosure without departing from the scope or spirit of the inventive concept described herein. As such the specification and drawings should be regarded as examples only and the scope of the inventive concept to be determined solely by the appended claims.

